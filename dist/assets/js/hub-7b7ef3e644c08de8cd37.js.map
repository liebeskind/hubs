{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/utils/history.js","webpack:///./src/storage/media-search-store.js","webpack:///./src/utils/fullscreen.js","webpack:///./src/utils/audio-context-fix.js","webpack:///./src/utils/threejs-positional-audio-updatematrixworld.js","webpack:///./src/components/bone-mute-state-indicator.js","webpack:///./src/components/bone-visibility.js","webpack:///./src/components/hoverable-visuals.js","webpack:///./src/components/hover-visuals.js","webpack:///./src/components/offset-relative-to.js","webpack:///./src/components/hud-controller.js","webpack:///./src/components/icon-button.js","webpack:///./src/components/text-button.js","webpack:///./src/utils/image-bitmap-utils.js","webpack:///./src/components/block-button.js","webpack:///./src/components/mute-button.js","webpack:///./src/components/kick-button.js","webpack:///./src/components/close-vr-notice-button.js","webpack:///./src/components/leave-room-button.js","webpack:///./src/components/visible-if-permitted.js","webpack:///./src/components/networked-avatar.js","webpack:///./src/components/pinnable.js","webpack:///./src/components/drop-object-button.js","webpack:///./src/components/remove-networked-object-button.js","webpack:///./src/assets/sfx/tick.mp3","webpack:///./src/components/camera-focus-button.js","webpack:///./src/components/mirror-camera-button.js","webpack:///./src/components/visible-to-owner.js","webpack:///./src/components/emit-state-change.js","webpack:///./src/components/action-to-event.js","webpack:///./src/components/action-to-remove.js","webpack:///./src/components/emit-scene-event-on-remove.js","webpack:///./src/components/follow-in-fov.js","webpack:///./src/components/matrix-auto-update.js","webpack:///./src/components/hover-menu.js","webpack:///./src/components/disable-frustum-culling.js","webpack:///./src/components/set-active-camera.js","webpack:///./src/components/track-pose.js","webpack:///./src/components/replay.js","webpack:///./src/components/visibility-by-path.js","webpack:///./src/components/tags.js","webpack:///./src/systems/app-mode.js","webpack:///./src/systems/permissions.js","webpack:///./src/systems/exit-on-blur.js","webpack:///./src/systems/camera-tools.js","webpack:///./src/systems/frame-scheduler.js","webpack:///./src/components/owned-object-limiter.js","webpack:///./src/components/set-unowned-body-kinematic.js","webpack:///./src/components/networked-counter.js","webpack:///./src/components/set-yxz-order.js","webpack:///./src/components/nav-mesh-helper.js","webpack:///./src/components/tools/drawing-manager.js","webpack:///./src/utils/promisify-worker.js","webpack:///./src/components/mute-mic.js","webpack:///./src/components/in-world-hud.js","webpack:///./src/components/virtual-gamepad-controls.js","webpack:///./src/utils/avatar-utils.js","webpack:///./src/components/ik-controller.js","webpack:///./src/components/hand-controls2.js","webpack:///./src/components/character-controller.js","webpack:///./src/components/player-info.js","webpack:///./src/components/hand-poses.js","webpack:///./src/components/freeze-controller.js","webpack:///./src/components/visibility-while-frozen.js","webpack:///./src/components/stats-plus.js","webpack:///./src/components/media-views.js","webpack:///./src/components/avatar-volume-controls.js","webpack:///./src/components/pinch-to-move.js","webpack:///./src/components/pitch-yaw-rotator.js","webpack:///./src/components/position-at-box-shape-border.js","webpack:///./src/components/pin-networked-object-button.js","webpack:///./src/components/unmute-video-button.js","webpack:///./src/components/destroy-at-extreme-distances.js","webpack:///./src/components/camera-tool.js","webpack:///./src/components/clone-media-button.js","webpack:///./src/components/open-media-button.js","webpack:///./src/components/transform-object-button.js","webpack:///./src/components/teleporter.js","webpack:///./src/systems/userinput/sets.js","webpack:///./src/utils/vr-caps-detect.js","webpack:///./src/react-components/state-link.js","webpack:///./src/react-components/state-route.js","webpack:///./src/react-components/client-info-dialog.js","webpack:///./src/react-components/loader.js","webpack:///./src/react-components/auto-exit-warning.js","webpack:///./src/react-components/entry-buttons.js","webpack:///./src/react-components/profile-entry-panel.js","webpack:///./src/react-components/media-browser.js","webpack:///./src/react-components/create-object-dialog.js","webpack:///./src/react-components/change-scene-dialog.js","webpack:///./src/react-components/avatar-url-dialog.js","webpack:///./src/react-components/help-dialog.js","webpack:///./src/utils/share.js","webpack:///./src/react-components/invite-dialog.js","webpack:///./src/react-components/invite-team-dialog.js","webpack:///./src/react-components/link-dialog.js","webpack:///./src/react-components/safari-dialog.js","webpack:///./src/react-components/safari-mic-dialog.js","webpack:///./src/react-components/rename-room-dialog.js","webpack:///./src/react-components/close-room-dialog.js","webpack:///./src/react-components/webrtc-screenshare-unsupported-dialog.js","webpack:///./src/react-components/webvr-recommend-dialog.js","webpack:///./src/react-components/room-info-dialog.js","webpack:///./src/react-components/oauth-dialog.js","webpack:///./src/react-components/lobby-chat-box.js","webpack:///./src/react-components/chat-command-help.js","webpack:///./src/utils/serialize-element.js","webpack:///./src/react-components/presence-list.js","webpack:///./src/react-components/chat-message.js","webpack:///./src/react-components/in-world-chat-box.js","webpack:///./src/react-components/avatar-editor.js","webpack:///./src/react-components/photo-message.js","webpack:///./src/react-components/image-message.js","webpack:///./src/react-components/presence-log.js","webpack:///./src/systems/tips.js","webpack:///./src/react-components/settings-menu.js","webpack:///./src/react-components/2d-hud.js","webpack:///./src/utils/vr-interstitial.js","webpack:///./src/react-components/ui-root.js","webpack:///./src/utils/hub-channel.js","webpack:///./src/message-dispatch.js","webpack:///./src/scene-entry-manager.js","webpack:///./src/utils/pinned-entity-to-gltf.js","webpack:///./src/subscriptions.js","webpack:///./src/systems/personal-space-bubble.js","webpack:///./src/systems/userinput/devices/mouse.js","webpack:///./src/systems/userinput/array-backed-set.js","webpack:///./src/systems/userinput/devices/keyboard.js","webpack:///./src/systems/userinput/devices/hud.js","webpack:///./src/systems/userinput/devices/xbox-controller.js","webpack:///./src/systems/userinput/pose.js","webpack:///./src/systems/userinput/arm-model.js","webpack:///./src/systems/userinput/devices/copy-sitting-to-standing-transform.js","webpack:///./src/systems/userinput/devices/oculus-go-controller.js","webpack:///./src/systems/userinput/devices/gear-vr-controller.js","webpack:///./src/systems/userinput/devices/oculus-touch-controller.js","webpack:///./src/systems/userinput/devices/daydream-controller.js","webpack:///./src/systems/userinput/devices/vive-controller.js","webpack:///./src/systems/userinput/devices/windows-mixed-reality-controller.js","webpack:///./src/systems/userinput/devices/gyro.js","webpack:///./src/systems/userinput/devices/app-aware-mouse.js","webpack:///./src/systems/userinput/devices/touchscreen/assignments.js","webpack:///./src/systems/userinput/devices/app-aware-touchscreen.js","webpack:///./src/systems/userinput/bindings/xforms.js","webpack:///./src/utils/dpad.js","webpack:///./src/systems/userinput/bindings/utils.js","webpack:///./src/systems/userinput/bindings/keyboard-mouse-user.js","webpack:///./src/systems/userinput/bindings/touchscreen-user.js","webpack:///./src/systems/userinput/bindings/keyboard-debugging.js","webpack:///./src/systems/userinput/bindings/oculus-touch-user.js","webpack:///./src/systems/userinput/bindings/vive-user.js","webpack:///./src/systems/userinput/bindings/windows-mixed-reality-user.js","webpack:///./src/systems/userinput/bindings/xbox-controller-user.js","webpack:///./src/systems/userinput/bindings/daydream-user.js","webpack:///./src/systems/userinput/bindings/cardboard-user.js","webpack:///./src/systems/userinput/bindings/oculus-go-user.js","webpack:///./src/systems/userinput/resolve-action-sets.js","webpack:///./src/systems/userinput/devices/gamepad.js","webpack:///./src/systems/userinput/bindings/generic-gamepad.js","webpack:///./src/systems/userinput/userinput.js","webpack:///./src/systems/camera-mirror.js","webpack:///./src/systems/userinput/userinput-debug.js","webpack:///./src/systems/ui-hotkeys.js","webpack:///./src/systems/interactions.js","webpack:///./src/systems/cursor-targetting-system.js","webpack:///./src/systems/constraints-system.js","webpack:///./src/systems/two-point-stretching-system.js","webpack:///./src/systems/button-systems.js","webpack:///./src/systems/hover-menu-system.js","webpack:///./src/systems/super-spawner-system.js","webpack:///./src/systems/haptic-feedback-system.js","webpack:///./src/systems/hubs-systems.js","webpack:///./src/components/scalable-when-grabbed.js","webpack:///./src/components/cursor-controller.js","webpack:///./src/components/tools/pen.js","webpack:///./src/utils/sharedbuffergeometry.js","webpack:///./src/utils/sharedbuffergeometrymanager.js","webpack:///./src/components/tools/networked-drawing.js","webpack:///./src/network-schemas.js","webpack:///./src/hub.js","webpack:///./src/utils/concurrent-load-detector.js","webpack:///./src/utils/threejs-allocation-patches.js","webpack:///./src/constants.js","webpack:///./src/materials/MobileStandardMaterial.js","webpack:///./src/components/gltf-model-plus.js","webpack:///./src/utils/name-generation.js","webpack:///./src/utils/phoenix-utils.js","webpack:///./src/utils/scene-graph.js","webpack:///./src/assets/images/hub-preview-light-no-shadow.png","webpack:///./src/utils/media-highlight-frag.glsl","webpack:///./src/assets/images/cubemap/posx.jpg","webpack:///./src/assets/images/cubemap/negx.jpg","webpack:///./src/assets/images/cubemap/posy.jpg","webpack:///./src/assets/images/cubemap/negy.jpg","webpack:///./src/assets/images/cubemap/posz.jpg","webpack:///./src/assets/images/cubemap/negz.jpg","webpack:///./src/App.js","webpack:///./src/assets/stylesheets/sign-in-dialog.scss","webpack:///./src/assets/stylesheets/hub.scss","webpack:///./src/components/virtual-gamepad-controls.css","webpack:///./src/assets/stylesheets/ui-root.scss","webpack:///./src/assets/stylesheets/entry.scss","webpack:///./src/assets/stylesheets/invite-dialog.scss","webpack:///./src/assets/stylesheets/client-info-dialog.scss","webpack:///./src/assets/stylesheets/loader.scss","webpack:///./src/components/environment-map.js","webpack:///./src/assets/stylesheets/profile.scss","webpack:///./src/assets/stylesheets/avatar-preview.scss","webpack:///./src/assets/stylesheets/media-browser.scss","webpack:///./src/assets/stylesheets/create-object-dialog.scss","webpack:///./src/assets/stylesheets/change-scene-dialog.scss","webpack:///./src/assets/stylesheets/avatar-url-dialog.scss","webpack:///./src/assets/stylesheets/link-dialog.scss","webpack:///./src/assets/stylesheets/rename-room-dialog.scss","webpack:///./src/assets/stylesheets/close-room-dialog.scss","webpack:///./src/assets/stylesheets/room-info-dialog.scss","webpack:///./src/assets/stylesheets/oauth-dialog.scss","webpack:///./src/assets/stylesheets/message-entry.scss","webpack:///./src/assets/stylesheets/chat-command-help.scss","webpack:///./src/assets/stylesheets/presence-log.scss","webpack:///./src/assets/stylesheets/presence-list.scss","webpack:///./src/assets/stylesheets/avatar-editor.scss","webpack:///./src/assets/stylesheets/settings-menu.scss","webpack:///./src/assets/stylesheets/2d-hud.scss","webpack:///./src/react-components/sign-in-dialog.js","webpack:///./src/systems/userinput/paths.js","webpack:///./src/systems/sound-effects-system.js","webpack:///./src/utils/auto-box-collider.js","webpack:///./src/utils/webgl.js","webpack:///./src/utils/disable-ios-zoom.js","webpack:///./src/react-components/dialog-container.js","webpack:///./src/utils/animation.js","webpack:///./src/react-components/avatar-preview.js","webpack:///./src/utils/logging.js","webpack:///./src/components/animation.js","webpack:///./src/components/animation-mixer.js","webpack:///./src/components/audio-feedback.js","webpack:///./src/components/loop-animation.js","webpack:///./src/components/skybox.js","webpack:///./src/utils/qs_truthy.js","webpack:///./src/utils/i18n.js","webpack:///./src/utils/component-mappings.js","webpack:///./src/gltf-component-mappings.js","webpack:///./src/utils/mask-email.js","webpack:///./src/utils/auth-channel.js","webpack:///./src/assets/LoadingObject_Atom.glb","webpack:///./src/assets/sfx/teleport-loop.mp3","webpack:///./src/assets/sfx/quickTurn.mp3","webpack:///./src/assets/sfx/tap_mellow.mp3","webpack:///./src/assets/sfx/PenSpawn.mp3","webpack:///./src/assets/sfx/PenDraw1.mp3","webpack:///./src/assets/sfx/PicSnapHey.mp3","webpack:///./src/assets/sfx/welcome.mp3","webpack:///./src/assets/sfx/quack.mp3","webpack:///./src/assets/sfx/specialquack.mp3","webpack:///./src/assets/sfx/pop.mp3","webpack:///./src/assets/sfx/Eb_blip.mp3","webpack:///./src/assets/sfx/tack.mp3","webpack:///./src/assets/sfx/A_bendUp.mp3","webpack:///./src/assets/sfx/suspense.mp3","webpack:///./src/assets/waternormals.jpg","webpack:///./src/assets/images/hub-preview-white.png","webpack:///./src/utils/crypto.js","webpack:///./src/utils/link-channel.js","webpack:///./src/utils/identity.js","webpack:///./src/storage/store.js","webpack:///./src/assets/avatars/avatars.js","webpack:///./src/utils/debug-log.js","webpack:///./src/utils/focus-utils.js","webpack:///./src/utils/material-utils.js","webpack:///./src/utils/threejs-world-update.js","webpack:///./src/components/ambient-light.js","webpack:///./src/components/css-class.js","webpack:///./src/components/duck.js","webpack:///./src/components/heightfield.js","webpack:///./src/components/hemisphere-light.js","webpack:///./src/components/hide-when-quality.js","webpack:///./src/components/point-light.js","webpack:///./src/components/scene-preview-camera.js","webpack:///./src/object-types.js","webpack:///./src/components/spot-light.js","webpack:///./src/components/floaty-object.js","webpack:///./src/components/trigger-volume.js","webpack:///./src/components/video-pause-state.js","webpack:///./src/components/debug.js","webpack:///./src/systems/nav.js","webpack:///./src/components/event-repeater.js","webpack:///./src/telemetry.js","webpack:///./src/react-components/wrap-with-audio.js","webpack:///./src/utils/resizeShadowCameraFrustum.js","webpack:///./src/components/directional-light.js","webpack:///./src/components/layers.js","webpack:///./src/components/media-loader.js","webpack:///./src/components/quack.js","webpack:///./src/components/spawn-controller.js","webpack:///./src/components/super-spawner.js","webpack:///./src/utils/async-utils.js","webpack:///./src/components/water.js","webpack:///./src/utils/next-tick.js","webpack:///./src/assets/images/logo.svg","webpack:///./src/assets/images/mic_denied.png","webpack:///./src/assets/images/mic_denied@2x.png","webpack:///./src/assets/images/mobile_screen_entry.svg","webpack:///./src/assets/images/giphy_logo.png","webpack:///./src/utils/three-utils.js","webpack:///./src/utils/media-utils.js","webpack:///./src/assets/images/media-error.gif","webpack:///./src/assets/camera_tool.glb","webpack:///./src/assets/images/mic_granted.png","webpack:///./src/assets/images/mic_granted@2x.png","webpack:///./src/assets/images/level_background.png","webpack:///./src/assets/images/level_background@2x.png","webpack:///./src/assets/images/level_fill.png","webpack:///./src/assets/images/level_fill@2x.png","webpack:///./src/assets/images/mic_level.png","webpack:///./src/assets/images/mic_level@2x.png","webpack:///./src/assets/images/level_action_background.png","webpack:///./src/assets/images/level_action_background@2x.png","webpack:///./src/assets/images/level_action_fill.png","webpack:///./src/assets/images/level_action_fill@2x.png","webpack:///./src/assets/images/speaker_level.png","webpack:///./src/assets/images/speaker_level@2x.png","webpack:///./src/assets/images/mic_small.png","webpack:///./src/assets/images/mic_small@2x.png","webpack:///./src/assets/images/dropdown_arrow.png","webpack:///./src/assets/images/dropdown_arrow@2x.png","webpack:///./src/assets/images/warning_icon.png","webpack:///./src/assets/images/warning_icon@2x.png","webpack:///./src/assets/images/desktop_screen_entry.svg","webpack:///./src/assets/images/generic_vr_entry.svg","webpack:///./src/assets/images/gearvr_entry.svg","webpack:///./src/assets/images/daydream_entry.svg","webpack:///./src/assets/images/device_entry.svg","webpack:///./src/assets/images/link_dialog_header.svg","webpack:///./src/assets/images/presence_phone.png","webpack:///./src/assets/images/presence_desktop.png","webpack:///./src/assets/images/presence_discord.png","webpack:///./src/assets/images/presence_vr.png","webpack:///./src/assets/images/change_avatar.svg","webpack:///./src/assets/sfx/tone.webm","webpack:///./src/assets/sfx/tone.mp3","webpack:///./src/assets/sfx/tone.ogg","webpack:///./src/assets/sfx/tone.wav"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","6","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","pushOrUpdateHistory","history","replace","k","v","detail","newPathname","newSearch","state","newLength","location","__historyLength","_objectSpread","__duplicate","pathname","undefined","search","isDuplicate","method","pushHistoryState","replaceHistoryState","pushHistoryPath","path","clearHistoryState","popToBeginningOfHubHistory","navigateToPriorPage","len","Promise","resolve","unsubscribe","listen","go","sluglessPath","split","join","withSlug","SOURCES","URL_SOURCE_TO_TO_API_SOURCE","scenes","images","videos","youtube","gifs","sketchfab","poly","twitch","MEDIA_SOURCE_DEFAULT_FILTERS","SEARCH_CONTEXT_PARAMS","MediaSearchStore","EventTarget","constructor","super","_defineProperty","this","async","dispatchEvent","CustomEvent","urlSource","getUrlMediaSource","previousSource","urlParams","URLSearchParams","requestIndex","currentRequestIndex","searchParams","param","set","source","navigator","languages","singular","startsWith","APP","store","credentialsAccountId","url","getReticulumFetchUrl","toString","lastSavedUrl","_fetchMedia","nextCursor","meta","next_cursor","lastFetchedUrl","qsTruthy","entries","avatars","map","_legacyAvatarToSearchEntry","headers","Content-Type","credentialsToken","credentials","token","authorization","res","fetch","body","text","JSON","parse","e","legacyAvatar","id","type","preview","thumbnail","width","height","gltfs","avatar","model","delta","goBack","filter","query","delete","keepSource","keepNav","_stashedParams","_stashedSource","q","_sourceNavigate","hideNav","useLastStashedParams","currentQuery","getSearchClearedSearchParams","useValue","hasAccountWithAvatars","_hasAccountWithAvatars","process","document","host","substring","stashLastSearchParams","_stashLastSearchParams","hasMediaPath","setHistory","_update","__webpack_exports__","showFullScreenIfAvailable","showFullScreenIfWasFullScreen","screenfull__WEBPACK_IMPORTED_MODULE_0__","screenfull__WEBPACK_IMPORTED_MODULE_0___default","hasEnteredFullScreenThisSession","AFRAME","utils","device","isMobile","isMobileVR","isIOS","screenfull","enabled","request","isFullscreen","addEventListener","ctx","THREE","AudioContext","getContext","resume","setTimeout","removeEventListener","PositionalAudio","updateMatrixWorld","position","Vector3","quaternion","Quaternion","scale","orientation","force","Object3D","setInitial","_lastPosition","_lastOrientation","_lastListenerPosition","panner","listener","context","matrixWorld","decompose","applyQuaternion","Math","abs","x","Number","EPSILON","y","z","positionX","positionY","positionZ","setPosition","setOrientation","registerComponent","schema","unmutedBoneName","default","mutedBoneName","onPos","offPos","init","onStateToggled","el","unmutedBone","object3D","getObjectByName","mutedBone","modelLoaded","updateMuteState","play","sceneEl","pause","muted","is","matrixNeedsUpdate","tick","visible","lastVisible","updateMatrices","interactorOneTransform","interactorTwoTransform","cursorController","enableSweepingEffect","uniforms","boundingSphere","Sphere","sweepParams","remove","boundingBox","time","isPinned","components","pinnable","pinned","isSpawner","isFrozen","hideDueToPinning","interactorOne","interactorTwo","interaction","systems","leftHand","hovered","held","options","entity","rightRemote","rightHand","toArray","worldY","elements","scaledRadius","radius","uniform","hubs_EnableSweepingEffect","hubs_IsFrozen","hubs_SweepParams","hubs_HighlightInteractorOne","hubs_InteractorOnePos","hubs_HighlightInteractorTwo","hubs_InteractorTwoPos","hubs_Time","hand","handleLeftVisuals","handleRightVisuals","hideVisualEffectOnElement","interactingElement","hideVisual","target","offset","on","selfDestruct","updateOffset","QUARTER_CIRCLE","PI","offsetVector","obj","copy","localToWorld","parent","worldToLocal","getWorldQuaternion","rotateOnAxis","removeAttribute","TWOPI","head","lookCutoff","animRange","yawCutoff","onChildHovered","removeHoverEvents","isYLocked","lockedHeadPositionY","lookDir","lookEuler","Euler","hoverableChildren","querySelectorAll","hud","pitch","rotation","RAD2DEG","yawDif","a","b","deltaAngle","forceHudVisible","activity","hasHoveredInWorldHud","clamp","hudLocked","hudOutOfView","add","DEG2RAD","update","image","hoverImage","activeImage","activeHoverImage","active","tooltip","tooltipText","activeTooltipText","onHover","hovering","updateButtonState","onHoverOut","setAttribute","querySelector","textHoverColor","textColor","backgroundHoverColor","backgroundColor","textEl","noop","dependencies","getObject3D","raycast","createImageBitmap","disposeImageBitmap","srcUrl","Blob","URL","createObjectURL","canvas","createElement","putImageData","toDataURL","img","src","imageBitmap","HTMLImageElement","revokeObjectURL","close","onClick","block","owner","NAF","getNetworkedEntity","then","networkedEl","networked","clientId","hubChannel","hide","mute","[object Object]","emit","kick","updateVisibility","permissions","canOrWillIfCreator","left_hand_pose","right_hand_pose","_fireEvents","oldData","isMine","pinStateChanged","changed","currentScale","dur","from","to","easing","delay","wasHeld","targetEl","takeOwnership","modifyGravityOnRelease","gravity","angularDamping","linearDamping","linearSleepingThreshold","angularSleepingThreshold","activate","parentNode","removeChild","track","selector","cameraSystem","myCamera","getMyCamera","focus","isVisible","getAttribute","shouldBeVisible","labelSelector","_updateUI","_isMirrored","labelEl","unmirror","mirror","getMirroredCameraEl","isMirrored","onStateChange","newOwner","multiple","transform","oneof","event","stateadded","stateremoved","userinput","requireOwnership","speed","angle","targetPos","snappedRot","snappedQ","snappedXForm","Matrix4","snappedXFormWorld","tempVector","dt","_applyMaskedTargetRotation","applyMatrix4","started","order","setFromEuler","compose","multiplyMatrices","_updateMatrixAutoUpdate","matrixAutoUpdate","template","dirs","dim","onFrozenStateChange","getHoverMenu","applyHoverState","menuPromise","menu","appendChild","importNode","content","children","animate","object3DMap","mesh","material","color","setScalar","traverse","frustumCulled","camera","currentActiveCamera","activeCameraEl","setActiveCamera","classList","matrix","matrixIsModified","playhead","poseIndex","overflow","poses","timestamp","isHandCollisionTarget","isHoldable","offersHandConstraint","offersRemoteConstraint","singleActionButton","holdableButton","isPen","isHoverMenuChild","didUpdateOnce","console","warn","invert","updateComponentState","inVRMode","componentName","class","registerSystem","can","permissionName","fetchPermissions","onBlur","onFocus","onTimeout","onEnterVR","isOculusBrowser","userAgent","match","enteredVR","lastTimeoutCheck","exitTimeout","clearTimeout","cameraEls","register","_onOwnershipChange","deregister","avatarUpdated","forEach","onAvatarUpdated","find","registry","Map","queues","frameIndex","schedule","func","queue","has","unschedule","idx","indexOf","counter","_syncCounterRegistration","isHeld","timestamps","performance","now","COLLISION_LAYERS","require","setBodyKinematic","didThisOnce","collisionFilterMask","UNOWNED_INTERACTABLE","locked","max","clear","count","size","_destroyOldest","oldestEl","minTs","MAX_VALUE","ts","_destroy","teleporters","queryCollisionEntities","_onComponentInitialized","drawingToPen","drawingEl","drawing","createDrawing","getDrawing","pen","returnDrawing","promisifyWorker","worker","nextItemId","outstanding","onmessage","msg","err","handlers","error","reject","Error","transfer","promise","postMessage","payload","bindAllEvents","events","f","unbindAllEvents","eventSrc","toggleEvents","muteEvents","unmuteEvents","onToggle","onMute","onUnmute","connection","adapter","soundEffectsSystem","playSoundOneShot","SOUND_TOGGLE_MIC","enableMicrophone","removeState","addState","mic","spawn","cameraBtn","inviteBtn","background","renderOrder","RENDER_ORDER","HUD_ICONS","HUD_BACKGROUND","updateButtonStates","evt","onMicClick","onSpawnClick","onPenClick","SOUND_SPAWN_PEN","onCameraClick","onInviteClick","onEnterVr","onExitVr","onFirstInteraction","onMoveJoystickChanged","onMoveJoystickEnd","onLookJoystickChanged","onLookJoystickEnd","mockJoystickContainer","styles","leftMock","mockJoystick","leftMockSmall","inner","rightMock","rightMockSmall","leftTouchZone","touchZone","left","leftStick","nipplejs","zone","fadeTime","rightTouchZone","right","rightStick","inVr","moving","rotating","moveEvent","axis","rotateYEvent","rotateXEvent","off","joystick","radian","cos","sin","style","display","AVATAR_TYPES","LEGACY","SKINNABLE","legacyAvatarIds","getAvatarType","avatarId","fetchAvatar","resp","status","json","fetchAvatarGltfUrl","gltf_url","getAvatarSrc","proxiedUrlFor","getAvatarGltfUrl","leftController","rightController","LEGACY_HAND_ROTATIONS","makeRotationFromEuler","HAND_ROTATIONS","leftEye","rightEye","neck","chest","hips","rotationSpeed","alwaysUpdate","_runScheduledWork","_updateIsInView","flipY","makeRotationY","cameraForward","headTransform","hipsPosition","invHipsToHeadVector","middleEyeMatrix","middleEyePosition","invMiddleEyeToHead","cameraYRotation","cameraYQuaternion","invHipsQuaternion","headQuaternion","rootToChest","invRootToChest","ikRoot","findIKRoot","isInView","hasConvergedHips","lastCameraTransform","cameraMirrorSystem","playerCamera","addVectors","divideScalar","makeTranslation","getInverse","negate","root","updateMatrix","hasNewCameraTransform","equals","forceIkUpdate","setFromMatrixPosition","setFromRotationMatrix","slerp","epsilon","u","w","inverse","premultiply","handRotations","avatarType","updateHand","handRotation","handObject3D","controllerObject3D","isLeft","handMatrix","spaceInvader","handHiddenByPersonalSpace","invading","multiply","frustum","Frustum","frustumMatrix","cameraWorld","isInViewOfCamera","screenCamera","pos","projectionMatrix","matrixWorldInverse","setFromMatrix","containsPoint","mirrorCamera","getWorldPosition","POSES","pose","poseForFingers","thumb","index","middleRingPinky","subpath","paths","actions","previous","current","PI_2","groundAcc","pivot","snapRotationDegrees","fly","navGroup","navNode","velocity","accelerationInput","pendingSnapRotationMatrix","angularVelocity","_withinWarningLimit","_warningCount","setAccelerationInput","snapRotateLeft","snapRotateRight","setAngularVelocity","leftRotationMatrix","rightRotationMatrix","reset","identity","axes","SOUND_SNAP_ROTATE","teleportTo","rig","deltaFromHeadToTargetForHead","targetForHead","targetForRig","targetWorldPosition","sub","pathfinder","nav","getGroup","_setNavNode","clampStep","move","trans","transInv","pivotPos","rotationAxis","yawMatrix","rotationMatrix","rotationInvMatrix","pivotRotationMatrix","pivotRotationInvMatrix","startPos","startScale","deltaSeconds","distance","rotationDelta","acc","characterAcceleration","makeRotationAxis","updateVelocity","boost","lengthSq","setPositionOnNavMesh","_warnWithWarningLimit","getClosestNode","start","end","zones","dvx","dvz","avatarSrc","displayName","communityIdentifier","applyProperties","updateDisplayName","applyDisplayName","isLocalPlayerInfo","playerSessionId","networkedEntity","getCreator","playerPresence","presence","updateDisplayNameFromPresenceMeta","metas","sessionId","presenceMeta","isModerator","roles","moderator","profile","nametagEl","communityIdentifierEl","modelEl","injectCustomShaderChunks","open","thumbDown","indexDown","mrpDown","thumbUp","point","fist","pinch","NETWORK_POSES","animatePose","mixerEl","findAncestorWithComponent","suffix","mixer","clipAction","getNetworkedAvatar","networkedAvatar","parentEl","prev","curr","stop","fadeOut","fadeIn","setHandPose","toggleEvent","scene","ensureFrozen","thaw","toggleFreeze","hasFoundFreeze","frozen","SOUND_FREEZE","SOUND_THAW","withinDistance","requireHoverOnNonMobile","camWorldPos","objWorldPos","cam","hoverableSearch","hoverable","shouldNotBeVisible","isWithinDistance","getLastWorldPosition","distanceToSquared","isTransforming","transforming","toggle","onExpand","onCollapse","stats","threeStats","renderer","aframeStats","plugins","rStats","css","values","fps","caption","below","groups","createStats","statsEl","statsHeaderEl","statsTitleEl","innerHTML","collapseEl","insertBefore","firstChild","fpsEl","lastFpsUpdate","lastFps","frameCount","inVR","frame","round","show","ONCE_TRUE","once","TYPE_IMG_PNG","parseGIF","GIFWorker","VOLUME_LABELS","GIFTexture","Texture","frames","delays","disposals","_ctx","generateMipmaps","isVideoTexture","minFilter","NearestFilter","frameStartTime","Date","clearRect","drawImage","needsUpdate","createVideoTexture","contentType","videoEl","autoplay","preload","crossOrigin","createVideoEl","texture","VideoTexture","LinearFilter","encoding","sRGBEncoding","streamClientId","stream","getMediaStream","srcObject","MediaStream","getVideoTracks","isHLS","HLS","isSupported","corsProxyPrefix","CORS_PROXY_SERVER","baseUrl","hls","xhrSetup","xhr","buildAbsoluteURL","loadSource","attachMedia","Events","ERROR","fatal","ErrorTypes","NETWORK_ERROR","startLoad","MEDIA_ERROR","recoverMediaError","canPlayType","onerror","hasResolved","resolveOnce","poll","videoHeight","videoWidth","scaleToAspectRatio","ratio","min","textureLoader","TextureLoader","disposeTexture","HTMLVideoElement","video","load","destroy","dispose","setCrossOrigin","textureCache","cache","retain","cacheItem","release","errorImage","Image","errorImageSrc","errorTexture","timeFmt","floor","h","magFilter","onload","volume","loop","audioType","hidePlaybackControls","distanceModel","rolloffFactor","refDistance","maxDistance","coneInnerAngle","coneOuterAngle","coneOuterGain","videoPaused","projection","tickRate","syncTolerance","onPauseStateChange","tryUpdateVideoPlaybackState","updateSrc","seekForward","seekBack","volumeUp","volumeDown","snap","changeVolumeBy","togglePlaying","lastUpdate","videoMutedAt","localSnapCount","isSnapping","onSnapImageLoaded","hoverMenu","playbackControls","playPauseButton","volumeUpButton","volumeDownButton","seekForwardButton","seekBackButton","snapButton","timeLabel","volumeLabel","updateVolumeLabel","updateHoverMenuBasedOnLiveState","updatePlaybackState","getNetworkOwner","random","audioListener","AudioListener","cameraEl","videoIsLive","currentTime","SOUND_CAMERA_TOOL_TOOK_SNAPSHOT","blob","toBlob","file","File","spawnMediaAround","paused","audio","gain","_playbackStateChangeTimeout","catch","cleanUp","audioSource","createMediaElementSource","setDistanceModel","setRolloffFactor","setRefDistance","setMaxDistance","Audio","setNodeSource","setObject3D","updateLiveState","levels","currentLevel","details","live","LEVEL_SWITCHED","duration","Infinity","getElementById","MeshBasicMaterial","geometry","SphereBufferGeometry","PlaneBufferGeometry","side","DoubleSide","Mesh","volumeMod","cursor","mediaVolumeMod","removeObject3D","disconnect","includes","arrayBuffer","rawImageData","delayTimes","loadCnt","createGIFTexture","statusText","transparent","format","RGBAFormat","sound","touchscreen","pinchDelta","degToRad","radToDeg","minPitch","maxPitch","yaw","onRotateX","pendingXRotation","look","deltaPitch","deltaYaw","cameraDelta","lookX","lookY","HALF_PI","THREE_HALF_PI","forward","back","zero","dir","halfExtent","_updateBox","_setupTarget","halfExtents","opening","wasVisible","scaleChanged","previousScaleX","previousScaleY","previousScaleZ","isAnimating","targetPosition","pointOnBoxFace","pointOnBoxFaceToCamera","boxCenter","tempParentWorldScale","boxFaceNormal","forceNewExtents","box","getBox","clone","multiplyScalar","targetSquareDistance","targetDir","targetHalfExtentStr","targetHalfExtent","targetRotation","targetCameraDot","halfExtentStr","subVectors","normalize","cameraAngleDotBoxNormal","dot","squareDistance","setFromMatrixScale","sqrt","targetScale","finalScale","tipSelector","hideWhenPinnedSelector","_updateUIOnStateChange","tipEl","onHovered","onUnhovered","wasPinned","SOUND_PIN","_discordBridges","presences","channels","discordBridges","Array","channel","fileIsOwned","fileId","canPin","getPromotionTokenForFile","hideEl","mediaVideo","xMin","xMax","yMin","yMax","zMin","zMax","_checkForDestroy","cameraModelPromise","GLTFLoader","cameraModelSrc","pathsMap","player-right-controller","takeSnapshot","player-left-controller","snapCanvas","enableCameraViewport","previewFPS","imageWidth","imageHeight","renderTarget","WebGLRenderTarget","depth","stencil","PerspectiveCamera","updateRenderTargetNextTick","aspect","screen","selfieScreen","takeSnapshotNextTick","unmirrorCameraAtEl","trackTarget","lookAt","mirrorCameraAtEl","playerHead","heldLeftHand","heldRightHand","heldRightRemote","grabberId","grabPath","grabberPaths","tock","tempHeadScale","headEl","playerHud","hudEl","playerHudWasVisible","tmpVRFlag","vr","tmpOnAfterRender","onAfterRender","setRenderTarget","render","snapPixels","Uint8Array","readRenderTargetPixels","pixels","imageData","createImageData","bitmap","pixelsToPNG","objectType","ObjectTypes","CAMERA","guessContentType","resize","addMedia","ObjectContentOrigins","label","isHubsSceneUrl","isHubsRoomUrl","href","AMMO_BODY_ATTRIBUTES","HANDS","TRANSFORM_MODE","AXIS","PUPPET","CURSOR","ALIGN","SCALE","STEP_LENGTH","CAMERA_WORLD_QUATERNION","CAMERA_WORLD_POSITION","TARGET_WORLD_QUATERNION","v2","q2","onGrabStart","transformSystem","startTransform","onGrabEnd","stopTransform","dxStore","dxApplied","dyAll","dyStore","dyApplied","puppet","initialControllerOrientation","initialControllerOrientation_inverse","initialObjectOrientation","currentControllerOrientation","controllerOrientationDelta","planarInfo","plane","wireframe","opacity","normal","intersections","previousPointOnPlane","currentPointOnPlane","deltaOnPlane","finalProjectedVec","startPlaneCasting","raycaster","far","sign","sign2","dxAll","hasScaled","hasRotated","hasRecentered","puppetingTick","cursorAxisOrScaleTick","cameraToPlaneDistance","intersection","projectOnPlane","modify","transformModifier","setFromAxisAngle","scaleFactor","newScale","FORWARD","TWO_PI","RayCurve","numPoints","BufferGeometry","vertices","Float32Array","uvs","addAttribute","BufferAttribute","setDynamic","drawMode","TriangleStripDrawMode","direction","parabolicCurve","p0","v0","out","setDirection","UP","cross","setWidth","setPoint","posA","posB","attributes","checkLineIntersection","meshes","referenceNormal","landingMaxAngle","hitPoint","intersects","intersectObjects","collisionNormal","angleNormals","angleTo","isValidNormalsAngle","face","LANDING_NORMAL","vecHelper","confirm","collisionEntities","hitCylinderColor","hitCylinderRadius","outerRadius","hitCylinderHeight","isTeleporting","rayCurve","teleportEntity","parabola","hit","Raycaster","rigWorldPosition","newRigWorldPosition","teleportOriginWorldPosition","teleportEventDetail","oldPosition","newPosition","prevHitHeight","hitEntity","createHitEntity","stopPlayingTeleportSound","teleportingSound","stopSoundNode","sfx","timeTeleporting","playSoundLoopedWithGain","SOUND_TELEPORT_START","characterController","SOUND_TELEPORT_END","collidedIndex","timeSegment","percentToDraw","segmentT","hitEntityOpacity","easeOutIn","dRadii","outerScale","easeIn","outerTorus","torus","cylinder","className","primitive","radiusTubular","segmentsRadial","segmentsTubular","shader","depthTest","segmentsHeight","openEnded","sets","detect","browser","VR_DEVICE_AVAILABILITY","yes","no","maybe","GENERIC_ENTRY_TYPE_DEVICE_BLACKLIST","getAvailableVREntryTypes","ua","isSamsungBrowser","test","isWebVRCapableBrowser","hasNativeWebVRImplementation","isDaydreamCapableBrowser","isIDevice","isFirefoxBrowser","isUIWebView","mediaDevices","safari","isCardboardCapableBrowser","displays","getVRDisplays","generic","cardboard","gearvr","isMaybeGearVRCompatibleDevice","daydream","isMaybeDaydreamCompatibleDevice","capabilities","canPresent","StateLink","React","Component","props","defaultPrevented","button","metaKey","altKey","ctrlKey","shiftKey","isModifiedEvent","preventDefault","stateKey","stateValue","stateDetail","innerRef","react_default","handleClick","ref","PropTypes","bool","string","node","StateRoute","_this$props","routeProps","_objectWithoutProperties","es_Route","_extends","ClientInfoDialog","args","client_info_dialog_defineProperty","avatarThumbnailUrl","performConditionalSignIn","onClose","unhide","getPresenceProfile","componentDidMount","files","getAvatarThumbnailUrl","setState","title","mayKick","mayMute","isHidden","dialog_container","client_info_dialog_extends","clientInfoDialog","wide","roomInfo","clientProfileImage","clientActionButtons","index_es","cancel","Loader","loader_defineProperty","loadingNum","loadedNum","doneWithInitialLoad","loadingTimeout","tryFinishLoading","environmentSceneLoaded","onLoaded","onObjectLoading","onObjectLoaded","componentWillUnmount","nomore","loaderStyles","loadingText","progress","usual","locale","lang","messages","hub_preview_light_no_shadow_default","finished","AutoExitWarning","secondsRemaining","wrap_with_audio","onCancel","propTypes","number","EntryButton","cx","entryButton","entryButtonSecondary","secondary","iconSrc","icon","contents","prefixMessageId","bolded","mediumMessageId","subtitle","isInHMD","TwoDEntryButton","entryButtonProps","MobileScreenEntryImg","DesktopScreenEntryImg","GenericEntryButton","GenericVREntryImg","DaydreamEntryButton","DaydreamEntryImg","SafariEntryButton","DeviceEntryButton","DeviceEntryImg","ProfileEntryPanel","profile_entry_panel_defineProperty","avatarGltfUrl","newState","getStateFromProfile","hasChangedName","hasChangedNowOrPreviously","hasAcceptedProfile","stopPropagation","entry","storeUpdated","nameInput","setAvatarFromMediaResult","formatMessage","intl","profileEntry","onSubmit","saveStateAndFinish","form","classNames","darkened","htmlFor","displayNameOverride","formFieldText","handleTextFieldFocus","handleTextFieldBlur","onChange","required","spellCheck","pattern","SCHEMA","definitions","properties","inp","chooseAvatar","mediaSearchStore","sourceNavigateWithNoNav","avatar_preview","state_link","hideDelete","returnToProfile","editAvatar","react_fontawesome_index_es","faPencilAlt","formSubmit","links","rel","logo","hubLogo","injectIntl","PUBLISHER_FOR_ENTRY_TYPE","sketchfab_model","poly_model","twitch_stream","PRIVACY_POLICY_LINKS","DEFAULT_FACETS","params","MediaBrowser","media_browser_defineProperty","facets","showNav","selectNextResult","clearStashedQueryOnClose","getStoreAndHistoryState","selectEntry","inputRef","getUrlSource","suggestions","forceNow","_sendQueryTimeout","filterQueryNavigate","lucky_query","handleQueryUpdated","onMediaSearchResultEntrySelected","sourceNavigate","facet","pushExitMediaBrowserHistory","isSceneApiType","isAvatarApiType","dialog","clearStashedQuery","pageNavigate","browserDiv","scrollTop","isImage","isAvatar","imageAspect","clientWidth","innerWidth","imageSrc","creator","attributions","endsWith","getTileDimensions","publisherName","publisher","tile","handleEntryClicked","tileLink","tileContent","avatarTile","scaledThumbnailUrlFor","info","attribution","faExternalLinkAlt","sourceChanged","hasMeta","hasNext","hasPrevious","apiSource","isVariableWidth","showCustomOption","createTileWidth","createTileHeight","hideSearch","handleCustomClicked","showCustomMediaDialog","mediaBrowser","header","noSearch","headerLeft","faTimes","headerCenter","faSearch","autoFocus","placeholder","onKeyDown","trim","blur","engineAttribution","engineAttributionContents","headerRight","createButton","faLink","faCloudUploadAlt","createLink","handleSourceClicked","navSource","navSourceSelected","navRightPad","navScrollArrow","faAngleRight","handleFacetClicked","tiles","tilesVariable","createTile","faPlus","entryToTile","pager","previousPage","pagerButtonDisabled","handlePager","faAngleLeft","pageNumber","page","nextPage","attributionHostnames","giphy.com","giphyLogo","media.giphy.com","DEFAULT_OBJECT_URL","instructions","references","mobileInstructions","desktopInstructions","lastUrl","fileInputId","CreateObjectDialog","create_object_dialog_defineProperty","fileName","attributionImage","validity","valid","hostname","fileInput","onCreate","other","create_object_dialog_objectWithoutProperties","cancelButton","smallButton","cancelIcon","uploadButton","uploadIcon","faPaperclip","filenameLabel","leftSideOfInput","urlInput","onUrlChange","create_object_dialog_extends","onCreateClicked","addMediaForm","hideFileInput","onFileChange","inputBorder","buttons","actionButton","ChangeSceneDialog","change_scene_dialog_defineProperty","onChangeClicked","changeSceneForm","spokeCreate","spokeLaunch","AvatarUrlDialog","avatar_url_dialog_defineProperty","avatarUrlDialog","HelpDialog","help_dialog_extends","textAlign","share","opts","tweetLink","encodeURIComponent","InviteDialog","invite_dialog_defineProperty","copyButtonActive","shareButtonActive","link","entryCode","entryCodeString","num","pad","shortLinkText","hubId","shortLink","modal","isModal","attachPoint","hubLinkLink","code","digit","domain","readOnly","select","linkButton","copyClicked","allowShare","shareClicked","enterVrButton","InviteTeamDialog","invite_team_dialog_defineProperty","inviteButtonText","requestSupport","invite_team_dialog_extends","inviteClicked","LinkDialog","linkCode","codeLoadingPanel","imageHeader","LinkDialogHeader","keepOpen","closeButton","SafariDialog","safari_dialog_defineProperty","copyLinkButtonText","onCopyClicked","copyLinkClicked","safari_dialog_extends","SafariMicDialog","safari_mic_dialog_extends","reload","RenameRoomDialog","rename_room_dialog_defineProperty","onRename","rename_room_dialog_extends","renameRoomForm","autoComplete","nameField","nextButton","CloseRoomDialog","close_room_dialog_extends","message","confirmButton","onConfirm","WebRTCScreenshareUnsupportedDialog","webrtc_screenshare_unsupported_dialog_extends","flexDirection","alignItems","fontSize","WebVRRecommendDialog","webvr_recommend_dialog_extends","RoomInfoDialog","toAttributionDiv","attributionName","attributionAuthor","author","hubName","room_info_dialog_extends","sceneScreenshot","screenshot_url","sceneDetails","sceneMain","sceneName","sceneCreator","sceneAttributions","sceneButtons","OAuthDialog","oauth_dialog_extends","privacyNotice","oauthButtons","oauthInfo","oauthButton","oauthTypeName","array","LobbyChatBox","lobby_chat_box_defineProperty","pendingMessage","onSendMessage","textRows","pendingMessageTextareaHeight","pendingMessageFieldHeight","discordSnippet","ch","occupantSnippet","occupantCount","messageEntryPlaceholder","sendMessage","messageEntry","messageEntryDisabled","messageEntryInput","rows","disabled","messageEntryButton","messageEntrySubmit","faPaperPlane","ChatCommandHelp","commandHelp","commandHelpOnTop","onTop","matchingPrefix","command","defaultStylesByTagName","noStyleTags","BASE","HEAD","HTML","META","NOFRAME","NOSCRIPT","PARAM","SCRIPT","STYLE","TITLE","tagNames","computeDefaultStyleByTagName","tagName","defaultStyle","element","computedStyle","getComputedStyle","warmSerializeElement","navigateToClientInfo","currentParams","PresenceList","presence_list_defineProperty","mobile","PhoneImage","hmd","HMDImage","discord","DiscordImage","DesktopImage","getPresenceImage","isBot","badge","moderatorBadge","row","listItem","self","clientLink","presenceList","domForPresence","signIn","signedIn","maskEmail","email","onSignOut","onSignIn","messageCanvas","emojiRegex","urlRegex","messageBodyDom","fromSessionId","multiLine","wrapStyle","messageWrapMulti","messageWrap","mono","messageBodyClasses","messageBody","messageBodyMulti","messageBodyMono","includeClientLink","onFromClick","words","outWords","word","wordWrap","cleanedBody","messageSource","messageSourceLink","Linkify_default","toEmojis","renderChatMessage","allowEmojiRender","lowResolution","isOneLine","emoji","isEmoji","presenceLog","presenceLogSpawn","entryDom","presenceLogEntry","presenceLogEntryOneLine","presenceLogEmoji","ReactDOM","objectScale","offsetWidth","offsetHeight","xhtml","keys","nodeType","Node","ELEMENT_NODE","TypeError","cssTexts","toUpperCase","cssText","ii","cssPropName","outerHTML","serializeElement","spawnChatMessage","ChatMessage","maySpawn","iconButton","spawnMessage","InWorldChatBox","in_world_chat_box_defineProperty","messageEntryInRoom","messageEntryOnMobile","chat_command_help_ChatCommandHelp","accept","onObjectCreated","messageEntryButtonInRoom","messageEntryUpload","faCamera","messageEntryInputInRoom","messageEntrySpawn","AVATARS_API","BOT_PARENT_AVATAR","AvatarEditor","avatar_editor_defineProperty","parent_avatar_id","previewGltfUrl","creatorAttribution","assign","inputFiles","base_gltf_url","fetchReticulumAuthenticated","avatar_id","glb","gltfLoader","gltfUrl","onProgress","log","parser","createParser","extensions","KHR_binary_glTF","gltf","bin","snapshot","filesToUpload","uploading","fileUploads","all","upload","avatar_editor_objectSpread","file_id","access_token","promotion_token","reduce","createOrUpdateAvatar","onSave","checked","debug","avatarEditor","textField","textarea","fileField","mapField","checkbox","avatar_editor_extends","uploadAvatar","confirmDelete","deleteAvatar","PhotoMessage","landingPageUrl","getLandingPageForPhoto","onShareClicked","mediaBody","ImageMessage","spawnImage","PresenceLog","presence_log_defineProperty","entryClasses","presenceLogEntryWithButton","presenceLogChat","expired","oldName","newName","media","presenceClasses","presenceLogInRoom","inRoom","domForEntry","LOCAL_CLOSE_TIPS","localStorageCache","finishedScopes","tipPlatform","platformTips","desktop","top","bottom","standalone","isTipFinished","tip","localStorage","getItem","markTipFinished","storeData","setItem","stringify","handleTipClose","fullTip","scope","tips","resetTips","resetTipActivityFlags","resetConfirmedDiscordRooms","VALIDATORS","activeSets","cursorHoldingPen","touchCameraDelta","smartMouse","locomotion","accel","turning","spawn_menu","mediaCounter","freeze_gesture","cursorHoldingInteractable","cursorHoveringOnInteractable","menu_hover","invite","cursorHoldingCamera","object_grab","object_rotate_button","object_scale_button","object_recenter_button","object_pin","hasPinned","object_zoom","modDelta","object_scale","scaleGrabbedGrabbable","pen_color","penNextColor","penPrevColor","pen_size","scalePenTip","pen_mode","freeze_mode","video_share_mode","mirror_mode","mute_mode","activeTips","_finishedScopes","_performStep","_userinput","_mediaCounter","prevTop","prevBottom","chosenTip","finishCount","SettingsMenu","rowClasses","settingsRow","rowHeader","showRoomSettings","showCloseRoom","showRoomInfo","hubScene","showRoomSection","settingsMenu","change_avatar_default","hideSettings","faImage","listItemLink","faDoorClosed","faInfoCircle","bottomLinksMain","bottomLinks","bottomLink","TopHUD","_2d_hud_defineProperty","showVideoShareOptions","lastActiveMediaSource","videoShareMediaSource","onEndShareVideo","onShareVideo","onShareVideoNotCapable","videoShareExtraOptionTypes","primaryVideoShareType","showExtrasOnHover","hideVideoSharingButtonTimeout","videoShare","handleVideoShareClicked","onMouseOver","videoShareExtraOptions","onMouseOut","videoSharingButtons","buildVideoSharingButtons","activeTip","topTip","container","unselectable","uiStyles","uiInteractive","panel","onToggleMute","sourceNavigateToDefaultSource","isCursorHoldingPen","onSpawnPen","hasActiveCamera","onSpawnCamera","onToggleFreeze","react_components_2d_hud","_isIn2DInterstitial","_exitAction","afterUserGesturePrompt","handleExitTo2DInterstitial","isLower","exitAction","exitVR","vrNotice","handleReEntryToVRFrom2DInterstitial","exit","enterVR","avatarEditorDebug","addLocaleData","en","HMD_MIC_REGEXES","IN_ROOM_MODAL_ROUTER_PATHS","IN_ROOM_MODAL_QUERY_VARS","LOBBY_MODAL_ROUTER_PATHS","LOBBY_MODAL_QUERY_VARS","LOBBY_MODAL_QUERY_VALUES","isMobilePhoneOrVR","AUTO_EXIT_TIMER_SECONDS","toneClip","webmTone","mp3Tone","oggTone","wavTone","UIRoot","ui_root_defineProperty","enterInVR","muteOnEntry","entered","showInviteDialog","showPresenceList","showSettingsMenu","discordTipDismissed","linkCodeCancel","miniInviteActivated","didConnectToNetworkedScene","noMoreLoadingUpdates","hideLoader","waitingOnAudio","shareScreen","requestedScreen","mediaStream","audioTrack","numAudioTracks","toneInterval","tonePlaying","micLevel","micDevices","micUpdateInterval","profileNamePending","autoExitTimerStartedAt","autoExitTimerInterval","secondsRemainingBeforeAutoExit","spacebubble","exited","signInMessageId","authChannel","signInCompleteMessageId","signInContinueTextId","onContinueAfterSignIn","showNonHistoriedDialog","SignInDialog","authComplete","startAuthentication","authStarted","continueText","onContinue","isSubscribed","subscriptions","sceneLoaded","mediaSource","updateSubscribedState","forcedVREntryType","enterDaydream","enter2D","testToneTimeout","disableAutoExitOnConcurrentLoad","setInterval","secondsSinceStart","checkForAutoExit","endAutoExitTimer","reason","exitScene","clearInterval","enumerateDevices","kind","grantedMicLabels","hasGrantedMicPermissions","setMediaStreamToDefault","beginOrSkipAudioSetup","performDirectEntryFlow","availableVREntryTypes","constraints","deviceId","exact","ev","fetchAudioTrack","setupNewMediaStream","hasAudio","lastUsedMicDeviceId","settings","ideal","getUserMedia","getAudioTracks","fetchMicDevices","addTrack","webkitAudioContext","micLevelAudioContext","micSource","createMediaStreamSource","analyser","createAnalyser","fftSize","frequencyBinCount","connect","getByteTimeDomainData","level","micLevelMovingAverage","average","movingAverage","micDeviceId","micDeviceIdForMicLabel","micLabelForMediaStream","entry_step","onAudioReadyButton","hasHmdMicrophone","selectedMicLabel","enterScene","stopTestTone","onFinished","linkChannel","generateCode","updateScene","ui_root_objectSpread","DialogClass","closeDialog","signOut","confirmedDiscordRooms","interstitial","onInterstitialPromptClicked","roomUnavailableReason","platformUnsupportedReason","exitSubtitleId","logo_default","hasPush","serviceWorker","promptForNameAndAvatarBeforeEntry","hubIsBound","entryStyles","entryPanel","editButton","infoButton","roomSubtitle","center","lobbyLabel","chooseScene","lobby_chat_box","subscribe","onSubscribeChanged","initialIsSubscribed","buttonContainer","wideButton","handleForceEntry","faArrowLeft","audioLoader","attemptLink","showSafariDialog","screenSharing","setStateAndRequestScreen","granted","onMicGrantButton","mic_granted_default","srcSet","mic_granted_2x_default","mic_denied_default","mic_denied_2x_default","micClip","clip","speakerClip","subtitleId","level_background_default","level_background_2x_default","level_fill_default","level_fill_2x_default","mic_level_default","mic_level_2x_default","playTestTone","level_action_background_default","level_action_background_2x_default","level_action_fill_default","level_action_fill_2x_default","speaker_level_default","speaker_level_2x_default","selectedMicDeviceId","micDeviceChanged","mic_small_default","mic_small_2x_default","dropdown_arrow_default","dropdown_arrow_2x_default","shouldShowHmdMicWarning","warning_icon_default","warning_icon_2x_default","overlay","showSafariMicDialog","safari_mic_dialog_SafariMicDialog","closable","exitEventHandler","componentDidUpdate","prevProps","showSignInDialog","showContextualSignInDialog","willCompileAndUploadMaterials","requestAnimationFrame","isBotMode","compileAndUploadMaterials","onConcurrentLoad","MovingAverage","onSceneLoaded","onAframeStateChanged","onShareVideoEnabled","onShareVideoDisabled","onStoreChanged","action","audioContext","playSound","onMouseLeave","isExited","isLoading","rootStyles","ui","ui-root","in-modal-or-overlay","isInModalOrOverlay","showOAuthDialog","oauth_dialog_OAuthDialog","renderExitedPane","react_components_loader","onLoadingFinished","showInterstitialPrompt","renderInterstitialPrompt","renderBotMode","entryDialog","isWaitingForAutoExit","auto_exit_warning","state_route","renderDevicePanel","renderMicPanel","renderAudioSetupPanel","renderEntryStartPanel","dialogBoxContentsClassNames","uiDialogBoxContents","backgrounded","showVREntryButton","presenceLogEntries","showMediaBrowser","hasTopTip","clientInfoClientId","getClientInfoClientId","showClientInfo","showDiscordTip","getPresenceProfileForSession","Provider","profile_entry_panel","ui_root_extends","avatar_editor_AvatarEditor","react_components_media_browser","renderDialog","rename","closeHub","createObject","changeScene","setAvatarUrl","client_info_dialog_ClientInfoDialog","uiDialog","presence_log_PresenceLog","bottomTip","tipCancel","splitTip","splitTipIcon","confirmDiscordBridge","in_world_chat_box","leaveButton","inviteStyles","inviteContainer","inviteContainerBelowHud","inviteContainerInverted","inviteButton","hideSmallScreens","toggleInviteDialog","onMiniInviteClicked","inviteMiniButton","enterButton","invite_dialog_InviteDialog","hubEntryCode","link_dialog_LinkDialog","settingsInfo","settingsInfoSelected","faBars","presenceInfo","presenceInfoSelected","faUsers","presence_list_PresenceList","settings_menu_SettingsMenu","topHud","toggleMute","onToggleSpaceBubble","toggleSpaceBubble","spawnPen","shareVideo","endShareVideo","showWebRTCScreenshareUnsupportedDialog","nagCornerButton","isSupportAvailable","MS_PER_DAY","MS_PER_MONTH","isSameMonth","da","db","getFullYear","getMonth","HUB_CREATOR_PERMISSIONS","HubChannel","hub_channel_defineProperty","Presence","_permissions","jwtDecode","nextRefresh","exp","entryDisplayType","vrDisplay","isPresenting","initialOccupantCount","initialOccupants","entryEvent","hub_channel_objectSpread","getEntryTimingFlags","entryTimingFlags","isNewDaily","isNewMonthly","isNewDayWindow","isNewMonthWindow","storedLastEnteredAt","lastEnteredAt","lastEntered","msSinceLastEntered","getDate","isSameDay","spawnEvent","object_type","update_hub","close_hub","subscription","receive","creatorAssignmentTokenEntry","creatorAssignmentTokens","creatorAssignmentToken","creator_assignment_token","_getCreatorAssignmentToken","perms_token","setPermissionsFromToken","_signedIn","gltfNode","fileAccessToken","promotionToken","gltf_node","file_access_token","permsToken","session_id","_blockedSessionIds","unblock","entities","completeSync","socket","Set","permission","presenceBindings","onJoin","caller","onLeave","onSync","migrateChannelToSocket","DUCK_URL","MessageDispatch","entryManager","addToPresenceLog","remountUI","message_dispatch_defineProperty","commandParts","dispatchCommand","activeElement","playerRig","scales","curScale","physicsSystem","SOUND_SPECIAL_QUACK","SOUND_QUACK","physics","setDebug","isDebug","qs","SceneEntryManager","scene_entry_manager_defineProperty","whenSceneLoaded","_entered","session","verbose","_setupPlayerRig","_setupBlocking","_setupKicking","_setupMedia","_setupCamera","_spawnAvatar","SOUND_ENTER_SCENE","_runBot","setLocalMediaStream","nextTick","sendEntryEvent","toISOString","callback","hasLoaded","localMediaStream","getTracks","setAnimationLoop","_setPlayerInfoFromProfile","avatarScale","parseInt","resetToRandomLegacyAvatar","kickedClientId","persistent","_unpinElement","removeEntity","removeEntitiesOfClient","networkId","storedPromotionToken","gltfComponents","HUBS_components","equalArray","every","translation","mediaSrc","pageIndex","pinnedEntityToGltf","pin","_signInAndPinOrUnpinElement","_pinElement","_disableSignInOnPinAction","mediaLoader","unpin","spawnMediaInfrontOfPlayer","contentOrigin","or","currentVideoShareEntity","FILE","sendObjectSpawnedEvent","matches","clipboardData","getData","CLIPBOARD","dataTransfer","isHandlingVideoShare","shareVideoMediaStream","newStream","frameRate","removeTrack","audioEl","audioInput","dataInput","getAudio","crossorigin","onchange","getRecording","recording","captureStream","mozCaptureStream","INIT_TIMEOUT_MS","urlBase64ToUint8Array","base64String","base64","repeat","rawData","atob","outputArray","charCodeAt","Subscriptions","subscriptions_defineProperty","registration","vapidPublicKey","_isSubscribed","startedAt","pushManager","convertedVapidKey","permissionState","userVisibleOnly","applicationServerKey","getSubscription","endpoint","pushSubscription","has_remaining_subscriptions","invaderPos","bubblePos","createSphereGizmo","WireframeGeometry","line","LineSegments","invaders","bubbles","registerBubble","bubble","unregisterBubble","registerInvader","invader","unregisterInvader","updateDebug","setInvading","tempInvasionFlags","distanceSquared","radiusSum","meshName","targetMesh","useMaterial","invadingOpacity","findInvaderMesh","radiusSquared","forEachMaterial","system","modeMod","WheelEvent","DOM_DELTA_PIXEL","DOM_DELTA_LINE","DOM_DELTA_PAGE","isInModal","uiRoot","contains","MouseDevice","coords","movementXY","buttonLeft","buttonRight","wheel","queueEvent","deltaX","deltaY","deltaMode","clientX","clientY","innerHeight","movementX","movementY","write","setVector2","mouse","setValueType","ArrayBackedSet","initialItems","items","item","pop","oncontextmenu","KeyboardDevice","seenKeys","nodeName","toLowerCase","keyboard","HudDevice","penButton","XboxControllerDevice","gamepad","buttonMap","buttonId","axisMap","axisId","getGamepads","connected","xbox","pressed","touched","hapticActuators","haptics","actuators","Pose","fromOriginAndDirection","origin","setFromUnitVectors","fromCameraProjection","normalizedX","normalizedY","unproject","EYES_TO_ELBOW","FOREARM","applyArmModel","controllerEuler","deltaControllerPosition","controllerQuaternion","controllerPosition","gamepadPose","headObject3D","userHeight","applyAxisAngle","up","fromArray","setFromQuaternion","applyEuler","copySittingToStandingTransform","stageParameters","sittingToStandingTransform","ONES","TOUCHPAD","oculusgo","touchpad","TRIGGER","trigger","OculusGoControllerDevice","rayObjectRotation","sittingToStandingMatrix","rayObject","axisX","axisY","rayMatrixWorld","setPose","setMatrix4","gearVRController","TOUCHPAD_X","TOUCHPAD_Y","GearVRControllerDevice","leftOculusTouchButtonMap","rightOculusTouchButtonMap","LEFT_HAND_OFFSET","RIGHT_HAND_OFFSET","OculusTouchControllerDevice","buttonMaps","devicePaths","leftOculusTouch","rightOculusTouch","handOffset","HAND_OFFSET","POSE","MATRIX","DaydreamControllerDevice","RAY_ROTATION","ViveControllerDevice","vive","WindowsMixedRealityControllerDevice","wmr","grip","CircularBuffer","fill","writePtr","difference","sum","GyroDevice","hmdEuler","hmdQuaternion","prevX","prevY","dXBuffer","dYBuffer","hasPolyfill","webvrpolyfill","getPolyfillDisplays","frameData","VRFrameData","getFrameData","dX","dY","averageDeltaX","averageDeltaY","gyro","calculateCursorPose","cursorPose","AppAwareMouseDevice","prevButtonLeft","clickedOnAnything","prevCursorPose","prevOrigin","prevDirection","rawIntersections","cursorTargettingSystem","targets","touchIsAssigned","touch","assignments","assignment","identifier","jobIsAssigned","job","unassign","findIndex","findByJob","findByTouch","MOVE_CURSOR_JOB","MOVE_CAMERA_JOB","FIRST_PINCHER_JOB","SECOND_PINCHER_JOB","TAP_PATHS","tap1","tap2","tap3","tap4","tap5","x1","y1","x2","y2","dx","dy","getPlayerCamera","AppAwareTouchscreenDevice","initialDistance","currentDistance","pendingTap","maxTouchCount","tapIndexToWriteNextFrame","framesUntilGrab","framesUntilUnassign","second","first","cameraMover","isFirstTouch","isSecondTouch","isThirdTouch","hasSecondPinch","setFromCamera","shouldMoveCursor","cursorJob","previousAssignment","changedTouches","touches","hasCursorJob","hasCameraJob","isTouching","isTouchingGrabbable","xforms","dest","scalar","scaleExp","pow","deadzone","deadzoneSize","split_vec2","compose_vec2","copyIfFalse","copyIfTrue","zeroIfDefined","true","rising","prevState","risingWithFrameDelay","falling","vec2Zero","_","poseFromCameraProjection","vec2dpad","deadzoneRadius","invertX","invertY","deadzoneRadiusSquared","atan2","always","constValue","wasd_to_vec2","vec2","add_vec2","max_vec2","normalize_vec2","any","touch_axis_scroll","snap_to","touching","addSetsToBindings","mapping","setName","binding","togglePenWithP","togglePenWithHud","keyboardMouseUserBindings","global","xform","exitMirror","priority","toggleCamera","muteMic","focusChat","focusChatCommand","mediaExit","mediaSearch1","mediaSearch2","mediaSearch3","mediaSearch4","mediaSearch5","mediaSearch6","mediaSearch7","mediaSearch8","logDebugFrame","logInteractionState","startGazeTeleport","stopGazeTeleport","startDrawing","stopDrawing","undoDrawing","drop","cursorHoldingUI","grab","cursorHoveringOnVideo","inputFocused","cursorHoveringOnUI","touchscreenUserBindings","cursorHoveringOnPen","keyboardDebuggingBindings","leftButton","leftAxis","leftPose","rightButton","rightAxis","rightPose","rightGripRisingGrab","lowerButtons","leftGripPressed1","leftGripPressed2","rightGripPressed1","rightGripPressed2","leftTriggerPressed1","leftTriggerPressed2","rightTriggerPressed1","rightTriggerPressed2","oculusTouchUserBindings","north","south","east","west","override","stopTeleport","leftHandHoveringOnNothing","startTeleport","cursorHoveringOnNothing","leftHandHoveringOnInteractable","leftHandHoldingInteractable","leftHandHoveringOnPen","leftHandHoldingPen","rightHandHoveringOnInteractable","rightHandHoldingInteractable","rightHandHoveringOnPen","rightHandHoldingPen","cursorHoveringOnCamera","rightHandHoveringOnCamera","leftHandHoveringOnCamera","rightHandHoldingCamera","leftHandHoldingCamera","rightHandHoveringOnNothing","lButton","lAxis","lPose","lJoy","lJoyScaled","lJoyXScaled","lJoyYScaled","lDpadNorth","lDpadSouth","lDpadEast","lDpadWest","lDpadCenter","lTriggerFallingStopDrawing","lGripFallingStopDrawing","lTriggerRisingGrab","lGripRisingGrab","lTouchpadRising2","lTouchpadRising1","lCharacterAcceleration","leftBoost","rButton","rAxis","rPose","rJoy","rDpadNorth","rDpadSouth","rDpadEast","rDpadWest","rDpadCenter","rDpadCenterStrip","rTouchpadRising","rTouchpadFalling","rightBoost","rTriggerRisingGrab","rGripRisingGrab","cursorDrop1","cursorDrop2","rHandDrop1","rHandDrop2","rTriggerStopTeleport","rTouchpadStopTeleport","ensureFrozenViaDpad","ensureFrozenViaKeyboard","thawViaDpad","thawViaKeyboard","rSnapRight","rSnapLeft","keyboardSnapRight","keyboardSnapLeft","keyboardCharacterAcceleration","wasd_vec2","arrows_vec2","keyboardBoost","leftTouchpadPressed1","leftTouchpadPressed2","leftTouchpadFallingStopTeleport","leftTriggerFallingStopTeleport","leftGripFallingWhileHoldingPen","viveUserBindings","rightHandTeleporting","leftHandTeleporting","lGripPressed","rGripPressed","rTriggerPressed","rJoyNorth","rGripRising","rTriggerRising","rGripFalling","rTriggerFalling","dpadVariables","padWest","padEast","padNorth","padSouth","padCenter","padCenterStrip","dpadBindings","neverFrozenBinding","penBindings","forCursor","padY","triggerPressed","padPressed","padTouched","padRising","padCenterStripTouched","handPoseBindings","gripPressed","holdingCameraBindings","wmrUserBindings","leftPadPressed","rightPadPressed","leftPadFalling","rightPadFalling","keyboardSaceFalling","freezeBindings","rJoyWest","rJoyEast","rJoyWestRising","rJoyEastRising","keyboardQRising","keyboardERising","teleportationAndRotationBindings","lJoyXDeadzoned","lJoyYDeadzoned","characterAccelerationBindings","cursorMediaVolumeModBindings","rPadNorthOrSouth","rPadNorthOrSouthPressed","rPadNorthOrSouthPressedY","cursorModDeltaBindings","xboxControllerUserBindings","cursorScalePenTip","touchpadRising","touchpadFalling","touchpadPressed","dpadNorth","dpadSouth","dpadEast","dpadWest","dpadCenter","brushSizeDelta","cursorModDelta","dpadSouthDrop","dpadCenterDrop","grabBinding","dropOnCenterOrSouth","daydreamUserBindings","cardboardUserBindings","generate3DOFTriggerBindings","touchpadButton","triggerButton","touchpadX","touchpadXForPen","touchpadY","touchpadYForPen","triggerRising","triggerFalling","dpadCenterStrip","dpadBottomCenterStrip","togglePen","dropBinding","leftTeleporter","rightTeleporter","GamepadDevice","buttonPath","gamepadBindings","oculusGoUserBindings","gearVRControllerUserBindings","satisfiesPath","satisfyPath","bindings","satisfiedBy","canMask","masker","masked","maskerKey","maskerPath","maskedKey","isActive","toggleSet","pendingSetChanges","generation","generations","mat4","prevActiveSets","xformStates","activeDevices","registeredMappings","registeredMappingsChanged","vrGamepadMappings","nonVRGamepadMappings","updateBindingsForVRMode","activeDevice","gamepadConnected","gamepadDevice","tick2","prevSortedBindings","sortedBindings","mappings","unsorted","sorted","dependencySort","masks","masksRow","bindingsRow","col","computeMasks","teleporter","tags","leftHandHoveringOnVideo","rightHandHoveringOnVideo","resolveActionSets","activeSetsChanged","il","elem","found","jl","arrayContentsDiffer","actives","prevActives","prevMasked","maskedRow","computeExecutionStrategy","bindingExistedLastFrame","oldValue","_onWindowResize","mirrorEl","directRenderFunc","_patchRenderFunc","oldEl","updateProjectionMatrix","setSize","wasVREnabled","userinputFrameStatus","replacer","toFixed","pathsOutput","some","val","textContent","append","sb","logBindings","MEDIA_SEARCH_PATHS","findHandCollisionTargetForHand","driver","numManifolds","dispatcher","getNumManifolds","handPtr","Ammo","getPointer","persistentManifold","getManifoldByIndexInternal","body0ptr","getBody0","body1ptr","getBody1","numContacts","getNumContacts","getContactPoint","getDistance","els","prefix","remoteHoverTargets","updateCursorIntersection","rightRemoteHoverTarget","findRemoteHoverTarget","dropPath","hoverFn","getRightRemoteHoverTarget","spawning","previousState","tickInteractor","lostOwnership","rightHandTeleporter","gazeTeleporter","enableRightRemote","SOUND_HOVER_OR_GRAB","CursorTargettingSystem","setDirty","dirty","observer","MutationObserver","observe","childList","subtree","populateEntities","ACTIVATION_STATE","ConstraintsSystem","prevLeftHand","prevRightHand","prevRightRemote","constraintTag","entityId","hasAnotherConstraint","activationState","ACTIVE_TAG","DISABLE_DEACTIVATION","COLLISION_FILTER_MASK_HANDS","distanceBetweenStretchers","obj1","obj2","distanceTo","TwoPointStretchingSystem","initialScale","leftStretcher","rightStretcher","previousLeftStretcher","previousRightStretcher","stretched","initialStretchDistance","SingleActionButtonSystem","didInteractThisFrame","HoldableButtonSystem","prevHeld","HOVERED","UNHOVERED","HoverButtonSystem","getHoverableButton","prevButton","getSpecificHoverMenu","HoverMenuSystem","findHoverMenu","prevHoverMenu","SuperSpawnerSystem","maybeSpawn","superSpawner","cooldownTimeout","performSpawn","spawnedEntity","SPAWNER","useCustomSpawnPosition","spawnPosition","useCustomSpawnRotation","spawnRotation","useCustomSpawnScale","spawnScale","activateCooldown","centerSpawnedObject","copyState","STRENGTH","DROP","PICKUP","BUTTON_PRESSED","HOVER","STRETCH_BASE","STRETCH_DISTANCE","TELEPORTING","TELEPORTED","determineStrength","HapticFeedbackSystem","twoPointStretchingSystem","didClickButton","leftActuator","rightActuator","leftHandStrength","rightHandStrength","rightRemoteStrength","buttonPressedStrength","stretchingStrength","stretchSystem","stretcherLeft","stretcherRight","leftStrength","rightStrength","pulse","constraintsSystem","singleActionButtonSystem","holdableButtonSystem","hoverButtonSystem","hoverMenuSystem","superSpawnerSystem","hapticFeedbackSystem","SoundEffectsSystem","deltaScale","addScalar","clampScalar","HIGHLIGHT","Color","NO_HIGHLIGHT","TRANSFORM_COLOR_1","TRANSFORM_COLOR_2","near","minDistance","firstHitOnly","lineGeometry","Line","LineBasicMaterial","cameraPos","rightHandPose","isGrabbing","ray","addScaledVector","lerpHSL","posePosition","cursorPosition","positionArray","computeBoundingSphere","drawFrequency","minDistanceBetweenPoints","drawingManager","availableColors","minRadius","maxRadius","timeSinceLastDraw","lastPosition","currentDrawing","worldPosition","colorIndex","grabbed","prevData","_startDraw","SOUND_PEN_START_DRAW","_endDraw","SOUND_PEN_STOP_DRAW","_undoDraw","SOUND_PEN_UNDO_DRAW","penScaleMod","_changeRadius","_changeColor","SOUND_PEN_CHANGE_COLOR","getLastPoint","_getNormal","draw","directionToCamera","crossVectors","startDraw","endDraw","undoDraw","mod","SharedBufferGeometry","primitiveMode","maxBufferSize","geometries","addBuffer","restartPrimitive","addVertex","prevIdx","componentSize","diff","undo","normals","colors","setDrawRange","addColor","g","setXYZ","addNormal","buffer","SharedBufferGeometryManager","sharedBuffers","addSharedBuffer","getSharedBuffer","copyData","fromIndex","toIndex","segments","defaultRadius","maxDrawTimeout","maxLines","maxPointsPerLine","_receiveData","networkBuffer","sendNetworkBufferQueue","drawStarted","lineStarted","remoteLineStarted","receivedBufferParts","bufferIndex","connectedToOwner","networkBufferInitialized","vertexColors","VertexColors","MeshStandardMaterial","sharedBufferGeometryManager","lastPoint","lastSegments","currentSegments","sharedBuffer","vertexCount","networkBufferCount","currentPointCount","invalidPointRead","lastReadPointCount","networkBufferHistory","onConnect","getNetworkId","drawingId","subscribeToDataChannel","unsubscribeToDataChannel","isConnected","hasActiveDataChannel","sendDataGuaranteed","_broadcastDrawing","_drawFromNetwork","_sendNetworkBuffer","_deleteExpiredLines","copyArray","broadcastDataGuaranteed","didWork","pointCount","setHex","_draw","_updateBuffer","drawTime","datum","idxLength","uv","parts","ceil","dataType","_addToNetworkBuffer","getHexString","capNormal","radiusMultiplier","_generateSegments","_drawCylinder","_drawEndCap","_endLine","_addDegenerateTriangle","_restartPrimitive","_drawCap","_pushToNetworkBuffer","_drawPoint","projectedDirection","projectedPoint","clock","elapsedTime","copyDirection","copyNormal","setLength","getHex","_addVertex","down","segmentIndex","segment","segmentsList","angleIncrement","_rotatePointAroundAxis","calculatedDirection","registerNetworkSchemas","vectorRequiresUpdate","almostEqualVec3","schemas","component","requiresNetworkUpdate","BUILD_VERSION","patchWebGLRenderingContext","App","DefaultMatrixAutoUpdate","quality","AmmoWasm","locateFile","firstSyncSource","isTelemetryDisabled","loadingEnvironmentURL","registerTelemetry","disableiOSZoom","instanceKey","started_at","onStorageEvent","detectConcurrentLoad","uiProps","routerBaseName","createBrowserHistory","basename","userinputSets","Router","Route","react_components_ui_root","hub_objectSpread","hub_isBotMode","hub_store","hub_mediaSearchStore","mountUI","updateUIForHub","hub","hub_id","entry_code","updateEnvironmentForHub","sceneUrl","isLegacyBundle","environmentScene","model_url","defaultSpaceTopic","topics","glbAsset","assets","asset_type","bundleAsset","hasExtension","baseURL","LoaderUtils","extractUrlBase","environmentEl","childNodes","useCache","inflate","traverseMeshesAndAddShapes","Cache","moveToSpawnPoint","detectedOS","detectOS","ready","setRegistration","setRegistrationFailed","initialized","gl","texImage2D","compressedTexImage2D","patchThreeAllocations","AuthChannel","predicate","messageId","onFailure","actionError","LinkChannel","handleEarlyVRMode","getVRDisplay","chatFocusTarget","RTCDataChannelEvent","buildNumber","getReticulumMeta","reticulumMeta","phx_host","version","pool","onFirstEnvironmentLoad","previewCamera","reorder","setupLobbyCamera","enterSceneWhenLoaded","runBotMode","addAnimationComponents","connectToReticulum","retDeployReconnectInterval","retPhxChannel","setVapidPublicKey","vapid_public_key","pushSubscriptionEndpoint","getCurrentEndpoint","oauthFlowPermsToken","Cookies","createHubChannelParams","push_subscription_endpoint","auth_token","deployNotification","ret_version","ret_pool","tryReconnect","invalidateReticulumMeta","oldSocket","migrateToSocket","setSocket","teardown","migrateToNewReticulumServer","hubPhxChannel","SOUND_CHAT_MESSAGE","messageDispatch","isInitialJoin","setPhoenixChannel","session_token","vrHudPresenceCount","sendProfileUpdate","__hadInitialSync","isSelf","currentMeta","setClientId","setJoinToken","setHubChannel","setSubscribed","web_push","hub_requires_oauth","hubs","objectsScene","objectsUrl","objectsEl","dispatch","onMediaSearchCancelled","connectToScene","room","serverURL","newHostPollInterval","setReconnectionListeners","currentServerURL","serverUrl","newServerURL","getHost","sendViaPhoenix","reliable","isOpen","connectionState","reliableTransport","unreliableTransport","connectError","isFull","handleHubChannelJoined","oauth_info","onData","incomingMessage","userInfo","getAuthor","meshEntity","blobUrl","isRawProperty","meshMaterial","createInWorldLogMessage","stale_fields","titleParts","oldSlug","slug","entry_mode","ALL","NONE","INTERACTABLES","ENVIRONMENT","AVATAR","DEFAULT_INTERACTABLE","DEFAULT_SPAWNER","VERTEX_SHADER","FRAGMENT_SHADER","MobileStandardMaterial","ShaderMaterial","parameters","vertexShader","fragmentShader","uvTransform","Matrix3","diffuse","aoMapIntensity","aoMap","emissive","emissiveMap","fog","lights","skinning","morphTargets","mobileMaterial","fromStandardMaterial","loadGLTF","acceleratedRaycast","GLTFCache","extractZipFile","SketchfabZipWorker","defaultInflator","componentData","isArray","cloneSkinnedMesh","cloneLookup","parallelTraverse","sourceNode","clonedNode","isMesh","boundsTree","sourceMesh","isSkinnedMesh","sourceBones","skeleton","bones","clonedMesh","sourceBone","bindMatrix","getHubsComponents","hubsComponents","userData","gltfExtensions","MOZ_hubs_components","legacyComponents","GLTFModelPlus","componentKey","inflator","inflateEntities","indexToEntityMap","templates","isRoot","modelToWorldScale","childEntities","child","entityComponents","uuid","animations","gltfIndex","attachTemplate","templateRoot","targetEls","cloneNode","_ref","preferredTechnique","fileMap","loadingManager","LoadingManager","setURLModifier","getCustomGLTFParserURLResolver","materials","MOZ_alt_materials","altMaterialIndex","nodes","extras","mapMaterials","isMeshStandardMaterial","loadTemplates","applySrc","templateEl","firstElementChild","technique","charAt","assetEl","lastSrc","inflatedEl","disposeLastInflatedEl","loadModel","initMixer","hasBufferGeometry","isBufferGeometry","hasBoundsTree","geo","triCount","MeshBVH","strategy","maxDepth","object3DToSet","inflatedEntity","prop","inflateComponents","rewires","environmentMapComponent","applyEnvironmentMap","adjectives","nouns","generateHubName","randItem","createAndRedirectToNewHub","absolute","invalidatedReticulumMetaThisSession","phxHostOverride","getNewSocketUrl","socketProtocol","protocol","socketHost","socketPort","socketUrl","socketSettings","logger","Socket","onError","endPointPath","endPoint","newEndPoint","photoUrl","parsedUrl","retUrl","content-type","sceneId","createUrl","scene_id","default_environment_gltf_bundle_url","Store","oldChannel","topic","pushBuffer","timeout","oldJoinPush","joinPush","recHooks","_storage_store__WEBPACK_IMPORTED_MODULE_0__","_storage_media_search_store__WEBPACK_IMPORTED_MODULE_1__","setQuality","email-field","emailField","next-button","continue-button","continueButton","sign-in-form","signInForm","sign-in-complete","signInComplete","terms","ui-dialog","ui-interactive","presence-info","settings-info","profile-entry","form-submit","nag-corner-button","entry-button-secondary","leave-button","entry-button","entry-panel","button-container","action-button","edit-button","info-button","form-field-text","lobby-label","wide-button","screen-sharing","bottom-tip","loading-text","ui-dialog-box-contents","occupant-count","presence-info-selected","settings-info-selected","tip-cancel","split-tip","split-tip-icon","spawn_menu-icon","spawnMenuIcon","object_rotate_button-icon","objectRotateButtonIcon","object_scale_button-icon","objectScaleButtonIcon","object_recenter_button-icon","objectRecenterButtonIcon","avatar-editor","display-name","choose-avatar","edit-avatar","entry-dialog","room-subtitle","lobby","choose-scene","profile-icon","profileIcon","audio-loader","webvr-link-container","webvrLinkContainer","webvr-link","webvrLink","invite-container","link-button","enter-vr-button","invite-button","enter-button","invite-mini-button","invite-container-inverted","hide-small-screens","invite-container-below-hud","attach-point","keep-open","digit_2","digit2","digit_3","digit3","code-loading-panel","hub-link-link","client-action-buttons","client-info-dialog","community-identifier","client-info","clientInfo","client-profile-image","client-details","clientDetails","client-main","clientMain","createDefaultEnvironmentMap","_utils_material_utils__WEBPACK_IMPORTED_MODULE_0__","_assets_images_cubemap_posx_jpg__WEBPACK_IMPORTED_MODULE_1__","_assets_images_cubemap_posx_jpg__WEBPACK_IMPORTED_MODULE_1___default","_assets_images_cubemap_negx_jpg__WEBPACK_IMPORTED_MODULE_2__","_assets_images_cubemap_negx_jpg__WEBPACK_IMPORTED_MODULE_2___default","_assets_images_cubemap_posy_jpg__WEBPACK_IMPORTED_MODULE_3__","_assets_images_cubemap_posy_jpg__WEBPACK_IMPORTED_MODULE_3___default","_assets_images_cubemap_negy_jpg__WEBPACK_IMPORTED_MODULE_4__","_assets_images_cubemap_negy_jpg__WEBPACK_IMPORTED_MODULE_4___default","_assets_images_cubemap_posz_jpg__WEBPACK_IMPORTED_MODULE_5__","_assets_images_cubemap_posz_jpg__WEBPACK_IMPORTED_MODULE_5___default","_assets_images_cubemap_negz_jpg__WEBPACK_IMPORTED_MODULE_6__","_assets_images_cubemap_negz_jpg__WEBPACK_IMPORTED_MODULE_6___default","urls","cubeMapPosX","cubeMapNegX","cubeMapPosY","cubeMapNegY","cubeMapPosZ","cubeMapNegZ","CubeTextureLoader","RGBFormat","loadDefault","environmentMap","updateEnvironmentMap","envMap","media-browser","header-center","engine-attribution","engine-attribution-contents","no-search","nav-right-pad","nav-source","nav-source-selected","nav-scroll-arrow","tile-link","tile-content","avatar-tile","create-tile","tiles-variable","page-number","pager-button-disabled","header-left","header-right","create-button","create-link","small-button","input-border","left-side-of-input","add-media-form","cancel-icon","upload-icon","hide-file-input","spoke-launch","change-scene-button","changeSceneButton","spoke-create","avatar-url-dialog","close-button","name-field","rename-room-form","cancel-button","confirm-button","room-info","scene-screenshot","scene-details","scene-main","scene-name","scene-creator","scene-attributions","attribution-name","attribution-author","oauth-button","oauth-type-name","oauth-icon","oauthIcon","privacy-notice","oauth-buttons","message-entry-in-room","message-entry-spawn","message-entry-input","message-entry","message-entry-disabled","message-entry-button","message-entry-button-in-room","message-entry-upload","message-entry-input-in-room","message-entry-on-mobile","command-help","presence-log","presence-log-entry","message-body","message-body-multi","message-body-mono","message-wrap","message-wrap-multi","message-source","message-source-link","icon-button","spawn-message","presence-log-entry-with-button","presence-log-in-room","presence-log-spawn","presence-log-entry-one-line","presence-log-emoji","client-link","presence-list","row-header","list-item","list-item-link","sign-in","moderator-badge","bottom-links-main","settings-menu","settings-row","bottom-links","top-tip","column","attach_video_share_mode","attachVideoShareMode","attach_pen_mode","attachPenMode","attach_mute_mode","attachMuteMode","attach_freeze_mode","attachFreezeMode","video-share-extra-options","small","large","video-share","freeze","mobile-media-picker","mobileMediaPicker","share_camera","shareCamera","share_screen","share_window","shareWindow","react__WEBPACK_IMPORTED_MODULE_0___default","react_intl__WEBPACK_IMPORTED_MODULE_2__","_dialog_container__WEBPACK_IMPORTED_MODULE_4__","toggleScreenShare","gyroCameraDelta","gamepadIndex","buttonIndex","axisIndex","buttonName","axisName","wmrController","SOUND_MEDIA_LOADING","SOUND_MEDIA_LOADED","_assets_sfx_tick_mp3__WEBPACK_IMPORTED_MODULE_0__","_assets_sfx_tick_mp3__WEBPACK_IMPORTED_MODULE_0___default","_assets_sfx_teleport_loop_mp3__WEBPACK_IMPORTED_MODULE_1__","_assets_sfx_teleport_loop_mp3__WEBPACK_IMPORTED_MODULE_1___default","_assets_sfx_quickTurn_mp3__WEBPACK_IMPORTED_MODULE_2__","_assets_sfx_quickTurn_mp3__WEBPACK_IMPORTED_MODULE_2___default","_assets_sfx_tap_mellow_mp3__WEBPACK_IMPORTED_MODULE_3__","_assets_sfx_tap_mellow_mp3__WEBPACK_IMPORTED_MODULE_3___default","_assets_sfx_PenSpawn_mp3__WEBPACK_IMPORTED_MODULE_4__","_assets_sfx_PenSpawn_mp3__WEBPACK_IMPORTED_MODULE_4___default","_assets_sfx_PenDraw1_mp3__WEBPACK_IMPORTED_MODULE_5__","_assets_sfx_PenDraw1_mp3__WEBPACK_IMPORTED_MODULE_5___default","_assets_sfx_PicSnapHey_mp3__WEBPACK_IMPORTED_MODULE_6__","_assets_sfx_PicSnapHey_mp3__WEBPACK_IMPORTED_MODULE_6___default","_assets_sfx_welcome_mp3__WEBPACK_IMPORTED_MODULE_7__","_assets_sfx_welcome_mp3__WEBPACK_IMPORTED_MODULE_7___default","_assets_sfx_quack_mp3__WEBPACK_IMPORTED_MODULE_8__","_assets_sfx_quack_mp3__WEBPACK_IMPORTED_MODULE_8___default","_assets_sfx_specialquack_mp3__WEBPACK_IMPORTED_MODULE_9__","_assets_sfx_specialquack_mp3__WEBPACK_IMPORTED_MODULE_9___default","_assets_sfx_pop_mp3__WEBPACK_IMPORTED_MODULE_10__","_assets_sfx_pop_mp3__WEBPACK_IMPORTED_MODULE_10___default","_assets_sfx_Eb_blip_mp3__WEBPACK_IMPORTED_MODULE_11__","_assets_sfx_Eb_blip_mp3__WEBPACK_IMPORTED_MODULE_11___default","_assets_sfx_tack_mp3__WEBPACK_IMPORTED_MODULE_12__","_assets_sfx_tack_mp3__WEBPACK_IMPORTED_MODULE_12___default","_assets_sfx_A_bendUp_mp3__WEBPACK_IMPORTED_MODULE_13__","_assets_sfx_A_bendUp_mp3__WEBPACK_IMPORTED_MODULE_13___default","_assets_sfx_suspense_mp3__WEBPACK_IMPORTED_MODULE_14__","_assets_sfx_suspense_mp3__WEBPACK_IMPORTED_MODULE_14___default","soundEnum","pendingEffects","soundsAndUrls","URL_TICK","URL_TELEPORT_LOOP","URL_QUICK_TURN","URL_TAP_MELLOW","URL_PEN_SPAWN","URL_PEN_DRAW","URL_CAMERA_SNAPSHOT","URL_WELCOME","URL_QUACK","URL_SPECIAL_QUACK","URL_POP","URL_FREEZE","URL_TACK","URL_MEDIA_LOADING","URL_MEDIA_LOADED","loading","audioBufferPromise","decodeAudioData","sounds","audioBuffer","enqueueSound","createBufferSource","destination","playSoundLooped","createGain","getScaleCoefficient","computeObjectAABB","bounds","Box3","makeEmpty","computeBoundingBox","union","boxRoot","isEmpty","matrixWorldNeedsUpdate","dZ","originalGetExtension","WebGLRenderingContext","getExtension","supportsFloatTextures","WebGLRenderer","Scene","dataTexture","DataTexture","FloatType","Camera","getError","checkFloatTextureSupport","detect_browser__WEBPACK_IMPORTED_MODULE_0__","lastTouchAtMs","getTime","isDoubleTouch","DialogContainer","currentTarget","onContainerClicked","_wrap_with_audio__WEBPACK_IMPORTED_MODULE_3__","_fortawesome_react_fontawesome__WEBPACK_IMPORTED_MODULE_5__","isRequired","TEXTURE_PROPS","base_map","emissive_map","normal_map","orm_map","ALL_MAPS","createRenderer","alpha","useDevicePixelRatio","antialias","premultipliedAlpha","preserveDrawingBuffer","powerPreference","gammaOutput","gammaFactor","physicallyCorrectLights","setPixelRatio","devicePixelRatio","createImageBitmapFromURL","ORBIT_ANGLE","DEFAULT_MARGIN","fitBoxInFrustum","margin","halfYExtents","halfVertFOV","fov","tan","AvatarPreview","clientHeight","controls","OrbitControls","enablePan","light","DirectionalLight","HemisphereLight","loadPreviewAvatar","setAvatar","Clock","snapshotCanvas","snapshotCamera","snapshotRenderer","setClearAlpha","previewRenderer","setClearColor","getDelta","parentElement","resetCamera","setFromObject","getCenter","disposeNode","imageBitmaps","oldProps","applyMaps","previewMesh","idleAnimation","AnimationMixer","setLoop","LoopRepeat","idleAnimationAction","getImage","onUpdate","originalMaps","bm","newProps","mapName","applyMap","applyMapToPreview","revertMap","debug__WEBPACK_IMPORTED_MODULE_0__","debug__WEBPACK_IMPORTED_MODULE_0___default","_qs_truthy__WEBPACK_IMPORTED_MODULE_1__","logFilter","enable","anime","animation","colorHelperFrom","colorHelperTo","getComponentProperty","setComponentProperty","splitCache","TYPE_COLOR","STRING_COMPONENTS","STRING_OBJECT3D","toRadians","addEventListeners","eventNames","handler","removeEventListeners","getRawProperty","splitDot","setRawProperty","propertyName","targetValue","elasticity","startEvents","pauseEvents","resumeEvents","eventDetail","attrName","animationIsPlaying","onStartEvent","beginAnimation","pauseAnimation","resumeAnimation","fromColor","toColor","targetsArray","updateConfigForDefault","updateConfigForRawColor","config","complete","createAndStartAnimation","cancelDelayedStart","pausedWasPlaying","updateConfig","delayTimeout","stopRelatedAnimations","waitComponentInitRawProperty","setColorConfig","lastValue","anim","animatables","isBoolean","isNaN","parseFloat","aframeProperty","updateConfigForVector","coordinates","propType","getPropertyType","cb","wait","prevVolume","smoothing","threshold","soundSource","amplitude","currVolume","minScale","maxScale","_playerCamera","_playerCameraWorldPosition","_worldPosition","audioAnalyser","_utils_scene_graph__WEBPACK_IMPORTED_MODULE_0__","updateClip","currentAction","clipName","_utils_qs_truthy__WEBPACK_IMPORTED_MODULE_2__","Sky","SkyShader","UniformsUtils","BackSide","BoxBufferGeometry","luminance","turbidity","rayleigh","mieCoefficient","mieDirectionalG","sunPosition","inclination","azimuth","sky","skyScene","cubeCamera","CubeCamera","theta","phi","vrEnabled","pmremGenerator","PMREMGenerator","pmremCubeUVPacker","PMREMCubeUVPacker","cubeLods","CubeUVRenderTarget","_assets_translations_data_json__WEBPACK_IMPORTED_MODULE_0__","navigatorLang","language","userLanguage","localeData","getSanitizedComponentMapping","inputComponent","inputProperty","publicComponents","publicComponent","publicProperty","publicProperties","mappedComponent","mappedProperty","getMappedValue","PHYSICS_CONSTANTS","TYPE","SHAPE","FIT","decayMigration","range","decay","mediaInflator","isControlled","hasVolume","templateName","isHubsDestinationUrl","mediaOptions","autoPlay","mass","STATIC","collisionFilterGroup","castShadow","shadow","euler","BOX","fit","MANUAL","_componentName","loadMesh","loop-animation","enterComponent","enterProperty","enterValue","leaveComponent","leaveProperty","leaveValue","enterComponentMapping","leaveComponentMapping","targetEntity","colliders","emailParts","emailIdentity","emailDomain","deriveKey","privateKey","publicKey","crypto","subtle","public","publicKeyToString","exportKey","stringToPublicKey","importKey","namedCurve","stringToArrayBuffer","buf","arrayBufferToString","byteLength","String","fromCharCode","LINK_ACTION_TIMEOUT","step","getLetter","readyToSend","leftChannel","leave","incoming","incomingPublicKeyString","iv","incomingPublicKey","keyPair","generateKey","publicKeyString","secret","encryptedData","btoa","encrypt","generatePublicKeyAndEncryptedObject","public_key","target_session_id","reply_to_session_id","generateKeys","numOccupants","base64value","ciphertext","decrypt","decryptObject","names","selectRandom","arr","avatarIds","av","generateDefaultProfile","LOCAL_STORE_KEY","STORE_STATE_CACHE_KEY","OAUTH_FLOW_CREDENTIALS_KEY","validator","Validator","additionalProperties","personalAvatarId","uploadPromotionTokens","$ref","oauthFlowCredentials","getJSON","arrayMerge","destinationArray","sourceArray","mergeOpts","finalState","merge","validate","_qs_truthy__WEBPACK_IMPORTED_MODULE_0__","showLog","debugLog","debugLogInput","debugLogEval","onsubmit","eval","minimized","debugLogMinimize","onclick","scrollHeight","origConsoleLog","origConsoleError","origConsoleWarn","objs","firstObj","stack","shouldScroll","arguments","onunhandledrejection","_fullscreen__WEBPACK_IMPORTED_MODULE_1__","isExitingFullscreenDueToFocus","fn","zeroPos","zeroQuat","oneScale","bindingSetters","PropertyBinding","SetterByBindingTypeAndVersioning","Versioning","setter","MatrixWorldNeedsUpdate","targetObject","getWorldScale","handleMatrixModification","cachedMatrixWorld","applyMatrix","forceLocalUpdate","forceWorldUpdate","skipParents","hasHadFirstMatrixUpdate","childrenNeedMatrixWorldUpdate","includeInvisible","forceChildrenWorldUpdate","q1","m1","isVector3","isCamera","isLight","extractRotation","intensity","AmbientLight","registerLight","rendererSystem","applyColorCorrection","initialForce","maxForce","hasBody","CANNON","Vec3","addComponent","removeComponent","beforeStep","applyForce","generateAndAddHeightfield","shape","mult","cannonOffset","Heightfield","elementSize","addShape","skyColor","groundColor","onQualityChanged","shadowMapResolution","shadowBias","shadowRadius","PointLight","bias","prevWidth","prevHeight","mapSize","lerp","newRot","positionOnly","startPoint","startRotation","targetPoint","targetRotDelta","startTime","backwards","ranOnePass","fromRot","toRot","objectTypeForOriginAndContentType","URL_IMAGE","URL_VIDEO","URL_MODEL","URL_PDF","URL_AUDIO","FILE_IMAGE","FILE_VIDEO","FILE_MODEL","FILE_PDF","FILE_AUDIO","CLIPBOARD_IMAGE","CLIPBOARD_VIDEO","CLIPBOARD_MODEL","CLIPBOARD_PDF","CLIPBOARD_AUDIO","SPAWNER_IMAGE","SPAWNER_VIDEO","SPAWNER_MODEL","SPAWNER_PDF","SPAWNER_AUDIO","UNKNOWN","objectTypeForOrigin","urlType","fileType","clipboardType","spawnerType","objectTypeMimePrefixLookupMap","image/","model/","application/x-zip-compressed","video/","application/vnd.apple.mpegurl","application/x-mpegurl","audio/","application/pdf","srcSuffixLookupMap",".m3u8","innerConeAngle","outerConeAngle","SpotLight","penumbra","autoLockOnLoad","autoLockOnRelease","releaseGravity","reduceAngularFloat","gravitySpeedLimit","onGrab","onRelease","ammoBody","_makeStaticWhenAtRest","linearThreshold","angularThreshold","isAtRest","getLinearVelocity","length2","getAngularVelocity","hasBeenHereBefore","_onBodyLoaded","setLocked","getVelocity","stuckTo","_unstickObject","sizeVec","boundingBoxWorldPositionVec","colliderWorldPositionVec","collidingLastFrame","setFromCenterAndSize","isColliding","videoComponent","onVideoLoaded","origDispatch","firstObject","Pathfinding","Geometry","fromBufferGeometry","setZoneData","createZone","eventSource","eventListeners","_handleEvent","raven_js__WEBPACK_IMPORTED_MODULE_0__","raven_js__WEBPACK_IMPORTED_MODULE_0___default","ga","trackedPage","trackedTitle","sentryDsn","SENTRY_DSN","gaTrackingId","GA_TRACKING_ID","Raven","install","ReactAudioContext","WithHoverSound","react__WEBPACK_IMPORTED_MODULE_0__","prop_types__WEBPACK_IMPORTED_MODULE_1__","prop_types__WEBPACK_IMPORTED_MODULE_1___default","createContext","Consumer","cloneElement","onMouseEnter","frustumBox","inverseLightMatrixWorld","tempBox","FRUSTUM_PADDING","NEAR_CLIPPING_PLANE","FAR_CLIPPING_PLANE","verts","expandByPoint","resizeShadowCameraFrustum","Layers","reflection","inWorldHud","exclusive","layers","mask","layer","newValue","disable","loadingObject","loadingObjectSrc","showLoader","clearLoadingTimeout","onMediaLoaded","updateScale","scaleCoefficient","removeShape","loaderMixer","loadingSoundNode","useFancyLoader","BoxGeometry","loadingClip","loadingScaleClip","AnimationClip","VectorKeyframeTrack","showLoaderTimeout","updateHoverableVisuals","hoverableVisuals","injectedCustomShaderChunks","getBoundingSphere","physicsShape","finish","minHalfExtent","repositionToolbar","addMeshScaleAnimation","onComplete","canonicalUrl","accessibleUrl","resolveUrl","expected_content_type","fetchContentType","raw","qsTime","hash","HULL","mayChangeScene","toolbar","onNext","onPrev","_ensureUI","hasSetupUI","maxIndex","fetchMaxContentIndex","pageLabel","pageSrc","quackPercentage","specialQuackPercentage","_handleGrabStart","rand","playerHeight","loadedEvent","spawnPoints","spawnPoint","spawnCooldown","animateFromCursor","handPosition","onSpawnEvent","tempSpawnHandPosition","willAnimateFromCursor","eventName","eventObj","syncToPhysics","sx","sy","sz","MobileWater","normalSampler","waterNormals","sunDirection","sunColor","waterColor","eye","distortionScale","FrontSide","mirrorShader","UniformsLib","ShaderChunk","Water","forceMobile","waterMesh","waterGeometry","wrapS","wrapT","RepeatWrapping","loadWaterNormals","waterNormalMap","waterConfig","textureWidth","textureHeight","water","setStyle","disposeMaterial","mtrl","lightMap","bumpMap","normalMap","specularMap","materialArray","MeshFaceMaterial","MultiMaterial","_object_types__WEBPACK_IMPORTED_MODULE_0__","_phoenix_utils__WEBPACK_IMPORTED_MODULE_1__","_media_highlight_frag_glsl__WEBPACK_IMPORTED_MODULE_2__","_media_highlight_frag_glsl__WEBPACK_IMPORTED_MODULE_2___default","_material_utils__WEBPACK_IMPORTED_MODULE_3__","nonCorsProxyDomains","mediaAPIEndpoint","commonKnownContentTypes","png","jpg","jpeg","pdf","mp4","mp3","farsparkEncodeUrl","str","p1","b64EncodeUnicode","hasIndex","resolveUrlCache","cacheKey","resolved","originalUrlParts","decodeURIComponent","extension","formData","FormData","interactableId","needsToBeUploaded","fireLoadingTimeout","reader","FileReader","view","DataView","getUint16","marker","getUint32","little","readAsArrayBuffer","getOrientation","response","vertexRegex","fragRegex","validMaterials","shaderUniforms","newMaterial","onBeforeCompile","vlines","vindex","unshift","flines","findex","mediaHighlightFrag","shapes","meshRoot","__proto__","group","floorPlan","MESH","shapePrefix","groupEnd","mediaPos","snapCount","mirrorOrientation","rotateY","hubsSceneRegex","hubsRoomRegex"],"mappings":"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3C,MAAM+a,eAAevzD,MAAM,KAAK,MAChEq5C,GAAAroC,EAAA0C,cAAA,OAAKmiC,UAAWnxB,KAAO86B,MAAOniD,IAAKjB,GACjCi9C,GAAAroC,EAAA0C,cAAA,OAAKmiC,UAAWnxB,KAAO8uC,SAAvB,IAAkCp3D,GAClCi9C,GAAAroC,EAAA0C,cAAA,WACE2lC,GAAAroC,EAAA0C,cAAC+nC,GAAA,EAAD,CAAkBn3C,eAAgBlI,EAAE4D,MAAM,KAAK,2HAlB5CmzD,eACA,CACjBI,eAAgB/Z,KAAUE,OAC1B4Z,MAAO9Z,KAAUC,0ECNrB,MAAMga,GAAyB,GAGzBC,GAAc,CAClBC,MAAM,EACNC,MAAM,EACNC,MAAM,EACNC,MAAM,EACNC,SAAS,EACTC,UAAU,EACVC,OAAO,EACPC,QAAQ,EACRC,OAAO,EACPC,OAAO,GAKHC,GAAW,CACf,IACA,OACA,UACA,OACA,UACA,QACA,QACA,IACA,OACA,MACA,MACA,aACA,OACA,KACA,SACA,SACA,UACA,SACA,OACA,OACA,MACA,WACA,UACA,WACA,KACA,MACA,UACA,MACA,MACA,KACA,KACA,KACA,QACA,WACA,aACA,SACA,OACA,SACA,OACA,KACA,KACA,KACA,KACA,KACA,KACA,OACA,SACA,SACA,KACA,OACA,IACA,SACA,MACA,QACA,MACA,MACA,SACA,QACA,SACA,KACA,OACA,MACA,OACA,OACA,OACA,OACA,QACA,MACA,OACA,WACA,SACA,KACA,SACA,WACA,SACA,IACA,QACA,MACA,WACA,IACA,KACA,KACA,OACA,IACA,OACA,SACA,UACA,SACA,QACA,SACA,OACA,SACA,QACA,MACA,UACA,MACA,MACA,QACA,QACA,KACA,WACA,QACA,KACA,QACA,OACA,QACA,KACA,QACA,IACA,KACA,MACA,QACA,OAGF,SAASC,GAA6BC,GACpC,MAAMC,EAAe,GACfC,EAAUvuD,SAASlC,KAAKoW,YAAYlU,SAASwN,cAAc6gD,IAC3DG,EAAgBC,iBAAiBF,GACvC,IAAK,IAAIl6D,EAAI,EAAGA,EAAIm6D,EAAcj6D,OA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QACA,QACA,MACA,QACA,YACA,OACA,UACA,SACA,cACA,WACA,UACA,YACA,UACA,WACA,YACA,UACA,aACA,SACA,WACA,UACA,WACA,SACA,YACA,UACA,QACA,OACA,OACA,QACA,YACA,QACA,SACA,SACA,QACA,UACA,aACA,SACA,cACA,YACA,WACA,OACA,QACA,WACA,UACA,WACA,WACA,cACA,cACA,OACA,SACA,QACA,YACA,UACA,WACA,SACA,WACA,eACA,aACA,OACA,SACA,MACA,WACA,SACA,QACA,SACA,UACA,QACA,QACA,SACA,SACA,WACA,OACA,UACA,aACA,aACA,YACA,YACA,UACA,SACA,UACA,aACA,aACA,OACA,YACA,WACA,WACA,SACA,YACA,WACA,aACA,aACA,cACA,UACA,UACA,OACA,QACA,QACA,SACA,OACA,WACA,OACA,YACA,QACA,UACA,UACA,WACA,QACA,WACA,YACA,QACA,YACA,QACA,OACA,YACA,aACA,QACA,SACA,SACA,QACA,QACA,QACA,MACA,QACA,WACA,QACA,WACA,QACA,WACA,UACA,SACA,OACA,QACA,MACA,UACA,QACA,UACA,QACA,QACA,QACA,WACA,WACA,SACA,WACA,WACA,cACA,gBACA,WACA,aACA,QACA,aACA,YACA,cACA,WACA,aACA,UACA,YACA,UACA,YACA,YACA,aACA,YACA,WACA,OACA,WACA,OACA,YACA,QACA,SACA,WACA,WACA,SACA,SACA,OACA,WACA,WACA,UACA,YACA,SACA,UACA,YACA,aACA,QACA,SACA,eACA,UACA,QACA,SACA,UACA,YACA,OACA,MACA,UACA,UACA,WACA,WACA,QACA,QACA,WACA,SACA,WACA,WACA,aACA,SACA,aACA,cACA,SACA,aACA,WACA,SACA,SACA,OACA,QACA,SACA,SACA,SACA,UACA,OACA,WACA,QACA,aACA,SACA,UACA,UACA,WACA,YACA,YACA,QACA,UACA,YACA,QACA,SACA,UACA,UACA,UACA,UACA,OACA,QACA,OACA,SACA,YACA,UACA,YACA,cACA,WACA,UACA,eACA,SACA,OACA,cACA,WACA,YACA,SACA,WACA,UACA,YACA,UACA,WACA,WACA,SACA,YACA,UACA,OACA,WACA,QACA,YACA,WACA,WACA,QACA,QACA,SACA,OACA,YACA,SACA,eACA,aACA,WACA,SACA,SACA,YACA,SACA,OACA,WACA,YACA,QACA,QACA,OACA,OACA,QACA,SACA,UACA,UACA,SACA,UACA,OACA,WACA,UACA,WACA,YACA,WACA,UACA,cACA,QACA,YACA,OACA,QACA,WACA,OACA,QACA,OACA,gBACA,UACA,YACA,cACA,SACA,QACA,SACA,WACA,WACA,WACA,WACA,OACA,UACA,OACA,QACA,SACA,SACA,SACA,WACA,SACA,SACA,OACA,OACA,UACA,UACA,QACA,SACA,eACA,cACA,WACA,UACA,cACA,SACA,YACA,SACA,cACA,aACA,YACA,SACA,QACA,SACA,WACA,QACA,UACA,WACA,YACA,YACA,cACA,QACA,OACA,YACA,YACA,YACA,YACA,aACA,YACA,WACA,QACA,OACA,WACA,QACA,WACA,aACA,SACA,WACA,WACA,SACA,YACA,UACA,UACA,aACA,MACA,OACA,aACA,WACA,WACA,YACA,cACA,QACA,QACA,UACA,gBACA,WACA,OACA,UACA,SACA,SACA,SACA,aACA,SACA,UACA,WACA,WACA,SACA,UACA,UACA,WACA,UACA,QACA,aACA,aACA,QACA,iBACA,UACA,SACA,SACA,WACA,SACA,QACA,SACA,QACA,cACA,WACA,UACA,SACA,WACA,WACA,QACA,UACA,YACA,aACA,aACA,SACA,SACA,UACA,SACA,UACA,QACA,YACA,SACA,UACA,WACA,WACA,YACA,aACA,UACA,YACA,YACA,QACA,UACA,SACA,WACA,OACA,UACA,SACA,WACA,QACA,QACA,OACA,cACA,YACA,WACA,UACA,WACA,SACA,cACA,SACA,SACA,WACA,OACA,WACA,QACA,QACA,UACA,QACA,QACA,SACA,YACA,SACA,cACA,cACA,QACA,QACA,QACA,QACA,WACA,WACA,YACA,eACA,aACA,aACA,OACA,aACA,cACA,YACA,SACA,QACA,UACA,WACA,OACA,OACA,UACA,WACA,SACA,aACA,SACA,UACA,UACA,SACA,QACA,QACA,SACA,aACA,YACA,QACA,QACA,cACA,UACA,WACA,cACA,SACA,WACA,OACA,SACA,OACA,SACA,WACA,QACA,QACA,UACA,aACA,SACA,WACA,MACA,QACA,YACA,UACA,OACA,UACA,OACA,WACA,OACA,QACA,UACA,QACA,OACA,SACA,WACA,SACA,OACA,UACA,SACA,cACA,YACA,UAGIC,EAAQ,CACZ,QACA,OACA,QACA,WACA,QACA,OACA,SACA,QACA,YACA,SACA,eACA,WACA,QACA,SACA,WACA,QACA,SACA,UACA,OACA,SACA,SACA,UACA,OACA,OACA,OACA,QACA,OACA,QACA,YACA,SACA,OACA,SACA,SACA,WACA,YACA,cACA,SACA,YACA,SACA,UACA,aACA,WACA,cACA,YACA,OACA,UACA,SACA,aACA,WACA,eACA,aACA,SACA,OACA,UAGK,SAASC,IACd,MAAMC,EAAW3sH,IACf,MAAMpG,EAAIoG,EAAIqH,KAAKyzB,MAAMzzB,KAAKy2B,SAAW99B,EAAIxH,SAC7C,OAAOoB,EAAEsxH,OAAO,GAAG3zD,cAAgB39D,EAAEiC,MAAM,IAG7C,SAAU8wH,EAASH,MAAeG,EAASH,MAAeG,EAASF,iBCzpBrE9yH,EAAAS,EAAAqK,EAAA,sBAAA/D,IAAA/G,EAAAS,EAAAqK,EAAA,sBAAA88G,IAAA5nH,EAAAS,EAAAqK,EAAA,sBAAAk7G,IAAAhmH,EAAAS,EAAAqK,EAAA,sBAAA87G,IAAA5mH,EAAAS,EAAAqK,EAAA,sBAAAu3D,IAAAriE,EAAAS,EAAAqK,EAAA,sBAAA+0D,IAAA7/D,EAAAS,EAAAqK,EAAA,sBAAAmoH,IAAAjzH,EAAAS,EAAAqK,EAAA,sBAAA0wE,IAAAx7E,EAAAS,EAAAqK,EAAA,sBAAAk4E,IAKqB14E,SAASwN,cAAc,KACrC,SAAS/Q,EAAqBtD,EA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,cACA,YACA,cACA,aACA,aACA,aACA,gBACA,gBACA,gBACA,gBACA,YACA,eACA,mBACA,mBACA,iBACA,gBACA,kBACA,eACA,eACA,mBACA,iBACA,WACA,cACA,gBACA,UACA,WACA,gBACA,cACA,YACA,WACA,YACA,YACA,mBACA,iBACA,aACA,aACA,YACA,cACA,eACA,cACA,cACA,UACA,WACA,eACA,eACA,YACA,mBACA,gBACA,oBACA,kBACA,YACA,cACA,kBACA,aACA,cACA,eACA,cACA,cACA,cACA,iBACA,kBACA,cACA,WACA,WACA,cACA,OACA,mBACA,cACA,mBACA,cACA,iBACA,aACA,cACA,cACA,gBACA,qBACA,iBACA,eACA,gBACA,eACA,SACA,YACA,iBAGF,SAASC,EAAaC,GACpB,OAAOA,EAAIztI,KAAKyzB,MAAMzzB,KAAKy2B,SAAWg3G,EAAIt8I,SAOrC,MAAMu8I,EAAY3zI,IAAQC,IAAI2zI,GAAMA,EAAG3yI,IAEvC,SAAS4yI,IACd,MAAO,CACLpwH,SAAUgwH,EAAaE,ggBClG3B,MAAMG,EAAkB,gBAClBC,EAAwBv6I,SACxBw6I,EAA6B,qCAC7BC,EAAY,IAAIC,YAMT12F,EAAS,CACpBv8C,GAAI,aAEJw8C,YAAa,CACXzuB,QAAS,CACP9tB,KAAM,SACNizI,sBAAsB,EACtBz2F,WAAY,CACV5vB,YAAa,CAAE5sB,KAAM,SAAUq8C,QAAS,wBACxC95B,SAAU,CAAEviB,KAAM,UAClBkzI,iBAAkB,CAAElzI,KAAM,YAI9BZ,YAAa,CACXY,KAAM,SACNizI,sBAAsB,EACtBz2F,WAAY,CACVn9C,MAAO,CAAEW,KAAM,CAAC,OAAQ,WACxB8xD,MAAO,CAAE9xD,KAAM,CAAC,OAAQ,aAI5B6M,SAAU,CACR7M,KAAM,SACNizI,sBAAsB,EACtBz2F,WAAY,CACVxsB,eAAgB,CAAEhwB,KAAM,WACxB66C,eAAgB,CAAE76C,KAAM,WACxB+6C,mBAAoB,CAAE/6C,KAAM,WAC5B+3E,cAAe,CAAE/3E,KAAM,UACvBy9D,UAAW,CAAEz9D,KAAM,WACnBwrC,WAAY,CAAExrC,KAAM,WACpByrC,cAAe,CAAEzrC,KAAM,WACvBurC,UAAW,CAAEvrC,KAAM,WACnB8M,qBAAsB,CAAE9M,KAAM,aAIlC6oE,SAAU,CACR7oE,KAAM,SACNizI,sBAAsB,EACtBz2F,WAAY,CACVosB,oBAAqB,CAAE5oE,KAAM,YAIjCkrE,sBAAuB,CACrBlrE,KAAM,QACNmlF,MAAO,CAAEnlF,KAAM,WAGjBmzI,sBAAuB,CACrBnzI,KAAM,QACNmlF,MAAO,CACLnlF,KAAM,SACNizI,sBAAsB,EACtBz2F,WAAY,CACV3Y,OAAQ,CAAE7jC,KAAM,UAChBo5E,eAAgB,CAAEp5E,KAAM,aAK9B24E,wBAAyB,CACvB34E,KAAM,QACNmlF,MAAO,CACLnlF,KAAM,SACNizI,sBAAsB,EACtBz2F,WAAY,CACV8L,MAAO,CAAEtoD,KAAM,UACf44E,uBAAwB,CAAE54E,KAAM,cAMxCA,KAAM,SAENw8C,WAAY,CACV1uB,QAAS,CAAEslH,KAAM,yBACjBh0I,YAAa,CAAEg0I,KAAM,6BACrBvmI,SAAU,CAAEumI,KAAM,0BAClBvqE,SAAU,CAAEuqE,KAAM,0BAClBloE,sBAAuB,CAAEkoE,KAAM,uCAC/BD,sBAAuB,CAAEC,KAAM,uCAC/Bz6D,wBAAyB,CAAEy6D,KAAM,0CAGnCH,sBAAsB,GAGT,MAAMlnB,UAActvH,IACjCC,cACEC,QADYC,EAAAC,KAAA,OAyBP,KACLA,KAAKuQ,OAAO,CACV0gB,QAAO1zB,EAAA,GAAOu4I,IAA8B91I,KAAK7C,MAAM8zB,SAAW,MAI/DjxB,KAAK7C,MAAM6S,SAASguC,gBACvBh+C,KAAKuQ,OAAO,CAAE0gB,QAAS,CAAElB,eD3CnB2lH,EAAaD,MAAUvtI,KAAKyzB,MAAM,IAAwB,IAAhBzzB,KAAKy2B,iBCW3C5+B,EAAAC,KAAA,4BAoCc,KAC1BA,KAAKuQ,OAAO,CACV0gB,QAAO1zB,EAAA,GAAQyC,KAAK7C,MAAM8zB,SAAW,GAAQ6kH,SAnCD,OAA1Cp3E,aAAaC,QAAQo3E,IACvBr3E,aAAaI,QAAQi3E,EAAiBjzI,KAAKi8D,UAAU,KAEvD/+D,KAAKuQ,OAAO,CACVP,SAAU,GACVg8D,SAAU,GACVzpE,YAAa,GACb0uB,QAAS,GACTo9C,sBAAuB,GACvBioE,sBAAuB,GACvBx6D,wBAAyB,KAG3B,MAAM06D,EAAuB50B,IAAQ60B,QAAQR,GACzCO,IACFx2I,KAAKuQ,OAAO,CAAEhO,YAAai0I,IAC3Bx2I,KAAKsgF,4BACLshC,IAAQ52G,OAAOirI,IAsBnB94I,YAKE,OAJK6C,KAAKtG,eAAes8I,KACvBh2I,KAAKg2I,GAAyBlzI,KAAKC,MAAM27D,aAAaC,QAAQo3E,KAGzD/1I,KAAKg2I,GAGd30I,2BACE,OAAIrB,KAAK7C,MAAMoF,YAAYC,MAClBy3E,IAAUj6E,KAAK7C,MAAMoF,YAAYC,OAAOmrB,IAExC,KAIX2xC,6BAGEt/D,KAAKuQ,OAAO,CAAE89D,sBAAuB,IAAM,CAAEqoE,WADtB,CAACC,EAAkBC,IAAgBA,IAI5Dv3E,wBACEr/D,KAAKuQ,OAAO,CAAEP,SAAU,CAAE2+B,YAAY,EAAOiyB,WAAW,EAAOhyB,eAAe,EAAOF,WAAW,KAGlGn+B,OAAOutC,EAAU+4F,GACf,MAAMC,EAAaC,kBAAM/2I,KAAK7C,MAAO2gD,EAAU+4F,IACzCtuF,MAAEA,GAAU2tF,EAAUc,SAASF,EAAYr3F,GAEjD,IAAK8I,EAGH,MAAM,IAAIloC,MAAO,4CAQnB,OALAq+C,aAAaI,QAAQi3E,EAAiBjzI,KAAKi8D,UAAU+3E,WAC9C92I,KAAKg2I,GAEZh2I,KAAKE,cAAc,IAAIC,YAAY,iBAE5B22I,qCC9LXt8I,EAAAS,EAAAqK,EAAA,sBAAArD,IAAO,MAAMA,EAAU,CACrB,CACEiB,GAAI,aACJQ,MAAO,iFACPL,UAAW,sGAEb,CACEH,GAAI,UACJQ,MAAO,8EACPL,UAAW,mGAEb,CACEH,GAAI,SACJQ,MAAO,6EACPL,UAAW,kGAEb,CACEH,GAAI,UACJQ,MAAO,8EACPL,UAAW,mGAEb,CACEH,GAAI,WACJQ,MAAO,+EACPL,UAAW,oGAEb,CACEH,GAAI,SACJQ,MAAO,6EACPL,UAAW,kGAEb,CACEH,GAAI,SACJQ,MAAO,6EACPL,UAAW,kGAEb,CACEH,GAAI,WACJQ,MAAO,+EACPL,UAAW,oGAEb,CACEH,GAAI,YACJQ,MAAO,gFACPL,UAAW,qGAEb,CACEH,GAAI,WACJQ,MAAO,+EACPL,UAAW,gLCjDf,IAAA4zI,wCAAAz8I,oBAAA,IAEA,MAAM08I,QAAUn1I,kDAAS,aAEzB,GAAIm1I,QAAS,CACX,MAAM1+H,SAAW1T,SAASwN,cAAc,YACxCkG,SAAS+c,UAAa,80CAyDtBzwB,SAASwB,iBAAiB,mBAAoB,KAC5CxB,SAASlC,KAAKoW,YAAYR,SAASU,WAGrC,MAAMi+H,SAAW3+H,SAASU,QAAQ7H,cAAc,kBAChD8lI,SAAS7wI,iBAAiB,QAAStD,GAAKA,EAAEm7C,mBAE1C,MAAMi5F,cAAgB5+H,SAASU,QAAQ7H,cAAc,oBAC/CgmI,aAAe7+H,SAASU,QAAQ7H,cAAc,mBACpDgmI,aAAaC,SAAWt0I,KACtBA,EAAE40C,iBACF38B,QAAQ0/C,IAAI48E,SAASH,cAAcz7I,aAGrC,IAAI67I,WAAY,EAChB,MAAMC,iBAAmBj/H,SAASU,QAAQ7H,cAAc,uBACxDomI,iBAAiBC,QAAU,MACzBF,WAAaA,UACbL,SAAS1iG,UAAY+iG,UAAY,YAAc,GAC/CL,SAASr0F,UAAYq0F,SAASQ,aAAeR,SAAS/Q,eAGxD,MAAMwR,eAAiB38H,QAAQ0/C,IACzBk9E,iBAAmB58H,QAAQkF,MAC3B23H,gBAAkB78H,QAAQC,KAE1By/C,IAAM,SAASlmB,EAAWsjG,GAC9B,IAAI35F,EACA+4F,SAASt4B,WAAWxlH,OAAS,IAC/B+kD,EAAQ+4F,SAASzhH,YAEjB0oB,EAAQt5C,SAASwN,cAAc,QACzB0H,UAAU3J,IAAI,SAEtB+tC,EAAMpkC,UAAUhP,OAAO,OAAQ,SAC/BozC,EAAMpkC,UAAU3J,IAAIokC,GAEpB,MAAMkhG,EAAM9uG,MAAMnyB,KAAKqjI,GACjBC,EAAWrC,EAAI,GACrB,IAAIz8H,EAEFA,EADsB,iBAAb8+H,GAAyBA,EAASr2G,SAAS,MAC1Cq2G,EAASn7I,QAAQ,MAAO,IACzBm7I,aAAoB33H,SAChB23H,EAASvpF,YAAYupF,EAASC,QAEjCtC,EACPzzI,IAAI+L,GACgB,iBAARA,EAAyBA,EAC7BnL,KAAKi8D,UAAU9wD,IAEvBpP,KAAK,KAGV,MAAMqM,GAAO,IAAIksB,MAAOyoD,cAAc76E,UAAU,GAAI,IACpDo5C,EAAMoqD,gBAAkBt9F,MAASgO,IAEjC,MAAMg/H,EAAef,SAASr0F,YAAcq0F,SAASQ,aAAeR,SAAS/Q,aAC7E+Q,SAAS1uC,OAAOrqD,GACZ85F,IAAcf,SAASr0F,UAAYq0F,SAASQ,aAAeR,SAAS/Q,eAG1EnrH,QAAQC,KAAO,WACb48H,gBAAgB99I,MAAM,KAAMm+I,WAC5Bx9E,IAAI,OAAQw9E,YAGdl9H,QAAQkF,MAAQ,WACd03H,iBAAiB79I,MAAM,KAAMm+I,WAC7Bx9E,IAAI,QAASw9E,YAGfl9H,QAAQ0/C,IAAM,WACZi9E,eAAe59I,MAAM,KAAMm+I,WAC3Bx9E,IAAI,MAAOw9E,YAGb37I,OAAO47I,qBAAuBp1I,IAAK23D,IAAI,QAAS,CAAC33D,EAAE6nE,OAAOpc,QAASzrD,EAAE6nE,OAAO9e,KAAM/oD,EAAE6nE,OAAO3vE,QAC3FsB,OAAOu9B,QAAU/2B,IAAK23D,IAAI,QAAS,CAAC33D,uCC5ItCxI,EAAAS,EAAAqK,EAAA,sBAAA65C,IAAA3kD,EAAAS,EAAAqK,EAAA,sBAAA85C,IAAA,IAAA35C,EAAAjL,EAAA,IAAAkL,EAAAlL,EAAA2B,EAAAsJ,GAAA4yI,EAAA79I,EAAA,KAEA,MAAM26C,OAAEA,GAAWl3B,EAAQ,KAErBm3B,EAAUD,IAChB,IAAImjG,GAAgC,EAM7B,SAASn5F,EAAqB1xC,GACnC,IAAKjR,OAAOoJ,OAAQ,OACpB,MAAMG,EAAWH,OAAOC,MAAMC,OAAOC,WAEjCG,IAAWG,eAAiBT,OAAOC,MAAMC,OAAOE,cAAiC,YAAjBovC,EAAQl6C,OAQ1Eo9I,GAAgC,EAChCpyI,IAAWggE,OAAO9yD,KAAK,KACrB3F,EAAOsI,WAINhQ,GAAU0H,EAAO0+C,SAGjB,SAAS/M,IAEVk5F,EACFA,GAAgC,EAIlC9yI,gDCvCK,SAAS+gF,EAAgB98E,EAAU8uI,GACnC9uI,EAAS8P,WAEVstB,MAAMuhF,QAAQ3+G,EAAS8P,UACzB9P,EAAS8P,SAASqD,QAAQ27H,GAE1BA,EAAG9uI,EAAS8P,WAIT,SAASiyG,EAAa/hH,EAAU8uI,GACrC,GAAK9uI,EAAS8P,SAEd,OAAIstB,MAAMuhF,QAAQ3+G,EAAS8P,UAClB9P,EAAS8P,SAASrX,IAAIq2I,GAEtBA,EAAG9uI,EAAS8P,UAhBvB/e,EAAAS,EAAAqK,EAAA,sBAAAihF,IAAA/rF,EAAAS,EAAAqK,EAAA,sBAAAkmH,uBCAA,MAAMgtB,EAAU,IAAIhyI,MAAMS,QAAQ,EAAG,EAAG,GAClCwxI,EAAW,IAAIjyI,MAAMW,WACrBuxI,EAAW,IAAIlyI,MAAMS,QAAQ,EAAG,EAAG,GACnCimB,EAAW,IAAI1mB,MAAMmR,QAC3BuV,EAASA,WAGT,MAAMyrH,EAAiBnyI,MAAMoyI,gBAAgBn/I,UAAUo/I,iCACjDC,EAAatyI,MAAMoyI,gBAAgBn/I,UAAUq/I,WAInD,IAAK,IAAI3/I,EAAI,EAAGA,EAAIw/I,EAAet/I,OAAQF,IAAK,CAC9C,MAAM4/I,EAASJ,EAAex/I,GAAG2/I,EAAWE,wBACvCD,IAELJ,EAAex/I,GAAG2/I,EAAWE,wBAA0B,WACrD,MAAMj8I,EAAIg8I,EAAO/+I,MAAMgG,KAAMm4I,WAE7B,OADAn4I,KAAKi5I,aAAa9uI,mBAAoB,EAC/BpN,IAIXyJ,MAAMe,SAAS9N,UAAUyxB,iBAAmB,SAASzd,GASnD,YARe/P,IAAX+P,IACFwN,QAAQC,KAAK,8DACbzN,EAAS,IAAIjH,MAAMS,SAIrBjH,KAAKuK,iBAEEkD,EAAOyb,sBAAsBlpB,KAAK+H,cAG3CvB,MAAMe,SAAS9N,UAAU6U,mBAAsB,WAC7C,MAAMtH,EAAW,IAAIR,MAAMS,QACrBG,EAAQ,IAAIZ,MAAMS,QAExB,OAAO,SAA4BwG,GAUjC,YATe/P,IAAX+P,IACFwN,QAAQC,KAAK,gEACbzN,EAAS,IAAIjH,MAAMW,YAIrBnH,KAAKuK,iBACLvK,KAAK+H,YAAYC,UAAUhB,EAAUyG,EAAQrG,GAEtCqG,GAdoC,GAkB/CjH,MAAMe,SAAS2xI,cAAiB,WAC9B,MAAMlyI,EAAW,IAAIR,MAAMS,QACrBC,EAAa,IAAIV,MAAMW,WAE7B,OAAO,SAAuBsG,GAU5B,YATe/P,IAAX+P,IACFwN,QAAQC,KAAK,2DACbzN,EAAS,IAAIjH,MAAMS,SAIrBjH,KAAKuK,iBACLvK,KAAK+H,YAAYC,UAAUhB,EAAUE,EAAYuG,GAE1CA,GAdqB,GAkBhC,MAAM0rI,EAA2B/9I,IAC1BA,EAAE8e,mBACL9e,EAAE8e,kBAAmB,EAEjB9e,EAAEg+I,oBACJh+I,EAAEg+I,kBAAkBlrI,KAAK9S,EAAE2M,aAC3B3M,EAAE2M,YAAc3M,EAAEg+I,qBAKlBtwH,EAAetiB,MAAMe,SAAS9N,UAAUqvB,aAC9CtiB,MAAMe,SAAS9N,UAAUqvB,aAAe,WACtCA,EAAa9uB,MAAMgG,KAAMm4I,WACzBgB,EAAyBn5I,OAG3B,MAAMq5I,EAAc7yI,MAAMe,SAAS9N,UAAU4/I,YAC7C7yI,MAAMe,SAAS9N,UAAU4/I,YAAc,WACrCA,EAAYr/I,MAAMgG,KAAMm4I,WACxBgB,EAAyBn5I,OAgB3BwG,MAAMe,SAAS9N,UAAU8Q,eAAiB,SAAS+uI,EAAkBC,EAAkBC,GAChFx5I,KAAKy5I,yBAgBCz5I,KAAKmK,mBAAqBnK,KAAKuY,kBAAoB+gI,KAC5Dt5I,KAAK8oB,eACD9oB,KAAKmK,oBAAmBnK,KAAKmK,mBAAoB,KAhBlDnK,KAAKgH,SAASgiB,OAAOwvH,IACrBx4I,KAAKkH,WAAW8hB,OAAOyvH,IACvBz4I,KAAKoH,MAAM4hB,OAAO0vH,IAClB14I,KAAKia,OAAO+O,OAAOkE,IAKpBltB,KAAK8oB,eAGP9oB,KAAKy5I,yBAA0B,EAC/Bz5I,KAAKgjI,wBAAyB,EAC9BhjI,KAAKo5I,kBAAoBp5I,KAAK+H,cAM3ByxI,GAAex5I,KAAKoO,SACvBpO,KAAKoO,OAAO7D,gBAAe,EAAOgvI,GAAkB,GACpDv5I,KAAKgjI,uBAAyBhjI,KAAKgjI,wBAA0BhjI,KAAKoO,OAAOsrI,gCAGvE15I,KAAKgjI,wBAA0BuW,KACb,OAAhBv5I,KAAKoO,OACPpO,KAAK+H,YAAYmG,KAAKlO,KAAKia,QAQtBja,KAAKka,iBAKRla,KAAK+H,YAAYsQ,iBAAiBrY,KAAKoO,OAAOrG,YAAa/H,KAAKia,QAJhEja,KAAK+H,YAAc/H,KAAKoO,OAAOrG,YAQnC/H,KAAK05I,+BAAgC,EACrC15I,KAAKgjI,wBAAyB,IAUlCx8H,MAAMe,SAAS9N,UAAUsN,kBAAoB,SAASwyI,EAAkBI,GACtE,IAAK35I,KAAKqK,UAAYsvI,EAAkB,OAGxC35I,KAAKuK,gBAAe,EAAOgvI,GAAkB,GAE7C,MAAMpgI,EAAWnZ,KAAKmZ,SAChBygI,EAA2B55I,KAAK05I,+BAAiCH,EAEvE,IAAK,IAAIpgJ,EAAI,EAAG2B,EAAIqe,EAAS9f,OAAQF,EAAI2B,EAAG3B,IAC1CggB,EAAShgB,GAAG4N,kBAAkB6yI,EAA0BD,GAGtD35I,KAAK05I,gCAA+B15I,KAAK05I,+BAAgC,IAI/ElzI,MAAMe,SAAS9N,UAAU2vC,OAAU,WAGjC,MAAMywG,EAAK,IAAIrzI,MAAMW,WACf2yI,EAAK,IAAItzI,MAAMmR,QACflK,EAAS,IAAIjH,MAAMS,QACnBD,EAAW,IAAIR,MAAMS,QAE3B,OAAO,SAAgBmB,EAAGG,EAAGC,GACvBJ,EAAE2xI,UACJtsI,EAAOS,KAAK9F,GAEZqF,EAAO5M,IAAIuH,EAAGG,EAAGC,GAGnB,MAAM4F,EAASpO,KAAKoO,OAEpBpO,KAAKuK,iBAELvD,EAASkiB,sBAAsBlpB,KAAK+H,aAEhC/H,KAAKg6I,UAAYh6I,KAAKi6I,QACxBH,EAAG1wG,OAAOpiC,EAAUyG,EAAQzN,KAAKkrF,IAEjC4uD,EAAG1wG,OAAO37B,EAAQzG,EAAUhH,KAAKkrF,IAGnClrF,KAAKkH,WAAWiiB,sBAAsB2wH,GAElC1rI,IACF0rI,EAAGI,gBAAgB9rI,EAAOrG,aAC1B8xI,EAAG1wH,sBAAsB2wH,GACzB95I,KAAKkH,WAAWuiB,YAAYowH,EAAGrwH,aAhCF,sBCrLnC5jB,OAAOkD,kBAAkB,gBAAiB,CACxCC,OAAQ,CACNyQ,MAAO,CAAErW,KAAM,SACfg3I,UAAW,CAAElxI,QAAS,IAGxBI,OACE,MAAME,EAAKvJ,KAAKuJ,GAChBvJ,KAAKwmI,MAAQ,IAAIhgI,MAAM4zI,aACvBp6I,KAAKuJ,GAAG82B,YAAY,gBAAiBrgC,KAAKwmI,OAC1CxmI,KAAKuJ,GAAGQ,QAAQ8B,QAAQ26H,MAAM6T,cAAc9wI,GAC5CvJ,KAAKs6I,eAAiBt6I,KAAKuJ,GAAGQ,QAAQ8B,QAAQ4oB,UAGhDlkB,OAAO6iG,GACDpzG,KAAKnH,KAAK2gB,QAAU45F,EAAS55F,QAC/BxZ,KAAKwmI,MAAMhtH,MAAM3Y,IAAIb,KAAKnH,KAAK2gB,OAC/BxZ,KAAKs6I,eAAeC,qBAAqBv6I,KAAKwmI,MAAMhtH,QAGlDxZ,KAAKnH,KAAKshJ,YAAc/mC,EAAS+mC,YACnCn6I,KAAKwmI,MAAM2T,UAAYn6I,KAAKnH,KAAKshJ,YAIrCnvI,OAAQ,WACNhL,KAAKuJ,GAAGk4B,eAAe,uCCtB3B77B,OAAOkD,kBAAkB,YAAa,CACpCC,OAAQ,CACN5F,KAAM,UAER0T,UAAU,EACVxN,OACErJ,KAAKuJ,GAAGyQ,UAAU3J,IAAIrQ,KAAKnH,OAE7B0X,OAAO6D,GACDpU,KAAKnH,OAASub,IAChBpU,KAAKuJ,GAAGyQ,UAAUhP,OAAOoJ,GACzBpU,KAAKuJ,GAAGyQ,UAAU3J,IAAIrQ,KAAKnH,QAG/BmS,SACEhL,KAAKuJ,GAAGyQ,UAAUhP,OAAOhL,KAAKnH,4BCdlC+M,OAAOkD,kBAAkB,OAAQ,CAC/BC,OAAQ,CACNyxI,aAAc,CAAEvxI,QAAS,GACzBwxI,SAAU,CAAExxI,QAAS,KACrBkkI,SAAU,CAAElkI,QAAS,IAGvBI,KAAM,WACJrJ,KAAKq+E,cAAgBr+E,KAAKuJ,GAAGQ,QAAQ8B,QAAQ2yE,QAC7Cx+E,KAAK06I,SAAU,EACf16I,KAAKgH,SAAW,IAAI2zI,OAAOC,KAC3B56I,KAAKsH,MAAQ,IAAIqzI,OAAOC,KAAK,EAAG56I,KAAKnH,KAAK2hJ,aAAc,GACxDx6I,KAAK0sG,aAAe1sG,KAAKuJ,GAAGE,SAASrC,MAAMgB,EAC3CpI,KAAKmtI,SAAWntI,KAAKnH,KAAKs0I,SAAWntI,KAAK0sG,cAG5C5iG,KAAM,WACJ9J,KAAKq+E,cAAcw8D,aAAa76I,OAGlCgK,MAAO,WACLhK,KAAKq+E,cAAcy8D,gBAAgB96I,OAGrC+6I,WAAY,WACV,GAAI/6I,KAAKuJ,GAAG3G,MAAQsQ,IAAIrN,MAAMwO,OAAOrU,KAAKuJ,IAAK,CAC7C,MAAMiL,EAAexU,KAAKuJ,GAAGE,SAASrC,MAAMgB,EAEtCd,EADQY,KAAKqyB,IAAI,GAAI/lB,EAAexU,KAAK0sG,eAAiB1sG,KAAKmtI,SAAWntI,KAAK0sG,eAC/D1sG,KAAKnH,KAAK4hJ,SAChC,GAAInzI,EAAQ,EAAG,CACb,MAAMgQ,EAAQpP,KAAKy2B,SAAWz2B,KAAK6F,GAAK,EAClC3F,EAAIF,KAAK+c,IAAI3N,GACb9O,EAAIN,KAAKgd,IAAI5N,GACnBtX,KAAKsH,MAAMzG,IAAIuH,EAAGd,EAAOkB,GACzBxI,KAAKgH,SAASnG,IAAQ,IAAJuH,EAAU,EAAO,IAAJI,GAC/BxI,KAAKuJ,GAAGE,SAASU,mBAAoB,EACrCnK,KAAKuJ,GAAG3G,KAAKo4I,WAAWh7I,KAAKsH,MAAOtH,KAAKgH,kCCxCjDpB,OAAOkD,kBAAkB,cAAe,CACtCO,OACErJ,KAAKuJ,GAAGjD,iBAAiB,uBAAwBtD,IACzB,gBAAlBA,EAAEhG,OAAO9B,MACX8E,KAAKi7I,0BAA0Bj7I,KAAKuJ,GAAG6B,WAAW,kBAGtDpL,KAAKuJ,GAAG6H,aAAa,cAAe,CAAE8pI,MAAO,OAAQ9J,KAAM,KAE7D6J,0BAA0Br4I,GACxB,MAAM8K,OAAEA,EAAFohB,SAAUA,EAAVj2B,KAAoBA,GAASmH,KAAKnH,KAElCwO,EAAc,IAAIszI,OAAOxzI,WAC/BE,EAAY+nC,iBAAiB,IAAIurG,OAAOC,KAAK,EAAG,EAAG,IAAK1yI,KAAK6F,GAAK,GAElE,MAAM0B,EAAW,IAAIkrI,OAAOxzI,WAC5BsI,EAAS2/B,iBAAiB,IAAIurG,OAAOC,KAAK,EAAG,EAAG,IAAK1yI,KAAK6F,GAAK,GAC/D0B,EAAS0rI,KAAK9zI,EAAaA,GAE3B,MAAM+zI,EAAe,IAAIT,OAAOC,KAAKltI,EAAOtF,EAAGsF,EAAOnF,EAAGmF,EAAOlF,GAE1D0yI,EAAQ,IAAIP,OAAOU,YAAYxiJ,EAAM,CAAEyiJ,YAAaxsH,IAE1DlsB,EAAK24I,SAASL,EAAOE,EAAc/zI,yBCxBvCzB,OAAOkD,kBAAkB,mBAAoB,CAC3CC,OAAQ,CACNyyI,SAAU,CAAEr4I,KAAM,SAClBs4I,YAAa,CAAEt4I,KAAM,SACrBg3I,UAAW,CAAElxI,QAAS,IAGxBI,OACE,MAAME,EAAKvJ,KAAKuJ,GAChBvJ,KAAKwmI,MAAQ,IAAIhgI,MAAMkgI,gBACvB1mI,KAAKwmI,MAAMx/H,SAASnG,IAAI,EAAG,EAAG,GAC9Bb,KAAKwmI,MAAMr8H,mBAAoB,EAC/BnK,KAAKuJ,GAAG82B,YAAY,mBAAoBrgC,KAAKwmI,OAC7CxmI,KAAKuJ,GAAGQ,QAAQ8B,QAAQ26H,MAAM6T,cAAc9wI,IAG9CgH,OAAO6iG,GACDpzG,KAAKnH,KAAK2iJ,WAAapoC,EAASooC,UAClCx7I,KAAKwmI,MAAMhtH,MAAM3Y,IAAIb,KAAKnH,KAAK2iJ,UAG7Bx7I,KAAKnH,KAAK4iJ,cAAgBroC,EAASqoC,aACrCz7I,KAAKwmI,MAAMiV,YAAY56I,IAAIb,KAAKnH,KAAK4iJ,aAGnCz7I,KAAKnH,KAAKshJ,YAAc/mC,EAAS+mC,YACnCn6I,KAAKwmI,MAAM2T,UAAYn6I,KAAKnH,KAAKshJ,YAIrCnvI,OAAQ,WACNhL,KAAKuJ,GAAGk4B,eAAe,0CC1B3B77B,OAAOkD,kBAAkB,oBAAqB,CAC5CC,OAAQ,CAAE5F,KAAM,SAAU8F,QAAS,OAEnCI,OACErJ,KAAK07I,iBAAmB17I,KAAK07I,iBAAiBx/I,KAAK8D,MACnDA,KAAKuJ,GAAGQ,QAAQzD,iBAAiB,kBAAmBtG,KAAK07I,mBAG3DA,iBAAiB1kI,GACfhX,KAAKob,qBAAqBpE,EAAMha,SAGlCuT,OAAO6D,GACDpU,KAAKnH,OAASub,GAChBpU,KAAKob,qBAAqB5e,OAAO2E,IAAI66G,UAIzC5gG,qBAAqB4gG,GACnBh8G,KAAKuJ,GAAG6H,aAAa,UAAW4qG,IAAYh8G,KAAKnH,4BCxBrD+M,OAAOkD,kBAAkB,cAAe,CACtCC,OAAQ,CACNyQ,MAAO,CAAErW,KAAM,SACfg3I,UAAW,CAAElxI,QAAS,GACtB0nI,MAAO,CAAE1nI,QAAS,GAClB2nI,MAAO,CAAE3nI,QAAS,GAClBsoI,WAAY,CAAEtoI,SAAS,GACvB0yI,oBAAqB,CAAE1yI,QAAS,CAAC,IAAK,MACtC2yI,WAAY,CAAE3yI,QAAS,GACvB4yI,aAAc,CAAE5yI,QAAS,IAG3BI,OACE,MAAME,EAAKvJ,KAAKuJ,GAChBvJ,KAAKwmI,MAAQ,IAAIhgI,MAAMs1I,WACvB97I,KAAKwmI,MAAMgL,OAAO53H,OAAOrB,kBAAmB,EAC5CvY,KAAKuJ,GAAG82B,YAAY,cAAergC,KAAKwmI,OACxCxmI,KAAKuJ,GAAGQ,QAAQ8B,QAAQ26H,MAAM6T,cAAc9wI,GAC5CvJ,KAAKs6I,eAAiBt6I,KAAKuJ,GAAGQ,QAAQ8B,QAAQ4oB,UAGhDlkB,OAAO6iG,GACL,MAAMozB,EAAQxmI,KAAKwmI,MAEnB,GAAIxmI,KAAKnH,KAAK2gB,QAAU45F,EAAS55F,MAAO,CACtC,MAAMA,EAAQ,IAAIhT,MAAM4qG,MAAMpxG,KAAKnH,KAAK2gB,OACxCxZ,KAAKs6I,eAAeC,qBAAqB/gI,GACzCgtH,EAAMhtH,MAAMtL,KAAKsL,GAGfxZ,KAAKnH,KAAKshJ,YAAc/mC,EAAS+mC,YACnC3T,EAAM2T,UAAYn6I,KAAKnH,KAAKshJ,WAG1Bn6I,KAAKnH,KAAK83I,QAAUv9B,EAASu9B,QAC/BnK,EAAM13G,SAAW9uB,KAAKnH,KAAK83I,OAGzB3wI,KAAKnH,KAAK+3I,QAAUx9B,EAASw9B,QAC/BpK,EAAMoK,MAAQ5wI,KAAKnH,KAAK+3I,OAGtB5wI,KAAKnH,KAAK04I,aAAen+B,EAASm+B,aACpC/K,EAAM+K,WAAavxI,KAAKnH,KAAK04I,YAG3BvxI,KAAKnH,KAAK+iJ,aAAexoC,EAASwoC,aACpCpV,EAAMgL,OAAOuK,KAAO/7I,KAAKnH,KAAK+iJ,YAG5B57I,KAAKnH,KAAKgjJ,eAAiBzoC,EAASyoC,eACtCrV,EAAMgL,OAAO/kI,OAASzM,KAAKnH,KAAKgjJ,cAGlC,MAAOv4I,EAAOC,GAAUvD,KAAKnH,KAAK8iJ,qBAC3BK,EAAWC,GAAc7oC,EAASuoC,oBAAsBvoC,EAASuoC,oBAAsB,CAAC,IAAK,KAEhGr4I,IAAU04I,GAAaz4I,IAAW04I,IACpCzV,EAAMgL,OAAO0K,QAAQr7I,IAAIyC,EAAOC,GAE5BijI,EAAMgL,OAAOtvI,MACfskI,EAAMgL,OAAOtvI,IAAI64B,UACjByrG,EAAMgL,OAAOtvI,IAAM,QAKzB8I,OAAQ,WACNhL,KAAKuJ,GAAGk4B,eAAe,qCC/D3B,SAAS06G,EAAK1sH,EAAOC,EAAK9zB,GACxB,OAAQ,EAAIA,GAAK6zB,EAAQ7zB,EAAI8zB,EAG/B,MAAM0sH,EAAS,IAAI51I,MAAMW,WAEzBvB,OAAOkD,kBAAkB,uBAAwB,CAC/CC,OAAQ,CACN63B,SAAU,CAAE33B,QAAS,GAAI9F,KAAM,UAC/Bk5I,aAAc,CAAEpzI,SAAS,EAAO9F,KAAM,YAGxCkG,KAAM,WACJrJ,KAAKs8I,WAAat8I,KAAKuJ,GAAGE,SAASzC,SAAS+9B,QAC5C/kC,KAAKu8I,cAAgB,IAAI/1I,MAAMW,WAC/BnH,KAAKu8I,cAAcpkI,aAAanY,KAAKuJ,GAAGE,SAASgG,UAEjDzP,KAAKw8I,YAAc,IAAIh2I,MAAMS,QAAQ,EAAG,IAAM,IAC9CjH,KAAKw8I,YAAYxkI,aAAahY,KAAKuJ,GAAGE,SAASwQ,QAC/Cja,KAAKw8I,YAAYnsI,IAAI,IAAI7J,MAAMS,QAAQ,EAAG,GAAI,IAE9C,MAAMw1I,EAAiB,IAAIj2I,MAAM4I,OAAO,IAAM,EAAK,KACnDpP,KAAKqlC,eAAiB,IAAI7+B,MAAMW,WAChCnH,KAAKqlC,eAAeltB,aAAaskI,GACjCz8I,KAAKqlC,eAAe5b,YAAYzpB,KAAKu8I,eAErCv8I,KAAK08I,UAAY5+H,YAAYC,MAC7B/d,KAAK28I,WAAY,EACjB38I,KAAK48I,YAAa,GAGpBxyI,KAAM,WACJ,IAAIxO,GAAKkiB,YAAYC,MAAQ/d,KAAK08I,YAAc,IAAS18I,KAAKnH,KAAK+nC,UACnEhlC,EAAIsM,KAAKqyB,IAAI,EAAKryB,KAAKqW,IAAI,EAAK3iB,IAE3BoE,KAAK48I,WAGRhhJ,EAAIA,EAAI,GAAM,EAAIA,EAAIA,GAAU,EAAI,EAAIA,GAAKA,EAAlB,EAF3BA,GAAS,EAAIA,EAKf,MAAM8Y,EAAO1U,KAAK28I,UAAY38I,KAAKw8I,YAAcx8I,KAAKs8I,WAChD3nI,EAAK3U,KAAK28I,UAAY38I,KAAKs8I,WAAat8I,KAAKw8I,YAC7CK,EAAU78I,KAAK28I,UAAY38I,KAAKqlC,eAAiBrlC,KAAKu8I,cACtDO,EAAQ98I,KAAK28I,UAAY38I,KAAKu8I,cAAgBv8I,KAAKqlC,eAEzD7+B,MAAMW,WAAWiiB,MAAMyzH,EAASC,EAAOV,EAAQxgJ,GAE/CoE,KAAKuJ,GAAGE,SAASzC,SAASnG,IAAIs7I,EAAKznI,EAAKtM,EAAGuM,EAAGvM,EAAGxM,GAAIugJ,EAAKznI,EAAKnM,EAAGoM,EAAGpM,EAAG3M,GAAIugJ,EAAKznI,EAAKlM,EAAGmM,EAAGnM,EAAG5M,IAE1FoE,KAAKnH,KAAKwjJ,cACbr8I,KAAKuJ,GAAGE,SAASgG,SAAS27E,kBAAkBgxD,GAG9Cp8I,KAAKuJ,GAAGE,SAASU,mBAAoB,EAEjCvO,GAAK,QACPoE,KAAK48I,YAAa,EAClB58I,KAAK28I,WAAa38I,KAAK28I,UACvB38I,KAAK08I,UAAY5+H,YAAYC,2CChEnCvjB,EAAAS,EAAAqK,EAAA,sBAAAimC,IAAA/wC,EAAAS,EAAAqK,EAAA,sBAAA4lC,IAAA1wC,EAAAS,EAAAqK,EAAA,sBAAAy3I,IAIO,MAAMxxG,EAAuB,CAClCp5B,IAAK,EACL6vE,KAAM,EACNK,UAAW,EACX+rB,QAAS,GAMEljE,EAAc,CACzB8xG,UAAW,EACXC,UAAW,EACXC,UAAW,EACXC,QAAS,EACTC,UAAW,EAGXC,WAAY,EACZC,WAAY,EACZC,WAAY,GACZC,SAAU,GACVC,WAAY,GAEZC,gBAAiB,GACjBC,gBAAiB,GACjBC,gBAAiB,GACjBC,cAAe,GACfC,gBAAiB,GAEjBC,cAAe,GACfC,cAAe,GACfC,cAAe,GACfC,YAAa,GACbC,cAAe,GAEfhzG,OAAQ,GACRizG,QAAS,IAKX,SAASC,EAAoBx8D,EAAey8D,EAASC,EAAUC,EAAeC,GAC5E,OAAI58D,IAAkBt2C,EAAqBp5B,IAClCmsI,EACEz8D,IAAkBt2C,EAAqBy2C,KACzCu8D,EACE18D,IAAkBt2C,EAAqB82C,UACzCm8D,EAEAC,EAMX,MAAMC,EAAgC,CACpCC,SAAU,CAACzzG,EAAY8xG,UAAW9xG,EAAYmyG,WAAYnyG,EAAYwyG,gBAAiBxyG,EAAY6yG,eACnGa,SAAU,CAAC1zG,EAAYgyG,UAAWhyG,EAAYqyG,WAAYryG,EAAY0yG,gBAAiB1yG,EAAY+yG,eACnGY,+BAAgC,CAC9B3zG,EAAYgyG,UACZhyG,EAAYqyG,WACZryG,EAAY0yG,gBACZ1yG,EAAY+yG,eAEda,SAAU,CAAC5zG,EAAY+xG,UAAW/xG,EAAYoyG,WAAYpyG,EAAYyyG,gBAAiBzyG,EAAY8yG,eACnGe,gCAAiC,CAC/B7zG,EAAY+xG,UACZ/xG,EAAYoyG,WACZpyG,EAAYyyG,gBACZzyG,EAAY8yG,eAEdgB,wBAAyB,CACvB9zG,EAAY+xG,UACZ/xG,EAAYoyG,WACZpyG,EAAYyyG,gBACZzyG,EAAY8yG,eAEdiB,SAAU,CAAC/zG,EAAYkyG,UAAWlyG,EAAYuyG,WAAYvyG,EAAY4yG,gBAAiB5yG,EAAYizG,eACnGe,kBAAmB,CAACh0G,EAAYiyG,QAASjyG,EAAYsyG,SAAUtyG,EAAY2yG,cAAe3yG,EAAYgzG,cAGlGiB,EAAqB,CACzBC,QAAS,CAACl0G,EAAY+xG,UAAW/xG,EAAYoyG,WAAYpyG,EAAYyyG,gBAAiBzyG,EAAY8yG,gBAK7F,SAASjB,EAAkCl7D,EAAepqD,EAAa/kB,GAC5E,IAAK,MAAMs3F,KAAU00C,EACnB,GAAIjnH,EAAYoxD,cAAc3nF,WAAW8oG,GAAS,CAEhD,OAAOq0C,EAAoBx8D,KADb68D,EAA8B10C,IAKhD,GAAIt3F,EACF,IAAK,MAAMwf,KAAUitH,EACnB,GAAIzsI,EAAIm2E,cAActlC,SAASrxB,GAAS,CAEtC,OAAOmsH,EAAoBx8D,KADbs9D,EAAmBjtH,IAMvC,OAAOgZ,EAAYkzG,4BC7GrBx4I,OAAOkD,kBAAkB,aAAc,CACrCC,OAAQ,CACNyQ,MAAO,CAAErW,KAAM,SACfg3I,UAAW,CAAElxI,QAAS,GACtB0nI,MAAO,CAAE1nI,QAAS,GAClB2nI,MAAO,CAAE3nI,QAAS,GAClBo2I,eAAgB,CAAEp2I,QAAS,GAC3Bq2I,eAAgB,CAAEr2I,QAASf,KAAK6F,GAAK,GACrCwjI,WAAY,CAAEtoI,SAAS,GACvB0yI,oBAAqB,CAAE1yI,QAAS,CAAC,IAAK,MACtC2yI,WAAY,CAAE3yI,QAAS,GACvB4yI,aAAc,CAAE5yI,QAAS,IAG3BI,OACE,MAAME,EAAKvJ,KAAKuJ,GAChBvJ,KAAKwmI,MAAQ,IAAIhgI,MAAM+4I,UACvBv/I,KAAKwmI,MAAMx/H,SAASnG,IAAI,EAAG,EAAG,GAC9Bb,KAAKwmI,MAAM/4H,OAAOzG,SAASnG,IAAI,EAAG,EAAG,GACrCb,KAAKwmI,MAAMn2H,IAAIrQ,KAAKwmI,MAAM/4H,QAC1BzN,KAAKwmI,MAAMr8H,mBAAoB,EAC/BnK,KAAKwmI,MAAM/4H,OAAOtD,mBAAoB,EACtCnK,KAAKuJ,GAAG82B,YAAY,aAAcrgC,KAAKwmI,OACvCxmI,KAAKuJ,GAAGQ,QAAQ8B,QAAQ26H,MAAM6T,cAAc9wI,IAG9CgH,OAAO6iG,GACL,MAAMozB,EAAQxmI,KAAKwmI,MAEfxmI,KAAKnH,KAAK2gB,QAAU45F,EAAS55F,OAC/BgtH,EAAMhtH,MAAM3Y,IAAIb,KAAKnH,KAAK2gB,OAGxBxZ,KAAKnH,KAAKshJ,YAAc/mC,EAAS+mC,YACnC3T,EAAM2T,UAAYn6I,KAAKnH,KAAKshJ,WAG1Bn6I,KAAKnH,KAAK83I,QAAUv9B,EAASu9B,QAC/BnK,EAAM13G,SAAW9uB,KAAKnH,KAAK83I,OAGzB3wI,KAAKnH,KAAK+3I,QAAUx9B,EAASw9B,QAC/BpK,EAAMoK,MAAQ5wI,KAAKnH,KAAK+3I,OAGtB5wI,KAAKnH,KAAKwmJ,iBAAmBjsC,EAASisC,gBAAkBr/I,KAAKnH,KAAKymJ,iBAAmBlsC,EAASksC,iBAChG9Y,EAAMlvH,MAAQtX,KAAKnH,KAAKymJ,eACxB9Y,EAAMgZ,SAAW,EAAMx/I,KAAKnH,KAAKwmJ,eAAiBr/I,KAAKnH,KAAKymJ,gBAG1Dt/I,KAAKnH,KAAK04I,aAAen+B,EAASm+B,aACpC/K,EAAM+K,WAAavxI,KAAKnH,KAAK04I,YAG3BvxI,KAAKnH,KAAK+iJ,aAAexoC,EAASwoC,aACpCpV,EAAMgL,OAAOuK,KAAO/7I,KAAKnH,KAAK+iJ,YAG5B57I,KAAKnH,KAAKgjJ,eAAiBzoC,EAASyoC,eACtCrV,EAAMgL,OAAO/kI,OAASzM,KAAKnH,KAAKgjJ,cAGlC,MAAOv4I,EAAOC,GAAUvD,KAAKnH,KAAK8iJ,qBAC3BK,EAAWC,GAAc7oC,EAASuoC,oBAAsBvoC,EAASuoC,oBAAsB,CAAC,IAAK,KAEhGr4I,IAAU04I,GAAaz4I,IAAW04I,IACpCzV,EAAMgL,OAAO0K,QAAQr7I,IAAIyC,EAAOC,GAE5BijI,EAAMgL,OAAOtvI,MACfskI,EAAMgL,OAAOtvI,IAAI64B,UACjByrG,EAAMgL,OAAOtvI,IAAM,QAKzB8I,OAAQ,WACNhL,KAAKuJ,GAAGk4B,eAAe,sCC3E3B,MAAMzjB,EAAmBC,EAAQ,KAAgBD,iBAEjDpY,OAAOkD,kBAAkB,gBAAiB,CACxCC,OAAQ,CAEN02I,eAAgB,CAAEx2I,SAAS,GAG3By2I,kBAAmB,CAAEz2I,SAAS,GAI9BgM,uBAAwB,CAAEhM,SAAS,GAGnC02I,eAAgB,CAAE12I,SAAU,GAG5B22I,mBAAoB,CAAE32I,SAAS,GAG/B42I,kBAAmB,CAAE52I,QAAS,OAGhCI,OACErJ,KAAK8/I,OAAS9/I,KAAK8/I,OAAO5jJ,KAAK8D,MAC/BA,KAAK+/I,UAAY//I,KAAK+/I,UAAU7jJ,KAAK8D,OAGvCoK,OACOpK,KAAKggJ,WACRhgJ,KAAKggJ,SAAWhgJ,KAAKuJ,GAAG6B,WAAW,cAGrC,MACMwS,EADchY,OAAO3G,OAAO,GAAG4M,QAAQD,YAClBgS,OAAO5d,KAAKuJ,IAQvC,GAPIqU,IAAW5d,KAAK8U,SAClB9U,KAAK8/I,SAEH9/I,KAAK8U,UAAY8I,GACnB5d,KAAK+/I,YAGH//I,KAAKigJ,sBAAuB,CAC9B,MAAM5rI,EAASrU,KAAKuJ,GAAG6B,WAAWkI,WAAaJ,IAAIrN,MAAMwO,OAAOrU,KAAKuJ,IAC/D22I,EAAkBlgJ,KAAKggJ,SAASnnJ,KAAKwc,wBACrC8qI,EAAmBngJ,KAAKggJ,SAASnnJ,KAAKyc,yBACtC8qI,EACJpgJ,KAAKggJ,SAASp9I,KAAKy9I,oBAAoBC,UAAYJ,EAAkBA,GACrElgJ,KAAKggJ,SAASp9I,KAAK29I,qBAAqBD,UAAYH,EAAmBA,EAErEC,GAAY/rI,GACdrU,KAAKuJ,GAAG6H,aAAa,YAAa,CAAEjO,KAAM,YAGxCi9I,GAAa/rI,IACfrU,KAAKigJ,uBAAwB,GAIjCjgJ,KAAK8U,QAAU8I,GAGjB9T,OAEM9J,KAAKwgJ,oBACTxgJ,KAAKwgJ,mBAAoB,EACrBxgJ,KAAKuJ,GAAG3G,KACV5C,KAAKygJ,iBAELzgJ,KAAKygJ,cAAgBzgJ,KAAKygJ,cAAcvkJ,KAAK8D,MAC7CA,KAAKuJ,GAAGjD,iBAAiB,cAAetG,KAAKygJ,cAAe,CAAErqH,MAAM,OAIxEsqH,UAAUpiI,GACJte,KAAKuJ,GAAG6B,WAAWkI,YAAcJ,IAAIrN,MAAMwO,OAAOrU,KAAKuJ,MAE3DvJ,KAAKse,OAASA,EACdte,KAAKuJ,GAAG6H,aAAa,YAAa,CAAEjO,KAAMmb,EAAS,YAAc,cAGnEmiI,gBACMzgJ,KAAKnH,KAAK4mJ,gBACZz/I,KAAK0gJ,WAAU,IAInBX,YACM//I,KAAKnH,KAAKoc,yBAEsB,IAAhCjV,KAAKnH,KAAKgnJ,mBACV7/I,KAAKggJ,SAASW,cAAcL,UAAYtgJ,KAAKnH,KAAKgnJ,kBAAoB7/I,KAAKnH,KAAKgnJ,mBAEhF7/I,KAAKuJ,GAAG6H,aAAa,YAAa,CAChC8D,QAAS,CAAE9M,EAAG,EAAGG,EAAG,EAAGC,EAAG,GAC1B2M,eAAgBnV,KAAKnH,KAAK+mJ,mBAAqB,IAAO,GACtDxqI,cAAe,IACfC,wBAAyB,GACzBC,yBAA0B,KAG5BtV,KAAKigJ,uBAAwB,GAE7BjgJ,KAAKuJ,GAAG6H,aAAa,YAAa,CAChC8D,QAAS,CAAE9M,EAAG,EAAGG,EAAGvI,KAAKnH,KAAK8mJ,eAAgBn3I,EAAG,GACjD2M,eAAgB,IAChBC,cAAe,IACfC,wBAAyB,IACzBC,yBAA0B,OAK5BtV,KAAKnH,KAAK6mJ,mBACZ1/I,KAAK0gJ,WAAU,GAGjB1gJ,KAAKuJ,GAAG6H,aAAa,YAAa,CAAEgN,oBAAqBJ,EAAiBuoG,wBAG5Eu5B,SACE9/I,KAAKuJ,GAAG6H,aAAa,YAAa,CAChCgN,oBAAqBpe,KAAKse,OAASN,EAAiB6tB,MAAQ7tB,EAAiBuoG,uBAE/EvmH,KAAK0gJ,WAAU,IAGjB11I,SAEE,GADAhL,KAAKuJ,GAAG1C,oBAAoB,cAAe7G,KAAKygJ,eAC5CzgJ,KAAK4gJ,QAAS,CAChB,MAAMA,EAAU5gJ,KAAK4gJ,eACd5gJ,KAAK4gJ,QACZA,EAAQC,wCCtId,MAAMC,EAAU,IAAIt6I,MAAMS,QACpB85I,EAA8B,IAAIv6I,MAAMS,QACxC+5I,EAA2B,IAAIx6I,MAAMS,QAE3CrB,OAAOkD,kBAAkB,iBAAkB,CACzCC,OAAQ,CACN0pI,UAAW,CAAEtvI,KAAM,eACnBub,KAAM,CAAEvb,KAAM,OAAQ8F,QAAS,CAAEb,EAAG,EAAGG,EAAG,EAAGC,EAAG,IAChDiF,OAAQ,CAAEtK,KAAM,YAChB6uI,eAAgB,CAAE7uI,KAAM,UACxB8uI,cAAe,CAAE9uI,KAAM,UACvB+uI,WAAY,CACVjpI,QAAS,GACTlG,MAAOhG,GAAmB,iBAANA,EAAiBA,EAAI+F,KAAKC,MAAMhG,GACpDgiE,UAAWj8D,KAAKi8D,WAElBozE,eAAgB,CAAEhvI,KAAM,UACxBivI,cAAe,CAAEjvI,KAAM,UACvBkvI,WAAY,CACVppI,QAAS,GACTlG,MAAOhG,GAAmB,iBAANA,EAAiBA,EAAI+F,KAAKC,MAAMhG,GACpDgiE,UAAWj8D,KAAKi8D,YAGpB11D,OACErJ,KAAKiL,YAAc,IAAIzE,MAAMk8H,KAC7B1iI,KAAKihJ,mBAAqB,IAE5B1wI,SACEvQ,KAAKuJ,GAAGE,SAASyhB,iBAAiB61H,GAClCD,EAAQ5yI,KAAKlO,KAAKnH,KAAK6lB,MACvB1e,KAAKiL,YAAYi2I,qBAAqBH,EAA6BD,IAErE12I,OACE,MAAMqoI,EAAYzyI,KAAKnH,KAAK45I,UAE5B,IAAK,IAAIt5I,EAAI,EAAGA,EAAIs5I,EAAUp5I,OAAQF,IAAK,CACzC,MACMsQ,EADWgpI,EAAUt5I,GACDsQ,SAE1BA,EAASyhB,iBAAiB81H,GAC1B,MAAMG,EAAcnhJ,KAAKiL,YAAY+f,cAAcg2H,GAC7CC,EAAqBjhJ,KAAKihJ,mBAAmBx3I,EAASvG,IAExDi+I,IAAgBF,EAClBjhJ,KAAKnH,KAAK4U,OAAO2D,aAAapR,KAAKnH,KAAKm5I,eAAgBhyI,KAAKnH,KAAKo5I,cAAejyI,KAAKnH,KAAKq5I,aACjFiP,GAAeF,GACzBjhJ,KAAKnH,KAAK4U,OAAO2D,aAAapR,KAAKnH,KAAKs5I,eAAgBnyI,KAAKnH,KAAKu5I,cAAepyI,KAAKnH,KAAKw5I,YAG7FryI,KAAKihJ,mBAAmBx3I,EAASvG,IAAMi+I,yBChD7Cv7I,OAAOkD,kBAAkB,oBAAqB,CAC5CC,OAAQ,CACNw2B,OAAQ,CAAEt2B,SAAS,IAGrBI,OACErJ,KAAK88B,mBAAqB98B,KAAK88B,mBAAmB5gC,KAAK8D,MACvDA,KAAKohJ,eAAiBphJ,KAAKuJ,GAAG6B,WAAW,eAErCpL,KAAKohJ,eACPphJ,KAAKqhJ,iBAELrhJ,KAAKqhJ,cAAgBrhJ,KAAKqhJ,cAAcnlJ,KAAK8D,MAC7CA,KAAKuJ,GAAGjD,iBAAiB,eAAgBtG,KAAKqhJ,iBAIlDA,gBACErhJ,KAAKohJ,eAAiBphJ,KAAKuJ,GAAG6B,WAAW,eACzCpL,KAAK46B,MAAQ56B,KAAKohJ,eAAexmH,MACjC56B,KAAK46B,MAAMt0B,iBAAiB,QAAStG,KAAK88B,qBAG5CA,qBACE98B,KAAKuJ,GAAG6H,aAAa,SAAUpR,KAAK46B,MAAM2E,SAG5ChvB,SACMvQ,KAAK46B,OAAS56B,KAAKnH,KAAK0mC,SAAWv/B,KAAK46B,MAAM2E,QAChDv/B,KAAKohJ,eAAe7jH,iBAIxBvyB,SACEhL,KAAK46B,MAAM/zB,oBAAoB,QAAS7G,KAAK88B,oBAC7C98B,KAAKuJ,GAAG1C,oBAAoB,eAAgB7G,KAAKqhJ,qCChCrDz7I,OAAOkD,kBAAkB,aAAc,CACrCO,KAAM,WACJ,MAAME,EAAKvJ,KAAKuJ,GACVoxD,EAAM36D,KAAK26D,IAAIz+D,KAAK8D,MACpBshJ,EAAethJ,KAAKuJ,GAAGrJ,cAC7BF,KAAKuJ,GAAGrJ,cAAgB,WAEtB,OADAy6D,EAAI9zB,MAAMnyB,KAAKyjI,YACRmJ,EAAatnJ,MAAMuP,EAAI4uI,aAGlCx9E,IAAK,UAAU33D,IACb,GAAI,CAAC,oBAAoB2+B,SAAS3+B,EAAEG,MAAO,OAC3C,IAAIo+I,GAAc,EAYlBtmI,QAAQgpC,oBAAoBjkD,KAAKuJ,GAAGrG,MAAMF,EAAEG,QAAQL,KAAKi8D,UAAU/7D,EAAEhG,OAXpD,CAACF,EAAGsL,IACdA,GACY,iBAANA,QAA+B1K,IAAb0K,EAAE/O,OACzBkoJ,GACFA,GAAc,EACPn5I,GAEF,WANMA,SAmBrBxC,OAAOkD,kBAAkB,oBAAqB,CAC5CC,OAAQ,CACN7N,KAAM,CAAEiI,KAAM,UACdiH,KAAM,CAAEnB,SAAS,IAEnBI,KAAM,WACJrJ,KAAK26D,IAAI,SAEXpqD,OAAQ,WACNvQ,KAAK26D,IAAI,WAEXvwD,KAAM,WACApK,KAAKnH,KAAKuR,MACZpK,KAAK26D,IAAI,SAGb3vD,OAAQ,WACNhL,KAAK26D,IAAI,WAEX3wD,MAAO,WACLhK,KAAK26D,IAAI,UAEX7wD,KAAM,WACJ9J,KAAK26D,IAAI,SAGXA,IAAK,SAAS98D,GACZod,QAAQgpC,0BAA0BjkD,KAAKnH,KAAKqC,QAAQ2C,6BCjExD,MAAM2jJ,YAAEA,GAAgBvjI,EAAQ,KAEhCrY,OAAO4V,eAAe,MAAO,CAC3BnS,KAAM,WACJrJ,KAAK4tB,WAAa,IAAI4zH,GAGxB1P,SAAU,SAASx4H,EAAM4K,GACvBlkB,KAAKuJ,GAAGE,SAAS1C,oBAEb/G,KAAKsZ,MAAQtZ,KAAKsZ,KAAK0nB,UAAYhhC,KAAKsZ,KAAK0nB,SAASjG,SACxD/6B,KAAKsZ,KAAK0nB,SAASjG,UAGrB/6B,KAAKsZ,KAAOA,EACZ,MAAM0nB,GAAW,IAAIx6B,MAAMi7I,UAAWC,mBAAmBpoI,EAAK0nB,UAC9DA,EAASq4G,YAAY//H,EAAKvR,aAC1B/H,KAAK4tB,WAAW+zH,YAAYz9H,EAAMs9H,EAAYI,WAAW5gH,IACzDhhC,KAAKuJ,GAAGQ,QAAQ6J,KAAK,yCCdzBhO,OAAOkD,kBAAkB,iBAAkB,CACzCC,OAAQ,CACN84I,YAAa,CAAE1+I,KAAM,YACrBwd,OAAQ,CAAExd,KAAM,UAGlB2G,KAAM,WACJ9J,KAAKnH,KAAKipJ,eAAiB,GAC3B,MAAMnhI,EAAS3gB,KAAKnH,KAAK8nB,OACzB,IAAK,IAAIxnB,EAAI,EAAGA,EAAIwnB,EAAOtnB,OAAQF,IAAK,CACtC,MAAM6d,EAAQ2J,EAAOxnB,GACrB6G,KAAKnH,KAAKipJ,eAAe9qI,GAAShX,KAAK+hJ,aAAa7lJ,KAAK8D,KAAMgX,GAC/DhX,KAAKnH,KAAKgpJ,YAAYv7I,iBAAiB0Q,EAAOhX,KAAKnH,KAAKipJ,eAAe9qI,MAI3EhN,MAAO,WACL,MAAM2W,EAAS3gB,KAAKnH,KAAK8nB,OACzB,IAAK,IAAIxnB,EAAI,EAAGA,EAAIwnB,EAAOtnB,OAAQF,IAAK,CACtC,MAAM6d,EAAQ2J,EAAOxnB,GACrB6G,KAAKnH,KAAKgpJ,YAAYh7I,oBAAoBmQ,EAAOhX,KAAKnH,KAAKipJ,eAAe9qI,IAE5EhX,KAAKnH,KAAKipJ,eAAiB,IAG7BC,aAAc,SAAS/qI,EAAOhU,GAC5BhD,KAAKuJ,GAAGqK,KAAKoD,EAAOhU,EAAEhG,4CC9B1BxC,EAAAS,EAAAqK,EAAA,sBAAAg3G,IAAA,IAAA0lC,EAAAxnJ,EAAA,IAAAynJ,EAAAznJ,EAAA2B,EAAA6lJ,GAEA,MAAME,EAAK1lJ,OAAO0lJ,GAEH,SAAS5lC,EAAkB6lC,EAAaC,GACrD,MAAMC,EAAYx9I,gTAAYy9I,WACxBC,EAAe19I,gTAAY29I,eAE7BH,IACFpnI,QAAQ0/C,IAAI,yBAA2B0nF,GACvCI,IAAMpX,OAAOgX,GAAWK,WAGtBR,GAAMK,IACRtnI,QAAQ0/C,IAAI,kCAAoC4nF,GAEhDL,EAAG,SAAUK,EAAc,QAEvBJ,GACFD,EAAG,MAAO,OAAQC,GAGhBC,GACFF,EAAG,MAAO,QAASE,GAGrBF,EAAG,OAAQ,8CC1Bf1nJ,EAAAS,EAAAqK,EAAA,sBAAAq9I,IAAAnoJ,EAAAS,EAAAqK,EAAA,sBAAAs9I,IAAA,IAAAC,EAAAroJ,EAAA,GAAAwjI,EAAAxjI,EAAA2B,EAAA0mJ,GAAAC,EAAAtoJ,EAAA,GAAAuoJ,EAAAvoJ,EAAA2B,EAAA2mJ,GAGO,MAAMH,EAAoBzrG,IAAM8rG,cAAc,IAIxCJ,EAAiB,EAAGvgH,QAAOlpB,cAEpC6kH,EAAApuH,EAAA0C,cAACqwI,EAAkBM,SAAnB,KACGn7I,GACQovC,IAAMgsG,aAAa/pI,EAAU,CAClCgqI,aAAcngJ,IACR8E,GAAWA,EAAQ8rE,WACrB9rE,EAAQ8rE,UAAUvxC,GATH,8BAWjBlpB,EAASi+B,MAAM+rG,cAAgBhqI,EAASi+B,MAAM+rG,aAAangJ,OAQvE4/I,EAAe3mG,UAAY,CACzB9iC,SAAUi/B,IAAUh8C,OACpBimC,MAAO+V,IAAUE,6EC1BnB,MAAMrtC,EAAc,IAAIzE,MAAMk8H,KACxB0gB,EAAa,IAAI58I,MAAMk8H,KACvB2gB,EAA0B,IAAI78I,MAAMmR,QACpC2rI,EAAU,IAAI98I,MAAMk8H,KACpB6gB,EAAkB,EAClBC,GAAuB,IACvBC,EAAqB,IACrBC,EAAQ,CACZ,IAAIl9I,MAAMS,QACV,IAAIT,MAAMS,QACV,IAAIT,MAAMS,QACV,IAAIT,MAAMS,QACV,IAAIT,MAAMS,QACV,IAAIT,MAAMS,QACV,IAAIT,MAAMS,QACV,IAAIT,MAAMS,SCbZrB,OAAOkD,kBAAkB,oBAAqB,CAC5CC,OAAQ,CACNyQ,MAAO,CAAErW,KAAM,SACfg3I,UAAW,CAAElxI,QAAS,GACtBsoI,WAAY,CAAEtoI,SAAS,GACvB0yI,oBAAqB,CAAE1yI,QAAS,CAAC,IAAK,MACtC2yI,WAAY,CAAE3yI,QAAS,GACvB4yI,aAAc,CAAE5yI,QAAS,IAG3BI,OACE,MAAME,EAAKvJ,KAAKuJ,GAChBvJ,KAAKwmI,MAAQ,IAAIhgI,MAAMigI,iBACvBzmI,KAAKwmI,MAAMx/H,SAASnG,IAAI,EAAG,EAAG,GAC9Bb,KAAKwmI,MAAM/4H,OAAOzG,SAASnG,IAAI,EAAG,EAAG,GACrCb,KAAKwmI,MAAMn2H,IAAIrQ,KAAKwmI,MAAM/4H,QAC1BzN,KAAKuJ,GAAG82B,YAAY,oBAAqBrgC,KAAKwmI,OAC9CxmI,KAAKuJ,GAAGQ,QAAQ8B,QAAQ26H,MAAM6T,cAAc9wI,GAC5CvJ,KAAKs6I,eAAiBt6I,KAAKuJ,GAAGQ,QAAQ8B,QAAQ4oB,UAGhDlkB,OAAO6iG,GACL,MAAMozB,EAAQxmI,KAAKwmI,MAEnB,GAAIxmI,KAAKnH,KAAK2gB,QAAU45F,EAAS55F,MAAO,CACtC,MAAMA,EAAQ,IAAIhT,MAAM4qG,MAAMpxG,KAAKnH,KAAK2gB,OACxCxZ,KAAKs6I,eAAeC,qBAAqB/gI,GACzCgtH,EAAMhtH,MAAMtL,KAAKsL,GAGfxZ,KAAKnH,KAAKshJ,YAAc/mC,EAAS+mC,YACnC3T,EAAM2T,UAAYn6I,KAAKnH,KAAKshJ,WAG1Bn6I,KAAKnH,KAAK04I,aAAen+B,EAASm+B,aACpC/K,EAAM+K,WAAavxI,KAAKnH,KAAK04I,YAG3BvxI,KAAKnH,KAAK+iJ,aAAexoC,EAASwoC,aACpCpV,EAAMgL,OAAOuK,KAAO/7I,KAAKnH,KAAK+iJ,YAG5B57I,KAAKnH,KAAKgjJ,eAAiBzoC,EAASyoC,eACtCrV,EAAMgL,OAAO/kI,OAASzM,KAAKnH,KAAKgjJ,cAGlC,MAAOv4I,EAAOC,GAAUvD,KAAKnH,KAAK8iJ,qBAC3BK,EAAWC,GAAc7oC,EAASuoC,oBAAsBvoC,EAASuoC,oBAAsB,CAAC,IAAK,KAEhGr4I,IAAU04I,GAAaz4I,IAAW04I,IACpCzV,EAAMgL,OAAO0K,QAAQr7I,IAAIyC,EAAOC,GAE5BijI,EAAMgL,OAAOtvI,MACfskI,EAAMgL,OAAOtvI,IAAI64B,UACjByrG,EAAMgL,OAAOtvI,IAAM,OAIvBlC,KAAKwmI,MAAMgL,OAAO53H,OAAOzP,mBAAoB,GAG/CC,OACM5N,OAAO2E,KAA8B,QAAvB3E,OAAO2E,IAAI66G,SD9ClB,SAAmCwqB,EAAOzzG,GAEvDqwH,EAAWzgB,YACX13H,EAAY03H,YAGZ5vG,EAAMrZ,SAAS6+B,IACb,MAAMvX,EAAWuX,EAAKvX,SAElBA,GAAYuX,EAAKg5F,aACdvwG,EAAS/1B,aACZ+1B,EAAS4hG,qBAGX0gB,EAAQp1I,KAAK8yB,EAAS/1B,aAGtBq4I,EAAQtrI,aAAaugC,EAAKxwC,aAE1BkD,EAAY43H,MAAMygB,MAMtB,MAAM/oH,EAAMtvB,EAAYsvB,IAClBhc,EAAMtT,EAAYsT,IAExBmlI,EAAM,GAAG7iJ,IAAI05B,EAAInyB,EAAGmyB,EAAIhyB,EAAGgyB,EAAI/xB,GAC/Bk7I,EAAM,GAAG7iJ,IAAI05B,EAAInyB,EAAGmyB,EAAIhyB,EAAGgW,EAAI/V,GAC/Bk7I,EAAM,GAAG7iJ,IAAI05B,EAAInyB,EAAGmW,EAAIhW,EAAGgyB,EAAI/xB,GAC/Bk7I,EAAM,GAAG7iJ,IAAI05B,EAAInyB,EAAGmW,EAAIhW,EAAGgW,EAAI/V,GAC/Bk7I,EAAM,GAAG7iJ,IAAI0d,EAAInW,EAAGmyB,EAAIhyB,EAAGgyB,EAAI/xB,GAC/Bk7I,EAAM,GAAG7iJ,IAAI0d,EAAInW,EAAGmyB,EAAIhyB,EAAGgW,EAAI/V,GAC/Bk7I,EAAM,GAAG7iJ,IAAI0d,EAAInW,EAAGmW,EAAIhW,EAAGgyB,EAAI/xB,GAC/Bk7I,EAAM,GAAG7iJ,IAAI0d,EAAInW,EAAGmW,EAAIhW,EAAGgW,EAAI/V,GAE/B66I,EAAwB16H,WAAW69G,EAAMgL,OAAO53H,OAAO7R,aAEvD,IAAK,IAAI5O,EAAI,EAAGA,EAAIuqJ,EAAMrqJ,OAAQF,IAChCuqJ,EAAMvqJ,GAAG6e,aAAaqrI,GACtBD,EAAWO,cAAcD,EAAMvqJ,IAQjC,MAAMygB,EAAS4sH,EAAMgL,OAAO53H,OAC5BA,EAAOmK,KAAOq/H,EAAW7oH,IAAInyB,EAAIm7I,EACjC3pI,EAAOyK,MAAQ++H,EAAW7kI,IAAInW,EAAIm7I,EAClC3pI,EAAO0kD,OAAS8kF,EAAW7oH,IAAIhyB,EAAIg7I,EACnC3pI,EAAOykD,IAAM+kF,EAAW7kI,IAAIhW,EAAIg7I,EAChC3pI,EAAO43F,KAAO4xC,EAAW7oH,IAAI/xB,EAAIg7I,EACjC5pI,EAAO00B,IAAM80G,EAAW7kI,IAAI/V,EAAIi7I,EAChC7pI,EAAOmuF,yBCNL67C,CAA0B5jJ,KAAKwmI,MAAOxmI,KAAKuJ,GAAGQ,QAAQN,WAGxDuB,OAAQ,WACNhL,KAAKuJ,GAAGk4B,eAAe,2DCxEpB,MAAMoiH,EAAS,CAEpBC,WAAY,GAQdl+I,OAAOkD,kBAAkB,SAAU,CACjCC,OAAQ,CACN+6I,WAAY,CAAE3gJ,KAAM,UAAW8F,SAAS,GACxC86I,WAAY,CAAE5gJ,KAAM,UAAW8F,SAAS,GACxC+6I,UAAW,CAAE7gJ,KAAM,UAAW8F,SAAS,IAEzCI,OACErJ,KAAKuQ,OAASvQ,KAAKuQ,OAAOrU,KAAK8D,MAC/BA,KAAKuJ,GAAGjD,iBAAiB,eAAgBtG,KAAKuQ,SAEhDA,OAAO6D,GACL,MAAMnG,EAAMjO,KAAKuJ,GAAGE,SAEhBzJ,KAAKnH,KAAKmrJ,WACZ/1I,EAAIyL,SAASte,GAAMA,EAAE6oJ,OAAOC,KAAO,GAGrC,IAAK,MAAOhpJ,EAAMipJ,KAAU3qJ,OAAOwI,QAAQ6hJ,GAAS,CAClD,MAAMp8C,EAAWrzF,EAAQlZ,GACnBkpJ,EAAWpkJ,KAAKnH,KAAKqC,GAEvBusG,IAAa28C,IACXA,EACFn2I,EAAIyL,SAASte,GAAKA,EAAE6oJ,OAAOjb,OAAOmb,IAElCl2I,EAAIyL,SAASte,GAAKA,EAAE6oJ,OAAOI,QAAQF,OAK3Cn5I,SACEhL,KAAKuJ,GAAG1C,oBAAoB,eAAgB7G,KAAKuQ,kFC3BrD,MAAM04H,EAAQhrH,EAAQ,KAEhBuyH,EAAQvyH,EAAQ,KAAuCuyH,MAG7D,IAAI8T,GADe,IAAI99I,MAAMqhC,YAElBhN,KAAK0pH,IAAkBvpF,IAChCspF,EAAgBtpF,IAGlB,MAQM/vD,EAAc,IAAIzE,MAAMk8H,KAE9B98H,OAAOkD,kBAAkB,eAAgB,CACvCC,OAAQ,CACNi+B,OAAQ,CAAE7jC,KAAM,UAChB4jC,YAAa,CAAE5jC,KAAM,WACrBuP,IAAK,CAAEvP,KAAM,UACbkoC,OAAQ,CAAEpiC,SAAS,GACnB1K,QAAS,CAAE0K,SAAS,GACpBwuB,YAAa,CAAExuB,QAAS,MACxBmQ,QAAS,CAAEnQ,SAAS,GACpBioI,aAAc,CACZjoI,QAAS,GACTlG,MAAOhG,GAAmB,iBAANA,EAAiBA,EAAI+F,KAAKC,MAAMhG,GACpDgiE,UAAWj8D,KAAKi8D,YAIpB11D,OACErJ,KAAKsuH,QAAUtuH,KAAKsuH,QAAQpyH,KAAK8D,MACjCA,KAAKwkJ,WAAaxkJ,KAAKwkJ,WAAWtoJ,KAAK8D,MACvCA,KAAKykJ,oBAAsBzkJ,KAAKykJ,oBAAoBvoJ,KAAK8D,MACzDA,KAAK0kJ,cAAgB1kJ,KAAK0kJ,cAAcxoJ,KAAK8D,MAE7CkT,IAAIrN,MAAMsN,mBAAmBnT,KAAKuJ,IAAI6J,KAAKC,IACzCrT,KAAKqT,YAAcA,KAIvBsxI,YAAc,WACZ,MAAMt1E,EAAS,IAAI7oE,MAAMS,QACzB,OAAO,SAASokC,GACd,MAAM/xB,EAAOtZ,KAAKuJ,GAAGsI,YAAY,QAC3BgzB,EAAMC,YAAO9kC,KAAKuJ,GAAI+P,GACtBsrI,EAAmBv5G,EAASk3F,YAAoB,GAAK19F,GAAO,EAClEvrB,EAAKlS,MAAM49B,eAAe4/G,GAC1B,MAAMrqH,IAAEA,EAAFhc,IAAOA,GAAQsmB,EACrBwqC,EAAO7mD,WAAW+R,EAAKhc,GAAKymB,eAAe,GAAM4/G,GACjDtrI,EAAKtS,SAAS2mB,IAAI0hD,GAClB/1D,EAAKnP,mBAAoB,GAVf,GAcd06I,YAAY3hJ,GACNlD,KAAKuJ,GAAG0M,aAAa,eAAiB/S,IACxClD,KAAKuJ,GAAGiF,gBAAgB,eAAiBtL,IAI7CkH,KAAKxO,EAAGkc,GACF9X,KAAK8kJ,aACP9kJ,KAAK8kJ,YAAYv0I,OAAOuH,EAAK,MAIjC9M,SACMhL,KAAK+kJ,mBACP/kJ,KAAKuJ,GAAGQ,QAAQ8B,QAAQ,gBAAgB0V,mBAAmB+xB,cAActzC,KAAK+kJ,kBAC9E/kJ,KAAK+kJ,iBAAmB,OAI5Bz2B,UACEtuH,KAAKuJ,GAAGiF,gBAAgB,mBACxBxO,KAAKuJ,GAAGiF,gBAAgB,eACxBxO,KAAKuJ,GAAGiF,gBAAgB,eACxBxO,KAAKuJ,GAAG6H,aAAa,cAAe,CAAEsB,IAAK,UAC3C1S,KAAKykJ,uBAGPD,aACE,GAAIxkJ,KAAKuJ,GAAG8P,YAAYC,KAEtB,YADAtZ,KAAKykJ,sBAGP,MAAMO,IAAmBV,EACnBhrI,EAAO0rI,EACTV,EAAcvxH,MAAMgS,QACpB,IAAIv+B,MAAM66B,KAAK,IAAI76B,MAAMy+I,YAAe,IAAIz+I,MAAMu6B,mBACtD/gC,KAAKuJ,GAAG82B,YAAY,OAAQ/mB,GAC5BtZ,KAAK2kJ,aAAY,GACbK,IACFhlJ,KAAK8kJ,YAAc,IAAIt+I,MAAMuhI,eAAezuH,GAE5CtZ,KAAKklJ,YAAcllJ,KAAK8kJ,YAAY1yH,WAAWkyH,EAAch6B,WAAW,IACxEtqH,KAAKmlJ,iBAAmBnlJ,KAAK8kJ,YAAY1yH,WACvC,IAAI5rB,MAAM4+I,cAAc,KAAM,IAAM,CAClC,IAAI5+I,MAAM6+I,oBAAoB,SAAU,CAAC,EAAG,IAAM,CAAC,EAAG,EAAG,EAAG/rI,EAAKlS,MAAMgB,EAAGkR,EAAKlS,MAAMmB,EAAG+Q,EAAKlS,MAAMoB,OAGvG5B,WAAW,KACJ5G,KAAK8kJ,aACV9kJ,KAAKuJ,GAAG6H,aAAa,qBAAsB,CAAEjO,KAAMqtI,EAAMkB,OACxD,KAEH1xI,KAAKklJ,YAAYp7I,OACjB9J,KAAKmlJ,iBAAiBr7I,SAEpB9J,KAAKuJ,GAAGQ,QAAQG,GAAG,YAAgBlK,KAAKqT,cAAeH,IAAIrN,MAAMwO,OAAOrU,KAAKqT,eAC/ErT,KAAK+kJ,iBAAmB/kJ,KAAKuJ,GAAGQ,QAAQ8B,QAAQ,gBAAgB0V,mBAAmB8gH,gBACjF1D,aAGG3+H,KAAKslJ,mBAGdb,sBACEnoI,aAAatc,KAAKslJ,mBACdtlJ,KAAK+kJ,mBACP/kJ,KAAKuJ,GAAGQ,QAAQ8B,QAAQ,gBAAgB0V,mBAAmB+xB,cAActzC,KAAK+kJ,kBAC9E/kJ,KAAK+kJ,iBAAmB,MAEtB/kJ,KAAK8kJ,cACP9kJ,KAAKklJ,YAAYxyH,OACjB1yB,KAAKmlJ,iBAAiBzyH,cACf1yB,KAAK8kJ,mBACL9kJ,KAAKmlJ,wBACLnlJ,KAAKklJ,oBAEPllJ,KAAKslJ,kBACZtlJ,KAAK6kJ,YAAY,WAGnBU,yBACE,MAAMC,EAAmBxlJ,KAAKuJ,GAAG6B,WAAW,qBAExCo6I,IACGxlJ,KAAKylJ,6BACRzlJ,KAAKylJ,4BAA6B,EAClCD,EAAiB56I,SAAWymB,YAAyBrxB,KAAKuJ,GAAGE,WAG/DwB,EAAYs8H,cAAcvnI,KAAKuJ,GAAG8P,YAAYC,MAC9CrO,EAAYy6I,kBAAkBF,EAAiB36I,kBAInD65I,cAAciB,EAAe,MAC3B,MAAMp8I,EAAKvJ,KAAKuJ,GAChBvJ,KAAKykJ,sBAEDzkJ,KAAKuJ,GAAGQ,QAAQG,GAAG,YACrBlK,KAAKuJ,GAAGQ,QAAQ8B,QAAQ,gBAAgB0V,mBAAmBC,iBAAiBo9G,KAG9E,MAAMgnB,EAAS,KACTD,GACFp8I,EAAG6H,aAAa,aAAc,CAC5BjO,KAAMwiJ,EACNE,cAAe,MAInB7lJ,KAAKulJ,yBAEL,MAAMx+F,EAAQx9C,EAAG6B,WAAW,eAExB27C,GACFA,EAAM++F,qBAIN9lJ,KAAKnH,KAAKugB,QACZpZ,KAAK+lJ,sBAAsB/lJ,KAAKuJ,GAAGsI,YAAY,QAAS,CAAEzJ,EAAG,KAAOG,EAAG,KAAOC,EAAG,MAASo9I,GAE1FA,KAIJG,sBAAsBzsI,EAAMozF,EAAcs5C,GACxC,MAAM3a,EAAS,CACbzqG,SAAU,IACVhsB,OAAQ,iBACRy1H,WAAY,IACZruG,KAAM,EACN/F,OAAO,EACP7tB,EAAGkR,EAAKlS,MAAMgB,EACdG,EAAG+Q,EAAKlS,MAAMmB,EACdC,EAAG8Q,EAAKlS,MAAMoB,EACdynF,QAAS,CAACyc,GACVn8F,OAAS,WACP,MAAMw7H,EAAY,GAClB,OAAO,SAASC,GACd,MAAMrwI,EAAQqwI,EAAKC,YAAY,GAAGx+H,OAElC9R,EAAMyM,EAAIF,KAAKqW,IAAI,KAAQ5iB,EAAMyM,GACjCzM,EAAM4M,EAAIL,KAAKqW,IAAI,KAAQ5iB,EAAM4M,GACjC5M,EAAM6M,EAAIN,KAAKqW,IAAI,KAAQ5iB,EAAM6M,GAG7B7M,EAAMyM,IAAM2jI,EAAU3jI,GAAKzM,EAAM4M,IAAMwjI,EAAUxjI,GAAK5M,EAAM6M,IAAMujI,EAAUvjI,IAIhFujI,EAAU3jI,EAAIzM,EAAMyM,EACpB2jI,EAAUxjI,EAAI5M,EAAM4M,EACpBwjI,EAAUvjI,EAAI7M,EAAM6M,EAEpB8Q,EAAKlS,MAAMvG,IAAIlF,EAAMyM,EAAGzM,EAAM4M,EAAG5M,EAAM6M,GACvC8Q,EAAKnP,mBAAoB,IAnBpB,GAsBTmhI,SAAU0a,GAMZ,OAHA1sI,EAAKlS,MAAM8G,KAAKw+F,GAChBpzF,EAAKnP,mBAAoB,EAElB8+H,EAAMoC,IAGf13H,aAAaS,GACX,IACE,MAAM1B,IAAEA,GAAQ1S,KAAKnH,KAMrB,GAJI6Z,IAAQ0B,EAAQ1B,KAAQ1S,KAAKslJ,oBAC/BtlJ,KAAKslJ,kBAAoB1+I,WAAW5G,KAAKwkJ,WAAY,OAGlD9xI,EAAK,OAEV,IAGIrP,EAHA4iJ,EAAevzI,EACfwzI,EAAgBxzI,EAChB+kB,EAAcz3B,KAAKnH,KAAK4+B,YAG5B,GAAIz3B,KAAKnH,KAAK0F,QAAS,CACrB,MAAMrE,QAAeisJ,YAAWzzI,IAChCuzI,EAAe/rJ,EAAO+vF,QAEL/oF,WAAW,QAC1B+kJ,EAAe5oJ,SAAS0wH,SAAWk4B,GAErCxuH,EAAev9B,EAAO0H,MAAQ1H,EAAO0H,KAAKwkJ,uBAA0B3uH,EACpEp0B,EAAYnJ,EAAO0H,MAAQ1H,EAAO0H,KAAKyB,WAAa6iB,YAAchsB,EAAO0H,KAAKyB,WAehF,GAXA6iJ,EAAgBhgI,YAAc+/H,EAAc,MAI5CxuH,EAAcA,GAAe2T,YAAiB66G,SA1P3B3kJ,IAChBqB,MAAMrB,EAAK,CAAEzD,OAAQ,SAAUuV,KAAK5X,GAAKA,EAAE4G,QAAQ7G,IAAI,iBAyPY8qJ,CAAiBH,GAGnFxzI,IAAQ0B,EAAQ1B,KAClB1S,KAAKuJ,GAAGqK,KAAK,iBAAkB,CAAElB,MAAK4zI,IAAKJ,EAAezuH,gBAI1DA,EAAYv2B,WAAW,WACvBu2B,EAAYv2B,WAAW,WACvB0E,OAAOC,MAAM0T,SAASmf,MAAMutH,EAAcxuH,GAC1C,CACA,MAAMk3F,EAAY,IAAIx8G,IAAIO,GACpB6zI,EAASlmE,SAASsuC,EAAUhuH,aAAapF,IAAI,MAE7CmhJ,EADWr8D,SAAS,IAAI7/E,gBAAgBmuH,EAAU63B,KAAKxhJ,UAAU,IAAIzJ,IAAI,OACjDgrJ,GAAU,EACxCvmJ,KAAKuJ,GAAGiF,gBAAgB,mBACxBxO,KAAKuJ,GAAGiF,gBAAgB,eACxBxO,KAAKuJ,GAAG6H,aAAa,gBAAiB,CAAEwuI,oBAAoB,EAAMD,gBAAiB,IACnF3/I,KAAKuJ,GAAGjD,iBACN,eACAtD,IACEhD,KAAK0kJ,cAAsC,SAAxB1hJ,EAAEhG,OAAO2/B,WAAwB6zG,EAAMkB,IAAM,OAElE,CAAEt7G,MAAM,IAEVp2B,KAAKuJ,GAAG6H,aACN,cACA5X,OAAO0gE,OAAO,GAAIl6D,KAAKnH,KAAKq4I,aAAc,CAAEx+H,IAAKwzI,EAAeh7I,KAAMwxI,EAAWjlH,iBAE/Ez3B,KAAKuJ,GAAG6B,WAAW,yCACrBpL,KAAKuJ,GAAG6H,aAAa,uCAAwC,CAAEqH,KAAM,CAAC,UAAW,eAE9E,GAAIgf,EAAYv2B,WAAW,UAChClB,KAAKuJ,GAAGiF,gBAAgB,mBACxBxO,KAAKuJ,GAAGiF,gBAAgB,eACxBxO,KAAKuJ,GAAGiF,gBAAgB,eACxBxO,KAAKuJ,GAAGjD,iBACN,eACAtD,IACEhD,KAAK0kJ,cAAsC,SAAxB1hJ,EAAEhG,OAAO2/B,WAAwB6zG,EAAMkB,IAAM,OAElE,CAAEt7G,MAAM,IAEVp2B,KAAKuJ,GAAG6H,aAAa,gBAAiB,CAAEwuI,oBAAoB,EAAMD,gBAAiB,IACnF3/I,KAAKuJ,GAAG6H,aACN,cACA5X,OAAO0gE,OAAO,GAAIl6D,KAAKnH,KAAKq4I,aAAc,CAAEx+H,IAAKwzI,EAAezuH,iBAG9Dz3B,KAAKuJ,GAAG6B,WAAW,yCACrBpL,KAAKuJ,GAAG6H,aAAa,uCAAwC,CAAEqH,KAAM,CAAC,UAAW,eAE9E,GAAIgf,EAAYv2B,WAAW,mBAChClB,KAAKuJ,GAAGiF,gBAAgB,mBACxBxO,KAAKuJ,GAAGiF,gBAAgB,eAIxBxO,KAAKuJ,GAAG6H,aAAa,cAAe5X,OAAO0gE,OAAO,GAAIl6D,KAAKnH,KAAKq4I,aAAc,CAAEx+H,IAAKuzI,KACrFjmJ,KAAKuJ,GAAG6H,aAAa,gBAAiB,CAAEwuI,oBAAoB,EAAMD,gBAAiB,IACnF3/I,KAAKuJ,GAAGjD,iBAAiB,eAAgBtG,KAAKykJ,oBAAqB,CAAEruH,MAAM,IAC3Ep2B,KAAKuJ,GAAGjD,iBAAiB,iBAAkB,IAAMtG,KAAK0kJ,cAAclU,EAAMkB,KAAM,CAAEt7G,MAAM,IAEpFp2B,KAAKuJ,GAAG6B,WAAW,yCACrBpL,KAAKuJ,GAAG6H,aAAa,uCAAwC,CAAEqH,KAAM,CAAC,UAAW,eAE9E,GACLgf,EAAYkK,SAAS,6BACrBlK,EAAYkK,SAAS,qBACrBlK,EAAYv2B,WAAW,cAEvBlB,KAAKuJ,GAAGiF,gBAAgB,eACxBxO,KAAKuJ,GAAGiF,gBAAgB,eACxBxO,KAAKuJ,GAAGiF,gBAAgB,eACxBxO,KAAKuJ,GAAGjD,iBACN,eACA,KACEtG,KAAK2kJ,YAAY3kJ,KAAKnH,KAAKwyC,QAC3BrrC,KAAK0kJ,cAAclU,EAAMiW,MACzBtlC,YAAuBnhH,KAAKuJ,KAE9B,CAAE6sB,MAAM,IAEVp2B,KAAKuJ,GAAGjD,iBAAiB,cAAetG,KAAKsuH,QAAS,CAAEl4F,MAAM,IAC9Dp2B,KAAKuJ,GAAG6H,aACN,kBACA5X,OAAO0gE,OAAO,GAAIl6D,KAAKnH,KAAKq4I,aAAc,CACxCx+H,IAAKwzI,EACLzuH,YAAaA,EACbsnF,SAAS,EACTkL,kBAAmBjqH,KAAKnH,KAAKwyC,OAAS,KAAS,SAG9C,KAAI5T,EAAYv2B,WAAW,aA8BhC,MAAM,IAAImf,mCAAmCoX,KA7B7Cz3B,KAAKuJ,GAAGiF,gBAAgB,mBACxBxO,KAAKuJ,GAAGiF,gBAAgB,eACxBxO,KAAKuJ,GAAGiF,gBAAgB,eACxBxO,KAAKuJ,GAAGjD,iBACN,eACA,KACE,MAAMogJ,EAAiB1mJ,KAAKuJ,GAAGQ,QAAQ8B,QAAQkI,YAAY0H,IAAI,cAE3DiwB,YAAch5B,IAAS+4B,YAAe/4B,IAAQg0I,EAChD1mJ,KAAKuJ,GAAG6H,aAAa,wBAAyB,CAC5CoH,SAAU,+BACVC,KAAM,CAAC,UAAW,UAGpBzY,KAAKuJ,GAAG6H,aAAa,mBAAoB,CAAEoH,SAAU,mBAAoBC,KAAM,CAAC,UAAW,UAE7FzY,KAAK0kJ,cAAclU,EAAMkB,MAE3B,CAAEt7G,MAAM,IAEVp2B,KAAKuJ,GAAG6H,aAAa,gBAAiB,CAAEwuI,oBAAoB,EAAMD,gBAAiB,IACnF3/I,KAAKuJ,GAAG6H,aACN,cACA5X,OAAO0gE,OAAO,GAAIl6D,KAAKnH,KAAKq4I,aAAc,CAAEx+H,IAAKrP,EAAWo0B,YAAa,eAEvEz3B,KAAKuJ,GAAG6B,WAAW,yCACrBpL,KAAKuJ,GAAG6H,aAAa,uCAAwC,CAAEqH,KAAM,CAAC,UAAW,WAKrF,MAAOzV,GACPiY,QAAQkF,MAAM,qBAAsBnd,GACpChD,KAAKsuH,cAKX1oH,OAAOkD,kBAAkB,cAAe,CACtCC,OAAQ,CACN2J,IAAK,CAAEvP,KAAM,UACbooB,MAAO,CAAEtiB,QAAS,IAGpBI,OACErJ,KAAK2mJ,QAAU,KACf3mJ,KAAKojD,SAAW,KAChBpjD,KAAK4mJ,OAAS5mJ,KAAK4mJ,OAAO1qJ,KAAK8D,MAC/BA,KAAK6mJ,OAAS7mJ,KAAK6mJ,OAAO3qJ,KAAK8D,MAE/BkT,IAAIrN,MAAMsN,mBAAmBnT,KAAKuJ,IAAI6J,KAAKC,IACzCrT,KAAKqT,YAAcA,IAGrBrT,KAAKuJ,GAAGjD,iBAAiB,eAAgBrG,UACvCD,KAAKojD,SAAWpgD,EAAEhG,OAAO0V,UACnB1S,KAAK8mJ,YACX9mJ,KAAKuQ,YAIToD,kBACE,GAAI3T,KAAK+mJ,aAAe/mJ,KAAKojD,SAAU,OACvCpjD,KAAK+mJ,YAAa,EAIlB/mJ,KAAKgnJ,cAxZoB1lJ,IACpBqB,MAAMrB,GAAK8R,KAAK5X,GAAK6kF,SAAS7kF,EAAE4G,QAAQ7G,IAAI,yBAuZ3B0rJ,CAAqBjnJ,KAAKojD,UAChD,MAAM5qC,EAAW1T,SAASg8B,eAAe,kBACzC9gC,KAAKuJ,GAAG8H,cAAc,oBAAoB2H,YAAYlU,SAASmU,WAAWT,EAASU,SAAS,IAC5FlZ,KAAK2mJ,QAAU3mJ,KAAKuJ,GAAG8H,cAAc,mBAErCzK,WAAW,KACT5G,KAAKsuD,WAAatuD,KAAKuJ,GAAG8H,cAAc,8BACxCrR,KAAKytG,WAAaztG,KAAKuJ,GAAG8H,cAAc,8BACxCrR,KAAKknJ,UAAYlnJ,KAAKuJ,GAAG8H,cAAc,eAEvCrR,KAAKsuD,WAAW7kD,SAASnD,iBAAiB,WAAYtG,KAAK4mJ,QAC3D5mJ,KAAKytG,WAAWhkG,SAASnD,iBAAiB,WAAYtG,KAAK6mJ,QAE3D7mJ,KAAKuQ,SACLvQ,KAAKuJ,GAAGqK,KAAK,mBACZ,IAGLD,eACE,IAAK3T,KAAKnH,KAAK6Z,IAAK,OAEpB,MAAMy0I,EAAUjhI,YAAclmB,KAAKnH,KAAK6Z,IAAK1S,KAAKnH,KAAK0yB,OACvDvrB,KAAKuJ,GAAG6H,aAAa,cAAe,CAAEsB,IAAKy0I,EAAS1vH,YAAa,oBAE3Dz3B,KAAK8mJ,YAEP9mJ,KAAKknJ,YACPlnJ,KAAKknJ,UAAU91I,aAAa,OAAQ,WAAYpR,KAAKnH,KAAK0yB,MAAQ,KAAKvrB,KAAKgnJ,SAAW,KACvFhnJ,KAAK8lJ,sBAIT96I,SACMhL,KAAK2mJ,SACP3mJ,KAAK2mJ,QAAQnxI,WAAWC,YAAYzV,KAAK2mJ,UAI7CC,UACO1zI,IAAIrN,MAAMwO,OAAOrU,KAAKqT,cAAiBH,IAAIrN,MAAMmP,cAAchV,KAAKqT,gBACzErT,KAAKuJ,GAAG6H,aAAa,cAAe,QAASlJ,KAAKqyB,IAAIv6B,KAAKnH,KAAK0yB,MAAQ,EAAGvrB,KAAKgnJ,WAChFhnJ,KAAKuJ,GAAGqK,KAAK,wBAGfizI,UACO3zI,IAAIrN,MAAMwO,OAAOrU,KAAKqT,cAAiBH,IAAIrN,MAAMmP,cAAchV,KAAKqT,gBACzErT,KAAKuJ,GAAG6H,aAAa,cAAe,QAASlJ,KAAKqW,IAAIve,KAAKnH,KAAK0yB,MAAQ,EAAG,IAC3EvrB,KAAKuJ,GAAGqK,KAAK,wBAGfkyI,oBACoB9lJ,KAAKuJ,GAAG0M,aAAa,gBAGvCjW,KAAK2mJ,QAAQl9I,SAASzC,SAASuB,GAAK,GACpCvI,KAAK2mJ,QAAQl9I,SAASU,mBAAoB,aCze9CvE,OAAOkD,kBAAkB,QAAS,CAChCC,OAAQ,CACNq+I,gBAAiB,CAAEn+I,QAAS,GAC5Bo+I,uBAAwB,CAAEp+I,QAAS,MAGrCI,KAAM,WACJrJ,KAAKsnJ,iBAAmBtnJ,KAAKsnJ,iBAAiBprJ,KAAK8D,OAGrD8J,KAAM,WACJ9J,KAAKuJ,GAAGE,SAASnD,iBAAiB,WAAYtG,KAAKsnJ,mBAGrDt9I,MAAO,WACLhK,KAAKuJ,GAAGE,SAAS5C,oBAAoB,WAAY7G,KAAKsnJ,mBAGxDA,iBAAkB,WAChB,MAAMC,EAAOr/I,KAAKy2B,SACd4oH,EAAOvnJ,KAAKnH,KAAKwuJ,uBACnBrnJ,KAAKuJ,GAAGQ,QAAQ8B,QAAQ,gBAAgB0V,mBAAmBC,iBAAiB88D,KACnEipE,EAAOvnJ,KAAKnH,KAAKuuJ,iBAC1BpnJ,KAAKuJ,GAAGQ,QAAQ8B,QAAQ,gBAAgB0V,mBAAmBC,iBAAiB+8D,kCClBlF34E,OAAOkD,kBAAkB,mBAAoB,CAC3CC,OAAQ,CACN0E,OAAQ,CAAEtK,KAAM,YAChByW,OAAQ,CAAEzW,KAAM,WAAY8F,QAAS,kBACrCu+I,aAAc,CAAEv+I,QAAS,KACzBw+I,YAAa,CAAEtkJ,KAAM,WAEvBkG,OACErJ,KAAKk/G,iBAAmBl/G,KAAKk/G,iBAAiBhjH,KAAK8D,MACnDA,KAAKnH,KAAK4U,OAAOnH,iBAAiBtG,KAAKnH,KAAK4uJ,YAAaznJ,KAAKk/G,mBAEhEA,mBACE,MAAMwoC,EAAc5iJ,SAASwK,iBAAiB,iBAE9C,GAA2B,IAAvBo4I,EAAYruJ,OAEd,OAGF,MAAMugB,EAAS5Z,KAAKnH,KAAK+gB,OAEnB+tI,EAAaD,EADKx/I,KAAK+tB,OAAOyxH,EAAYruJ,OAAS,GAAK6O,KAAKy2B,WAGnE3K,YAAqB2zH,EAAWl+I,SAAUzJ,KAAKuJ,GAAGE,SAASzC,UAC3DhH,KAAKuJ,GAAGE,SAASgG,SAASvB,KAAKy5I,EAAWl+I,SAASgG,UAE/CzP,KAAKuJ,GAAGQ,QAAQG,GAAG,WAErBlK,KAAKuJ,GAAGE,SAASgG,SAASlH,GAAKvI,KAAKnH,KAAK+gB,OAAOnQ,SAASgG,SAASlH,GAGlEqR,EAAOnQ,SAASzC,SAASnG,IAAI,EAAGb,KAAKnH,KAAK2uJ,aAAc,GACxD5tI,EAAOnQ,SAASgG,SAAS5O,IAAI,EAAG,EAAG,GACnC+Y,EAAOnQ,SAASU,mBAAoB,GAItCnK,KAAKuJ,GAAGE,SAASgG,SAASlH,GAAKL,KAAK6F,GACpC/N,KAAKuJ,GAAGE,SAASU,mBAAoB,EAGjCyP,EAAOxO,WAAW,sBACpBwO,EAAOxO,WAAW,qBAAqBvK,IAAI+Y,EAAOnQ,SAASgG,SAASrH,EAAGwR,EAAOnQ,SAASgG,SAASlH,MAUtG3C,OAAOkD,kBAAkB,cAAe,CACtCO,OACErJ,KAAKuJ,GAAGE,SAASY,SAAU,sCCvD/B,MAAM2T,EAAmBC,EAAQ,KAAgBD,iBAOjDpY,OAAOkD,kBAAkB,gBAAiB,CACxCC,OAAQ,CAIN2J,IAAK,CAAEzJ,QAAS,IAKhB1K,QAAS,CAAE0K,SAAS,GAKpBoiC,OAAQ,CAAEpiC,SAAS,GAKnBuP,SAAU,CAAEvP,QAAS,IAKrBolG,uBAAwB,CAAEplG,SAAS,GACnCqlG,cAAe,CAAEnrG,KAAM,QAKvBorG,uBAAwB,CAAEtlG,SAAS,GACnCulG,cAAe,CAAErrG,KAAM,QAKvBsrG,oBAAqB,CAAExlG,SAAS,GAChCylG,WAAY,CAAEvrG,KAAM,QAKpBykJ,cAAe,CAAE3+I,QAAS,GAK1B2lG,oBAAqB,CAAE3lG,SAAS,GAKhCsyE,WAAY,CAAEp4E,KAAM,UAKpB0kJ,kBAAmB,CAAE1kJ,KAAM,YAG7BkG,OACErJ,KAAKiuG,gBAAkB,KACvBjuG,KAAK8nJ,aAAe,IAAIthJ,MAAMS,QAE9BjH,KAAK+nJ,aAAe/nJ,KAAK+nJ,aAAa7rJ,KAAK8D,MAE3CA,KAAK+J,QAAUjF,SAASuM,cAAc,WAEtCrR,KAAKgoJ,sBAAwB,IAAIxhJ,MAAMS,SAGzC6C,OACM9J,KAAKnH,KAAK0iF,YACZv7E,KAAKuJ,GAAGQ,QAAQzD,iBAAiBtG,KAAKnH,KAAK0iF,WAAYv7E,KAAK+nJ,eAIhE/9I,QACMhK,KAAKnH,KAAK0iF,YACZv7E,KAAKuJ,GAAGQ,QAAQlD,oBAAoB7G,KAAKnH,KAAK0iF,WAAYv7E,KAAK+nJ,cAE7D/nJ,KAAKiuG,kBACP3xF,aAAatc,KAAKiuG,iBAClBjuG,KAAKiuG,gBAAkB,KACvBjuG,KAAKuJ,GAAG6H,aAAa,WAAW,GAChCpR,KAAKuJ,GAAGyQ,UAAU3J,IAAI,kBAI1BsD,qBACE,GAAI3T,KAAKiuG,kBAAoBjuG,KAAKuJ,GAAGQ,QAAQG,GAAG,WAC9C,OAGF,MAAMgC,EAASo/B,YAAStrC,KAAKnH,KAAK6Z,IAAK1S,KAAKnH,KAAK2f,SAAU+yB,IAAqB6iE,QAASpuG,KAAKnH,KAAK0F,SAAS,GACzG2N,OAEGq1B,EAASz8B,SAASuM,cAAc,WACtCkwB,EAAO93B,SAASyhB,iBAAiBhf,EAAOzC,SAASzC,UACjDu6B,EAAO93B,SAAS6E,mBAAmBpC,EAAOzC,SAASvC,YACnDgF,EAAOzC,SAASU,mBAAoB,EAEhCnK,KAAKnH,KAAK41G,qBACZviG,EAAOzC,SAASrC,MAAM8G,KAAKlO,KAAKnH,KAAK61G,YAGvC,MAAMv3F,EAAYvR,OAAO3G,OAAO,GAAG4M,QAAQsL,UACrCvL,EAAchG,OAAO3G,OAAO,GAAG4M,QAAQD,YACvCq8I,EACJjoJ,KAAKnH,KAAKgvJ,mBAAqB1wI,EAAU5b,IAAImwB,IAAMC,QAAQvf,UAAU6N,UAAYrU,OAAOC,MAAMC,OAAOE,aC3H/E,IAASkiJ,EAAWC,ED4HvCF,IACHr8I,EAAYzO,MAAMgP,YAAYH,KAAOE,EACrCN,EAAYzO,MAAMgP,YAAYq+F,UAAW,GAE3CxqG,KAAK2uG,yBChI4Bu5C,EDiId,cCjIyBC,EDiIVj8I,EChI7B,IAAI5N,QAAQC,IACjB4pJ,EAAS7hJ,iBAAiB4hJ,EAAW3pJ,EAAS,CAAE63B,MAAM,ODiItDmL,EAAO93B,SAASyhB,iBAAiBhf,EAAOzC,SAASzC,UACjDu6B,EAAO93B,SAAS6E,mBAAmBpC,EAAOzC,SAASvC,YACnDgF,EAAOzC,SAASU,mBAAoB,EAEhC89I,GACFnjJ,SAASuM,cAAc,4BAA4B5H,SAASyhB,iBAAiBlrB,KAAK8nJ,cAClF57I,EAAOkF,aAAa,6BAA8B,CAChD/U,SAAU,WACVwY,MAAO,IACPJ,IAAK,KACLC,KAAM,CAAEtM,EAAG8D,EAAOzC,SAASzC,SAASoB,EAAGG,EAAG2D,EAAOzC,SAASzC,SAASuB,EAAGC,EAAG0D,EAAOzC,SAASzC,SAASwB,GAClGmM,GAAI,CAAEvM,EAAGpI,KAAK8nJ,aAAa1/I,EAAGG,EAAGvI,KAAK8nJ,aAAav/I,EAAGC,EAAGxI,KAAK8nJ,aAAat/I,GAC3EoM,OAAQ,mBAGVhJ,EAAYzO,MAAMgP,YAAYq+F,UAAW,EAE3Ct+F,EAAOd,WAAW,aAAag9I,iBAGjCz5C,mBACE,GAAI3uG,KAAKnH,KAAK+uJ,cAAgB,EAAG,CAC/B,MAAOS,EAAIC,EAAIC,GAAM,CAACvoJ,KAAKuJ,GAAGE,SAASrC,MAAMgB,EAAGpI,KAAKuJ,GAAGE,SAASrC,MAAMmB,EAAGvI,KAAKuJ,GAAGE,SAASrC,MAAMoB,GAEjGxI,KAAKuJ,GAAG6H,aAAa,WAAW,GAChCpR,KAAKuJ,GAAGE,SAASrC,MAAMvG,IAAI,KAAO,KAAO,MACzCb,KAAKuJ,GAAGE,SAASU,mBAAoB,EACrCnK,KAAKuJ,GAAGyQ,UAAUhP,OAAO,gBACzBhL,KAAKuJ,GAAG6H,aAAa,YAAa,CAAEgN,oBAAqBJ,EAAiBmoG,OAC1EnmH,KAAKiuG,gBAAkBrnG,WAAW,KAChC5G,KAAKuJ,GAAG6H,aAAa,WAAW,GAChCpR,KAAKuJ,GAAGyQ,UAAU3J,IAAI,gBACtBrQ,KAAKuJ,GAAG6H,aAAa,YAAa,CAAEgN,oBAAqBJ,EAAiBwoG,kBAC1ExmH,KAAKuJ,GAAGiF,gBAAgB,+BACxBxO,KAAKuJ,GAAG6H,aAAa,8BAA+B,CAClD/U,SAAU,QACVwY,MAAO,GACPJ,IAAK,IACLC,KAAM,CAAEtM,EAAG,KAAOG,EAAG,KAAOC,EAAG,MAC/BmM,GAAI,CAAEvM,EAAGigJ,EAAI9/I,EAAG+/I,EAAI9/I,EAAG+/I,GACvB3zI,OAAQ,mBAGV5U,KAAKiuG,gBAAkB,MACI,IAA1BjuG,KAAKnH,KAAK+uJ,gDElKnB,SAASY,EAAYxnH,EAAU/0B,GAC7BzF,MAAM66B,KAAK1nC,KAAKqG,KAAMghC,GAEtB,MAIM91B,OAAwBxN,KAF9BuO,EAAUA,GAAW,IAEAf,KAAqBe,EAAQf,KAAO,EACnDu9I,OAAyC/qJ,IAAzBuO,EAAQy8I,aAA6Bz8I,EAAQy8I,aAAe,KAC5EC,OACqBjrJ,IAAzBuO,EAAQ08I,aAA6B18I,EAAQ08I,aAAe,IAAIniJ,MAAMS,QAAQ,OAAS,OAAS,GAC5F2hJ,EAAW,IAAIpiJ,MAAM4qG,WAA2B1zG,IAArBuO,EAAQ28I,SAAyB38I,EAAQ28I,SAAW,UAC/EC,EAAa,IAAIriJ,MAAM4qG,WAA6B1zG,IAAvBuO,EAAQ48I,WAA2B58I,EAAQ48I,WAAa,SACrFC,OAAsBprJ,IAAhBuO,EAAQ68I,IAAoB78I,EAAQ68I,IAAM,IAAItiJ,MAAMS,QAAQ,EAAG,EAAG,GACxE8hJ,OAA8CrrJ,IAA5BuO,EAAQ88I,gBAAgC98I,EAAQ88I,gBAAkB,GACpF5nH,OAAwBzjC,IAAjBuO,EAAQk1B,KAAqBl1B,EAAQk1B,KAAO36B,MAAMwiJ,UACzDzhC,OAAsB7pH,IAAhBuO,EAAQs7G,KAAoBt7G,EAAQs7G,IAE1C0hC,EAAe,CACnBr+I,SAAUpE,MAAMunI,cAAcgJ,MAAM,CAClCvwI,MAAM0iJ,YAAN,OACA,CACET,cAAe,CAAE9sJ,MAAO,MACxBuP,KAAM,CAAEvP,MAAO,GACf+iB,KAAM,CAAE/iB,MAAO,GACfotJ,gBAAiB,CAAEptJ,MAAO,IAC1BitJ,SAAU,CAAEjtJ,MAAO,IAAI6K,MAAM4qG,MAAM,UACnCu3C,aAAc,CAAEhtJ,MAAO,IAAI6K,MAAMS,QAAQ,OAAS,OAAS,IAC3D6hJ,IAAK,CAAEntJ,MAAO,IAAI6K,MAAMS,SACxB4hJ,WAAY,CAAEltJ,MAAO,IAAI6K,MAAM4qG,MAAM,aAIzC0V,aAAe,kSAYfC,62CA+BIvgH,MAAM2iJ,YAAN,iBACA3iJ,MAAM2iJ,YAAN,kBACA3iJ,MAAM2iJ,YAAN,gBACA3iJ,MAAM2iJ,YAAN,i7BAwBA5vI,EAAW,IAAI/S,MAAMogH,eAAe,CACxCG,eAAgBkiC,EAAaliC,eAC7BD,aAAcmiC,EAAaniC,aAC3Bl8G,SAAUpE,MAAMunI,cAAchpG,MAAMkkH,EAAar+I,UACjDs3B,aAAa,EACbslF,QAAQ,EACRrmF,KAAMA,EACNomF,IAAKA,IAGPhuG,EAAS3O,SAASM,KAAKvP,MAAQuP,EAC/BqO,EAAS3O,SAAS69I,cAAc9sJ,MAAQ8sJ,EACxClvI,EAAS3O,SAASg+I,SAASjtJ,MAAQitJ,EACnCrvI,EAAS3O,SAASi+I,WAAWltJ,MAAQktJ,EACrCtvI,EAAS3O,SAAS+9I,aAAahtJ,MAAQgtJ,EACvCpvI,EAAS3O,SAASm+I,gBAAgBptJ,MAAQotJ,EAE1CxvI,EAAS3O,SAASk+I,IAAIntJ,MAAQmtJ,EArHhB9oJ,KAuHRuZ,SAAWA,EAGnBivI,EAAY/uJ,UAAYD,OAAOwC,OAAOwK,MAAM66B,KAAK5nC,WACjD+uJ,EAAY/uJ,UAAUoG,YAAc2G,MAAM4iJ,MAW1CxjJ,OAAOkD,kBAAkB,QAAS,CAChCC,OAAQ,CACN8/I,WAAY,CAAE1lJ,KAAM,QAAS8F,QAAS,WACtC8/I,gBAAiB,CAAE5lJ,KAAM,SAAU8F,QAAS,KAC5C2/I,SAAU,CAAEzlJ,KAAM,QAAS8F,QAAS,WACpCulI,YAAa,CAAErrI,KAAM,SAAU8F,QAAS,GACxCwlI,QAAS,CAAEtrI,KAAM,SAAU8F,QAAS,GACpC6lB,SAAU,CAAE3rB,KAAM,SAAU8F,QAAS,GACrCoO,MAAO,CAAElU,KAAM,SAAU8F,QAAS,IAClCogJ,YAAa,CAAElmJ,KAAM,UAAW8F,SAAS,IAE3CI,OACE,MAAMigJ,EAAYtpJ,KAAKuJ,GAAGsI,YAAY,QAChC03I,EAAgBD,EAAUtoH,SAGhCsoH,EAAUj/I,SAAU,EAzBxBpK,eAAgCqB,GAC9B,MAAMy2B,QAAgB,IAAIz5B,QAAQ,CAACC,EAAS6hB,KAC1C,IAAI5Z,MAAMi0B,eAAgBI,KAAKv5B,EAAK/C,OAASb,EAAW0iB,IAI1D,OAFA2X,EAAQyxH,MAAQzxH,EAAQ0xH,MAAQjjJ,MAAMkjJ,eACtC3xH,EAAQR,aAAc,EACfQ,EAqBL4xH,CAAiBC,KAAgBx2I,KAAKs1I,IACpC,MAAMmB,EAAc,CAClBC,aAAc,IACdC,cAAe,IACfrB,aAAcA,EACdC,aAAc3oJ,KAAKnH,KAAK8vJ,aACxBC,SAAU,IAAIpiJ,MAAM4qG,MAAMpxG,KAAKnH,KAAK+vJ,UACpCC,WAAY,IAAIriJ,MAAM4qG,MAAMpxG,KAAKnH,KAAKgwJ,YACtCE,gBAAiB/oJ,KAAKnH,KAAKkwJ,gBAC3BxhC,KAAK,GAGH3hH,OAAOC,MAAMC,OAAOC,YAAcH,OAAOC,MAAMC,OAAOE,cAAgBhG,KAAKnH,KAAKwwJ,YAClFrpJ,KAAKgqJ,MAAQ,IAAIxB,EAAYe,EAAeM,IAE5C7pJ,KAAKgqJ,MAAQ,IAAIxjJ,MAAM4iJ,MAAMG,EAAeM,GAC5C7pJ,KAAKgqJ,MAAM/+H,aAAag5H,OAAOpjJ,IAAIgjJ,EAAOC,aAG5C9jJ,KAAKuJ,GAAG82B,YAAY,QAASrgC,KAAKgqJ,UAItCz5I,OAAO6D,GACL,GAAIpU,KAAKnH,KAAKwwJ,cAAgBj1I,EAAQi1I,YAGpC,OAFArpJ,KAAKuJ,GAAGk4B,eAAe,cACvBzhC,KAAKqJ,OAIP,IAAKrJ,KAAKgqJ,MACR,OAGF,MAAMp/I,EAAW5K,KAAKgqJ,MAAMzwI,SAAS3O,SAcrC,GAZI5K,KAAKnH,KAAKgwJ,aAAez0I,EAAQy0I,YACnCj+I,EAASi+I,WAAWltJ,MAAMsuJ,SAASjqJ,KAAKnH,KAAKgwJ,YAG3C7oJ,KAAKnH,KAAKkwJ,kBAAoB30I,EAAQ20I,kBACxCn+I,EAASm+I,gBAAgBptJ,MAAQqE,KAAKnH,KAAKkwJ,iBAGzC/oJ,KAAKnH,KAAK+vJ,WAAax0I,EAAQw0I,UACjCh+I,EAASg+I,SAASjtJ,MAAMsuJ,SAASjqJ,KAAKnH,KAAK+vJ,UAI3C5oJ,KAAKnH,KAAK21I,cAAgBp6H,EAAQo6H,aAClCxuI,KAAKnH,KAAK41I,UAAYr6H,EAAQq6H,SAC9BzuI,KAAKnH,KAAKi2B,WAAa1a,EAAQ0a,SAC/B,CACA,MAAMggH,EAAQ5mI,KAAK6F,IAAM/N,KAAKnH,KAAK21I,YAAc,IAC3CO,EAAM,EAAI7mI,KAAK6F,IAAM/N,KAAKnH,KAAK41I,QAAU,IAEzC3/G,EAAW9uB,KAAKnH,KAAKi2B,SAErB1mB,EAAI0mB,EAAW5mB,KAAK+c,IAAI8pH,GACxBxmI,EAAIumB,EAAW5mB,KAAKgd,IAAI6pH,GAAO7mI,KAAKgd,IAAI4pH,GACxCtmI,EAAIsmB,EAAW5mB,KAAKgd,IAAI6pH,GAAO7mI,KAAK+c,IAAI6pH,GAE9ClkI,EAAS+9I,aAAahtJ,MAAMkF,IAAIuH,EAAGG,EAAGC,KAI1C4B,KAAKc,GACClL,KAAKgqJ,QACPhqJ,KAAKgqJ,MAAMzwI,SAAS3O,SAASM,KAAKvP,MAASuP,EAAO,IAAQlL,KAAKnH,KAAKwe,QAIxErM,SACEhL,KAAKuJ,GAAGk4B,eAAe,SACLzhC,KAAKuJ,GAAGsI,YAAY,QAC5BxH,SAAU,2DCnPT,SAASs1E,IACtB,OAAO,IAAIrhF,QAAQC,IACjBqI,WAAWrI,EAAS,KAFxB/D,EAAAS,EAAAqK,EAAA,sBAAAq6E,yBCAA9kF,EAAAD,QAAiBJ,EAAA8B,EAAuB,+ECAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,qFCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,wFCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,8FCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,iGCAxC9B,EAAAS,EAAAqK,EAAA,sBAAA0uB,IAAAx5B,EAAAS,EAAAqK,EAAA,sBAAAmiI,IAAoB,IAAIjhI,MAAMS,QACP,IAAIT,MAAMW,WAE1B,SAAS6sB,EAAqBthB,EAAKjF,GAExC,OADAA,EAAOyb,sBAAsBxW,EAAI3K,aAC1B0F,EAaF,SAASy8I,EAAgBC,GAC1BA,EAAKjoJ,KAAKioJ,EAAKjoJ,IAAI64B,UACnBovH,EAAKC,UAAUD,EAAKC,SAASrvH,UAC7BovH,EAAKE,SAASF,EAAKE,QAAQtvH,UAC3BovH,EAAKG,WAAWH,EAAKG,UAAUvvH,UAC/BovH,EAAKI,aAAaJ,EAAKI,YAAYxvH,UACnCovH,EAAKpzB,QAAQozB,EAAKpzB,OAAOh8F,UAC7BovH,EAAKpvH,UAGA,SAAS0sG,EAAYlvF,GAC1B,GAAMA,aAAgB/xC,MAAM66B,OAExBkX,EAAKvX,UACPuX,EAAKvX,SAASjG,UAGZwd,EAAKh/B,UAAU,CACjB,IAAIixI,EACAjyG,EAAKh/B,oBAAoB/S,MAAMikJ,kBAAoBlyG,EAAKh/B,oBAAoB/S,MAAMkkJ,cACpFF,EAAgBjyG,EAAKh/B,SAAS4xG,UACrB5yE,EAAKh/B,oBAAoBstB,QAClC2jH,EAAgBjyG,EAAKh/B,UAEnBixI,EACFA,EAAc5tI,QAAQstI,GAEtBA,EAAgB3xG,EAAKh/B,4CC7C3B/e,EAAAS,EAAAqK,EAAA,sBAAA0+C,IAAAxpD,EAAAS,EAAAqK,EAAA,sBAAA4gB,IAAA1rB,EAAAS,EAAAqK,EAAA,sBAAA6gJ,IAAA3rJ,EAAAS,EAAAqK,EAAA,sBAAA4lH,IAAA1wH,EAAAS,EAAAqK,EAAA,sBAAA8lC,IAAA5wC,EAAAS,EAAAqK,EAAA,sBAAAi2D,IAAA/gE,EAAAS,EAAAqK,EAAA,sBAAAgmC,IAAA9wC,EAAAS,EAAAqK,EAAA,sBAAA+rB,IAAA72B,EAAAS,EAAAqK,EAAA,sBAAA4hC,IAAA1sC,EAAAS,EAAAqK,EAAA,sBAAA05G,IAAAxkH,EAAAS,EAAAqK,EAAA,sBAAAg6B,IAAA9kC,EAAAS,EAAAqK,EAAA,sBAAAmmC,IAAAjxC,EAAAS,EAAAqK,EAAA,sBAAAomC,IAAAlxC,EAAAS,EAAAqK,EAAA,sBAAA2rI,IAAA,IAAA0Z,EAAAnwJ,EAAA,IAAAowJ,EAAApwJ,EAAA,IAAAqwJ,EAAArwJ,EAAA,KAAAswJ,EAAAtwJ,EAAA2B,EAAA0uJ,GAAAE,EAAAvwJ,EAAA,IAKA,MAAMwwJ,EAAuBnmJ,8BAA0CjG,MAAM,MACzEiG,iTAAYi0B,mBACdkyH,EAAoBzxJ,KAAKsL,gTAAYi0B,mBAEvC,MAAMmyH,EAAmB1pJ,YAAqB,iBAExC2pJ,EAA0B,CAC9BlwF,KAAM,aACNT,IAAK,oBACL4wF,IAAK,YACLC,IAAK,aACLC,KAAM,aACNC,IAAK,kBACLC,IAAK,YACLC,IAAK,cAGDlb,EAAoBryH,EAAQ,KAChCuyH,EAAQF,EAAkBE,MAC1BC,EAAMH,EAAkBG,IAU1B,MAAMgb,EAAoBnqJ,IAP1B,SAA0BoqJ,GAIxB,OAAO7W,KAAK/pF,mBAAmB4gG,GAAK7uJ,QADpB,kBACqC,CAAC43F,EAAGk3D,IAAO/X,OAAOC,aAAa,KAAO8X,MAMpFC,CAAiBtqJ,GACrBzE,QAAQ,OAAQ,IAChBA,QAAQ,MAAO,KACfA,QAAQ,MAAO,KAGPmnD,EAAwB,CAAC1iD,EAAKgC,EAAOC,IAG9CsB,mBAA6B88B,SAAS,eACtCrgC,EAAIqgC,SAAS,cAENrgC,iDAGkDmqJ,EAAkBnqJ,QAAUgC,OAAWC,IAGvF2iB,EAAgB,CAAC5kB,EAAKiqB,EAAQ,QACzC,IAAMjqB,EAAIJ,WAAW,WAAYI,EAAIJ,WAAW,UAAY,OAAOI,EAEnE,MAAMuqJ,EAAqB,OAAVtgI,EAEjB,IAAKsgI,EAEH,IACE,MAAMl9B,EAAY,IAAIx8G,IAAI7Q,GAC1B,GAAI0pJ,EAAoBluI,KAAKmvC,GAAU0iE,EAAUnmE,SAASjF,SAAS0I,IAAU,OAAO3qD,EACpF,MAAO0B,IAKX,GAAI6oJ,IAAahnJ,gTAAYi0B,kBAAmB,CAE9C,6CADe+yH,EAAW,UAAY,eAC6BtgI,GAAS,KAAKkgI,EAAkBnqJ,KAEnG,iBAAkBuD,gTAAYi0B,qBAAqBx3B,KAIjDwqJ,EAAkB,IAAI9uI,IACfmpI,EAAalmJ,MAAOqB,EAAKiqB,KACpC,MAAMwgI,KAAczqJ,KAAOiqB,IAC3B,GAAIugI,EAAgBxuI,IAAIyuI,GAAW,OAAOD,EAAgBvwJ,IAAIwwJ,GAC9D,MAAMC,QAAiBrpJ,MAAMsoJ,EAAkB,CAC7CptJ,OAAQ,OACRuE,QAAS,CAAEC,eAAgB,oBAC3BO,KAAME,KAAKi8D,UAAU,CAAErB,MAAO,CAAEp8D,MAAKiqB,aACpCnY,KAAK5X,GAAKA,EAAEsqB,QAEf,OADAgmI,EAAgBjrJ,IAAIkrJ,EAAUC,GACvBA,GAGI9gC,EAAiCzwD,GAAWn5D,IACvD,GAAmB,iBAARA,GAA4B,KAARA,EAAY,MAAO,GAClD,GAAI,mBAAmBu0C,KAAKv0C,GAAM,OAAOA,EACzC,GAAI,gBAAgBu0C,KAAKv0C,GAAM,OAAOA,EACtC,GAAI,aAAau0C,KAAKv0C,GAAM,OAAOA,EAEnC,GAAIuD,gTAAYi0B,kBAAmB,CAEjC,MAAMD,aAA6Bh0B,gTAAYi0B,qBAE/C,GAAI2hC,EAAQv5D,WAAW23B,GAAkB,CACvC,MACMozH,EADcC,mBAAmBzxF,EAAQz1D,UAAU6zB,EAAgBx/B,SACpCuF,MAAM,KAGrCX,EAAO,IAAIkU,IAAI7Q,GAAK7D,SAE1B,OAAOo7B,GADUozH,EAAiBvvJ,MAAM,EAAGuvJ,EAAiB5yJ,OAAS,GAAGwF,KAAK,KAAO,IAAMZ,IAK9F,OAAOqD,GAGI8pC,EAAmB9pC,IAC9B,GAAIA,EAAIJ,WAAW,YAAcI,EAAIiiD,SAAS,UAAW,MAAO,wBAChE,MAAM4oG,EAAY,IAAIh6I,IAAI7Q,GAAK7D,SAASmB,MAAM,KAAK4pF,MACnD,OAAO0iE,EAAwBiB,IAGpB5wF,EAASn8B,IACpB,MAAMgtH,EAAW,IAAIC,SAGrB,OAFAD,EAAS3jD,OAAO,QAASrpE,GACzBgtH,EAAS3jD,OAAO,iBAAkB,cAC3B9lG,MAAMsoJ,EAAkB,CAC7BptJ,OAAQ,OACR+E,KAAMwpJ,IACLh5I,KAAK5X,GAAKA,EAAEsqB,SA0CjB,IAAIwmI,EAAiB,EACd,MAAMhhH,EAAW,CAAC54B,EAAK8F,EAAUqpE,EAAetjF,GAAU,EAAO8sC,GAAS,EAAOjyB,GAAU,KAChG,MAAM2Z,EAAQntB,OAAO3G,OAAO,GAEtBiN,EAASpH,SAASwN,cAAc,YACtCpG,EAAOhJ,GAAK,sBAAwBopJ,IACpCpgJ,EAAOkF,aAAa,YAAa,CAAEoH,SAAUA,IAC7C,MAAM+zI,EAAoB75I,aAAe2sB,KACzCnzB,EAAOkF,aAAa,eAAgB,CAClCi6B,SACA9sC,UACA6a,UACA1G,IAAoB,iBAARA,EAAmBA,EAAM,GACrCq0B,aAAcwlH,IAGhBrgJ,EAAOzC,SAASU,mBAAoB,EAEpC4oB,EAAM/Z,YAAY9M,GAElB,MAAMsgJ,EAAqB5lJ,WAAW,KACpCmsB,EAAMnf,KAAK,gBAAiB,CAAElB,IAAKA,KAClC,KAEH,CAAC,eAAgB,eAAgB,gBAAgBkK,QAAQsrI,IACvDh8I,EAAO5F,iBACL4hJ,EACAjoJ,UACEqc,aAAakwI,GACbz5H,EAAMnf,KAAK,eAAgB,CAAElB,IAAKA,KAEpC,CAAE0jB,MAAM,MAIZ,MAAM/uB,EAAc,IAAI/I,QAAQ,SAASC,GACnCguJ,EA1ER,SAAwBntH,EAAM0gD,GAC5B,MAAM2sE,EAAS,IAAIC,WACnBD,EAAO3wH,OAAS,SAAS94B,GACvB,MAAM2pJ,EAAO,IAAIC,SAAS5pJ,EAAEyK,OAAOvT,QACnC,GAAgC,OAA5ByyJ,EAAKE,UAAU,GAAG,GACpB,OAAO/sE,GAAU,GAEnB,MAAMzmF,EAASszJ,EAAKhZ,WACpB,IAAIjmI,EAAS,EACb,KAAOA,EAASrU,GAAQ,CACtB,GAAIszJ,EAAKE,UAAUn/I,EAAS,GAAG,IAAU,EAAG,OAAOoyE,GAAU,GAC7D,MAAMgtE,EAASH,EAAKE,UAAUn/I,GAAQ,GAEtC,GADAA,GAAU,EACI,OAAVo/I,EAAkB,CACpB,GAA4C,YAAxCH,EAAKI,UAAWr/I,GAAU,GAAI,GAChC,OAAOoyE,GAAU,GAGnB,MAAMktE,EAAiD,OAAxCL,EAAKE,UAAWn/I,GAAU,GAAI,GAC7CA,GAAUi/I,EAAKI,UAAUr/I,EAAS,EAAGs/I,GACrC,MAAMvmD,EAAOkmD,EAAKE,UAAUn/I,EAAQs/I,GACpCt/I,GAAU,EACV,IAAK,IAAIvU,EAAI,EAAGA,EAAIstG,EAAMttG,IACxB,GAA+C,KAA3CwzJ,EAAKE,UAAUn/I,EAAa,GAAJvU,EAAQ6zJ,GAClC,OAAOltE,EAAS6sE,EAAKE,UAAUn/I,EAAa,GAAJvU,EAAS,EAAG6zJ,QAGnD,IAAyB,QAAX,MAATF,GACV,MAEAp/I,GAAUi/I,EAAKE,UAAUn/I,GAAQ,IAGrC,OAAOoyE,GAAU,IAEnB2sE,EAAOQ,kBAAkB7tH,GAwCrB8tH,CAAex6I,EAAKtK,IAClB7J,EAAQ6J,KAGV7J,EAAQ,KA4BZ,OAzBIguJ,EACFhxF,EAAO7oD,GACJU,KAAK+5I,IACJ,MAAMl7I,EAAS,IAAIE,IAAIg7I,EAAS7G,KAChCr0I,EAAOtR,aAAaE,IAAI,QAASssJ,EAASvrJ,KAAK85D,cAC/CxvD,EAAOkF,aAAa,eAAgB,CAAE7S,SAAS,EAAOmU,IAAKT,EAAO05B,KAAM3E,OAAQmmH,EAAS1xF,UACzFj/D,OAAO2E,IAAIC,MAAMmP,OAAO,CACtB+lI,sBAAuB,CAAC,CAAEtvG,OAAQmmH,EAAS1xF,QAAS8gB,eAAgB4wE,EAASvrJ,KAAK+5D,sBAGrFh8B,MAAM38B,IACLiY,QAAQkF,MAAM,sBAAuBnd,GACrCkJ,EAAOkF,aAAa,eAAgB,CAAEsB,IAAK,YAEtCA,aAAe8lB,aACxBtsB,EAAOkF,aAAa,eAAgB,CAAEsB,sBAAuBQ,IAAIK,mBAG/DsuE,GACF31E,EAAO5F,iBAAiB,iBAAkB,EAAGtJ,aAC3C,MAAMiuC,EAAa8xG,YAAkCl7D,EAAe7kF,EAAOy6B,YAAaz6B,EAAO0V,KAC/FqgB,EAAMnf,KAAK,iBAAkB,CAAEq3B,iBAI5B,CAAE/+B,SAAQ7E,gBAGZ,SAASgqB,EAAyBpjB,GACvC,MAAMm/I,EAAc,sBACdC,EAAY,mBACZC,EAAiB,CAAC,uBAAwB,oBAAqB,0BAE/DC,EAAiB,GAsEvB,OApEAt/I,EAAIyL,SAAStd,IACNA,EAAOmd,WAEZnd,EAAOmd,SAAWiyG,YAAapvH,EAAQmd,IACrC,IAAK+zI,EAAe3rH,SAASpoB,EAASpW,MACpC,OAAOoW,EAOT,GAAInd,EAAOmN,GAAGyQ,UAAUgtE,SAAS,MAAO,OAAOztE,EAC/C,GAAInd,EAAOmN,GAAGyQ,UAAUgtE,SAAS,OAAQ,OAAOztE,EAChD,GAAInd,EAAOmN,GAAG0M,aAAa,eAAgB,OAAOsD,EAElD,MAAMi0I,EAAcj0I,EAASwrB,QAgD7B,OA/CAyoH,EAAYC,gBAAkB34G,KAC5B,IAAKs4G,EAAYv3G,KAAKf,EAAOgyE,cAAe,OAE5ChyE,EAAOlqC,SAASgC,cAAgB,CAAEjR,OAAO,GACzCm5C,EAAOlqC,SAAS+B,0BAA4B,CAAEhR,OAAO,GACrDm5C,EAAOlqC,SAASiC,iBAAmB,CAAElR,MAAO,CAAC,EAAG,IAChDm5C,EAAOlqC,SAASmC,sBAAwB,CAAEpR,MAAO,CAAC,EAAG,EAAG,IACxDm5C,EAAOlqC,SAASqC,sBAAwB,CAAEtR,MAAO,CAAC,EAAG,EAAG,IACxDm5C,EAAOlqC,SAASkC,4BAA8B,CAAEnR,OAAO,GACvDm5C,EAAOlqC,SAASoC,4BAA8B,CAAErR,OAAO,GACvDm5C,EAAOlqC,SAASsC,UAAY,CAAEvR,MAAO,GAErC,MASM+xJ,EAAS54G,EAAOgyE,aAAaloH,MAAM,MACnC+uJ,EAASD,EAAOh9D,UAAUxL,GAAQkoE,EAAYv3G,KAAKqvC,IACzDwoE,EAAOnzJ,OAAOozJ,EAAS,EAAG,EAXV,uQAYhBD,EAAOE,QAAQ,oCACfF,EAAOE,QAAQ,+BACfF,EAAOE,QAAQ,6CACfF,EAAOE,QAAQ,6CACf94G,EAAOgyE,aAAe4mC,EAAO7uJ,KAAK,MAElC,MAAMgvJ,EAAS/4G,EAAOiyE,eAAenoH,MAAM,MACrCkvJ,EAASD,EAAOn9D,UAAUxL,GAAQmoE,EAAUx3G,KAAKqvC,IACvD2oE,EAAOtzJ,OAAOuzJ,EAAS,EAAG,EAAGC,KAC7BF,EAAOD,QAAQ,oCACfC,EAAOD,QAAQ,+BACfC,EAAOD,QAAQ,2CACfC,EAAOD,QAAQ,kCACfC,EAAOD,QAAQ,6CACfC,EAAOD,QAAQ,uCACfC,EAAOD,QAAQ,6CACfC,EAAOD,QAAQ,uCACfC,EAAOD,QAAQ,4BACf94G,EAAOiyE,eAAiB8mC,EAAOhvJ,KAAK,MAEpC0uJ,EAAeh0J,KAAKu7C,EAAOlqC,YAE7B4iJ,EAAYj2H,aAAc,EACnBi2H,OAIJD,EAGF,SAASrmH,EAAyBF,GACvC,OAAOxqC,OAAO2E,IAAIC,MAAMjE,MAAMm5I,sBAAsBx5H,KAAKy+C,GAAUA,EAAOv0B,SAAWA,GAGhF,MAAMg4E,EAA8B,WACzC,MAEMgvC,EAAS,GACf,OAAO,SAASzkJ,GACd,MAAM0kJ,EAAW1kJ,EAAG8P,YAAYC,KAChC,KAAO00I,EAAO30J,OAAS,GAAG,CACxB,MAAM6J,GAAEA,EAAFgJ,OAAMA,GAAW8hJ,EAAOxlE,MAC9Bt8E,EAAOsC,gBAAgBtL,GAGzB,IAAIu0G,EAAc,EAClBw2C,EAASv0I,SAASte,KAEdA,EAAEstH,QACAliH,MAAMqnI,KAAOzyI,EAAE8yJ,WAAa1nJ,MAAMqnI,IAAIp0I,WAC7B,eAAX2B,EAAEF,MACS,iBAAXE,EAAEF,OAEFu8G,GAAer8G,EAAE4lC,SAASgQ,WAAWhqC,SAASyX,SAIlDxD,QAAQkzI,MAAM,8BAEdlzI,QAAQ0/C,iBAAiB88C,0BAEzB,MAAM22C,EAAYH,EAAS90I,SAAS2D,KAAK7O,GACnB,eAAbA,EAAI/S,OAERu8G,EA7Ba,KA6BgC,IAAhBA,IAAsB22C,GACtDnzI,QAAQ0/C,IAAK,qEACbyzF,EAAU7kJ,GAAG6H,aA9BG,eA8BwBg9I,EAAUlzJ,KAAM,CACtDiI,KAAMqtI,EAAM6d,KACZvoB,OAAQ,IACR6L,IAAKlB,EAAIvqB,MAEX8nC,EAAOz0J,KAAK,CAAE2J,GAnCE,eAmCgBkrJ,EAAUlzJ,KAAMgR,OAAQkiJ,EAAU7kJ,MACzDkuG,EArCO,KAqCsBA,EAAc,GACpDluG,EAAG6H,aAAak9I,0BAA6B,CAC3CnrJ,KAAMqtI,EAAM6d,KACZvoB,OAAQ,IACR6L,IAAKlB,EAAIvqB,MAEX8nC,EAAOz0J,KAAK,CAAE2J,GAAIorJ,0BAA6BpiJ,OAAQ3C,IACvD0R,QAAQ0/C,IAAI,gCAEZpxD,EAAG6H,aAAak9I,2BAA8B,CAC5CnrJ,KAAMqtI,EAAMkB,IACZ5L,OAAQ,IACRhiG,YAAa,CAAE17B,EAAG,IAAMG,EAAG,GAAKC,EAAG,KACnCkF,OAAQ,CAAEtF,EAAG,EAAGG,GAAI,GAAKC,EAAG,GAC5BmpI,IAAKlB,EAAImB,SAEXoc,EAAOz0J,KAAK,CAAE2J,GAAIorJ,2BAA8BpiJ,OAAQ3C,IACxD0R,QAAQ0/C,IAAI,mCAEd1/C,QAAQszI,YAzD+B,GA6DrCC,EAAW,IAAIhoJ,MAAMS,QAEpB,SAASq4B,EAAiB/1B,EAAIm0D,EAAO+wF,EAAWC,GAAoB,GACzE,MAAMxiJ,OAAEA,EAAF7E,YAAUA,GAAgBikC,EAASoyB,EAAO,2BAAuBhgE,GAAW,GAE5EktB,EAAMrhB,EAAGE,SAASzC,SAExBkF,EAAOzC,SAASzC,SAASnG,IAAI+pB,EAAIxiB,EAAGwiB,EAAIriB,EAAGqiB,EAAIpiB,GAC/C0D,EAAOzC,SAASgG,SAASvB,KAAK3E,EAAGE,SAASgG,UAEtCi/I,GACFxiJ,EAAOzC,SAASklJ,QAAQzmJ,KAAK6F,IAK/B,MAAMyP,EAAOixI,EAAY,EAAK,EAoC9B,OAlCAD,EAAS3tJ,IAC+B,IAAtCqH,KAAK+c,IAAc,EAAV/c,KAAK6F,IAAUyP,EAAM,IACQ,IAAtCtV,KAAKgd,IAAc,EAAVhd,KAAK6F,IAAUyP,EAAM,IAChB,KAANA,EAAP,KAGHjU,EAAGE,SAAS0E,aAAaqgJ,GACzBtiJ,EAAOzC,SAASY,SAAU,EAE1B6B,EAAO5F,iBACL,eACA,KACE4F,EAAOzC,SAASY,SAAU,EAC1B6B,EAAOkF,aAAa,uBAAwB,CAC1C/U,SAAU,WACVoY,IAAK,IACLC,KAAM,CAAEtM,EAAGwiB,EAAIxiB,EAAGG,EAAGqiB,EAAIriB,EAAGC,EAAGoiB,EAAIpiB,GACnCmM,GAAI,CAAEvM,EAAGomJ,EAASpmJ,EAAGG,EAAGimJ,EAASjmJ,EAAGC,EAAGgmJ,EAAShmJ,GAChDoM,OAAQ,oBAGZ,CAAEwhB,MAAM,IAGVlqB,EAAOzC,SAASU,mBAAoB,EAEpC+B,EAAO5F,iBACL,iBACA,KACEiD,EAAGqK,KAAK,cAAe1H,EAAOd,WAAW,gBAAgBvS,KAAK6Z,MAEhE,CAAE0jB,MAAM,IAGH,CAAElqB,SAAQ7E,eAGnB,MAAMunJ,EAAiB,gFACjBC,EAAgB,wEACTpjH,EAAiBmjH,EAAe/4G,KAAK35C,KAAK0yJ,GAC1CljH,EAAgBpqC,IAAQmqC,EAAenqC,IAAQutJ,EAAch5G,KAAKv0C,GAClE2vI,EAAuB3vI,GAAOmqC,EAAenqC,IAAQoqC,EAAcpqC,sBC5bhFzG,EAAAD,QAAA,kYCAAC,EAAAD,QAAiBJ,EAAA8B,EAAuB,+ECAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,sFCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,yFCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,2FCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,8FCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,qFCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,wFCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,oFCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,uFCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,kGCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,qGCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,4FCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,+FCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,wFCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,2FCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,oFCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,uFCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,yFCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,4FCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,uFCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,0FCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,+FCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,2FCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,uFCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,yFCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,uFCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,6FCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,yFCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,2FCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,2FCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,sFCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,wFCAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,6ECAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,4ECAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB,4ECAxCzB,EAAAD,QAAiBJ,EAAA8B,EAAuB","file":"assets/js/hub-7b7ef3e644c08de8cd37.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t6: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([1459,1,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","// Utilities for manipulating state history. This provides a number of functions which\n// need to be used to manipulate history state so we can deal with edge cases around\n// entry back button and refreshes once entered.\n//\n// These functions also transparently deal with the room slug, so incoming calls can ignore\n// dealing with it, and provides APIs for getting the non-slug part of the path.\n//\n// The slug cannot be part of the basename for history, because the slug changes intra-session\n// if the room is renamed.\n\n// This pushes/replaces a new k, v pair into the history, while maintaining all the other\n// keys, or clears state if k if null.\n//\n// Also maintains a length key that can be used to find the length of the history chain\n// (across refreshes) for the current room.\nfunction pushOrUpdateHistory(history, replace, k, v, detail, newPathname, newSearch) {\n  let state = {};\n  const newLength = ((history.location.state && history.location.state.__historyLength) || 0) + (replace ? 0 : 1);\n\n  if (k || newPathname || newSearch) {\n    state = history.location.state ? { ...history.location.state } : {};\n    delete state.__duplicate;\n\n    if (k) {\n      state[k] = v;\n      state.key = k;\n      state.value = v;\n      state.detail = detail;\n    }\n  }\n\n  const pathname =\n    newPathname !== undefined ? newPathname : history.location.pathname === \"/\" ? \"\" : history.location.pathname;\n\n  const search = newSearch !== undefined ? newSearch : history.location.search;\n\n  // If popToBeginningOfHubHistory was previously used, there is a duplicate entry\n  // at the top of the history stack (which was needed to wipe out forward history)\n  // so we use this opportunity to replace it.\n  const isDuplicate = history.location.state && history.location.state.__duplicate;\n  const method = replace || isDuplicate ? history.replace : history.push;\n  state.__historyLength = newLength;\n\n  method({ pathname, search, state });\n}\n\nexport function pushHistoryState(history, k, v, detail) {\n  pushOrUpdateHistory(history, false, k, v, detail);\n}\n\nexport function replaceHistoryState(history, k, v, detail) {\n  pushOrUpdateHistory(history, true, k, v, detail);\n}\n\nexport function pushHistoryPath(history, path, search) {\n  pushOrUpdateHistory(history, false, null, null, null, path, search);\n}\n\nexport function clearHistoryState(history) {\n  pushOrUpdateHistory(history, false);\n}\n\n// This will pop the browser history to the first entry that was for this hubs room,\n// and then push a duplicate entry onto the history stack in order to wipe out forward\n// history.\nexport function popToBeginningOfHubHistory(history, navigateToPriorPage) {\n  if (!history.location.state || history.location.state.__historyLength === undefined) return;\n\n  const len = history.location.state.__historyLength;\n  if (len === 0) return;\n\n  return new Promise(resolve => {\n    // After the go() completes, we push a duplicate history entry onto the stack\n    // in order to wipe out forward history. We also optionally go back -2 if we wanted\n    // to go back to the prior page.\n    const unsubscribe = history.listen(() => {\n      unsubscribe();\n      history.push({\n        pathname: history.location.pathname,\n        search: history.location.search,\n        state: { __historyLength: 0, __duplicate: true }\n      });\n      if (navigateToPriorPage) history.go(-2); // Go back to history entry before beginning.\n      resolve();\n    });\n\n    history.go(-len);\n  });\n}\n\n// This will pop the browser history to the entry before the first entry for this hubs room.\nexport function navigateToPriorPage(history) {\n  popToBeginningOfHubHistory(history, true);\n}\n\n// Returns the part of the pathname that does not include the slug\nexport function sluglessPath(location) {\n  const parts = location.pathname.split(\"/\");\n  return `/${parts.slice(2).join(\"/\")}`;\n}\n\n// Returns a new path that includes the current slug as a prefix to the\n// provided path.\nexport function withSlug(location, path) {\n  const parts = location.pathname.split(\"/\");\n  return `/${parts[1]}${path}`;\n}\n","import { EventTarget } from \"event-target-shim\";\nimport { getReticulumFetchUrl } from \"../utils/phoenix-utils\";\nimport { pushHistoryPath, sluglessPath, withSlug } from \"../utils/history\";\nimport { avatars } from \"../assets/avatars/avatars\";\nimport qsTruthy from \"../utils/qs_truthy\";\n\nexport const SOURCES = [\"videos\", \"sketchfab\", \"poly\", \"scenes\", \"gifs\", \"images\", \"twitch\"];\n\nconst URL_SOURCE_TO_TO_API_SOURCE = {\n  scenes: \"scene_listings\",\n  images: \"bing_images\",\n  videos: \"bing_videos\",\n  youtube: \"youtube_videos\",\n  gifs: \"tenor\",\n  sketchfab: \"sketchfab\",\n  poly: \"poly\",\n  twitch: \"twitch\"\n};\n\nexport const MEDIA_SOURCE_DEFAULT_FILTERS = {\n  gifs: \"trending\",\n  sketchfab: \"featured\",\n  scenes: \"featured\"\n};\n\nconst SEARCH_CONTEXT_PARAMS = [\"q\", \"filter\", \"cursor\"];\n\n// This class is responsible for fetching and storing media search results and provides a\n// convenience API for performing history updates relevant to search navigation.\nexport default class MediaSearchStore extends EventTarget {\n  constructor() {\n    super();\n\n    this.requestIndex = 0;\n  }\n\n  setHistory(history) {\n    this.history = history;\n\n    this._update(this.history.location);\n\n    this.history.listen(location => {\n      this._update(location);\n    });\n  }\n\n  _update = async location => {\n    this.result = null;\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n\n    const urlSource = this.getUrlMediaSource(location);\n    if (!urlSource) return;\n\n    if (!this.previousSource || this.previousSource !== urlSource) {\n      this.dispatchEvent(new CustomEvent(\"sourcechanged\"));\n      this.previousSource = urlSource;\n    }\n\n    const urlParams = new URLSearchParams(location.search);\n\n    this.requestIndex++;\n    const currentRequestIndex = this.requestIndex;\n    const searchParams = new URLSearchParams();\n\n    for (const param of SEARCH_CONTEXT_PARAMS) {\n      if (!urlParams.get(param)) continue;\n      searchParams.set(param, urlParams.get(param));\n    }\n\n    searchParams.get(\"locale\", navigator.languages[0]);\n\n    let source;\n    if (urlSource === \"avatars\" || urlSource === \"scenes\") {\n      // Avatars + scenes are special since we request them from a different source based on the facet.\n      const singular = urlSource === \"avatars\" ? \"avatar\" : \"scene\";\n      const filter = new URLSearchParams(location.search);\n      source = filter.get(\"filter\").startsWith(\"my-\") ? `${singular}s` : `${singular}_listings`;\n    } else {\n      source = URL_SOURCE_TO_TO_API_SOURCE[urlSource];\n    }\n    searchParams.set(\"source\", source);\n\n    if (source === \"avatars\" || source === \"scenes\") {\n      searchParams.set(\"user\", window.APP.store.credentialsAccountId);\n    }\n\n    const url = getReticulumFetchUrl(`/api/v1/media/search?${searchParams.toString()}`);\n    if (this.lastSavedUrl === url) return;\n\n    const result = await this._fetchMedia(url, source);\n\n    if (this.requestIndex != currentRequestIndex) return;\n\n    this.result = result;\n    this.nextCursor = this.result.meta && this.result.meta.next_cursor;\n    this.lastFetchedUrl = url;\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n  };\n\n  _fetchMedia = async (url, source) => {\n    if (source === \"avatar_listings\" && !qsTruthy(\"use_avatar_listings\")) {\n      // Use our legacy avatars until we are ready with real featured avatars.\n      return { entries: avatars.map(this._legacyAvatarToSearchEntry) };\n    }\n\n    const headers = { \"Content-Type\": \"application/json\" };\n    const credentialsToken = window.APP.store.state.credentials.token;\n    if (credentialsToken) headers.authorization = `bearer ${credentialsToken}`;\n\n    const res = await fetch(url, { method: \"GET\", headers });\n    const body = await res.text();\n\n    let result;\n    try {\n      result = JSON.parse(body);\n    } catch (e) {\n      result = body;\n    }\n\n    return result;\n  };\n\n  _legacyAvatarToSearchEntry = legacyAvatar => {\n    return {\n      id: legacyAvatar.id,\n      type: \"avatar_listing\",\n      url: legacyAvatar.url,\n      images: { preview: { url: legacyAvatar.thumbnail, width: 720, height: 1280 } },\n      gltfs: { avatar: legacyAvatar.model }\n    };\n  };\n\n  pageNavigate = delta => {\n    if (delta === -1) {\n      this.history.goBack();\n    } else {\n      const location = this.history.location;\n      const searchParams = new URLSearchParams(location.search);\n      searchParams.set(\"cursor\", this.nextCursor);\n      pushHistoryPath(this.history, location.pathname, searchParams.toString());\n    }\n  };\n\n  filterQueryNavigate = (filter, query) => {\n    const location = this.history.location;\n    const searchParams = new URLSearchParams(location.search);\n\n    if (query) {\n      searchParams.set(\"q\", query);\n    } else {\n      searchParams.delete(\"q\");\n    }\n\n    if (filter) {\n      searchParams.set(\"filter\", filter);\n    } else {\n      searchParams.delete(\"filter\");\n    }\n\n    if (filter) {\n      searchParams.set(\"cursor\", filter);\n    } else {\n      searchParams.delete(\"cursor\");\n    }\n\n    pushHistoryPath(this.history, location.pathname, searchParams.toString());\n  };\n\n  getSearchClearedSearchParams = (location, keepSource, keepNav) => {\n    const searchParams = new URLSearchParams(location.search);\n\n    // Strip browsing query params\n    searchParams.delete(\"q\");\n    searchParams.delete(\"filter\");\n    searchParams.delete(\"cursor\");\n\n    if (!keepNav) {\n      searchParams.delete(\"media_nav\");\n    }\n\n    if (!keepSource) {\n      searchParams.delete(\"media_source\");\n    }\n\n    return searchParams;\n  };\n\n  _stashLastSearchParams = location => {\n    const searchParams = new URLSearchParams(location.search);\n    this._stashedParams = {};\n    this._stashedSource = this.getUrlMediaSource(location);\n\n    for (const param of SEARCH_CONTEXT_PARAMS) {\n      const value = searchParams.get(param);\n\n      if (value) {\n        this._stashedParams[param] = value;\n      }\n    }\n  };\n\n  clearStashedQuery = () => {\n    if (!this._stashedParams) return;\n    delete this._stashedParams.q;\n  };\n\n  sourceNavigate = source => {\n    this._sourceNavigate(source, false, true);\n  };\n\n  sourceNavigateToDefaultSource = () => {\n    this._sourceNavigate(this._stashedSource ? this._stashedSource : SOURCES[0], false, true);\n  };\n\n  sourceNavigateWithNoNav = source => {\n    this._sourceNavigate(source, true, false);\n  };\n\n  _sourceNavigate = async (source, hideNav, useLastStashedParams) => {\n    const currentQuery = new URLSearchParams(this.history.location.search).get(\"q\");\n    const searchParams = this.getSearchClearedSearchParams(this.history.location);\n\n    if (currentQuery) {\n      searchParams.set(\"q\", currentQuery);\n    } else {\n      if (useLastStashedParams && this._stashedParams) {\n        for (const param of SEARCH_CONTEXT_PARAMS) {\n          const value = this._stashedParams[param];\n\n          // Only q param is compatible across sources, so keep it if is stashed.\n          const useValue = param === \"q\" || this._stashedSource === source;\n\n          if (value && useValue) {\n            searchParams.set(param, value);\n          }\n        }\n      } else {\n        if (source === \"avatars\") {\n          const hasAccountWithAvatars = await this._hasAccountWithAvatars();\n          searchParams.set(\"filter\", hasAccountWithAvatars ? \"my-avatars\" : \"featured\");\n        } else if (MEDIA_SOURCE_DEFAULT_FILTERS[source]) {\n          searchParams.set(\"filter\", MEDIA_SOURCE_DEFAULT_FILTERS[source]);\n        }\n      }\n    }\n\n    this._stashedParams = null;\n    this._stashedSource = null;\n\n    if (hideNav) {\n      searchParams.set(\"media_nav\", \"false\");\n    }\n\n    if (process.env.RETICULUM_SERVER && document.location.host !== process.env.RETICULUM_SERVER) {\n      searchParams.set(\"media_source\", source);\n      pushHistoryPath(this.history, this.history.location.pathname, searchParams.toString());\n    } else {\n      pushHistoryPath(this.history, withSlug(this.history.location, `/media/${source}`), searchParams.toString());\n    }\n  };\n\n  _hasAccountWithAvatars = async () => {\n    const { credentialsAccountId } = window.APP.store;\n    if (!credentialsAccountId) return false;\n\n    const searchParams = new URLSearchParams();\n    const source = \"avatars\";\n    searchParams.set(\"source\", source);\n    searchParams.set(\"user\", credentialsAccountId);\n    const url = getReticulumFetchUrl(`/api/v1/media/search?${searchParams.toString()}`);\n    const result = await this._fetchMedia(url, source);\n    return !!(result && result.entries) && result.entries.length > 0;\n  };\n\n  getUrlMediaSource = location => {\n    const { search } = location;\n    const urlParams = new URLSearchParams(search);\n    const pathname = sluglessPath(location);\n\n    if (!pathname.startsWith(\"/media\") && !urlParams.get(\"media_source\")) return null;\n    return urlParams.get(\"media_source\") || pathname.substring(7);\n  };\n\n  pushExitMediaBrowserHistory = (history, stashLastSearchParams = true) => {\n    if (!history) history = this.history;\n\n    if (stashLastSearchParams) this._stashLastSearchParams(history.location);\n\n    const { pathname } = history.location;\n    const hasMediaPath = sluglessPath(history.location).startsWith(\"/media\");\n    pushHistoryPath(\n      history,\n      hasMediaPath ? withSlug(history.location, \"/\") : pathname,\n      this.getSearchClearedSearchParams(history.location).toString()\n    );\n    this.dispatchEvent(new CustomEvent(\"media-exit\"));\n  };\n}\n","import screenfull from \"screenfull\";\n\nlet hasEnteredFullScreenThisSession = false;\n\nfunction shouldShowFullScreen() {\n  // Disable full screen on iOS, since Safari's fullscreen mode does not let you prevent native pinch-to-zoom gestures.\n  return (\n    (AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR()) &&\n    !AFRAME.utils.device.isIOS() &&\n    screenfull.enabled\n  );\n}\n\nexport function showFullScreenIfAvailable() {\n  if (shouldShowFullScreen()) {\n    screenfull.request();\n    hasEnteredFullScreenThisSession = true;\n  }\n}\n\nexport function showFullScreenIfWasFullScreen() {\n  if (hasEnteredFullScreenThisSession && !screenfull.isFullscreen) {\n    screenfull.request();\n  }\n}\n","/**\n * Chrome and Safari will start Audio contexts in a \"suspended\" state.\n * A user interaction (touch/mouse event) is needed in order to resume the AudioContext.\n */\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  const ctx = THREE.AudioContext.getContext();\n\n  function resume() {\n    ctx.resume();\n\n    setTimeout(function() {\n      if (ctx.state === \"running\") {\n        document.body.removeEventListener(\"touchend\", resume, false);\n        document.body.removeEventListener(\"mouseup\", resume, false);\n      }\n    }, 0);\n  }\n\n  document.body.addEventListener(\"touchend\", resume, false);\n  document.body.addEventListener(\"mouseup\", resume, false);\n});\n","// Monkeypatch to address performance issue with updating panner nodes\n// TODO this needs to be merged into 3.js\n\nTHREE.PositionalAudio.prototype.updateMatrixWorld = (function() {\n  const position = new THREE.Vector3();\n  const quaternion = new THREE.Quaternion();\n\n  const scale = new THREE.Vector3();\n  const orientation = new THREE.Vector3();\n\n  return function updateMatrixWorld(force) {\n    THREE.Object3D.prototype.updateMatrixWorld.call(this, force);\n\n    let setInitial = false;\n\n    if (!this._lastPosition) {\n      setInitial = true;\n      this._lastPosition = new THREE.Vector3();\n      this._lastOrientation = new THREE.Vector3();\n      this._lastListenerPosition = new THREE.Vector3();\n    }\n\n    const panner = this.panner;\n    const listener = panner.context.listener;\n    this.matrixWorld.decompose(position, quaternion, scale);\n    orientation.set(0, 0, 1).applyQuaternion(quaternion);\n\n    // Need to update the position on this node if either the listener moves or this node moves,\n    // because otherwise there are audio artifacts in Chrome.\n    if (\n      setInitial ||\n      Math.abs(position.x - this._lastPosition.x) > Number.EPSILON ||\n      Math.abs(position.y - this._lastPosition.y) > Number.EPSILON ||\n      Math.abs(position.z - this._lastPosition.z) > Number.EPSILON ||\n      Math.abs(orientation.x - this._lastOrientation.x) > Number.EPSILON ||\n      Math.abs(orientation.y - this._lastOrientation.y) > Number.EPSILON ||\n      Math.abs(orientation.z - this._lastOrientation.z) > Number.EPSILON ||\n      (listener.positionX && Math.abs(listener.positionX.value - this._lastListenerPosition.x) > Number.EPSILON) ||\n      (listener.positionY && Math.abs(listener.positionY.value - this._lastListenerPosition.y) > Number.EPSILON) ||\n      (listener.positionZ && Math.abs(listener.positionZ.value - this._lastListenerPosition.z) > Number.EPSILON)\n    ) {\n      panner.setPosition(position.x, position.y, position.z);\n      panner.setOrientation(orientation.x, orientation.y, orientation.z);\n\n      this._lastPosition.x = position.x;\n      this._lastPosition.y = position.y;\n      this._lastPosition.z = position.z;\n\n      this._lastOrientation.x = orientation.x;\n      this._lastOrientation.y = orientation.y;\n      this._lastOrientation.z = orientation.z;\n\n      if (listener.positionX && listener.positionY && listener.positionZ) {\n        this._lastListenerPosition.x = listener.positionX.value;\n        this._lastListenerPosition.y = listener.positionY.value;\n        this._lastListenerPosition.z = listener.positionZ.value;\n      }\n    }\n  };\n})();\n","/**\n * Toggles the position of 2 bones into \"on\" and \"off\" positions to indicate mute state.\n * @namespace avatar\n * @component bone-mute-state-indicator\n */\nAFRAME.registerComponent(\"bone-mute-state-indicator\", {\n  schema: {\n    unmutedBoneName: { default: \"Watch_Joint_MicON\" },\n    mutedBoneName: { default: \"Watch_Joint_Muted\" },\n    onPos: { default: 0.81 },\n    offPos: { default: 0.5 }\n  },\n\n  init() {\n    this.onStateToggled = this.onStateToggled.bind(this);\n    this.el.addEventListener(\"model-loaded\", () => {\n      this.unmutedBone = this.el.object3D.getObjectByName(this.data.unmutedBoneName);\n      this.mutedBone = this.el.object3D.getObjectByName(this.data.mutedBoneName);\n      this.modelLoaded = true;\n\n      this.updateMuteState();\n    });\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateToggled);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateToggled);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateToggled);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateToggled);\n  },\n\n  onStateToggled(e) {\n    if (!e.detail.state === \"muted\") return;\n    this.updateMuteState();\n  },\n\n  updateMuteState() {\n    if (!this.modelLoaded) return;\n    const muted = this.el.sceneEl.is(\"muted\");\n    this.mutedBone.position.y = muted ? this.data.onPos : this.data.offPos;\n    this.unmutedBone.position.y = !muted ? this.data.onPos : this.data.offPos;\n    this.mutedBone.matrixNeedsUpdate = true;\n    this.unmutedBone.matrixNeedsUpdate = true;\n  }\n});\n","/**\n * Scales an object to near-zero if the object is invisible. Useful for bones representing avatar body parts.\n * @namespace avatar\n * @component bone-visibility\n */\nAFRAME.registerComponent(\"bone-visibility\", {\n  tick() {\n    const { visible } = this.el.object3D;\n\n    if (this.lastVisible !== visible) {\n      if (visible) {\n        this.el.object3D.scale.set(1, 1, 1);\n      } else {\n        // Three.js doesn't like updating matrices with 0 scale, so we set it to a near zero number.\n        this.el.object3D.scale.set(0.00000001, 0.00000001, 0.00000001);\n      }\n\n      this.lastVisible = visible;\n      this.el.object3D.updateMatrices(true, true);\n      this.el.object3D.updateMatrixWorld(true, true);\n    }\n  }\n});\n","const interactorOneTransform = [];\nconst interactorTwoTransform = [];\n\n/**\n * Applies effects to a hoverable based on hover state.\n * @namespace interactables\n * @component hoverable-visuals\n */\nAFRAME.registerComponent(\"hoverable-visuals\", {\n  schema: {\n    cursorController: { type: \"selector\" },\n    enableSweepingEffect: { type: \"boolean\", default: true }\n  },\n  init() {\n    // uniforms and boundingSphere are set from the component responsible for loading the mesh.\n    this.uniforms = null;\n    this.boundingSphere = new THREE.Sphere();\n\n    this.sweepParams = [0, 0];\n  },\n  remove() {\n    this.uniforms = null;\n    this.boundingBox = null;\n  },\n  tick(time) {\n    if (!this.uniforms || !this.uniforms.length) return;\n\n    const isPinned = this.el.components.pinnable && this.el.components.pinnable.data.pinned;\n    const isSpawner = !!this.el.components[\"super-spawner\"];\n    const isFrozen = this.el.sceneEl.is(\"frozen\");\n    const hideDueToPinning = !isSpawner && isPinned && !isFrozen;\n\n    let interactorOne, interactorTwo;\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    if (interaction.state.leftHand.hovered === this.el || interaction.state.leftHand.held === this.el) {\n      interactorOne = interaction.options.leftHand.entity.object3D;\n    }\n    if (interaction.state.rightRemote.hovered === this.el || interaction.state.rightRemote.held === this.el) {\n      interactorTwo = interaction.options.rightRemote.entity.object3D;\n    }\n    if (interaction.state.rightHand.hovered === this.el || interaction.state.rightHand.held === this.el) {\n      interactorTwo = interaction.options.rightHand.entity.object3D;\n    }\n\n    if (interactorOne) {\n      interactorOne.matrixWorld.toArray(interactorOneTransform);\n    }\n    if (interactorTwo) {\n      interactorTwo.matrixWorld.toArray(interactorTwoTransform);\n    }\n\n    if (interactorOne || interactorTwo || isFrozen) {\n      const worldY = this.el.object3D.matrixWorld.elements[13];\n      const scaledRadius = this.el.object3D.scale.y * this.boundingSphere.radius;\n      this.sweepParams[0] = worldY - scaledRadius;\n      this.sweepParams[1] = worldY + scaledRadius;\n    }\n\n    for (let i = 0, l = this.uniforms.length; i < l; i++) {\n      const uniform = this.uniforms[i];\n      uniform.hubs_EnableSweepingEffect.value = this.data.enableSweepingEffect && !hideDueToPinning;\n      uniform.hubs_IsFrozen.value = isFrozen;\n      uniform.hubs_SweepParams.value = this.sweepParams;\n\n      uniform.hubs_HighlightInteractorOne.value = !!interactorOne && !hideDueToPinning;\n      uniform.hubs_InteractorOnePos.value[0] = interactorOneTransform[12];\n      uniform.hubs_InteractorOnePos.value[1] = interactorOneTransform[13];\n      uniform.hubs_InteractorOnePos.value[2] = interactorOneTransform[14];\n\n      uniform.hubs_HighlightInteractorTwo.value = !!interactorTwo && !hideDueToPinning;\n      uniform.hubs_InteractorTwoPos.value[0] = interactorTwoTransform[12];\n      uniform.hubs_InteractorTwoPos.value[1] = interactorTwoTransform[13];\n      uniform.hubs_InteractorTwoPos.value[2] = interactorTwoTransform[14];\n\n      if (interactorOne || interactorTwo || isFrozen) {\n        uniform.hubs_Time.value = time;\n      }\n    }\n  }\n});\n","/**\n * Applies effects to a hoverer based on hover state.\n * @namespace interactables\n * @component hover-visuals\n */\nAFRAME.registerComponent(\"hover-visuals\", {\n  schema: {\n    hand: { type: \"string\" }\n  },\n  init() {\n    // uniforms are set from the component responsible for loading the mesh.\n    this.handleLeftVisuals = this.handleLeftVisuals.bind(this);\n    this.handleRightVisuals = this.handleRightVisuals.bind(this);\n    this.hideVisualEffectOnElement = this.hideVisualEffectOnElement.bind(this);\n    this.uniforms = null;\n  },\n  remove() {\n    this.uniforms = null;\n  },\n  tick() {\n    if (!this.uniforms || !this.uniforms.length) return;\n\n    // Push down loops to assist JIT:\n    if (this.data.hand === \"left\") {\n      this.handleLeftVisuals();\n    } else {\n      this.handleRightVisuals();\n    }\n  },\n\n  hideVisualEffectOnElement(el) {\n    const isFrozen = this.el.sceneEl.is(\"frozen\");\n    const isPinned = el.components.pinnable && el.components.pinnable.data.pinned;\n    const isSpawner = !!el.components[\"super-spawner\"];\n\n    return !isSpawner && isPinned && !isFrozen;\n  },\n\n  handleLeftVisuals: function() {\n    const elements = this.el.object3D.matrixWorld.elements;\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const interactingElement = interaction.state.leftHand.held || interaction.state.leftHand.hovered;\n    const hideVisual = interactingElement && this.hideVisualEffectOnElement(interactingElement);\n\n    for (let i = 0, l = this.uniforms.length; i < l; i++) {\n      const uniform = this.uniforms[i];\n      uniform.hubs_HighlightInteractorOne.value = !!interactingElement && !hideVisual;\n      uniform.hubs_InteractorOnePos.value[0] = elements[12];\n      uniform.hubs_InteractorOnePos.value[1] = elements[13];\n      uniform.hubs_InteractorOnePos.value[2] = elements[14];\n    }\n  },\n\n  handleRightVisuals: function() {\n    const elements = this.el.object3D.matrixWorld.elements;\n    const interaction = AFRAME.scenes[0].systems.interaction;\n\n    const interactingElement = interaction.state.rightHand.held || interaction.state.rightHand.hovered;\n    const hideVisual = interactingElement && this.hideVisualEffectOnElement(interactingElement);\n\n    for (let i = 0, l = this.uniforms.length; i < l; i++) {\n      const uniform = this.uniforms[i];\n      uniform.hubs_HighlightInteractorTwo.value = !!interactingElement && !hideVisual;\n      uniform.hubs_InteractorTwoPos.value[0] = elements[12];\n      uniform.hubs_InteractorTwoPos.value[1] = elements[13];\n      uniform.hubs_InteractorTwoPos.value[2] = elements[14];\n    }\n  }\n});\n","/**\n * Positions an entity relative to a given target when the given event is fired.\n * @component offset-relative-to\n */\nAFRAME.registerComponent(\"offset-relative-to\", {\n  schema: {\n    target: {\n      type: \"selector\"\n    },\n    offset: {\n      type: \"vec3\"\n    },\n    on: {\n      type: \"string\"\n    },\n    orientation: {\n      default: 1 // see doc/image_orientations.gif\n    },\n    selfDestruct: {\n      default: false\n    }\n  },\n  init() {\n    this.updateOffset = this.updateOffset.bind(this);\n    if (this.data.on) {\n      this.el.sceneEl.addEventListener(this.data.on, this.updateOffset);\n    } else {\n      this.updateOffset();\n    }\n  },\n\n  updateOffset: (function() {\n    const y = new THREE.Vector3(0, 1, 0);\n    const z = new THREE.Vector3(0, 0, -1);\n    const QUARTER_CIRCLE = Math.PI / 2;\n    const offsetVector = new THREE.Vector3();\n    return function() {\n      const obj = this.el.object3D;\n      const target = this.data.target.object3D;\n      offsetVector.copy(this.data.offset);\n      target.localToWorld(offsetVector);\n      if (obj.parent) {\n        obj.parent.worldToLocal(offsetVector);\n      }\n      obj.position.copy(offsetVector);\n      target.getWorldQuaternion(obj.quaternion);\n\n      // See doc/image_orientations.gif\n      switch (this.data.orientation) {\n        case 8:\n          obj.rotateOnAxis(z, 3 * QUARTER_CIRCLE);\n          break;\n        case 7:\n          obj.rotateOnAxis(z, 3 * QUARTER_CIRCLE);\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\n          break;\n        case 6:\n          obj.rotateOnAxis(z, QUARTER_CIRCLE);\n          break;\n        case 5:\n          obj.rotateOnAxis(z, QUARTER_CIRCLE);\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\n          break;\n        case 4:\n          obj.rotateOnAxis(z, 2 * QUARTER_CIRCLE);\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\n          break;\n        case 3:\n          obj.rotateOnAxis(z, 2 * QUARTER_CIRCLE);\n          break;\n        case 2:\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\n          break;\n        case 1:\n        default:\n          break;\n      }\n\n      obj.matrixNeedsUpdate = true;\n\n      if (this.data.selfDestruct) {\n        if (this.data.on) {\n          this.el.sceneEl.removeEventListener(this.data.on, this.updateOffset);\n        }\n        this.el.removeAttribute(\"offset-relative-to\");\n      }\n    };\n  })()\n});\n","const TWOPI = Math.PI * 2;\nfunction deltaAngle(a, b) {\n  const p = Math.abs(b - a) % TWOPI;\n  return p > Math.PI ? TWOPI - p : p;\n}\n\n/**\n * Positions the HUD and toggles app mode based on where the user is looking\n * @namespace ui\n * @component hud-controller\n */\nAFRAME.registerComponent(\"hud-controller\", {\n  schema: {\n    head: { type: \"selector\" },\n    offset: { default: 0.7 }, // distance from hud above head,\n    lookCutoff: { default: 20 }, // angle at which the hud should be \"on\",\n    animRange: { default: 30 }, // degrees over which to animate the hud into view\n    yawCutoff: { default: 50 } // yaw degrees at wich the hud should reoirent even if the user is looking up\n  },\n  init() {\n    this.onChildHovered = this.onChildHovered.bind(this);\n    this.removeHoverEvents = this.removeHoverEvents.bind(this);\n    this.isYLocked = false;\n    this.lockedHeadPositionY = 0;\n    this.lookDir = new THREE.Vector3();\n    this.lookEuler = new THREE.Euler();\n    this.store = window.APP.store;\n    this.hoverableChildren = this.el.querySelectorAll(\"[is-remote-hover-target]\");\n  },\n\n  tick() {\n    const hud = this.el.object3D;\n    const head = this.data.head.object3D;\n\n    const { offset, lookCutoff, animRange, yawCutoff } = this.data;\n\n    const pitch = head.rotation.x * THREE.Math.RAD2DEG;\n    const yawDif = deltaAngle(head.rotation.y, hud.rotation.y) * THREE.Math.RAD2DEG;\n\n    // HUD is always visible until first hover, to increase discoverability.\n    const forceHudVisible = !this.store.state.activity.hasHoveredInWorldHud;\n\n    // animate the hud into place over animRange degrees as the user aproaches the lookCutoff angle\n    let t = 1 - THREE.Math.clamp(lookCutoff - pitch, 0, animRange) / animRange;\n\n    // HUD is locked down while showing tooltip or if forced.\n    if (forceHudVisible) {\n      t = 1;\n    }\n\n    // Once the HUD is in place it should stay in place until you look sufficiently far down\n    if (t === 1) {\n      this.lockedHeadPositionY = head.position.y;\n      this.hudLocked = true;\n    } else if (this.hudLocked && pitch < lookCutoff - animRange / 2) {\n      this.hudLocked = false;\n    }\n\n    if (this.hudLocked) {\n      t = 1;\n    }\n\n    // Reorient the hud only if the user is looking away from the hud, for right now this arbitrarily means the hud is 1/2 way animated away\n    // TODO: come up with better huristics for this that maybe account for the user turning away from the hud \"too far\", also animate the position so that it doesnt just snap.\n    const hudOutOfView = yawDif >= yawCutoff || pitch < lookCutoff - animRange / 2;\n\n    if (hudOutOfView) {\n      this.lookDir.set(0, 0, -1);\n      this.lookDir.applyQuaternion(head.quaternion);\n      this.lookDir.add(head.position);\n      hud.position.x = this.lookDir.x;\n      hud.position.z = this.lookDir.z;\n      hud.rotation.copy(head.rotation);\n      hud.rotation.x = 0;\n      hud.rotation.z = 0;\n    }\n\n    hud.visible = !hudOutOfView || forceHudVisible;\n    hud.position.y = (this.isYLocked ? this.lockedHeadPositionY : head.position.y) + offset + (1 - t) * offset;\n    hud.rotation.x = (1 - t) * THREE.Math.DEG2RAD * 90;\n    hud.matrixNeedsUpdate = true;\n  },\n\n  play() {\n    for (let i = 0; i < this.hoverableChildren.length; i++) {\n      this.hoverableChildren[i].object3D.addEventListener(\"hovered\", this.onChildHovered);\n    }\n  },\n\n  pause() {\n    this.removeHoverEvents();\n  },\n\n  removeHoverEvents() {\n    for (let i = 0; i < this.hoverableChildren.length; i++) {\n      this.hoverableChildren[i].object3D.removeEventListener(\"hovered\", this.onChildHovered);\n    }\n  },\n\n  onChildHovered() {\n    if (!this.store.state.activity.hasHoveredInWorldHud) {\n      this.store.update({ activity: { hasHoveredInWorldHud: true } });\n      this.removeHoverEvents();\n    }\n  }\n});\n","/**\n * A button with an image, tooltip, hover states.\n * @namespace ui\n * @component icon-button\n */\nAFRAME.registerComponent(\"icon-button\", {\n  schema: {\n    image: { type: \"string\" },\n    hoverImage: { type: \"string\" },\n    activeImage: { type: \"string\" },\n    activeHoverImage: { type: \"string\" },\n    active: { type: \"boolean\" },\n    tooltip: { type: \"selector\" },\n    tooltipText: { type: \"string\" },\n    activeTooltipText: { type: \"string\" }\n  },\n\n  init() {\n    this.el.object3D.matrixNeedsUpdate = true;\n    this.onHover = () => {\n      this.hovering = true;\n      this.updateButtonState();\n    };\n    this.onHoverOut = () => {\n      this.hovering = false;\n      this.updateButtonState();\n    };\n  },\n\n  play() {\n    this.updateButtonState();\n    this.el.object3D.addEventListener(\"hovered\", this.onHover);\n    this.el.object3D.addEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"hovered\", this.onHover);\n    this.el.object3D.removeEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  update() {\n    this.updateButtonState();\n  },\n\n  updateButtonState() {\n    const hovering = this.hovering;\n    const active = this.data.active;\n\n    const image = active ? (hovering ? \"activeHoverImage\" : \"activeImage\") : hovering ? \"hoverImage\" : \"image\";\n\n    this.el.setAttribute(\"src\", this.data[image]);\n\n    if (this.data.tooltip && hovering) {\n      this.data.tooltip.setAttribute(\"visible\", this.hovering);\n      this.data.tooltip\n        .querySelector(\"[text]\")\n        .setAttribute(\"text\", \"value\", this.data.active ? this.data.activeTooltipText : this.data.tooltipText);\n    }\n  }\n});\n","/**\n * A button with text\n * @namespace ui\n * @component text-button\n */\nAFRAME.registerComponent(\"text-button\", {\n  schema: {\n    textHoverColor: { type: \"string\" },\n    textColor: { type: \"string\" },\n    backgroundHoverColor: { type: \"string\" },\n    backgroundColor: { type: \"string\" }\n  },\n\n  init() {\n    // TODO: This is a bit of a hack to deal with position \"component\" not setting matrixNeedsUpdate. Come up with a better solution.\n    this.el.object3D.matrixNeedsUpdate = true;\n    this.onHover = () => {\n      this.hovering = true;\n      this.updateButtonState();\n    };\n    this.onHoverOut = () => {\n      this.hovering = false;\n      this.updateButtonState();\n    };\n    this.textEl = this.el.querySelector(\"[text]\");\n  },\n\n  play() {\n    this.updateButtonState();\n    this.el.object3D.addEventListener(\"hovered\", this.onHover);\n    this.el.object3D.addEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"hovered\", this.onHover);\n    this.el.object3D.removeEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  update() {\n    this.updateButtonState();\n  },\n\n  updateButtonState() {\n    const hovering = this.hovering;\n    this.el.setAttribute(\"slice9\", \"color\", hovering ? this.data.backgroundHoverColor : this.data.backgroundColor);\n\n    if (this.textEl) {\n      this.textEl.setAttribute(\"text\", \"color\", hovering ? this.data.textHoverColor : this.data.textColor);\n    }\n  }\n});\n\nconst noop = function() {};\n// TODO: this should ideally be fixed upstream somehow but its pretty tricky since text is just a geometry not a different type of Object3D, and Object3D is what handles raycast checks.\nAFRAME.registerComponent(\"text-raycast-hack\", {\n  dependencies: [\"text\"],\n  init() {\n    this.el.getObject3D(\"text\").raycast = noop;\n  }\n});\n","export const createImageBitmap =\n  window.createImageBitmap ||\n  async function(data) {\n    return new Promise(resolve => {\n      // https://dev.to/nektro/createimagebitmap-polyfill-for-safari-and-edge-228\n      // https://gist.github.com/MonsieurV/fb640c29084c171b4444184858a91bc7\n\n      let srcUrl;\n      if (data instanceof Blob) {\n        srcUrl = URL.createObjectURL(data);\n      } else {\n        const canvas = document.createElement(\"canvas\");\n        const ctx = canvas.getContext(\"2d\");\n        canvas.width = data.width;\n        canvas.height = data.height;\n        ctx.putImageData(data, 0, 0);\n        srcUrl = canvas.toDataURL();\n      }\n      const img = document.createElement(\"img\");\n\n      img.addEventListener(\"load\", () => resolve(img));\n\n      img.src = srcUrl;\n    });\n  };\n\nexport function disposeImageBitmap(imageBitmap) {\n  if (imageBitmap instanceof HTMLImageElement && imageBitmap.src.startsWith(\"blob:\")) {\n    URL.revokeObjectURL(imageBitmap.src);\n  } else {\n    imageBitmap.close && imageBitmap.close();\n  }\n}\n","/**\n * Registers a click handler and invokes the block method on the NAF adapter for the owner associated with its entity.\n * @namespace network\n * @component block-button\n */\nAFRAME.registerComponent(\"block-button\", {\n  init() {\n    this.onClick = () => {\n      this.block(this.owner);\n    };\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.owner = networkedEl.components.networked.data.owner;\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  },\n\n  block(clientId) {\n    window.APP.hubChannel.hide(clientId);\n  }\n});\n","AFRAME.registerComponent(\"mute-button\", {\n  init() {\n    this.onClick = () => {\n      this.mute(this.owner);\n    };\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.owner = networkedEl.components.networked.data.owner;\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  },\n\n  async mute(clientId) {\n    this.el.sceneEl.emit(\"action_mute_client\", { clientId });\n  }\n});\n","AFRAME.registerComponent(\"kick-button\", {\n  init() {\n    this.onClick = () => {\n      this.kick(this.owner);\n    };\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.owner = networkedEl.components.networked.data.owner;\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  },\n\n  async kick(clientId) {\n    this.el.sceneEl.emit(\"action_kick_client\", { clientId });\n  }\n});\n","AFRAME.registerComponent(\"close-vr-notice-button\", {\n  init() {\n    this.onClick = () => {\n      this.el.sceneEl.emit(\"action_vr_notice_closed\");\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","AFRAME.registerComponent(\"leave-room-button\", {\n  init() {\n    this.onClick = () => {\n      this.el.sceneEl.emit(\"leave_room_requested\");\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","AFRAME.registerComponent(\"visible-if-permitted\", {\n  schema: {\n    type: \"string\"\n  },\n  init() {\n    this.updateVisibility = this.updateVisibility.bind(this);\n    this.updateVisibility();\n    window.APP.hubChannel.addEventListener(\"permissions_updated\", this.updateVisibility);\n  },\n  updateVisibility() {\n    this.el.object3D.visible = this.el.sceneEl.systems.permissions.canOrWillIfCreator(this.data);\n  },\n  remove() {\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.updateVisibility);\n  }\n});\n","/**\n * Stores networked avatar state.\n * @namespace avatar\n * @component networked-avatar\n */\nAFRAME.registerComponent(\"networked-avatar\", {\n  schema: {\n    left_hand_pose: { default: 0 },\n    right_hand_pose: { default: 0 }\n  }\n});\n","AFRAME.registerComponent(\"pinnable\", {\n  schema: {\n    pinned: { default: false }\n  },\n\n  init() {\n    this._fireEvents = this._fireEvents.bind(this);\n\n    // Fire pinned events when page changes so we can persist the page.\n    this.el.addEventListener(\"pager-page-changed\", this._fireEvents);\n\n    // Fire pinned events when video state changes so we can persist the page.\n    this.el.addEventListener(\"owned-video-state-changed\", this._fireEvents);\n  },\n\n  update(oldData) {\n    this._fireEvents(oldData);\n  },\n\n  _fireEvents(oldData) {\n    // We need to guard against _fireEvents being called during entity initialization,\n    // when the networked component isn't initialized yet.\n    if (this.el.components.networked && this.el.components.networked.data && !NAF.utils.isMine(this.el)) return;\n\n    const pinStateChanged = !!oldData.pinned !== this.data.pinned;\n\n    if (this.data.pinned) {\n      this.el.emit(\"pinned\", { el: this.el, changed: pinStateChanged });\n\n      this.el.removeAttribute(\"animation__pin-start\");\n      this.el.removeAttribute(\"animation__pin-end\");\n      const currentScale = this.el.object3D.scale;\n\n      this.el.setAttribute(\"animation__pin-start\", {\n        property: \"scale\",\n        dur: 200,\n        from: { x: currentScale.x, y: currentScale.y, z: currentScale.z },\n        to: { x: currentScale.x * 1.1, y: currentScale.y * 1.1, z: currentScale.z * 1.1 },\n        easing: \"easeOutElastic\"\n      });\n\n      this.el.setAttribute(\"animation__pin-end\", {\n        property: \"scale\",\n        delay: 200,\n        dur: 200,\n        from: { x: currentScale.x * 1.1, y: currentScale.y * 1.1, z: currentScale.z * 1.1 },\n        to: { x: currentScale.x, y: currentScale.y, z: currentScale.z },\n        easing: \"easeOutElastic\"\n      });\n\n      if (this.el.components[\"ammo-body\"]) {\n        this.el.setAttribute(\"ammo-body\", { type: \"static\" });\n      }\n    } else {\n      this.el.emit(\"unpinned\", { el: this.el, changed: pinStateChanged });\n    }\n  },\n\n  tick() {\n    const { leftHand, rightHand, rightRemote } = this.el.sceneEl.systems.interaction.state;\n    const held = leftHand.held === this.el || rightHand.held === this.el || rightRemote.held === this.el;\n    if (!held && this.wasHeld) {\n      this._fireEvents(this.data);\n    }\n    this.wasHeld = held;\n  }\n});\n","AFRAME.registerComponent(\"drop-object-button\", {\n  init() {\n    this.onClick = () => {\n      if (!NAF.utils.isMine(this.targetEl) && !NAF.utils.takeOwnership(this.targetEl)) return;\n\n      this.targetEl.setAttribute(\"floaty-object\", { modifyGravityOnRelease: false });\n      this.targetEl.setAttribute(\"ammo-body\", {\n        type: \"dynamic\",\n        gravity: { x: 0, y: -9.8, z: 0 },\n        angularDamping: 0.01,\n        linearDamping: 0.01,\n        linearSleepingThreshold: 1.6,\n        angularSleepingThreshold: 2.5\n      });\n      this.targetEl.components[\"ammo-body\"].body.activate();\n\n      // Remove drop button after using it\n      this.el.parentNode.removeChild(this.el);\n    };\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","AFRAME.registerComponent(\"remove-networked-object-button\", {\n  init() {\n    this.onClick = () => {\n      if (!NAF.utils.isMine(this.targetEl) && !NAF.utils.takeOwnership(this.targetEl)) return;\n\n      this.targetEl.setAttribute(\"animation__remove\", {\n        property: \"scale\",\n        dur: 200,\n        to: { x: 0.01, y: 0.01, z: 0.01 },\n        easing: \"easeInQuad\"\n      });\n\n      this.el.parentNode.removeAttribute(\"visibility-while-frozen\");\n      this.el.parentNode.setAttribute(\"visible\", false);\n\n      this.targetEl.addEventListener(\"animationcomplete\", () => {\n        this.targetEl.parentNode.removeChild(this.targetEl);\n      });\n    };\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","module.exports = __webpack_public_path__ + \"assets/sfx/tick-b0fcbf1d9b6f92a24bec12f9bae1e42a.mp3\";","AFRAME.registerComponent(\"camera-focus-button\", {\n  schema: {\n    track: { default: false },\n    selector: { default: null }\n  },\n\n  init() {\n    this.cameraSystem = this.el.sceneEl.systems[\"camera-tools\"];\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      if (this.data.selector) {\n        this.targetEl = networkedEl.querySelector(this.data.selector);\n      } else {\n        this.targetEl = networkedEl;\n      }\n    });\n\n    this.onClick = () => {\n      const myCamera = this.cameraSystem.getMyCamera();\n      if (!myCamera) return;\n\n      myCamera.components[\"camera-tool\"].focus(this.targetEl, this.data.track);\n    };\n  },\n\n  tick() {\n    const isVisible = this.el.getAttribute(\"visible\");\n    const shouldBeVisible = !!(this.cameraSystem && this.cameraSystem.getMyCamera());\n\n    if (isVisible !== shouldBeVisible) {\n      this.el.setAttribute(\"visible\", shouldBeVisible);\n    }\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","AFRAME.registerComponent(\"mirror-camera-button\", {\n  schema: {\n    // Selector for label to change when mirroring/un-mirroring\n    labelSelector: { type: \"string\" }\n  },\n\n  init() {\n    this._updateUI = this._updateUI.bind(this);\n    this._isMirrored = this._isMirrored.bind(this);\n    this.labelEl = this.el.parentNode.querySelector(this.data.labelSelector);\n\n    this.onClick = () => {\n      if (!this._isMirrored()) {\n        this.targetEl.components[\"camera-tool\"].mirror();\n      } else {\n        this.targetEl.components[\"camera-tool\"].unmirror();\n      }\n    };\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n      this.targetEl.addEventListener(\"mirrored\", this._updateUI);\n      this.targetEl.addEventListener(\"unmirrored\", this._updateUI);\n      this._updateUI();\n    });\n\n    if (AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR()) {\n      this.el.object3D.visible = false;\n    }\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  },\n\n  _isMirrored() {\n    return this.targetEl === this.el.sceneEl.systems[\"camera-mirror\"].getMirroredCameraEl();\n  },\n\n  _updateUI() {\n    const isMirrored = this._isMirrored();\n    this.labelEl.setAttribute(\"text\", \"value\", isMirrored ? \"unmirror\" : \"mirror\");\n    this.el.setAttribute(\"text-button\", \"backgroundColor\", isMirrored ? \"#fff\" : \"#ff0520\");\n    this.el.setAttribute(\"text-button\", \"backgroundHoverColor\", isMirrored ? \"#aaa\" : \"#cc0515\");\n  }\n});\n","/**\n * Toggles the visibility of this entity based on networked ownership\n * @namespace ui\n * @component visible-to-owner\n */\nAFRAME.registerComponent(\"visible-to-owner\", {\n  init() {\n    this.onStateChange = e => {\n      this.el.setAttribute(\"visible\", e.detail.newOwner === NAF.clientId);\n    };\n    NAF.utils.getNetworkedEntity(this.el).then(el => {\n      el.addEventListener(\"ownership-changed\", this.onStateChange);\n      this.el.setAttribute(\"visible\", NAF.utils.isMine(el));\n    });\n  }\n});\n","AFRAME.registerComponent(\"emit-state-change\", {\n  multiple: true,\n  schema: {\n    state: { type: \"string\" },\n    transform: { type: \"string\", oneof: [\"rising\", \"falling\"] },\n    event: { type: \"string\" }\n  },\n\n  init() {\n    this.stateadded = this.stateadded.bind(this);\n    this.stateremoved = this.stateremoved.bind(this);\n  },\n\n  stateadded(e) {\n    if (e.detail === this.data.state) {\n      this.el.emit(this.data.event);\n    }\n  },\n  stateremoved(e) {\n    if (e.detail === this.data.state) {\n      this.el.emit(this.data.event);\n    }\n  },\n\n  update() {\n    this.el.removeEventListener(\"stateadded\", this.stateadded);\n    this.el.removeEventListener(\"stateremoved\", this.stateremoved);\n\n    if (this.data.transform === \"rising\") {\n      this.el.addEventListener(\"stateadded\", this.stateadded);\n    }\n    if (this.data.transform === \"falling\") {\n      this.el.addEventListener(\"stateremoved\", this.stateremoved);\n    }\n  }\n});\n","AFRAME.registerComponent(\"action-to-event\", {\n  multiple: true,\n\n  schema: {\n    path: { type: \"string\" },\n    event: { type: \"string\" }\n  },\n\n  tick() {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    if (userinput.get(this.data.path)) {\n      this.el.emit(this.data.event);\n    }\n  }\n});\n","AFRAME.registerComponent(\"action-to-remove\", {\n  multiple: true,\n\n  schema: {\n    path: { type: \"string\" },\n    requireOwnership: { type: \"boolean\", default: true }\n  },\n\n  init() {\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.networkedEl = networkedEl;\n    });\n  },\n\n  tick() {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    if (!userinput.get(this.data.path)) return;\n    if (this.data.requireOwnership && this.networkedEl && !NAF.utils.isMine(this.networkedEl)) return;\n\n    this.el.parentNode.removeChild(this.el);\n  }\n});\n","AFRAME.registerComponent(\"emit-scene-event-on-remove\", {\n  schema: {\n    event: { default: null }\n  },\n\n  remove() {\n    if (this.data.event) {\n      this.el.sceneEl.emit(this.data.event, { el: this.el });\n    }\n  }\n});\n","AFRAME.registerComponent(\"follow-in-fov\", {\n  schema: {\n    target: { type: \"selector\" },\n    offset: { type: \"vec3\" },\n    speed: { type: \"number\", default: 0.003 },\n    angle: { type: \"number\", default: 45 }\n  },\n\n  init() {\n    this.targetPos = new THREE.Vector3();\n    this.offset = new THREE.Vector3();\n    this.offset.copy(this.data.offset);\n\n    this.snappedRot = new THREE.Euler();\n    this.snappedQ = new THREE.Quaternion();\n    this.snappedXForm = new THREE.Matrix4();\n    this.snappedXFormWorld = new THREE.Matrix4();\n    this.tempVector = new THREE.Vector3();\n  },\n\n  tick(t, dt) {\n    if (!this.el.object3D.visible) return;\n\n    const obj = this.el.object3D;\n    const target = this.data.target.object3D;\n\n    // Compute position + rotation by projecting offset along a downward ray in target space,\n    // and mask out Z rotation.\n    this._applyMaskedTargetRotation(\n      -this.data.angle * THREE.Math.DEG2RAD,\n      target.rotation.y,\n      0,\n      this.snappedXFormWorld\n    );\n\n    this.targetPos.copy(this.offset);\n    this.targetPos.applyMatrix4(this.snappedXFormWorld);\n\n    if (obj.parent) {\n      obj.parent.worldToLocal(this.targetPos);\n    }\n\n    if (!this.started) {\n      obj.position.copy(this.targetPos);\n      this.started = true;\n    } else {\n      const t = this.data.speed * dt;\n\n      obj.position.set(\n        obj.position.x + (this.targetPos.x - obj.position.x) * t,\n        obj.position.y + (this.targetPos.y - obj.position.y) * t,\n        obj.position.z + (this.targetPos.z - obj.position.z) * t\n      );\n    }\n\n    this.snappedXFormWorld.decompose(this.tempVector, obj.quaternion, this.tempVector);\n    obj.matrixNeedsUpdate = true;\n  },\n\n  _applyMaskedTargetRotation(x, y, z, to) {\n    const target = this.data.target.object3D;\n    this.snappedRot.set(x, y, z, target.rotation.order);\n    this.snappedQ.setFromEuler(this.snappedRot);\n\n    this.snappedXForm.compose(\n      target.position,\n      this.snappedQ,\n      target.scale\n    );\n\n    to.multiplyMatrices(target.parent.matrixWorld, this.snappedXForm);\n  }\n});\n","AFRAME.registerComponent(\"matrix-auto-update\", {\n  schema: {\n    target: { type: \"string\" }\n  },\n\n  init: function() {\n    this._updateMatrixAutoUpdate = this._updateMatrixAutoUpdate.bind(this);\n    this._updateMatrixAutoUpdate();\n  },\n\n  play: function() {\n    this.el.sceneEl.addEventListener(\"object3dset\", this._updateMatrixAutoUpdate);\n  },\n\n  pause: function() {\n    this.el.sceneEl.removeEventListener(\"object3dset\", this._updateMatrixAutoUpdate);\n  },\n\n  _updateMatrixAutoUpdate: function() {\n    if (this.data.target) {\n      this.el.getObject3D(this.data.target).matrixAutoUpdate = true;\n    } else {\n      this.el.object3D.matrixAutoUpdate = true;\n    }\n  }\n});\n","AFRAME.registerComponent(\"hover-menu\", {\n  multiple: true,\n  schema: {\n    template: { type: \"selector\" },\n    dirs: { type: \"array\" },\n    dim: { default: true }\n  },\n\n  async init() {\n    this.onFrozenStateChange = this.onFrozenStateChange.bind(this);\n    this.hovering = false;\n    await this.getHoverMenu();\n    this.applyHoverState();\n  },\n\n  getHoverMenu() {\n    if (this.menuPromise) return this.menuPromise;\n    return (this.menuPromise = new Promise(resolve => {\n      const menu = this.el.appendChild(document.importNode(this.data.template.content, true).children[0]);\n      // we have to wait a tick for the attach callbacks to get fired for the elements in a template\n      setTimeout(() => {\n        this.menu = menu;\n        this.el.setAttribute(\"position-at-box-shape-border\", {\n          target: \".hover-container\",\n          dirs: this.data.dirs,\n          animate: false,\n          scale: false\n        });\n        resolve(this.menu);\n      });\n    }));\n  },\n\n  onFrozenStateChange(e) {\n    if (!e.detail === \"frozen\") return;\n    this.applyHoverState();\n  },\n\n  applyHoverState() {\n    if (!this.menu) return;\n    this.menu.object3D.visible = !this.el.sceneEl.is(\"frozen\") && this.hovering;\n    if (this.data.dim && this.el.object3DMap.mesh && this.el.object3DMap.mesh.material) {\n      this.el.object3DMap.mesh.material.color.setScalar(this.menu.object3D.visible ? 0.5 : 1);\n    }\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onFrozenStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onFrozenStateChange);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onFrozenStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onFrozenStateChange);\n  }\n});\n","AFRAME.registerComponent(\"disable-frustum-culling\", {\n  init() {\n    this.el.object3D.traverse(o => (o.frustumCulled = false));\n  }\n});\n","AFRAME.registerComponent(\"set-active-camera\", {\n  init() {\n    // This is a hack needed to set the active camera because sometimes A-Frame will create the default camera and set it to the active camera on startup because the query selector to find an existing camera in the scene fails.\n\n    const cameraSystem = this.el.sceneEl.systems.camera;\n    const currentActiveCamera = cameraSystem.activeCameraEl;\n\n    if (currentActiveCamera !== this.el) {\n      cameraSystem.setActiveCamera(this.el);\n\n      // Also A-Frame fails to delete the default camera :P\n      currentActiveCamera.parentNode.removeChild(currentActiveCamera);\n\n      // Look controls leaves behind this CSS class.\n      this.el.sceneEl.canvas.classList.remove(\"a-grab-cursor\");\n    }\n  }\n});\n","AFRAME.registerComponent(\"track-pose\", {\n  schema: {\n    path: { type: \"string\" }\n  },\n\n  tick() {\n    const matrix = AFRAME.scenes[0].systems.userinput.get(this.data.path);\n    if (matrix) {\n      const o = this.el.object3D;\n      o.matrix.copy(matrix);\n      o.matrix.decompose(o.position, o.quaternion, o.scale);\n      o.matrixIsModified = true;\n    }\n  }\n});\n","AFRAME.registerComponent(\"replay\", {\n  init: function() {\n    this.playhead = 0;\n    this.poseIndex = 0;\n  },\n\n  tick: function(t, dt) {\n    let overflow = false;\n    while (!overflow && this.playhead >= this.poses[this.poseIndex].timestamp) {\n      this.el.setAttribute(\"position\", this.poses[this.poseIndex].position);\n      this.el.setAttribute(\"rotation\", this.poses[this.poseIndex].rotation);\n      this.el.object3D.matrixNeedsUpdate = true;\n      this.poseIndex += 1;\n      overflow = this.poseIndex === this.poses.length;\n    }\n\n    this.playhead += dt;\n\n    if (overflow) {\n      this.playhead = 0;\n      this.poseIndex = 0;\n    }\n  }\n});\n","AFRAME.registerComponent(\"visibility-by-path\", {\n  schema: {\n    path: { type: \"string\" }\n  },\n  tick() {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const shouldBeVisible = !!userinput.get(this.data.path);\n    if (this.el.object3D.visible !== shouldBeVisible) {\n      this.el.setAttribute(\"visible\", shouldBeVisible);\n    }\n  }\n});\n","AFRAME.registerComponent(\"tags\", {\n  schema: {\n    isHandCollisionTarget: { default: false },\n    isHoldable: { default: false },\n    offersHandConstraint: { default: false },\n    offersRemoteConstraint: { default: false },\n    singleActionButton: { default: false },\n    holdableButton: { default: false },\n    isPen: { default: false },\n    isHoverMenuChild: { default: false }\n  },\n  update() {\n    if (this.didUpdateOnce) {\n      console.warn(\"Do not edit tags with .setAttribute\");\n    }\n    this.didUpdateOnce = true;\n  }\n});\n","/* global AFRAME */\n\n/**\n * Toggle visibility of an entity based on if the user is in vr mode or not\n * @namespace vr-mode\n * @component vr-mode-toggle-visibility\n */\nAFRAME.registerComponent(\"vr-mode-toggle-visibility\", {\n  schema: {\n    invert: { type: \"boolean\", default: false }\n  },\n\n  init() {\n    this.updateComponentState = this.updateComponentState.bind(this);\n  },\n\n  play() {\n    this.updateComponentState();\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  updateComponentState() {\n    const inVRMode = this.el.sceneEl.is(\"vr-mode\");\n    this.el.setAttribute(\"visible\", inVRMode !== this.data.invert);\n  }\n});\n\n/**\n * Toggle the isPlaying state of a component based on app mode\n * @namespace vr-mode\n * @component vr-mode-toggle-playing\n */\nAFRAME.registerComponent(\"vr-mode-toggle-playing\", {\n  multiple: true,\n  schema: {\n    invert: { type: \"boolean\", default: false }\n  },\n\n  init() {\n    this.updateComponentState = this.updateComponentState.bind(this);\n  },\n\n  play() {\n    this.updateComponentState();\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  updateComponentState() {\n    const componentName = this.id;\n    const inVRMode = this.el.sceneEl.is(\"vr-mode\");\n    this.el.components[componentName][inVRMode !== this.data.invert ? \"play\" : \"pause\"]();\n  }\n});\n\n/**\n * Toggle a CSS class based upon app mode.\n * @namespace vr-mode\n * @component vr-mode-toggle-class\n */\nAFRAME.registerComponent(\"vr-mode-toggle-class\", {\n  multiple: true,\n  schema: {\n    invert: { type: \"boolean\", default: false },\n    class: { type: \"string\", default: false }\n  },\n\n  init() {\n    this.updateComponentState = this.updateComponentState.bind(this);\n  },\n\n  play() {\n    this.updateComponentState();\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  updateComponentState() {\n    const inVRMode = this.el.sceneEl.is(\"vr-mode\");\n\n    if (inVRMode) {\n      this.el.classList.add(this.data.class);\n    } else {\n      this.el.classList.remove(this.data.class);\n    }\n  }\n});\n","AFRAME.registerSystem(\"permissions\", {\n  can(permissionName) {\n    return !!window.APP.hubChannel.can(permissionName);\n  },\n  canOrWillIfCreator(permissionName) {\n    return !!window.APP.hubChannel.canOrWillIfCreator(permissionName);\n  },\n  fetchPermissions() {\n    return window.APP.hubChannel.fetchPermissions();\n  }\n});\n","/**\n * Emits an \"exit\" event when a user has stopped using the app for a certain period of time\n * @system exit-on-blur\n */\nAFRAME.registerSystem(\"exit-on-blur\", {\n  init() {\n    this.onBlur = this.onBlur.bind(this);\n    this.onFocus = this.onFocus.bind(this);\n    this.onTimeout = this.onTimeout.bind(this);\n    this.onEnterVR = this.onEnterVR.bind(this);\n\n    this.isOculusBrowser = navigator.userAgent.match(/Oculus/);\n    this.enteredVR = false;\n\n    window.addEventListener(\"blur\", this.onBlur);\n    window.addEventListener(\"focus\", this.onFocus);\n    this.el.addEventListener(\"enter-vr\", this.onEnterVR);\n\n    this.lastTimeoutCheck = 0;\n    this.exitTimeout = null;\n  },\n\n  tick(t) {\n    // This is a hack to detect when an Oculus Go user has taken off the headset and the headset has\n    // entered standby mode. Currently Oculus Browser is not emitting a blur, vrdisplaydeactivate,\n    // vrdisplayblur, visibilitychange, or vrdisplaypresentchange event, so we wait 15 seconds after\n    // the last requestAnimationFrame callback to determine if the headset has gone into standby mode.\n    // We also check that you have entered VR so that this timeout does not occur in the setup UI.\n    if (\n      this.isOculusBrowser &&\n      this.enteredVR &&\n      (this.lastTimeoutCheck === 0 || t - this.lastTimeoutCheck >= 1000.0) // Don't do this clear every frame, slow.\n    ) {\n      this.lastTimeoutCheck = t;\n      clearTimeout(this.exitTimeout);\n      this.exitTimeout = setTimeout(this.onTimeout, 15 * 1000);\n    }\n  },\n\n  onEnterVR() {\n    this.enteredVR = true;\n  },\n\n  onBlur() {\n    if (this.el.isMobile) {\n      clearTimeout(this.exitTimeout);\n      this.exitTimeout = setTimeout(this.onTimeout, 30 * 1000);\n    }\n  },\n\n  onFocus() {\n    if (this.el.isMobile) {\n      clearTimeout(this.exitTimeout);\n    }\n  },\n\n  onTimeout() {\n    this.el.dispatchEvent(new CustomEvent(\"exit\"));\n  },\n\n  remove() {\n    clearTimeout(this.exitTimeout);\n    window.removeEventListener(\"blur\", this.onBlur);\n  }\n});\n","// Used for tracking and managing camera tools in the scene\nAFRAME.registerSystem(\"camera-tools\", {\n  init() {\n    this.cameraEls = [];\n  },\n\n  register(el) {\n    this.cameraEls.push(el);\n    el.addEventListener(\"ownership-changed\", this._onOwnershipChange);\n    delete this.myCamera;\n  },\n\n  deregister(el) {\n    this.cameraEls = this.cameraEls.filter(c => c !== el);\n    el.removeEventListener(\"ownership-changed\", this._onOwnershipChange);\n    delete this.myCamera;\n  },\n\n  avatarUpdated() {\n    this.cameraEls.forEach(el => delete el.components[\"camera-tool\"].onAvatarUpdated());\n  },\n\n  getMyCamera() {\n    if (this.myCamera !== undefined) return this.myCamera;\n    this.myCamera = this.cameraEls.find(NAF.utils.isMine) || null;\n    return this.myCamera;\n  },\n\n  _onOwnershipChange() {\n    this.myCamera = null;\n  }\n});\n","// Given a function and a queue name, schedules things so a single function\n// from a given queue will be called per frame.\nAFRAME.registerSystem(\"frame-scheduler\", {\n  init() {\n    // Registry a map from queue name to list of registered functions.\n    this.registry = new Map();\n    this.queues = [];\n    this.frameIndex = 0;\n  },\n\n  schedule(func, queue) {\n    if (!this.registry.has(queue)) {\n      this.queues.push(queue);\n      this.registry.set(queue, []);\n    }\n\n    this.registry.get(queue).push(func);\n  },\n\n  unschedule(func) {\n    for (let i = 0; i < this.queues.length; i++) {\n      const queue = this.queues[i];\n      const entries = this.registry.get(queue);\n      const idx = entries.indexOf(func);\n\n      if (idx >= 0) {\n        entries.splice(idx, 1);\n      }\n    }\n  },\n\n  tick: function() {\n    for (let i = 0; i < this.queues.length; i++) {\n      const queue = this.queues[i];\n      const entries = this.registry.get(queue);\n      if (entries.length === 0) continue;\n\n      entries[this.frameIndex % entries.length]();\n    }\n\n    this.frameIndex++;\n  }\n});\n","/* global AFRAME NAF performance */\nAFRAME.registerComponent(\"owned-object-limiter\", {\n  schema: {\n    counter: { type: \"selector\" }\n  },\n\n  init() {\n    this.counter = this.data.counter.components[\"networked-counter\"];\n  },\n\n  tick() {\n    this._syncCounterRegistration();\n    const isHeld = this.el.sceneEl.systems.interaction.isHeld(this.el);\n    if (!isHeld && this.wasHeld && this.counter.timestamps.has(this.el)) {\n      this.counter.timestamps.set(this.el, performance.now());\n    }\n    this.wasHeld = isHeld;\n  },\n\n  remove() {\n    this.counter.deregister(this.el);\n  },\n\n  _syncCounterRegistration() {\n    if (!this.el.components[\"networked\"]) return;\n\n    const isPinned = this.el.components[\"pinnable\"] && this.el.components[\"pinnable\"].data.pinned;\n\n    if (NAF.utils.isMine(this.el) && !isPinned) {\n      this.counter.register(this.el);\n    } else {\n      this.counter.deregister(this.el);\n    }\n  }\n});\n","/* global NAF */\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\n\nAFRAME.registerComponent(\"set-unowned-body-kinematic\", {\n  init() {\n    this.setBodyKinematic = this.setBodyKinematic.bind(this);\n  },\n  play() {\n    this.el.addEventListener(\"ownership-lost\", this.setBodyKinematic);\n\n    if (!this.didThisOnce) {\n      // Do this in play instead of init so that the ammo-body and networked components are done\n      this.didThisOnce = true;\n\n      if (!NAF.utils.isMine(this.el)) {\n        this.setBodyKinematic();\n      }\n    }\n  },\n  pause() {\n    this.el.removeEventListener(\"ownership-lost\", this.setBodyKinematic);\n  },\n  setBodyKinematic() {\n    this.el.setAttribute(\"ammo-body\", {\n      type: \"kinematic\",\n      collisionFilterMask: COLLISION_LAYERS.UNOWNED_INTERACTABLE\n    });\n    if (this.el.components[\"floaty-object\"]) {\n      this.el.components[\"floaty-object\"].locked = true;\n    }\n  }\n});\n","/* global AFRAME performance */\n/**\n * Limits networked interactables to a maximum number at any given time\n * @namespace network\n * @component networked-counter\n */\nAFRAME.registerComponent(\"networked-counter\", {\n  schema: {\n    max: { default: 3 }\n  },\n\n  init() {\n    this.timestamps = new Map();\n    this.el.object3D.visible = false;\n  },\n\n  remove() {\n    this.timestamps.clear();\n  },\n\n  count() {\n    return this.timestamps.size;\n  },\n\n  register(el) {\n    if (this.data.max <= 0 || this.timestamps.has(el)) return;\n\n    this.timestamps.set(el, performance.now());\n    this._destroyOldest();\n  },\n\n  deregister(el) {\n    this.timestamps.delete(el);\n  },\n\n  _destroyOldest() {\n    if (this.timestamps.size > this.data.max) {\n      const interaction = this.el.sceneEl.systems.interaction;\n      let oldestEl = null,\n        minTs = Number.MAX_VALUE;\n      this.timestamps.forEach((ts, el) => {\n        if (ts < minTs && !interaction.isHeld(el)) {\n          oldestEl = el;\n          minTs = ts;\n        }\n      });\n      this._destroy(oldestEl);\n    }\n  },\n\n  _destroy(el) {\n    // networked-interactable's remvoe will also call deregister, but it will happen async so we do it here as well.\n    this.deregister(el);\n    el.parentNode.removeChild(el);\n  }\n});\n","AFRAME.registerComponent(\"set-yxz-order\", {\n  init: function() {\n    this.el.object3D.rotation.order = \"YXZ\";\n  }\n});\n","/**\n * Initializes teleporters when the environment bundle has loaded.\n * @namespace environment\n * @component nav-mesh-helper\n */\nAFRAME.registerComponent(\"nav-mesh-helper\", {\n  init: function() {\n    this.el.addEventListener(\"model-loaded\", () => {\n      const teleporters = document.querySelectorAll(\"[teleporter]\");\n      for (let i = 0; i < teleporters.length; i++) {\n        teleporters[i].components[\"teleporter\"].queryCollisionEntities();\n      }\n    });\n  }\n});\n","/**\n * Drawing Manager\n * Manages what networked-drawings are available to pen components\n * @namespace drawing\n * @component drawing-manager\n */\nAFRAME.registerComponent(\"drawing-manager\", {\n  init() {\n    this._onComponentInitialized = this._onComponentInitialized.bind(this);\n\n    this.el.object3D.visible = false;\n    this.drawingToPen = new Map();\n  },\n\n  remove() {\n    if (this.drawingEl) {\n      this.drawingEl.removeEventListener(\"componentinitialized\", this._onComponentInitialized);\n    }\n  },\n\n  _onComponentInitialized(e) {\n    if (e.detail.name == \"networked-drawing\") {\n      this.drawing = this.drawingEl.components[\"networked-drawing\"];\n    }\n  },\n\n  createDrawing() {\n    if (!this.drawingEl) {\n      this.drawingEl = document.createElement(\"a-entity\");\n      this.drawingEl.setAttribute(\"networked\", \"template: #interactable-drawing\");\n      this.el.sceneEl.appendChild(this.drawingEl);\n\n      this.drawingEl.addEventListener(\"componentinitialized\", this._onComponentInitialized);\n    }\n  },\n\n  getDrawing(pen) {\n    //TODO: future handling of multiple drawings\n    if (this.drawing && (!this.drawingToPen.has(this.drawing) || this.drawingToPen.get(this.drawing) === pen)) {\n      this.drawingToPen.set(this.drawing, pen);\n      return this.drawing;\n    }\n\n    return null;\n  },\n\n  returnDrawing(pen) {\n    if (this.drawingToPen.has(this.drawing) && this.drawingToPen.get(this.drawing) === pen) {\n      this.drawingToPen.delete(this.drawing);\n    }\n  }\n});\n","// Wrapper for a worker which accepts work items and responds with results.\n//\n// The worker must receive messages with data of the shape { id, payload }, and then respond\n// with messages containing matching IDs of the shape { id, result, err }.\n//\n// Returns a function that accepts a work item, sends it to the worker, and returns a promise that\n// will resolve with the result or reject with the error.\n//\nexport function promisifyWorker(worker) {\n  let nextItemId = 0;\n  const outstanding = {}; // item ID: { resolve, reject }\n\n  worker.onmessage = msg => {\n    const { id, result, err } = msg.data;\n    const handlers = outstanding[id];\n    if (handlers == null) {\n      console.error(`Unknown message with ID ${id} received from ${worker}.`);\n    } else {\n      delete outstanding[id];\n      if (err != null) {\n        handlers.reject(new Error(err));\n      } else {\n        handlers.resolve(result);\n      }\n    }\n  };\n\n  return function(data, transfer) {\n    const id = nextItemId++;\n    const promise = new Promise((resolve, reject) => {\n      outstanding[id] = { resolve, reject };\n    });\n    worker.postMessage({ id, payload: data }, transfer);\n    return promise;\n  };\n}\n","import { SOUND_TOGGLE_MIC } from \"../systems/sound-effects-system\";\n\nconst bindAllEvents = function(elements, events, f) {\n  if (!elements || !elements.length) return;\n  for (const el of elements) {\n    events.length &&\n      events.forEach(e => {\n        el.addEventListener(e, f);\n      });\n  }\n};\nconst unbindAllEvents = function(elements, events, f) {\n  if (!elements || !elements.length) return;\n  for (const el of elements) {\n    events.length &&\n      events.forEach(e => {\n        el.removeEventListener(e, f);\n      });\n  }\n};\n\n/**\n * Toggles the microphone on the current network connection based on the given events.\n * @namespace network\n * @component mute-mic\n */\nAFRAME.registerComponent(\"mute-mic\", {\n  schema: {\n    eventSrc: { type: \"selectorAll\" },\n    toggleEvents: { type: \"array\" },\n    muteEvents: { type: \"array\" },\n    unmuteEvents: { type: \"array\" }\n  },\n  init: function() {\n    this.onToggle = this.onToggle.bind(this);\n    this.onMute = this.onMute.bind(this);\n    this.onUnmute = this.onUnmute.bind(this);\n  },\n\n  play: function() {\n    const { eventSrc, toggleEvents, muteEvents, unmuteEvents } = this.data;\n    bindAllEvents(eventSrc, toggleEvents, this.onToggle);\n    bindAllEvents(eventSrc, muteEvents, this.onMute);\n    bindAllEvents(eventSrc, unmuteEvents, this.onUnmute);\n  },\n\n  pause: function() {\n    const { eventSrc, toggleEvents, muteEvents, unmuteEvents } = this.data;\n    unbindAllEvents(eventSrc, toggleEvents, this.onToggle);\n    unbindAllEvents(eventSrc, muteEvents, this.onMute);\n    unbindAllEvents(eventSrc, unmuteEvents, this.onUnmute);\n  },\n\n  onToggle: function() {\n    if (!NAF.connection.adapter) return;\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_TOGGLE_MIC);\n    if (this.el.is(\"muted\")) {\n      NAF.connection.adapter.enableMicrophone(true);\n      this.el.removeState(\"muted\");\n    } else {\n      NAF.connection.adapter.enableMicrophone(false);\n      this.el.addState(\"muted\");\n    }\n  },\n\n  onMute: function() {\n    if (!NAF.connection.adapter) return;\n    if (!this.el.is(\"muted\")) {\n      NAF.connection.adapter.enableMicrophone(false);\n      this.el.addState(\"muted\");\n    }\n  },\n\n  onUnmute: function() {\n    if (this.el.is(\"muted\")) {\n      NAF.connection.adapter.enableMicrophone(true);\n      this.el.removeState(\"muted\");\n    }\n  }\n});\n","import { SOUND_SPAWN_PEN } from \"../systems/sound-effects-system\";\n/**\n * HUD panel for muting, freezing, and space bubble controls.\n * @namespace ui\n * @component in-world-hud\n */\nAFRAME.registerComponent(\"in-world-hud\", {\n  init() {\n    this.mic = this.el.querySelector(\".mic\");\n    this.spawn = this.el.querySelector(\".spawn\");\n    this.pen = this.el.querySelector(\".penhud\");\n    this.cameraBtn = this.el.querySelector(\".camera-btn\");\n    this.inviteBtn = this.el.querySelector(\".invite-btn\");\n    this.background = this.el.querySelector(\".bg\");\n    const renderOrder = window.APP.RENDER_ORDER;\n    this.mic.object3DMap.mesh.renderOrder = renderOrder.HUD_ICONS;\n    this.spawn.object3DMap.mesh.renderOrder = renderOrder.HUD_ICONS;\n    this.pen.object3DMap.mesh.renderOrder = renderOrder.HUD_ICONS;\n    this.cameraBtn.object3DMap.mesh.renderOrder = renderOrder.HUD_ICONS;\n    this.background.object3DMap.mesh.renderOrder = renderOrder.HUD_BACKGROUND;\n\n    this.updateButtonStates = () => {\n      this.mic.setAttribute(\"icon-button\", \"active\", this.el.sceneEl.is(\"muted\"));\n      this.pen.setAttribute(\"icon-button\", \"active\", this.el.sceneEl.is(\"pen\"));\n      this.cameraBtn.setAttribute(\"icon-button\", \"active\", this.el.sceneEl.is(\"camera\"));\n    };\n    this.updateButtonStates();\n\n    this.onStateChange = evt => {\n      if (!(evt.detail === \"muted\" || evt.detail === \"frozen\" || evt.detail === \"pen\" || evt.detail === \"camera\"))\n        return;\n      this.updateButtonStates();\n    };\n\n    this.onMicClick = () => {\n      this.el.emit(\"action_mute\");\n    };\n\n    this.onSpawnClick = () => {\n      this.el.emit(\"action_spawn\");\n    };\n\n    this.onPenClick = () => {\n      this.el.emit(\"spawn_pen\");\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SPAWN_PEN);\n    };\n\n    this.onCameraClick = () => {\n      this.el.emit(\"action_toggle_camera\");\n    };\n\n    this.onInviteClick = () => {\n      this.el.emit(\"action_invite\");\n    };\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateChange);\n\n    this.mic.object3D.addEventListener(\"interact\", this.onMicClick);\n    this.spawn.object3D.addEventListener(\"interact\", this.onSpawnClick);\n    this.pen.object3D.addEventListener(\"interact\", this.onPenClick);\n    this.cameraBtn.object3D.addEventListener(\"interact\", this.onCameraClick);\n    this.inviteBtn.object3D.addEventListener(\"interact\", this.onInviteClick);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateChange);\n\n    this.mic.object3D.removeEventListener(\"interact\", this.onMicClick);\n    this.spawn.object3D.removeEventListener(\"interact\", this.onSpawnClick);\n    this.pen.object3D.removeEventListener(\"interact\", this.onPenClick);\n    this.cameraBtn.object3D.removeEventListener(\"interact\", this.onCameraClick);\n    this.inviteBtn.object3D.removeEventListener(\"interact\", this.onInviteClick);\n  }\n});\n","import nipplejs from \"nipplejs\";\nimport styles from \"./virtual-gamepad-controls.css\";\n\n/**\n * Instantiates 2D virtual gamepads and emits associated events.\n * @namespace user-input\n * @component virtual-gamepad-controls\n */\nAFRAME.registerComponent(\"virtual-gamepad-controls\", {\n  schema: {},\n\n  init() {\n    this.onEnterVr = this.onEnterVr.bind(this);\n    this.onExitVr = this.onExitVr.bind(this);\n    this.onFirstInteraction = this.onFirstInteraction.bind(this);\n    this.onMoveJoystickChanged = this.onMoveJoystickChanged.bind(this);\n    this.onMoveJoystickEnd = this.onMoveJoystickEnd.bind(this);\n    this.onLookJoystickChanged = this.onLookJoystickChanged.bind(this);\n    this.onLookJoystickEnd = this.onLookJoystickEnd.bind(this);\n\n    this.mockJoystickContainer = document.createElement(\"div\");\n    this.mockJoystickContainer.classList.add(styles.mockJoystickContainer);\n    const leftMock = document.createElement(\"div\");\n    leftMock.classList.add(styles.mockJoystick);\n    const leftMockSmall = document.createElement(\"div\");\n    leftMockSmall.classList.add(styles.mockJoystick, styles.inner);\n    leftMock.appendChild(leftMockSmall);\n    this.mockJoystickContainer.appendChild(leftMock);\n    const rightMock = document.createElement(\"div\");\n    rightMock.classList.add(styles.mockJoystick);\n    const rightMockSmall = document.createElement(\"div\");\n    rightMockSmall.classList.add(styles.mockJoystick, styles.inner);\n    rightMock.appendChild(rightMockSmall);\n    this.mockJoystickContainer.appendChild(rightMock);\n    document.body.appendChild(this.mockJoystickContainer);\n\n    // Setup gamepad elements\n    const leftTouchZone = document.createElement(\"div\");\n    leftTouchZone.classList.add(styles.touchZone, styles.left);\n    document.body.appendChild(leftTouchZone);\n\n    this.leftTouchZone = leftTouchZone;\n\n    this.leftStick = nipplejs.create({\n      zone: this.leftTouchZone,\n      color: \"white\",\n      fadeTime: 0\n    });\n\n    this.leftStick.on(\"start\", this.onFirstInteraction);\n    this.leftStick.on(\"move\", this.onMoveJoystickChanged);\n    this.leftStick.on(\"end\", this.onMoveJoystickEnd);\n\n    const rightTouchZone = document.createElement(\"div\");\n    rightTouchZone.classList.add(styles.touchZone, styles.right);\n    document.body.appendChild(rightTouchZone);\n\n    this.rightTouchZone = rightTouchZone;\n\n    this.rightStick = nipplejs.create({\n      zone: this.rightTouchZone,\n      color: \"white\",\n      fadeTime: 0\n    });\n\n    this.rightStick.on(\"start\", this.onFirstInteraction);\n    this.rightStick.on(\"move\", this.onLookJoystickChanged);\n    this.rightStick.on(\"end\", this.onLookJoystickEnd);\n\n    this.inVr = false;\n    this.moving = false;\n    this.rotating = false;\n\n    this.moveEvent = {\n      axis: [0, 0]\n    };\n    this.rotateYEvent = {\n      value: 0\n    };\n    this.rotateXEvent = {\n      value: 0\n    };\n\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.onEnterVr);\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.onExitVr);\n  },\n\n  onFirstInteraction() {\n    this.leftStick.off(\"start\", this.onFirstInteraction);\n    this.rightStick.off(\"start\", this.onFirstInteraction);\n    document.body.removeChild(this.mockJoystickContainer);\n  },\n\n  onMoveJoystickChanged(event, joystick) {\n    const angle = joystick.angle.radian;\n    const force = joystick.force < 1 ? joystick.force : 1;\n    const moveStrength = 1.85;\n    const x = Math.cos(angle) * force * moveStrength;\n    const z = Math.sin(angle) * force * moveStrength;\n    this.moving = true;\n    this.moveEvent.axis[0] = x;\n    this.moveEvent.axis[1] = z;\n  },\n\n  onMoveJoystickEnd() {\n    this.moving = false;\n    this.moveEvent.axis[0] = 0;\n    this.moveEvent.axis[1] = 0;\n    this.el.sceneEl.emit(\"move\", this.moveEvent);\n  },\n\n  onLookJoystickChanged(event, joystick) {\n    // Set pitch and yaw angles on right stick move\n    const angle = joystick.angle.radian;\n    const force = joystick.force < 1 ? joystick.force : 1;\n    const turnStrength = 0.5;\n    this.rotating = true;\n    this.rotateYEvent.value = Math.cos(angle) * force * turnStrength;\n    this.rotateXEvent.value = Math.sin(angle) * force * turnStrength;\n  },\n\n  onLookJoystickEnd() {\n    this.rotating = false;\n    this.rotateYEvent.value = 0;\n    this.rotateXEvent.value = 0;\n    this.el.sceneEl.emit(\"rotateY\", this.rotateYEvent);\n    this.el.sceneEl.emit(\"rotateX\", this.rotateXEvent);\n  },\n\n  tick() {\n    if (!this.inVr) {\n      if (this.moving) {\n        this.el.sceneEl.emit(\"move\", this.moveEvent);\n      }\n\n      if (this.rotating) {\n        this.el.sceneEl.emit(\"rotateY\", this.rotateYEvent);\n        this.el.sceneEl.emit(\"rotateX\", this.rotateXEvent);\n      }\n    }\n  },\n\n  onEnterVr() {\n    // Hide the joystick controls\n    this.inVr = true;\n    this.leftTouchZone.style.display = \"none\";\n    this.rightTouchZone.style.display = \"none\";\n  },\n\n  onExitVr() {\n    // Show the joystick controls\n    this.inVr = false;\n    this.leftTouchZone.style.display = \"block\";\n    this.rightTouchZone.style.display = \"block\";\n  },\n\n  remove() {\n    this.el.sceneEl.removeEventListener(\"entervr\", this.onEnterVr);\n    this.el.sceneEl.removeEventListener(\"exitvr\", this.onExitVr);\n    document.body.removeChild(this.mockJoystickContainer);\n    document.body.removeChild(this.leftTouchZone);\n    document.body.removeChild(this.rightTouchZone);\n  }\n});\n","import { getReticulumFetchUrl } from \"./phoenix-utils\";\nimport { proxiedUrlFor } from \"./media-utils\";\nimport { avatars } from \"../assets/avatars/avatars\";\n\nexport const AVATAR_TYPES = {\n  LEGACY: \"legacy\",\n  SKINNABLE: \"skinnable\",\n  URL: \"url\"\n};\n\nconst legacyAvatarIds = avatars.map(a => a.id);\nexport function getAvatarType(avatarId) {\n  if (!avatarId || legacyAvatarIds.indexOf(avatarId) !== -1) return AVATAR_TYPES.LEGACY;\n  if (avatarId.startsWith(\"http\")) return AVATAR_TYPES.URL;\n  return AVATAR_TYPES.SKINNABLE;\n}\n\nasync function fetchAvatar(avatarId) {\n  const resp = await fetch(getReticulumFetchUrl(`/api/v1/avatars/${avatarId}`));\n  if (resp.status === 404) {\n    return null;\n  } else {\n    return resp.json().then(({ avatars }) => avatars[0]);\n  }\n}\n\nasync function fetchAvatarGltfUrl(avatarId) {\n  return fetchAvatar(avatarId).then(avatar => avatar.gltf_url);\n}\n\nexport function getAvatarSrc(avatarId) {\n  switch (getAvatarType(avatarId)) {\n    case AVATAR_TYPES.LEGACY:\n      return `#${avatarId}`;\n    case AVATAR_TYPES.SKINNABLE:\n      return fetchAvatarGltfUrl(avatarId);\n    case AVATAR_TYPES.URL:\n      return proxiedUrlFor(avatarId);\n    default:\n      return avatarId;\n  }\n}\n\nexport function getAvatarGltfUrl(avatarId) {\n  switch (getAvatarType(avatarId)) {\n    case AVATAR_TYPES.LEGACY:\n      return avatars.find(avatar => avatar.id === avatarId).model;\n    case AVATAR_TYPES.SKINNABLE:\n      return fetchAvatarGltfUrl(avatarId);\n    case AVATAR_TYPES.URL:\n      return proxiedUrlFor(avatarId);\n  }\n}\n\nexport async function getAvatarThumbnailUrl(avatarId) {\n  switch (getAvatarType(avatarId)) {\n    case AVATAR_TYPES.LEGACY:\n      return avatars.find(avatar => avatar.id === avatarId).thumbnail;\n    case AVATAR_TYPES.SKINNABLE:\n      return fetchAvatar(avatarId).then(avatar => avatar.files.thumbnail);\n    default:\n      return \"https://asset-bundles-prod.reticulum.io/bots/avatar_unavailable.png\";\n  }\n}\n","const { Vector3, Quaternion, Matrix4, Euler } = THREE;\n\nimport { AVATAR_TYPES } from \"../utils/avatar-utils\";\n\nfunction quaternionAlmostEquals(epsilon, u, v) {\n  // Note: q and -q represent same rotation\n  return (\n    (Math.abs(u.x - v.x) < epsilon &&\n      Math.abs(u.y - v.y) < epsilon &&\n      Math.abs(u.z - v.z) < epsilon &&\n      Math.abs(u.w - v.w) < epsilon) ||\n    (Math.abs(-u.x - v.x) < epsilon &&\n      Math.abs(-u.y - v.y) < epsilon &&\n      Math.abs(-u.z - v.z) < epsilon &&\n      Math.abs(-u.w - v.w) < epsilon)\n  );\n}\n\n/**\n * Provides access to the end effectors for IK.\n * @namespace avatar\n * @component ik-root\n */\nAFRAME.registerComponent(\"ik-root\", {\n  schema: {\n    camera: { type: \"string\", default: \".camera\" },\n    leftController: { type: \"string\", default: \".left-controller\" },\n    rightController: { type: \"string\", default: \".right-controller\" }\n  },\n  update(oldData) {\n    if (this.data.camera !== oldData.camera) {\n      this.camera = this.el.querySelector(this.data.camera);\n    }\n\n    if (this.data.leftController !== oldData.leftController) {\n      this.leftController = this.el.querySelector(this.data.leftController);\n    }\n\n    if (this.data.rightController !== oldData.rightController) {\n      this.rightController = this.el.querySelector(this.data.rightController);\n    }\n  }\n});\n\nfunction findIKRoot(entity) {\n  while (entity && !(entity.components && entity.components[\"ik-root\"])) {\n    entity = entity.parentNode;\n  }\n  return entity && entity.components[\"ik-root\"];\n}\n\nconst LEGACY_HAND_ROTATIONS = {\n  left: new Matrix4().makeRotationFromEuler(new Euler(-Math.PI / 2, Math.PI / 2, 0)),\n  right: new Matrix4().makeRotationFromEuler(new Euler(Math.PI / 2, Math.PI / 2, 0))\n};\n\nconst HAND_ROTATIONS = {\n  left: new Matrix4().makeRotationFromEuler(new Euler(-Math.PI / 2, Math.PI / 2, 0)),\n  right: new Matrix4().makeRotationFromEuler(new Euler(-Math.PI / 2, -Math.PI / 2, 0))\n};\n\n/**\n * Performs IK on a hip-rooted skeleton to align the hip, head and hands with camera and controller inputs.\n * @namespace avatar\n * @component ik-controller\n */\nAFRAME.registerComponent(\"ik-controller\", {\n  schema: {\n    leftEye: { type: \"string\", default: \"LeftEye\" },\n    rightEye: { type: \"string\", default: \"RightEye\" },\n    head: { type: \"string\", default: \"Head\" },\n    neck: { type: \"string\", default: \"Neck\" },\n    leftHand: { type: \"string\", default: \"LeftHand\" },\n    rightHand: { type: \"string\", default: \"RightHand\" },\n    chest: { type: \"string\", default: \"Spine\" },\n    hips: { type: \"string\", default: \"Hips\" },\n    rotationSpeed: { default: 5 },\n    alwaysUpdate: { type: \"boolean\", default: false }\n  },\n\n  init() {\n    this._runScheduledWork = this._runScheduledWork.bind(this);\n    this._updateIsInView = this._updateIsInView.bind(this);\n\n    this.flipY = new Matrix4().makeRotationY(Math.PI);\n\n    this.cameraForward = new Matrix4();\n    this.headTransform = new Matrix4();\n    this.hipsPosition = new Vector3();\n\n    this.invHipsToHeadVector = new Vector3();\n\n    this.middleEyeMatrix = new Matrix4();\n    this.middleEyePosition = new Vector3();\n    this.invMiddleEyeToHead = new Matrix4();\n\n    this.cameraYRotation = new Euler();\n    this.cameraYQuaternion = new Quaternion();\n\n    this.invHipsQuaternion = new Quaternion();\n    this.headQuaternion = new Quaternion();\n\n    this.rootToChest = new Matrix4();\n    this.invRootToChest = new Matrix4();\n\n    this.ikRoot = findIKRoot(this.el);\n\n    this.isInView = true;\n    this.hasConvergedHips = false;\n    this.lastCameraTransform = new THREE.Matrix4();\n    this.cameraMirrorSystem = this.el.sceneEl.systems[\"camera-mirror\"];\n    this.playerCamera = document.querySelector(\"#player-camera\").getObject3D(\"camera\");\n\n    this.el.sceneEl.systems[\"frame-scheduler\"].schedule(this._runScheduledWork, \"ik\");\n  },\n\n  remove() {\n    this.el.sceneEl.systems[\"frame-scheduler\"].unschedule(this._runScheduledWork, \"ik\");\n  },\n\n  update(oldData) {\n    if (this.data.leftEye !== oldData.leftEye) {\n      this.leftEye = this.el.object3D.getObjectByName(this.data.leftEye);\n    }\n\n    if (this.data.rightEye !== oldData.rightEye) {\n      this.rightEye = this.el.object3D.getObjectByName(this.data.rightEye);\n    }\n\n    if (this.data.head !== oldData.head) {\n      this.head = this.el.object3D.getObjectByName(this.data.head);\n    }\n\n    if (this.data.neck !== oldData.neck) {\n      this.neck = this.el.object3D.getObjectByName(this.data.neck);\n    }\n\n    if (this.data.leftHand !== oldData.leftHand) {\n      this.leftHand = this.el.object3D.getObjectByName(this.data.leftHand);\n    }\n\n    if (this.data.rightHand !== oldData.rightHand) {\n      this.rightHand = this.el.object3D.getObjectByName(this.data.rightHand);\n    }\n\n    if (this.data.chest !== oldData.chest) {\n      this.chest = this.el.object3D.getObjectByName(this.data.chest);\n    }\n\n    if (this.data.hips !== oldData.hips) {\n      this.hips = this.el.object3D.getObjectByName(this.data.hips);\n    }\n\n    // Set middleEye's position to be right in the middle of the left and right eyes.\n    this.middleEyePosition.addVectors(this.leftEye.position, this.rightEye.position);\n    this.middleEyePosition.divideScalar(2);\n    this.middleEyeMatrix.makeTranslation(this.middleEyePosition.x, this.middleEyePosition.y, this.middleEyePosition.z);\n    this.invMiddleEyeToHead = this.middleEyeMatrix.getInverse(this.middleEyeMatrix);\n\n    this.invHipsToHeadVector\n      .addVectors(this.chest.position, this.neck.position)\n      .add(this.head.position)\n      .negate();\n  },\n\n  tick(time, dt) {\n    if (!this.ikRoot) {\n      return;\n    }\n\n    const root = this.ikRoot.el.object3D;\n    const { camera, leftController, rightController } = this.ikRoot;\n\n    camera.object3D.updateMatrix();\n\n    const hasNewCameraTransform = !this.lastCameraTransform.equals(camera.object3D.matrix);\n\n    // Optimization: if the camera hasn't moved and the hips converged to the target orientation on a previous frame,\n    // then the avatar does not need any IK this frame.\n    //\n    // Update in-view avatars every frame, and update out-of-view avatars via frame scheduler.\n    if (\n      this.data.alwaysUpdate ||\n      this.forceIkUpdate ||\n      (this.isInView && (hasNewCameraTransform || !this.hasConvergedHips))\n    ) {\n      if (hasNewCameraTransform) {\n        this.lastCameraTransform.copy(camera.object3D.matrix);\n      }\n\n      const {\n        hips,\n        head,\n        neck,\n        chest,\n        cameraForward,\n        headTransform,\n        invMiddleEyeToHead,\n        invHipsToHeadVector,\n        flipY,\n        cameraYRotation,\n        cameraYQuaternion,\n        invHipsQuaternion,\n        rootToChest,\n        invRootToChest\n      } = this;\n\n      // Camera faces the -Z direction. Flip it along the Y axis so that it is +Z.\n      cameraForward.multiplyMatrices(camera.object3D.matrix, flipY);\n\n      // Compute the head position such that the hmd position would be in line with the middleEye\n      headTransform.multiplyMatrices(cameraForward, invMiddleEyeToHead);\n\n      // Then position the hips such that the head is aligned with headTransform\n      // (which positions middleEye in line with the hmd)\n      hips.position.setFromMatrixPosition(headTransform).add(invHipsToHeadVector);\n\n      // Animate the hip rotation to follow the Y rotation of the camera with some damping.\n      cameraYRotation.setFromRotationMatrix(cameraForward, \"YXZ\");\n      cameraYRotation.x = 0;\n      cameraYRotation.z = 0;\n      cameraYQuaternion.setFromEuler(cameraYRotation);\n      Quaternion.slerp(hips.quaternion, cameraYQuaternion, hips.quaternion, (this.data.rotationSpeed * dt) / 1000);\n\n      this.hasConvergedHips = quaternionAlmostEquals(0.0001, cameraYQuaternion, hips.quaternion);\n\n      // Take the head orientation computed from the hmd, remove the Y rotation already applied to it by the hips,\n      // and apply it to the head\n      invHipsQuaternion.copy(hips.quaternion).inverse();\n      head.quaternion.setFromRotationMatrix(headTransform).premultiply(invHipsQuaternion);\n\n      hips.updateMatrix();\n      rootToChest.multiplyMatrices(hips.matrix, chest.matrix);\n      invRootToChest.getInverse(rootToChest);\n\n      root.matrixNeedsUpdate = true;\n      neck.matrixNeedsUpdate = true;\n      head.matrixNeedsUpdate = true;\n      chest.matrixNeedsUpdate = true;\n    }\n\n    const { leftHand, rightHand } = this;\n\n    const handRotations =\n      this.ikRoot.el.components[\"player-info\"].data.avatarType === AVATAR_TYPES.LEGACY\n        ? LEGACY_HAND_ROTATIONS\n        : HAND_ROTATIONS;\n    this.updateHand(handRotations.left, leftHand, leftController.object3D, true, this.isInView);\n    this.updateHand(handRotations.right, rightHand, rightController.object3D, false, this.isInView);\n    this.forceIkUpdate = false;\n  },\n\n  updateHand(handRotation, handObject3D, controllerObject3D, isLeft, isInView) {\n    const handMatrix = handObject3D.matrix;\n\n    // TODO: This coupling with personal-space-invader is not ideal.\n    // There should be some intermediate thing managing multiple opinions about object visibility\n    const spaceInvader = handObject3D.el.components[\"personal-space-invader\"];\n    const handHiddenByPersonalSpace = spaceInvader && spaceInvader.invading;\n\n    handObject3D.visible = !handHiddenByPersonalSpace && controllerObject3D.visible;\n\n    // Optimization: skip IK update if not in view and not forced by frame scheduler\n    if (controllerObject3D.visible && (isInView || this.forceIkUpdate || this.data.alwaysUpdate)) {\n      handMatrix.multiplyMatrices(this.invRootToChest, controllerObject3D.matrix);\n\n      handMatrix.multiply(handRotation);\n\n      handObject3D.position.setFromMatrixPosition(handMatrix);\n      handObject3D.rotation.setFromRotationMatrix(handMatrix);\n      handObject3D.matrixNeedsUpdate = true;\n    }\n  },\n\n  _runScheduledWork() {\n    // Every scheduled run, we force an IK update on the next frame (so at most one avatar with forced IK per frame)\n    // and also update the this.isInView bit on the avatar which is used to determine if an IK update should be run\n    // every frame.\n    this.forceIkUpdate = true;\n\n    this._updateIsInView();\n  },\n\n  _updateIsInView: (function() {\n    const frustum = new THREE.Frustum();\n    const frustumMatrix = new THREE.Matrix4();\n    const cameraWorld = new THREE.Vector3();\n    const isInViewOfCamera = (screenCamera, pos) => {\n      frustumMatrix.multiplyMatrices(screenCamera.projectionMatrix, screenCamera.matrixWorldInverse);\n      frustum.setFromMatrix(frustumMatrix);\n      return frustum.containsPoint(pos);\n    };\n\n    return function() {\n      // Take into account the mirror camera if it is enabled.\n      const mirrorCamera = this.cameraMirrorSystem.mirrorCamera;\n\n      const camera = this.ikRoot.camera.object3D;\n      camera.getWorldPosition(cameraWorld);\n\n      this.isInView =\n        isInViewOfCamera(this.playerCamera, cameraWorld) ||\n        (mirrorCamera && isInViewOfCamera(mirrorCamera, cameraWorld));\n    };\n  })()\n});\n","import { paths } from \"../systems/userinput/paths\";\n\nconst POSES = {\n  open: \"open\",\n  point: \"point\",\n  fist: \"fist\",\n  hold: \"hold\",\n  thumbUp: \"thumbUp\",\n  thumbDown: \"thumbDown\",\n  indexDown: \"indexDown\",\n  pinch: \"pinch\",\n  mrpDown: \"mrpDown\"\n};\n\n/**\n * Emits events indicating that avatar hands should be posed differently.\n * @namespace user-input\n * @component hand-controls2\n */\nAFRAME.registerComponent(\"hand-controls2\", {\n  schema: { default: \"left\" },\n\n  init() {\n    this.pose = POSES.open;\n  },\n\n  poseForFingers(thumb, index, middleRingPinky) {\n    if (!thumb && !index && !middleRingPinky) {\n      return POSES.open;\n    } else if (thumb && index && middleRingPinky) {\n      return POSES.fist;\n    } else if (!thumb && index && middleRingPinky) {\n      return POSES.thumbUp;\n    } else if (!thumb && !index && middleRingPinky) {\n      return POSES.mrpDown;\n    } else if (!thumb && index && !middleRingPinky) {\n      return POSES.indexDown;\n    } else if (thumb && !index && !middleRingPinky) {\n      return POSES.thumbDown;\n    } else if (thumb && index && !middleRingPinky) {\n      return POSES.pinch;\n    } else if (thumb && !index && middleRingPinky) {\n      return POSES.point;\n    }\n\n    console.warn(`Did not find matching pose for thumb ${thumb}, index ${index}, middleRingPinky ${middleRingPinky}`);\n    return POSES.open;\n  },\n\n  tick() {\n    const hand = this.data;\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const subpath = hand === \"left\" ? paths.actions.leftHand : paths.actions.rightHand;\n    const thumb = userinput.get(subpath.thumb);\n    const index = userinput.get(subpath.index);\n    const middleRingPinky = userinput.get(subpath.middleRingPinky);\n    const pose = this.poseForFingers(thumb, index, middleRingPinky);\n    if (pose !== this.pose) {\n      this.el.emit(\"hand-pose\", { previous: this.pose, current: pose });\n      this.pose = pose;\n    }\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\nimport { SOUND_SNAP_ROTATE } from \"../systems/sound-effects-system\";\nconst CLAMP_VELOCITY = 0.01;\nconst MAX_DELTA = 0.2;\nconst EPS = 10e-6;\nconst MAX_WARNINGS = 10;\nconst PI_2 = Math.PI / 2;\n\nconst NAV_ZONE = \"character\";\n\n/**\n * Avatar movement controller that listens to move, rotate and teleportation events and moves the avatar accordingly.\n * The controller accounts for playspace offset and orientation and depends on the nav mesh system for translation.\n * @namespace avatar\n * @component character-controller\n */\nAFRAME.registerComponent(\"character-controller\", {\n  schema: {\n    groundAcc: { default: 5.5 },\n    easing: { default: 10 },\n    pivot: { type: \"selector\" },\n    snapRotationDegrees: { default: THREE.Math.DEG2RAD * 45 },\n    rotationSpeed: { default: -3 },\n    fly: { default: false }\n  },\n\n  init: function() {\n    this.navGroup = null;\n    this.navNode = null;\n    this.velocity = new THREE.Vector3(0, 0, 0);\n    this.accelerationInput = new THREE.Vector3(0, 0, 0);\n    this.pendingSnapRotationMatrix = new THREE.Matrix4();\n    this.angularVelocity = 0; // Scalar value because we only allow rotation around Y\n    this._withinWarningLimit = true;\n    this._warningCount = 0;\n    this.setAccelerationInput = this.setAccelerationInput.bind(this);\n    this.snapRotateLeft = this.snapRotateLeft.bind(this);\n    this.snapRotateRight = this.snapRotateRight.bind(this);\n    this.setAngularVelocity = this.setAngularVelocity.bind(this);\n    this.el.sceneEl.addEventListener(\"nav-mesh-loaded\", () => {\n      this.navGroup = null;\n      this.navNode = null;\n    });\n  },\n\n  update: function() {\n    this.leftRotationMatrix = new THREE.Matrix4().makeRotationY(this.data.snapRotationDegrees);\n    this.rightRotationMatrix = new THREE.Matrix4().makeRotationY(-this.data.snapRotationDegrees);\n  },\n\n  play: function() {\n    const eventSrc = this.el.sceneEl;\n    eventSrc.addEventListener(\"move\", this.setAccelerationInput);\n    eventSrc.addEventListener(\"rotateY\", this.setAngularVelocity);\n  },\n\n  pause: function() {\n    const eventSrc = this.el.sceneEl;\n    eventSrc.removeEventListener(\"move\", this.setAccelerationInput);\n    eventSrc.removeEventListener(\"rotateY\", this.setAngularVelocity);\n    this.reset();\n  },\n\n  reset() {\n    this.accelerationInput.set(0, 0, 0);\n    this.velocity.set(0, 0, 0);\n    this.angularVelocity = 0;\n    this.pendingSnapRotationMatrix.identity();\n  },\n\n  setAccelerationInput: function(event) {\n    const axes = event.detail.axis;\n    this.accelerationInput.set(axes[0], 0, axes[1]);\n  },\n\n  setAngularVelocity: function(event) {\n    this.angularVelocity = event.detail.value;\n  },\n\n  snapRotateLeft: function() {\n    this.pendingSnapRotationMatrix.copy(this.leftRotationMatrix);\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SNAP_ROTATE);\n  },\n\n  snapRotateRight: function() {\n    this.pendingSnapRotationMatrix.copy(this.rightRotationMatrix);\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SNAP_ROTATE);\n  },\n\n  // We assume the rig is at the root, and its local position === its world position.\n  teleportTo: (function() {\n    const rig = new THREE.Vector3();\n    const head = new THREE.Vector3();\n    const deltaFromHeadToTargetForHead = new THREE.Vector3();\n    const targetForHead = new THREE.Vector3();\n    const targetForRig = new THREE.Vector3();\n    return function teleportTo(targetWorldPosition) {\n      const o = this.el.object3D;\n      o.getWorldPosition(rig);\n      this.data.pivot.object3D.getWorldPosition(head);\n      targetForHead.copy(targetWorldPosition);\n      targetForHead.y += this.data.pivot.object3D.position.y;\n      deltaFromHeadToTargetForHead.copy(targetForHead).sub(head);\n      targetForRig.copy(rig).add(deltaFromHeadToTargetForHead);\n\n      const pathfinder = this.el.sceneEl.systems.nav.pathfinder;\n      this.navGroup = pathfinder.getGroup(NAV_ZONE, targetForRig, true, true);\n      this.navNode = null;\n      this._setNavNode(targetForRig);\n      pathfinder.clampStep(rig, targetForRig, this.navNode, NAV_ZONE, this.navGroup, o.position);\n      o.matrixNeedsUpdate = true;\n    };\n  })(),\n\n  tick: (function() {\n    const move = new THREE.Matrix4();\n    const trans = new THREE.Matrix4();\n    const transInv = new THREE.Matrix4();\n    const pivotPos = new THREE.Vector3();\n    const rotationAxis = new THREE.Vector3(0, 1, 0);\n    const yawMatrix = new THREE.Matrix4();\n    const rotationMatrix = new THREE.Matrix4();\n    const rotationInvMatrix = new THREE.Matrix4();\n    const pivotRotationMatrix = new THREE.Matrix4();\n    const pivotRotationInvMatrix = new THREE.Matrix4();\n    const startPos = new THREE.Vector3();\n    const startScale = new THREE.Vector3();\n\n    return function(t, dt) {\n      if (!this.el.sceneEl.is(\"entered\")) return;\n      const deltaSeconds = dt / 1000;\n      const root = this.el.object3D;\n      const pivot = this.data.pivot.object3D;\n      const distance = this.data.groundAcc * deltaSeconds;\n      const rotationDelta = this.data.rotationSpeed * this.angularVelocity * deltaSeconds;\n\n      pivot.updateMatrices();\n      root.updateMatrices();\n\n      startScale.copy(root.scale);\n      startPos.copy(root.position);\n\n      const userinput = AFRAME.scenes[0].systems.userinput;\n      if (userinput.get(paths.actions.snapRotateLeft)) {\n        this.snapRotateLeft();\n      }\n      if (userinput.get(paths.actions.snapRotateRight)) {\n        this.snapRotateRight();\n      }\n      const acc = userinput.get(paths.actions.characterAcceleration);\n      if (acc) {\n        this.accelerationInput.set(\n          this.accelerationInput.x + acc[0],\n          this.accelerationInput.y + 0,\n          this.accelerationInput.z + acc[1]\n        );\n      }\n\n      pivotPos.copy(pivot.position);\n      pivotPos.applyMatrix4(root.matrix);\n      trans.setPosition(pivotPos);\n      transInv.makeTranslation(-pivotPos.x, -pivotPos.y, -pivotPos.z);\n      rotationMatrix.makeRotationAxis(rotationAxis, root.rotation.y);\n      rotationInvMatrix.makeRotationAxis(rotationAxis, -root.rotation.y);\n      pivotRotationMatrix.makeRotationAxis(rotationAxis, pivot.rotation.y);\n      pivotRotationInvMatrix.makeRotationAxis(rotationAxis, -pivot.rotation.y);\n      this.updateVelocity(deltaSeconds, pivot);\n      this.accelerationInput.set(0, 0, 0);\n\n      const boost = userinput.get(paths.actions.boost) ? 2 : 1;\n      move.makeTranslation(\n        this.velocity.x * distance * boost,\n        this.velocity.y * distance * boost,\n        this.velocity.z * distance * boost\n      );\n      yawMatrix.makeRotationAxis(rotationAxis, rotationDelta);\n\n      // Translate to middle of playspace (player rig)\n      root.matrix.premultiply(transInv);\n      // Zero playspace (player rig) rotation\n      root.matrix.premultiply(rotationInvMatrix);\n      // Zero pivot (camera/head) rotation\n      root.matrix.premultiply(pivotRotationInvMatrix);\n      // Apply joystick translation\n      root.matrix.premultiply(move);\n      // Apply joystick yaw rotation\n      root.matrix.premultiply(yawMatrix);\n      // Apply snap rotation if necessary\n      root.matrix.premultiply(this.pendingSnapRotationMatrix);\n      // Reapply pivot (camera/head) rotation\n      root.matrix.premultiply(pivotRotationMatrix);\n      // Reapply playspace (player rig) rotation\n      root.matrix.premultiply(rotationMatrix);\n      // Reapply playspace (player rig) translation\n      root.matrix.premultiply(trans);\n      // update pos/rot/scale\n      root.matrix.decompose(root.position, root.quaternion, root.scale);\n\n      // TODO: the above matrix trnsfomraitons introduce some floating point errors in scale, this reverts them to\n      // avoid spamming network with fake scale updates\n      root.scale.copy(startScale);\n\n      this.pendingSnapRotationMatrix.identity(); // Revert to identity\n\n      if (this.velocity.lengthSq() > EPS && !this.data.fly) {\n        this.setPositionOnNavMesh(startPos, root.position, root);\n      }\n\n      root.matrixNeedsUpdate = true;\n    };\n  })(),\n\n  _warnWithWarningLimit: function(msg) {\n    if (!this._withinWarningLimit) return;\n    this._warningCount++;\n    if (this._warningCount > MAX_WARNINGS) {\n      this._withinWarningLimit = false;\n      msg = \"Warning count exceeded. Will not log further warnings\";\n    }\n    console.warn(\"character-controller\", msg);\n  },\n\n  _setNavNode: function(pos) {\n    if (this.navNode !== null) return;\n    const { pathfinder } = this.el.sceneEl.systems.nav;\n    this.navNode =\n      pathfinder.getClosestNode(pos, NAV_ZONE, this.navGroup, true) ||\n      pathfinder.getClosestNode(pos, NAV_ZONE, this.navGroup);\n  },\n\n  setPositionOnNavMesh: function(start, end, object3D) {\n    const { pathfinder } = this.el.sceneEl.systems.nav;\n    if (!(NAV_ZONE in pathfinder.zones)) return;\n    if (this.navGroup === null) {\n      this.navGroup = pathfinder.getGroup(NAV_ZONE, end, true, true);\n    }\n    this._setNavNode(end);\n    this.navNode = pathfinder.clampStep(start, end, this.navNode, NAV_ZONE, this.navGroup, object3D.position);\n    object3D.matrixNeedsUpdate = true;\n  },\n\n  updateVelocity: function(dt, pivot) {\n    const data = this.data;\n    const velocity = this.velocity;\n\n    // If FPS too low, reset velocity.\n    if (dt > MAX_DELTA) {\n      velocity.x = 0;\n      velocity.y = 0;\n      velocity.z = 0;\n      return;\n    }\n\n    // Decay velocity.\n    if (velocity.x !== 0) {\n      velocity.x -= velocity.x * data.easing * dt;\n    }\n    if (velocity.y !== 0) {\n      velocity.y -= velocity.y * data.easing * dt;\n    }\n    if (velocity.z !== 0) {\n      velocity.z -= velocity.z * data.easing * dt;\n    }\n\n    const dvx = data.groundAcc * dt * this.accelerationInput.x;\n    const dvz = data.groundAcc * dt * -this.accelerationInput.z;\n    velocity.x += dvx;\n\n    if (this.data.fly) {\n      const pitch = pivot.rotation.x / PI_2;\n      velocity.y += dvz * -pitch;\n      velocity.z += dvz * (1.0 - pitch);\n    } else {\n      velocity.z += dvz;\n    }\n\n    const decay = 0.7;\n    this.accelerationInput.x = this.accelerationInput.x * decay;\n    this.accelerationInput.z = this.accelerationInput.z * decay;\n\n    if (Math.abs(velocity.x) < CLAMP_VELOCITY) {\n      velocity.x = 0;\n    }\n    if (this.data.fly && Math.abs(velocity.y) < CLAMP_VELOCITY) {\n      velocity.y = 0;\n    }\n    if (Math.abs(velocity.z) < CLAMP_VELOCITY) {\n      velocity.z = 0;\n    }\n  }\n});\n","import { injectCustomShaderChunks } from \"../utils/media-utils\";\nimport { AVATAR_TYPES } from \"../utils/avatar-utils\";\n/**\n * Sets player info state, including avatar choice and display name.\n * @namespace avatar\n * @component player-info\n */\nAFRAME.registerComponent(\"player-info\", {\n  schema: {\n    avatarSrc: { type: \"string\" },\n    avatarType: { type: \"string\", default: AVATAR_TYPES.LEGACY }\n  },\n  init() {\n    this.displayName = null;\n    this.communityIdentifier = null;\n    this.applyProperties = this.applyProperties.bind(this);\n    this.updateDisplayName = this.updateDisplayName.bind(this);\n    this.applyDisplayName = this.applyDisplayName.bind(this);\n\n    this.isLocalPlayerInfo = this.el.id === \"player-rig\";\n    this.playerSessionId = null;\n\n    if (!this.isLocalPlayerInfo) {\n      NAF.utils.getNetworkedEntity(this.el).then(networkedEntity => {\n        this.playerSessionId = NAF.utils.getCreator(networkedEntity);\n        const playerPresence = window.APP.hubChannel.presence.state[this.playerSessionId];\n        if (playerPresence) {\n          this.updateDisplayNameFromPresenceMeta(playerPresence.metas[0]);\n        }\n      });\n    }\n  },\n  play() {\n    this.el.addEventListener(\"model-loaded\", this.applyProperties);\n    this.el.sceneEl.addEventListener(\"presence_updated\", this.updateDisplayName);\n  },\n  pause() {\n    this.el.removeEventListener(\"model-loaded\", this.applyProperties);\n    this.el.sceneEl.removeEventListener(\"presence_updated\", this.updateDisplayName);\n  },\n  update() {\n    this.applyProperties();\n  },\n  updateDisplayName(e) {\n    if (!this.playerSessionId && this.isLocalPlayerInfo) {\n      this.playerSessionId = NAF.clientId;\n    }\n    if (!this.playerSessionId) return;\n    if (this.playerSessionId !== e.detail.sessionId) return;\n\n    this.updateDisplayNameFromPresenceMeta(e.detail);\n  },\n  updateDisplayNameFromPresenceMeta(presenceMeta) {\n    const isModerator = presenceMeta.roles && presenceMeta.roles.moderator;\n    this.displayName = presenceMeta.profile.displayName + (isModerator ? \" *\" : \"\");\n    this.communityIdentifier = presenceMeta.profile.communityIdentifier;\n    this.applyDisplayName();\n  },\n  applyDisplayName() {\n    const nametagEl = this.el.querySelector(\".nametag\");\n    if (this.displayName && nametagEl) {\n      nametagEl.setAttribute(\"text\", { value: this.displayName });\n    }\n    const communityIdentifierEl = this.el.querySelector(\".communityIdentifier\");\n    if (this.communityIdentifier && communityIdentifierEl) {\n      communityIdentifierEl.setAttribute(\"text\", { value: this.communityIdentifier });\n    }\n  },\n  applyProperties() {\n    this.applyDisplayName();\n\n    const modelEl = this.el.querySelector(\".model\");\n    if (this.data.avatarSrc && modelEl) {\n      modelEl.setAttribute(\"gltf-model-plus\", \"src\", this.data.avatarSrc);\n      this.el.sceneEl.systems[\"camera-tools\"].avatarUpdated();\n    }\n\n    const uniforms = injectCustomShaderChunks(this.el.object3D);\n    this.el.querySelectorAll(\"[hover-visuals]\").forEach(el => {\n      el.components[\"hover-visuals\"].uniforms = uniforms;\n    });\n  }\n});\n","import { findAncestorWithComponent } from \"../utils/scene-graph\";\n\nconst POSES = {\n  open: \"allOpen\",\n  thumbDown: \"thumbDown\",\n  indexDown: \"indexDown\",\n  mrpDown: \"mrpDown\",\n  thumbUp: \"thumbsUp\",\n  point: \"point\",\n  fist: \"allGrip\",\n  pinch: \"pinch\"\n};\n\nconst NETWORK_POSES = [\"allOpen\", \"thumbDown\", \"indexDown\", \"mrpDown\", \"thumbsUp\", \"point\", \"allGrip\", \"pinch\"];\n\n/**\n * Animates between poses based on networked pose state using an animation mixer.\n * @namespace avatar\n * @component hand-pose\n */\nAFRAME.registerComponent(\"hand-pose\", {\n  multiple: true,\n\n  init() {\n    this.pose = 0;\n    this.animatePose = this.animatePose.bind(this);\n    const mixerEl = findAncestorWithComponent(this.el, \"animation-mixer\");\n    const suffix = this.id == \"left\" ? \"_L\" : \"_R\";\n    this.mixer = mixerEl && mixerEl.components[\"animation-mixer\"].mixer;\n    if (!this.mixer || !this.mixer.clipAction(POSES.open + suffix)) {\n      console.warn(\"Avatar does not an 'allOpen' animation, disabling hand animations\");\n      this.el.removeAttribute(\"hand-pose\");\n      return;\n    }\n    this.from = this.to = this.mixer.clipAction(POSES.open + suffix);\n    this.from.play();\n\n    const getNetworkedAvatar = el => {\n      if (!el) {\n        window.setTimeout(() => {\n          getNetworkedAvatar(this.el);\n        }, 1000);\n        return;\n      }\n      const networkedAvatar = el.components && el.components[\"networked-avatar\"];\n      if (networkedAvatar) {\n        return networkedAvatar;\n      }\n      return getNetworkedAvatar(el.parentEl);\n    };\n    this.networkedAvatar = getNetworkedAvatar(this.el);\n  },\n\n  tick() {\n    if (\n      !this.networkedAvatar ||\n      !this.networkedAvatar.data ||\n      this.networkedAvatar.data[`${this.id}_hand_pose`] === this.pose\n    ) {\n      return;\n    }\n\n    this.animatePose(NETWORK_POSES[this.pose], NETWORK_POSES[this.networkedAvatar.data[`${this.id}_hand_pose`]]);\n    this.pose = this.networkedAvatar.data[`${this.id}_hand_pose`];\n  },\n\n  animatePose(prev, curr) {\n    this.from.stop();\n    this.to.stop();\n\n    const duration = 0.065;\n    const suffix = this.id == \"left\" ? \"_L\" : \"_R\";\n    this.from = this.mixer.clipAction(prev + suffix);\n    this.to = this.mixer.clipAction(curr + suffix);\n\n    this.from.fadeOut(duration);\n    this.to.fadeIn(duration);\n    this.to.play();\n    this.from.play();\n\n    this.mixer.update(0.001);\n  }\n});\n\n/**\n * Sets the networked hand pose state based on hand-pose events.\n * @namespace avatar\n * @component hand-pose-controller\n */\nAFRAME.registerComponent(\"hand-pose-controller\", {\n  multiple: true,\n  schema: {\n    eventSrc: { type: \"selector\" },\n    networkedAvatar: { type: \"selector\" }\n  },\n  init: function() {\n    this.setHandPose = this.setHandPose.bind(this);\n  },\n\n  play: function() {\n    this.data.eventSrc.addEventListener(\"hand-pose\", this.setHandPose);\n  },\n\n  pause: function() {\n    this.data.eventSrc.removeEventListener(\"hand-pose\", this.setHandPose);\n  },\n\n  setHandPose: function(evt) {\n    this.data.networkedAvatar.setAttribute(\n      \"networked-avatar\",\n      `${this.id}_hand_pose`,\n      NETWORK_POSES.indexOf(POSES[evt.detail.current])\n    );\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\nimport { SOUND_FREEZE, SOUND_THAW } from \"../systems/sound-effects-system\";\n\n/**\n * Toggles freezing of network traffic on the given event.\n * @namespace network\n * @component freeze-controller\n */\nAFRAME.registerComponent(\"freeze-controller\", {\n  schema: {\n    toggleEvent: { type: \"string\" }\n  },\n\n  init: function() {\n    this.onToggle = this.onToggle.bind(this);\n  },\n\n  play: function() {\n    this.el.addEventListener(this.data.toggleEvent, this.onToggle);\n  },\n\n  pause: function() {\n    this.el.removeEventListener(this.data.toggleEvent, this.onToggle);\n  },\n\n  tick: function() {\n    const scene = this.el.sceneEl;\n    if (!scene.is(\"entered\")) return;\n\n    const userinput = scene.systems.userinput;\n    const ensureFrozen = userinput.get(paths.actions.ensureFrozen);\n    const thaw = userinput.get(paths.actions.thaw);\n    const toggleFreeze = userinput.get(paths.actions.toggleFreeze);\n\n    const toggleFreezeDueToInput =\n      (this.el.is(\"frozen\") && thaw) || (!this.el.is(\"frozen\") && ensureFrozen) || toggleFreeze;\n\n    if (toggleFreezeDueToInput) {\n      this.onToggle();\n    }\n  },\n\n  onToggle: function() {\n    window.APP.store.update({ activity: { hasFoundFreeze: true } });\n    if (!NAF.connection.adapter) return;\n    NAF.connection.adapter.toggleFreeze();\n    if (NAF.connection.adapter.frozen) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_FREEZE);\n      this.el.addState(\"frozen\");\n    } else {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_THAW);\n      this.el.removeState(\"frozen\");\n    }\n  }\n});\n","import { getLastWorldPosition } from \"../utils/three-utils\";\n\nconst isMobile = AFRAME.utils.device.isMobile();\n\n/**\n * Toggles the visibility of this entity when the scene is frozen.\n * @namespace ui\n * @component visibility-while-frozen\n */\nAFRAME.registerComponent(\"visibility-while-frozen\", {\n  schema: {\n    withinDistance: { type: \"number\" },\n    visible: { type: \"boolean\", default: true },\n    requireHoverOnNonMobile: { type: \"boolean\", default: true }\n  },\n\n  init() {\n    this.updateVisibility = this.updateVisibility.bind(this);\n    this.camWorldPos = new THREE.Vector3();\n    this.objWorldPos = new THREE.Vector3();\n    this.cam = this.el.sceneEl.camera.el.object3D;\n\n    let hoverableSearch = this.el;\n\n    while (hoverableSearch !== document) {\n      if (hoverableSearch.getAttribute(\"is-remote-hover-target\") !== null) {\n        this.hoverable = hoverableSearch;\n        break;\n      }\n\n      hoverableSearch = hoverableSearch.parentNode;\n    }\n    if (!this.hoverable && this.data.requireHoverOnNonMobile) {\n      console.error(\"Didn't find a remote hover target.\");\n    }\n\n    this.onStateChange = evt => {\n      if (!evt.detail === \"frozen\") return;\n      this.updateVisibility();\n    };\n    this.updateVisibility();\n  },\n\n  tick() {\n    const isFrozen = this.el.sceneEl.is(\"frozen\");\n    const isVisible = this.el.object3D.visible;\n    const shouldNotBeVisible = isFrozen === !this.data.visible;\n    if (!isVisible && shouldNotBeVisible) return;\n\n    this.updateVisibility();\n  },\n\n  updateVisibility() {\n    const isFrozen = this.el.sceneEl.is(\"frozen\");\n\n    let isWithinDistance = true;\n    const isVisible = this.el.object3D.visible;\n\n    if (this.data.withinDistance) {\n      if (!isVisible) {\n        // Edge case, if the object is not visible force a matrix update\n        // since the main matrix update loop will not do it.\n        this.el.object3D.updateMatrices(true, true);\n      }\n\n      getLastWorldPosition(this.cam, this.camWorldPos);\n      this.objWorldPos.copy(this.el.object3D.position);\n      this.el.object3D.localToWorld(this.objWorldPos);\n\n      isWithinDistance =\n        this.camWorldPos.distanceToSquared(this.objWorldPos) < this.data.withinDistance * this.data.withinDistance;\n    }\n\n    const isTransforming = AFRAME.scenes[0].systems[\"transform-selected-object\"].transforming;\n\n    let shouldBeVisible =\n      ((isFrozen && this.data.visible) || (!isFrozen && !this.data.visible)) && isWithinDistance && !isTransforming;\n\n    if (this.data.requireHoverOnNonMobile && !isMobile) {\n      shouldBeVisible =\n        shouldBeVisible &&\n        ((this.hoverable && AFRAME.scenes[0].systems.interaction.state.rightRemote.hovered === this.hoverable) ||\n          isVisible);\n    }\n\n    if (isVisible !== shouldBeVisible) {\n      this.el.setAttribute(\"visible\", shouldBeVisible);\n    }\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateChange);\n\n    if (this.hoverable) {\n      this.hoverable.object3D.addEventListener(\"hovered\", this.updateVisibility);\n      this.hoverable.object3D.addEventListener(\"unhovered\", this.updateVisibility);\n    }\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateChange);\n\n    if (this.hoverable) {\n      this.hoverable.object3D.addEventListener(\"hovered\", this.updateVisibility);\n      this.hoverable.object3D.addEventListener(\"unhovered\", this.updateVisibility);\n    }\n  }\n});\n\n/**\n * Toggles the interactivity of a UI entity while the scene is frozen.\n * @namespace ui\n * @component ui-class-while-frozen\n */\nAFRAME.registerComponent(\"ui-class-while-frozen\", {\n  init() {\n    this.onStateChange = evt => {\n      if (!evt.detail === \"frozen\") return;\n      this.el.classList.toggle(\"ui\", this.el.sceneEl.is(\"frozen\"));\n    };\n    this.el.classList.toggle(\"ui\", this.el.sceneEl.is(\"frozen\"));\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateChange);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateChange);\n  }\n});\n","import \"./stats-plus.css\";\n// Adapted from https://github.com/aframevr/aframe/blob/master/src/components/scene/stats.js\n\nfunction createStats(scene) {\n  const threeStats = new window.threeStats(scene.renderer);\n  const aframeStats = new window.aframeStats(scene);\n  const plugins = scene.isMobile ? [] : [threeStats, aframeStats];\n  return new window.rStats({\n    css: [], // Our stylesheet is injected from AFrame.\n    values: {\n      fps: { caption: \"fps\", below: 30 }\n    },\n    groups: [{ caption: \"Framerate\", values: [\"fps\", \"raf\"] }],\n    plugins: plugins\n  });\n}\n\nconst HIDDEN_CLASS = \"a-hidden\";\n\nAFRAME.registerComponent(\"stats-plus\", {\n  // Whether or not the stats panel is expanded.\n  // Shows FPS counter when collapsed.\n  schema: { default: false },\n  init() {\n    this.onExpand = this.onExpand.bind(this);\n    this.onCollapse = this.onCollapse.bind(this);\n    this.onEnterVr = this.onEnterVr.bind(this);\n    this.onExitVr = this.onExitVr.bind(this);\n\n    const scene = this.el.sceneEl;\n    this.stats = createStats(scene);\n    this.statsEl = document.querySelector(\".rs-base\");\n\n    // Add header to stats panel so we can collapse it\n    const statsHeaderEl = document.createElement(\"div\");\n    statsHeaderEl.classList.add(\"rs-header\");\n\n    const statsTitleEl = document.createElement(\"h1\");\n    statsTitleEl.innerHTML = \"Stats\";\n    statsHeaderEl.appendChild(statsTitleEl);\n\n    const collapseEl = document.createElement(\"div\");\n    collapseEl.classList.add(\"rs-collapse-btn\");\n    collapseEl.innerHTML = \"X\";\n    collapseEl.addEventListener(\"click\", this.onCollapse);\n    statsHeaderEl.appendChild(collapseEl);\n\n    this.statsEl.insertBefore(statsHeaderEl, this.statsEl.firstChild);\n\n    // Add fps counter to the page\n    this.fpsEl = document.createElement(\"div\");\n    this.fpsEl.addEventListener(\"click\", this.onExpand);\n    this.fpsEl.classList.add(\"rs-fps-counter\");\n    document.body.appendChild(this.fpsEl);\n    this.lastFpsUpdate = performance.now();\n    this.lastFps = 0;\n    this.frameCount = 0;\n    this.inVR = scene.is(\"vr-mode\");\n\n    if (scene.isMobile) {\n      this.statsEl.classList.add(\"rs-mobile\");\n      this.fpsEl.classList.add(\"rs-mobile\");\n    }\n\n    scene.addEventListener(\"enter-vr\", this.onEnterVr);\n    scene.addEventListener(\"exit-vr\", this.onExitVr);\n  },\n  update(oldData) {\n    if (oldData !== this.data) {\n      if (this.data) {\n        this.statsEl.classList.remove(HIDDEN_CLASS);\n        this.fpsEl.classList.add(HIDDEN_CLASS);\n      } else {\n        this.statsEl.classList.add(HIDDEN_CLASS);\n        this.fpsEl.classList.remove(HIDDEN_CLASS);\n      }\n    }\n  },\n  tick() {\n    if (this.data) {\n      // Update rStats\n      const stats = this.stats;\n      stats(\"rAF\").tick();\n      stats(\"FPS\").frame();\n      stats().update();\n    } else if (!this.inVR) {\n      // Update the fps counter\n      const now = performance.now();\n      this.frameCount++;\n\n      // Update the fps counter text once a second\n      if (now >= this.lastFpsUpdate + 1000) {\n        const fps = Math.round(this.frameCount / ((now - this.lastFpsUpdate) / 1000));\n        if (fps !== this.lastFps) {\n          this.fpsEl.innerHTML = Math.round(fps) + \" FPS\";\n          this.lastFps = fps;\n        }\n        this.lastFpsUpdate = now;\n        this.frameCount = 0;\n      }\n    }\n  },\n  onEnterVr() {\n    this.inVR = true;\n    // Hide all stats elements when entering VR on mobile\n    if (this.el.sceneEl.isMobile) {\n      this.statsEl.classList.add(HIDDEN_CLASS);\n      this.fpsEl.classList.add(HIDDEN_CLASS);\n    }\n  },\n  onExitVr() {\n    this.inVR = false;\n    // Revert to previous state whe exiting VR on mobile\n    if (this.el.sceneEl.isMobile) {\n      if (this.data) {\n        this.statsEl.classList.remove(HIDDEN_CLASS);\n      } else {\n        this.fpsEl.classList.remove(HIDDEN_CLASS);\n      }\n    }\n  },\n  onExpand() {\n    this.el.setAttribute(this.name, true);\n  },\n  onCollapse() {\n    this.el.setAttribute(this.name, false);\n  },\n  remove() {\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.hide);\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.show);\n\n    if (this.statsEl) {\n      this.statsEl.parentNode.removeChild(this.statsEl);\n      this.fpsEl.parentNode.removeChild(this.fpsEl);\n    }\n  }\n});\n","/* global performance THREE AFRAME NAF MediaStream process setTimeout */\nimport GIFWorker from \"../workers/gifparsing.worker.js\";\nimport errorImageSrc from \"!!url-loader!../assets/images/media-error.gif\";\nimport { paths } from \"../systems/userinput/paths\";\nimport HLS from \"hls.js/dist/hls.light.js\";\nimport { proxiedUrlFor, spawnMediaAround } from \"../utils/media-utils\";\nimport { buildAbsoluteURL } from \"url-toolkit\";\nimport { SOUND_CAMERA_TOOL_TOOK_SNAPSHOT } from \"../systems/sound-effects-system\";\nimport { promisifyWorker } from \"../utils/promisify-worker.js\";\n\nconst ONCE_TRUE = { once: true };\nconst TYPE_IMG_PNG = { type: \"image/png\" };\nconst parseGIF = promisifyWorker(new GIFWorker());\n\nexport const VOLUME_LABELS = [];\nfor (let i = 0; i <= 20; i++) {\n  let s = \"|\";\n  for (let j = 0; j <= 20; j++) {\n    s += i >= j ? \"|\" : \" \";\n  }\n  s += \"|\";\n  VOLUME_LABELS[i] = s;\n}\n\nclass GIFTexture extends THREE.Texture {\n  constructor(frames, delays, disposals) {\n    super(document.createElement(\"canvas\"));\n    this.image.width = frames[0].width;\n    this.image.height = frames[0].height;\n\n    this._ctx = this.image.getContext(\"2d\");\n\n    this.generateMipmaps = false;\n    this.isVideoTexture = true;\n    this.minFilter = THREE.NearestFilter;\n\n    this.frames = frames;\n    this.delays = delays;\n    this.disposals = disposals;\n\n    this.frame = 0;\n    this.frameStartTime = Date.now();\n  }\n\n  update() {\n    if (!this.frames || !this.delays || !this.disposals) return;\n    const now = Date.now();\n    if (now - this.frameStartTime > this.delays[this.frame]) {\n      if (this.disposals[this.frame] === 2) {\n        this._ctx.clearRect(0, 0, this.image.width, this.image.width);\n      }\n      this.frame = (this.frame + 1) % this.frames.length;\n      this.frameStartTime = now;\n      this._ctx.drawImage(this.frames[this.frame], 0, 0, this.image.width, this.image.height);\n      this.needsUpdate = true;\n    }\n  }\n}\n\nasync function createGIFTexture(url) {\n  return new Promise((resolve, reject) => {\n    fetch(url, { mode: \"cors\" })\n      .then(r => r.arrayBuffer())\n      .then(rawImageData => parseGIF(rawImageData, [rawImageData]))\n      .then(result => {\n        const { frames, delayTimes, disposals } = result;\n        let loadCnt = 0;\n        for (let i = 0; i < frames.length; i++) {\n          const img = new Image();\n          img.onload = e => {\n            loadCnt++;\n            frames[i] = e.target;\n            if (loadCnt === frames.length) {\n              const texture = new GIFTexture(frames, delayTimes, disposals);\n              texture.image.src = url;\n              texture.encoding = THREE.sRGBEncoding;\n              texture.minFilter = THREE.LinearFilter;\n              resolve(texture);\n            }\n          };\n          img.src = frames[i];\n        }\n      })\n      .catch(reject);\n  });\n}\n\nconst isIOS = AFRAME.utils.device.isIOS();\n\n/**\n * Create video element to be used as a texture.\n *\n * @param {string} src - Url to a video file.\n * @returns {Element} Video element.\n */\nasync function createVideoEl() {\n  const videoEl = document.createElement(\"video\");\n  videoEl.setAttribute(\"playsinline\", \"\");\n  videoEl.setAttribute(\"webkit-playsinline\", \"\");\n  // iOS Safari requires the autoplay attribute, or it won't play the video at all.\n  videoEl.autoplay = true;\n  // iOS Safari will not play videos without user interaction. We mute the video so that it can autoplay and then\n  // allow the user to unmute it with an interaction in the unmute-video-button component.\n  videoEl.muted = isIOS;\n  videoEl.preload = \"auto\";\n  videoEl.crossOrigin = \"anonymous\";\n\n  return videoEl;\n}\n\nfunction createVideoTexture(url, contentType) {\n  return new Promise(async (resolve, reject) => {\n    const videoEl = await createVideoEl();\n\n    const texture = new THREE.VideoTexture(videoEl);\n    texture.minFilter = THREE.LinearFilter;\n    texture.encoding = THREE.sRGBEncoding;\n\n    if (url.startsWith(\"hubs://\")) {\n      const streamClientId = url.substring(7).split(\"/\")[1]; // /clients/<client id>/video is only URL for now\n      const stream = await NAF.connection.adapter.getMediaStream(streamClientId, \"video\");\n      videoEl.srcObject = new MediaStream(stream.getVideoTracks());\n      // If hls.js is supported we always use it as it gives us better events\n    } else if (AFRAME.utils.material.isHLS(url, contentType)) {\n      if (HLS.isSupported()) {\n        const corsProxyPrefix = `https://${process.env.CORS_PROXY_SERVER}/`;\n        const baseUrl = url.startsWith(corsProxyPrefix) ? url.substring(corsProxyPrefix.length) : url;\n        const hls = new HLS({\n          xhrSetup: (xhr, u) => {\n            if (u.startsWith(corsProxyPrefix)) {\n              u = u.substring(corsProxyPrefix.length);\n            }\n\n            // HACK HLS.js resolves relative urls internally, but our CORS proxying screws it up. Resolve relative to the original unproxied url.\n            // TODO extend HLS.js to allow overriding of its internal resolving instead\n            if (!u.startsWith(\"http\")) {\n              u = buildAbsoluteURL(baseUrl, u.startsWith(\"/\") ? u : `/${u}`);\n            }\n\n            xhr.open(\"GET\", proxiedUrlFor(u));\n          }\n        });\n        texture.hls = hls;\n        hls.loadSource(url);\n        hls.attachMedia(videoEl);\n        hls.on(HLS.Events.ERROR, function(event, data) {\n          if (data.fatal) {\n            switch (data.type) {\n              case HLS.ErrorTypes.NETWORK_ERROR:\n                // try to recover network error\n                hls.startLoad();\n                break;\n              case HLS.ErrorTypes.MEDIA_ERROR:\n                hls.recoverMediaError();\n                break;\n              default:\n                reject(event);\n                return;\n            }\n          }\n        });\n        // If not, see if native support will work\n      } else if (videoEl.canPlayType(contentType)) {\n        videoEl.src = url;\n        videoEl.onerror = reject;\n      } else {\n        reject(\"HLS unsupported\");\n      }\n    } else {\n      videoEl.src = url;\n      videoEl.onerror = reject;\n    }\n\n    let hasResolved = false;\n\n    const resolveOnce = () => {\n      if (hasResolved) return;\n      hasResolved = true;\n      resolve(texture);\n    };\n\n    videoEl.addEventListener(\"canplay\", resolveOnce, { once: true });\n\n    // HACK: Sometimes iOS fails to fire the canplay event, so we poll for the video dimensions to appear instead.\n    if (isIOS) {\n      const poll = () => {\n        if ((texture.image.videoHeight || texture.image.height) && (texture.image.videoWidth || texture.image.width)) {\n          resolveOnce();\n        } else {\n          setTimeout(poll, 500);\n        }\n      };\n\n      poll();\n    }\n  });\n}\n\nfunction scaleToAspectRatio(el, ratio) {\n  const width = Math.min(1.0, 1.0 / ratio);\n  const height = Math.min(1.0, ratio);\n  el.object3DMap.mesh.scale.set(width, height, 1);\n  el.object3DMap.mesh.matrixNeedsUpdate = true;\n}\n\nconst textureLoader = new THREE.TextureLoader();\ntextureLoader.setCrossOrigin(\"anonymous\");\nfunction createImageTexture(url) {\n  return new Promise((resolve, reject) => {\n    textureLoader.load(\n      url,\n      texture => {\n        texture.encoding = THREE.sRGBEncoding;\n        texture.minFilter = THREE.LinearFilter;\n        resolve(texture);\n      },\n      null,\n      function(xhr) {\n        reject(`'${url}' could not be fetched (Error code: ${xhr.status}; Response: ${xhr.statusText})`);\n      }\n    );\n  });\n}\n\nfunction disposeTexture(texture) {\n  if (texture.image instanceof HTMLVideoElement) {\n    const video = texture.image;\n    video.pause();\n    video.src = \"\";\n    video.load();\n  }\n\n  if (texture.hls) {\n    texture.hls.destroy();\n  }\n\n  texture.dispose();\n}\n\nclass TextureCache {\n  cache = new Map();\n\n  set(src, texture) {\n    const image = texture.image;\n    this.cache.set(src, {\n      texture,\n      ratio: (image.videoHeight || image.height) / (image.videoWidth || image.width),\n      count: 0\n    });\n    return this.retain(src);\n  }\n\n  has(src) {\n    return this.cache.has(src);\n  }\n\n  get(src) {\n    return this.cache.get(src);\n  }\n\n  retain(src) {\n    const cacheItem = this.cache.get(src);\n    cacheItem.count++;\n    // console.log(\"retain\", src, cacheItem.count);\n    return cacheItem;\n  }\n\n  release(src) {\n    const cacheItem = this.cache.get(src);\n    cacheItem.count--;\n    // console.log(\"release\", src, cacheItem.count);\n    if (cacheItem.count <= 0) {\n      // Unload the video element to prevent it from continuing to play in the background\n      disposeTexture(cacheItem.texture);\n      this.cache.delete(src);\n    }\n  }\n}\n\nconst textureCache = new TextureCache();\n\nconst errorImage = new Image();\nerrorImage.src = errorImageSrc;\nconst errorTexture = new THREE.Texture(errorImage);\nerrorTexture.magFilter = THREE.NearestFilter;\nerrorImage.onload = () => {\n  errorTexture.needsUpdate = true;\n};\n\nfunction timeFmt(t) {\n  let s = Math.floor(t),\n    h = Math.floor(s / 3600);\n  s -= h * 3600;\n  let m = Math.floor(s / 60);\n  s -= m * 60;\n  if (h < 10) h = `0${h}`;\n  if (m < 10) m = `0${m}`;\n  if (s < 10) s = `0${s}`;\n  return h === \"00\" ? `${m}:${s}` : `${h}:${m}:${s}`;\n}\n\nAFRAME.registerComponent(\"media-video\", {\n  schema: {\n    src: { type: \"string\" },\n    contentType: { type: \"string\" },\n    volume: { type: \"number\", default: 0.5 },\n    loop: { type: \"boolean\", default: true },\n    audioType: { type: \"string\", default: \"pannernode\" },\n    hidePlaybackControls: { type: \"boolean\", default: false },\n    distanceModel: { type: \"string\", default: \"inverse\" },\n    rolloffFactor: { type: \"number\", default: 1 },\n    refDistance: { type: \"number\", default: 1 },\n    maxDistance: { type: \"number\", default: 10000 },\n    coneInnerAngle: { type: \"number\", default: 360 },\n    coneOuterAngle: { type: \"number\", default: 0 },\n    coneOuterGain: { type: \"number\", default: 0 },\n    videoPaused: { type: \"boolean\" },\n    projection: { type: \"string\", default: \"flat\" },\n    time: { type: \"number\" },\n    tickRate: { default: 1000 }, // ms interval to send time interval updates\n    syncTolerance: { default: 2 }\n  },\n\n  init() {\n    this.onPauseStateChange = this.onPauseStateChange.bind(this);\n    this.tryUpdateVideoPlaybackState = this.tryUpdateVideoPlaybackState.bind(this);\n    this.updateSrc = this.updateSrc.bind(this);\n\n    this.seekForward = this.seekForward.bind(this);\n    this.seekBack = this.seekBack.bind(this);\n    this.volumeUp = this.volumeUp.bind(this);\n    this.volumeDown = this.volumeDown.bind(this);\n    this.snap = this.snap.bind(this);\n    this.changeVolumeBy = this.changeVolumeBy.bind(this);\n    this.togglePlaying = this.togglePlaying.bind(this);\n\n    this.lastUpdate = 0;\n    this.videoMutedAt = 0;\n    this.localSnapCount = 0;\n    this.isSnapping = false;\n    this.onSnapImageLoaded = () => (this.isSnapping = false);\n\n    this.el.setAttribute(\"hover-menu__video\", { template: \"#video-hover-menu\", dirs: [\"forward\", \"back\"] });\n    this.el.components[\"hover-menu__video\"].getHoverMenu().then(menu => {\n      // If we got removed while waiting, do nothing.\n      if (!this.el.parentNode) return;\n\n      this.hoverMenu = menu;\n\n      this.playbackControls = this.el.querySelector(\".video-playback\");\n      this.playPauseButton = this.el.querySelector(\".video-playpause-button\");\n      this.volumeUpButton = this.el.querySelector(\".video-volume-up-button\");\n      this.volumeDownButton = this.el.querySelector(\".video-volume-down-button\");\n      this.seekForwardButton = this.el.querySelector(\".video-seek-forward-button\");\n      this.seekBackButton = this.el.querySelector(\".video-seek-back-button\");\n      this.snapButton = this.el.querySelector(\".video-snap-button\");\n      this.timeLabel = this.el.querySelector(\".video-time-label\");\n      this.volumeLabel = this.el.querySelector(\".video-volume-label\");\n\n      this.playPauseButton.object3D.addEventListener(\"interact\", this.togglePlaying);\n      this.seekForwardButton.object3D.addEventListener(\"interact\", this.seekForward);\n      this.seekBackButton.object3D.addEventListener(\"interact\", this.seekBack);\n      this.volumeUpButton.object3D.addEventListener(\"interact\", this.volumeUp);\n      this.volumeDownButton.object3D.addEventListener(\"interact\", this.volumeDown);\n      this.snapButton.object3D.addEventListener(\"interact\", this.snap);\n\n      this.updateVolumeLabel();\n      this.updateHoverMenuBasedOnLiveState();\n      this.updatePlaybackState();\n    });\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.networkedEl = networkedEl;\n      this.updatePlaybackState();\n\n      // For scene-owned videos, take ownership after a random delay if nobody\n      // else has so there is a timekeeper. Do not due this on iOS because iOS has an\n      // annoying \"auto-pause\" feature that forces one non-autoplaying video to play\n      // at once, which will pause the videos for everyone in the room if owned.\n      if (!isIOS && NAF.utils.getNetworkOwner(this.networkedEl) === \"scene\") {\n        setTimeout(() => {\n          if (NAF.utils.getNetworkOwner(this.networkedEl) === \"scene\") {\n            NAF.utils.takeOwnership(this.networkedEl);\n          }\n        }, 2000 + Math.floor(Math.random() * 2000));\n      }\n    });\n\n    // from a-sound\n    const sceneEl = this.el.sceneEl;\n    sceneEl.audioListener = sceneEl.audioListener || new THREE.AudioListener();\n    if (sceneEl.camera) {\n      sceneEl.camera.add(sceneEl.audioListener);\n    }\n    sceneEl.addEventListener(\"camera-set-active\", function(evt) {\n      evt.detail.cameraEl.getObject3D(\"camera\").add(sceneEl.audioListener);\n    });\n  },\n\n  seekForward() {\n    if ((!this.videoIsLive && NAF.utils.isMine(this.networkedEl)) || NAF.utils.takeOwnership(this.networkedEl)) {\n      this.video.currentTime += 30;\n      this.el.setAttribute(\"media-video\", \"time\", this.video.currentTime);\n    }\n  },\n\n  seekBack() {\n    if ((!this.videoIsLive && NAF.utils.isMine(this.networkedEl)) || NAF.utils.takeOwnership(this.networkedEl)) {\n      this.video.currentTime -= 10;\n      this.el.setAttribute(\"media-video\", \"time\", this.video.currentTime);\n    }\n  },\n\n  changeVolumeBy(v) {\n    this.el.setAttribute(\"media-video\", \"volume\", THREE.Math.clamp(this.data.volume + v, 0, 1));\n    this.updateVolumeLabel();\n  },\n\n  volumeUp() {\n    this.changeVolumeBy(0.1);\n  },\n\n  volumeDown() {\n    this.changeVolumeBy(-0.1);\n  },\n\n  async snap() {\n    if (this.isSnapping) return;\n    this.isSnapping = true;\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_TOOK_SNAPSHOT);\n\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = this.video.videoWidth;\n    canvas.height = this.video.videoHeight;\n    canvas.getContext(\"2d\").drawImage(this.video, 0, 0, canvas.width, canvas.height);\n    const blob = await new Promise(resolve => canvas.toBlob(resolve));\n    const file = new File([blob], \"snap.png\", TYPE_IMG_PNG);\n\n    this.localSnapCount++;\n    const { entity } = spawnMediaAround(this.el, file, this.localSnapCount);\n    entity.addEventListener(\"image-loaded\", this.onSnapImageLoaded, ONCE_TRUE);\n  },\n\n  togglePlaying() {\n    // See onPauseStateChanged for note about iOS\n    if (isIOS && this.video.paused && NAF.utils.isMine(this.networkedEl)) {\n      this.video.play();\n      return;\n    }\n\n    if (this.networkedEl && (NAF.utils.isMine(this.networkedEl) || NAF.utils.takeOwnership(this.networkedEl))) {\n      this.tryUpdateVideoPlaybackState(!this.data.videoPaused);\n    }\n  },\n\n  onPauseStateChange() {\n    // iOS Safari will auto-pause other videos if one is manually started (not autoplayed.) So, to keep things\n    // easy to reason about, we *never* broadcast pauses from iOS.\n    //\n    // if an iOS safari user pauses and plays a video they'll pause all the other videos,\n    // which isn't great, but this check will at least ensure they don't pause those videos\n    // for all other users in the room! Of course, if they go and hit play on those videos auto-paused,\n    // they will become the timekeeper, and will seek everyone to where the video was auto-paused.\n    //\n    // This specific case will diverge the network schema and the video player state, so that\n    // this.data.videoPaused is false (so others will keep playing it) but our local player will\n    // have stopped. So we deal with this special case as well when we press the play button.\n    if (isIOS && this.video.paused && NAF.utils.isMine(this.networkedEl)) {\n      return;\n    }\n\n    this.el.setAttribute(\"media-video\", \"videoPaused\", this.video.paused);\n\n    if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n      this.el.emit(\"owned-video-state-changed\");\n    }\n  },\n\n  updatePlaybackState(force) {\n    if (this.hoverMenu) {\n      this.playbackControls.object3D.visible = !this.data.hidePlaybackControls && !!this.video;\n      this.timeLabel.object3D.visible = !this.data.hidePlaybackControls;\n\n      this.playPauseButton.object3D.visible = !!this.video;\n      this.snapButton.object3D.visible = !!this.video;\n      this.seekForwardButton.object3D.visible = !!this.video && !this.videoIsLive;\n      this.seekBackButton.object3D.visible = !!this.video && !this.videoIsLive;\n    }\n\n    // Only update playback position for videos you don't own\n    if (force || (this.networkedEl && !NAF.utils.isMine(this.networkedEl) && this.video)) {\n      if (Math.abs(this.data.time - this.video.currentTime) > this.data.syncTolerance) {\n        this.tryUpdateVideoPlaybackState(this.data.videoPaused, this.data.time);\n      } else {\n        this.tryUpdateVideoPlaybackState(this.data.videoPaused);\n      }\n    }\n\n    // Volume is local, always update it\n    if (this.audio) {\n      this.audio.gain.gain.value = this.data.volume;\n    }\n  },\n\n  tryUpdateVideoPlaybackState(pause, currentTime) {\n    if (this._playbackStateChangeTimeout) {\n      clearTimeout(this._playbackStateChangeTimeout);\n      delete this._playbackStateChangeTimeout;\n    }\n\n    if (!this.videoIsLive && currentTime !== undefined) {\n      this.video.currentTime = currentTime;\n    }\n\n    if (this.hoverMenu) {\n      this.playPauseButton.setAttribute(\"icon-button\", \"active\", pause);\n    }\n\n    if (pause) {\n      this.video.pause();\n    } else {\n      // Need to deal with the fact play() may fail if user has not interacted with browser yet.\n      this.video.play().catch(() => {\n        this._playbackStateChangeTimeout = setTimeout(() => this.tryUpdateVideoPlaybackState(pause, currentTime), 1000);\n      });\n    }\n  },\n\n  async update(oldData) {\n    const src = this.data.src;\n    this.updatePlaybackState();\n\n    if (!src || src === oldData.src) return;\n    return this.updateSrc(oldData);\n  },\n\n  async updateSrc(oldData) {\n    const { src } = this.data;\n\n    this.cleanUp();\n    if (this.mesh && this.mesh.material) {\n      this.mesh.material.map = null;\n      this.mesh.material.needsUpdate = true;\n    }\n\n    let texture;\n    try {\n      texture = await createVideoTexture(src, this.data.contentType);\n\n      // No way to cancel promises, so if src has changed while we were creating the texture just throw it away.\n      if (this.data.src !== src) {\n        disposeTexture(texture);\n        return;\n      }\n\n      if (!src.startsWith(\"hubs://\")) {\n        // TODO FF error here if binding mediastream: The captured HTMLMediaElement is playing a MediaStream. Applying volume or mute status is not currently supported -- not an issue since we have no audio atm in shared video.\n        texture.audioSource = this.el.sceneEl.audioListener.context.createMediaElementSource(texture.image);\n\n        if (this.data.audioType === \"pannernode\") {\n          this.audio = new THREE.PositionalAudio(this.el.sceneEl.audioListener);\n          this.audio.setDistanceModel(this.data.distanceModel);\n          this.audio.setRolloffFactor(this.data.rolloffFactor);\n          this.audio.setRefDistance(this.data.refDistance);\n          this.audio.setMaxDistance(this.data.maxDistance);\n          this.audio.panner.coneInnerAngle = this.data.coneInnerAngle;\n          this.audio.panner.coneOuterAngle = this.data.coneOuterAngle;\n          this.audio.panner.coneOuterGain = this.data.coneOuterGain;\n        } else {\n          this.audio = new THREE.Audio(this.el.sceneEl.audioListener);\n        }\n\n        this.audio.setNodeSource(texture.audioSource);\n        this.el.setObject3D(\"sound\", this.audio);\n      }\n\n      this.video = texture.image;\n      this.video.loop = this.data.loop;\n      this.video.addEventListener(\"pause\", this.onPauseStateChange);\n      this.video.addEventListener(\"play\", this.onPauseStateChange);\n\n      if (texture.hls) {\n        const updateLiveState = () => {\n          this.videoIsLive = texture.hls.levels[texture.hls.currentLevel].details.live;\n          this.updateHoverMenuBasedOnLiveState();\n        };\n        texture.hls.on(HLS.Events.LEVEL_SWITCHED, updateLiveState);\n        if (texture.hls.currentLevel >= 0) {\n          updateLiveState();\n        }\n      } else {\n        this.videoIsLive = this.video.duration === Infinity;\n        this.updateHoverMenuBasedOnLiveState();\n      }\n\n      if (isIOS) {\n        const template = document.getElementById(\"video-unmute\");\n        this.el.appendChild(document.importNode(template.content, true));\n        this.el.setAttribute(\"position-at-box-shape-border__unmute-ui\", {\n          target: \".unmute-ui\",\n          dirs: [\"forward\", \"back\"]\n        });\n      }\n    } catch (e) {\n      console.error(\"Error loading video\", this.data.src, e);\n      texture = errorTexture;\n    }\n\n    const projection = this.data.projection;\n\n    if (!this.mesh || projection !== oldData.projection) {\n      const material = new THREE.MeshBasicMaterial();\n\n      let geometry;\n\n      if (projection === \"360-equirectangular\") {\n        geometry = new THREE.SphereBufferGeometry(1, 64, 32);\n        // invert the geometry on the x-axis so that all of the faces point inward\n        geometry.scale(-1, 1, 1);\n      } else {\n        geometry = new THREE.PlaneBufferGeometry();\n        material.side = THREE.DoubleSide;\n      }\n\n      this.mesh = new THREE.Mesh(geometry, material);\n      this.el.setObject3D(\"mesh\", this.mesh);\n    }\n\n    this.mesh.material.map = texture;\n    this.mesh.material.needsUpdate = true;\n\n    if (projection === \"flat\") {\n      scaleToAspectRatio(this.el, texture.image.videoHeight / texture.image.videoWidth);\n    }\n\n    this.updatePlaybackState(true);\n\n    if (this.video.muted) {\n      this.videoMutedAt = performance.now();\n    }\n\n    this.el.emit(\"video-loaded\", { projection: projection });\n  },\n\n  updateHoverMenuBasedOnLiveState() {\n    if (!this.hoverMenu) return;\n\n    this.seekForwardButton.object3D.visible = !this.videoIsLive;\n    this.seekBackButton.object3D.visible = !this.videoIsLive;\n\n    if (this.videoIsLive) {\n      this.timeLabel.setAttribute(\"text\", \"value\", \"LIVE\");\n    }\n  },\n\n  updateVolumeLabel() {\n    this.volumeLabel.setAttribute(\n      \"text\",\n      \"value\",\n      this.data.volume === 0 ? \"MUTE\" : VOLUME_LABELS[Math.floor(this.data.volume / 0.05)]\n    );\n  },\n\n  tick() {\n    if (!this.video) return;\n\n    const userinput = this.el.sceneEl.systems.userinput;\n    const interaction = this.el.sceneEl.systems.interaction;\n    const volumeMod = userinput.get(paths.actions.cursor.mediaVolumeMod);\n    if (interaction.state.rightRemote.hovered === this.el && volumeMod) {\n      this.changeVolumeBy(volumeMod);\n    }\n\n    const isHeld = interaction.isHeld(this.el);\n\n    if (this.wasHeld && !isHeld) {\n      this.localSnapCount = 0;\n    }\n\n    this.wasHeld = isHeld;\n\n    if (this.hoverMenu && this.hoverMenu.object3D.visible && !this.videoIsLive) {\n      this.timeLabel.setAttribute(\n        \"text\",\n        \"value\",\n        `${timeFmt(this.video.currentTime)} / ${timeFmt(this.video.duration)}`\n      );\n    }\n\n    // If a non-live video is currently playing and we own it, send out time updates\n    if (!this.data.videoPaused && !this.videoIsLive && this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n      const now = performance.now();\n      if (now - this.lastUpdate > this.data.tickRate) {\n        this.el.setAttribute(\"media-video\", \"time\", this.video.currentTime);\n        this.lastUpdate = now;\n      }\n    }\n  },\n\n  cleanUp() {\n    if (this.mesh && this.mesh.material) {\n      disposeTexture(this.mesh.material.map);\n    }\n  },\n\n  remove() {\n    this.cleanUp();\n\n    if (this.audio) {\n      this.el.removeObject3D(\"sound\");\n      this.audio.disconnect();\n      delete this.audio;\n    }\n\n    if (this.video) {\n      this.video.removeEventListener(\"pause\", this.onPauseStateChange);\n      this.video.removeEventListener(\"play\", this.onPauseStateChange);\n    }\n    if (this.hoverMenu) {\n      this.playPauseButton.object3D.removeEventListener(\"interact\", this.togglePlaying);\n      this.volumeUpButton.object3D.removeEventListener(\"interact\", this.volumeUp);\n      this.volumeDownButton.object3D.removeEventListener(\"interact\", this.volumeDown);\n      this.seekForwardButton.object3D.removeEventListener(\"interact\", this.seekForward);\n      this.seekBackButton.object3D.removeEventListener(\"interact\", this.seekBack);\n    }\n  }\n});\n\nAFRAME.registerComponent(\"media-image\", {\n  schema: {\n    src: { type: \"string\" },\n    projection: { type: \"string\", default: \"flat\" },\n    contentType: { type: \"string\" }\n  },\n\n  remove() {\n    textureCache.release(this.data.src);\n  },\n\n  async update(oldData) {\n    let texture;\n    let ratio = 1;\n    try {\n      const { src, contentType } = this.data;\n      if (!src) return;\n\n      this.el.emit(\"image-loading\");\n\n      if (this.mesh && this.mesh.map && src !== oldData.src) {\n        this.mesh.material.map = null;\n        this.mesh.material.needsUpdate = true;\n        if (this.mesh.map !== errorTexture) {\n          textureCache.release(oldData.src);\n        }\n      }\n\n      if (textureCache.has(src)) {\n        const cacheItem = textureCache.retain(src);\n        texture = cacheItem.texture;\n        ratio = cacheItem.ratio;\n      } else {\n        if (src === \"error\") {\n          texture = errorTexture;\n        } else if (contentType.includes(\"image/gif\")) {\n          texture = await createGIFTexture(src);\n        } else if (contentType.startsWith(\"image/\")) {\n          texture = await createImageTexture(src);\n        } else {\n          throw new Error(`Unknown image content type: ${contentType}`);\n        }\n\n        const cacheItem = textureCache.set(src, texture);\n        ratio = cacheItem.ratio;\n\n        // No way to cancel promises, so if src has changed while we were creating the texture just throw it away.\n        if (this.data.src !== src) {\n          textureCache.release(src);\n          return;\n        }\n      }\n    } catch (e) {\n      console.error(\"Error loading image\", this.data.src, e);\n      texture = errorTexture;\n    }\n\n    const projection = this.data.projection;\n\n    if (!this.mesh || projection !== oldData.projection) {\n      const material = new THREE.MeshBasicMaterial();\n\n      let geometry;\n\n      if (projection === \"360-equirectangular\") {\n        geometry = new THREE.SphereBufferGeometry(1, 64, 32);\n        // invert the geometry on the x-axis so that all of the faces point inward\n        geometry.scale(-1, 1, 1);\n      } else {\n        geometry = new THREE.PlaneBufferGeometry(1, 1, 1, 1, texture.flipY);\n        material.side = THREE.DoubleSide;\n      }\n\n      this.mesh = new THREE.Mesh(geometry, material);\n      this.el.setObject3D(\"mesh\", this.mesh);\n    }\n\n    this.mesh.material.map = texture;\n    this.mesh.material.transparent = texture.format === THREE.RGBAFormat;\n    this.mesh.material.needsUpdate = true;\n\n    if (projection === \"flat\") {\n      scaleToAspectRatio(this.el, ratio);\n    }\n\n    this.el.emit(\"image-loaded\", { src: this.data.src, projection: projection });\n  }\n});\n","import { VOLUME_LABELS } from \"./media-views\";\n\nAFRAME.registerComponent(\"avatar-volume-controls\", {\n  schema: {\n    volume: { type: \"number\", default: 1.0 }\n  },\n\n  init() {\n    this.volumeUp = this.volumeUp.bind(this);\n    this.volumeDown = this.volumeDown.bind(this);\n    this.changeVolumeBy = this.changeVolumeBy.bind(this);\n    this.volumeUpButton = this.el.querySelector(\".avatar-volume-up-button\");\n    this.volumeDownButton = this.el.querySelector(\".avatar-volume-down-button\");\n    this.volumeLabel = this.el.querySelector(\".avatar-volume-label\");\n    this.volumeUpButton.object3D.addEventListener(\"interact\", this.volumeUp);\n    this.volumeDownButton.object3D.addEventListener(\"interact\", this.volumeDown);\n\n    this.updateVolumeLabel();\n  },\n\n  changeVolumeBy(v) {\n    this.el.setAttribute(\"avatar-volume-controls\", \"volume\", THREE.Math.clamp(this.data.volume + v, 0, 1));\n    this.updateVolumeLabel();\n  },\n\n  volumeUp() {\n    this.changeVolumeBy(0.1);\n  },\n\n  volumeDown() {\n    this.changeVolumeBy(-0.1);\n  },\n\n  update() {\n    if (this.audio) {\n      this.audio.gain.gain.value = this.data.volume;\n    }\n  },\n\n  updateVolumeLabel() {\n    this.volumeLabel.setAttribute(\n      \"text\",\n      \"value\",\n      this.data.volume === 0 ? \"Muted\" : VOLUME_LABELS[Math.floor(this.data.volume / 0.05)]\n    );\n  },\n\n  tick() {\n    if (this.audio) return;\n\n    // Walk up to Spine and then search down.\n    const source = this.el.parentNode.parentNode.querySelector(\"[networked-audio-source]\");\n    if (!source) return;\n\n    this.audio = source.components[\"networked-audio-source\"].sound;\n    this.update();\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\n\nAFRAME.registerComponent(\"pinch-to-move\", {\n  schema: {\n    speed: { default: 0.25 }\n  },\n  init() {\n    this.axis = [0, 0];\n  },\n  tick() {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const pinch = userinput.get(paths.device.touchscreen.pinchDelta);\n    if (pinch) {\n      this.axis[1] = pinch * this.data.speed;\n      this.el.emit(\"move\", { axis: this.axis });\n    }\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\n\nconst degToRad = THREE.Math.degToRad;\nconst radToDeg = THREE.Math.radToDeg;\n\nAFRAME.registerComponent(\"pitch-yaw-rotator\", {\n  schema: {\n    minPitch: { default: -65 },\n    maxPitch: { default: 65 }\n  },\n\n  init() {\n    this.pitch = 0;\n    this.yaw = 0;\n    this.onRotateX = this.onRotateX.bind(this);\n    this.el.sceneEl.addEventListener(\"rotateX\", this.onRotateX);\n    this.pendingXRotation = 0;\n  },\n\n  onRotateX(e) {\n    this.pendingXRotation += e.detail.value;\n  },\n\n  look(deltaPitch, deltaYaw) {\n    const { minPitch, maxPitch } = this.data;\n    this.pitch += deltaPitch;\n    this.pitch = THREE.Math.clamp(this.pitch, minPitch, maxPitch);\n    this.yaw += deltaYaw;\n  },\n\n  set(pitch, yaw) {\n    const { minPitch, maxPitch } = this.data;\n    this.pitch = THREE.Math.clamp(radToDeg(pitch), minPitch, maxPitch);\n    this.yaw = radToDeg(yaw);\n  },\n\n  tick() {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const cameraDelta = userinput.get(paths.actions.cameraDelta);\n    let lookX = this.pendingXRotation;\n    let lookY = 0;\n    if (cameraDelta) {\n      lookY += cameraDelta[0];\n      lookX += cameraDelta[1];\n    }\n    if (lookX !== 0 || lookY !== 0) {\n      this.look(lookX, lookY);\n      this.el.object3D.rotation.set(degToRad(this.pitch), degToRad(this.yaw), 0);\n      this.el.object3D.rotation.order = \"YXZ\";\n    }\n    this.pendingXRotation = 0;\n  }\n});\n","import { getBox } from \"../utils/auto-box-collider.js\";\nimport { getLastWorldPosition } from \"../utils/three-utils\";\n\nconst PI = Math.PI;\nconst HALF_PI = PI / 2;\nconst THREE_HALF_PI = 3 * HALF_PI;\nconst right = new THREE.Vector3(1, 0, 0);\nconst forward = new THREE.Vector3(0, 0, 1);\nconst left = new THREE.Vector3(-1, 0, 0);\nconst back = new THREE.Vector3(0, 0, -1);\nconst zero = new THREE.Vector3(0, 0, 0);\nconst dirs = {\n  left: {\n    dir: left,\n    rotation: THREE_HALF_PI,\n    halfExtent: \"x\"\n  },\n  right: {\n    dir: right,\n    rotation: HALF_PI,\n    halfExtent: \"x\"\n  },\n  forward: {\n    dir: forward,\n    rotation: 0,\n    halfExtent: \"z\"\n  },\n  back: {\n    dir: back,\n    rotation: PI,\n    halfExtent: \"z\"\n  }\n};\n\nAFRAME.registerComponent(\"position-at-box-shape-border\", {\n  multiple: true,\n  schema: {\n    target: { type: \"string\" },\n    dirs: { default: [\"left\", \"right\", \"forward\", \"back\"] },\n    animate: { default: true },\n    scale: { default: true }\n  },\n\n  init() {\n    this.cam = this.el.sceneEl.camera.el.object3D;\n    this._updateBox = this._updateBox.bind(this);\n    this._setupTarget = this._setupTarget.bind(this);\n    this.halfExtents = new THREE.Vector3();\n    this.el.sceneEl.systems[\"frame-scheduler\"].schedule(this._updateBox, \"media-components\");\n  },\n\n  remove() {\n    this.el.sceneEl.systems[\"frame-scheduler\"].unschedule(this._updateBox, \"media-components\");\n  },\n\n  update() {\n    this.dirs = this.data.dirs.map(d => dirs[d]);\n  },\n\n  _setupTarget() {\n    this.targetEl = this.el.querySelector(this.data.target);\n    if (!this.targetEl) {\n      console.warn(`Race condition on position-at-box-shape-border on selector ${this.data.target}`);\n      return;\n    }\n\n    this.target = this.targetEl.object3D;\n\n    this.targetEl.addEventListener(\"animationcomplete\", () => {\n      this.targetEl.removeAttribute(\"animation__show\");\n    });\n\n    this.target.scale.setScalar(0.01); // To avoid \"pop\" of gigantic button first time\n    this.target.matrixNeedsUpdate = true;\n  },\n\n  tick() {\n    if (!this.target) {\n      this._setupTarget();\n      return;\n    }\n\n    if (!this.el.getObject3D(\"mesh\")) {\n      return;\n    }\n\n    const isVisible = this.targetEl.object3D.visible;\n    const opening = isVisible && !this.wasVisible;\n    const scaleChanged =\n      this.el.object3D.scale.x !== this.previousScaleX ||\n      this.el.object3D.scale.y !== this.previousScaleY ||\n      this.el.object3D.scale.z !== this.previousScaleZ;\n    const isAnimating = this.targetEl.getAttribute(\"animation__show\");\n\n    // If the target is being shown or the scale changed while the opening animation is being run,\n    // we need to start or re-start the animation.\n    if (opening || (scaleChanged && isAnimating)) {\n      this._updateBox(this.data.animate, true);\n    }\n\n    this.wasVisible = isVisible;\n    this.previousScaleX = this.el.object3D.scale.x;\n    this.previousScaleY = this.el.object3D.scale.y;\n    this.previousScaleZ = this.el.object3D.scale.z;\n  },\n\n  _updateBox: (function() {\n    const camWorldPos = new THREE.Vector3();\n    const targetPosition = new THREE.Vector3();\n    const pointOnBoxFace = new THREE.Vector3();\n    const pointOnBoxFaceToCamera = new THREE.Vector3();\n    const boxCenter = new THREE.Vector3();\n    const tempParentWorldScale = new THREE.Vector3();\n    const boxFaceNormal = new THREE.Vector3();\n    const min = new THREE.Vector3(0.001, 0.001, 0.001);\n\n    return function(animate, forceNewExtents) {\n      if (forceNewExtents || this.mesh !== this.el.getObject3D(\"mesh\")) {\n        this.mesh = this.el.getObject3D(\"mesh\");\n\n        const box = getBox(this.el, this.mesh);\n        this.halfExtents = box.min\n          .clone()\n          .negate()\n          .add(box.max)\n          .multiplyScalar(0.65);\n\n        this.halfExtents.max(min);\n      }\n\n      if (!this.target) return;\n\n      getLastWorldPosition(this.cam, camWorldPos);\n\n      let targetSquareDistance = Infinity;\n      let targetDir = this.dirs[0].dir;\n      let targetHalfExtentStr = this.dirs[0].halfExtent;\n      let targetHalfExtent = this.halfExtents[targetHalfExtentStr];\n      let targetRotation = this.dirs[0].rotation;\n      let targetCameraDot = -1.1;\n\n      this.el.object3D.updateMatrices();\n\n      for (let i = 0; i < this.dirs.length; i++) {\n        const dir = this.dirs[i].dir;\n        const halfExtentStr = this.dirs[i].halfExtent;\n        const halfExtent = this.halfExtents[halfExtentStr];\n        pointOnBoxFace.copy(dir).multiplyScalar(halfExtent);\n        boxCenter.copy(zero);\n\n        this.el.object3D.localToWorld(pointOnBoxFace);\n        this.el.object3D.localToWorld(boxCenter);\n\n        pointOnBoxFaceToCamera.subVectors(camWorldPos, pointOnBoxFace);\n        pointOnBoxFaceToCamera.normalize();\n\n        boxFaceNormal.subVectors(pointOnBoxFace, boxCenter);\n        boxFaceNormal.normalize();\n\n        // Compute dot between camera + box normal to ensure menus are going to be\n        // somewhat perpendicular to camera frustum\n        const cameraAngleDotBoxNormal = boxFaceNormal.dot(pointOnBoxFaceToCamera);\n\n        const squareDistance = pointOnBoxFace.distanceToSquared(camWorldPos);\n        if (cameraAngleDotBoxNormal > targetCameraDot) {\n          targetSquareDistance = squareDistance;\n          targetDir = dir;\n          targetHalfExtent = halfExtent;\n          targetRotation = this.dirs[i].rotation;\n          targetHalfExtentStr = halfExtentStr;\n          targetCameraDot = cameraAngleDotBoxNormal;\n        }\n      }\n\n      this.target.position.copy(targetPosition.copy(targetDir).multiplyScalar(targetHalfExtent));\n      this.target.rotation.set(0, targetRotation, 0);\n\n      tempParentWorldScale.setFromMatrixScale(this.target.parent.matrixWorld);\n\n      const distance = Math.sqrt(targetSquareDistance);\n      const scale = Math.max(this.halfExtents.x, this.halfExtents.z) * distance;\n      const targetScale = Math.min(2.0, Math.max(0.5, scale * tempParentWorldScale.x));\n      const finalScale = this.data.scale ? targetScale / tempParentWorldScale.x : 1;\n\n      if (animate) {\n        this.targetEl.removeAttribute(\"animation__show\");\n\n        this.targetEl.setAttribute(\"animation__show\", {\n          property: \"scale\",\n          dur: 300,\n          from: { x: finalScale * 0.8, y: finalScale * 0.8, z: finalScale * 0.8 },\n          to: { x: finalScale, y: finalScale, z: finalScale },\n          easing: \"easeOutElastic\"\n        });\n      } else if (!this.targetEl.getAttribute(\"animation__show\")) {\n        this.target.scale.setScalar(finalScale);\n      }\n\n      this.target.matrixNeedsUpdate = true;\n    };\n  })()\n});\n","import { getPromotionTokenForFile } from \"../utils/media-utils\";\nimport { SOUND_PIN } from \"../systems/sound-effects-system\";\n\nAFRAME.registerComponent(\"pin-networked-object-button\", {\n  schema: {\n    // Selector for label informing users about Discord bridging of pins.\n    tipSelector: { type: \"string\" },\n\n    // Selector for label to change when pinned/unpinned, must be sibling of this components element\n    labelSelector: { type: \"string\" },\n\n    // Selector for items to hide iff pinned\n    hideWhenPinnedSelector: { type: \"string\" }\n  },\n\n  init() {\n    this._updateUI = this._updateUI.bind(this);\n    this._updateUIOnStateChange = this._updateUIOnStateChange.bind(this);\n    this.el.sceneEl.addEventListener(\"stateadded\", this._updateUIOnStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this._updateUIOnStateChange);\n\n    this.tipEl = this.el.parentNode.querySelector(this.data.tipSelector);\n    this.labelEl = this.el.parentNode.querySelector(this.data.labelSelector);\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n\n      this._updateUI();\n      this.targetEl.addEventListener(\"pinned\", this._updateUI);\n      this.targetEl.addEventListener(\"unpinned\", this._updateUI);\n    });\n\n    this.onHovered = () => {\n      this.hovering = true;\n      this._updateUI();\n    };\n\n    this.onUnhovered = () => {\n      this.hovering = false;\n      this._updateUI();\n    };\n\n    this.onClick = () => {\n      if (!NAF.utils.isMine(this.targetEl) && !NAF.utils.takeOwnership(this.targetEl)) return;\n\n      const wasPinned = this.targetEl.components.pinnable && this.targetEl.components.pinnable.data.pinned;\n      this.targetEl.setAttribute(\"pinnable\", \"pinned\", !wasPinned);\n      if (!wasPinned) {\n        this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_PIN);\n      }\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n    this.el.object3D.addEventListener(\"hovered\", this.onHovered);\n    this.el.object3D.addEventListener(\"unhovered\", this.onUnhovered);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n    this.el.object3D.removeEventListener(\"hovered\", this.onHovered);\n    this.el.object3D.removeEventListener(\"unhovered\", this.onUnhovered);\n  },\n\n  remove() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this._updateUIOnStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this._updateUIOnStateChange);\n\n    if (this.targetEl) {\n      this.targetEl.removeEventListener(\"pinned\", this._updateUI);\n      this.targetEl.removeEventListener(\"unpinned\", this._updateUI);\n    }\n  },\n\n  _discordBridges() {\n    const presences = window.APP.hubChannel.presence.state;\n    if (!presences) {\n      return [];\n    } else {\n      const channels = [];\n      for (const p of Object.values(presences)) {\n        for (const m of p.metas) {\n          if (m.profile && m.profile.discordBridges) {\n            Array.prototype.push.apply(channels, m.profile.discordBridges.map(b => b.channel.name));\n          }\n        }\n      }\n      return channels;\n    }\n  },\n\n  _updateUIOnStateChange(e) {\n    if (e.detail !== \"frozen\") return;\n    this._updateUI();\n  },\n\n  _updateUI() {\n    const { fileIsOwned, fileId } = this.targetEl.components[\"media-loader\"].data;\n    const canPin = !!(fileIsOwned || (fileId && getPromotionTokenForFile(fileId)));\n    this.el.setAttribute(\"visible\", canPin);\n    this.labelEl.setAttribute(\"visible\", canPin);\n\n    const isPinned = this.targetEl.getAttribute(\"pinnable\") && this.targetEl.getAttribute(\"pinnable\").pinned;\n    const discordBridges = this._discordBridges();\n    this.tipEl.setAttribute(\"visible\", !!(canPin && !isPinned && this.hovering && discordBridges.length > 0));\n\n    if (!canPin) return;\n    this.labelEl.setAttribute(\"text\", \"value\", isPinned ? \"un-pin\" : \"pin\");\n    this.el.setAttribute(\"text-button\", \"backgroundColor\", isPinned ? \"#fff\" : \"#ff3550\");\n    this.el.setAttribute(\"text-button\", \"backgroundHoverColor\", isPinned ? \"#bbb\" : \"#fc3545\");\n\n    this.el.parentNode.querySelectorAll(this.data.hideWhenPinnedSelector).forEach(hideEl => {\n      hideEl.setAttribute(\"visible\", !isPinned);\n    });\n  }\n});\n","import { findAncestorWithComponent } from \"../utils/scene-graph\";\n\nAFRAME.registerComponent(\"unmute-video-button\", {\n  init() {\n    this.onClick = () => {\n      const videoEl = findAncestorWithComponent(this.el, \"media-video\");\n      const mediaVideo = videoEl.components[\"media-video\"];\n      if (!mediaVideo || !mediaVideo.video || !mediaVideo.videoMutedAt) return;\n\n      // iOS initially plays the sound and *then* mutes it, and sometimes a second video playing\n      // can break all sound in the app. (Likely a Safari bug.) Adding a delay before the unmute\n      // occurs seems to help with reducing this.\n      if (performance.now() - mediaVideo.videoMutedAt < 3000) {\n        return;\n      }\n\n      if (mediaVideo.video.muted) {\n        mediaVideo.video.muted = false;\n        this.el.setAttribute(\"visible\", false);\n      }\n    };\n  },\n\n  play() {\n    // Safari won't accept grab-start or even mousedown as user-initiated gestures,\n    // so we have to use a global touchstart event here.\n    document.addEventListener(\"touchstart\", this.onClick);\n  },\n\n  pause() {\n    document.removeEventListener(\"touchstart\", this.onClick);\n  }\n});\n","import { getLastWorldPosition } from \"../utils/three-utils\";\n\nAFRAME.registerComponent(\"destroy-at-extreme-distances\", {\n  schema: {\n    xMin: { default: -1000 },\n    xMax: { default: 1000 },\n    yMin: { default: -1000 },\n    yMax: { default: 1000 },\n    zMin: { default: -1000 },\n    zMax: { default: 1000 }\n  },\n\n  init() {\n    this._checkForDestroy = this._checkForDestroy.bind(this);\n    this.el.sceneEl.systems[\"frame-scheduler\"].schedule(this._checkForDestroy, \"media-components\");\n  },\n\n  remove() {\n    this.el.sceneEl.systems[\"frame-scheduler\"].unschedule(this._checkForDestroy, \"media-components\");\n  },\n\n  _checkForDestroy: (function() {\n    const pos = new THREE.Vector3();\n    return function() {\n      const { xMin, xMax, yMin, yMax, zMin, zMax } = this.data;\n      getLastWorldPosition(this.el.object3D, pos);\n\n      if (pos.x < xMin || pos.x > xMax || pos.y < yMin || pos.y > yMax || pos.z < zMin || pos.z > zMax) {\n        this.el.parentNode.removeChild(this.el);\n      }\n    };\n  })()\n});\n","import { spawnMediaAround } from \"../utils/media-utils\";\nimport { createImageBitmap } from \"../utils/image-bitmap-utils\";\nimport { ObjectTypes } from \"../object-types\";\nimport { paths } from \"../systems/userinput/paths\";\nimport { SOUND_CAMERA_TOOL_TOOK_SNAPSHOT } from \"../systems/sound-effects-system\";\n\nimport cameraModelSrc from \"../assets/camera_tool.glb\";\n\nconst cameraModelPromise = new Promise(resolve => new THREE.GLTFLoader().load(cameraModelSrc, resolve));\n\nconst pathsMap = {\n  \"player-right-controller\": {\n    takeSnapshot: paths.actions.rightHand.takeSnapshot\n  },\n  \"player-left-controller\": {\n    takeSnapshot: paths.actions.leftHand.takeSnapshot\n  },\n  cursor: {\n    takeSnapshot: paths.actions.cursor.takeSnapshot\n  }\n};\n\nconst snapCanvas = document.createElement(\"canvas\");\nasync function pixelsToPNG(pixels, width, height) {\n  snapCanvas.width = width;\n  snapCanvas.height = height;\n  const context = snapCanvas.getContext(\"2d\");\n\n  const imageData = context.createImageData(width, height);\n  imageData.data.set(pixels);\n  const bitmap = await createImageBitmap(imageData);\n  context.scale(1, -1);\n  context.drawImage(bitmap, 0, -height);\n  const blob = await new Promise(resolve => snapCanvas.toBlob(resolve));\n  return new File([blob], \"snap.png\", { type: \"image/png\" });\n}\n\n// Don't show camera viewports on mobile VR to same framerate.\nconst enableCameraViewport = !AFRAME.utils.device.isMobileVR();\n\nAFRAME.registerComponent(\"camera-tool\", {\n  schema: {\n    previewFPS: { default: 6 },\n    imageWidth: { default: 1024 },\n    imageHeight: { default: 1024 / (16 / 9) }\n  },\n\n  init() {\n    this.lastUpdate = performance.now();\n    this.localSnapCount = 0; // Counter that is used to arrange photos\n\n    this.renderTarget = new THREE.WebGLRenderTarget(this.data.imageWidth, this.data.imageHeight, {\n      format: THREE.RGBAFormat,\n      minFilter: THREE.LinearFilter,\n      magFilter: THREE.NearestFilter,\n      encoding: THREE.sRGBEncoding,\n      depth: false,\n      stencil: false\n    });\n\n    this.camera = new THREE.PerspectiveCamera(50, this.renderTarget.width / this.renderTarget.height, 0.1, 30000);\n    this.camera.rotation.set(0, Math.PI, 0);\n    this.camera.position.set(0, 0, 0.05);\n    this.camera.matrixNeedsUpdate = true;\n    this.el.setObject3D(\"camera\", this.camera);\n\n    const material = new THREE.MeshBasicMaterial({\n      map: this.renderTarget.texture\n    });\n\n    // Bit of a hack here to only update the renderTarget when the screens are in view and at a reduced FPS\n    material.map.isVideoTexture = true;\n    material.map.update = () => {\n      if (enableCameraViewport && performance.now() - this.lastUpdate >= 1000 / this.data.previewFPS) {\n        this.updateRenderTargetNextTick = true;\n      }\n    };\n\n    cameraModelPromise.then(model => {\n      const mesh = model.scene.clone();\n      mesh.scale.set(2, 2, 2);\n      mesh.matrixNeedsUpdate = true;\n      this.el.setObject3D(\"mesh\", mesh);\n\n      const width = 0.28;\n      const geometry = new THREE.PlaneBufferGeometry(width, width / this.camera.aspect);\n\n      if (enableCameraViewport) {\n        const screen = new THREE.Mesh(geometry, material);\n        screen.rotation.set(0, Math.PI, 0);\n        screen.position.set(0, 0, -0.042);\n        screen.matrixNeedsUpdate = true;\n        this.el.setObject3D(\"screen\", screen);\n\n        const selfieScreen = new THREE.Mesh(geometry, material);\n        selfieScreen.position.set(0, 0.4, 0);\n        selfieScreen.scale.set(-2, 2, 2);\n        selfieScreen.matrixNeedsUpdate = true;\n        this.el.setObject3D(\"selfieScreen\", selfieScreen);\n\n        this.updateRenderTargetNextTick = true;\n      }\n\n      this.cameraSystem = this.el.sceneEl.systems[\"camera-tools\"];\n      this.cameraSystem.register(this.el);\n    });\n\n    this.el.setAttribute(\"hover-menu__camera\", { template: \"#camera-hover-menu\", dirs: [\"forward\", \"back\"] });\n    this.el.components[\"hover-menu__camera\"].getHoverMenu().then(() => {\n      this.snapButton = this.el.querySelector(\".snap-button\");\n      this.snapButton.object3D.addEventListener(\"interact\", () => {\n        this.takeSnapshotNextTick = true;\n      });\n    });\n  },\n\n  remove() {\n    this.cameraSystem.deregister(this.el);\n    this.el.sceneEl.systems[\"camera-mirror\"].unmirrorCameraAtEl(this.el);\n    this.el.sceneEl.emit(\"camera_removed\");\n  },\n\n  focus(el, track) {\n    if (track) {\n      this.trackTarget = el;\n    } else {\n      this.trackTarget = null;\n    }\n\n    this.lookAt(el);\n  },\n\n  lookAt: (function() {\n    const targetPos = new THREE.Vector3();\n    return function(el) {\n      targetPos.setFromMatrixPosition(el.object3D.matrixWorld);\n      this.el.object3D.lookAt(targetPos);\n      this.el.object3D.matrixNeedsUpdate = true;\n    };\n  })(),\n\n  mirror() {\n    this.el.sceneEl.systems[\"camera-mirror\"].mirrorCameraAtEl(this.el);\n  },\n\n  unmirror() {\n    this.el.sceneEl.systems[\"camera-mirror\"].unmirrorCameraAtEl(this.el);\n  },\n\n  onAvatarUpdated() {\n    delete this.playerHead;\n  },\n\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const heldLeftHand = interaction.state.leftHand.held === this.el;\n    const heldRightHand = interaction.state.rightHand.held === this.el;\n    const heldRightRemote = interaction.state.rightRemote.held === this.el;\n    if (\n      (heldLeftHand && userinput.get(interaction.options.leftHand.grabPath)) ||\n      (heldRightHand && userinput.get(interaction.options.rightHand.grabPath)) ||\n      (heldRightRemote && userinput.get(interaction.options.rightRemote.grabPath))\n    ) {\n      this.localSnapCount = 0;\n    }\n\n    let grabberId;\n    if (heldRightHand) {\n      grabberId = \"player-right-controller\";\n    } else if (heldLeftHand) {\n      grabberId = \"player-left-controller\";\n    } else if (heldRightRemote) {\n      grabberId = \"cursor\";\n    }\n    if (grabberId) {\n      const grabberPaths = pathsMap[grabberId];\n      if (userinput.get(grabberPaths.takeSnapshot)) {\n        this.takeSnapshotNextTick = true;\n      }\n    }\n\n    if (userinput.get(paths.actions.takeSnapshot)) {\n      this.takeSnapshotNextTick = true;\n    }\n  },\n\n  tock: (function() {\n    const tempHeadScale = new THREE.Vector3();\n\n    return function tock() {\n      const sceneEl = this.el.sceneEl;\n      const renderer = this.renderer || sceneEl.renderer;\n      const now = performance.now();\n\n      // Perform lookAt in tock so it will re-orient after grabs, etc.\n      if (this.trackTarget) {\n        if (this.trackTarget.parentNode) {\n          this.lookAt(this.trackTarget);\n        } else {\n          this.trackTarget = null; // Target removed\n        }\n      }\n\n      if (!this.playerHead) {\n        const headEl = document.getElementById(\"player-head\");\n        this.playerHead = headEl && headEl.object3D;\n      }\n\n      if (!this.playerHud) {\n        const hudEl = document.getElementById(\"player-hud\");\n        this.playerHud = hudEl && hudEl.object3D;\n      }\n\n      if (this.takeSnapshotNextTick || this.updateRenderTargetNextTick) {\n        if (this.playerHead) {\n          tempHeadScale.copy(this.playerHead.scale);\n          this.playerHead.scale.set(1, 1, 1);\n          this.playerHead.updateMatrices(true, true);\n          this.playerHead.updateMatrixWorld(true, true);\n        }\n\n        let playerHudWasVisible = false;\n\n        if (this.playerHud) {\n          playerHudWasVisible = this.playerHud.visible;\n          this.playerHud.visible = false;\n        }\n\n        const tmpVRFlag = renderer.vr.enabled;\n        const tmpOnAfterRender = sceneEl.object3D.onAfterRender;\n        delete sceneEl.object3D.onAfterRender;\n        renderer.vr.enabled = false;\n\n        renderer.setRenderTarget(this.renderTarget);\n        renderer.render(sceneEl.object3D, this.camera);\n        renderer.setRenderTarget(null);\n\n        renderer.vr.enabled = tmpVRFlag;\n        sceneEl.object3D.onAfterRender = tmpOnAfterRender;\n        if (this.playerHead) {\n          this.playerHead.scale.copy(tempHeadScale);\n          this.playerHead.updateMatrices(true, true);\n          this.playerHead.updateMatrixWorld(true, true);\n        }\n        if (this.playerHud) {\n          this.playerHud.visible = playerHudWasVisible;\n        }\n        this.lastUpdate = now;\n        this.updateRenderTargetNextTick = false;\n      }\n\n      if (this.takeSnapshotNextTick) {\n        const width = this.renderTarget.width;\n        const height = this.renderTarget.height;\n        if (!this.snapPixels) {\n          this.snapPixels = new Uint8Array(width * height * 4);\n        }\n        renderer.readRenderTargetPixels(this.renderTarget, 0, 0, width, height, this.snapPixels);\n        pixelsToPNG(this.snapPixels, width, height).then(file => {\n          const { orientation } = spawnMediaAround(this.el, file, this.localSnapCount, true);\n\n          orientation.then(() => {\n            this.el.sceneEl.emit(\"object_spawned\", { objectType: ObjectTypes.CAMERA });\n          });\n        });\n        sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_TOOK_SNAPSHOT);\n        this.takeSnapshotNextTick = false;\n        this.localSnapCount++;\n      }\n    };\n  })()\n});\n","import { addMedia } from \"../utils/media-utils\";\nimport { ObjectContentOrigins } from \"../object-types\";\nimport { guessContentType } from \"../utils/media-utils\";\n\nAFRAME.registerComponent(\"clone-media-button\", {\n  init() {\n    this.updateSrc = () => {\n      const src = (this.src = this.targetEl.components[\"media-loader\"].data.src);\n      const visible = src && guessContentType(src) !== \"video/vnd.hubs-webrtc\";\n      this.el.object3D.visible = !!visible;\n    };\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n      this.targetEl.addEventListener(\"media_resolved\", this.updateSrc, { once: true });\n      this.updateSrc();\n    });\n\n    this.onClick = () => {\n      const src = this.src;\n      const { resize } = this.targetEl.components[\"media-loader\"].data;\n      const { entity } = addMedia(src, \"#interactable-media\", ObjectContentOrigins.URL, true, resize);\n\n      entity.object3D.matrixNeedsUpdate = true;\n\n      entity.setAttribute(\"offset-relative-to\", {\n        target: \"#player-camera\",\n        offset: { x: 0, y: 0, z: -1.5 }\n      });\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","import { isHubsSceneUrl, isHubsRoomUrl } from \"../utils/media-utils\";\nimport { guessContentType } from \"../utils/media-utils\";\n\nAFRAME.registerComponent(\"open-media-button\", {\n  init() {\n    this.label = this.el.querySelector(\"[text]\");\n\n    this.updateSrc = () => {\n      const src = (this.src = this.targetEl.components[\"media-loader\"].data.src);\n      const visible = src && guessContentType(src) !== \"video/vnd.hubs-webrtc\";\n      this.el.object3D.visible = !!visible;\n\n      if (visible) {\n        let label = \"open link\";\n        if (isHubsSceneUrl(src)) {\n          label = \"use scene\";\n        } else if (isHubsRoomUrl(src)) {\n          label = \"visit room\";\n        }\n        this.label.setAttribute(\"text\", \"value\", label);\n      }\n    };\n\n    this.onClick = () => {\n      if (isHubsSceneUrl(this.src)) {\n        this.el.sceneEl.emit(\"scene_media_selected\", this.src);\n      } else if (isHubsRoomUrl(this.src)) {\n        location.href = this.src;\n      } else {\n        window.open(this.src);\n      }\n    };\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n      this.targetEl.addEventListener(\"media_resolved\", this.updateSrc, { once: true });\n      this.updateSrc();\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\nconst AMMO_BODY_ATTRIBUTES = { type: \"kinematic\", collisionFilterMask: COLLISION_LAYERS.HANDS };\n\nconst TRANSFORM_MODE = {\n  AXIS: \"axis\",\n  PUPPET: \"puppet\",\n  CURSOR: \"cursor\",\n  ALIGN: \"align\",\n  SCALE: \"scale\"\n};\n\nconst SCALE_SENSITIVITY = 100;\nconst MIN_SCALE = 0.1;\nconst MAX_SCALE = 100;\n\nconst STEP_LENGTH = Math.PI / 10;\nconst CAMERA_WORLD_QUATERNION = new THREE.Quaternion();\nconst CAMERA_WORLD_POSITION = new THREE.Vector3();\nconst TARGET_WORLD_QUATERNION = new THREE.Quaternion();\nconst v = new THREE.Vector3();\nconst v2 = new THREE.Vector3();\nconst q = new THREE.Quaternion();\nconst q2 = new THREE.Quaternion();\n\nAFRAME.registerComponent(\"transform-button\", {\n  schema: {\n    mode: {\n      type: \"string\",\n      oneof: Object.values(TRANSFORM_MODE),\n      default: TRANSFORM_MODE.CURSOR\n    },\n    axis: { type: \"vec3\", default: null }\n  },\n  init() {\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n    });\n    const rightHand = document.querySelector(\"#player-right-controller\");\n    this.onGrabStart = e => {\n      if (!this.targetEl) {\n        return;\n      }\n      if (!NAF.utils.isMine(this.targetEl) && !NAF.utils.takeOwnership(this.targetEl)) {\n        return;\n      }\n      if (this.targetEl.body) {\n        this.targetEl.setAttribute(\"ammo-body\", AMMO_BODY_ATTRIBUTES);\n      }\n      this.transformSystem = this.transformSystem || AFRAME.scenes[0].systems[\"transform-selected-object\"];\n      this.transformSystem.startTransform(\n        this.targetEl.object3D,\n        e.object3D.el.id === \"cursor\" ? rightHand.object3D : e.object3D,\n        this.data\n      );\n    };\n    this.onGrabEnd = () => {\n      this.transformSystem = this.transformSystem || AFRAME.scenes[0].systems[\"transform-selected-object\"];\n      this.transformSystem.stopTransform();\n    };\n  },\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onGrabStart);\n    this.el.object3D.addEventListener(\"holdable-button-down\", this.onGrabStart);\n    this.el.object3D.addEventListener(\"holdable-button-up\", this.onGrabEnd);\n  },\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onGrabStart);\n    this.el.object3D.removeEventListener(\"holdable-button-down\", this.onGrabStart);\n    this.el.object3D.removeEventListener(\"holdable-button-up\", this.onGrabEnd);\n  }\n});\n\nAFRAME.registerSystem(\"transform-selected-object\", {\n  init() {\n    this.target = null;\n    this.mode = null;\n    this.transforming = false;\n    this.axis = new THREE.Vector3();\n    this.store = window.APP.store;\n\n    this.dxStore = 0;\n    this.dxApplied = 0;\n    this.dyAll = 0;\n    this.dyStore = 0;\n    this.dyApplied = 0;\n\n    this.puppet = {\n      initialControllerOrientation: new THREE.Quaternion(),\n      initialControllerOrientation_inverse: new THREE.Quaternion(),\n      initialObjectOrientation: new THREE.Quaternion(),\n      currentControllerOrientation: new THREE.Quaternion(),\n      controllerOrientationDelta: new THREE.Quaternion()\n    };\n\n    this.planarInfo = {\n      plane: new THREE.Mesh(\n        new THREE.PlaneBufferGeometry(100000, 100000, 2, 2),\n        new THREE.MeshBasicMaterial({\n          visible: false,\n          wireframe: true,\n          side: THREE.DoubleSide,\n          transparent: true,\n          opacity: 0.3\n        })\n      ),\n      normal: new THREE.Vector3(),\n      intersections: [],\n      previousPointOnPlane: new THREE.Vector3(),\n      currentPointOnPlane: new THREE.Vector3(),\n      deltaOnPlane: new THREE.Vector3(),\n      finalProjectedVec: new THREE.Vector3()\n    };\n    this.el.object3D.add(this.planarInfo.plane);\n  },\n\n  stopTransform() {\n    this.transforming = false;\n  },\n\n  startPlaneCasting() {\n    const { plane, intersections, previousPointOnPlane } = this.planarInfo;\n\n    this.el.camera.getWorldQuaternion(CAMERA_WORLD_QUATERNION);\n    plane.quaternion.copy(CAMERA_WORLD_QUATERNION);\n    this.target.getWorldPosition(plane.position);\n    plane.matrixNeedsUpdate = true;\n    plane.updateMatrixWorld(true);\n\n    intersections.length = 0;\n    this.raycaster =\n      this.raycaster || document.querySelector(\"#cursor-controller\").components[\"cursor-controller\"].raycaster;\n    const far = this.raycaster.far;\n    this.raycaster.far = 1000;\n    plane.raycast(this.raycaster, intersections);\n    this.raycaster.far = far;\n    this.transforming = !!intersections[0];\n    if (!this.transforming) {\n      return;\n    }\n\n    previousPointOnPlane.copy(intersections[0].point);\n\n    this.target.getWorldQuaternion(TARGET_WORLD_QUATERNION);\n\n    v.set(0, 0, -1).applyQuaternion(CAMERA_WORLD_QUATERNION);\n    v2.set(0, 0, -1).applyQuaternion(TARGET_WORLD_QUATERNION);\n    this.sign = v.dot(v2) > 0 ? 1 : -1;\n\n    v.set(0, 1, 0); //.applyQuaternion(this.CAMERA_WORLD_QUATERNION);\n    v2.set(0, 1, 0).applyQuaternion(TARGET_WORLD_QUATERNION);\n    this.sign2 = v.dot(v2) > 0 ? 1 : -1;\n\n    this.dyAll = 0;\n    this.dyStore = 0;\n    this.dyApplied = 0;\n    this.dxAll = 0;\n    this.dxStore = 0;\n    this.dxApplied = 0;\n  },\n\n  startTransform(target, hand, data) {\n    this.target = target;\n    this.hand = hand;\n    this.mode = data.mode;\n    this.transforming = true;\n\n    if (this.mode === TRANSFORM_MODE.ALIGN) {\n      this.store.update({ activity: { hasRecentered: true } });\n      return;\n    } else if (this.mode === TRANSFORM_MODE.SCALE) {\n      this.store.update({ activity: { hasScaled: true } });\n    } else {\n      this.store.update({ activity: { hasRotated: true } });\n    }\n\n    if (this.mode === TRANSFORM_MODE.PUPPET) {\n      this.target.getWorldQuaternion(this.puppet.initialObjectOrientation);\n      this.hand.getWorldQuaternion(this.puppet.initialControllerOrientation);\n      this.puppet.initialControllerOrientation_inverse.copy(this.puppet.initialControllerOrientation).inverse();\n      return;\n    }\n\n    if (this.mode === TRANSFORM_MODE.AXIS) {\n      this.axis.copy(data.axis);\n    }\n\n    this.startPlaneCasting();\n  },\n\n  puppetingTick() {\n    // Find controller delta as a quaternion, then apply it to the object, snapping in fixed increments if desired:\n    // Snap to fixed angle increments by converting to an Euler,\n    // restricting the angles using Math.floor, and converting back to a quaternion.\n    const {\n      currentControllerOrientation,\n      controllerOrientationDelta,\n      initialControllerOrientation_inverse,\n      initialObjectOrientation\n    } = this.puppet;\n    this.hand.getWorldQuaternion(currentControllerOrientation);\n    controllerOrientationDelta.copy(initialControllerOrientation_inverse).premultiply(currentControllerOrientation);\n    this.target.quaternion.copy(initialObjectOrientation).premultiply(controllerOrientationDelta);\n    this.target.matrixNeedsUpdate = true;\n  },\n\n  cursorAxisOrScaleTick() {\n    const {\n      plane,\n      normal,\n      intersections,\n      previousPointOnPlane,\n      currentPointOnPlane,\n      deltaOnPlane,\n      finalProjectedVec\n    } = this.planarInfo;\n\n    this.target.getWorldPosition(plane.position);\n    this.el.camera.getWorldQuaternion(plane.quaternion);\n    plane.matrixNeedsUpdate = true;\n    const cameraToPlaneDistance = v.sub(plane.position).length();\n\n    intersections.length = 0;\n    const far = this.raycaster.far;\n    this.raycaster.far = 1000;\n    plane.raycast(this.raycaster, intersections);\n    this.raycaster.far = far;\n    const intersection = intersections[0]; // point\n    if (!intersection) return;\n\n    normal.set(0, 0, -1).applyQuaternion(plane.quaternion);\n\n    currentPointOnPlane.copy(intersection.point);\n    deltaOnPlane.copy(currentPointOnPlane).sub(previousPointOnPlane);\n    const SENSITIVITY = 10;\n    finalProjectedVec\n      .copy(deltaOnPlane)\n      .projectOnPlane(normal)\n      .applyQuaternion(q.copy(plane.quaternion).inverse())\n      .multiplyScalar(SENSITIVITY / cameraToPlaneDistance);\n    if (this.mode === TRANSFORM_MODE.CURSOR || this.mode === TRANSFORM_MODE.SCALE) {\n      const modify = AFRAME.scenes[0].systems.userinput.get(paths.actions.transformModifier);\n\n      this.dyAll = this.dyStore + finalProjectedVec.y;\n      this.dyApplied = modify ? this.dyAll : Math.round(this.dyAll / STEP_LENGTH) * STEP_LENGTH;\n      this.dyStore = this.dyAll - this.dyApplied;\n\n      this.dxAll = this.dxStore + finalProjectedVec.x;\n      this.dxApplied = modify ? this.dxAll : Math.round(this.dxAll / STEP_LENGTH) * STEP_LENGTH;\n      this.dxStore = this.dxAll - this.dxApplied;\n\n      if (this.mode === TRANSFORM_MODE.CURSOR) {\n        this.target.getWorldQuaternion(TARGET_WORLD_QUATERNION);\n        v.set(1, 0, 0).applyQuaternion(modify ? CAMERA_WORLD_QUATERNION : TARGET_WORLD_QUATERNION);\n        q.setFromAxisAngle(v, modify ? -this.dyApplied : this.sign2 * this.sign * -this.dyApplied);\n\n        if (modify) {\n          v.set(0, 1, 0).applyQuaternion(CAMERA_WORLD_QUATERNION);\n        } else {\n          v.set(0, 1, 0);\n        }\n        q2.setFromAxisAngle(v, this.dxApplied);\n\n        this.target.quaternion.premultiply(q).premultiply(q2);\n      } else {\n        const scaleFactor =\n          THREE.Math.clamp(finalProjectedVec.y + finalProjectedVec.x, -0.0005, 0.0005) * SCALE_SENSITIVITY;\n\n        const newScale = this.target.scale.x * (1.0 + scaleFactor);\n\n        if (newScale > MIN_SCALE && newScale < MAX_SCALE) {\n          this.target.scale.multiplyScalar(1.0 + scaleFactor);\n        }\n      }\n\n      this.target.matrixNeedsUpdate = true;\n    } else if (this.mode === TRANSFORM_MODE.AXIS) {\n      this.dxAll = this.dxStore + finalProjectedVec.x;\n      this.dxApplied = Math.round(this.dxAll / STEP_LENGTH) * STEP_LENGTH;\n      this.dxStore = this.dxAll - this.dxApplied;\n\n      this.target.quaternion.multiply(q.setFromAxisAngle(this.axis, -this.sign * this.dxApplied));\n      this.target.matrixNeedsUpdate = true;\n    }\n\n    previousPointOnPlane.copy(currentPointOnPlane);\n  },\n\n  tick() {\n    if (!this.transforming) {\n      return;\n    }\n\n    if (this.mode === TRANSFORM_MODE.ALIGN) {\n      this.el.camera.getWorldPosition(CAMERA_WORLD_POSITION);\n      this.target.lookAt(CAMERA_WORLD_POSITION);\n      this.transforming = false;\n      return;\n    }\n\n    if (this.mode === TRANSFORM_MODE.PUPPET) {\n      this.puppetingTick();\n      return;\n    }\n    this.cursorAxisOrScaleTick();\n  }\n});\n\nAFRAME.registerComponent(\"transform-button-selector\", {\n  tick() {\n    const hand = AFRAME.scenes[0].systems.userinput.get(paths.actions.rightHand.pose);\n    if (!hand) {\n      if (this.el.components[\"transform-button\"].data.mode !== TRANSFORM_MODE.CURSOR) {\n        this.el.setAttribute(\"transform-button\", \"mode\", TRANSFORM_MODE.CURSOR);\n      }\n    } else {\n      if (this.el.components[\"transform-button\"].data.mode !== TRANSFORM_MODE.PUPPET) {\n        this.el.setAttribute(\"transform-button\", \"mode\", TRANSFORM_MODE.PUPPET);\n      }\n    }\n  }\n});\n\nconst FORWARD = new THREE.Vector3(0, 0, 1);\nconst TWO_PI = 2 * Math.PI;\nAFRAME.registerComponent(\"visible-if-transforming\", {\n  init() {},\n  tick(t) {\n    const shouldBeVisible = AFRAME.scenes[0].systems[\"transform-selected-object\"].transforming;\n    const visibleNeedsUpdate = this.el.getAttribute(\"visible\") !== shouldBeVisible;\n    if (visibleNeedsUpdate) {\n      this.el.setAttribute(\"visible\", AFRAME.scenes[0].systems[\"transform-selected-object\"].transforming);\n    }\n\n    if (shouldBeVisible) {\n      this.el.object3D.quaternion.setFromAxisAngle(FORWARD, TWO_PI * Math.sin(t / 1000.0));\n      this.el.object3D.matrixNeedsUpdate = true;\n    }\n  }\n});\n","const CYLINDER_TEXTURE =\n  \"data:image/png;base64,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\";\n\nimport { SOUND_TELEPORT_START, SOUND_TELEPORT_END } from \"../systems/sound-effects-system\";\n\nfunction easeIn(t) {\n  return t * t;\n}\n\nfunction easeOutIn(t) {\n  if (t < 0.5) return 0.5 * ((t = t * 2 - 1) * t * t + 1);\n  return 0.5 * (t = t * 2 - 1) * t * t + 0.5;\n}\n\nconst RayCurve = function(numPoints, width) {\n  this.geometry = new THREE.BufferGeometry();\n  this.vertices = new Float32Array(numPoints * 3 * 2);\n  this.uvs = new Float32Array(numPoints * 2 * 2);\n  this.width = width;\n\n  this.geometry.addAttribute(\"position\", new THREE.BufferAttribute(this.vertices, 3).setDynamic(true));\n\n  this.material = new THREE.MeshBasicMaterial({\n    side: THREE.DoubleSide,\n    transparent: true\n  });\n\n  this.mesh = new THREE.Mesh(this.geometry, this.material);\n  this.mesh.drawMode = THREE.TriangleStripDrawMode;\n\n  this.mesh.frustumCulled = false;\n  this.mesh.vertices = this.vertices;\n\n  this.direction = new THREE.Vector3();\n  this.numPoints = numPoints;\n};\n\nRayCurve.prototype = {\n  setDirection: function(direction) {\n    const UP = new THREE.Vector3(0, 1, 0);\n    this.direction\n      .copy(direction)\n      .cross(UP)\n      .normalize()\n      .multiplyScalar(this.width / 2);\n  },\n\n  setWidth: function(width) {\n    this.width = width;\n  },\n\n  setPoint: (function() {\n    const posA = new THREE.Vector3();\n    const posB = new THREE.Vector3();\n\n    return function(i, point) {\n      posA.copy(point).add(this.direction);\n      posB.copy(point).sub(this.direction);\n\n      let idx = 2 * 3 * i;\n      this.vertices[idx++] = posA.x;\n      this.vertices[idx++] = posA.y;\n      this.vertices[idx++] = posA.z;\n\n      this.vertices[idx++] = posB.x;\n      this.vertices[idx++] = posB.y;\n      this.vertices[idx++] = posB.z;\n\n      this.geometry.attributes.position.needsUpdate = true;\n    };\n  })()\n};\n\nfunction parabolicCurve(p0, v0, t, out) {\n  out.x = p0.x + v0.x * t;\n  out.y = p0.y + v0.y * t - 4.9 * t * t;\n  out.z = p0.z + v0.z * t;\n  return out;\n}\n\nfunction isValidNormalsAngle(collisionNormal, referenceNormal, landingMaxAngle) {\n  const angleNormals = referenceNormal.angleTo(collisionNormal);\n  return THREE.Math.RAD2DEG * angleNormals <= landingMaxAngle;\n}\n\nconst checkLineIntersection = (function() {\n  const direction = new THREE.Vector3();\n  return function checkLineIntersection(start, end, meshes, raycaster, referenceNormal, landingMaxAngle, hitPoint) {\n    direction.copy(end).sub(start);\n    const distance = direction.length();\n    raycaster.far = distance;\n    raycaster.set(start, direction.normalize());\n    const intersects = raycaster.intersectObjects(meshes, true);\n    if (intersects.length > 0 && isValidNormalsAngle(intersects[0].face.normal, referenceNormal, landingMaxAngle)) {\n      hitPoint.copy(intersects[0].point);\n      return true;\n    }\n    return false;\n  };\n})();\n\nfunction getMeshes(collisionEntities) {\n  return collisionEntities\n    .map(function(entity) {\n      return entity.getObject3D(\"mesh\");\n    })\n    .filter(function(n) {\n      return n;\n    });\n}\n\nconst MISS_OPACITY = 0.1;\nconst HIT_OPACITY = 0.3;\nconst MISS_COLOR = 0xff0000;\nconst HIT_COLOR = 0x00ff00;\nconst FORWARD = new THREE.Vector3(0, 0, -1);\nconst LANDING_NORMAL = new THREE.Vector3(0, 1, 0);\nconst MAX_LANDING_ANGLE = 45;\nconst DRAW_TIME_MS = 400;\nconst q = new THREE.Quaternion();\nconst vecHelper = new THREE.Vector3();\n\nAFRAME.registerComponent(\"teleporter\", {\n  schema: {\n    start: { type: \"string\" },\n    confirm: { type: \"string\" },\n    speed: { default: 12 },\n    collisionEntities: { default: \"\" },\n    hitCylinderColor: { type: \"color\", default: \"#99ff99\" },\n    hitCylinderRadius: { default: 0.25, min: 0 },\n    outerRadius: { default: 0.6, min: 0 },\n    hitCylinderHeight: { default: 0.3, min: 0 }\n  },\n\n  init() {\n    this.isTeleporting = false;\n    this.rayCurve = new RayCurve(20, 0.025);\n    this.rayCurve.mesh.visible = false;\n    this.teleportEntity = document.createElement(\"a-entity\");\n    this.teleportEntity.setObject3D(\"mesh\", this.rayCurve.mesh);\n    this.el.sceneEl.appendChild(this.teleportEntity);\n\n    this.p0 = new THREE.Vector3();\n    this.v0 = new THREE.Vector3();\n    this.parabola = Array.from(new Array(this.rayCurve.numPoints), () => new THREE.Vector3());\n    this.hit = false;\n    this.hitPoint = new THREE.Vector3();\n    this.meshes = [];\n    this.raycaster = new THREE.Raycaster();\n    this.rigWorldPosition = new THREE.Vector3();\n    this.newRigWorldPosition = new THREE.Vector3();\n    this.teleportOriginWorldPosition = new THREE.Vector3();\n\n    this.teleportEventDetail = {\n      oldPosition: this.rigWorldPosition,\n      newPosition: this.newRigWorldPosition,\n      hitPoint: this.hitPoint\n    };\n    this.prevHitHeight = 0;\n    this.direction = new THREE.Vector3();\n    this.hitEntity = this.createHitEntity();\n    this.hitEntity.object3D.visible = false;\n    this.el.sceneEl.appendChild(this.hitEntity);\n    this.queryCollisionEntities();\n  },\n\n  queryCollisionEntities: function() {\n    this.collisionEntities = [].slice.call(this.el.sceneEl.querySelectorAll(this.data.collisionEntities));\n    this.meshes = getMeshes(this.collisionEntities);\n  },\n\n  remove() {\n    this.stopPlayingTeleportSound();\n  },\n\n  stopPlayingTeleportSound() {\n    if (this.teleportingSound) {\n      const sfx = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem;\n      sfx.stopSoundNode(this.teleportingSound.source);\n      this.teleportingSound = null;\n    }\n  },\n\n  tick(t, dt) {\n    const sfx = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem;\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const { start, confirm, speed } = this.data;\n    const object3D = this.el.object3D;\n\n    if (!this.isTeleporting && userinput.get(start)) {\n      this.isTeleporting = true;\n      this.timeTeleporting = 0;\n      this.hit = false;\n      this.rayCurve.mesh.visible = true;\n      this.rayCurve.mesh.updateMatrixWorld();\n      this.rayCurve.mesh.material.opacity = MISS_OPACITY;\n      this.rayCurve.mesh.material.color.set(MISS_COLOR);\n      this.rayCurve.mesh.material.needsUpdate = true;\n      this.teleportingSound = sfx.playSoundLoopedWithGain(SOUND_TELEPORT_START);\n      if (this.teleportingSound) {\n        this.teleportingSound.gain.gain.value = 0.005;\n      }\n    }\n\n    if (!this.isTeleporting) {\n      return;\n    }\n    if (this.teleportingSound) {\n      this.teleportingSound.gain.gain.value = Math.min(0.025, this.teleportingSound.gain.gain.value + 0.00002 * dt);\n    }\n\n    if (userinput.get(confirm)) {\n      this.hitEntity.setAttribute(\"visible\", false);\n      this.isTeleporting = false;\n      this.rayCurve.mesh.visible = false;\n\n      if (this.teleportingSound) {\n        this.stopPlayingTeleportSound();\n      }\n\n      if (!this.hit || this.timeTeleporting < DRAW_TIME_MS) {\n        return;\n      }\n\n      this.characterController =\n        this.characterController || document.querySelector(\"#player-rig\").components[\"character-controller\"];\n      this.characterController.teleportTo(this.hitPoint);\n\n      sfx.playSoundOneShot(SOUND_TELEPORT_END);\n      return;\n    }\n\n    this.timeTeleporting += dt;\n    object3D.updateMatrixWorld();\n    object3D.matrixWorld.decompose(this.p0, q, vecHelper);\n    this.direction\n      .copy(FORWARD)\n      .applyQuaternion(q)\n      .normalize();\n    this.rayCurve.setDirection(this.direction);\n    this.v0.copy(this.direction).multiplyScalar(speed);\n\n    let collidedIndex = this.rayCurve.numPoints - 1;\n\n    this.hit = false;\n    this.parabola[0].copy(this.p0);\n    const timeSegment = 1 / (this.rayCurve.numPoints - 1);\n    for (let i = 1; i < this.rayCurve.numPoints; i++) {\n      const t = i * timeSegment;\n      parabolicCurve(this.p0, this.v0, t, vecHelper);\n      this.parabola[i].copy(vecHelper);\n\n      if (\n        checkLineIntersection(\n          this.parabola[i - 1],\n          this.parabola[i],\n          this.meshes,\n          this.raycaster,\n          LANDING_NORMAL,\n          MAX_LANDING_ANGLE,\n          this.hitPoint\n        )\n      ) {\n        this.hit = true;\n        collidedIndex = i;\n        break;\n      }\n    }\n\n    const percentToDraw = this.timeTeleporting > DRAW_TIME_MS ? 1 : this.timeTeleporting / DRAW_TIME_MS;\n    const percentRaycasted = collidedIndex / (this.rayCurve.numPoints - 1);\n    const segmentT = (percentToDraw * percentRaycasted) / (this.rayCurve.numPoints - 1);\n\n    for (let i = 0; i < this.rayCurve.numPoints; i++) {\n      const t = i * segmentT;\n      parabolicCurve(this.p0, this.v0, t, vecHelper);\n      this.rayCurve.setPoint(i, vecHelper);\n    }\n\n    const color = this.hit ? HIT_COLOR : MISS_COLOR;\n    const opacity = this.hit && this.timeTeleporting >= DRAW_TIME_MS ? HIT_OPACITY : MISS_OPACITY;\n    this.rayCurve.material.color.set(color);\n    this.rayCurve.material.opacity = opacity;\n\n    this.hitEntity.setAttribute(\"visible\", this.hit);\n    if (this.hit) {\n      this.hitEntity.setAttribute(\"position\", this.hitPoint);\n      this.hitEntity.object3D.traverse(o => {\n        o.matrixNeedsUpdate = true;\n      });\n      const hitEntityOpacity = HIT_OPACITY * easeOutIn(percentToDraw);\n      const dRadii = this.data.outerRadius - this.data.hitCylinderRadius;\n      const outerScale = (this.data.outerRadius - easeIn(percentToDraw) * dRadii) / this.data.outerRadius;\n      this.outerTorus.object3D.scale.set(outerScale, outerScale, 1);\n      this.torus.setAttribute(\"material\", \"opacity\", hitEntityOpacity);\n      this.cylinder.setAttribute(\"material\", \"opacity\", hitEntityOpacity);\n    }\n  },\n\n  createHitEntity() {\n    const data = this.data;\n\n    // Parent.\n    const hitEntity = document.createElement(\"a-entity\");\n    hitEntity.className = \"hitEntity\";\n\n    // Torus.\n    this.torus = document.createElement(\"a-entity\");\n    this.torus.setAttribute(\"geometry\", {\n      primitive: \"torus\",\n      radius: data.hitCylinderRadius,\n      radiusTubular: 0.01,\n      segmentsRadial: 16,\n      segmentsTubular: 18\n    });\n    this.torus.setAttribute(\"rotation\", { x: 90, y: 0, z: 0 });\n    this.torus.setAttribute(\"material\", {\n      shader: \"flat\",\n      color: data.hitCylinderColor,\n      side: \"double\",\n      depthTest: false\n    });\n    hitEntity.appendChild(this.torus);\n\n    // Cylinder.\n    this.cylinder = document.createElement(\"a-entity\");\n    this.cylinder.setAttribute(\"position\", { x: 0, y: data.hitCylinderHeight / 2, z: 0 });\n    if (window.createImageBitmap !== undefined) {\n      this.cylinder.setAttribute(\"rotation\", { x: 0, y: 0, z: 180 });\n    }\n    this.cylinder.setAttribute(\"geometry\", {\n      primitive: \"cylinder\",\n      segmentsHeight: 1,\n      radius: data.hitCylinderRadius,\n      height: data.hitCylinderHeight,\n      openEnded: true\n    });\n    this.cylinder.setAttribute(\"material\", {\n      shader: \"flat\",\n      color: data.hitCylinderColor,\n      side: \"double\",\n      src: CYLINDER_TEXTURE,\n      transparent: true,\n      depthTest: false\n    });\n    hitEntity.appendChild(this.cylinder);\n\n    // create another torus for animating when the hit destination is ready to go\n    this.outerTorus = document.createElement(\"a-entity\");\n    this.outerTorus.setAttribute(\"geometry\", {\n      primitive: \"torus\",\n      radius: data.outerRadius,\n      radiusTubular: 0.01,\n      segmentsRadial: 16,\n      segmentsTubular: 18\n    });\n    this.outerTorus.setAttribute(\"rotation\", { x: 90, y: 0, z: 0 });\n    this.outerTorus.setAttribute(\"material\", {\n      shader: \"flat\",\n      color: data.hitCylinderColor,\n      side: \"double\",\n      opacity: HIT_OPACITY,\n      depthTest: false\n    });\n    this.outerTorus.setAttribute(\"id\", \"outerTorus\");\n    hitEntity.appendChild(this.outerTorus);\n\n    return hitEntity;\n  }\n});\n","export const sets = {};\nsets.global = \"global\";\nsets.inputFocused = \"inputFocused\";\nsets.cursorHoveringOnPen = \"cursorHoveringOnPen\";\nsets.cursorHoveringOnCamera = \"cursorHoveringOnCamera\";\nsets.cursorHoveringOnInteractable = \"cursorHoveringOnInteractable\";\nsets.cursorHoveringOnUI = \"cursorHoveringOnUI\";\nsets.cursorHoveringOnVideo = \"cursorHoveringOnVideo\";\nsets.cursorHoveringOnNothing = \"cursorHoveringOnNothing\";\nsets.cursorHoldingPen = \"cursorHoldingPen\";\nsets.cursorHoldingCamera = \"cursorHoldingCamera\";\nsets.cursorHoldingInteractable = \"cursorHoldingInteractable\";\nsets.cursorHoldingUI = \"cursorHoldingUI\";\nsets.rightHandTeleporting = \"rightHandTeleporting\";\nsets.rightHandHoveringOnPen = \"rightHandHoveringOnPen\";\nsets.rightHandHoveringOnCamera = \"rightHandHoveringOnCamera\";\nsets.rightHandHoveringOnInteractable = \"rightHandHoveringOnInteractable\";\nsets.rightHandHoveringOnNothing = \"rightHandHoveringOnNothing\";\nsets.rightHandHoldingPen = \"rightHandHoldingPen\";\nsets.rightHandHoldingCamera = \"rightHandHoldingCamera\";\nsets.rightHandHoldingInteractable = \"rightHandHoldingInteractable\";\nsets.leftHandTeleporting = \"leftHandTeleporting\";\nsets.leftHandHoveringOnPen = \"leftHandHoveringOnPen\";\nsets.leftHandHoveringOnCamera = \"leftHandHoveringOnCamera\";\nsets.leftHandHoveringOnInteractable = \"leftHandHoveringOnInteractable\";\nsets.leftHandHoldingPen = \"leftHandHoldingPen\";\nsets.leftHandHoldingCamera = \"leftHandHoldingCamera\";\nsets.leftHandHoldingInteractable = \"leftHandHoldingInteractable\";\nsets.leftHandHoveringOnNothing = \"leftHandHoveringOnNothing\";\n","const { detect } = require(\"detect-browser\");\n\nconst browser = detect();\n\n// Precision on device detection is fuzzy -- we can sometimes know if a device is definitely\n// available, or definitely *not* available, and assume it may be available otherwise.\nexport const VR_DEVICE_AVAILABILITY = {\n  yes: \"yes\", // Implies VR can be launched into on this device immediately, in this browser\n  no: \"no\", // Implies this VR device is definitely not supported regardless of browser\n  maybe: \"maybe\" // Implies this device may support this VR platform, but may not be installed or in a compatible browser\n};\n\nfunction isMaybeGearVRCompatibleDevice(ua) {\n  return /\\WAndroid\\W/.test(ua);\n}\n\nfunction isMaybeDaydreamCompatibleDevice(ua) {\n  return /\\WAndroid\\W/.test(ua);\n}\n\n// Blacklist of VR device name regex matchers that we do not want to consider as valid VR devices\n// that can be entered into as a \"generic\" entry flow.\nconst GENERIC_ENTRY_TYPE_DEVICE_BLACKLIST = [/cardboard/i];\n\n// Tries to determine VR entry compatibility regardless of the current browser.\n//\n// For each VR \"entry type\", returns VR_DEVICE_AVAILABILITY.yes if that type can be launched into directly from this browser\n// on this device, returns VR_DEVICE_AVAILABILITY.no if that type is known to not be possible to ever use on this device no matter what,\n// and VR_DEVICE_AVAILABILITY.maybe if the device potentially could support that type if a different browser was running, or if\n// the software was setup, an HMD was purchased, etc.\n//\n// When \"yes\" or \"maybe\", we should present the option. If \"maybe\", when chosen try to get them into a compatible browser.\n// Once in a compatible browser, we should assume it will work (if it doesn't, it's because they don't have the headset,\n// haven't installed the software, our guess about their phone was wrong, etc.)\n//\n// At the time of this writing there are the following VR \"entry types\" that will be validated by this method:\n//\n// - screen: Enter \"on-screen\" in 2D\n// - generic: Generic WebVR (platform/OS agnostic indicator if a general 'Enter VR' option should be presented.)\n// - daydream: Google Daydream\n// - gearvr: Oculus GearVR\n// - cardboard: Google Cardboard\n//\nexport async function getAvailableVREntryTypes() {\n  const ua = navigator.userAgent;\n  const isSamsungBrowser = browser.name === \"chrome\" && /SamsungBrowser/.test(ua);\n  const isMobile = AFRAME.utils.device.isMobile();\n  const isMobileVR = AFRAME.utils.device.isMobileVR();\n\n  // This needs to be kept up-to-date with the latest browsers that can support VR and Hubs.\n  // Checking for navigator.getVRDisplays always passes b/c of polyfill.\n  const isWebVRCapableBrowser = window.hasNativeWebVRImplementation;\n\n  const isDaydreamCapableBrowser = !!(isWebVRCapableBrowser && browser.name === \"chrome\" && !isSamsungBrowser);\n  const isIDevice = AFRAME.utils.device.isIOS();\n  const isFirefoxBrowser = browser.name === \"firefox\";\n  const isUIWebView = typeof navigator.mediaDevices === \"undefined\";\n\n  const safari = isIDevice\n    ? !isUIWebView\n      ? VR_DEVICE_AVAILABILITY.yes\n      : VR_DEVICE_AVAILABILITY.maybe\n    : VR_DEVICE_AVAILABILITY.no;\n\n  const isCardboardCapableBrowser = !!(isMobile && !isIDevice && browser.name === \"chrome\" && !isSamsungBrowser);\n\n  let displays = [];\n  try {\n    // Skip getVRDisplays on desktop Chrome since the API is in a broken state there.\n    // See https://github.com/mozilla/hubs/issues/892\n    if (browser.name !== \"chrome\" || isMobile) {\n      // We pull the displays on non-WebVR capable mobile browsers so we can pick up cardboard.\n      displays = isWebVRCapableBrowser || isCardboardCapableBrowser ? await navigator.getVRDisplays() : [];\n    }\n  } catch (e) {\n    console.warn(\"navigator.getVRDisplays() failed\", e);\n  }\n\n  const isOculusBrowser = /Oculus/.test(ua);\n\n  const screen = isMobileVR\n    ? VR_DEVICE_AVAILABILITY.no\n    : isIDevice && isUIWebView\n      ? VR_DEVICE_AVAILABILITY.maybe\n      : VR_DEVICE_AVAILABILITY.yes;\n\n  // HACK -- we prompt the user to install firefox if they click the VR button on a non-WebVR compatible\n  // browser. once we change this (ie when Chrome has VR support) then this check can be removed. Without this\n  // check if you have FF on Mac/Linux you'll get the confusing flow of having a VR button but then\n  // being asked to download FF.\n  const isNonWebVRFirefox = !isWebVRCapableBrowser && isFirefoxBrowser;\n  let generic = isMobile || isNonWebVRFirefox ? VR_DEVICE_AVAILABILITY.no : VR_DEVICE_AVAILABILITY.maybe;\n  let cardboard = VR_DEVICE_AVAILABILITY.no;\n\n  // We only consider GearVR support as \"maybe\" and never \"yes\". The only browser\n  // that will detect GearVR outside of VR is Samsung Internet, and we'd prefer to launch into Oculus\n  // Browser for now since Samsung Internet requires an additional WebVR installation + flag, so return \"maybe\".\n  //\n  // If we are in Oculus Browser (ie, we are literally wearing a GearVR) then return 'yes'.\n  let gearvr = VR_DEVICE_AVAILABILITY.no;\n  if (isMaybeGearVRCompatibleDevice(ua)) {\n    gearvr = isOculusBrowser ? VR_DEVICE_AVAILABILITY.yes : VR_DEVICE_AVAILABILITY.maybe;\n  }\n\n  // For daydream detection, we first check if they are on an Android compatible device, and assume they\n  // may support daydream *unless* this browser has WebVR capabilities, in which case we can do better.\n  let daydream =\n    isMaybeDaydreamCompatibleDevice(ua) && !isMobileVR ? VR_DEVICE_AVAILABILITY.maybe : VR_DEVICE_AVAILABILITY.no;\n\n  cardboard =\n    isCardboardCapableBrowser && displays.find(d => d.capabilities.canPresent && /cardboard/i.test(d.displayName))\n      ? VR_DEVICE_AVAILABILITY.yes\n      : VR_DEVICE_AVAILABILITY.no;\n\n  if (isWebVRCapableBrowser) {\n    // Generic is supported for non-blacklisted devices and presentable HMDs.\n    generic = displays.find(\n      d => d.capabilities.canPresent && !GENERIC_ENTRY_TYPE_DEVICE_BLACKLIST.find(r => r.test(d.displayName))\n    )\n      ? VR_DEVICE_AVAILABILITY.yes\n      : VR_DEVICE_AVAILABILITY.no;\n\n    // For daydream detection, in a WebVR browser we can increase confidence in daydream compatibility.\n    const hasDaydreamWebVRDevice = displays.find(d => /daydream/i.test(d.displayName));\n\n    if (hasDaydreamWebVRDevice) {\n      // If we detected daydream via WebVR\n      daydream = VR_DEVICE_AVAILABILITY.yes;\n      generic = VR_DEVICE_AVAILABILITY.no;\n    } else if (isDaydreamCapableBrowser) {\n      // If we didn't detect daydream in a daydream capable browser, we definitely can't run daydream at all.\n      daydream = VR_DEVICE_AVAILABILITY.no;\n    }\n  }\n\n  return { screen, generic, gearvr, daydream, cardboard, safari };\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { pushHistoryState, replaceHistoryState } from \"../utils/history\";\n\nfunction isModifiedEvent(event) {\n  return !!(event.metaKey || event.altKey || event.ctrlKey || event.shiftKey);\n}\n\n/**\n * A history-aware link that pushes/replaces the state, but not the path, in the browser history.\n */\nclass StateLink extends React.Component {\n  static propTypes = {\n    history: PropTypes.object,\n    innerRef: PropTypes.object,\n    replace: PropTypes.bool,\n    stateKey: PropTypes.string,\n    stateValue: PropTypes.string,\n    stateDetail: PropTypes.object,\n    target: PropTypes.string,\n    onClick: PropTypes.func,\n    children: PropTypes.node,\n    className: PropTypes.string\n  };\n\n  async handleClick(event, history) {\n    if (this.props.onClick) this.props.onClick(event);\n\n    if (\n      !event.defaultPrevented && // onClick prevented default\n      event.button === 0 && // ignore everything but left clicks\n      (!this.props.target || this.props.target === \"_self\") && // let browser handle \"target=_blank\" etc.\n      !isModifiedEvent(event) // ignore clicks with modifier keys\n    ) {\n      event.preventDefault();\n      const method = this.props.replace ? replaceHistoryState : pushHistoryState;\n      method(history, this.props.stateKey, this.props.stateValue, this.props.stateDetail);\n    }\n  }\n\n  render() {\n    const { innerRef, target, className, children } = this.props;\n    return (\n      <a\n        target={target}\n        className={className}\n        onClick={event => this.handleClick(event, this.props.history)}\n        href=\"#\"\n        ref={innerRef}\n      >\n        {children}\n      </a>\n    );\n  }\n}\n\nexport default StateLink;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Route } from \"react-router\";\n\n/**\n * A react-router Route that looks for a key/value pair in the state to render something.\n */\nclass StateRoute extends React.Component {\n  static propTypes = {\n    stateKey: PropTypes.string,\n    stateValue: PropTypes.string,\n    history: PropTypes.object\n  };\n\n  render() {\n    const { history, stateKey, stateValue, ...routeProps } = this.props;\n\n    if (\n      (!history.location.state && !stateValue) ||\n      (history.location.state &&\n        (history.location.state[stateKey] === stateValue || (!history.location.state[stateKey] && !stateValue)))\n    ) {\n      return <Route path=\"/\" {...routeProps} />;\n    }\n\n    return null;\n  }\n}\n\nexport default StateRoute;\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport DialogContainer from \"./dialog-container.js\";\nimport styles from \"../assets/stylesheets/client-info-dialog.scss\";\nimport { FormattedMessage } from \"react-intl\";\nimport { sluglessPath } from \"../utils/history\";\nimport { getAvatarThumbnailUrl } from \"../utils/avatar-utils\";\n\nexport function getClientInfoClientId(location) {\n  const { search } = location;\n  const urlParams = new URLSearchParams(search);\n  const pathname = sluglessPath(location);\n\n  if (!pathname.startsWith(\"/client\") && !urlParams.get(\"client_id\")) return null;\n  return urlParams.get(\"client_id\") || pathname.substring(9);\n}\n\nexport default class ClientInfoDialog extends Component {\n  static propTypes = {\n    clientId: PropTypes.string,\n    history: PropTypes.object,\n    hubChannel: PropTypes.object,\n    presences: PropTypes.object,\n    performConditionalSignIn: PropTypes.func,\n    onClose: PropTypes.func\n  };\n\n  state = {\n    avatarThumbnailUrl: null\n  };\n\n  kick() {\n    const { clientId, performConditionalSignIn, hubChannel, onClose } = this.props;\n\n    performConditionalSignIn(\n      () => hubChannel.can(\"kick_users\"),\n      async () => await hubChannel.kick(clientId),\n      \"kick-user\"\n    );\n\n    onClose();\n  }\n\n  hide() {\n    const { clientId, onClose, hubChannel } = this.props;\n    hubChannel.hide(clientId);\n    onClose();\n  }\n\n  mute() {\n    const { clientId, performConditionalSignIn, hubChannel, onClose } = this.props;\n\n    performConditionalSignIn(\n      () => hubChannel.can(\"mute_users\"),\n      async () => await hubChannel.mute(clientId),\n      \"mute-user\"\n    );\n\n    onClose();\n  }\n\n  unhide() {\n    const { clientId, hubChannel, onClose } = this.props;\n    hubChannel.unhide(clientId);\n    onClose();\n  }\n\n  getPresenceProfile() {\n    if (!this.props.presences) return null;\n\n    const presence = Object.entries(this.props.presences).find(([k]) => k === this.props.clientId);\n    if (!presence) return null;\n\n    const metas = presence[1].metas;\n    return metas[metas.length - 1].profile;\n  }\n\n  componentDidMount() {\n    const { avatarId } = this.getPresenceProfile();\n    if (avatarId) {\n      getAvatarThumbnailUrl(avatarId).then(avatarThumbnailUrl => this.setState({ avatarThumbnailUrl }));\n    }\n  }\n\n  render() {\n    const profile = this.getPresenceProfile();\n    if (!profile) return null;\n\n    const { displayName, communityIdentifier } = profile;\n    const { hubChannel, clientId, onClose } = this.props;\n    const title = (\n      <div className={styles.title}>\n        {displayName}\n        <div className={styles.communityIdentifier}>{communityIdentifier}</div>\n      </div>\n    );\n    const mayKick = hubChannel.canOrWillIfCreator(\"kick_users\");\n    const mayMute = hubChannel.canOrWillIfCreator(\"mute_users\");\n    const isHidden = hubChannel.isHidden(clientId);\n\n    return (\n      <DialogContainer className={styles.clientInfoDialog} title={title} wide={true} {...this.props}>\n        <div className={styles.roomInfo}>\n          <div className={styles.clientProfileImage}>\n            <img src={this.state.avatarThumbnailUrl} />\n          </div>\n          <div className={styles.clientActionButtons}>\n            {!isHidden && (\n              <button onClick={() => this.hide()}>\n                <FormattedMessage id=\"client-info.hide-button\" />\n              </button>\n            )}\n            {isHidden && (\n              <button onClick={() => this.unhide()}>\n                <FormattedMessage id=\"client-info.unhide-button\" />\n              </button>\n            )}\n            {mayMute && (\n              <button onClick={() => this.mute()}>\n                <FormattedMessage id=\"client-info.mute-button\" />\n              </button>\n            )}\n            {mayKick && (\n              <button onClick={() => this.kick()}>\n                <FormattedMessage id=\"client-info.kick-button\" />\n              </button>\n            )}\n            <button className={styles.cancel} onClick={onClose}>\n              <FormattedMessage id=\"client-info.cancel\" />\n            </button>\n          </div>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { IntlProvider, FormattedMessage } from \"react-intl\";\nimport { lang, messages } from \"../utils/i18n\";\nimport loaderStyles from \"../assets/stylesheets/loader.scss\";\n\nclass Loader extends Component {\n  static propTypes = {\n    scene: PropTypes.object,\n    finished: PropTypes.bool,\n    onLoaded: PropTypes.func\n  };\n\n  doneWithInitialLoad = false;\n  state = {\n    loadingNum: 0,\n    loadedNum: 0\n  };\n\n  componentDidMount() {\n    this.props.scene.addEventListener(\"model-loading\", this.onObjectLoading);\n    this.props.scene.addEventListener(\"image-loading\", this.onObjectLoading);\n    this.props.scene.addEventListener(\"model-loaded\", this.onObjectLoaded);\n    this.props.scene.addEventListener(\"image-loaded\", this.onObjectLoaded);\n    this.props.scene.addEventListener(\"model-error\", this.onObjectLoaded);\n    this.props.scene.addEventListener(\n      \"environment-scene-loaded\",\n      () => {\n        this.environmentSceneLoaded = true;\n        this.tryFinishLoading();\n      },\n      { once: true }\n    );\n  }\n\n  componentWillUnmount() {\n    this.props.scene.removeEventListener(\"model-loading\", this.onObjectLoading);\n    this.props.scene.removeEventListener(\"image-loading\", this.onObjectLoading);\n    this.props.scene.removeEventListener(\"model-loaded\", this.onObjectLoaded);\n    this.props.scene.removeEventListener(\"image-loaded\", this.onObjectLoaded);\n    this.props.scene.removeEventListener(\"model-error\", this.onObjectLoaded);\n  }\n\n  onObjectLoading = () => {\n    if (!this.doneWithInitialLoad && this.loadingTimeout) {\n      window.clearTimeout(this.loadingTimeout);\n      this.loadingTimeout = null;\n    }\n\n    this.setState(state => {\n      return { loadingNum: state.loadingNum + 1 };\n    });\n  };\n\n  onObjectLoaded = () => {\n    this.setState(state => {\n      return { loadedNum: state.loadedNum + 1 };\n    });\n\n    this.tryFinishLoading();\n  };\n\n  tryFinishLoading = () => {\n    if (!this.doneWithInitialLoad && this.loadingTimeout) window.clearTimeout(this.loadingTimeout);\n\n    if (this.environmentSceneLoaded) {\n      this.loadingTimeout = window.setTimeout(() => {\n        this.doneWithInitialLoad = true;\n        if (this.props.onLoaded) {\n          this.props.onLoaded();\n        }\n      }, 1500);\n    }\n  };\n\n  render() {\n    const nomore = (\n      <h4 className={loaderStyles.loadingText}>\n        <FormattedMessage id=\"loader.entering_lobby\" />\n      </h4>\n    );\n    const progress = this.state.loadingNum === 0 ? \" \" : `${this.state.loadedNum} / ${this.state.loadingNum} `;\n    const usual = (\n      <h4 className={loaderStyles.loadingText}>\n        <FormattedMessage id=\"loader.loading\" />\n        {progress}\n        <FormattedMessage id={this.state.loadingNum !== 1 ? \"loader.objects\" : \"loader.object\"} />\n        ...\n      </h4>\n    );\n    return (\n      <IntlProvider locale={lang} messages={messages}>\n        <div className=\"loading-panel\">\n          <img className=\"loading-panel__logo\" src=\"../assets/images/hub-preview-light-no-shadow.png\" />\n\n          {this.props.finished ? nomore : usual}\n\n          <div className=\"loader-wrap loader-bottom\">\n            <div className=\"loader\">\n              <div className=\"loader-center\" />\n            </div>\n          </div>\n        </div>\n      </IntlProvider>\n    );\n  }\n}\n\nexport default Loader;\n","import React from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport PropTypes from \"prop-types\";\n\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nconst AutoExitWarning = props => (\n  <div className=\"autoexit-panel\">\n    <div className=\"autoexit-panel__title\">\n      <FormattedMessage id=\"autoexit.title\" />\n      <span>{props.secondsRemaining}</span>\n      <FormattedMessage id=\"autoexit.title_units\" />\n    </div>\n    <div className=\"autoexit-panel__subtitle\">\n      <FormattedMessage id=\"autoexit.subtitle\" />\n    </div>\n    <WithHoverSound>\n      <div className=\"autoexit-panel__cancel-button\" onClick={props.onCancel}>\n        <FormattedMessage id=\"autoexit.cancel\" />\n      </div>\n    </WithHoverSound>\n  </div>\n);\n\nAutoExitWarning.propTypes = {\n  secondsRemaining: PropTypes.number,\n  onCancel: PropTypes.func\n};\n\nexport default AutoExitWarning;\n","import React from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport PropTypes from \"prop-types\";\n\nimport MobileScreenEntryImg from \"../assets/images/mobile_screen_entry.svg\";\nimport DesktopScreenEntryImg from \"../assets/images/desktop_screen_entry.svg\";\nimport GenericVREntryImg from \"../assets/images/generic_vr_entry.svg\";\nimport GearVREntryImg from \"../assets/images/gearvr_entry.svg\";\nimport DaydreamEntryImg from \"../assets/images/daydream_entry.svg\";\nimport DeviceEntryImg from \"../assets/images/device_entry.svg\";\nimport styles from \"../assets/stylesheets/entry.scss\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\nimport cx from \"classnames\";\n\nconst EntryButton = props => {\n  return (\n    <WithHoverSound>\n      <button\n        className={cx([{ [styles.entryButton]: true, [styles.entryButtonSecondary]: props.secondary }])}\n        onClick={props.onClick}\n      >\n        <img src={props.iconSrc} className={styles.icon} />\n        <div className={styles.label}>\n          <div className={styles.contents}>\n            <span>\n              <FormattedMessage id={props.prefixMessageId} />\n            </span>\n            <span className={styles.bolded}>\n              <FormattedMessage id={props.mediumMessageId} />\n            </span>\n            {props.subtitle && (\n              <div className={styles.subtitle}>\n                <FormattedMessage id={props.subtitle} />\n              </div>\n            )}\n          </div>\n        </div>\n      </button>\n    </WithHoverSound>\n  );\n};\n\nEntryButton.propTypes = {\n  onClick: PropTypes.func,\n  iconSrc: PropTypes.string,\n  secondary: PropTypes.bool,\n  prefixMessageId: PropTypes.string,\n  mediumMessageId: PropTypes.string,\n  subtitle: PropTypes.string,\n  isInHMD: PropTypes.bool\n};\n\nconst isMobile = AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR();\n\nexport const TwoDEntryButton = props => {\n  const entryButtonProps = {\n    ...props,\n    iconSrc: isMobile ? MobileScreenEntryImg : DesktopScreenEntryImg,\n    prefixMessageId: \"entry.screen-prefix\",\n    mediumMessageId: isMobile ? \"entry.mobile-screen\" : \"entry.desktop-screen\"\n  };\n\n  return <EntryButton {...entryButtonProps} />;\n};\n\nexport const GenericEntryButton = props => {\n  const entryButtonProps = {\n    ...props,\n    iconSrc: GenericVREntryImg,\n    prefixMessageId: \"entry.generic-prefix\",\n    mediumMessageId: \"entry.generic-medium\",\n    subtitle: isMobile ? null : \"entry.generic-subtitle-desktop\"\n  };\n\n  return <EntryButton {...entryButtonProps} />;\n};\n\nexport const GearVREntryButton = props => {\n  const entryButtonProps = {\n    ...props,\n    iconSrc: GearVREntryImg,\n    prefixMessageId: \"entry.gearvr-prefix\",\n    mediumMessageId: \"entry.gearvr-medium\"\n  };\n\n  return <EntryButton {...entryButtonProps} />;\n};\n\nexport const DaydreamEntryButton = props => {\n  const entryButtonProps = {\n    ...props,\n    iconSrc: DaydreamEntryImg,\n    prefixMessageId: \"entry.daydream-prefix\",\n    mediumMessageId: \"entry.daydream-medium\"\n  };\n\n  return <EntryButton {...entryButtonProps} />;\n};\n\nexport const SafariEntryButton = props => {\n  const entryButtonProps = {\n    ...props,\n    iconSrc: MobileScreenEntryImg,\n    prefixMessageId: \"entry.screen-prefix\",\n    mediumMessageId: \"entry.mobile-safari\"\n  };\n\n  return <EntryButton {...entryButtonProps} />;\n};\n\nexport const DeviceEntryButton = props => {\n  const entryButtonProps = {\n    ...props,\n    iconSrc: DeviceEntryImg,\n    prefixMessageId: isMobile ? \"entry.device-prefix-mobile\" : \"entry.device-prefix-desktop\",\n    mediumMessageId: \"entry.device-medium\"\n  };\n\n  entryButtonProps.subtitle = entryButtonProps.isInHMD\n    ? \"entry.device-subtitle-vr\"\n    : isMobile\n      ? \"entry.device-subtitle-mobile\"\n      : \"entry.device-subtitle-desktop\";\n\n  return <EntryButton {...entryButtonProps} />;\n};\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { injectIntl, FormattedMessage } from \"react-intl\";\nimport classNames from \"classnames\";\nimport { faPencilAlt } from \"@fortawesome/free-solid-svg-icons/faPencilAlt\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nimport { SCHEMA } from \"../storage/store\";\nimport styles from \"../assets/stylesheets/profile.scss\";\nimport hubLogo from \"../assets/images/hub-preview-white.png\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\nimport { AVATAR_TYPES, getAvatarGltfUrl, getAvatarType } from \"../utils/avatar-utils\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\nimport { replaceHistoryState } from \"../utils/history\";\nimport { proxiedUrlFor } from \"../utils/media-utils\";\nimport StateLink from \"./state-link\";\n\nimport AvatarPreview from \"./avatar-preview\";\n\nclass ProfileEntryPanel extends Component {\n  static propTypes = {\n    displayNameOverride: PropTypes.string,\n    store: PropTypes.object,\n    mediaSearchStore: PropTypes.object,\n    messages: PropTypes.object,\n    finished: PropTypes.func,\n    intl: PropTypes.object,\n    history: PropTypes.object,\n    avatarId: PropTypes.string\n  };\n\n  state = {\n    avatarId: null,\n    avatarType: null,\n    displayName: null,\n    avatarGltfUrl: null\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = this.getStateFromProfile();\n    if (props.avatarId) {\n      this.state.avatarId = props.avatarId;\n      this.state.avatarType = getAvatarType(this.state.avatarId);\n    }\n    this.props.store.addEventListener(\"statechanged\", this.storeUpdated);\n    this.scene = document.querySelector(\"a-scene\");\n  }\n\n  getStateFromProfile = () => {\n    const { displayName, avatarId } = this.props.store.state.profile;\n    const avatarType = getAvatarType(avatarId);\n    const newState = { displayName, avatarId, avatarType };\n    if (avatarType === AVATAR_TYPES.URL) {\n      newState.avatarGltfUrl = proxiedUrlFor(avatarId);\n    }\n    return newState;\n  };\n\n  storeUpdated = () => this.setState(this.getStateFromProfile());\n\n  saveStateAndFinish = e => {\n    e && e.preventDefault();\n\n    const { displayName } = this.props.store.state.profile;\n    const { hasChangedName } = this.props.store.state.activity;\n\n    const hasChangedNowOrPreviously = hasChangedName || this.state.displayName !== displayName;\n    this.props.store.update({\n      activity: {\n        hasChangedName: hasChangedNowOrPreviously,\n        hasAcceptedProfile: true\n      },\n      profile: {\n        displayName: this.state.displayName,\n        avatarId: this.state.avatarId\n      }\n    });\n    this.props.finished();\n  };\n\n  stopPropagation = e => {\n    e.stopPropagation();\n  };\n\n  setAvatarFromMediaResult = ({ detail: entry }) => {\n    this.setState({\n      avatarId: entry.id,\n      avatarType: getAvatarType(entry.id),\n      avatarGltfUrl: entry.gltfs.avatar\n    });\n    // Replace history state with the current avatar id since this component gets destroyed when we open the\n    // avatar editor and we want the back button to work. We read the history state back via the avatarId prop.\n    // We read the current state key from history since it could be \"overlay\" or \"entry_step\".\n    replaceHistoryState(this.props.history, this.props.history.location.state.key, \"profile\", { avatarId: entry.id });\n  };\n\n  async componentDidMount() {\n    this.setState({ avatarGltfUrl: await getAvatarGltfUrl(this.state.avatarId) });\n    if (this.nameInput) {\n      // stop propagation so that avatar doesn't move when wasd'ing during text input.\n      this.nameInput.addEventListener(\"keydown\", this.stopPropagation);\n      this.nameInput.addEventListener(\"keypress\", this.stopPropagation);\n      this.nameInput.addEventListener(\"keyup\", this.stopPropagation);\n    }\n    this.scene.addEventListener(\"action_selected_media_result_entry\", this.setAvatarFromMediaResult);\n  }\n\n  componentWillUnmount() {\n    this.props.store.removeEventListener(\"statechanged\", this.storeUpdated);\n    if (this.nameInput) {\n      this.nameInput.removeEventListener(\"keydown\", this.stopPropagation);\n      this.nameInput.removeEventListener(\"keypress\", this.stopPropagation);\n      this.nameInput.removeEventListener(\"keyup\", this.stopPropagation);\n    }\n    this.scene.removeEventListener(\"action_selected_media_result_entry\", this.setAvatarFromMediaResult);\n  }\n\n  render() {\n    const { formatMessage } = this.props.intl;\n\n    return (\n      <div className={styles.profileEntry}>\n        <form onSubmit={this.saveStateAndFinish} className={styles.form}>\n          <div className={classNames([styles.box, styles.darkened])}>\n            <label htmlFor=\"#profile-entry-display-name\" className={styles.title}>\n              <FormattedMessage id=\"profile.header\" />\n            </label>\n            {this.props.displayNameOverride ? (\n              <span className={styles.displayName}>{this.props.displayNameOverride}</span>\n            ) : (\n              <input\n                id=\"profile-entry-display-name\"\n                className={styles.formFieldText}\n                value={this.state.displayName}\n                onFocus={e => handleTextFieldFocus(e.target)}\n                onBlur={() => handleTextFieldBlur()}\n                onChange={e => this.setState({ displayName: e.target.value })}\n                required\n                spellCheck=\"false\"\n                pattern={SCHEMA.definitions.profile.properties.displayName.pattern}\n                title={formatMessage({ id: \"profile.display_name.validation_warning\" })}\n                ref={inp => (this.nameInput = inp)}\n              />\n            )}\n\n            <a\n              className={styles.chooseAvatar}\n              onClick={() => this.props.mediaSearchStore.sourceNavigateWithNoNav(\"avatars\")}\n            >\n              <FormattedMessage id=\"profile.choose_avatar\" />\n            </a>\n\n            <div className={styles.preview}>\n              <AvatarPreview avatarGltfUrl={this.state.avatarGltfUrl} />\n\n              {this.state.avatarType === AVATAR_TYPES.SKINNABLE && (\n                <StateLink\n                  stateKey=\"overlay\"\n                  stateValue=\"avatar-editor\"\n                  stateDetail={{ avatarId: this.state.avatarId, hideDelete: true, returnToProfile: true }}\n                  history={this.props.history}\n                  className={styles.editAvatar}\n                >\n                  <FontAwesomeIcon icon={faPencilAlt} />\n                </StateLink>\n              )}\n            </div>\n\n            <WithHoverSound>\n              <input className={styles.formSubmit} type=\"submit\" value={formatMessage({ id: \"profile.save\" })} />\n            </WithHoverSound>\n            <div className={styles.links}>\n              <WithHoverSound>\n                <a\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  href=\"https://github.com/mozilla/hubs/blob/master/TERMS.md\"\n                >\n                  <FormattedMessage id=\"profile.terms_of_use\" />\n                </a>\n              </WithHoverSound>\n\n              <WithHoverSound>\n                <a\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  href=\"https://github.com/mozilla/hubs/blob/master/PRIVACY.md\"\n                >\n                  <FormattedMessage id=\"profile.privacy_notice\" />\n                </a>\n              </WithHoverSound>\n            </div>\n          </div>\n        </form>\n        <img className={styles.logo} src={hubLogo} />\n      </div>\n    );\n  }\n}\n\nexport default injectIntl(ProfileEntryPanel);\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { injectIntl, FormattedMessage } from \"react-intl\";\nimport classNames from \"classnames\";\nimport { faAngleLeft } from \"@fortawesome/free-solid-svg-icons/faAngleLeft\";\nimport { faAngleRight } from \"@fortawesome/free-solid-svg-icons/faAngleRight\";\nimport { faSearch } from \"@fortawesome/free-solid-svg-icons/faSearch\";\nimport { faCloudUploadAlt } from \"@fortawesome/free-solid-svg-icons/faCloudUploadAlt\";\nimport { faLink } from \"@fortawesome/free-solid-svg-icons/faLink\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport { faExternalLinkAlt } from \"@fortawesome/free-solid-svg-icons/faExternalLinkAlt\";\nimport { faPencilAlt } from \"@fortawesome/free-solid-svg-icons/faPencilAlt\";\nimport { faPlus } from \"@fortawesome/free-solid-svg-icons/faPlus\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nimport styles from \"../assets/stylesheets/media-browser.scss\";\nimport { scaledThumbnailUrlFor } from \"../utils/media-utils\";\nimport { pushHistoryPath, pushHistoryState, sluglessPath } from \"../utils/history\";\nimport { SOURCES } from \"../storage/media-search-store\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\nimport { showFullScreenIfWasFullScreen } from \"../utils/fullscreen\";\nimport StateLink from \"./state-link\";\n\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\n\nconst PUBLISHER_FOR_ENTRY_TYPE = {\n  sketchfab_model: \"Sketchfab\",\n  poly_model: \"Google Poly\",\n  twitch_stream: \"Twitch\"\n};\n\nconst PRIVACY_POLICY_LINKS = {\n  videos: \"https://privacy.microsoft.com/en-us/privacystatement\",\n  images: \"https://privacy.microsoft.com/en-us/privacystatement\",\n  gifs: \"https://tenor.com/legal-privacy\",\n  sketchfab: \"https://sketchfab.com/privacy\",\n  poly: \"https://policies.google.com/privacy\",\n  youtube: \"https://policies.google.com/privacy\",\n  twitch: \"https://www.twitch.tv/p/legal/privacy-policy/\"\n};\n\nconst DEFAULT_FACETS = {\n  sketchfab: [\n    { text: \"Animals\", params: { filter: \"animals-pets\" } },\n    { text: \"Architecture\", params: { filter: \"architecture\" } },\n    { text: \"Art\", params: { filter: \"art-abstract\" } },\n    { text: \"Vehicles\", params: { filter: \"cars-vehicles\" } },\n    { text: \"Characters\", params: { filter: \"characters-creatures\" } },\n    { text: \"Culture\", params: { filter: \"cultural-heritage-history\" } },\n    { text: \"Gadgets\", params: { filter: \"electronics-gadgets\" } },\n    { text: \"Fashion\", params: { filter: \"fashion-style\" } },\n    { text: \"Food\", params: { filter: \"food-drink\" } },\n    { text: \"Furniture\", params: { filter: \"furniture-home\" } },\n    { text: \"Music\", params: { filter: \"music\" } },\n    { text: \"Nature\", params: { filter: \"nature-plants\" } },\n    { text: \"News\", params: { filter: \"news-politics\" } },\n    { text: \"People\", params: { filter: \"people\" } },\n    { text: \"Places\", params: { filter: \"places-travel\" } },\n    { text: \"Science\", params: { filter: \"science-technology\" } },\n    { text: \"Sports\", params: { filter: \"sports-fitness\" } },\n    { text: \"Weapons\", params: { filter: \"weapons-military\" } }\n  ],\n  poly: [\n    { text: \"Animals\", params: { filter: \"animals\" } },\n    { text: \"Architecture\", params: { filter: \"architecture\" } },\n    { text: \"Art\", params: { filter: \"art\" } },\n    { text: \"Food\", params: { filter: \"food\" } },\n    { text: \"Nature\", params: { filter: \"nature\" } },\n    { text: \"Objects\", params: { filter: \"objects\" } },\n    { text: \"People\", params: { filter: \"people\" } },\n    { text: \"Scenes\", params: { filter: \"scenes\" } },\n    { text: \"Transport\", params: { filter: \"transport\" } }\n  ],\n  avatars: [\n    { text: \"Featured\", params: { filter: \"featured\" } },\n    { text: \"My Avatars\", params: { filter: \"my-avatars\" } }\n  ],\n  scenes: [{ text: \"Featured\", params: { filter: \"featured\" } }, { text: \"My Scenes\", params: { filter: \"my-scenes\" } }]\n};\n\nclass MediaBrowser extends Component {\n  static propTypes = {\n    mediaSearchStore: PropTypes.object,\n    history: PropTypes.object,\n    intl: PropTypes.object,\n    hubChannel: PropTypes.object,\n    onMediaSearchResultEntrySelected: PropTypes.func,\n    performConditionalSignIn: PropTypes.func\n  };\n\n  state = { query: \"\", facets: [], showNav: true, selectNextResult: false, clearStashedQueryOnClose: false };\n\n  constructor(props) {\n    super(props);\n    this.state = this.getStoreAndHistoryState(props);\n    this.props.mediaSearchStore.addEventListener(\"statechanged\", this.storeUpdated);\n    this.props.mediaSearchStore.addEventListener(\"sourcechanged\", this.sourceChanged);\n  }\n\n  componentDidMount() {}\n\n  componentWillUnmount() {\n    this.props.mediaSearchStore.removeEventListener(\"statechanged\", this.storeUpdated);\n    this.props.mediaSearchStore.removeEventListener(\"sourcechanged\", this.sourceChanged);\n  }\n\n  storeUpdated = () => {\n    const newState = this.getStoreAndHistoryState(this.props);\n    this.setState(newState);\n\n    if (this.state.selectNextResult) {\n      if (newState.result && newState.result.entries.length > 0) {\n        this.selectEntry(newState.result.entries[0]);\n      } else {\n        this.close();\n      }\n    }\n  };\n\n  sourceChanged = () => {\n    if (this.inputRef && !isMobile && !isMobileVR) {\n      this.inputRef.focus();\n    }\n  };\n\n  getUrlSource = searchParams =>\n    searchParams.get(\"media_source\") || sluglessPath(this.props.history.location).substring(7);\n\n  getStoreAndHistoryState = props => {\n    const searchParams = new URLSearchParams(props.history.location.search);\n    const result = props.mediaSearchStore.result;\n\n    const newState = { result, query: this.state.query || searchParams.get(\"q\") || \"\" };\n    const urlSource = this.getUrlSource(searchParams);\n    newState.showNav = !!(searchParams.get(\"media_nav\") !== \"false\");\n\n    if (result && result.suggestions && result.suggestions.length > 0) {\n      newState.facets = result.suggestions.map(s => {\n        return { text: s, params: { q: s } };\n      });\n    } else {\n      newState.facets = DEFAULT_FACETS[urlSource] || [];\n    }\n\n    return newState;\n  };\n\n  handleQueryUpdated = (query, forceNow) => {\n    this.setState({ result: null });\n\n    if (this._sendQueryTimeout) {\n      clearTimeout(this._sendQueryTimeout);\n      this._sendQueryTimeout = null;\n    }\n\n    if (forceNow) {\n      this.props.mediaSearchStore.filterQueryNavigate(\"\", query);\n    } else {\n      // Don't update search on every keystroke, but buffer for some ms.\n      this._sendQueryTimeout = setTimeout(() => {\n        // Drop filter for now, so entering text drops into \"search all\" mode\n        this.props.mediaSearchStore.filterQueryNavigate(\"\", query);\n        this._sendQueryTimeout = null;\n      }, 500);\n    }\n\n    this.setState({ query });\n  };\n\n  handleEntryClicked = (evt, entry) => {\n    evt.preventDefault();\n\n    if (!entry.lucky_query) {\n      this.selectEntry(entry);\n    } else {\n      // Entry has a pointer to another \"i'm feeling lucky\" query -- used for trending videos\n      //\n      // Also, mark the browser to clear the stashed query on close, since this is a temporary\n      // query we are running to get the result we want.\n      this.setState({ clearStashedQueryOnClose: true });\n      this.handleQueryUpdated(entry.lucky_query, true);\n    }\n  };\n\n  selectEntry = entry => {\n    if (!this.props.onMediaSearchResultEntrySelected) return;\n    this.props.onMediaSearchResultEntrySelected(entry);\n    this.close();\n  };\n\n  handleSourceClicked = source => {\n    this.props.mediaSearchStore.sourceNavigate(source);\n  };\n\n  handleFacetClicked = facet => {\n    const searchParams = this.getSearchClearedSearchParams(true, true);\n\n    for (const [k, v] of Object.entries(facet.params)) {\n      searchParams.set(k, v);\n    }\n\n    pushHistoryPath(this.props.history, this.props.history.location.pathname, searchParams.toString());\n  };\n\n  getSearchClearedSearchParams = (keepSource, keepNav) => {\n    return this.props.mediaSearchStore.getSearchClearedSearchParams(this.props.history.location, keepSource, keepNav);\n  };\n\n  pushExitMediaBrowserHistory = (stashLastSearchParams = true) => {\n    this.props.mediaSearchStore.pushExitMediaBrowserHistory(this.props.history, stashLastSearchParams);\n  };\n\n  showCustomMediaDialog = source => {\n    const isSceneApiType = source === \"scene_listings\" || source === \"scenes\";\n    // Note: The apiSource for avatars *is* actually singular. We should probably fix this on the backend.\n    const isAvatarApiType = source === \"avatar_listings\" || source === \"avatar\";\n    this.pushExitMediaBrowserHistory(!isAvatarApiType);\n    const dialog = isSceneApiType ? \"change_scene\" : isAvatarApiType ? \"avatar_url\" : \"create\";\n    pushHistoryState(this.props.history, \"modal\", dialog);\n  };\n\n  close = () => {\n    showFullScreenIfWasFullScreen();\n    const urlSource = this.getUrlSource(new URLSearchParams(this.props.history.location.search));\n    this.pushExitMediaBrowserHistory(urlSource !== \"avatars\");\n    if (this.state.clearStashedQueryOnClose) {\n      this.props.mediaSearchStore.clearStashedQuery();\n    }\n  };\n\n  handlePager = delta => {\n    this.setState({ result: null });\n    this.props.mediaSearchStore.pageNavigate(delta);\n    this.browserDiv.scrollTop = 0;\n  };\n\n  render() {\n    const { formatMessage } = this.props.intl;\n    const hasMeta = !!(this.state.result && this.state.result.meta);\n    const hasNext = !!(hasMeta && this.state.result.meta.next_cursor) || false;\n    const searchParams = new URLSearchParams(this.props.history.location.search);\n    const hasPrevious = searchParams.get(\"cursor\");\n    const urlSource = this.getUrlSource(searchParams);\n    const apiSource = (hasMeta && this.state.result.meta.source) || null;\n    const isVariableWidth = this.state.result && [\"bing_images\", \"tenor\"].includes(apiSource);\n    const isSceneApiType = apiSource === \"scene_listings\" || apiSource === \"scenes\";\n    // Note: The apiSource for avatars *is* actually singular. We should probably fix this on the backend.\n    const isAvatarApiType = apiSource === \"avatar_listings\" || apiSource === \"avatar\";\n    const showCustomOption = !isSceneApiType || this.props.hubChannel.canOrWillIfCreator(\"update_hub\");\n    const [createTileWidth, createTileHeight] = this.getTileDimensions(false, urlSource === \"avatars\");\n    const entries = (this.state.result && this.state.result.entries) || [];\n    const hideSearch = urlSource === \"avatars\";\n\n    // Don't render anything if we just did a feeling lucky query and are waiting on result.\n    if (this.state.selectNextResult) return <div />;\n    const handleCustomClicked = apiSource => {\n      if (isAvatarApiType) {\n        this.showCustomMediaDialog(apiSource);\n      } else {\n        this.props.performConditionalSignIn(\n          () => !isSceneApiType || this.props.hubChannel.can(\"update_hub\"),\n          () => this.showCustomMediaDialog(apiSource),\n          \"change-scene\"\n        );\n      }\n    };\n\n    return (\n      <div className={styles.mediaBrowser} ref={browserDiv => (this.browserDiv = browserDiv)}>\n        <div className={classNames([styles.box, styles.darkened])}>\n          <div className={classNames(styles.header, { [styles.noSearch]: hideSearch })}>\n            <div className={styles.headerLeft}>\n              <a onClick={() => this.close()}>\n                <i>\n                  <FontAwesomeIcon icon={faTimes} />\n                </i>\n              </a>\n            </div>\n            <div className={styles.headerCenter}>\n              {!hideSearch && (\n                <div className={styles.search}>\n                  <i>\n                    <FontAwesomeIcon icon={faSearch} />\n                  </i>\n                  <input\n                    type=\"text\"\n                    autoFocus={!isMobile && !isMobileVR}\n                    ref={r => (this.inputRef = r)}\n                    placeholder={formatMessage({\n                      id: `media-browser.search-placeholder.${urlSource}`\n                    })}\n                    onFocus={e => handleTextFieldFocus(e.target)}\n                    onBlur={() => handleTextFieldBlur()}\n                    onKeyDown={e => {\n                      if (e.key === \"Enter\" && e.ctrlKey) {\n                        if (entries.length > 0 && !this._sendQueryTimeout) {\n                          this.handleEntryClicked(e, entries[0]);\n                        } else if (this.state.query.trim() !== \"\") {\n                          this.handleQueryUpdated(this.state.query, true);\n                          this.setState({ selectNextResult: true });\n                        } else {\n                          this.close();\n                        }\n                      } else if (e.key === \"Escape\" || (e.key === \"Enter\" && isMobile)) {\n                        e.target.blur();\n                      }\n                    }}\n                    value={this.state.query}\n                    onChange={e => this.handleQueryUpdated(e.target.value)}\n                  />\n                </div>\n              )}\n              <div className={styles.engineAttribution}>\n                {urlSource !== \"scenes\" && (\n                  <div className={styles.engineAttributionContents}>\n                    <FormattedMessage id={`media-browser.powered_by.${urlSource}`} />\n                    {PRIVACY_POLICY_LINKS[urlSource] && (\n                      <a href={PRIVACY_POLICY_LINKS[urlSource]} target=\"_blank\" rel=\"noreferrer noopener\">\n                        <FormattedMessage id=\"media-browser.privacy_policy\" />\n                      </a>\n                    )}\n                  </div>\n                )}\n                {urlSource === \"scenes\" && (\n                  <div className={styles.engineAttributionContents}>\n                    <FormattedMessage id={`media-browser.powered_by.${urlSource}`} />\n                    <a href=\"/spoke\" target=\"_blank\" rel=\"noreferrer noopener\">\n                      <FormattedMessage id=\"media-browser.spoke\" />\n                    </a>\n                    |\n                    <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"/?report\">\n                      <FormattedMessage id=\"media-browser.report_issue\" />\n                    </a>\n                  </div>\n                )}\n              </div>\n            </div>\n            <div className={styles.headerRight}>\n              {showCustomOption && (\n                <a onClick={() => handleCustomClicked(apiSource)} className={styles.createButton}>\n                  <i>\n                    <FontAwesomeIcon icon={[\"scenes\", \"avatars\"].includes(urlSource) ? faLink : faCloudUploadAlt} />\n                  </i>\n                </a>\n              )}\n              {showCustomOption && (\n                <a onClick={() => handleCustomClicked(apiSource)} className={styles.createLink}>\n                  <FormattedMessage\n                    id={`media-browser.add_custom_${\n                      this.state.result && isSceneApiType ? \"scene\" : urlSource === \"avatars\" ? \"avatar\" : \"object\"\n                    }`}\n                  />\n                </a>\n              )}\n            </div>\n          </div>\n\n          {this.state.showNav && (\n            <div className={styles.nav}>\n              {SOURCES.map(s => (\n                <a\n                  onClick={() => this.handleSourceClicked(s)}\n                  key={s}\n                  className={classNames({ [styles.navSource]: true, [styles.navSourceSelected]: urlSource === s })}\n                >\n                  <FormattedMessage id={`media-browser.nav_title.${s}`} />\n                </a>\n              ))}\n              <div className={styles.navRightPad}>&nbsp;</div>\n              <div className={styles.navScrollArrow}>\n                <FontAwesomeIcon icon={faAngleRight} />\n              </div>\n            </div>\n          )}\n\n          {this.state.facets &&\n            this.state.facets.length > 0 && (\n              <div className={styles.facets}>\n                {this.state.facets.map((s, i) => (\n                  <a onClick={() => this.handleFacetClicked(s)} key={i} className={styles.facet}>\n                    {s.text}\n                  </a>\n                ))}\n              </div>\n            )}\n\n          <div className={styles.body}>\n            <div className={classNames({ [styles.tiles]: true, [styles.tilesVariable]: isVariableWidth })}>\n              {(urlSource === \"avatars\" || urlSource === \"scenes\") && (\n                <div\n                  style={{ width: `${createTileWidth}px`, height: `${createTileHeight}px` }}\n                  className={classNames(styles.tile, styles.createTile)}\n                >\n                  {urlSource === \"scenes\" ? (\n                    <a href=\"/spoke/new\" rel=\"noopener noreferrer\" target=\"_blank\" className={styles.tileLink}>\n                      <div className={styles.tileContent}>\n                        <FontAwesomeIcon icon={faPlus} />\n                        <FormattedMessage id=\"media-browser.create-scene\" />\n                      </div>\n                    </a>\n                  ) : (\n                    <a\n                      onClick={e => {\n                        e.preventDefault();\n                        window.dispatchEvent(new CustomEvent(\"action_create_avatar\"));\n                      }}\n                      className={styles.tileLink}\n                    >\n                      <div className={styles.tileContent}>\n                        <FontAwesomeIcon icon={faPlus} />\n                        <FormattedMessage id=\"media-browser.create-avatar\" />\n                      </div>\n                    </a>\n                  )}\n                </div>\n              )}\n\n              {entries.map(this.entryToTile)}\n            </div>\n\n            {this.state.result &&\n              (hasNext || hasPrevious) && (\n                <div className={styles.pager}>\n                  <a\n                    className={classNames({ [styles.previousPage]: true, [styles.pagerButtonDisabled]: !hasPrevious })}\n                    onClick={() => this.handlePager(-1)}\n                  >\n                    <FontAwesomeIcon icon={faAngleLeft} />\n                  </a>\n                  <div className={styles.pageNumber}>{this.state.result.meta.page}</div>\n                  <a\n                    className={classNames({ [styles.nextPage]: true, [styles.pagerButtonDisabled]: !hasNext })}\n                    onClick={() => this.handlePager(1)}\n                  >\n                    <FontAwesomeIcon icon={faAngleRight} />\n                  </a>\n                </div>\n              )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  getTileDimensions = (isImage, isAvatar, imageAspect) => {\n    // Doing breakpointing here, so we can have proper image placeholder based upon dynamic aspect ratio\n    const clientWidth = window.innerWidth;\n    let imageHeight = clientWidth < 1079 ? (clientWidth < 768 ? (clientWidth < 400 ? 85 : 100) : 150) : 200;\n    if (isAvatar) imageHeight = Math.floor(imageHeight * 1.5);\n\n    // Aspect ratio can vary per image if its an image result. Avatars are a taller portrait aspect, o/w assume 720p\n    let imageWidth;\n    if (isImage) {\n      imageWidth = Math.floor(Math.max(imageAspect * imageHeight, imageHeight * 0.85));\n    } else if (isAvatar) {\n      imageWidth = Math.floor((9 / 16) * imageHeight);\n    } else {\n      imageWidth = Math.floor(Math.max((16 / 9) * imageHeight, imageHeight * 0.85));\n    }\n\n    return [imageWidth, imageHeight];\n  };\n\n  entryToTile = (entry, idx) => {\n    const imageSrc = entry.images.preview.url;\n    const creator = entry.attributions && entry.attributions.creator;\n    const isImage = entry.type.endsWith(\"_image\");\n    const isAvatar = [\"avatar\", \"avatar_listing\"].includes(entry.type);\n    const imageAspect = entry.images.preview.width / entry.images.preview.height;\n\n    const [imageWidth, imageHeight] = this.getTileDimensions(isImage, isAvatar, imageAspect);\n\n    const publisherName =\n      (entry.attributions && entry.attributions.publisher && entry.attributions.publisher.name) ||\n      PUBLISHER_FOR_ENTRY_TYPE[entry.type];\n\n    return (\n      <div style={{ width: `${imageWidth}px` }} className={styles.tile} key={`${entry.id}_${idx}`}>\n        <a\n          href={entry.url}\n          target=\"_blank\"\n          rel=\"noreferrer noopener\"\n          onClick={e => this.handleEntryClicked(e, entry)}\n          className={styles.tileLink}\n          style={{ width: `${imageWidth}px`, height: `${imageHeight}px` }}\n        >\n          <img\n            className={classNames(styles.tileContent, styles.avatarTile)}\n            src={scaledThumbnailUrlFor(imageSrc, imageWidth, imageHeight)}\n          />\n        </a>\n        {entry.type === \"avatar\" && (\n          <StateLink\n            className={styles.editAvatar}\n            stateKey=\"overlay\"\n            stateValue=\"avatar-editor\"\n            stateDetail={{ avatarId: entry.id }}\n            history={this.props.history}\n          >\n            <FontAwesomeIcon icon={faPencilAlt} />\n          </StateLink>\n        )}\n        {!entry.type.endsWith(\"_image\") && (\n          <div className={styles.info}>\n            <a\n              href={entry.url}\n              target=\"_blank\"\n              rel=\"noreferrer noopener\"\n              className={styles.name}\n              onClick={e => this.handleEntryClicked(e, entry)}\n            >\n              {entry.name || \"\\u00A0\"}\n            </a>\n            {!isAvatar && (\n              <div className={styles.attribution}>\n                <div className={styles.creator}>\n                  {creator && creator.name === undefined && <span>{creator}</span>}\n                  {creator && creator.name && !creator.url && <span>{creator.name}</span>}\n                  {creator &&\n                    creator.name &&\n                    creator.url && (\n                      <a href={creator.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                        {creator.name}\n                      </a>\n                    )}\n                </div>\n                {publisherName && (\n                  <div className={styles.publisher}>\n                    <i>\n                      <FontAwesomeIcon icon={faExternalLinkAlt} />\n                    </i>\n                    &nbsp;<a href={entry.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                      {publisherName}\n                    </a>\n                  </div>\n                )}\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    );\n  };\n}\n\nexport default injectIntl(MediaBrowser);\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport giphyLogo from \"../assets/images/giphy_logo.png\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faPaperclip } from \"@fortawesome/free-solid-svg-icons/faPaperclip\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport styles from \"../assets/stylesheets/create-object-dialog.scss\";\nimport cx from \"classnames\";\nimport DialogContainer from \"./dialog-container.js\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nconst attributionHostnames = {\n  \"giphy.com\": giphyLogo,\n  \"media.giphy.com\": giphyLogo\n};\n\nconst DEFAULT_OBJECT_URL = \"https://asset-bundles-prod.reticulum.io/interactables/Ducky/DuckyMesh-438ff8e022.gltf\";\nconst isMobile = AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR();\nconst instructions = \"Paste a URL to an image, video, model, scene, or upload.\";\nconst desktopTips = \"Tip: You can paste URLs directly into Hubs with Ctrl+V\";\nconst references = (\n  <span>\n    For models, try{\" \"}\n    <a href=\"https://sketchfab.com/search?features=downloadable&type=models\" target=\"_blank\" rel=\"noopener noreferrer\">\n      Sketchfab\n    </a>,{\" \"}\n    <a href=\"http://poly.google.com/\" target=\"_blank\" rel=\"noopener noreferrer\">\n      Google Poly\n    </a>, or our{\" \"}\n    <a href=\"https://sketchfab.com/mozillareality\" target=\"_blank\" rel=\"noopener noreferrer\">\n      collection\n    </a>.\n  </span>\n);\n\nconst mobileInstructions = (\n  <div>\n    <p>{instructions}</p>\n    <p>{references}</p>\n  </div>\n);\nconst desktopInstructions = (\n  <div>\n    <p>{instructions}</p>\n    <p>{references}</p>\n    <p>{desktopTips}</p>\n  </div>\n);\n\nlet lastUrl = \"\";\nconst fileInputId = \"file-input\";\n\nexport default class CreateObjectDialog extends Component {\n  state = {\n    url: \"\",\n    file: null,\n    fileName: \"\"\n  };\n\n  static propTypes = {\n    onCreate: PropTypes.func,\n    onClose: PropTypes.func\n  };\n\n  componentDidMount() {\n    this.setState({ url: lastUrl });\n  }\n\n  componentWillUnmount() {\n    lastUrl = this.state.url;\n  }\n\n  onUrlChange = e => {\n    let attributionImage = this.state.attributionImage;\n    if (e.target && e.target.value && e.target.validity.valid) {\n      const url = new URL(e.target.value);\n      attributionImage = attributionHostnames[url.hostname];\n    }\n    this.setState({\n      url: e.target && e.target.value,\n      attributionImage: attributionImage\n    });\n  };\n\n  onFileChange = e => {\n    this.setState({\n      file: e.target.files[0],\n      fileName: e.target.files[0].name\n    });\n  };\n\n  reset = e => {\n    e.preventDefault();\n    this.setState({\n      url: \"\",\n      file: null,\n      fileName: \"\"\n    });\n    this.fileInput.value = null;\n  };\n\n  onCreateClicked = e => {\n    e.preventDefault();\n    this.props.onCreate(this.state.file || this.state.url || DEFAULT_OBJECT_URL);\n    this.props.onClose();\n  };\n\n  render() {\n    const { onCreate, onClose, ...other } = this.props; // eslint-disable-line no-unused-vars\n\n    const cancelButton = (\n      <WithHoverSound>\n        <label className={cx(styles.smallButton, styles.cancelIcon)} onClick={this.reset}>\n          <FontAwesomeIcon icon={faTimes} />\n        </label>\n      </WithHoverSound>\n    );\n    const uploadButton = (\n      <WithHoverSound>\n        <label htmlFor={fileInputId} className={cx(styles.smallButton, styles.uploadIcon)}>\n          <FontAwesomeIcon icon={faPaperclip} />\n        </label>\n      </WithHoverSound>\n    );\n    const filenameLabel = <label className={cx(styles.leftSideOfInput)}>{this.state.fileName}</label>;\n    const urlInput = (\n      <input\n        className={cx(styles.leftSideOfInput)}\n        placeholder=\"Image/Video/glTF URL\"\n        onFocus={e => handleTextFieldFocus(e.target)}\n        onBlur={() => handleTextFieldBlur()}\n        onChange={this.onUrlChange}\n        type=\"url\"\n        value={this.state.url}\n      />\n    );\n\n    return (\n      <DialogContainer title=\"Create Object\" onClose={this.props.onClose} {...other}>\n        <div>\n          {isMobile ? mobileInstructions : desktopInstructions}\n          <form onSubmit={this.onCreateClicked}>\n            <div className={styles.addMediaForm}>\n              <input\n                id={fileInputId}\n                ref={f => (this.fileInput = f)}\n                className={styles.hideFileInput}\n                type=\"file\"\n                onChange={this.onFileChange}\n              />\n              <div className={styles.inputBorder}>\n                {this.state.file ? filenameLabel : urlInput}\n                {this.state.url || this.state.fileName ? cancelButton : uploadButton}\n              </div>\n              <div className={styles.buttons}>\n                <WithHoverSound>\n                  <button className={styles.actionButton}>\n                    <span>Create</span>\n                  </button>\n                </WithHoverSound>\n              </div>\n              {this.state.attributionImage ? (\n                <div>\n                  <img src={this.state.attributionImage} />\n                </div>\n              ) : null}\n            </div>\n          </form>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"../assets/stylesheets/change-scene-dialog.scss\";\nimport cx from \"classnames\";\nimport DialogContainer from \"./dialog-container.js\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport default class ChangeSceneDialog extends Component {\n  state = {\n    url: \"\"\n  };\n\n  static propTypes = {\n    onChange: PropTypes.func,\n    onClose: PropTypes.func\n  };\n\n  onUrlChange = e => {\n    this.setState({\n      url: e.target && e.target.value\n    });\n  };\n\n  reset = e => {\n    e.preventDefault();\n    this.setState({ url: \"\" });\n  };\n\n  onChangeClicked = e => {\n    e.preventDefault();\n\n    if (this.state.url) {\n      this.props.onChange(this.state.url);\n    }\n\n    this.props.onClose();\n  };\n\n  render() {\n    const { onChange, onClose } = this.props; // eslint-disable-line no-unused-vars\n\n    return (\n      <DialogContainer title=\"Custom Scene\" onClose={this.props.onClose}>\n        <div>\n          <div>\n            <p>\n              Paste a URL to a{\" \"}\n              <a href=\"/spoke\" target=\"_blank\" rel=\"noopener noreferrer\">\n                Spoke\n              </a>{\" \"}\n              scene or a URL to a{\" \"}\n              <a href=\"https://en.wikipedia.org/wiki/GlTF#GLB\" target=\"_blank\" rel=\"noopener noreferrer\">\n                GLB\n              </a>.\n            </p>\n          </div>\n          <form onSubmit={this.onChangeClicked}>\n            <div className={styles.changeSceneForm}>\n              <div className={styles.inputBorder}>\n                <input\n                  className={cx(styles.leftSideOfInput)}\n                  placeholder=\"Scene URL\"\n                  onFocus={e => handleTextFieldFocus(e.target)}\n                  onBlur={() => handleTextFieldBlur()}\n                  onChange={this.onUrlChange}\n                  type=\"url\"\n                  value={this.state.url}\n                />\n              </div>\n              <div className={styles.buttons}>\n                <button className={styles.actionButton}>\n                  <FormattedMessage id=\"change-scene-dialog.change-scene\" />\n                </button>\n              </div>\n              <div className={styles.spokeCreate}>\n                <div>\n                  <FormattedMessage id=\"change-scene-dialog.create-in-spoke\" />\n                </div>\n                <a className={styles.spokeLaunch} href=\"/spoke/new\" target=\"_blank\" rel=\"noopener noreferrer\">\n                  <FormattedMessage id=\"change-scene-dialog.new-spoke-project\" />\n                </a>\n              </div>\n            </div>\n          </form>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\n\nimport styles from \"../assets/stylesheets/avatar-url-dialog.scss\";\nimport DialogContainer from \"./dialog-container.js\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\n\nexport default class AvatarUrlDialog extends Component {\n  state = {\n    url: \"\"\n  };\n\n  static propTypes = {\n    onChange: PropTypes.func,\n    onClose: PropTypes.func\n  };\n\n  onUrlChange = e => {\n    this.setState({\n      url: e.target && e.target.value\n    });\n  };\n\n  onChangeClicked = e => {\n    e.preventDefault();\n\n    if (this.state.url) {\n      this.props.onChange(this.state.url);\n    }\n\n    this.props.onClose();\n  };\n\n  render() {\n    return (\n      <DialogContainer title=\"Custom Avatar URL\" className={styles.avatarUrlDialog} onClose={this.props.onClose}>\n        <p>\n          Paste a URL to a{\" \"}\n          <a href=\"https://en.wikipedia.org/wiki/GlTF#GLB\" target=\"_blank\" rel=\"noopener noreferrer\">\n            GLB\n          </a>.\n        </p>\n        <form className=\"form\" onSubmit={this.onChangeClicked}>\n          <input\n            className=\"url-field\"\n            placeholder=\"Avatar GLB URL\"\n            onFocus={e => handleTextFieldFocus(e.target)}\n            onBlur={() => handleTextFieldBlur()}\n            onChange={this.onUrlChange}\n            type=\"url\"\n            value={this.state.url}\n          />\n          <button className=\"submit\">\n            <FormattedMessage id=\"avatar-url-dialog.apply\" />\n          </button>\n        </form>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport DialogContainer from \"./dialog-container.js\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nexport default class HelpDialog extends Component {\n  render() {\n    return (\n      <DialogContainer title=\"Getting Started\" {...this.props}>\n        <div className=\"info-dialog__help\">\n          <p style={{ textAlign: \"center\" }}>\n            Join the Hubs community on{\" \"}\n            <WithHoverSound>\n              <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://discord.gg/wHmY4nd\">\n                Discord\n              </a>\n            </WithHoverSound>\n            !\n          </p>\n          <p>When in a room, other avatars can see and hear you.</p>\n          <p>\n            Use your controller&apos;s action button to teleport from place to place. If it has a grip, use it to pick\n            up objects.\n          </p>\n          <p>\n            In VR, <b>look up</b> to find your menu.\n          </p>\n          <p>\n            The <b>Mic Toggle</b> mutes your mic.\n          </p>\n          <p>\n            The <b>Pause Toggle</b> pauses all other avatars and lets you block others or pin or remove objects.\n          </p>\n          <p>\n            See detailed{\" \"}\n            <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://github.com/mozilla/hubs/wiki/Hubs-Features\">\n              feature\n            </a>{\" \"}\n            and{\" \"}\n            <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://github.com/mozilla/hubs/wiki/Hubs-Controls\">\n              controls\n            </a>{\" \"}\n            documentation.\n          </p>\n          <p className=\"dialog__box__contents__links\">\n            <WithHoverSound>\n              <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://github.com/mozilla/hubs/blob/master/TERMS.md\">\n                <FormattedMessage id=\"profile.terms_of_use\" />\n              </a>\n            </WithHoverSound>\n            <WithHoverSound>\n              <a\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                href=\"https://github.com/mozilla/hubs/blob/master/PRIVACY.md\"\n              >\n                <FormattedMessage id=\"profile.privacy_notice\" />\n              </a>\n            </WithHoverSound>\n            <WithHoverSound>\n              <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"/?report\">\n                <FormattedMessage id=\"help.report_issue\" />\n              </a>\n            </WithHoverSound>\n          </p>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","/**\n * Wraps navigator.share with a fallback to twitter for unsupported browsers\n */\nexport function share(opts) {\n  if (navigator.share) {\n    return navigator.share(opts);\n  } else {\n    const { title, url } = opts;\n    const width = 550;\n    const height = 420;\n    const left = (screen.width - width) / 2;\n    const top = (screen.height - height) / 2;\n    const params = `scrollbars=no,menubar=no,toolbar=no,status=no,width=${width},height=${height},top=${top},left=${left}`;\n    const tweetLink = `https://twitter.com/intent/tweet?url=${encodeURIComponent(url)}&text=${encodeURIComponent(\n      title\n    )}`;\n    window.open(tweetLink, \"_blank\", params);\n    return Promise.resolve();\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport copy from \"copy-to-clipboard\";\nimport classNames from \"classnames\";\nimport { FormattedMessage } from \"react-intl\";\nimport { share } from \"../utils/share\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nimport { WithHoverSound } from \"./wrap-with-audio\";\nimport styles from \"../assets/stylesheets/invite-dialog.scss\";\n\nfunction pad(num, size) {\n  let s = `${num}`;\n  while (s.length < size) s = `0${s}`;\n  return s;\n}\n\nexport default class InviteDialog extends Component {\n  static propTypes = {\n    entryCode: PropTypes.number,\n    hubId: PropTypes.string,\n    allowShare: PropTypes.bool,\n    isModal: PropTypes.bool,\n    onClose: PropTypes.func\n  };\n\n  state = {\n    copyButtonActive: false,\n    shareButtonActive: false\n  };\n\n  shareClicked = url => {\n    this.setState({ shareButtonActive: true });\n    share({ url, title: \"Join me now in #hubs!\" }).then(() => {\n      this.setState({ shareButtonActive: false });\n    });\n  };\n\n  copyClicked = link => {\n    this.setState({ copyButtonActive: true });\n    setTimeout(() => this.setState({ copyButtonActive: false }), 5000);\n\n    copy(link);\n  };\n\n  render() {\n    const { entryCode } = this.props;\n\n    const entryCodeString = pad(entryCode, 6);\n    const shortLinkText = `hub.link/${this.props.hubId}`;\n    const shortLink = \"https://\" + shortLinkText;\n\n    return (\n      <div className={classNames({ [styles.dialog]: true, [styles.modal]: this.props.isModal })}>\n        {!this.props.isModal && <div className={styles.attachPoint} />}\n        <WithHoverSound>\n          <button className={styles.close} onClick={() => this.props.onClose()}>\n            <i>\n              <FontAwesomeIcon icon={faTimes} />\n            </i>\n          </button>\n        </WithHoverSound>\n        <div>\n          <FormattedMessage id={`invite.enter_via${this.props.isModal ? \"_modal\" : \"\"}`} />\n          <WithHoverSound>\n            <a href=\"https://hub.link\" target=\"_blank\" className={styles.hubLinkLink} rel=\"noopener noreferrer\">\n              hub.link\n            </a>\n          </WithHoverSound>\n          <FormattedMessage id=\"invite.and_enter_code\" />\n        </div>\n        <div className={styles.code}>\n          {entryCodeString.split(\"\").map((d, i) => (\n            <div className={classNames({ [styles.digit]: true, [styles[`digit_${i}`]]: true })} key={`link_code_${i}`}>\n              {d}\n            </div>\n          ))}\n        </div>\n        <div>\n          <FormattedMessage id={`invite.or_visit${this.props.isModal ? \"_modal\" : \"\"}`} />\n        </div>\n        <div className={styles.domain}>\n          <input type=\"text\" readOnly onFocus={e => e.target.select()} value={shortLinkText} />\n        </div>\n        <div className={styles.buttons}>\n          <WithHoverSound>\n            <button className={styles.linkButton} onClick={this.copyClicked.bind(this, shortLink)}>\n              <span>{this.state.copyButtonActive ? \"copied!\" : \"copy\"}</span>\n            </button>\n          </WithHoverSound>\n          {this.props.allowShare &&\n            navigator.share && (\n              <WithHoverSound>\n                <button className={styles.linkButton} onClick={this.shareClicked.bind(this, shortLink)}>\n                  <span>{this.state.shareButtonActive ? \"sharing...\" : \"share\"}</span>\n                </button>\n              </WithHoverSound>\n            )}\n          {this.props.allowShare &&\n            !navigator.share && (\n              <WithHoverSound>\n                <button className={styles.linkButton} onClick={this.shareClicked.bind(this, shortLink)}>\n                  <FormattedMessage id=\"invite.tweet\" />\n                </button>\n              </WithHoverSound>\n            )}\n        </div>\n        {this.props.isModal && (\n          <button className={styles.enterVrButton} onClick={() => this.props.onClose()}>\n            <FormattedMessage id=\"entry.return-to-vr\" />\n          </button>\n        )}\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport DialogContainer from \"./dialog-container.js\";\nimport PropTypes from \"prop-types\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nexport default class InviteTeamDialog extends Component {\n  static propTypes = {\n    hubChannel: PropTypes.object\n  };\n\n  state = {\n    inviteButtonText: \"invite a hubs team member\"\n  };\n\n  constructor(props) {\n    super(props);\n  }\n\n  inviteClicked = () => {\n    this.setState({ inviteButtonText: \"OK! We'll be there shortly.\" });\n    this.props.hubChannel.requestSupport();\n  };\n\n  render() {\n    return (\n      <DialogContainer title=\"Let's Chat!\" {...this.props}>\n        <div>\n          <div>\n            <p>Have an idea for Hubs? Having trouble?</p>\n            <p>We&apos;d love to chat. Someone from our team will join you in just a few minutes.</p>\n          </div>\n          <div className=\"invite-team-form\">\n            <div className=\"invite-team-form__buttons\">\n              <WithHoverSound>\n                <button className=\"invite-team-form__action-button\" onClick={this.inviteClicked}>\n                  <span>{this.state.inviteButtonText}</span>\n                </button>\n              </WithHoverSound>\n            </div>\n          </div>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { FormattedMessage } from \"react-intl\";\nimport LinkDialogHeader from \"../assets/images/link_dialog_header.svg\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nimport styles from \"../assets/stylesheets/link-dialog.scss\";\n\nexport default class LinkDialog extends Component {\n  static propTypes = {\n    linkCode: PropTypes.string,\n    onClose: PropTypes.func\n  };\n\n  render() {\n    const { linkCode } = this.props;\n\n    return (\n      <div className={styles.dialog}>\n        <WithHoverSound>\n          <div className={styles.close} onClick={() => this.props.onClose()}>\n            <span></span>\n          </div>\n        </WithHoverSound>\n        <div>\n          {!linkCode && (\n            <div>\n              <div className={classNames(\"loading-panel\", styles.codeLoadingPanel)}>\n                <div className=\"loader-wrap\">\n                  <div className=\"loader\">\n                    <div className=\"loader-center\" />\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n          {linkCode && (\n            <div className={styles.contents}>\n              <img className={styles.imageHeader} src={LinkDialogHeader} />\n              <div className={styles.header}>\n                <FormattedMessage id=\"link.connect_headset\" />\n              </div>\n              <div>\n                <FormattedMessage id=\"link.in_your_browser\" />\n              </div>\n              <WithHoverSound>\n                <a href=\"https://hub.link\" className={styles.domain} target=\"_blank\" rel=\"noopener noreferrer\">\n                  hub.link\n                </a>\n              </WithHoverSound>\n              <div>\n                <FormattedMessage id=\"link.enter_code\" />\n              </div>\n              {linkCode && (\n                <div className={styles.code}>\n                  {linkCode.split(\"\").map((d, i) => (\n                    <span className={styles.digit} key={`link_code_${i}`}>\n                      {d}\n                    </span>\n                  ))}\n                </div>\n              )}\n              <div className={styles.keepOpen}>\n                <FormattedMessage id=\"link.do_not_close\" />\n              </div>\n              <WithHoverSound>\n                <button className={styles.closeButton} onClick={() => this.props.onClose()}>\n                  <FormattedMessage id=\"link.cancel\" />\n                </button>\n              </WithHoverSound>\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport copy from \"copy-to-clipboard\";\nimport DialogContainer from \"./dialog-container.js\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nexport default class SafariDialog extends Component {\n  state = {\n    copyLinkButtonText: \"copy\"\n  };\n\n  copyLinkClicked = link => {\n    copy(link);\n    this.setState({ copyLinkButtonText: \"copied!\" });\n  };\n\n  render() {\n    const onCopyClicked = this.copyLinkClicked.bind(this, document.location);\n    return (\n      <DialogContainer title=\"Open in Safari\" {...this.props}>\n        <div>\n          <div>Hubs does not support your current browser on iOS. Copy and paste this link directly in Safari.</div>\n          <div className=\"invite-form\">\n            <input\n              type=\"text\"\n              readOnly\n              onFocus={e => e.target.select()}\n              value={document.location}\n              className=\"invite-form__link_field\"\n            />\n            <div className=\"invite-form__buttons\">\n              <WithHoverSound>\n                <button className=\"invite-form__action-button\" onClick={onCopyClicked}>\n                  <span>{this.state.copyLinkButtonText}</span>\n                </button>\n              </WithHoverSound>\n            </div>\n          </div>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport DialogContainer from \"./dialog-container.js\";\n\nexport default class SafariMicDialog extends Component {\n  render() {\n    return (\n      <DialogContainer title=\"Microphone Access Required\" {...this.props}>\n        <div>\n          <div>\n            Hubs requires microphone permissions in Safari. <br />\n            Please reload and allow microphone access to continue.\n          </div>\n          <div className=\"invite-form\">\n            <div className=\"invite-form__buttons\">\n              <button className=\"invite-form__action-button\" onClick={() => location.reload()}>\n                Reload\n              </button>\n            </div>\n          </div>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\n\nimport styles from \"../assets/stylesheets/rename-room-dialog.scss\";\nimport DialogContainer from \"./dialog-container\";\n\nexport default class RenameRoomDialog extends Component {\n  static propTypes = {\n    onRename: PropTypes.func,\n    onClose: PropTypes.func\n  };\n\n  state = {\n    name: \"\"\n  };\n\n  onSubmit = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    this.props.onRename(this.state.name);\n    this.props.onClose();\n  };\n\n  render() {\n    return (\n      <DialogContainer title=\"Set Room Name\" {...this.props}>\n        <form onSubmit={this.onSubmit} className={styles.renameRoomForm}>\n          <span>\n            <FormattedMessage id=\"rename-room.message\" />\n          </span>\n          <input\n            name=\"name\"\n            type=\"text\"\n            required\n            autoFocus\n            autoComplete=\"off\"\n            placeholder=\"Room name\"\n            value={this.state.name}\n            onFocus={e => handleTextFieldFocus(e.target)}\n            onBlur={() => handleTextFieldBlur()}\n            onChange={e => this.setState({ name: e.target.value })}\n            className={styles.nameField}\n          />\n          <button type=\"submit\" className={styles.nextButton}>\n            <FormattedMessage id=\"rename-room.rename\" />\n          </button>\n        </form>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\n\nimport styles from \"../assets/stylesheets/close-room-dialog.scss\";\nimport DialogContainer from \"./dialog-container\";\n\nexport default class CloseRoomDialog extends Component {\n  static propTypes = {\n    onConfirm: PropTypes.func,\n    onClose: PropTypes.func\n  };\n\n  render() {\n    return (\n      <DialogContainer title=\"Close Room\" {...this.props}>\n        <div className={styles.message}>\n          <FormattedMessage id=\"close-room.message\" />\n        </div>\n        <button\n          className={styles.confirmButton}\n          onClick={() => {\n            this.props.onConfirm();\n            this.props.onClose();\n          }}\n        >\n          <FormattedMessage id=\"close-room.confirm\" />\n        </button>\n        <button className={styles.cancelButton} onClick={() => this.props.onClose()}>\n          <FormattedMessage id=\"close-room.cancel\" />\n        </button>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport DialogContainer from \"./dialog-container.js\";\n\nexport default class WebRTCScreenshareUnsupportedDialog extends Component {\n  render() {\n    return (\n      <DialogContainer title=\"Share Screen\" {...this.props}>\n        <div style={{ display: \"flex\", flexDirection: \"column\", alignItems: \"center\" }}>\n          <p>\n            Your browser doesn&apos;t seem to support WebRTC screen sharing.\n            <br />\n            To share your screen in Hubs, you can use Firefox.\n          </p>\n          <a\n            className=\"info-dialog--action-button\"\n            target=\"_blank\"\n            rel=\"noreferrer noopener\"\n            href=\"https://www.mozilla.org/firefox\"\n          >\n            Download Firefox\n          </a>\n          <p style={{ fontSize: \"0.8em\" }}>\n            To test WebRTC screen sharing in your browser, see this&nbsp;\n            <a\n              href=\"https://www.webrtc-experiment.com/screen-sharing/#5591174797993739\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n            >\n              WebRTC experiment\n            </a>.\n          </p>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport DialogContainer from \"./dialog-container.js\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nexport default class WebVRRecommendDialog extends Component {\n  render() {\n    return (\n      <DialogContainer title=\"Enter in VR\" {...this.props}>\n        <div style={{ display: \"flex\", flexDirection: \"column\", alignItems: \"center\" }}>\n          <p>To enter Hubs with Oculus or SteamVR, you can use Firefox.</p>\n          <WithHoverSound>\n            <a\n              className=\"info-dialog--action-button\"\n              href=\"https://www.mozilla.org/firefox\"\n              target=\"_blank\"\n              rel=\"noreferrer noopener\"\n            >\n              Download Firefox\n            </a>\n          </WithHoverSound>\n          <p style={{ fontSize: \"0.8em\" }}>\n            For a full list of browsers with experimental VR support, visit{\" \"}\n            <WithHoverSound>\n              <a href=\"https://webvr.rocks\" target=\"_blank\" rel=\"noopener noreferrer\">\n                WebVR Rocks\n              </a>\n            </WithHoverSound>\n          </p>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport DialogContainer from \"./dialog-container.js\";\nimport styles from \"../assets/stylesheets/room-info-dialog.scss\";\nimport { scaledThumbnailUrlFor } from \"../utils/media-utils\";\n\nexport default class RoomInfoDialog extends Component {\n  static propTypes = {\n    hubName: PropTypes.string,\n    scene: PropTypes.object\n  };\n\n  render() {\n    const toAttributionDiv = (a, i) => {\n      if (a.url) {\n        const source = a.url.includes(\"sketchfab.com\")\n          ? \"on Sketchfab\"\n          : a.url.includes(\"poly.google.com\")\n            ? \"on Google Poly\"\n            : \"\";\n\n        return (\n          <div className={styles.attribution} key={`${a.url} ${i}`}>\n            <div className={styles.attributionName}>\n              <a href={a.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                {a.name}\n              </a>\n            </div>\n            <div className={styles.attributionAuthor}>\n              by {a.author} {source}\n            </div>\n          </div>\n        );\n      } else {\n        return (\n          <div className={styles.attribution} key={`${a.name} ${a.author} {i}`}>\n            <div className={styles.attributionName}>{a.name}</div>\n            <div className={styles.attributionAuthor}>by {a.author}</div>\n          </div>\n        );\n      }\n    };\n\n    let attributions = null;\n    let creator = null;\n\n    if (this.props.scene.attributions) {\n      creator = this.props.scene.attributions.creator;\n      attributions = (\n        <div>\n          {this.props.scene.attributions.content && this.props.scene.attributions.content.map(toAttributionDiv)}\n        </div>\n      );\n    }\n\n    const title = <div className={styles.title}>{this.props.hubName}</div>;\n\n    return (\n      <DialogContainer title={title} wide={true} {...this.props}>\n        <div className={styles.roomInfo}>\n          <div className={styles.sceneScreenshot}>\n            <a href={this.props.scene.url} target=\"_blank\" rel=\"noopener noreferrer\">\n              <img src={scaledThumbnailUrlFor(this.props.scene.screenshot_url, 400, 480)} />\n            </a>\n          </div>\n          <div className={styles.sceneDetails}>\n            <div className={styles.sceneMain}>\n              <div className={styles.sceneName}>\n                <a href={this.props.scene.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                  {this.props.scene.name}\n                </a>\n              </div>\n              <div className={styles.sceneCreator}>{creator}</div>\n            </div>\n            <div className={styles.sceneAttributions}>{attributions}</div>\n            <div className={styles.sceneButtons}> </div>\n          </div>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport DialogContainer from \"./dialog-container.js\";\nimport styles from \"../assets/stylesheets/oauth-dialog.scss\";\n\nexport default class OAuthDialog extends Component {\n  static propTypes = {\n    oauthInfo: PropTypes.array\n  };\n  render() {\n    return (\n      <DialogContainer title=\"Sign In\" {...this.props}>\n        <div>\n          <div>You&apos;ll need to sign in to access this room.</div>\n          <br />\n          <div>We&apos;ll ask for access to your e-mail address so you can skip signing in next time.</div>\n          <p className={styles.privacyNotice}>\n            By proceeding, you agree to the{\" \"}\n            <a rel=\"noopener noreferrer\" target=\"_blank\" href=\"https://github.com/mozilla/hubs/blob/master/TERMS.md\">\n              terms of use\n            </a>{\" \"}\n            and{\" \"}\n            <a rel=\"noopener noreferrer\" target=\"_blank\" href=\"https://github.com/mozilla/hubs/blob/master/PRIVACY.md\">\n              privacy notice\n            </a>.\n          </p>\n          <div className=\"invite-form\">\n            <div className={`invite-form__buttons ${styles.oauthButtons}`}>\n              {this.props.oauthInfo.map(oauthInfo => (\n                <a href={oauthInfo.url} key={oauthInfo.type} className={styles.oauthButton}>\n                  Sign in with&nbsp;<span className={styles.oauthTypeName}>{oauthInfo.type}</span>\n                </a>\n              ))}\n            </div>\n          </div>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"../assets/stylesheets/message-entry.scss\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\nimport { faPaperPlane } from \"@fortawesome/free-solid-svg-icons/faPaperPlane\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nclass LobbyChatBox extends Component {\n  static propTypes = {\n    discordBridges: PropTypes.array,\n    occupantCount: PropTypes.number,\n    onSendMessage: PropTypes.func\n  };\n\n  state = {\n    pendingMessage: \"\"\n  };\n\n  sendMessage = e => {\n    e.preventDefault();\n    if (this.props.onSendMessage) {\n      this.props.onSendMessage(this.state.pendingMessage);\n    }\n    this.setState({ pendingMessage: \"\" });\n  };\n\n  render() {\n    const textRows = this.state.pendingMessage.split(\"\\n\").length;\n    const pendingMessageTextareaHeight = textRows * 28 + \"px\";\n    const pendingMessageFieldHeight = textRows * 28 + 20 + \"px\";\n    const discordSnippet = this.props.discordBridges.map(ch => \"#\" + ch).join(\", \");\n    const occupantSnippet = `${this.props.occupantCount - 1} other${this.props.occupantCount > 2 ? \"s\" : \"\"}`;\n    const messageEntryPlaceholder =\n      this.props.occupantCount <= 1\n        ? \"Nobody is here yet...\"\n        : this.props.discordBridges.length\n          ? `Send message to ${occupantSnippet} and ${discordSnippet}...`\n          : `Send message to ${occupantSnippet}...`;\n\n    return (\n      <form onSubmit={this.sendMessage}>\n        <div\n          className={classNames({\n            [styles.messageEntry]: true,\n            [styles.messageEntryDisabled]: this.props.occupantCount <= 1\n          })}\n          style={{ height: pendingMessageFieldHeight }}\n        >\n          <textarea\n            className={classNames([styles.messageEntryInput, \"chat-focus-target\"])}\n            value={this.state.pendingMessage}\n            rows={textRows}\n            style={{ height: pendingMessageTextareaHeight }}\n            onFocus={e => handleTextFieldFocus(e.target)}\n            onBlur={() => handleTextFieldBlur()}\n            onChange={e => this.setState({ pendingMessage: e.target.value })}\n            disabled={this.props.occupantCount <= 1 ? true : false}\n            onKeyDown={e => {\n              if (e.key === \"Enter\" && !e.shiftKey) {\n                this.sendMessage(e);\n              } else if (e.key === \"Escape\") {\n                e.target.blur();\n              }\n            }}\n            placeholder={messageEntryPlaceholder}\n          />\n          <WithHoverSound>\n            <button\n              className={classNames([styles.messageEntryButton, styles.messageEntrySubmit])}\n              disabled={this.props.occupantCount <= 1 ? true : false}\n              type=\"submit\"\n            >\n              <i>\n                <FontAwesomeIcon icon={faPaperPlane} />\n              </i>\n            </button>\n          </WithHoverSound>\n        </div>\n      </form>\n    );\n  }\n}\n\nexport default LobbyChatBox;\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"../assets/stylesheets/chat-command-help.scss\";\nimport classNames from \"classnames\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport default class ChatCommandHelp extends Component {\n  static propTypes = {\n    matchingPrefix: PropTypes.string,\n    onTop: PropTypes.bool\n  };\n\n  render() {\n    const commands = [\"leave\", \"fly\", \"grow\", \"shrink\", \"duck\", \"debug\", \"scene <scene url>\", \"rename <new name>\"];\n\n    return (\n      <div className={classNames({ [styles.commandHelp]: true, [styles.commandHelpOnTop]: this.props.onTop })}>\n        {commands.map(\n          c =>\n            (this.props.matchingPrefix === \"\" ||\n              c.split(\" \")[0].startsWith(this.props.matchingPrefix.split(\" \")[0])) && (\n              <div className={styles.entry} key={c}>\n                <div className={styles.command}>/{c}</div>\n                <div>\n                  <FormattedMessage id={`commands.${c.split(\" \")[0]}`} />\n                </div>\n              </div>\n            )\n        )}\n      </div>\n    );\n  }\n}\n","// https://stackoverflow.com/questions/6209161/extract-the-current-dom-and-print-it-as-a-string-with-styles-intact\n//\n// Mapping between tag names and css default values lookup tables. This allows to exclude default values in the result.\nconst defaultStylesByTagName = {};\n\n// Styles inherited from style sheets will not be rendered for elements with these tag names\nconst noStyleTags = {\n  BASE: true,\n  HEAD: true,\n  HTML: true,\n  META: true,\n  NOFRAME: true,\n  NOSCRIPT: true,\n  PARAM: true,\n  SCRIPT: true,\n  STYLE: true,\n  TITLE: true\n};\n\n// This list determines which css default values lookup tables are precomputed at load time\n// Lookup tables for other tag names will be automatically built at runtime if needed\nconst tagNames = [\n  \"A\",\n  \"ABBR\",\n  \"ADDRESS\",\n  \"AREA\",\n  \"ARTICLE\",\n  \"ASIDE\",\n  \"AUDIO\",\n  \"B\",\n  \"BASE\",\n  \"BDI\",\n  \"BDO\",\n  \"BLOCKQUOTE\",\n  \"BODY\",\n  \"BR\",\n  \"BUTTON\",\n  \"CANVAS\",\n  \"CAPTION\",\n  \"CENTER\",\n  \"CITE\",\n  \"CODE\",\n  \"COL\",\n  \"COLGROUP\",\n  \"COMMAND\",\n  \"DATALIST\",\n  \"DD\",\n  \"DEL\",\n  \"DETAILS\",\n  \"DFN\",\n  \"DIV\",\n  \"DL\",\n  \"DT\",\n  \"EM\",\n  \"EMBED\",\n  \"FIELDSET\",\n  \"FIGCAPTION\",\n  \"FIGURE\",\n  \"FONT\",\n  \"FOOTER\",\n  \"FORM\",\n  \"H1\",\n  \"H2\",\n  \"H3\",\n  \"H4\",\n  \"H5\",\n  \"H6\",\n  \"HEAD\",\n  \"HEADER\",\n  \"HGROUP\",\n  \"HR\",\n  \"HTML\",\n  \"I\",\n  \"IFRAME\",\n  \"IMG\",\n  \"INPUT\",\n  \"INS\",\n  \"KBD\",\n  \"KEYGEN\",\n  \"LABEL\",\n  \"LEGEND\",\n  \"LI\",\n  \"LINK\",\n  \"MAP\",\n  \"MARK\",\n  \"MATH\",\n  \"MENU\",\n  \"META\",\n  \"METER\",\n  \"NAV\",\n  \"NOBR\",\n  \"NOSCRIPT\",\n  \"OBJECT\",\n  \"OL\",\n  \"OPTION\",\n  \"OPTGROUP\",\n  \"OUTPUT\",\n  \"P\",\n  \"PARAM\",\n  \"PRE\",\n  \"PROGRESS\",\n  \"Q\",\n  \"RP\",\n  \"RT\",\n  \"RUBY\",\n  \"S\",\n  \"SAMP\",\n  \"SCRIPT\",\n  \"SECTION\",\n  \"SELECT\",\n  \"SMALL\",\n  \"SOURCE\",\n  \"SPAN\",\n  \"STRONG\",\n  \"STYLE\",\n  \"SUB\",\n  \"SUMMARY\",\n  \"SUP\",\n  \"SVG\",\n  \"TABLE\",\n  \"TBODY\",\n  \"TD\",\n  \"TEXTAREA\",\n  \"TFOOT\",\n  \"TH\",\n  \"THEAD\",\n  \"TIME\",\n  \"TITLE\",\n  \"TR\",\n  \"TRACK\",\n  \"U\",\n  \"UL\",\n  \"VAR\",\n  \"VIDEO\",\n  \"WBR\"\n];\n\nfunction computeDefaultStyleByTagName(tagName) {\n  const defaultStyle = {};\n  const element = document.body.appendChild(document.createElement(tagName));\n  const computedStyle = getComputedStyle(element);\n  for (let i = 0; i < computedStyle.length; i++) {\n    defaultStyle[computedStyle[i]] = computedStyle[computedStyle[i]];\n  }\n  document.body.removeChild(element);\n  return defaultStyle;\n}\n\nfunction getDefaultStyleByTagName(tagName) {\n  tagName = tagName.toUpperCase();\n  if (!defaultStylesByTagName[tagName]) {\n    defaultStylesByTagName[tagName] = computeDefaultStyleByTagName(tagName);\n  }\n  return defaultStylesByTagName[tagName];\n}\n\nexport function warmSerializeElement() {\n  for (let i = 0; i < tagNames.length; i++) {\n    if (!noStyleTags[tagNames[i]]) {\n      defaultStylesByTagName[tagNames[i]] = computeDefaultStyleByTagName(tagNames[i]);\n    }\n  }\n}\n\nexport default function serializeElement(el) {\n  if (Object.keys(defaultStylesByTagName).length === 0) {\n    // Precompute the lookup tables.\n    warmSerializeElement();\n  }\n\n  if (el.nodeType !== Node.ELEMENT_NODE) {\n    throw new TypeError();\n  }\n  const cssTexts = [];\n  const elements = el.querySelectorAll(\"*\");\n  for (let i = 0; i < elements.length; i++) {\n    const e = elements[i];\n    if (!noStyleTags[e.tagName]) {\n      const computedStyle = getComputedStyle(e);\n      const defaultStyle = getDefaultStyleByTagName(e.tagName);\n      cssTexts[i] = e.style.cssText;\n      for (let ii = 0; ii < computedStyle.length; ii++) {\n        const cssPropName = computedStyle[ii];\n\n        // Skip non-standard CSS for now, because it overwrites things like color\n        if (cssPropName.startsWith(\"-webkit\")) continue;\n\n        if (computedStyle[cssPropName] !== defaultStyle[cssPropName]) {\n          e.style[cssPropName] = computedStyle[cssPropName];\n        }\n      }\n    }\n  }\n  const result = el.outerHTML;\n  for (let i = 0; i < elements.length; i++) {\n    elements[i].style.cssText = cssTexts[i];\n  }\n  return result;\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\nimport classNames from \"classnames\";\n\nimport styles from \"../assets/stylesheets/presence-list.scss\";\nimport PhoneImage from \"../assets/images/presence_phone.png\";\nimport DesktopImage from \"../assets/images/presence_desktop.png\";\nimport DiscordImage from \"../assets/images/presence_discord.png\";\nimport HMDImage from \"../assets/images/presence_vr.png\";\nimport maskEmail from \"../utils/mask-email\";\nimport StateLink from \"./state-link.js\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faPencilAlt } from \"@fortawesome/free-solid-svg-icons/faPencilAlt\";\nimport { pushHistoryPath, withSlug } from \"../utils/history\";\n\nfunction getPresenceImage(ctx) {\n  if (ctx && ctx.mobile) {\n    return PhoneImage;\n  } else if (ctx && ctx.hmd) {\n    return HMDImage;\n  } else if (ctx && ctx.discord) {\n    return DiscordImage;\n  } else {\n    return DesktopImage;\n  }\n}\n\nexport function navigateToClientInfo(history, clientId) {\n  const currentParams = new URLSearchParams(history.location.search);\n\n  if (process.env.RETICULUM_SERVER && document.location.host !== process.env.RETICULUM_SERVER) {\n    currentParams.set(\"client_id\", clientId);\n    pushHistoryPath(history, history.location.pathname, currentParams.toString());\n  } else {\n    pushHistoryPath(history, withSlug(history.location, `/clients/${clientId}`), currentParams.toString());\n  }\n}\n\nexport default class PresenceList extends Component {\n  static propTypes = {\n    presences: PropTypes.object,\n    history: PropTypes.object,\n    sessionId: PropTypes.string,\n    signedIn: PropTypes.bool,\n    email: PropTypes.string,\n    onSignIn: PropTypes.func,\n    onSignOut: PropTypes.func\n  };\n\n  navigateToClientInfo = clientId => {\n    navigateToClientInfo(this.props.history, clientId);\n  };\n\n  domForPresence = ([sessionId, data]) => {\n    const meta = data.metas[data.metas.length - 1];\n    const context = meta.context;\n    const profile = meta.profile;\n    const image = getPresenceImage(context);\n    const isBot = context && context.discord;\n    const isModerator = meta.roles && meta.roles.moderator;\n    const badge = isModerator && (\n      <span className={styles.moderatorBadge} title=\"Moderator\">\n        &#x2605;\n      </span>\n    );\n\n    return (\n      <WithHoverSound key={sessionId}>\n        <div className={styles.row}>\n          <div className={styles.icon}>\n            <img src={image} />\n          </div>\n          <div\n            className={classNames({\n              [styles.listItem]: true\n            })}\n          >\n            {sessionId === this.props.sessionId ? (\n              <StateLink className={styles.self} stateKey=\"overlay\" stateValue=\"profile\" history={this.props.history}>\n                {profile && profile.displayName}\n                {badge}\n                <i>\n                  <FontAwesomeIcon icon={faPencilAlt} />\n                </i>\n              </StateLink>\n            ) : (\n              <div>\n                {!isBot ? (\n                  <button className={styles.clientLink} onClick={() => this.navigateToClientInfo(sessionId)}>\n                    {profile && profile.displayName}\n                  </button>\n                ) : (\n                  <span>{profile && profile.displayName}</span>\n                )}\n                {badge}\n              </div>\n            )}\n          </div>\n          <div className={styles.presence}>\n            <FormattedMessage id={`presence.in_${meta.presence}`} />\n          </div>\n        </div>\n      </WithHoverSound>\n    );\n  };\n\n  render() {\n    // Draw self first\n    return (\n      <div className={styles.presenceList}>\n        <div className={styles.attachPoint} />\n        <div className={styles.contents}>\n          <div className={styles.rows}>\n            {Object.entries(this.props.presences || {})\n              .filter(([k]) => k === this.props.sessionId)\n              .map(this.domForPresence)}\n            {Object.entries(this.props.presences || {})\n              .filter(([k]) => k !== this.props.sessionId)\n              .map(this.domForPresence)}\n          </div>\n          <div className={styles.signIn}>\n            {this.props.signedIn ? (\n              <div>\n                <span>\n                  <FormattedMessage id=\"sign-in.as\" /> {maskEmail(this.props.email)}\n                </span>{\" \"}\n                <a onClick={this.props.onSignOut}>\n                  <FormattedMessage id=\"sign-in.out\" />\n                </a>\n              </div>\n            ) : (\n              <a onClick={this.props.onSignIn}>\n                <FormattedMessage id=\"sign-in.in\" />\n              </a>\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport PropTypes from \"prop-types\";\nimport styles from \"../assets/stylesheets/presence-log.scss\";\nimport classNames from \"classnames\";\nimport Linkify from \"react-linkify\";\nimport { toArray as toEmojis } from \"react-emoji-render\";\nimport serializeElement from \"../utils/serialize-element\";\nimport { navigateToClientInfo } from \"./presence-list\";\n\nconst messageCanvas = document.createElement(\"canvas\");\nconst emojiRegex = /(?:[\\u2700-\\u27bf]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\u0023-\\u0039]\\ufe0f?\\u20e3|\\u3299|\\u3297|\\u303d|\\u3030|\\u24c2|\\ud83c[\\udd70-\\udd71]|\\ud83c[\\udd7e-\\udd7f]|\\ud83c\\udd8e|\\ud83c[\\udd91-\\udd9a]|\\ud83c[\\udde6-\\uddff]|[\\ud83c[\\ude01-\\ude02]|\\ud83c\\ude1a|\\ud83c\\ude2f|[\\ud83c[\\ude32-\\ude3a]|[\\ud83c[\\ude50-\\ude51]|\\u203c|\\u2049|[\\u25aa-\\u25ab]|\\u25b6|\\u25c0|[\\u25fb-\\u25fe]|\\u00a9|\\u00ae|\\u2122|\\u2139|\\ud83c\\udc04|[\\u2600-\\u26FF]|\\u2b05|\\u2b06|\\u2b07|\\u2b1b|\\u2b1c|\\u2b50|\\u2b55|\\u231a|\\u231b|\\u2328|\\u23cf|[\\u23e9-\\u23f3]|[\\u23f8-\\u23fa]|\\ud83c\\udccf|\\u2934|\\u2935|[\\u2190-\\u21ff])/;\nconst urlRegex = /^https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_+.~#?&//=]*)$/;\nconst textureLoader = new THREE.TextureLoader();\n\n// Hacky word wrapping, needed because the SVG conversion doesn't properly deal\n// with wrapping in Firefox for some reason. (The CSS white-space is set to pre)\nconst wordWrap = body => {\n  const maxCharsPerLine = 40;\n  const words = body.split(\" \");\n  const outWords = [];\n  let c = 0;\n\n  for (let i = 0; i < words.length; i++) {\n    const word = words[i];\n\n    if (word.startsWith(\":\") && word.endsWith(\":\")) {\n      c++;\n    } else {\n      c += word.length;\n    }\n\n    outWords.push(word);\n\n    if (c >= maxCharsPerLine) {\n      c = 0;\n      outWords.push(\"\\n\");\n    }\n  }\n\n  return outWords.join(\" \");\n};\n\nconst messageBodyDom = (body, from, fromSessionId, history) => {\n  // Support wrapping text in ` to get monospace, and multiline.\n  const multiLine = body.split(\"\\n\").length > 1;\n  const wrapStyle = multiLine ? styles.messageWrapMulti : styles.messageWrap;\n  const mono = body.startsWith(\"`\") && body.endsWith(\"`\");\n  const messageBodyClasses = {\n    [styles.messageBody]: true,\n    [styles.messageBodyMulti]: multiLine,\n    [styles.messageBodyMono]: mono\n  };\n  const includeClientLink = fromSessionId && history && NAF.clientId !== fromSessionId;\n  const onFromClick = includeClientLink ? () => navigateToClientInfo(history, fromSessionId) : () => {};\n\n  if (!multiLine) {\n    body = wordWrap(body);\n  }\n\n  const cleanedBody = (mono ? body.substring(1, body.length - 1) : body).trim();\n\n  return (\n    <div className={wrapStyle}>\n      {from && (\n        <div\n          onClick={onFromClick}\n          className={classNames({ [styles.messageSource]: true, [styles.messageSourceLink]: includeClientLink })}\n        >\n          {from}:\n        </div>\n      )}\n      <div className={classNames(messageBodyClasses)}>\n        <Linkify properties={{ target: \"_blank\", rel: \"noopener referrer\" }}>{toEmojis(cleanedBody)}</Linkify>\n      </div>\n    </div>\n  );\n};\n\nfunction renderChatMessage(body, from, allowEmojiRender, lowResolution) {\n  const isOneLine = body.split(\"\\n\").length === 1;\n  const context = messageCanvas.getContext(\"2d\");\n  const emoji = toEmojis(body);\n  const isEmoji =\n    allowEmojiRender &&\n    emoji.length === 1 &&\n    emoji[0].props &&\n    emoji[0].props.children.match &&\n    emoji[0].props.children.match(emojiRegex);\n\n  const el = document.createElement(\"div\");\n  el.setAttribute(\"xmlns\", \"http://www.w3.org/1999/xhtml\");\n  el.setAttribute(\"class\", `${styles.presenceLog} ${styles.presenceLogSpawn}`);\n\n  // The element is added to the DOM in order to have layout compute the width & height,\n  // and then it is removed after being rendered.\n  document.body.appendChild(el);\n\n  const entryDom = (\n    <div\n      className={classNames({\n        [styles.presenceLogEntry]: !isEmoji,\n        [styles.presenceLogEntryOneLine]: !isEmoji && isOneLine,\n        [styles.presenceLogEmoji]: isEmoji\n      })}\n    >\n      {messageBodyDom(body, from)}\n    </div>\n  );\n\n  return new Promise(resolve => {\n    ReactDOM.render(entryDom, el, () => {\n      // Scale by 12x\n      let objectScale = \"8.33%\";\n      let scale = 12;\n\n      if (lowResolution) {\n        // In low res, scale by 4x\n        objectScale = \"25%\";\n        scale = 4;\n      }\n\n      messageCanvas.width = el.offsetWidth * (scale + 0.1);\n      messageCanvas.height = el.offsetHeight * (scale + 0.1);\n\n      const xhtml = encodeURIComponent(`\n          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${messageCanvas.width}\" height=\"${messageCanvas.height}\">\n            <foreignObject width=\"${objectScale}\" height=\"${objectScale}\" style=\"transform: scale(${scale});\">\n              ${serializeElement(el)}\n            </foreignObject>\n          </svg>\n    `);\n      const img = new Image();\n\n      img.onload = async () => {\n        context.drawImage(img, 0, 0);\n        const blob = await new Promise(resolve => messageCanvas.toBlob(resolve));\n        el.parentNode.removeChild(el);\n        resolve(blob);\n      };\n\n      img.src = \"data:image/svg+xml,\" + xhtml;\n    });\n  });\n}\n\nexport async function createInWorldLogMessage({ name, type, body }) {\n  if (type !== \"chat\") return;\n\n  const lowResolution = AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR();\n  const blob = await renderChatMessage(body, name, false, lowResolution);\n  const entity = document.createElement(\"a-entity\");\n  const meshEntity = document.createElement(\"a-entity\");\n\n  document.querySelector(\"a-scene\").appendChild(entity);\n\n  entity.appendChild(meshEntity);\n  entity.setAttribute(\"follow-in-fov\", {\n    target: \"#player-camera\",\n    offset: { x: 0, y: 0.0, z: -0.8 }\n  });\n\n  const blobUrl = URL.createObjectURL(blob);\n\n  meshEntity.setAttribute(\"animation__float\", {\n    property: \"position\",\n    dur: 10000,\n    from: { x: 0, y: 0, z: 0 },\n    to: { x: 0, y: 0.05, z: -0.05 },\n    easing: \"easeOutQuad\"\n  });\n\n  entity.setAttribute(\"animation__spawn\", {\n    property: \"scale\",\n    dur: 200,\n    from: { x: 0.1, y: 0.1, z: 0.1 },\n    to: { x: 1, y: 1, z: 1 },\n    easing: \"easeOutElastic\"\n  });\n\n  meshEntity.setAttribute(\"animation__opacity\", {\n    property: \"meshMaterial.opacity\",\n    isRawProperty: true,\n    delay: 3000,\n    dur: 8000,\n    from: 1.0,\n    to: 0.0,\n    easing: \"easeInQuad\"\n  });\n\n  meshEntity.addEventListener(\"animationcomplete__opacity\", () => {\n    entity.parentNode.removeChild(entity);\n  });\n\n  textureLoader.load(blobUrl, texture => {\n    const material = new THREE.MeshBasicMaterial();\n    material.transparent = true;\n    material.map = texture;\n    material.generateMipmaps = false;\n    material.needsUpdate = true;\n\n    const geometry = new THREE.PlaneBufferGeometry(1, 1, 1, 1, texture.flipY);\n    const mesh = new THREE.Mesh(geometry, material);\n    meshEntity.setObject3D(\"mesh\", mesh);\n    meshEntity.meshMaterial = material;\n    const scaleFactor = 4000.0 / (lowResolution ? 3.0 : 1.0);\n    meshEntity.object3DMap.mesh.scale.set(texture.image.width / scaleFactor, texture.image.height / scaleFactor, 1);\n  });\n}\n\nexport async function spawnChatMessage(body, from) {\n  if (body.length === 0) return;\n\n  if (body.match(urlRegex)) {\n    document.querySelector(\"a-scene\").emit(\"add_media\", body);\n    return;\n  }\n\n  const blob = await renderChatMessage(body, from, true, false);\n  document.querySelector(\"a-scene\").emit(\"add_media\", new File([blob], \"message.png\", { type: \"image/png\" }));\n}\n\nexport default function ChatMessage(props) {\n  return (\n    <div className={props.className}>\n      {props.maySpawn && (\n        <button\n          className={classNames(styles.iconButton, styles.spawnMessage)}\n          onClick={() => spawnChatMessage(props.body)}\n        />\n      )}\n      {messageBodyDom(props.body, props.name, props.sessionId, props.history)}\n    </div>\n  );\n}\n\nChatMessage.propTypes = {\n  name: PropTypes.string,\n  maySpawn: PropTypes.bool,\n  body: PropTypes.string,\n  sessionId: PropTypes.string,\n  history: PropTypes.object,\n  className: PropTypes.string\n};\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"../assets/stylesheets/message-entry.scss\";\nimport ChatCommandHelp from \"./chat-command-help\";\nimport { faPaperPlane } from \"@fortawesome/free-solid-svg-icons/faPaperPlane\";\nimport { faCamera } from \"@fortawesome/free-solid-svg-icons/faCamera\";\nimport { faPlus } from \"@fortawesome/free-solid-svg-icons/faPlus\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\nimport { spawnChatMessage } from \"./chat-message\";\nimport { pushHistoryState } from \"../utils/history\";\n\nconst isMobile = AFRAME.utils.device.isMobile();\n\nclass InWorldChatBox extends Component {\n  static propTypes = {\n    discordBridges: PropTypes.array,\n    onSendMessage: PropTypes.func,\n    onObjectCreated: PropTypes.func,\n    history: PropTypes.object\n  };\n\n  state = {\n    pendingMessage: \"\"\n  };\n\n  sendMessage = e => {\n    e.preventDefault();\n    if (this.props.onSendMessage) {\n      this.props.onSendMessage(this.state.pendingMessage);\n    }\n    this.setState({ pendingMessage: \"\" });\n  };\n\n  render() {\n    const textRows = this.state.pendingMessage.split(\"\\n\").length;\n    const pendingMessageTextareaHeight = textRows * 28 + \"px\";\n    const pendingMessageFieldHeight = textRows * 28 + 20 + \"px\";\n    const discordSnippet = this.props.discordBridges.map(ch => \"#\" + ch).join(\", \");\n\n    return (\n      <form onSubmit={this.sendMessage}>\n        <div\n          className={classNames({ [styles.messageEntryInRoom]: true, [styles.messageEntryOnMobile]: isMobile })}\n          style={{ height: pendingMessageFieldHeight }}\n        >\n          {this.state.pendingMessage.startsWith(\"/\") && (\n            <ChatCommandHelp matchingPrefix={this.state.pendingMessage.substring(1)} />\n          )}\n          <input\n            id=\"message-entry-media-input\"\n            type=\"file\"\n            style={{ display: \"none\" }}\n            accept={isMobile ? \"image/*\" : \"*\"}\n            multiple\n            onChange={e => {\n              if (this.props.onObjectCreated) {\n                for (const file of e.target.files) {\n                  this.props.onObjectCreated(file);\n                }\n              }\n            }}\n          />\n          <label\n            htmlFor=\"message-entry-media-input\"\n            title={\"Upload\"}\n            className={classNames([\n              styles.messageEntryButton,\n              styles.messageEntryButtonInRoom,\n              styles.messageEntryUpload\n            ])}\n          >\n            <i>\n              <FontAwesomeIcon icon={isMobile ? faCamera : faPlus} />\n            </i>\n          </label>\n          <textarea\n            style={{ height: pendingMessageTextareaHeight }}\n            className={classNames([styles.messageEntryInput, styles.messageEntryInputInRoom, \"chat-focus-target\"])}\n            value={this.state.pendingMessage}\n            rows={textRows}\n            onFocus={e => {\n              handleTextFieldFocus(e.target);\n            }}\n            onBlur={() => {\n              handleTextFieldBlur();\n            }}\n            onChange={e => {\n              e.stopPropagation();\n              this.setState({ pendingMessage: e.target.value });\n            }}\n            onKeyDown={e => {\n              if (e.key === \"Enter\" && !e.ctrlKey && !e.shiftKey) {\n                this.sendMessage(e);\n              } else if (e.key === \"Enter\" && e.ctrlKey) {\n                spawnChatMessage(e.target.value);\n                this.setState({ pendingMessage: \"\" });\n                e.target.blur();\n              } else if (e.key === \"Escape\") {\n                e.target.blur();\n              }\n            }}\n            placeholder={this.props.discordBridges.length ? `Send to room and ${discordSnippet}...` : \"Send to room...\"}\n          />\n          <button\n            className={classNames([styles.messageEntrySpawn])}\n            onClick={() => {\n              if (this.state.pendingMessage.length > 0) {\n                spawnChatMessage(this.state.pendingMessage);\n                this.setState({ pendingMessage: \"\" });\n              } else {\n                pushHistoryState(this.props.history, \"modal\", \"create\");\n              }\n            }}\n          />\n          <button\n            type=\"submit\"\n            className={classNames([\n              styles.messageEntryButton,\n              styles.messageEntryButtonInRoom,\n              styles.messageEntrySubmit\n            ])}\n          >\n            <i>\n              <FontAwesomeIcon icon={faPaperPlane} />\n            </i>\n          </button>\n        </div>\n      </form>\n    );\n  }\n}\n\nexport default InWorldChatBox;\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\nimport { fetchReticulumAuthenticated } from \"../utils/phoenix-utils\";\nimport { upload } from \"../utils/media-utils\";\nimport classNames from \"classnames\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nimport AvatarPreview from \"./avatar-preview\";\nimport styles from \"../assets/stylesheets/avatar-editor.scss\";\n\nconst AVATARS_API = \"/api/v1/avatars\";\nconst BOT_PARENT_AVATAR =\n  location.hostname === \"hubs.mozilla.com\" || location.hostname === \"smoke-hubs.mozilla.com\" ? \"gZ6gPvQ\" : \"xf9xkIY\";\n\nexport default class AvatarEditor extends Component {\n  static propTypes = {\n    avatarId: PropTypes.string,\n    onSignIn: PropTypes.func,\n    onSave: PropTypes.func,\n    onClose: PropTypes.func,\n    signedIn: PropTypes.bool,\n    hideDelete: PropTypes.bool,\n    debug: PropTypes.bool,\n    className: PropTypes.string\n  };\n\n  state = {\n    avatar: { name: \"My Avatar\", parent_avatar_id: BOT_PARENT_AVATAR, files: {} },\n    previewGltfUrl: null\n  };\n\n  constructor(props) {\n    super(props);\n    // Blank avatar, used to create base avatar\n    // this.state = { avatar: { name: \"Base bot avatar\", files: {} } };\n\n    this.inputFiles = {};\n  }\n\n  componentDidMount = async () => {\n    if (this.props.avatarId) {\n      const avatar = await this.fetchAvatar(this.props.avatarId);\n      avatar.creatorAttribution = (avatar.attributions && avatar.attributions.creator) || \"\";\n      Object.assign(this.inputFiles, avatar.files);\n      this.setState({ avatar, previewGltfUrl: avatar.base_gltf_url });\n    } else {\n      const { base_gltf_url } = await this.fetchAvatar(BOT_PARENT_AVATAR);\n      this.setState({ previewGltfUrl: base_gltf_url });\n    }\n  };\n\n  fetchAvatar = avatarId => {\n    return fetchReticulumAuthenticated(`${AVATARS_API}/${avatarId}`).then(({ avatars }) => avatars[0]);\n  };\n\n  createOrUpdateAvatar = avatar => {\n    return fetchReticulumAuthenticated(\n      avatar.avatar_id ? `${AVATARS_API}/${avatar.avatar_id}` : AVATARS_API,\n      avatar.avatar_id ? \"PUT\" : \"POST\",\n      { avatar }\n    ).then(({ avatars }) => avatars[0]);\n  };\n\n  uploadAvatar = async e => {\n    e.preventDefault();\n\n    if (this.inputFiles.glb && this.inputFiles.glb instanceof File) {\n      const gltfLoader = new THREE.GLTFLoader();\n      const gltfUrl = URL.createObjectURL(this.inputFiles.glb);\n      const onProgress = console.log;\n      const parser = await new Promise((resolve, reject) =>\n        gltfLoader.createParser(gltfUrl, resolve, onProgress, reject)\n      );\n      URL.revokeObjectURL(gltfUrl);\n\n      const { content, body } = parser.extensions.KHR_binary_glTF;\n\n      // Inject hubs components on upload. Used to create base avatar\n      // const gltf = parser.json;\n      // Object.assign(gltf.scenes[0], {\n      //   extensions: {\n      //     MOZ_hubs_components: {\n      //       \"loop-animation\": {\n      //         clip: \"idle_eyes\"\n      //       }\n      //     }\n      //   }\n      // });\n      // Object.assign(gltf.nodes.find(n => n.name === \"Head\"), {\n      //   extensions: {\n      //     MOZ_hubs_components: {\n      //       \"scale-audio-feedback\": \"\"\n      //     }\n      //   }\n      // });\n      // content = JSON.stringify(gltf);\n\n      this.inputFiles.gltf = new File([content], \"file.gltf\", {\n        type: \"model/gltf\"\n      });\n      this.inputFiles.bin = new File([body], \"file.bin\", {\n        type: \"application/octet-stream\"\n      });\n    }\n\n    this.inputFiles.thumbnail = new File([await this.preview.snapshot()], \"thumbnail.png\", { type: \"image/png\" });\n\n    const filesToUpload = [\"gltf\", \"bin\", \"base_map\", \"emissive_map\", \"normal_map\", \"orm_map\", \"thumbnail\"].filter(\n      k => this.inputFiles[k] === null || this.inputFiles[k] instanceof File\n    );\n\n    this.setState({ uploading: true });\n\n    const fileUploads = await Promise.all(filesToUpload.map(f => this.inputFiles[f] && upload(this.inputFiles[f])));\n    const avatar = {\n      ...this.state.avatar,\n      attributions: {\n        creator: this.state.avatar.creatorAttribution\n      },\n      files: fileUploads\n        .map((resp, i) => [filesToUpload[i], resp && [resp.file_id, resp.meta.access_token, resp.meta.promotion_token]])\n        .reduce((o, [k, v]) => ({ ...o, [k]: v }), {})\n    };\n\n    await this.createOrUpdateAvatar(avatar);\n\n    this.setState({ uploading: false });\n\n    if (this.props.onSave) this.props.onSave();\n  };\n\n  deleteAvatar = async e => {\n    e.preventDefault();\n    await fetchReticulumAuthenticated(`${AVATARS_API}/${this.state.avatar.avatar_id}`, \"DELETE\");\n    if (this.props.onSave) this.props.onSave();\n  };\n\n  fileField = (name, label, accept, disabled = false, title) => (\n    <div className=\"file-input-row\" key={name} title={title}>\n      <label htmlFor={`avatar-file_${name}`}>\n        <div className=\"img-box\" />\n        <span>{label}</span>\n      </label>\n      <input\n        id={`avatar-file_${name}`}\n        type=\"file\"\n        accept={accept}\n        disabled={disabled}\n        onChange={e => {\n          this.inputFiles[name] = e.target.files[0];\n          e.target.value = null;\n        }}\n      />\n      {this.state.avatar.files[name] && (\n        <a\n          onClick={() => {\n            this.inputFiles[name] = null;\n          }}\n        >\n          <i>\n            <FontAwesomeIcon icon={faTimes} />\n          </i>\n        </a>\n      )}\n    </div>\n  );\n\n  mapField = (name, label, accept, disabled = false, title) => (\n    <div className=\"file-input-row\" key={name} title={title}>\n      <label htmlFor={`avatar-file_${name}`}>\n        <div className=\"img-box\">{this.state.avatar.files[name] && <img src={this.state.avatar.files[name]} />}</div>\n        <span>{label}</span>\n      </label>\n      <input\n        id={`avatar-file_${name}`}\n        type=\"file\"\n        accept={accept}\n        disabled={disabled}\n        onChange={e => {\n          const file = e.target.files[0];\n          e.target.value = null;\n          this.inputFiles[name] = file;\n          URL.revokeObjectURL(this.state.avatar.files[name]);\n          this.setState({\n            avatar: {\n              ...this.state.avatar,\n              files: {\n                ...this.state.avatar.files,\n                [name]: URL.createObjectURL(file)\n              }\n            }\n          });\n        }}\n      />\n      {this.state.avatar.files[name] && (\n        <a\n          onClick={() => {\n            this.inputFiles[name] = null;\n            URL.revokeObjectURL(this.state.avatar.files[name]);\n            this.setState({\n              avatar: {\n                ...this.state.avatar,\n                files: {\n                  ...this.state.avatar.files,\n                  [name]: null\n                }\n              }\n            });\n          }}\n        >\n          <i>\n            <FontAwesomeIcon icon={faTimes} />\n          </i>\n        </a>\n      )}\n    </div>\n  );\n\n  textField = (name, placeholder, disabled, required) => (\n    <div>\n      <input\n        id={`avatar-${name}`}\n        type=\"text\"\n        disabled={disabled}\n        required={required}\n        placeholder={placeholder}\n        className=\"text-field\"\n        value={this.state.avatar[name] || \"\"}\n        onChange={e => this.setState({ avatar: { ...this.state.avatar, [name]: e.target.value } })}\n      />\n    </div>\n  );\n\n  textarea = (name, placeholder, disabled) => (\n    <div>\n      <textarea\n        id={`avatar-${name}`}\n        disabled={disabled}\n        placeholder={placeholder}\n        className=\"textarea\"\n        value={this.state.avatar[name] || \"\"}\n        onChange={e => this.setState({ avatar: { ...this.state.avatar, [name]: e.target.value } })}\n      />\n    </div>\n  );\n\n  checkbox = (name, children, disabled) => (\n    <div className=\"checkbox-container\">\n      <input\n        id={`avatar-${name}`}\n        type=\"checkbox\"\n        className=\"checkbox\"\n        disabled={disabled}\n        checked={!!this.state.avatar[name]}\n        onChange={e => this.setState({ avatar: { ...this.state.avatar, [name]: e.target.checked } })}\n      />\n      <label htmlFor={`#avatar-${name}`}>{children}</label>\n    </div>\n  );\n\n  render() {\n    const { debug } = this.props;\n    return (\n      <div className={classNames(styles.avatarEditor, this.props.className)}>\n        {this.props.onClose && (\n          <a className=\"close-button\" onClick={this.props.onClose}>\n            <i>\n              <FontAwesomeIcon icon={faTimes} />\n            </i>\n          </a>\n        )}\n        {this.props.signedIn ? (\n          <div className=\"center\">\n            <div className=\"split\">\n              <div className=\"form-body\">\n                {debug && this.textField(\"avatar_id\", \"Avatar ID\", true)}\n                {debug && this.textField(\"parent_avatar_id\", \"Parent Avatar ID\")}\n                {this.textField(\"name\", \"Name\", false, true)}\n                {debug && this.textarea(\"description\", \"Description\")}\n                {debug && this.fileField(\"glb\", \"Avatar GLB\", \"model/gltf+binary,.glb\")}\n\n                {this.mapField(\"base_map\", \"Base Map\", \"image/*\")}\n                {this.mapField(\"emissive_map\", \"Emissive Map\", \"image/*\")}\n                {this.mapField(\"normal_map\", \"Normal Map\", \"image/*\")}\n\n                {this.mapField(\"orm_map\", \"ORM Map\", \"image/*\", false, \"Occlussion (r), Roughness (g), Metallic (b)\")}\n\n                <hr />\n\n                {this.checkbox(\n                  \"allow_promotion\",\n                  <span>\n                    Allow{\" \"}\n                    <a\n                      href=\"https://github.com/mozilla/hubs/blob/master/PROMOTION.md\"\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                    >\n                      Promotion\n                    </a>\n                  </span>\n                )}\n                {this.checkbox(\n                  \"allow_remixing\",\n                  <span>\n                    Allow{\" \"}\n                    <a\n                      href=\"https://github.com/mozilla/hubs/blob/master/REMIXING.md\"\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                    >\n                      Remixing\n                    </a>{\" \"}\n                    <span className=\"license\">\n                      (under{\" \"}\n                      <a href=\"https://creativecommons.org/licenses/by/3.0/\" target=\"_blank\" rel=\"noopener noreferrer\">\n                        CC-BY 3.0\n                      </a>)\n                    </span>\n                  </span>\n                )}\n                {this.textField(\"creatorAttribution\", \"Attribution (optional)\", false, false)}\n\n                {/* {this.mapField(\"ao_map\", \"AO Map\", \"images/\\*\", true)} */}\n                {/* {this.mapField(\"metallic_map\", \"Metallic Map\", \"image/\\*\", true)} */}\n                {/* {this.mapField(\"roughness_map\", \"Roughness Map\", \"image/\\*\", true)} */}\n              </div>\n              <AvatarPreview\n                className=\"preview\"\n                avatarGltfUrl={this.state.previewGltfUrl}\n                {...this.inputFiles}\n                ref={p => (this.preview = p)}\n              />\n            </div>\n            <div className=\"info\">\n              <p>\n                <FormattedMessage id=\"avatar-editor.info\" />\n                <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://github.com/j-conrad/hubs-avatar-pipelines\">\n                  <FormattedMessage id=\"avatar-editor.info-link\" />\n                </a>\n              </p>\n            </div>\n            <div>\n              <input\n                disabled={this.state.uploading}\n                onClick={this.uploadAvatar}\n                className=\"form-submit\"\n                type=\"submit\"\n                value={this.state.uploading ? \"Uploading...\" : \"Save\"}\n              />\n            </div>\n            {!this.props.hideDelete && (\n              <div className=\"delete-avatar\">\n                {this.state.confirmDelete ? (\n                  <span>\n                    are you sure? <a onClick={this.deleteAvatar}>yes</a> /{\" \"}\n                    <a onClick={() => this.setState({ confirmDelete: false })}>no</a>\n                  </span>\n                ) : (\n                  <a onClick={() => this.setState({ confirmDelete: true })}>delete avatar</a>\n                )}\n              </div>\n            )}\n          </div>\n        ) : (\n          <a onClick={this.props.onSignIn}>\n            <FormattedMessage id=\"sign-in.in\" />\n          </a>\n        )}\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport styles from \"../assets/stylesheets/presence-log.scss\";\nimport classNames from \"classnames\";\n\nimport { share } from \"../utils/share\";\nimport { getLandingPageForPhoto } from \"../utils/phoenix-utils\";\n\nexport default function PhotoMessage({ name, body: { src: url }, className, maySpawn, hubId }) {\n  const landingPageUrl = getLandingPageForPhoto(url);\n  const onShareClicked = share.bind(null, {\n    url: landingPageUrl,\n    title: `Taken in #hubs, join me at https://hub.link/${hubId}`\n  });\n  return (\n    <div className={className}>\n      {maySpawn && <button className={classNames(styles.iconButton, styles.share)} onClick={onShareClicked} />}\n      <div className={styles.mediaBody}>\n        <span>\n          <b>{name}</b>\n        </span>\n        <span>\n          {\"took a \"}\n          <b>\n            <a href={landingPageUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n              photo\n            </a>\n          </b>.\n        </span>\n      </div>\n      <a href={landingPageUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n        <img src={url} />\n      </a>\n    </div>\n  );\n}\nPhotoMessage.propTypes = {\n  name: PropTypes.string,\n  maySpawn: PropTypes.bool,\n  body: PropTypes.object,\n  className: PropTypes.string,\n  hubId: PropTypes.string\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"../assets/stylesheets/presence-log.scss\";\nimport classNames from \"classnames\";\nimport { proxiedUrlFor } from \"../utils/media-utils\";\n\nfunction spawnImage(url) {\n  document.querySelector(\"a-scene\").emit(\"add_media\", url);\n}\n\nexport default function ImageMessage({ name, body: { src: url }, className, maySpawn }) {\n  return (\n    <div className={className}>\n      {maySpawn && (\n        <button className={classNames(styles.iconButton, styles.spawnMessage)} onClick={() => spawnImage(url)} />\n      )}\n      <div className={styles.mediaBody}>{name && <div className={styles.messageSource}>{name}:</div>}</div>\n      <a href={url} target=\"_blank\" rel=\"noopener noreferrer\">\n        <img src={proxiedUrlFor(url)} />\n      </a>\n    </div>\n  );\n}\n\nImageMessage.propTypes = {\n  name: PropTypes.string,\n  maySpawn: PropTypes.bool,\n  body: PropTypes.object,\n  className: PropTypes.string\n};\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"../assets/stylesheets/presence-log.scss\";\nimport classNames from \"classnames\";\nimport { FormattedMessage } from \"react-intl\";\n\nimport ChatMessage from \"./chat-message\";\nimport PhotoMessage from \"./photo-message\";\nimport ImageMessage from \"./image-message\";\n\nexport default class PresenceLog extends Component {\n  static propTypes = {\n    entries: PropTypes.array,\n    inRoom: PropTypes.bool,\n    hubId: PropTypes.string,\n    history: PropTypes.object\n  };\n\n  constructor(props) {\n    super(props);\n  }\n\n  domForEntry = e => {\n    const entryClasses = {\n      [styles.presenceLogEntry]: true,\n      [styles.presenceLogEntryWithButton]: (e.type === \"chat\" || e.type === \"image\") && e.maySpawn,\n      [styles.presenceLogChat]: e.type === \"chat\",\n      [styles.expired]: !!e.expired\n    };\n\n    switch (e.type) {\n      case \"join\":\n      case \"entered\":\n        return (\n          <div key={e.key} className={classNames(entryClasses)}>\n            <b>{e.name}</b>&nbsp;<FormattedMessage id={`presence.${e.type}_${e.presence}`} />\n          </div>\n        );\n      case \"leave\":\n        return (\n          <div key={e.key} className={classNames(entryClasses)}>\n            <b>{e.name}</b>&nbsp;<FormattedMessage id={`presence.${e.type}`} />\n          </div>\n        );\n      case \"display_name_changed\":\n        return (\n          <div key={e.key} className={classNames(entryClasses)}>\n            <b>{e.oldName}</b>&nbsp;<FormattedMessage id=\"presence.name_change\" />&nbsp;<b>{e.newName}</b>.\n          </div>\n        );\n      case \"scene_changed\":\n        return (\n          <div key={e.key} className={classNames(entryClasses)}>\n            <b>{e.name}</b>&nbsp;<FormattedMessage id=\"presence.scene_change\" />&nbsp;<b>{e.sceneName}</b>.\n          </div>\n        );\n      case \"hub_name_changed\":\n        return (\n          <div key={e.key} className={classNames(entryClasses)}>\n            <b>{e.name}</b>&nbsp;<FormattedMessage id=\"presence.hub_name_change\" />&nbsp;<b>{e.hubName}</b>.\n          </div>\n        );\n      case \"chat\":\n        return (\n          <ChatMessage\n            key={e.key}\n            name={e.name}\n            className={classNames(entryClasses)}\n            body={e.body}\n            maySpawn={e.maySpawn}\n            sessionId={e.sessionId}\n            history={this.props.history}\n          />\n        );\n      case \"image\":\n        return (\n          <ImageMessage\n            key={e.key}\n            name={e.name}\n            className={classNames(entryClasses, styles.media)}\n            body={e.body}\n            maySpawn={e.maySpawn}\n          />\n        );\n      case \"photo\":\n        return (\n          <PhotoMessage\n            key={e.key}\n            name={e.name}\n            className={classNames(entryClasses, styles.media)}\n            body={e.body}\n            maySpawn={e.maySpawn}\n            hubId={this.props.hubId}\n          />\n        );\n      case \"log\":\n        return (\n          <div key={e.key} className={classNames(entryClasses)}>\n            {e.body}\n          </div>\n        );\n    }\n  };\n\n  render() {\n    const presenceClasses = {\n      [styles.presenceLog]: true,\n      [styles.presenceLogInRoom]: this.props.inRoom\n    };\n\n    return <div className={classNames(presenceClasses)}>{this.props.entries.map(this.domForEntry)}</div>;\n  }\n}\n","import { sets } from \"./userinput/sets\";\nimport { paths } from \"./userinput/paths\";\n\n// The output of this system is activeTips which shows, if any, the tips to show at the top\n// and bottom of the screen. There are named tips (eg locomotion) that each have validators.\n//\n// Each frame we run all the non-finished validators and take the first tip (by order)\n// which is VALID. Any tip that returns FINISHED will no longer be considered without\n// a local storage reset.\n\n// Validators can return these values:\n//\n// INVALID - Tip is not valid to show\n// VALID - Tip is valid to show\n// FINISH - Tip should always be assumed INVALID going forward\n//\n//\n// Tips have \"scope\", which is a certain context within which the validators are run (right now,\n// just the top of bottom of the screen.) They are also platform-local.\nconst INVALID = 0;\nconst VALID = 1;\nconst FINISH = 2;\n\nconst LOCAL_STORAGE_KEY = \"__hubs_finished_tips\";\n\nconst TIPS = {\n  desktop: {\n    top: [\"mirror_mode\", \"pen_mode\", \"video_share_mode\", \"mute_mode\"],\n    bottom: [\n      \"look\",\n      \"locomotion\",\n      \"turning\",\n      \"spawn_menu\",\n      \"object_grab\",\n      \"object_zoom\",\n      \"object_scale\",\n      \"freeze_gesture\",\n      \"menu_hover\",\n      \"object_recenter_button\",\n      \"object_rotate_button\",\n      \"object_scale_button\",\n      \"object_pin\",\n      \"invite\",\n      \"pen_color\",\n      \"pen_size\"\n    ]\n  },\n  mobile: {\n    top: [\"pen_mode\", \"video_share_mode\", \"freeze_mode\", \"mute_mode\"],\n    bottom: [\n      \"look\",\n      \"locomotion\",\n      \"spawn_menu\",\n      \"object_grab\",\n      \"freeze_gesture\",\n      \"object_recenter_button\",\n      \"object_rotate_button\",\n      \"object_scale_button\",\n      \"object_pin\",\n      \"invite\"\n    ]\n  },\n  standalone: { top: [], bottom: [] }\n};\n\n// These tips, if closed, will only clear themselves, not all tips.\nconst LOCAL_CLOSE_TIPS = [\"invite\", \"object_pin\"];\n\nlet localStorageCache = null;\nlet finishedScopes = {}; // Optimization, lets system skip scopes altogether once finished.\n\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\n\nconst tipPlatform = () => {\n  if (isMobileVR) return \"standalone\";\n  return isMobile ? \"mobile\" : \"desktop\";\n};\n\nconst platformTips = TIPS[tipPlatform()];\n\nconst isTipFinished = tip => {\n  if (localStorageCache === null) {\n    localStorageCache = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY));\n  }\n\n  return !!(localStorageCache[tip] && localStorageCache[tip].finished);\n};\n\nexport const markTipFinished = tip => {\n  const storeData = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY));\n  storeData[tip] = { finished: true };\n  localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(storeData));\n  localStorageCache = null;\n};\n\nexport const handleTipClose = (fullTip, scope) => {\n  const tip = fullTip.split(\".\")[1];\n\n  // Invite and pinning tips should be locally cleared, others should clear all remaining tips.\n  const tips = LOCAL_CLOSE_TIPS.includes(tip) ? [tip] : platformTips[scope];\n\n  for (let i = 0; i < tips.length; i++) {\n    const tip = tips[i];\n    markTipFinished(tip);\n  }\n};\n\nexport const resetTips = () => {\n  localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify({}));\n  localStorageCache = null;\n  window.APP.store.resetTipActivityFlags();\n  window.APP.store.resetConfirmedDiscordRooms();\n  finishedScopes = {};\n};\n\nconst VALIDATORS = {\n  look: function(userinput) {\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    const cameraDelta = userinput.get(\n      isMobile ? paths.device.touchscreen.touchCameraDelta : paths.device.smartMouse.cameraDelta\n    );\n    return cameraDelta ? FINISH : VALID;\n  },\n  locomotion: function(userinput) {\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    const accel = userinput.get(paths.actions.characterAcceleration);\n\n    // User moved\n    return accel && (accel[0] !== 0 || accel[1] !== 0) ? FINISH : VALID;\n  },\n  turning: function(userinput) {\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (userinput.get(paths.actions.snapRotateLeft) || userinput.get(paths.actions.snapRotateRight)) return FINISH;\n    return VALID;\n  },\n  spawn_menu: function(userinput, scene, mediaCounter) {\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (mediaCounter.count() === 0) return VALID;\n    return FINISH;\n  },\n  freeze_gesture: function(userinput, scene, mediaCounter) {\n    if (mediaCounter.count() === 0) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingInteractable)) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (scene.is(\"frozen\") && userinput.activeSets.includes(sets.cursorHoveringOnInteractable)) return FINISH;\n    return scene.is(\"frozen\") ? INVALID : VALID;\n  },\n  menu_hover: function(userinput, scene, mediaCounter) {\n    if (mediaCounter.count() === 0) return INVALID;\n    if (!scene.is(\"frozen\")) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (scene.is(\"frozen\") && userinput.activeSets.includes(sets.cursorHoveringOnInteractable)) return FINISH;\n    return VALID;\n  },\n  invite: function(userinput, scene) {\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingCamera)) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingInteractable)) return INVALID;\n    return scene.is(\"copresent\") ? FINISH : VALID;\n  },\n  object_grab: function(userinput, scene, mediaCounter) {\n    if (scene.is(\"frozen\")) return INVALID;\n    if (mediaCounter.count() === 0) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingCamera)) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingInteractable)) return FINISH;\n    return VALID;\n  },\n  object_rotate_button: function(userinput, scene, mediaCounter, store) {\n    if (!scene.is(\"frozen\")) return INVALID;\n    if (mediaCounter.count() === 0) return INVALID;\n    if (store && store.state.activity.hasRotated) return FINISH;\n    return VALID;\n  },\n  object_scale_button: function(userinput, scene, mediaCounter, store) {\n    if (!scene.is(\"frozen\")) return INVALID;\n    if (mediaCounter.count() === 0) return INVALID;\n    if (store && store.state.activity.hasScaled) return FINISH;\n    return VALID;\n  },\n  object_recenter_button: function(userinput, scene, mediaCounter, store) {\n    if (!scene.is(\"frozen\")) return INVALID;\n    if (mediaCounter.count() === 0) return INVALID;\n    if (store && store.state.activity.hasRecentered) return FINISH;\n    return VALID;\n  },\n  object_pin: function(userinput, scene, mediaCounter, store) {\n    if (!scene.is(\"frozen\")) return INVALID;\n    if (mediaCounter.count() === 0) return INVALID;\n    if (store && store.state.activity.hasPinned) return FINISH;\n    return VALID;\n  },\n  object_zoom: function(userinput, scene) {\n    if (scene.is(\"frozen\")) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingCamera)) return INVALID;\n    if (!userinput.activeSets.includes(sets.cursorHoldingInteractable)) return INVALID;\n    if (userinput.get(paths.actions.cursor.modDelta)) return FINISH;\n    return VALID;\n  },\n  object_scale: function(userinput, scene) {\n    if (scene.is(\"frozen\")) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingCamera)) return INVALID;\n    if (!userinput.activeSets.includes(sets.cursorHoldingInteractable)) return INVALID;\n    if (userinput.get(paths.actions.cursor.scaleGrabbedGrabbable)) return FINISH;\n    return VALID;\n  },\n  pen_color: function(userinput) {\n    if (!userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (userinput.get(paths.actions.cursor.penNextColor) || userinput.get(paths.actions.cursor.penPrevColor)) {\n      return FINISH;\n    }\n    return VALID;\n  },\n  pen_size: function(userinput) {\n    if (!userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (userinput.get(paths.actions.cursor.scalePenTip)) return FINISH;\n    return VALID;\n  },\n  pen_mode: function(userinput) {\n    if (!userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    return VALID;\n  },\n  freeze_mode: function(userinput, scene) {\n    return scene.is(\"frozen\") ? VALID : INVALID;\n  },\n  video_share_mode: function(userinput, scene) {\n    return scene.is(\"sharing_video\") ? VALID : INVALID;\n  },\n  mirror_mode: function(userinput, scene) {\n    return scene.is(\"mirroring\") ? VALID : INVALID;\n  },\n  mute_mode: function(userinput, scene) {\n    return scene.is(\"muted\") ? VALID : INVALID;\n  }\n};\n\nAFRAME.registerSystem(\"tips\", {\n  init: function() {\n    this.activeTips = {};\n    this._finishedScopes = {};\n    this._performStep = this._performStep.bind(this);\n\n    if (localStorage.getItem(LOCAL_STORAGE_KEY) === null) {\n      localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify({}));\n    }\n  },\n\n  tick: function() {\n    if (!this._userinput) {\n      this._userinput = this.el.systems.userinput;\n\n      if (!this._userinput) return;\n    }\n\n    if (!this._mediaCounter) {\n      this._mediaCounter =\n        document.querySelector(\"#media-counter\") &&\n        document.querySelector(\"#media-counter\").components[\"networked-counter\"];\n\n      if (!this._mediaCounter) return;\n    }\n\n    const tips = platformTips;\n\n    const prevTop = this.activeTips.top;\n    const prevBottom = this.activeTips.bottom;\n\n    this._performStep(tips.top, \"top\");\n    this._performStep(tips.bottom, \"bottom\");\n\n    if (prevTop !== this.activeTips.top || prevBottom !== this.activeTips.bottom) {\n      this.el.emit(\"tips_changed\", this.activeTips);\n    }\n  },\n\n  _performStep: function(tips, scope) {\n    if (finishedScopes[scope]) return;\n\n    let chosenTip = null;\n    let finishCount = 0;\n\n    for (let i = 0; i < tips.length; i++) {\n      const tip = tips[i];\n      if (isTipFinished(tip)) {\n        finishCount++;\n        continue;\n      }\n\n      switch (VALIDATORS[tip](this._userinput, this.el, this._mediaCounter, window.APP.store)) {\n        case FINISH:\n          markTipFinished(tip);\n          break;\n        case VALID:\n          chosenTip = `${tipPlatform()}.${tip}`;\n          break;\n      }\n\n      if (chosenTip) break;\n    }\n\n    this.activeTips[scope] = chosenTip;\n\n    if (finishCount === tips.length) {\n      // Optimization: Tips are completed for this scope, no need to re-walk.\n      finishedScopes[scope] = true;\n    }\n  }\n});\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\nimport classNames from \"classnames\";\nimport StateLink from \"./state-link.js\";\nimport { resetTips } from \"../systems/tips\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faImage } from \"@fortawesome/free-solid-svg-icons/faImage\";\nimport { faDoorClosed } from \"@fortawesome/free-solid-svg-icons/faDoorClosed\";\nimport { faPencilAlt } from \"@fortawesome/free-solid-svg-icons/faPencilAlt\";\nimport { faInfoCircle } from \"@fortawesome/free-solid-svg-icons/faInfoCircle\";\nimport { faPlus } from \"@fortawesome/free-solid-svg-icons/faPlus\";\nimport { showFullScreenIfAvailable } from \"../utils/fullscreen\";\n\nimport styles from \"../assets/stylesheets/settings-menu.scss\";\n\nexport default class SettingsMenu extends Component {\n  static propTypes = {\n    history: PropTypes.object,\n    hideSettings: PropTypes.func,\n    mediaSearchStore: PropTypes.object,\n    hubScene: PropTypes.object,\n    hubChannel: PropTypes.object,\n    performConditionalSignIn: PropTypes.func,\n    pushHistoryState: PropTypes.func\n  };\n\n  render() {\n    const rowClasses = classNames([styles.row, styles.settingsRow]);\n    const rowHeader = classNames([styles.row, styles.settingsRow, styles.rowHeader]);\n    const showRoomSettings = !!this.props.hubChannel.canOrWillIfCreator(\"update_hub\");\n    const showCloseRoom = !!this.props.hubChannel.canOrWillIfCreator(\"close_hub\");\n    const showRoomInfo = !!this.props.hubScene;\n    const showRoomSection = showRoomSettings || showRoomInfo || showCloseRoom;\n\n    // Draw self first\n    return (\n      <div className={styles.settingsMenu}>\n        <div className={styles.attachPoint} />\n        <div className={styles.contents}>\n          <div className={styles.rows}>\n            <div className={rowHeader}>\n              <FormattedMessage id=\"settings.row-profile\" />\n            </div>\n            <div className={rowClasses}>\n              <div className={styles.icon}>\n                <img src=\"../assets/images/change_avatar.svg\" />\n              </div>\n              <div className={styles.listItem}>\n                <StateLink\n                  stateKey=\"overlay\"\n                  stateValue=\"profile\"\n                  history={this.props.history}\n                  onClick={this.props.hideSettings}\n                >\n                  <FormattedMessage id=\"settings.change-avatar\" />\n                </StateLink>\n              </div>\n            </div>\n            {showRoomSection && (\n              <div className={rowHeader}>\n                <FormattedMessage id=\"settings.row-room\" />\n              </div>\n            )}\n            {showRoomSettings && (\n              <div className={rowClasses}>\n                <div className={styles.icon}>\n                  <i>\n                    <FontAwesomeIcon icon={faImage} />\n                  </i>\n                </div>\n                <div className={styles.listItem}>\n                  <div\n                    className={styles.listItemLink}\n                    onClick={() => {\n                      this.props.performConditionalSignIn(\n                        () => this.props.hubChannel.can(\"update_hub\"),\n                        () => {\n                          showFullScreenIfAvailable();\n                          this.props.mediaSearchStore.sourceNavigateWithNoNav(\"scenes\");\n                          this.props.hideSettings();\n                        },\n                        \"change-scene\"\n                      );\n                    }}\n                  >\n                    <FormattedMessage id=\"settings.change-scene\" />\n                  </div>\n                </div>\n              </div>\n            )}\n            {showRoomSettings && (\n              <div className={rowClasses}>\n                <div className={styles.icon}>\n                  <i>\n                    <FontAwesomeIcon icon={faPencilAlt} />\n                  </i>\n                </div>\n                <div className={styles.listItem}>\n                  <a\n                    href=\"#\"\n                    onClick={e => {\n                      e.preventDefault();\n\n                      this.props.performConditionalSignIn(\n                        () => this.props.hubChannel.can(\"update_hub\"),\n                        () => {\n                          this.props.pushHistoryState(\"modal\", \"rename_room\");\n                          this.props.hideSettings();\n                        },\n                        \"rename-room\"\n                      );\n                    }}\n                  >\n                    <FormattedMessage id=\"settings.rename-room\" />\n                  </a>\n                </div>\n              </div>\n            )}\n            {showCloseRoom && (\n              <div className={rowClasses}>\n                <div className={styles.icon}>\n                  <i>\n                    <FontAwesomeIcon icon={faDoorClosed} />\n                  </i>\n                </div>\n                <div className={styles.listItem}>\n                  <a\n                    href=\"#\"\n                    onClick={e => {\n                      e.preventDefault();\n\n                      this.props.performConditionalSignIn(\n                        () => this.props.hubChannel.can(\"update_hub\"),\n                        () => {\n                          this.props.pushHistoryState(\"modal\", \"close_room\");\n                          this.props.hideSettings();\n                        },\n                        \"close-room\"\n                      );\n                    }}\n                  >\n                    <FormattedMessage id=\"settings.close-room\" />\n                  </a>\n                </div>\n              </div>\n            )}\n            {showRoomInfo && (\n              <div className={rowClasses}>\n                <div className={styles.icon}>\n                  <i>\n                    <FontAwesomeIcon icon={faInfoCircle} />\n                  </i>\n                </div>\n                <div className={styles.listItem}>\n                  <StateLink\n                    stateKey=\"modal\"\n                    stateValue=\"room_info\"\n                    history={this.props.history}\n                    onClick={this.props.hideSettings}\n                  >\n                    <FormattedMessage id=\"settings.room-info\" />\n                  </StateLink>\n                </div>\n              </div>\n            )}\n            <div className={rowClasses}>\n              <div className={styles.icon}>\n                <i>\n                  <FontAwesomeIcon icon={faPlus} />\n                </i>\n              </div>\n              <div className={styles.listItem}>\n                <a href=\"/\" onClick={this.props.hideSettings}>\n                  <FormattedMessage id=\"settings.create-room\" />\n                </a>\n              </div>\n            </div>\n            <div className={classNames([styles.bottomLinksMain])}>\n              <a href=\"/whats-new\" target=\"_blank\" rel=\"noreferrer noopener\">\n                <FormattedMessage id=\"settings.whats-new\" />\n              </a>\n              <button\n                onClick={e => {\n                  e.preventDefault();\n                  resetTips();\n                  this.props.hideSettings();\n                }}\n              >\n                <FormattedMessage id=\"settings.tips\" />\n              </button>\n              <a href=\"https://github.com/mozilla/hubs/wiki/Hubs-Controls\" target=\"_blank\" rel=\"noreferrer noopener\">\n                <FormattedMessage id=\"settings.controls\" />\n              </a>\n            </div>\n            <div className={classNames([styles.bottomLinks])}>\n              <a href=\"https://github.com/mozilla/hubs/wiki/Hubs-Features\" target=\"_blank\" rel=\"noreferrer noopener\">\n                <FormattedMessage id=\"settings.features\" />\n              </a>\n              <a href=\"https://discord.gg/wHmY4nd\" target=\"_blank\" rel=\"noreferrer noopener\">\n                <FormattedMessage id=\"settings.community\" />\n              </a>\n              <a target=\"_blank\" href=\"https://forms.gle/1g4H5Ayd1mGWqWpV7\" rel=\"noopener noreferrer\">\n                <FormattedMessage id=\"settings.send-feedback\" />\n              </a>\n              <a className={styles.bottomLink} href=\"/?report\" target=\"_blank\" rel=\"noreferrer noopener\">\n                <FormattedMessage id=\"settings.report\" />\n              </a>\n              <a\n                className={styles.bottomLink}\n                href=\"https://github.com/mozilla/hubs/blob/master/TERMS.md\"\n                target=\"_blank\"\n                rel=\"noreferrer noopener\"\n              >\n                <FormattedMessage id=\"settings.terms\" />\n              </a>\n              <a\n                className={styles.bottomLink}\n                href=\"https://github.com/mozilla/hubs/blob/master/PRIVACY.md\"\n                target=\"_blank\"\n                rel=\"noreferrer noopener\"\n              >\n                <FormattedMessage id=\"settings.privacy\" />\n              </a>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport cx from \"classnames\";\n\nconst { detect } = require(\"detect-browser\");\nimport styles from \"../assets/stylesheets/2d-hud.scss\";\nimport uiStyles from \"../assets/stylesheets/ui-root.scss\";\nimport { FormattedMessage } from \"react-intl\";\n\nconst browser = detect();\n\nclass TopHUD extends Component {\n  static propTypes = {\n    muted: PropTypes.bool,\n    isCursorHoldingPen: PropTypes.bool,\n    hasActiveCamera: PropTypes.bool,\n    frozen: PropTypes.bool,\n    videoShareMediaSource: PropTypes.string,\n    activeTip: PropTypes.string,\n    history: PropTypes.object,\n    onToggleMute: PropTypes.func,\n    onToggleFreeze: PropTypes.func,\n    onSpawnPen: PropTypes.func,\n    onSpawnCamera: PropTypes.func,\n    onShareVideo: PropTypes.func,\n    onEndShareVideo: PropTypes.func,\n    onShareVideoNotCapable: PropTypes.func,\n    mediaSearchStore: PropTypes.object\n  };\n\n  state = {\n    showVideoShareOptions: false,\n    lastActiveMediaSource: null\n  };\n\n  handleVideoShareClicked = source => {\n    if ((source === \"screen\" || source === \"window\") && browser.name !== \"firefox\") {\n      this.props.onShareVideoNotCapable();\n      return;\n    }\n\n    if (this.props.videoShareMediaSource) {\n      this.props.onEndShareVideo();\n    } else {\n      this.props.onShareVideo(source);\n      this.setState({ lastActiveMediaSource: source });\n    }\n  };\n\n  buildVideoSharingButtons = () => {\n    const isMobile = AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR();\n\n    const videoShareExtraOptionTypes = [];\n    const primaryVideoShareType =\n      this.props.videoShareMediaSource || this.state.lastActiveMediaSource || (isMobile ? \"camera\" : \"screen\");\n\n    if (this.state.showVideoShareOptions) {\n      videoShareExtraOptionTypes.push(primaryVideoShareType);\n\n      [\"screen\", \"window\", \"camera\"].forEach(t => {\n        if (videoShareExtraOptionTypes.indexOf(t) === -1) {\n          videoShareExtraOptionTypes.push(t);\n        }\n      });\n    }\n\n    const showExtrasOnHover = () => {\n      if (isMobile) return;\n\n      clearTimeout(this.hideVideoSharingButtonTimeout);\n\n      if (!this.props.videoShareMediaSource) {\n        this.setState({ showVideoShareOptions: true });\n      }\n    };\n\n    const hideExtrasOnOut = () => {\n      this.hideVideoSharingButtonTimeout = setTimeout(() => {\n        this.setState({ showVideoShareOptions: false });\n      }, 250);\n    };\n\n    return (\n      <div\n        className={cx(styles.iconButton, styles[`share_${primaryVideoShareType}`], {\n          [styles.active]: this.props.videoShareMediaSource === primaryVideoShareType,\n          [styles.videoShare]: true\n        })}\n        title={this.props.videoShareMediaSource !== null ? \"Stop sharing\" : `Share ${primaryVideoShareType}`}\n        onClick={() => {\n          if (!this.state.showVideoShareOptions) {\n            this.handleVideoShareClicked(primaryVideoShareType);\n          }\n        }}\n        onMouseOver={showExtrasOnHover}\n      >\n        {videoShareExtraOptionTypes.length > 0 && (\n          <div className={cx(styles.videoShareExtraOptions)} onMouseOut={hideExtrasOnOut}>\n            {videoShareExtraOptionTypes.map(type => (\n              <div\n                key={type}\n                className={cx(styles.iconButton, styles[`share_${type}`], {\n                  [styles.active]: this.props.videoShareMediaSource === type\n                })}\n                title={this.props.videoShareMediaSource === type ? \"Stop sharing\" : `Share ${type}`}\n                onClick={() => this.handleVideoShareClicked(type)}\n                onMouseOver={showExtrasOnHover}\n              />\n            ))}\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  render() {\n    const videoSharingButtons = this.buildVideoSharingButtons();\n\n    const tip = this.props.activeTip && (\n      <div className={cx(styles.topTip)}>\n        <div className={cx([styles.attachPoint, styles[`attach_${this.props.activeTip.split(\".\")[1]}`]])} />\n        <FormattedMessage id={`tips.${this.props.activeTip}`} />\n      </div>\n    );\n\n    // Hide buttons when frozen.\n    return (\n      <div className={cx(styles.container, styles.top, styles.unselectable, uiStyles.uiInteractive)}>\n        {this.props.frozen ? (\n          <div className={cx(uiStyles.uiInteractive, styles.panel)}>{tip}</div>\n        ) : (\n          <div className={cx(uiStyles.uiInteractive, styles.panel)}>\n            {tip}\n            {videoSharingButtons}\n            <div\n              className={cx(styles.iconButton, styles.mute, { [styles.active]: this.props.muted })}\n              title={this.props.muted ? \"Unmute Mic\" : \"Mute Mic\"}\n              onClick={this.props.onToggleMute}\n            />\n            <button\n              className={cx(uiStyles.uiInteractive, styles.iconButton, styles.spawn)}\n              onClick={() => this.props.mediaSearchStore.sourceNavigateToDefaultSource()}\n            />\n            <div\n              className={cx(styles.iconButton, styles.pen, { [styles.active]: this.props.isCursorHoldingPen })}\n              title={\"Pen\"}\n              onClick={this.props.onSpawnPen}\n            />\n            <div\n              className={cx(styles.iconButton, styles.camera, { [styles.active]: this.props.hasActiveCamera })}\n              title={\"Camera\"}\n              onClick={this.props.onSpawnCamera}\n            />\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default { TopHUD };\n","import { showFullScreenIfAvailable } from \"./fullscreen\";\nimport screenfull from \"screenfull\";\n\nlet _isIn2DInterstitial = false;\nlet _exitAction = null;\n\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\n\nconst afterUserGesturePrompt = f => {\n  const scene = document.querySelector(\"a-scene\");\n  scene.addEventListener(\"2d-interstitial-gesture-complete\", f, { once: true });\n  scene.emit(\"2d-interstitial-gesture-required\");\n};\n\nexport function handleExitTo2DInterstitial(isLower, exitAction) {\n  const scene = document.querySelector(\"a-scene\");\n  if (!scene.is(\"vr-mode\")) return;\n\n  _isIn2DInterstitial = true;\n  _exitAction = exitAction;\n\n  if (isMobileVR) {\n    // Immersive browser, exit VR.\n    scene.exitVR().then(() => {\n      afterUserGesturePrompt(() => showFullScreenIfAvailable());\n    });\n  } else {\n    // Non-immersive browser, show notice\n    const vrNotice = document.querySelector(\".vr-notice\");\n    vrNotice.object3D.visible = true;\n    vrNotice.setAttribute(\"follow-in-fov\", {\n      angle: isLower ? 39 : -15\n    });\n  }\n}\n\nexport function handleReEntryToVRFrom2DInterstitial() {\n  if (!_isIn2DInterstitial) return;\n  _isIn2DInterstitial = false;\n\n  document.querySelector(\".vr-notice\").object3D.visible = false;\n\n  if (isMobileVR) {\n    const scene = document.querySelector(\"a-scene\");\n\n    if (screenfull.isFullscreen) {\n      screenfull.exit();\n      afterUserGesturePrompt(() => scene.enterVR());\n    } else {\n      scene.enterVR();\n    }\n  }\n}\n\nexport function isIn2DInterstitial() {\n  return _isIn2DInterstitial;\n}\n\nexport function forceExitFrom2DInterstitial() {\n  if (!_isIn2DInterstitial) return;\n\n  if (_exitAction) {\n    _exitAction();\n    _exitAction = null;\n  }\n\n  handleReEntryToVRFrom2DInterstitial();\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport copy from \"copy-to-clipboard\";\nimport { IntlProvider, FormattedMessage, addLocaleData } from \"react-intl\";\nimport en from \"react-intl/locale-data/en\";\nimport MovingAverage from \"moving-average\";\nimport screenfull from \"screenfull\";\n\nimport { VR_DEVICE_AVAILABILITY } from \"../utils/vr-caps-detect\";\nimport styles from \"../assets/stylesheets/ui-root.scss\";\nimport entryStyles from \"../assets/stylesheets/entry.scss\";\nimport inviteStyles from \"../assets/stylesheets/invite-dialog.scss\";\nimport { ReactAudioContext, WithHoverSound } from \"./wrap-with-audio\";\nimport {\n  pushHistoryState,\n  clearHistoryState,\n  popToBeginningOfHubHistory,\n  navigateToPriorPage,\n  sluglessPath\n} from \"../utils/history\";\nimport StateLink from \"./state-link.js\";\nimport StateRoute from \"./state-route.js\";\nimport { getPresenceProfileForSession } from \"../utils/phoenix-utils\";\nimport { getClientInfoClientId } from \"./client-info-dialog\";\n\nimport { lang, messages } from \"../utils/i18n\";\nimport Loader from \"./loader\";\nimport AutoExitWarning from \"./auto-exit-warning\";\nimport {\n  TwoDEntryButton,\n  DeviceEntryButton,\n  GenericEntryButton,\n  DaydreamEntryButton,\n  SafariEntryButton\n} from \"./entry-buttons.js\";\nimport ProfileEntryPanel from \"./profile-entry-panel\";\nimport MediaBrowser from \"./media-browser\";\n\nimport CreateObjectDialog from \"./create-object-dialog.js\";\nimport ChangeSceneDialog from \"./change-scene-dialog.js\";\nimport AvatarUrlDialog from \"./avatar-url-dialog.js\";\nimport HelpDialog from \"./help-dialog.js\";\nimport InviteDialog from \"./invite-dialog.js\";\nimport InviteTeamDialog from \"./invite-team-dialog.js\";\nimport LinkDialog from \"./link-dialog.js\";\nimport SafariDialog from \"./safari-dialog.js\";\nimport SafariMicDialog from \"./safari-mic-dialog.js\";\nimport SignInDialog from \"./sign-in-dialog.js\";\nimport RenameRoomDialog from \"./rename-room-dialog.js\";\nimport CloseRoomDialog from \"./close-room-dialog.js\";\nimport WebRTCScreenshareUnsupportedDialog from \"./webrtc-screenshare-unsupported-dialog.js\";\nimport WebVRRecommendDialog from \"./webvr-recommend-dialog.js\";\nimport RoomInfoDialog from \"./room-info-dialog.js\";\nimport ClientInfoDialog from \"./client-info-dialog.js\";\nimport OAuthDialog from \"./oauth-dialog.js\";\nimport LobbyChatBox from \"./lobby-chat-box.js\";\nimport InWorldChatBox from \"./in-world-chat-box.js\";\nimport AvatarEditor from \"./avatar-editor\";\n\nimport PresenceLog from \"./presence-log.js\";\nimport PresenceList from \"./presence-list.js\";\nimport SettingsMenu from \"./settings-menu.js\";\nimport TwoDHUD from \"./2d-hud\";\nimport { showFullScreenIfAvailable, showFullScreenIfWasFullScreen } from \"../utils/fullscreen\";\nimport { handleReEntryToVRFrom2DInterstitial } from \"../utils/vr-interstitial\";\nimport { handleTipClose } from \"../systems/tips.js\";\n\nimport { faUsers } from \"@fortawesome/free-solid-svg-icons/faUsers\";\nimport { faImage } from \"@fortawesome/free-solid-svg-icons/faImage\";\nimport { faBars } from \"@fortawesome/free-solid-svg-icons/faBars\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport { faInfoCircle } from \"@fortawesome/free-solid-svg-icons/faInfoCircle\";\nimport { faArrowLeft } from \"@fortawesome/free-solid-svg-icons/faArrowLeft\";\nimport { faPencilAlt } from \"@fortawesome/free-solid-svg-icons/faPencilAlt\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nimport qsTruthy from \"../utils/qs_truthy\";\nconst avatarEditorDebug = qsTruthy(\"avatarEditorDebug\");\n\naddLocaleData([...en]);\n\n// This is a list of regexes that match the microphone labels of HMDs.\n//\n// If entering VR mode, and if any of these regexes match an audio device,\n// the user will be prevented from entering VR until one of those devices is\n// selected as the microphone.\n//\n// Note that this doesn't have to be exhaustive: if no devices match any regex\n// then we rely upon the user to select the proper mic.\nconst HMD_MIC_REGEXES = [/\\Wvive\\W/i, /\\Wrift\\W/i];\n\nconst IN_ROOM_MODAL_ROUTER_PATHS = [\"/media\"];\nconst IN_ROOM_MODAL_QUERY_VARS = [\"media_source\"];\n\nconst LOBBY_MODAL_ROUTER_PATHS = [\"/media/scenes\"];\nconst LOBBY_MODAL_QUERY_VARS = [\"media_source\"];\nconst LOBBY_MODAL_QUERY_VALUES = [\"scenes\"];\n\nasync function grantedMicLabels() {\n  const mediaDevices = await navigator.mediaDevices.enumerateDevices();\n  return mediaDevices.filter(d => d.label && d.kind === \"audioinput\").map(d => d.label);\n}\n\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\nconst isMobilePhoneOrVR = isMobile || isMobileVR;\n\nconst AUTO_EXIT_TIMER_SECONDS = 10;\n\nimport webmTone from \"../assets/sfx/tone.webm\";\nimport mp3Tone from \"../assets/sfx/tone.mp3\";\nimport oggTone from \"../assets/sfx/tone.ogg\";\nimport wavTone from \"../assets/sfx/tone.wav\";\nconst toneClip = document.createElement(\"audio\");\nif (toneClip.canPlayType(\"audio/webm\")) {\n  toneClip.src = webmTone;\n} else if (toneClip.canPlayType(\"audio/mpeg\")) {\n  toneClip.src = mp3Tone;\n} else if (toneClip.canPlayType(\"audio/ogg\")) {\n  toneClip.src = oggTone;\n} else {\n  toneClip.src = wavTone;\n}\n\nclass UIRoot extends Component {\n  willCompileAndUploadMaterials = false;\n\n  static propTypes = {\n    enterScene: PropTypes.func,\n    exitScene: PropTypes.func,\n    onSendMessage: PropTypes.func,\n    disableAutoExitOnConcurrentLoad: PropTypes.bool,\n    forcedVREntryType: PropTypes.string,\n    isBotMode: PropTypes.bool,\n    store: PropTypes.object,\n    mediaSearchStore: PropTypes.object,\n    scene: PropTypes.object,\n    authChannel: PropTypes.object,\n    hubChannel: PropTypes.object,\n    linkChannel: PropTypes.object,\n    hubEntryCode: PropTypes.number,\n    availableVREntryTypes: PropTypes.object,\n    environmentSceneLoaded: PropTypes.bool,\n    roomUnavailableReason: PropTypes.string,\n    platformUnsupportedReason: PropTypes.string,\n    hubId: PropTypes.string,\n    hubName: PropTypes.string,\n    hubScene: PropTypes.object,\n    hubIsBound: PropTypes.bool,\n    isSupportAvailable: PropTypes.bool,\n    presenceLogEntries: PropTypes.array,\n    presences: PropTypes.object,\n    sessionId: PropTypes.string,\n    subscriptions: PropTypes.object,\n    initialIsSubscribed: PropTypes.bool,\n    showSignInDialog: PropTypes.bool,\n    signInMessageId: PropTypes.string,\n    signInCompleteMessageId: PropTypes.string,\n    signInContinueTextId: PropTypes.string,\n    onContinueAfterSignIn: PropTypes.func,\n    showSafariMicDialog: PropTypes.bool,\n    showOAuthDialog: PropTypes.bool,\n    oauthInfo: PropTypes.array,\n    isCursorHoldingPen: PropTypes.bool,\n    hasActiveCamera: PropTypes.bool,\n    onMediaSearchResultEntrySelected: PropTypes.func,\n    activeTips: PropTypes.object,\n    location: PropTypes.object,\n    history: PropTypes.object,\n    showInterstitialPrompt: PropTypes.bool,\n    onInterstitialPromptClicked: PropTypes.func,\n    performConditionalSignIn: PropTypes.func,\n    hide: PropTypes.bool\n  };\n\n  state = {\n    enterInVR: false,\n    muteOnEntry: false,\n    entered: false,\n    dialog: null,\n    showInviteDialog: false,\n    showPresenceList: false,\n    showSettingsMenu: false,\n    discordTipDismissed: false,\n    linkCode: null,\n    linkCodeCancel: null,\n    miniInviteActivated: false,\n\n    didConnectToNetworkedScene: false,\n    noMoreLoadingUpdates: false,\n    hideLoader: false,\n\n    waitingOnAudio: false,\n    shareScreen: false,\n    requestedScreen: false,\n    mediaStream: null,\n    audioTrack: null,\n    numAudioTracks: 0,\n\n    toneInterval: null,\n    tonePlaying: false,\n\n    micLevel: 0,\n    micDevices: [],\n    micUpdateInterval: null,\n\n    profileNamePending: \"Hello\",\n\n    autoExitTimerStartedAt: null,\n    autoExitTimerInterval: null,\n    secondsRemainingBeforeAutoExit: Infinity,\n\n    muted: false,\n    frozen: false,\n    spacebubble: true,\n\n    exited: false,\n\n    signedIn: false,\n    videoShareMediaSource: null\n  };\n\n  constructor(props) {\n    super(props);\n    if (props.showSafariMicDialog) {\n      this.state.dialog = <SafariMicDialog closable={false} />;\n    }\n\n    props.mediaSearchStore.setHistory(props.history);\n\n    // An exit handler that discards event arguments and can be cleaned up.\n    this.exitEventHandler = () => this.exit();\n  }\n\n  componentDidUpdate(prevProps) {\n    const { hubChannel, showSignInDialog } = this.props;\n    if (hubChannel) {\n      const { signedIn } = hubChannel;\n      if (signedIn !== this.state.signedIn) {\n        this.setState({ signedIn });\n      }\n    }\n    if (prevProps.showSignInDialog !== showSignInDialog) {\n      if (showSignInDialog) {\n        this.showContextualSignInDialog();\n      } else {\n        this.closeDialog();\n      }\n    }\n    if (!this.willCompileAndUploadMaterials && this.state.noMoreLoadingUpdates) {\n      this.willCompileAndUploadMaterials = true;\n      // We want to ensure that react and the browser have had the chance to render / update.\n      // See https://stackoverflow.com/a/34999925 , although our solution flipped setTimeout and requestAnimationFrame\n      window.requestAnimationFrame(() => {\n        window.setTimeout(() => {\n          if (!this.props.isBotMode) {\n            this.props.scene.renderer.compileAndUploadMaterials(this.props.scene.object3D, this.props.scene.camera);\n          }\n\n          this.setState({ hideLoader: true });\n        }, 0);\n      });\n    }\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"concurrentload\", this.onConcurrentLoad);\n    this.micLevelMovingAverage = MovingAverage(100);\n    this.props.scene.addEventListener(\n      \"didConnectToNetworkedScene\",\n      () => {\n        this.setState({ didConnectToNetworkedScene: true });\n      },\n      { once: true }\n    );\n    this.props.scene.addEventListener(\"loaded\", this.onSceneLoaded);\n    this.props.scene.addEventListener(\"stateadded\", this.onAframeStateChanged);\n    this.props.scene.addEventListener(\"stateremoved\", this.onAframeStateChanged);\n    this.props.scene.addEventListener(\"share_video_enabled\", this.onShareVideoEnabled);\n    this.props.scene.addEventListener(\"share_video_disabled\", this.onShareVideoDisabled);\n    this.props.scene.addEventListener(\"exit\", this.exitEventHandler);\n    const scene = this.props.scene;\n\n    this.props.store.addEventListener(\"statechanged\", this.onStoreChanged);\n\n    const unsubscribe = this.props.history.listen((location, action) => {\n      const state = location.state;\n\n      // If we just hit back into the entry flow, just go back to the page before the room landing page.\n      if (action === \"POP\" && state && state.entry_step && this.state.entered) {\n        unsubscribe();\n        navigateToPriorPage(this.props.history);\n        return;\n      }\n    });\n\n    // If we refreshed the page with any state history (eg if we were in the entry flow\n    // or had a modal/overlay open) just reset everything to the beginning of the flow by\n    // erasing all history that was accumulated for this room (including across refreshes.)\n    //\n    // We don't do this for the media browser case, since we want to be able to share\n    // links to the browser pages\n    if (this.props.history.location.state && !sluglessPath(this.props.history.location).startsWith(\"/media\")) {\n      popToBeginningOfHubHistory(this.props.history);\n    }\n\n    this.setState({\n      audioContext: {\n        playSound: sound => {\n          scene.emit(sound);\n        },\n        onMouseLeave: () => {\n          //          scene.emit(\"play_sound-hud_mouse_leave\");\n        }\n      }\n    });\n\n    if (this.props.forcedVREntryType && this.props.forcedVREntryType.endsWith(\"_now\")) {\n      setTimeout(() => this.handleForceEntry(), 2000);\n    }\n  }\n\n  componentWillUnmount() {\n    this.props.scene.removeEventListener(\"loaded\", this.onSceneLoaded);\n    this.props.scene.removeEventListener(\"exit\", this.exitEventHandler);\n    this.props.scene.removeEventListener(\"share_video_enabled\", this.onShareVideoEnabled);\n    this.props.scene.removeEventListener(\"share_video_disabled\", this.onShareVideoDisabled);\n  }\n\n  showContextualSignInDialog = () => {\n    const {\n      signInMessageId,\n      authChannel,\n      signInCompleteMessageId,\n      signInContinueTextId,\n      onContinueAfterSignIn\n    } = this.props;\n\n    this.showNonHistoriedDialog(SignInDialog, {\n      message: messages[signInMessageId],\n      onSignIn: async email => {\n        const { authComplete } = await authChannel.startAuthentication(email, this.props.hubChannel);\n\n        this.showNonHistoriedDialog(SignInDialog, { authStarted: true, onClose: onContinueAfterSignIn });\n\n        await authComplete;\n\n        this.setState({ signedIn: true });\n        this.showNonHistoriedDialog(SignInDialog, {\n          authComplete: true,\n          message: messages[signInCompleteMessageId],\n          continueText: messages[signInContinueTextId],\n          onClose: onContinueAfterSignIn,\n          onContinue: onContinueAfterSignIn\n        });\n      },\n      onClose: onContinueAfterSignIn\n    });\n  };\n\n  updateSubscribedState = () => {\n    const isSubscribed = this.props.subscriptions && this.props.subscriptions.isSubscribed();\n    this.setState({ isSubscribed });\n  };\n\n  onLoadingFinished = () => {\n    this.setState({ noMoreLoadingUpdates: true });\n  };\n\n  onSceneLoaded = () => {\n    this.setState({ sceneLoaded: true });\n  };\n\n  // TODO: we need to come up with a cleaner way to handle the shared state between aframe and react than emmitting events and setting state on the scene\n  onAframeStateChanged = e => {\n    if (!(e.detail === \"muted\" || e.detail === \"frozen\" || e.detail === \"spacebubble\")) return;\n    this.setState({\n      [e.detail]: this.props.scene.is(e.detail)\n    });\n  };\n\n  onShareVideoEnabled = e => {\n    this.setState({ videoShareMediaSource: e.detail.source });\n  };\n\n  onShareVideoDisabled = () => {\n    this.setState({ videoShareMediaSource: null });\n  };\n\n  toggleMute = () => {\n    this.props.scene.emit(\"action_mute\");\n  };\n\n  toggleFreeze = () => {\n    this.props.scene.emit(\"action_freeze\");\n  };\n\n  toggleSpaceBubble = () => {\n    this.props.scene.emit(\"action_space_bubble\");\n  };\n\n  shareVideo = mediaSource => {\n    this.props.scene.emit(`action_share_${mediaSource}`);\n  };\n\n  endShareVideo = () => {\n    this.props.scene.emit(\"action_end_video_sharing\");\n  };\n\n  spawnPen = () => {\n    this.props.scene.emit(\"penButtonPressed\");\n  };\n\n  onSubscribeChanged = async () => {\n    if (!this.props.subscriptions) return;\n\n    await this.props.subscriptions.toggle();\n    this.updateSubscribedState();\n  };\n\n  handleForceEntry = () => {\n    if (!this.props.forcedVREntryType) return;\n\n    if (this.props.forcedVREntryType.startsWith(\"daydream\")) {\n      this.enterDaydream();\n    } else if (this.props.forcedVREntryType.startsWith(\"vr\")) {\n      this.enterVR();\n    } else if (this.props.forcedVREntryType.startsWith(\"2d\")) {\n      this.enter2D();\n    }\n  };\n\n  playTestTone = () => {\n    toneClip.currentTime = 0;\n    toneClip.play();\n    clearTimeout(this.testToneTimeout);\n    this.setState({ tonePlaying: true });\n    const toneLength = 1393;\n    this.testToneTimeout = setTimeout(() => {\n      this.setState({ tonePlaying: false });\n    }, toneLength);\n  };\n\n  stopTestTone = () => {\n    toneClip.pause();\n    toneClip.currentTime = 0;\n    this.setState({ tonePlaying: false });\n  };\n\n  onConcurrentLoad = () => {\n    if (this.props.disableAutoExitOnConcurrentLoad) return;\n\n    const autoExitTimerInterval = setInterval(() => {\n      let secondsRemainingBeforeAutoExit = Infinity;\n\n      if (this.state.autoExitTimerStartedAt) {\n        const secondsSinceStart = (new Date() - this.state.autoExitTimerStartedAt) / 1000;\n        secondsRemainingBeforeAutoExit = Math.max(0, Math.floor(AUTO_EXIT_TIMER_SECONDS - secondsSinceStart));\n      }\n\n      this.setState({ secondsRemainingBeforeAutoExit });\n      this.checkForAutoExit();\n    }, 500);\n\n    this.setState({ autoExitTimerStartedAt: new Date(), autoExitTimerInterval });\n  };\n\n  checkForAutoExit = () => {\n    if (this.state.secondsRemainingBeforeAutoExit !== 0) return;\n    this.endAutoExitTimer();\n    this.exit();\n  };\n\n  exit = reason => {\n    this.props.exitScene(reason);\n    this.setState({ exited: true });\n  };\n\n  isWaitingForAutoExit = () => {\n    return this.state.secondsRemainingBeforeAutoExit <= AUTO_EXIT_TIMER_SECONDS;\n  };\n\n  endAutoExitTimer = () => {\n    clearInterval(this.state.autoExitTimerInterval);\n    this.setState({\n      autoExitTimerStartedAt: null,\n      autoExitTimerInterval: null,\n      secondsRemainingBeforeAutoExit: Infinity\n    });\n  };\n\n  hasGrantedMicPermissions = async () => {\n    if (this.state.requestedScreen) {\n      // There is no way to tell if you've granted mic permissions in a previous session if we've\n      // already prompted for screen sharing permissions, so we have to assume that we've never granted permissions.\n      // Fortunately, if you *have* granted permissions permanently, there won't be a second browser prompt, but we\n      // can't determine that before hand.\n      // See https://bugzilla.mozilla.org/show_bug.cgi?id=1449783 for a potential solution in the future.\n      return false;\n    } else {\n      // If we haven't requested the screen in this session, check if we've granted permissions in a previous session.\n      return (await grantedMicLabels()).length > 0;\n    }\n  };\n\n  performDirectEntryFlow = async enterInVR => {\n    this.setState({ enterInVR, waitingOnAudio: true });\n\n    const hasGrantedMic = await this.hasGrantedMicPermissions();\n\n    if (hasGrantedMic) {\n      await this.setMediaStreamToDefault();\n      this.beginOrSkipAudioSetup();\n    } else {\n      this.pushHistoryState(\"entry_step\", \"mic_grant\");\n    }\n\n    this.setState({ waitingOnAudio: false });\n  };\n\n  enter2D = async () => {\n    await this.performDirectEntryFlow(false);\n  };\n\n  enterVR = async () => {\n    if (this.props.forcedVREntryType || this.props.availableVREntryTypes.generic !== VR_DEVICE_AVAILABILITY.maybe) {\n      await this.performDirectEntryFlow(true);\n    } else {\n      this.pushHistoryState(\"modal\", \"webvr\");\n    }\n  };\n\n  enterDaydream = async () => {\n    await this.performDirectEntryFlow(true);\n  };\n\n  micDeviceChanged = async ev => {\n    const constraints = { audio: { deviceId: { exact: [ev.target.value] } } };\n    await this.fetchAudioTrack(constraints);\n    await this.setupNewMediaStream();\n  };\n\n  setMediaStreamToDefault = async () => {\n    let hasAudio = false;\n    const { lastUsedMicDeviceId } = this.props.store.state.settings;\n\n    // Try to fetch last used mic, if there was one.\n    if (lastUsedMicDeviceId) {\n      hasAudio = await this.fetchAudioTrack({ audio: { deviceId: { ideal: lastUsedMicDeviceId } } });\n    } else {\n      hasAudio = await this.fetchAudioTrack({ audio: true });\n    }\n\n    await this.setupNewMediaStream();\n\n    return { hasAudio };\n  };\n\n  fetchAudioTrack = async constraints => {\n    if (this.state.audioTrack) {\n      this.state.audioTrack.stop();\n    }\n\n    try {\n      const mediaStream = await navigator.mediaDevices.getUserMedia(constraints);\n      this.setState({\n        audioTrack: mediaStream.getAudioTracks()[0],\n        numAudioTracks: mediaStream.getAudioTracks().length\n      });\n      return true;\n    } catch (e) {\n      // Error fetching audio track, most likely a permission denial.\n      this.setState({ audioTrack: null, numAudioTracks: 0 });\n      return false;\n    }\n  };\n\n  setupNewMediaStream = async () => {\n    const mediaStream = new MediaStream();\n\n    await this.fetchMicDevices();\n\n    // we should definitely have an audioTrack at this point unless they denied mic access\n    if (this.state.audioTrack) {\n      mediaStream.addTrack(this.state.audioTrack);\n\n      const AudioContext = window.AudioContext || window.webkitAudioContext;\n      this.micLevelAudioContext = new AudioContext();\n      const micSource = this.micLevelAudioContext.createMediaStreamSource(mediaStream);\n      const analyser = this.micLevelAudioContext.createAnalyser();\n      analyser.fftSize = 32;\n      const levels = new Uint8Array(analyser.frequencyBinCount);\n\n      micSource.connect(analyser);\n\n      clearInterval(this.micUpdateInterval);\n      this.micUpdateInterval = setInterval(() => {\n        analyser.getByteTimeDomainData(levels);\n        let v = 0;\n        for (let x = 0; x < levels.length; x++) {\n          v = Math.max(levels[x] - 128, v);\n        }\n        const level = v / 128.0;\n        // Multiplier to increase visual indicator.\n        const multiplier = 6;\n        // We use a moving average to smooth out the visual animation or else it would twitch too fast for\n        // the css renderer to keep up.\n        this.micLevelMovingAverage.push(Date.now(), level * multiplier);\n        const average = this.micLevelMovingAverage.movingAverage();\n        this.setState(state => {\n          if (Math.abs(average - state.micLevel) > 0.0001) {\n            return { micLevel: average };\n          }\n        });\n      }, 50);\n\n      const micDeviceId = this.micDeviceIdForMicLabel(this.micLabelForMediaStream(mediaStream));\n\n      if (micDeviceId) {\n        this.props.store.update({ settings: { lastUsedMicDeviceId: micDeviceId } });\n      }\n    }\n\n    this.setState({ mediaStream });\n  };\n\n  onMicGrantButton = async () => {\n    if (this.props.location.state && this.props.location.state.entry_step === \"mic_grant\") {\n      const { hasAudio } = await this.setMediaStreamToDefault();\n\n      if (hasAudio) {\n        this.pushHistoryState(\"entry_step\", \"mic_granted\");\n      } else {\n        this.beginOrSkipAudioSetup();\n      }\n    } else {\n      this.beginOrSkipAudioSetup();\n    }\n  };\n\n  beginOrSkipAudioSetup = () => {\n    const skipAudioSetup = this.props.forcedVREntryType && this.props.forcedVREntryType.endsWith(\"_now\");\n\n    if (skipAudioSetup) {\n      this.onAudioReadyButton();\n    } else {\n      this.pushHistoryState(\"entry_step\", \"audio\");\n    }\n  };\n\n  fetchMicDevices = () => {\n    return new Promise(resolve => {\n      navigator.mediaDevices.enumerateDevices().then(mediaDevices => {\n        this.setState(\n          {\n            micDevices: mediaDevices\n              .filter(d => d.kind === \"audioinput\")\n              .map(d => ({ deviceId: d.deviceId, label: d.label }))\n          },\n          resolve\n        );\n      });\n    });\n  };\n\n  shouldShowHmdMicWarning = () => {\n    if (isMobile || AFRAME.utils.device.isMobileVR()) return false;\n    if (!this.state.enterInVR) return false;\n    if (!this.hasHmdMicrophone()) return false;\n\n    return !HMD_MIC_REGEXES.find(r => this.selectedMicLabel().match(r));\n  };\n\n  hasHmdMicrophone = () => {\n    return !!this.state.micDevices.find(d => HMD_MIC_REGEXES.find(r => d.label.match(r)));\n  };\n\n  micLabelForMediaStream = mediaStream => {\n    return (mediaStream && mediaStream.getAudioTracks().length > 0 && mediaStream.getAudioTracks()[0].label) || \"\";\n  };\n\n  selectedMicLabel = () => {\n    return this.micLabelForMediaStream(this.state.mediaStream);\n  };\n\n  micDeviceIdForMicLabel = label => {\n    return this.state.micDevices.filter(d => d.label === label).map(d => d.deviceId)[0];\n  };\n\n  selectedMicDeviceId = () => {\n    return this.micDeviceIdForMicLabel(this.selectedMicLabel());\n  };\n\n  shouldShowFullScreen = () => {\n    // Disable full screen on iOS, since Safari's fullscreen mode does not let you prevent native pinch-to-zoom gestures.\n    return (\n      (isMobile || AFRAME.utils.device.isMobileVR()) &&\n      !AFRAME.utils.device.isIOS() &&\n      !this.state.enterInVR &&\n      screenfull.enabled\n    );\n  };\n\n  onAudioReadyButton = () => {\n    if (!this.state.enterInVR) {\n      showFullScreenIfAvailable();\n    }\n\n    this.props.enterScene(this.state.mediaStream, this.state.enterInVR, this.state.muteOnEntry);\n\n    const mediaStream = this.state.mediaStream;\n\n    if (mediaStream) {\n      if (mediaStream.getAudioTracks().length > 0) {\n        console.log(`Using microphone: ${mediaStream.getAudioTracks()[0].label}`);\n      }\n\n      if (mediaStream.getVideoTracks().length > 0) {\n        console.log(\"Screen sharing enabled.\");\n      }\n    }\n\n    this.stopTestTone();\n    clearTimeout(this.testToneTimeout);\n\n    if (this.micLevelAudioContext) {\n      this.micLevelAudioContext.close();\n    }\n    clearInterval(this.micUpdateInterval);\n\n    this.setState({ entered: true, showInviteDialog: false });\n    clearHistoryState(this.props.history);\n  };\n\n  attemptLink = async () => {\n    this.pushHistoryState(\"overlay\", \"link\");\n    const { code, cancel, onFinished } = await this.props.linkChannel.generateCode();\n    this.setState({ linkCode: code, linkCodeCancel: cancel });\n    onFinished.then(() => {\n      this.setState({ log: false, linkCode: null, linkCodeCancel: null });\n      this.props.history.goBack();\n    });\n  };\n\n  showInviteDialog = () => {\n    this.setState({ showInviteDialog: true });\n  };\n\n  toggleInviteDialog = async () => {\n    this.setState({ showInviteDialog: !this.state.showInviteDialog });\n  };\n\n  createObject = media => {\n    this.props.scene.emit(\"add_media\", media);\n  };\n\n  changeScene = url => {\n    this.props.hubChannel.updateScene(url);\n  };\n\n  setAvatarUrl = url => {\n    this.props.store.update({ profile: { ...this.props.store.state.profile, ...{ avatarId: url } } });\n  };\n\n  closeDialog = () => {\n    showFullScreenIfWasFullScreen();\n\n    if (this.state.dialog) {\n      this.setState({ dialog: null });\n    } else {\n      this.props.history.goBack();\n    }\n  };\n\n  showNonHistoriedDialog = (DialogClass, props = {}) => {\n    this.setState({\n      dialog: <DialogClass {...{ onClose: this.closeDialog, ...props }} />\n    });\n  };\n\n  renderDialog = (DialogClass, props = {}) => <DialogClass {...{ onClose: this.closeDialog, ...props }} />;\n\n  showSignInDialog = () => {\n    this.showNonHistoriedDialog(SignInDialog, {\n      message: messages[\"sign-in.prompt\"],\n      onSignIn: async email => {\n        const { authComplete } = await this.props.authChannel.startAuthentication(email, this.props.hubChannel);\n\n        this.showNonHistoriedDialog(SignInDialog, { authStarted: true });\n\n        await authComplete;\n\n        this.setState({ signedIn: true });\n        this.closeDialog();\n      }\n    });\n  };\n\n  signOut = async () => {\n    await this.props.authChannel.signOut(this.props.hubChannel);\n    this.setState({ signedIn: false });\n  };\n\n  showWebRTCScreenshareUnsupportedDialog = () => {\n    this.pushHistoryState(\"modal\", \"webrtc-screenshare\");\n  };\n\n  onMiniInviteClicked = () => {\n    const link = \"https://hub.link/\" + this.props.hubId;\n\n    this.setState({ miniInviteActivated: true });\n    setTimeout(() => {\n      this.setState({ miniInviteActivated: false });\n    }, 5000);\n\n    if (navigator.share) {\n      navigator.share({ title: document.title, url: link });\n    } else {\n      copy(link);\n    }\n  };\n\n  sendMessage = msg => {\n    this.props.onSendMessage(msg);\n  };\n\n  occupantCount = () => {\n    return this.props.presences ? Object.entries(this.props.presences).length : 0;\n  };\n\n  onStoreChanged = () => {\n    this.setState({ discordTipDismissed: this.props.store.state.confirmedDiscordRooms.includes(this.props.hubId) });\n  };\n\n  confirmDiscordBridge = () => {\n    this.props.store.update({ confirmedDiscordRooms: [this.props.hubId] });\n  };\n\n  discordBridges = () => {\n    if (!this.props.presences) {\n      return [];\n    } else {\n      const channels = [];\n      for (const p of Object.values(this.props.presences)) {\n        for (const m of p.metas) {\n          if (m.profile && m.profile.discordBridges) {\n            Array.prototype.push.apply(channels, m.profile.discordBridges.map(b => b.channel.name));\n          }\n        }\n      }\n      return channels;\n    }\n  };\n\n  pushHistoryState = (k, v) => pushHistoryState(this.props.history, k, v);\n\n  renderInterstitialPrompt = () => {\n    return (\n      <IntlProvider locale={lang} messages={messages}>\n        <div className={styles.interstitial} onClick={() => this.props.onInterstitialPromptClicked()}>\n          <div>\n            <FormattedMessage id=\"interstitial.prompt\" />\n          </div>\n        </div>\n      </IntlProvider>\n    );\n  };\n\n  renderExitedPane = () => {\n    let subtitle = null;\n    if (this.props.roomUnavailableReason === \"closed\") {\n      // TODO i18n, due to links and markup\n      subtitle = (\n        <div>\n          Sorry, this room is no longer available.\n          <p />A room may be closed if we receive reports that it violates our{\" \"}\n          <WithHoverSound>\n            <a target=\"_blank\" rel=\"noreferrer noopener\" href=\"https://github.com/mozilla/hubs/blob/master/TERMS.md\">\n              Terms of Use\n            </a>\n          </WithHoverSound>\n          .<br />\n          If you have questions, contact us at{\" \"}\n          <WithHoverSound>\n            <a href=\"mailto:hubs@mozilla.com\">hubs@mozilla.com</a>\n          </WithHoverSound>\n          .<p />\n          If you&apos;d like to run your own server, hubs&apos;s source code is available on{\" \"}\n          <WithHoverSound>\n            <a href=\"https://github.com/mozilla/hubs\">GitHub</a>\n          </WithHoverSound>\n          .\n        </div>\n      );\n    } else if (this.props.platformUnsupportedReason === \"no_data_channels\") {\n      // TODO i18n, due to links and markup\n      subtitle = (\n        <div>\n          Your browser does not support{\" \"}\n          <WithHoverSound>\n            <a\n              href=\"https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/createDataChannel#Browser_compatibility\"\n              rel=\"noreferrer noopener\"\n            >\n              WebRTC Data Channels\n            </a>\n          </WithHoverSound>\n          , which is required to use Hubs.\n          <br />\n          If you&quot;d like to use Hubs with Oculus or SteamVR, you can{\" \"}\n          <WithHoverSound>\n            <a href=\"https://www.mozilla.org/firefox\" rel=\"noreferrer noopener\">\n              Download Firefox\n            </a>\n          </WithHoverSound>\n          .\n        </div>\n      );\n    } else {\n      const reason = this.props.roomUnavailableReason || this.props.platformUnsupportedReason;\n      const exitSubtitleId = `exit.subtitle.${reason || \"exited\"}`;\n      subtitle = (\n        <div>\n          <FormattedMessage id={exitSubtitleId} />\n          <p />\n          {![\"left\", \"kicked\"].includes(this.props.roomUnavailableReason) && (\n            <div>\n              You can also{\" \"}\n              <WithHoverSound>\n                <a href=\"/\">create a new room</a>\n              </WithHoverSound>\n              .\n            </div>\n          )}\n        </div>\n      );\n    }\n\n    return (\n      <IntlProvider locale={lang} messages={messages}>\n        <div className=\"exited-panel\">\n          <img className=\"exited-panel__logo\" src=\"../assets/images/logo.svg\" />\n          <div className=\"exited-panel__subtitle\">{subtitle}</div>\n        </div>\n      </IntlProvider>\n    );\n  };\n\n  renderBotMode = () => {\n    return (\n      <div className=\"loading-panel\">\n        <img className=\"loading-panel__logo\" src=\"../assets/images/logo.svg\" />\n        <input type=\"file\" id=\"bot-audio-input\" accept=\"audio/*\" />\n        <input type=\"file\" id=\"bot-data-input\" accept=\"application/json\" />\n      </div>\n    );\n  };\n\n  renderEntryStartPanel = () => {\n    const hasPush = navigator.serviceWorker && \"PushManager\" in window;\n    const { hasAcceptedProfile, hasChangedName } = this.props.store.state.activity;\n    const promptForNameAndAvatarBeforeEntry = this.props.hubIsBound ? !hasAcceptedProfile : !hasChangedName;\n\n    return (\n      <div className={entryStyles.entryPanel}>\n        <div className={entryStyles.name}>\n          <span>{this.props.hubName}</span>\n          {this.props.hubChannel.canOrWillIfCreator(\"update_hub\") && (\n            <button\n              onClick={() =>\n                this.props.performConditionalSignIn(\n                  () => this.props.hubChannel.can(\"update_hub\"),\n                  () => this.pushHistoryState(\"modal\", \"rename_room\"),\n                  \"rename-room\"\n                )\n              }\n              className={entryStyles.editButton}\n            >\n              <i>\n                <FontAwesomeIcon icon={faPencilAlt} />\n              </i>\n            </button>\n          )}\n          {this.props.hubScene && (\n            <StateLink\n              stateKey=\"modal\"\n              stateValue=\"room_info\"\n              history={this.props.history}\n              className={entryStyles.infoButton}\n            >\n              <i>\n                <FontAwesomeIcon icon={faInfoCircle} />\n              </i>\n            </StateLink>\n          )}\n        </div>\n\n        <div className={entryStyles.roomSubtitle}>\n          <FormattedMessage id=\"entry.room\" />\n        </div>\n\n        <div className={entryStyles.center}>\n          {this.props.hubChannel.canOrWillIfCreator(\"update_hub\") ? (\n            <WithHoverSound>\n              <div\n                className={classNames([entryStyles.lobbyLabel, entryStyles.chooseScene])}\n                onClick={() => {\n                  this.props.performConditionalSignIn(\n                    () => this.props.hubChannel.can(\"update_hub\"),\n                    () => {\n                      showFullScreenIfAvailable();\n                      this.props.mediaSearchStore.sourceNavigateWithNoNav(\"scenes\");\n                    },\n                    \"change-scene\"\n                  );\n                }}\n              >\n                <i>\n                  <FontAwesomeIcon icon={faImage} />\n                </i>\n                <FormattedMessage id=\"entry.change-scene\" />\n              </div>\n            </WithHoverSound>\n          ) : (\n            <div className={entryStyles.lobbyLabel}>\n              <FormattedMessage id=\"entry.in-lobby-notice\" />\n            </div>\n          )}\n\n          <LobbyChatBox\n            occupantCount={this.occupantCount()}\n            discordBridges={this.discordBridges()}\n            onSendMessage={this.sendMessage}\n          />\n        </div>\n\n        {hasPush && (\n          <div className={entryStyles.subscribe}>\n            <input\n              id=\"subscribe\"\n              type=\"checkbox\"\n              onChange={this.onSubscribeChanged}\n              checked={this.state.isSubscribed === undefined ? this.props.initialIsSubscribed : this.state.isSubscribed}\n            />\n            <label htmlFor=\"subscribe\">\n              <FormattedMessage id=\"entry.notify_me\" />\n            </label>\n          </div>\n        )}\n\n        <div className={entryStyles.buttonContainer}>\n          <WithHoverSound>\n            {promptForNameAndAvatarBeforeEntry || !this.props.forcedVREntryType ? (\n              <StateLink\n                stateKey=\"entry_step\"\n                stateValue={promptForNameAndAvatarBeforeEntry ? \"profile\" : \"device\"}\n                history={this.props.history}\n                className={classNames([entryStyles.actionButton, entryStyles.wideButton])}\n              >\n                <FormattedMessage id=\"entry.enter-room\" />\n              </StateLink>\n            ) : (\n              <button\n                onClick={() => this.handleForceEntry()}\n                className={classNames([entryStyles.actionButton, entryStyles.wideButton])}\n              >\n                <FormattedMessage id=\"entry.enter-room\" />\n              </button>\n            )}\n          </WithHoverSound>\n        </div>\n      </div>\n    );\n  };\n\n  renderDevicePanel = () => {\n    return (\n      <div className={entryStyles.entryPanel}>\n        <div onClick={() => this.props.history.goBack()} className={entryStyles.back}>\n          <i>\n            <FontAwesomeIcon icon={faArrowLeft} />\n          </i>\n          <FormattedMessage id=\"entry.back\" />\n        </div>\n\n        <div className={entryStyles.title}>\n          <FormattedMessage id=\"entry.choose-device\" />\n        </div>\n\n        {!this.state.waitingOnAudio ? (\n          <div className={entryStyles.buttonContainer}>\n            {this.props.availableVREntryTypes.cardboard !== VR_DEVICE_AVAILABILITY.no && (\n              <div className={entryStyles.secondary} onClick={this.enterVR}>\n                <FormattedMessage id=\"entry.cardboard\" />\n              </div>\n            )}\n            {this.props.availableVREntryTypes.generic !== VR_DEVICE_AVAILABILITY.no && (\n              <GenericEntryButton secondary={true} onClick={this.enterVR} />\n            )}\n            {this.props.availableVREntryTypes.daydream === VR_DEVICE_AVAILABILITY.yes && (\n              <DaydreamEntryButton secondary={true} onClick={this.enterDaydream} subtitle={null} />\n            )}\n            <DeviceEntryButton secondary={true} onClick={() => this.attemptLink()} isInHMD={isMobileVR} />\n            {this.props.availableVREntryTypes.safari === VR_DEVICE_AVAILABILITY.maybe && (\n              <StateLink stateKey=\"modal\" stateValue=\"safari\" history={this.props.history}>\n                <SafariEntryButton onClick={this.showSafariDialog} />\n              </StateLink>\n            )}\n            {this.props.availableVREntryTypes.screen === VR_DEVICE_AVAILABILITY.yes && (\n              <TwoDEntryButton onClick={this.enter2D} />\n            )}\n          </div>\n        ) : (\n          <div className={entryStyles.audioLoader}>\n            <div className=\"loader-wrap loader-mid\">\n              <div className=\"loader\">\n                <div className=\"loader-center\" />\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  renderScreensharing = () => {\n    return (\n      <label className={entryStyles.screenSharing}>\n        <input\n          className={entryStyles.checkbox}\n          type=\"checkbox\"\n          value={this.state.shareScreen}\n          onChange={this.setStateAndRequestScreen}\n        />\n        <FormattedMessage id=\"entry.enable-screen-sharing\" />\n      </label>\n    );\n  };\n\n  renderMicPanel = granted => {\n    return (\n      <div className=\"mic-grant-panel\">\n        <div onClick={() => this.props.history.goBack()} className={entryStyles.back}>\n          <i>\n            <FontAwesomeIcon icon={faArrowLeft} />\n          </i>\n          <FormattedMessage id=\"entry.back\" />\n        </div>\n\n        <div className=\"mic-grant-panel__grant-container\">\n          <div className=\"mic-grant-panel__title\">\n            <FormattedMessage id={granted ? \"audio.granted-title\" : \"audio.grant-title\"} />\n          </div>\n          <div className=\"mic-grant-panel__subtitle\">\n            <FormattedMessage id={granted ? \"audio.granted-subtitle\" : \"audio.grant-subtitle\"} />\n          </div>\n          <div className=\"mic-grant-panel__button-container\">\n            {granted ? (\n              <WithHoverSound>\n                <button className=\"mic-grant-panel__button\" onClick={this.onMicGrantButton}>\n                  <img src=\"../assets/images/mic_granted.png\" srcSet=\"../assets/images/mic_granted@2x.png 2x\" />\n                </button>\n              </WithHoverSound>\n            ) : (\n              <WithHoverSound>\n                <button className=\"mic-grant-panel__button\" onClick={this.onMicGrantButton}>\n                  <img src=\"../assets/images/mic_denied.png\" srcSet=\"../assets/images/mic_denied@2x.png 2x\" />\n                </button>\n              </WithHoverSound>\n            )}\n          </div>\n          <div className=\"mic-grant-panel__next-container\">\n            <WithHoverSound>\n              <button className={classNames(\"mic-grant-panel__next\")} onClick={this.onMicGrantButton}>\n                <FormattedMessage id=\"audio.granted-next\" />\n              </button>\n            </WithHoverSound>\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  renderAudioSetupPanel = () => {\n    const maxLevelHeight = 111;\n    const micClip = {\n      clip: `rect(${maxLevelHeight - Math.floor(this.state.micLevel * maxLevelHeight)}px, 111px, 111px, 0px)`\n    };\n    const speakerClip = { clip: `rect(${this.state.tonePlaying ? 0 : maxLevelHeight}px, 111px, 111px, 0px)` };\n    const subtitleId = isMobilePhoneOrVR ? \"audio.subtitle-mobile\" : \"audio.subtitle-desktop\";\n    return (\n      <div className=\"audio-setup-panel\">\n        <div onClick={() => this.props.history.goBack()} className={entryStyles.back}>\n          <i>\n            <FontAwesomeIcon icon={faArrowLeft} />\n          </i>\n          <FormattedMessage id=\"entry.back\" />\n        </div>\n\n        <div>\n          <div className=\"audio-setup-panel__title\">\n            <FormattedMessage id=\"audio.title\" />\n          </div>\n          <div className=\"audio-setup-panel__subtitle\">\n            {(isMobilePhoneOrVR || this.state.enterInVR) && <FormattedMessage id={subtitleId} />}\n          </div>\n          <div className=\"audio-setup-panel__levels\">\n            <div className=\"audio-setup-panel__levels__icon\">\n              <img\n                src=\"../assets/images/level_background.png\"\n                srcSet=\"../assets/images/level_background@2x.png 2x\"\n                className=\"audio-setup-panel__levels__icon-part\"\n              />\n              {!this.state.muteOnEntry && (\n                <img\n                  src=\"../assets/images/level_fill.png\"\n                  srcSet=\"../assets/images/level_fill@2x.png 2x\"\n                  className=\"audio-setup-panel__levels__icon-part\"\n                  style={micClip}\n                />\n              )}\n              {this.state.audioTrack && !this.state.muteOnEntry ? (\n                <img\n                  src=\"../assets/images/mic_level.png\"\n                  srcSet=\"../assets/images/mic_level@2x.png 2x\"\n                  className=\"audio-setup-panel__levels__icon-part\"\n                />\n              ) : (\n                <img\n                  src=\"../assets/images/mic_denied.png\"\n                  srcSet=\"../assets/images/mic_denied@2x.png 2x\"\n                  className=\"audio-setup-panel__levels__icon-part\"\n                />\n              )}\n              {this.state.audioTrack &&\n                !this.state.muteOnEntry && (\n                  <div className=\"audio-setup-panel__levels__test_label\">\n                    <FormattedMessage id=\"audio.talk_to_test\" />\n                  </div>\n                )}\n            </div>\n            <WithHoverSound>\n              <div className=\"audio-setup-panel__levels__icon_clickable\" onClick={this.playTestTone}>\n                <img\n                  src=\"../assets/images/level_action_background.png\"\n                  srcSet=\"../assets/images/level_action_background@2x.png 2x\"\n                  className=\"audio-setup-panel__levels__icon-part\"\n                />\n                <img\n                  src=\"../assets/images/level_action_fill.png\"\n                  srcSet=\"../assets/images/level_action_fill@2x.png 2x\"\n                  className=\"audio-setup-panel__levels__icon-part\"\n                  style={speakerClip}\n                />\n                <img\n                  src=\"../assets/images/speaker_level.png\"\n                  srcSet=\"../assets/images/speaker_level@2x.png 2x\"\n                  className=\"audio-setup-panel__levels__icon-part\"\n                />\n                <div className=\"audio-setup-panel__levels__test_label\">\n                  <FormattedMessage id=\"audio.click_to_test\" />\n                </div>\n              </div>\n            </WithHoverSound>\n          </div>\n          {this.state.audioTrack && this.state.micDevices.length > 1 ? (\n            <div className=\"audio-setup-panel__device-chooser\">\n              <WithHoverSound>\n                <select\n                  className=\"audio-setup-panel__device-chooser__dropdown\"\n                  value={this.selectedMicDeviceId()}\n                  onChange={this.micDeviceChanged}\n                >\n                  {this.state.micDevices.map(d => (\n                    <option key={d.deviceId} value={d.deviceId}>\n                      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n                      {d.label}\n                    </option>\n                  ))}\n                </select>\n              </WithHoverSound>\n              <img\n                className=\"audio-setup-panel__device-chooser__mic-icon\"\n                src=\"../assets/images/mic_small.png\"\n                srcSet=\"../assets/images/mic_small@2x.png 2x\"\n              />\n              <img\n                className=\"audio-setup-panel__device-chooser__dropdown-arrow\"\n                src=\"../assets/images/dropdown_arrow.png\"\n                srcSet=\"../assets/images/dropdown_arrow@2x.png 2x\"\n              />\n            </div>\n          ) : (\n            <div />\n          )}\n          {this.shouldShowHmdMicWarning() && (\n            <div className=\"audio-setup-panel__hmd-mic-warning\">\n              <img\n                src=\"../assets/images/warning_icon.png\"\n                srcSet=\"../assets/images/warning_icon@2x.png 2x\"\n                className=\"audio-setup-panel__hmd-mic-warning__icon\"\n              />\n              <span className=\"audio-setup-panel__hmd-mic-warning__label\">\n                <FormattedMessage id=\"audio.hmd-mic-warning\" />\n              </span>\n            </div>\n          )}\n        </div>\n        <div className=\"audio-setup-panel__mute-container\">\n          <input\n            id=\"mute-on-entry\"\n            type=\"checkbox\"\n            onChange={() => this.setState({ muteOnEntry: !this.state.muteOnEntry })}\n            checked={this.state.muteOnEntry}\n          />\n          <label htmlFor=\"mute-on-entry\">\n            <FormattedMessage id=\"entry.mute-on-entry\" />\n          </label>\n        </div>\n        <div className=\"audio-setup-panel__enter-button-container\">\n          <WithHoverSound>\n            <button className=\"audio-setup-panel__enter-button\" onClick={this.onAudioReadyButton}>\n              <FormattedMessage id=\"audio.enter-now\" />\n            </button>\n          </WithHoverSound>\n        </div>\n      </div>\n    );\n  };\n\n  isInModalOrOverlay = () => {\n    if (\n      this.state.entered &&\n      (IN_ROOM_MODAL_ROUTER_PATHS.find(x => sluglessPath(this.props.history.location).startsWith(x)) ||\n        IN_ROOM_MODAL_QUERY_VARS.find(x => new URLSearchParams(this.props.history.location.search).get(x)))\n    ) {\n      return true;\n    }\n\n    if (\n      !this.state.entered &&\n      (LOBBY_MODAL_ROUTER_PATHS.find(x => sluglessPath(this.props.history.location).startsWith(x)) ||\n        LOBBY_MODAL_QUERY_VARS.find(\n          (x, i) => new URLSearchParams(this.props.history.location.search).get(x) === LOBBY_MODAL_QUERY_VALUES[i]\n        ))\n    ) {\n      return true;\n    }\n\n    return !!(\n      (this.props.history &&\n        this.props.history.location.state &&\n        (this.props.history.location.state.modal || this.props.history.location.state.overlay)) ||\n      this.state.dialog\n    );\n  };\n\n  render() {\n    if (this.props.hide) return <div />;\n\n    const isExited = this.state.exited || this.props.roomUnavailableReason || this.props.platformUnsupportedReason;\n\n    const isLoading =\n      (!this.state.hideLoader || !this.state.didConnectToNetworkedScene) && !this.props.showSafariMicDialog;\n\n    const rootStyles = {\n      [styles.ui]: true,\n      \"ui-root\": true,\n      \"in-modal-or-overlay\": this.isInModalOrOverlay()\n    };\n\n    if (this.props.showOAuthDialog)\n      return (\n        <div className={classNames(rootStyles)}>\n          <OAuthDialog closable={false} oauthInfo={this.props.oauthInfo} />\n        </div>\n      );\n    if (isExited) return this.renderExitedPane();\n    if (isLoading) {\n      return (\n        <Loader scene={this.props.scene} finished={this.state.noMoreLoadingUpdates} onLoaded={this.onLoadingFinished} />\n      );\n    }\n    if (this.props.showInterstitialPrompt) return this.renderInterstitialPrompt();\n    if (this.props.isBotMode) return this.renderBotMode();\n\n    const entered = this.state.entered;\n\n    const entryDialog =\n      this.props.availableVREntryTypes &&\n      (this.isWaitingForAutoExit() ? (\n        <AutoExitWarning\n          secondsRemaining={this.state.secondsRemainingBeforeAutoExit}\n          onCancel={this.endAutoExitTimer}\n        />\n      ) : (\n        <div className={entryStyles.entryDialog}>\n          <StateRoute stateKey=\"entry_step\" stateValue=\"device\" history={this.props.history}>\n            {this.renderDevicePanel()}\n          </StateRoute>\n          <StateRoute stateKey=\"entry_step\" stateValue=\"mic_grant\" history={this.props.history}>\n            {this.renderMicPanel(false)}\n          </StateRoute>\n          <StateRoute stateKey=\"entry_step\" stateValue=\"mic_granted\" history={this.props.history}>\n            {this.renderMicPanel(true)}\n          </StateRoute>\n          <StateRoute stateKey=\"entry_step\" stateValue=\"audio\" history={this.props.history}>\n            {this.renderAudioSetupPanel()}\n          </StateRoute>\n          <StateRoute stateKey=\"entry_step\" stateValue=\"\" history={this.props.history}>\n            {this.renderEntryStartPanel()}\n          </StateRoute>\n        </div>\n      ));\n\n    const dialogBoxContentsClassNames = classNames({\n      [styles.uiInteractive]: !this.isInModalOrOverlay(),\n      [styles.uiDialogBoxContents]: true,\n      [styles.backgrounded]: this.isInModalOrOverlay()\n    });\n\n    const showVREntryButton = entered && isMobileVR;\n\n    const presenceLogEntries = this.props.presenceLogEntries || [];\n\n    const mediaSource = this.props.mediaSearchStore.getUrlMediaSource(this.props.history.location);\n\n    // Allow scene picker pre-entry, otherwise wait until entry\n    const showMediaBrowser = mediaSource && ([\"scenes\", \"avatars\"].includes(mediaSource) || this.state.entered);\n    const hasTopTip = this.props.activeTips && this.props.activeTips.top;\n\n    const clientInfoClientId = getClientInfoClientId(this.props.history.location);\n    const showClientInfo = !!clientInfoClientId;\n\n    const discordBridges = this.discordBridges();\n    const discordSnippet = discordBridges.map(ch => \"#\" + ch).join(\", \");\n    const showDiscordTip = discordBridges.length > 0 && !this.state.discordTipDismissed;\n\n    const displayNameOverride = this.props.hubIsBound\n      ? getPresenceProfileForSession(this.props.presences, this.props.sessionId).displayName\n      : null;\n\n    return (\n      <ReactAudioContext.Provider value={this.state.audioContext}>\n        <IntlProvider locale={lang} messages={messages}>\n          <div className={classNames(rootStyles)}>\n            {this.state.dialog}\n\n            <StateRoute\n              stateKey=\"overlay\"\n              stateValue=\"profile\"\n              history={this.props.history}\n              render={props => (\n                <ProfileEntryPanel\n                  {...props}\n                  displayNameOverride={displayNameOverride}\n                  finished={() => this.pushHistoryState()}\n                  store={this.props.store}\n                  mediaSearchStore={this.props.mediaSearchStore}\n                  avatarId={props.location.state.detail && props.location.state.detail.avatarId}\n                />\n              )}\n            />\n            <StateRoute\n              stateKey=\"overlay\"\n              stateValue=\"avatar-editor\"\n              history={this.props.history}\n              render={props => (\n                <AvatarEditor\n                  className={styles.avatarEditor}\n                  signedIn={this.state.signedIn}\n                  onSignIn={this.showSignInDialog}\n                  onSave={() => {\n                    if (props.location.state.detail && props.location.state.detail.returnToProfile) {\n                      this.props.history.goBack();\n                    } else {\n                      this.props.history.goBack();\n                      // We are returning to the media browser. Trigger an update so that the filter switches to\n                      // my-avatars, now that we've saved an avatar.\n                      this.props.mediaSearchStore.sourceNavigateWithNoNav(\"avatars\");\n                    }\n                  }}\n                  onClose={() => this.props.history.goBack()}\n                  store={this.props.store}\n                  debug={avatarEditorDebug}\n                  avatarId={props.location.state.detail && props.location.state.detail.avatarId}\n                  hideDelete={props.location.state.detail && props.location.state.detail.hideDelete}\n                />\n              )}\n            />\n            {showMediaBrowser && (\n              <MediaBrowser\n                history={this.props.history}\n                mediaSearchStore={this.props.mediaSearchStore}\n                hubChannel={this.props.hubChannel}\n                onMediaSearchResultEntrySelected={this.props.onMediaSearchResultEntrySelected}\n                performConditionalSignIn={this.props.performConditionalSignIn}\n              />\n            )}\n            <StateRoute\n              stateKey=\"entry_step\"\n              stateValue=\"profile\"\n              history={this.props.history}\n              render={props => (\n                <ProfileEntryPanel\n                  {...props}\n                  displayNameOverride={displayNameOverride}\n                  finished={() => {\n                    if (this.props.forcedVREntryType) {\n                      this.pushHistoryState();\n                      this.handleForceEntry();\n                    } else {\n                      this.pushHistoryState(\"entry_step\", \"device\");\n                    }\n                  }}\n                  store={this.props.store}\n                  mediaSearchStore={this.props.mediaSearchStore}\n                  avatarId={props.location.state.detail && props.location.state.detail.avatarId}\n                />\n              )}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"rename_room\"\n              history={this.props.history}\n              render={() =>\n                this.renderDialog(RenameRoomDialog, { onRename: name => this.props.hubChannel.rename(name) })\n              }\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"close_room\"\n              history={this.props.history}\n              render={() => this.renderDialog(CloseRoomDialog, { onConfirm: () => this.props.hubChannel.closeHub() })}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"help\"\n              history={this.props.history}\n              render={() => this.renderDialog(HelpDialog)}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"safari\"\n              history={this.props.history}\n              render={() => this.renderDialog(SafariDialog)}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"support\"\n              history={this.props.history}\n              render={() => this.renderDialog(InviteTeamDialog, { hubChannel: this.props.hubChannel })}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"create\"\n              history={this.props.history}\n              render={() => this.renderDialog(CreateObjectDialog, { onCreate: this.createObject })}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"change_scene\"\n              history={this.props.history}\n              render={() => this.renderDialog(ChangeSceneDialog, { onChange: this.changeScene })}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"avatar_url\"\n              history={this.props.history}\n              render={() => this.renderDialog(AvatarUrlDialog, { onChange: this.setAvatarUrl })}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"webvr\"\n              history={this.props.history}\n              render={() => this.renderDialog(WebVRRecommendDialog)}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"webrtc-screenshare\"\n              history={this.props.history}\n              render={() => this.renderDialog(WebRTCScreenshareUnsupportedDialog)}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"room_info\"\n              history={this.props.history}\n              render={() =>\n                this.renderDialog(RoomInfoDialog, { scene: this.props.hubScene, hubName: this.props.hubName })\n              }\n            />\n\n            {showClientInfo && (\n              <ClientInfoDialog\n                clientId={clientInfoClientId}\n                onClose={this.closeDialog}\n                history={this.props.history}\n                presences={this.props.presences}\n                hubChannel={this.props.hubChannel}\n                performConditionalSignIn={this.props.performConditionalSignIn}\n              />\n            )}\n\n            {(!this.state.entered || this.isWaitingForAutoExit()) && (\n              <div className={styles.uiDialog}>\n                <PresenceLog entries={presenceLogEntries} hubId={this.props.hubId} history={this.props.history} />\n                <div className={dialogBoxContentsClassNames}>{entryDialog}</div>\n              </div>\n            )}\n\n            {entered && (\n              <PresenceLog\n                inRoom={true}\n                entries={presenceLogEntries}\n                hubId={this.props.hubId}\n                history={this.props.history}\n              />\n            )}\n            {entered &&\n              this.props.activeTips &&\n              this.props.activeTips.bottom &&\n              (!presenceLogEntries || presenceLogEntries.length === 0) &&\n              !showDiscordTip && (\n                <div className={styles.bottomTip}>\n                  <button\n                    className={styles.tipCancel}\n                    onClick={() => handleTipClose(this.props.activeTips.bottom, \"bottom\")}\n                  >\n                    <i>\n                      <FontAwesomeIcon icon={faTimes} />\n                    </i>\n                  </button>\n                  {[\".spawn_menu\", \"_button\"].find(x => this.props.activeTips.bottom.endsWith(x)) ? (\n                    <div className={styles.splitTip}>\n                      <FormattedMessage id={`tips.${this.props.activeTips.bottom}-pre`} />\n                      <div\n                        className={classNames({\n                          [styles.splitTipIcon]: true,\n                          [styles[this.props.activeTips.bottom.split(\".\")[1] + \"-icon\"]]: true\n                        })}\n                      />\n                      <FormattedMessage id={`tips.${this.props.activeTips.bottom}-post`} />\n                    </div>\n                  ) : (\n                    <div className={styles.tip}>\n                      <FormattedMessage id={`tips.${this.props.activeTips.bottom}`} />\n                    </div>\n                  )}\n                </div>\n              )}\n            {entered &&\n              showDiscordTip && (\n                <div className={styles.bottomTip}>\n                  <button className={styles.tipCancel} onClick={() => this.confirmDiscordBridge()}>\n                    <i>\n                      <FontAwesomeIcon icon={faTimes} />\n                    </i>\n                  </button>\n                  <div className={styles.tip}>\n                    {`Chat in this room is being bridged to ${discordSnippet} on Discord.`}\n                  </div>\n                </div>\n              )}\n            {entered && (\n              <InWorldChatBox\n                discordBridges={discordBridges}\n                onSendMessage={this.sendMessage}\n                onObjectCreated={this.createObject}\n                history={this.props.history}\n              />\n            )}\n            {this.state.frozen && (\n              <button className={styles.leaveButton} onClick={() => this.exit(\"left\")}>\n                <FormattedMessage id=\"entry.leave-room\" />\n              </button>\n            )}\n\n            {!this.state.frozen && (\n              <div\n                className={classNames({\n                  [inviteStyles.inviteContainer]: true,\n                  [inviteStyles.inviteContainerBelowHud]: entered,\n                  [inviteStyles.inviteContainerInverted]: this.state.showInviteDialog\n                })}\n              >\n                {!showVREntryButton &&\n                  !hasTopTip && (\n                    <WithHoverSound>\n                      <button\n                        className={classNames({\n                          [inviteStyles.inviteButton]: true,\n                          [inviteStyles.hideSmallScreens]: this.occupantCount() > 1 && entered\n                        })}\n                        onClick={() => this.toggleInviteDialog()}\n                      >\n                        <FormattedMessage id=\"entry.invite-others-nag\" />\n                      </button>\n                    </WithHoverSound>\n                  )}\n                {!showVREntryButton &&\n                  this.occupantCount() > 1 &&\n                  !hasTopTip &&\n                  entered && (\n                    <WithHoverSound>\n                      <button onClick={this.onMiniInviteClicked} className={inviteStyles.inviteMiniButton}>\n                        <span>\n                          {this.state.miniInviteActivated\n                            ? navigator.share\n                              ? \"sharing...\"\n                              : \"copied!\"\n                            : \"hub.link/\" + this.props.hubId}\n                        </span>\n                      </button>\n                    </WithHoverSound>\n                  )}\n                {showVREntryButton && (\n                  <WithHoverSound>\n                    <button className={inviteStyles.enterButton} onClick={() => this.props.scene.enterVR()}>\n                      <FormattedMessage id=\"entry.enter-in-vr\" />\n                    </button>\n                  </WithHoverSound>\n                )}\n                {this.state.showInviteDialog && (\n                  <InviteDialog\n                    allowShare={!isMobileVR}\n                    entryCode={this.props.hubEntryCode}\n                    hubId={this.props.hubId}\n                    onClose={() => this.setState({ showInviteDialog: false })}\n                  />\n                )}\n              </div>\n            )}\n\n            <StateRoute\n              stateKey=\"overlay\"\n              stateValue=\"invite\"\n              history={this.props.history}\n              render={() => (\n                <InviteDialog\n                  allowShare={!!navigator.share}\n                  entryCode={this.props.hubEntryCode}\n                  hubId={this.props.hubId}\n                  isModal={true}\n                  onClose={() => {\n                    this.props.history.goBack();\n                    handleReEntryToVRFrom2DInterstitial();\n                  }}\n                />\n              )}\n            />\n\n            <StateRoute\n              stateKey=\"overlay\"\n              stateValue=\"link\"\n              history={this.props.history}\n              render={() => (\n                <LinkDialog\n                  linkCode={this.state.linkCode}\n                  onClose={() => {\n                    this.state.linkCodeCancel();\n                    this.setState({ linkCode: null, linkCodeCancel: null });\n                    this.props.history.goBack();\n                  }}\n                />\n              )}\n            />\n\n            <div\n              onClick={() => this.setState({ showSettingsMenu: !this.state.showSettingsMenu })}\n              className={classNames({\n                [styles.settingsInfo]: true,\n                [styles.settingsInfoSelected]: this.state.showSettingsMenu\n              })}\n            >\n              <FontAwesomeIcon icon={faBars} />\n            </div>\n\n            <div\n              onClick={() => this.setState({ showPresenceList: !this.state.showPresenceList })}\n              className={classNames({\n                [styles.presenceInfo]: true,\n                [styles.presenceInfoSelected]: this.state.showPresenceList\n              })}\n            >\n              <FontAwesomeIcon icon={faUsers} />\n              <span className={styles.occupantCount}>{this.occupantCount()}</span>\n            </div>\n\n            {this.state.showPresenceList && (\n              <PresenceList\n                history={this.props.history}\n                presences={this.props.presences}\n                sessionId={this.props.sessionId}\n                signedIn={this.state.signedIn}\n                email={this.props.store.state.credentials.email}\n                onSignIn={this.showSignInDialog}\n                onSignOut={this.signOut}\n              />\n            )}\n\n            {this.state.showSettingsMenu && (\n              <SettingsMenu\n                history={this.props.history}\n                mediaSearchStore={this.props.mediaSearchStore}\n                hideSettings={() => this.setState({ showSettingsMenu: false })}\n                hubChannel={this.props.hubChannel}\n                hubScene={this.props.hubScene}\n                performConditionalSignIn={this.props.performConditionalSignIn}\n                pushHistoryState={this.pushHistoryState}\n              />\n            )}\n\n            {entered && (\n              <div className={styles.topHud}>\n                <TwoDHUD.TopHUD\n                  history={this.props.history}\n                  mediaSearchStore={this.props.mediaSearchStore}\n                  muted={this.state.muted}\n                  frozen={this.state.frozen}\n                  spacebubble={this.state.spacebubble}\n                  videoShareMediaSource={this.state.videoShareMediaSource}\n                  activeTip={this.props.activeTips && this.props.activeTips.top}\n                  isCursorHoldingPen={this.props.isCursorHoldingPen}\n                  hasActiveCamera={this.props.hasActiveCamera}\n                  onToggleMute={this.toggleMute}\n                  onToggleFreeze={this.toggleFreeze}\n                  onToggleSpaceBubble={this.toggleSpaceBubble}\n                  onSpawnPen={this.spawnPen}\n                  onSpawnCamera={() => this.props.scene.emit(\"action_toggle_camera\")}\n                  onShareVideo={this.shareVideo}\n                  onEndShareVideo={this.endShareVideo}\n                  onShareVideoNotCapable={() => this.showWebRTCScreenshareUnsupportedDialog()}\n                />\n                <div className={styles.nagCornerButton}>\n                  <a href=\"https://forms.gle/1g4H5Ayd1mGWqWpV7\" target=\"_blank\" rel=\"noopener noreferrer\">\n                    <FormattedMessage id=\"feedback.prompt\" />\n                  </a>\n                </div>\n              </div>\n            )}\n          </div>\n        </IntlProvider>\n      </ReactAudioContext.Provider>\n    );\n  }\n}\n\nexport default UIRoot;\n","import jwtDecode from \"jwt-decode\";\nimport { EventTarget } from \"event-target-shim\";\nimport { Presence } from \"phoenix\";\nimport { migrateChannelToSocket } from \"./phoenix-utils\";\n\nconst MS_PER_DAY = 1000 * 60 * 60 * 24;\nconst MS_PER_MONTH = 1000 * 60 * 60 * 24 * 30;\n\nfunction isSameMonth(da, db) {\n  return da.getFullYear() == db.getFullYear() && da.getMonth() == db.getMonth();\n}\n\nfunction isSameDay(da, db) {\n  return isSameMonth(da, db) && da.getDate() == db.getDate();\n}\n\n// Permissions that will be assumed if the user becomes the creator.\nconst HUB_CREATOR_PERMISSIONS = [\"update_hub\", \"close_hub\", \"mute_users\", \"kick_users\"];\n\nexport default class HubChannel extends EventTarget {\n  constructor(store, hubId) {\n    super();\n    this.store = store;\n    this.hubId = hubId;\n    this._signedIn = !!this.store.state.credentials.token;\n    this._permissions = {};\n    this._blockedSessionIds = new Set();\n  }\n\n  get signedIn() {\n    return this._signedIn;\n  }\n\n  // Returns true if this current session has the given permission.\n  can(permission) {\n    return this._permissions && this._permissions[permission];\n  }\n\n  // Returns true if the current session has the given permission, *or* will get the permission\n  // if they sign in and become the creator.\n  canOrWillIfCreator(permission) {\n    if (this._getCreatorAssignmentToken() && HUB_CREATOR_PERMISSIONS.includes(permission)) return true;\n    return this.can(permission);\n  }\n\n  // Migrates this hub channel to a new phoenix channel and presence\n  async migrateToSocket(socket, params) {\n    let presenceBindings;\n\n    // Unbind presence, and then set up bindings after reconnect\n    if (this.presence) {\n      presenceBindings = {\n        onJoin: this.presence.caller.onJoin,\n        onLeave: this.presence.caller.onLeave,\n        onSync: this.presence.caller.onSync\n      };\n\n      this.presence.onJoin(function() {});\n      this.presence.onLeave(function() {});\n      this.presence.onSync(function() {});\n    }\n\n    this.channel = await migrateChannelToSocket(this.channel, socket, params);\n    this.presence = new Presence(this.channel);\n\n    if (presenceBindings) {\n      this.presence.onJoin(presenceBindings.onJoin);\n      this.presence.onLeave(presenceBindings.onLeave);\n      this.presence.onSync(presenceBindings.onSync);\n    }\n  }\n\n  setPhoenixChannel = channel => {\n    this.channel = channel;\n    this.presence = new Presence(channel);\n  };\n\n  setPermissionsFromToken = token => {\n    // Note: token is not verified.\n    this._permissions = jwtDecode(token);\n    this.dispatchEvent(new CustomEvent(\"permissions_updated\"));\n\n    // Refresh the token 1 minute before it expires.\n    const nextRefresh = new Date(this._permissions.exp * 1000 - 60 * 1000) - new Date();\n    setTimeout(async () => {\n      const result = await this.fetchPermissions();\n      this.dispatchEvent(new CustomEvent(\"permissions-refreshed\", { detail: result }));\n    }, nextRefresh);\n  };\n\n  sendEntryEvent = async () => {\n    if (!this.channel) {\n      console.warn(\"No phoenix channel initialized before room entry.\");\n      return;\n    }\n\n    let entryDisplayType = \"Screen\";\n\n    if (navigator.getVRDisplays) {\n      const vrDisplay = (await navigator.getVRDisplays()).find(d => d.isPresenting);\n\n      if (vrDisplay) {\n        entryDisplayType = vrDisplay.displayName;\n      }\n    }\n\n    // This is fairly hacky, but gets the # of initial occupants\n    let initialOccupantCount = 0;\n\n    if (NAF.connection.adapter && NAF.connection.adapter.publisher) {\n      initialOccupantCount = NAF.connection.adapter.publisher.initialOccupants.length;\n    }\n\n    const entryTimingFlags = this.getEntryTimingFlags();\n\n    const entryEvent = {\n      ...entryTimingFlags,\n      initialOccupantCount,\n      entryDisplayType,\n      userAgent: navigator.userAgent\n    };\n\n    this.channel.push(\"events:entered\", entryEvent);\n  };\n\n  getEntryTimingFlags = () => {\n    const entryTimingFlags = { isNewDaily: true, isNewMonthly: true, isNewDayWindow: true, isNewMonthWindow: true };\n    const storedLastEnteredAt = this.store.state.activity.lastEnteredAt;\n\n    if (!storedLastEnteredAt) {\n      return entryTimingFlags;\n    }\n\n    const now = new Date();\n    const lastEntered = new Date(storedLastEnteredAt);\n    const msSinceLastEntered = now - lastEntered;\n\n    // note that new daily and new monthly is based on client local time\n    entryTimingFlags.isNewDaily = !isSameDay(now, lastEntered);\n    entryTimingFlags.isNewMonthly = !isSameMonth(now, lastEntered);\n    entryTimingFlags.isNewDayWindow = msSinceLastEntered > MS_PER_DAY;\n    entryTimingFlags.isNewMonthWindow = msSinceLastEntered > MS_PER_MONTH;\n\n    return entryTimingFlags;\n  };\n\n  sendObjectSpawnedEvent = objectType => {\n    if (!this.channel) {\n      console.warn(\"No phoenix channel initialized before object spawn.\");\n      return;\n    }\n\n    const spawnEvent = {\n      object_type: objectType\n    };\n\n    this.channel.push(\"events:object_spawned\", spawnEvent);\n  };\n\n  sendProfileUpdate = () => {\n    this.channel.push(\"events:profile_updated\", { profile: this.store.state.profile });\n  };\n\n  updateScene = url => {\n    if (!this._permissions.update_hub) return \"unauthorized\";\n    this.channel.push(\"update_scene\", { url });\n  };\n\n  rename = name => {\n    if (!this._permissions.update_hub) return \"unauthorized\";\n    this.channel.push(\"update_hub\", { name });\n  };\n\n  closeHub = () => {\n    if (!this._permissions.close_hub) return \"unauthorized\";\n    this.channel.push(\"close_hub\", {});\n  };\n\n  subscribe = subscription => {\n    this.channel.push(\"subscribe\", { subscription });\n  };\n\n  unsubscribe = subscription => {\n    return new Promise(resolve => this.channel.push(\"unsubscribe\", { subscription }).receive(\"ok\", resolve));\n  };\n\n  sendMessage = (body, type = \"chat\") => {\n    if (!body) return;\n    this.channel.push(\"message\", { body, type });\n  };\n\n  _getCreatorAssignmentToken = () => {\n    const creatorAssignmentTokenEntry =\n      this.store.state.creatorAssignmentTokens &&\n      this.store.state.creatorAssignmentTokens.find(t => t.hubId === this.hubId);\n\n    return creatorAssignmentTokenEntry && creatorAssignmentTokenEntry.creatorAssignmentToken;\n  };\n\n  signIn = token => {\n    return new Promise((resolve, reject) => {\n      const creator_assignment_token = this._getCreatorAssignmentToken();\n\n      this.channel\n        .push(\"sign_in\", { token, creator_assignment_token })\n        .receive(\"ok\", ({ perms_token }) => {\n          this.setPermissionsFromToken(perms_token);\n          this._signedIn = true;\n          resolve();\n        })\n        .receive(\"error\", err => {\n          if (err.reason === \"invalid_token\") {\n            console.warn(\"sign in failed\", err);\n            // Token expired or invalid TODO purge from storage if possible\n            resolve();\n          } else {\n            console.error(\"sign in failed\", err);\n            reject();\n          }\n        });\n    });\n  };\n\n  signOut = () => {\n    return new Promise((resolve, reject) => {\n      this.channel\n        .push(\"sign_out\")\n        .receive(\"ok\", () => {\n          this._permissions = {};\n          this._signedIn = false;\n          this.dispatchEvent(new CustomEvent(\"permissions_updated\"));\n          resolve();\n        })\n        .receive(\"error\", reject);\n    });\n  };\n\n  getHost = () => {\n    return new Promise((resolve, reject) => {\n      this.channel\n        .push(\"get_host\")\n        .receive(\"ok\", res => {\n          resolve(res.host);\n        })\n        .receive(\"error\", reject);\n    });\n  };\n\n  pin = (id, gltfNode, fileId, fileAccessToken, promotionToken) => {\n    const payload = { id, gltf_node: gltfNode };\n    if (fileId && promotionToken) {\n      payload.file_id = fileId;\n      payload.file_access_token = fileAccessToken;\n      payload.promotion_token = promotionToken;\n    }\n    return new Promise((resolve, reject) => {\n      this.channel\n        .push(\"pin\", payload)\n        .receive(\"ok\", resolve)\n        .receive(\"error\", reject);\n    });\n  };\n\n  unpin = (id, fileId) => {\n    const payload = { id };\n    if (fileId) {\n      payload.file_id = fileId;\n    }\n    this.channel.push(\"unpin\", payload);\n  };\n\n  fetchPermissions = () => {\n    return new Promise((resolve, reject) => {\n      this.channel\n        .push(\"refresh_perms_token\")\n        .receive(\"ok\", res => {\n          this.setPermissionsFromToken(res.perms_token);\n          resolve({ permsToken: res.perms_token, permissions: this._permissions });\n        })\n        .receive(\"error\", reject);\n    });\n  };\n\n  mute = sessionId => {\n    this.channel.push(\"mute\", { session_id: sessionId });\n  };\n\n  hide = sessionId => {\n    NAF.connection.adapter.block(sessionId);\n    this._blockedSessionIds.add(sessionId);\n  };\n\n  unhide = sessionId => {\n    if (!this._blockedSessionIds.has(sessionId)) return;\n    NAF.connection.adapter.unblock(sessionId);\n    NAF.connection.entities.completeSync(sessionId);\n    this._blockedSessionIds.delete(sessionId);\n  };\n\n  isHidden = sessionId => this._blockedSessionIds.has(sessionId);\n\n  kick = async sessionId => {\n    const permsToken = await this.fetchPermissions();\n    NAF.connection.adapter.kick(sessionId, permsToken);\n    this.channel.push(\"kick\", { session_id: sessionId });\n  };\n\n  requestSupport = () => {\n    this.channel.push(\"events:request_support\", {});\n  };\n\n  disconnect = () => {\n    if (this.channel) {\n      this.channel.socket.disconnect();\n    }\n  };\n}\n","import { spawnChatMessage } from \"./react-components/chat-message\";\nimport { SOUND_QUACK, SOUND_SPECIAL_QUACK } from \"./systems/sound-effects-system\";\n\nconst DUCK_URL = \"https://asset-bundles-prod.reticulum.io/interactables/Ducky/DuckyMesh-438ff8e022.gltf\";\n\n// Handles user-entered messages\nexport default class MessageDispatch {\n  constructor(scene, entryManager, hubChannel, addToPresenceLog, remountUI, mediaSearchStore) {\n    this.scene = scene;\n    this.entryManager = entryManager;\n    this.hubChannel = hubChannel;\n    this.addToPresenceLog = addToPresenceLog;\n    this.remountUI = remountUI;\n    this.mediaSearchStore = mediaSearchStore;\n  }\n\n  dispatch = message => {\n    if (message.startsWith(\"/\")) {\n      const commandParts = message.substring(1).split(\" \");\n      this.dispatchCommand(commandParts[0], ...commandParts.slice(1));\n      document.activeElement.blur(); // Commands should blur\n    } else {\n      this.hubChannel.sendMessage(message);\n    }\n  };\n\n  dispatchCommand = (command, ...args) => {\n    const entered = this.scene.is(\"entered\");\n\n    if (!entered) {\n      this.addToPresenceLog({ type: \"log\", body: \"You must enter the room to use this command.\" });\n      return;\n    }\n\n    const playerRig = document.querySelector(\"#player-rig\");\n    const scales = [0.0625, 0.125, 0.25, 0.5, 1.0, 1.5, 3, 5, 7.5, 12.5];\n    const curScale = playerRig.object3D.scale;\n    let err;\n    let physicsSystem;\n\n    switch (command) {\n      case \"fly\":\n        if (playerRig.getAttribute(\"character-controller\").fly !== true) {\n          playerRig.setAttribute(\"character-controller\", \"fly\", true);\n          this.addToPresenceLog({ type: \"log\", body: \"Fly mode enabled.\" });\n        } else {\n          playerRig.setAttribute(\"character-controller\", \"fly\", false);\n          this.addToPresenceLog({ type: \"log\", body: \"Fly mode disabled.\" });\n        }\n        break;\n      case \"grow\":\n        for (let i = 0; i < scales.length; i++) {\n          if (scales[i] > curScale.x) {\n            playerRig.object3D.scale.set(scales[i], scales[i], scales[i]);\n            playerRig.object3D.matrixNeedsUpdate = true;\n            break;\n          }\n        }\n\n        break;\n      case \"shrink\":\n        for (let i = scales.length - 1; i >= 0; i--) {\n          if (curScale.x > scales[i]) {\n            playerRig.object3D.scale.set(scales[i], scales[i], scales[i]);\n            break;\n          }\n        }\n\n        break;\n      case \"leave\":\n        this.entryManager.exitScene();\n        this.remountUI({ roomUnavailableReason: \"left\" });\n        break;\n      case \"duck\":\n        spawnChatMessage(DUCK_URL);\n        if (Math.random() < 0.01) {\n          this.scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SPECIAL_QUACK);\n        } else {\n          this.scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_QUACK);\n        }\n        break;\n      case \"debug\":\n        physicsSystem = document.querySelector(\"a-scene\").systems.physics;\n        physicsSystem.setDebug(!physicsSystem.debug);\n        break;\n      case \"scene\":\n        if (args[0]) {\n          err = this.hubChannel.updateScene(args[0]);\n\n          if (err === \"unauthorized\") {\n            this.addToPresenceLog({ type: \"log\", body: \"You do not have permission to change the scene.\" });\n          }\n        } else {\n          this.mediaSearchStore.sourceNavigateWithNoNav(\"scenes\");\n        }\n\n        break;\n      case \"rename\":\n        err = this.hubChannel.rename(args.join(\" \"));\n        if (err === \"unauthorized\") {\n          this.addToPresenceLog({ type: \"log\", body: \"You do not have permission to rename this room.\" });\n        }\n        break;\n    }\n  };\n}\n","import qsTruthy from \"./utils/qs_truthy\";\nimport nextTick from \"./utils/next-tick\";\nimport pinnedEntityToGltf from \"./utils/pinned-entity-to-gltf\";\n\nconst isBotMode = qsTruthy(\"bot\");\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isDebug = qsTruthy(\"debug\");\nconst qs = new URLSearchParams(location.search);\n\nimport { addMedia, getPromotionTokenForFile } from \"./utils/media-utils\";\nimport {\n  isIn2DInterstitial,\n  handleExitTo2DInterstitial,\n  handleReEntryToVRFrom2DInterstitial,\n  forceExitFrom2DInterstitial\n} from \"./utils/vr-interstitial\";\nimport { ObjectContentOrigins } from \"./object-types\";\nimport { getAvatarSrc, getAvatarType } from \"./utils/avatar-utils\";\nimport { pushHistoryState } from \"./utils/history\";\nimport { SOUND_ENTER_SCENE } from \"./systems/sound-effects-system\";\n\nconst isIOS = AFRAME.utils.device.isIOS();\n\nexport default class SceneEntryManager {\n  constructor(hubChannel, authChannel, availableVREntryTypes, history) {\n    this.hubChannel = hubChannel;\n    this.authChannel = authChannel;\n    this.availableVREntryTypes = availableVREntryTypes;\n    this.store = window.APP.store;\n    this.mediaSearchStore = window.APP.mediaSearchStore;\n    this.scene = document.querySelector(\"a-scene\");\n    this.cursorController = document.querySelector(\"#cursor-controller\");\n    this.playerRig = document.querySelector(\"#player-rig\");\n    this._entered = false;\n    this.performConditionalSignIn = () => {};\n    this.history = history;\n  }\n\n  init = () => {\n    this.whenSceneLoaded(() => {\n      this.cursorController.components[\"cursor-controller\"].enabled = false;\n    });\n  };\n\n  hasEntered = () => {\n    return this._entered;\n  };\n\n  enterScene = async (mediaStream, enterInVR, muteOnEntry) => {\n    const playerCamera = document.querySelector(\"#player-camera\");\n    playerCamera.removeAttribute(\"scene-preview-camera\");\n\n    if (isDebug) {\n      NAF.connection.adapter.session.options.verbose = true;\n    }\n\n    if (enterInVR) {\n      // This specific scene state var is used to check if the user went through the\n      // entry flow and chose VR entry, and is used to preempt VR mode on refreshes.\n      this.scene.addState(\"vr-entered\");\n\n      // HACK - A-Frame calls getVRDisplays at module load, we want to do it here to\n      // force gamepads to become live.\n      navigator.getVRDisplays();\n\n      this.scene.enterVR();\n    }\n\n    if (isMobile || qsTruthy(\"mobile\")) {\n      this.playerRig.setAttribute(\"virtual-gamepad-controls\", {});\n    }\n\n    this._setupPlayerRig();\n    this._setupBlocking();\n    this._setupKicking();\n    this._setupMedia(mediaStream);\n    this._setupCamera();\n\n    if (qsTruthy(\"offline\")) return;\n\n    this._spawnAvatar();\n\n    this.scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_ENTER_SCENE);\n\n    if (isBotMode) {\n      this._runBot(mediaStream);\n      return;\n    }\n\n    if (mediaStream) {\n      NAF.connection.adapter.setLocalMediaStream(mediaStream);\n    }\n\n    this.scene.classList.remove(\"hand-cursor\");\n    this.scene.classList.add(\"no-cursor\");\n\n    this.cursorController.components[\"cursor-controller\"].enabled = true;\n    this._entered = true;\n\n    // Delay sending entry event telemetry until VR display is presenting.\n    (async () => {\n      while (enterInVR && !(await navigator.getVRDisplays()).find(d => d.isPresenting)) {\n        await nextTick();\n      }\n\n      this.hubChannel.sendEntryEvent().then(() => {\n        this.store.update({ activity: { lastEnteredAt: new Date().toISOString() } });\n      });\n    })();\n\n    this.scene.addState(\"entered\");\n\n    if (muteOnEntry) {\n      this.scene.emit(\"action_mute\");\n    }\n  };\n\n  whenSceneLoaded = callback => {\n    if (this.scene.hasLoaded) {\n      callback();\n    } else {\n      this.scene.addEventListener(\"loaded\", callback);\n    }\n  };\n\n  enterSceneWhenLoaded = (mediaStream, enterInVR) => {\n    this.whenSceneLoaded(() => this.enterScene(mediaStream, enterInVR));\n  };\n\n  exitScene = () => {\n    if (NAF.connection.adapter && NAF.connection.adapter.localMediaStream) {\n      NAF.connection.adapter.localMediaStream.getTracks().forEach(t => t.stop());\n    }\n    if (this.hubChannel) {\n      this.hubChannel.disconnect();\n    }\n    if (this.scene.renderer) {\n      this.scene.renderer.setAnimationLoop(null); // Stop animation loop, TODO A-Frame should do this\n    }\n    document.body.removeChild(this.scene);\n  };\n\n  _setupPlayerRig = () => {\n    this._setPlayerInfoFromProfile();\n\n    const avatarScale = parseInt(qs.get(\"avatar_scale\"), 10);\n\n    if (avatarScale) {\n      this.playerRig.setAttribute(\"scale\", { x: avatarScale, y: avatarScale, z: avatarScale });\n    }\n  };\n\n  _setPlayerInfoFromProfile = async () => {\n    let avatarId = this.store.state.profile.avatarId;\n    let avatarSrc = await getAvatarSrc(avatarId);\n\n    if (!avatarSrc) {\n      this.store.resetToRandomLegacyAvatar();\n      avatarId = this.store.state.profile.avatarId;\n      avatarSrc = await getAvatarSrc(avatarId);\n    }\n\n    this.playerRig.setAttribute(\"player-info\", { avatarSrc, avatarType: getAvatarType(avatarId) });\n    this.store.addEventListener(\"statechanged\", this._setPlayerInfoFromProfile);\n  };\n\n  _setupKicking = () => {\n    // This event is only received by the kicker\n    document.body.addEventListener(\"kicked\", ({ detail }) => {\n      const { clientId: kickedClientId } = detail;\n      const { entities } = NAF.connection.entities;\n      for (const id in entities) {\n        const entity = entities[id];\n        if (NAF.utils.getCreator(entity) !== kickedClientId) continue;\n\n        if (entity.components.networked.data.persistent) {\n          NAF.utils.takeOwnership(entity);\n          this._unpinElement(entity);\n          entity.parentNode.removeChild(entity);\n        } else {\n          NAF.entities.removeEntity(id);\n        }\n      }\n    });\n  };\n\n  _setupBlocking = () => {\n    document.body.addEventListener(\"blocked\", ev => {\n      NAF.connection.entities.removeEntitiesOfClient(ev.detail.clientId);\n    });\n\n    document.body.addEventListener(\"unblocked\", ev => {\n      NAF.connection.entities.completeSync(ev.detail.clientId, true);\n    });\n  };\n\n  _pinElement = async el => {\n    const { networkId } = el.components.networked.data;\n\n    const { fileId, src } = el.components[\"media-loader\"].data;\n\n    let fileAccessToken, promotionToken;\n    if (fileId) {\n      fileAccessToken = new URL(src).searchParams.get(\"token\");\n      const storedPromotionToken = getPromotionTokenForFile(fileId);\n      if (storedPromotionToken) {\n        promotionToken = storedPromotionToken.promotionToken;\n      }\n    }\n\n    const gltfNode = pinnedEntityToGltf(el);\n    if (!gltfNode) return;\n    el.setAttribute(\"networked\", { persistent: true });\n    el.setAttribute(\"media-loader\", { fileIsOwned: true });\n\n    try {\n      await this.hubChannel.pin(networkId, gltfNode, fileId, fileAccessToken, promotionToken);\n      this.store.update({ activity: { hasPinned: true } });\n    } catch (e) {\n      if (e.reason === \"invalid_token\") {\n        await this.authChannel.signOut(this.hubChannel);\n        this._signInAndPinOrUnpinElement(el);\n      } else {\n        console.warn(\"Pin failed for unknown reason\", e);\n      }\n    }\n  };\n\n  _signInAndPinOrUnpinElement = (el, pin) => {\n    const action = pin ? () => this._pinElement(el) : async () => await this._unpinElement(el);\n\n    this.performConditionalSignIn(() => this.hubChannel.signedIn, action, pin ? \"pin\" : \"unpin\", () => {\n      // UI pins/un-pins the entity optimistically, so we undo that here.\n      // Note we have to disable the sign in flow here otherwise this will recurse.\n      this._disableSignInOnPinAction = true;\n      el.setAttribute(\"pinnable\", \"pinned\", !pin);\n      this._disableSignInOnPinAction = false;\n    });\n  };\n\n  _unpinElement = el => {\n    const components = el.components;\n    const networked = components.networked;\n\n    if (!networked || !networked.data || !NAF.utils.isMine(el)) return;\n\n    const networkId = components.networked.data.networkId;\n    el.setAttribute(\"networked\", { persistent: false });\n\n    const mediaLoader = components[\"media-loader\"];\n    const fileId = mediaLoader.data && mediaLoader.data.fileId;\n\n    this.hubChannel.unpin(networkId, fileId);\n  };\n\n  _setupMedia = mediaStream => {\n    const offset = { x: 0, y: 0, z: -1.5 };\n    const spawnMediaInfrontOfPlayer = (src, contentOrigin) => {\n      const { entity, orientation } = addMedia(\n        src,\n        \"#interactable-media\",\n        contentOrigin,\n        !(src instanceof MediaStream),\n        true\n      );\n      orientation.then(or => {\n        entity.setAttribute(\"offset-relative-to\", {\n          target: \"#player-camera\",\n          offset,\n          orientation: or\n        });\n      });\n\n      return entity;\n    };\n\n    this.scene.addEventListener(\"add_media\", e => {\n      const contentOrigin = e.detail instanceof File ? ObjectContentOrigins.FILE : ObjectContentOrigins.URL;\n\n      spawnMediaInfrontOfPlayer(e.detail, contentOrigin);\n    });\n\n    this.scene.addEventListener(\"pinned\", e => {\n      if (this._disableSignInOnPinAction) return;\n\n      // Don't go into pin/unpin flow if the pin state didn't actually change and this was just initialization\n      if (!e.detail.changed) return;\n\n      this._signInAndPinOrUnpinElement(e.detail.el, true);\n    });\n\n    this.scene.addEventListener(\"unpinned\", e => {\n      if (this._disableSignInOnPinAction) return;\n\n      // Don't go into pin/unpin flow if the pin state didn't actually change and this was just initialization\n      if (!e.detail.changed) return;\n\n      this._signInAndPinOrUnpinElement(e.detail.el, false);\n    });\n\n    this.scene.addEventListener(\"object_spawned\", e => {\n      this.hubChannel.sendObjectSpawnedEvent(e.detail.objectType);\n    });\n\n    this.scene.addEventListener(\"action_spawn\", () => {\n      handleExitTo2DInterstitial(false, () => window.APP.mediaSearchStore.pushExitMediaBrowserHistory());\n      window.APP.mediaSearchStore.sourceNavigateToDefaultSource();\n    });\n\n    this.scene.addEventListener(\"action_invite\", () => {\n      handleExitTo2DInterstitial(false, () => this.history.goBack());\n      pushHistoryState(this.history, \"overlay\", \"invite\");\n    });\n\n    this.scene.addEventListener(\"action_kick_client\", ({ detail: { clientId } }) => {\n      this.performConditionalSignIn(\n        () => this.hubChannel.can(\"kick_users\"),\n        async () => await window.APP.hubChannel.kick(clientId),\n        \"kick-user\"\n      );\n    });\n\n    this.scene.addEventListener(\"action_mute_client\", ({ detail: { clientId } }) => {\n      this.performConditionalSignIn(\n        () => this.hubChannel.can(\"mute_users\"),\n        () => window.APP.hubChannel.mute(clientId),\n        \"mute-user\"\n      );\n    });\n\n    this.scene.addEventListener(\"action_vr_notice_closed\", () => forceExitFrom2DInterstitial());\n\n    document.addEventListener(\"paste\", e => {\n      if (e.target.matches(\"input, textarea\") && document.activeElement === e.target) return;\n\n      const url = e.clipboardData.getData(\"text\");\n      const files = e.clipboardData.files && e.clipboardData.files;\n      if (url) {\n        spawnMediaInfrontOfPlayer(url, ObjectContentOrigins.URL);\n      } else {\n        for (const file of files) {\n          spawnMediaInfrontOfPlayer(file, ObjectContentOrigins.CLIPBOARD);\n        }\n      }\n    });\n\n    document.addEventListener(\"dragover\", e => e.preventDefault());\n\n    document.addEventListener(\"drop\", e => {\n      e.preventDefault();\n      const url = e.dataTransfer.getData(\"url\");\n      const files = e.dataTransfer.files;\n      if (url) {\n        spawnMediaInfrontOfPlayer(url, ObjectContentOrigins.URL);\n      } else {\n        for (const file of files) {\n          spawnMediaInfrontOfPlayer(file, ObjectContentOrigins.FILE);\n        }\n      }\n    });\n\n    let currentVideoShareEntity;\n    let isHandlingVideoShare = false;\n\n    const shareVideoMediaStream = async constraints => {\n      if (isHandlingVideoShare) return;\n      isHandlingVideoShare = true;\n\n      const newStream = await navigator.mediaDevices.getUserMedia(constraints);\n      const videoTracks = newStream ? newStream.getVideoTracks() : [];\n\n      if (videoTracks.length > 0) {\n        newStream.getVideoTracks().forEach(track => mediaStream.addTrack(track));\n        NAF.connection.adapter.setLocalMediaStream(mediaStream);\n        currentVideoShareEntity = spawnMediaInfrontOfPlayer(mediaStream, undefined);\n\n        // Wire up custom removal event which will stop the stream.\n        currentVideoShareEntity.setAttribute(\"emit-scene-event-on-remove\", \"event:action_end_video_sharing\");\n      }\n\n      this.scene.emit(\"share_video_enabled\", { source: constraints.video.mediaSource });\n      this.scene.addState(\"sharing_video\");\n      isHandlingVideoShare = false;\n    };\n\n    this.scene.addEventListener(\"action_share_camera\", () => {\n      shareVideoMediaStream({\n        video: {\n          mediaSource: \"camera\",\n          width: isIOS ? { max: 1280 } : { max: 1280, ideal: 720 },\n          frameRate: 30\n        }\n      });\n    });\n\n    this.scene.addEventListener(\"action_share_window\", () => {\n      shareVideoMediaStream({\n        video: {\n          mediaSource: \"window\",\n          // Work around BMO 1449832 by calculating the width. This will break for multi monitors if you share anything\n          // other than your current monitor that has a different aspect ratio.\n          width: 720 * (screen.width / screen.height),\n          height: 720,\n          frameRate: 30\n        }\n      });\n    });\n\n    this.scene.addEventListener(\"action_share_screen\", () => {\n      shareVideoMediaStream({\n        video: {\n          mediaSource: \"screen\",\n          // Work around BMO 1449832 by calculating the width. This will break for multi monitors if you share anything\n          // other than your current monitor that has a different aspect ratio.\n          width: 720 * (screen.width / screen.height),\n          height: 720,\n          frameRate: 30\n        }\n      });\n    });\n\n    this.scene.addEventListener(\"action_end_video_sharing\", () => {\n      if (isHandlingVideoShare) return;\n      isHandlingVideoShare = true;\n\n      if (currentVideoShareEntity && currentVideoShareEntity.parentNode) {\n        currentVideoShareEntity.parentNode.removeChild(currentVideoShareEntity);\n      }\n\n      for (const track of mediaStream.getVideoTracks()) {\n        mediaStream.removeTrack(track);\n      }\n\n      NAF.connection.adapter.setLocalMediaStream(mediaStream);\n      currentVideoShareEntity = null;\n\n      this.scene.emit(\"share_video_disabled\");\n      this.scene.removeState(\"sharing_video\");\n      isHandlingVideoShare = false;\n    });\n\n    this.scene.addEventListener(\"action_selected_media_result_entry\", e => {\n      // TODO spawn in space when no rights\n      const entry = e.detail;\n      if ([\"avatar\", \"avatar_listing\"].includes(entry.type)) return;\n      if ((entry.type === \"scene_listing\" || entry.type === \"scene\") && this.hubChannel.can(\"update_hub\")) return;\n\n      // If user has HMD lifted up or gone through interstitial, delay spawning for now. eventually show a modal\n      const spawnDelay = isIn2DInterstitial() ? 3000 : 0;\n\n      setTimeout(() => {\n        spawnMediaInfrontOfPlayer(entry.url, ObjectContentOrigins.URL);\n      }, spawnDelay);\n\n      handleReEntryToVRFrom2DInterstitial();\n    });\n\n    this.mediaSearchStore.addEventListener(\"media-exit\", () => {\n      handleReEntryToVRFrom2DInterstitial();\n    });\n  };\n\n  _setupCamera = () => {\n    this.scene.addEventListener(\"action_toggle_camera\", () => {\n      const myCamera = this.scene.systems[\"camera-tools\"].getMyCamera();\n\n      if (myCamera) {\n        myCamera.parentNode.removeChild(myCamera);\n        this.scene.removeState(\"camera\");\n      } else {\n        const entity = document.createElement(\"a-entity\");\n        entity.setAttribute(\"networked\", { template: \"#interactable-camera\" });\n        entity.setAttribute(\"offset-relative-to\", {\n          target: \"#player-camera\",\n          offset: { x: 0, y: 0, z: -1.5 }\n        });\n        this.scene.appendChild(entity);\n        this.scene.addState(\"camera\");\n      }\n\n      // Need to wait a frame so camera is registered with system.\n      setTimeout(() => this.scene.emit(\"camera_toggled\"));\n    });\n\n    this.scene.addEventListener(\"photo_taken\", e => {\n      this.hubChannel.sendMessage({ src: e.detail }, \"photo\");\n    });\n  };\n\n  _spawnAvatar = () => {\n    this.playerRig.setAttribute(\"networked\", \"template: #remote-avatar-template; attachTemplateToLocal: false;\");\n    this.playerRig.setAttribute(\"networked-avatar\", \"\");\n    this.playerRig.emit(\"entered\");\n  };\n\n  _runBot = async mediaStream => {\n    const audioEl = document.createElement(\"audio\");\n    let audioInput;\n    let dataInput;\n\n    // Wait for startup to render form\n    do {\n      audioInput = document.querySelector(\"#bot-audio-input\");\n      dataInput = document.querySelector(\"#bot-data-input\");\n      await nextTick();\n    } while (!audioInput || !dataInput);\n\n    const getAudio = () => {\n      audioEl.loop = true;\n      audioEl.muted = true;\n      audioEl.crossorigin = \"anonymous\";\n      audioEl.src = URL.createObjectURL(audioInput.files[0]);\n      document.body.appendChild(audioEl);\n    };\n\n    if (audioInput.files && audioInput.files.length > 0) {\n      getAudio();\n    } else {\n      audioInput.onchange = getAudio;\n    }\n\n    const camera = document.querySelector(\"#player-camera\");\n    const leftController = document.querySelector(\"#player-left-controller\");\n    const rightController = document.querySelector(\"#player-right-controller\");\n    const getRecording = () => {\n      fetch(URL.createObjectURL(dataInput.files[0]))\n        .then(resp => resp.json())\n        .then(recording => {\n          camera.setAttribute(\"replay\", \"\");\n          camera.components[\"replay\"].poses = recording.camera.poses;\n\n          leftController.setAttribute(\"replay\", \"\");\n          leftController.components[\"replay\"].poses = recording.left.poses;\n          leftController.removeAttribute(\"visibility-by-path\");\n          leftController.removeAttribute(\"track-pose\");\n          leftController.setAttribute(\"visible\", true);\n\n          rightController.setAttribute(\"replay\", \"\");\n          rightController.components[\"replay\"].poses = recording.right.poses;\n          rightController.removeAttribute(\"visibility-by-path\");\n          rightController.removeAttribute(\"track-pose\");\n          rightController.setAttribute(\"visible\", true);\n        });\n    };\n\n    if (dataInput.files && dataInput.files.length > 0) {\n      getRecording();\n    } else {\n      dataInput.onchange = getRecording;\n    }\n\n    await new Promise(resolve => audioEl.addEventListener(\"canplay\", resolve));\n    mediaStream.addTrack(\n      audioEl.captureStream\n        ? audioEl.captureStream().getAudioTracks()[0]\n        : audioEl.mozCaptureStream\n          ? audioEl.mozCaptureStream().getAudioTracks()[0]\n          : null\n    );\n    NAF.connection.adapter.setLocalMediaStream(mediaStream);\n    audioEl.play();\n  };\n}\n","export default function pinnedEntityToGltf(el) {\n  if (!NAF.utils.isMine(el)) return;\n\n  // Construct a GLTF node from this entity\n  const object3D = el.object3D;\n  const components = el.components;\n  const networkId = components.networked.data.networkId;\n\n  const gltfComponents = {};\n  // TODO: Move to MOZ_hubs_components and include version number. Requires migration of existing room objects.\n  // Please do this before making a breaking change to the data stored here.\n  const gltfNode = { name: networkId, extensions: { HUBS_components: gltfComponents } };\n\n  // Adapted from three.js GLTFExporter\n  const equalArray = (x, y) => x.length === y.length && x.every((v, i) => v === y[i]);\n  const rotation = object3D.quaternion.toArray();\n  const position = object3D.position.toArray();\n  const scale = object3D.scale.toArray();\n\n  if (!equalArray(rotation, [0, 0, 0, 1])) gltfNode.rotation = rotation;\n  if (!equalArray(position, [0, 0, 0])) gltfNode.translation = position;\n  if (!equalArray(scale, [1, 1, 1])) gltfNode.scale = scale;\n\n  if (components[\"media-loader\"]) {\n    const mediaSrc = components[\"media-loader\"].data.src;\n\n    if (mediaSrc.startsWith(\"hubs://\") && mediaSrc.endsWith(\"/video\")) {\n      // Do not persist hubs client video urls\n      return null;\n    }\n\n    gltfComponents.media = { src: mediaSrc, id: networkId };\n\n    if (components[\"media-pager\"]) {\n      gltfComponents.media.pageIndex = components[\"media-pager\"].data.index;\n    }\n\n    if (components[\"media-video\"] && components[\"media-video\"].data.videoPaused) {\n      gltfComponents.media.paused = true;\n      gltfComponents.media.time = components[\"media-video\"].data.time;\n    }\n  }\n\n  gltfComponents.pinnable = { pinned: true };\n\n  return gltfNode;\n}\n","import nextTick from \"./utils/next-tick.js\";\nconst INIT_TIMEOUT_MS = 5000;\n\n// Manages web push subscriptions\n//\nfunction urlBase64ToUint8Array(base64String) {\n  const padding = \"=\".repeat((4 - (base64String.length % 4)) % 4);\n  const base64 = (base64String + padding).replace(/-/g, \"+\").replace(/_/g, \"/\");\n\n  const rawData = window.atob(base64);\n  const outputArray = new Uint8Array(rawData.length);\n\n  for (let i = 0; i < rawData.length; ++i) {\n    outputArray[i] = rawData.charCodeAt(i);\n  }\n  return outputArray;\n}\n\nexport default class Subscriptions {\n  constructor(hubId) {\n    this.hubId = hubId;\n  }\n\n  setHubChannel = hubChannel => {\n    this.hubChannel = hubChannel;\n  };\n\n  setRegistration = registration => {\n    this.registration = registration;\n  };\n\n  setRegistrationFailed = () => {\n    this.registration = null;\n  };\n\n  setVapidPublicKey = vapidPublicKey => {\n    this.vapidPublicKey = vapidPublicKey;\n  };\n\n  setSubscribed = isSubscribed => {\n    this._isSubscribed = isSubscribed;\n  };\n\n  isSubscribed = () => {\n    return this._isSubscribed;\n  };\n\n  getCurrentEndpoint = async () => {\n    if (!navigator.serviceWorker) return null;\n    const startedAt = performance.now();\n\n    // registration becomes null if failed, non null if registered\n    while (this.registration === undefined && performance.now() - startedAt < INIT_TIMEOUT_MS) await nextTick();\n    if (performance.now() - startedAt >= INIT_TIMEOUT_MS) console.warn(\"Service worker registration timed out.\");\n    if (!this.registration || !this.registration.pushManager) return null;\n\n    while (this.vapidPublicKey === undefined) await nextTick();\n    if (this.vapidPublicKey === null) return null;\n\n    try {\n      const convertedVapidKey = urlBase64ToUint8Array(this.vapidPublicKey);\n\n      if (\n        (await this.registration.pushManager.permissionState({\n          userVisibleOnly: true,\n          applicationServerKey: convertedVapidKey\n        })) !== \"granted\"\n      )\n        return null;\n    } catch (e) {\n      return null; // Chrome can throw here complaining about userVisible if push is not right\n    }\n    const sub = await this.registration.pushManager.getSubscription();\n    if (!sub) return null;\n\n    return sub.endpoint;\n  };\n\n  toggle = async () => {\n    if (!this.registration) return;\n\n    if (this._isSubscribed) {\n      const pushSubscription = await this.registration.pushManager.getSubscription();\n      const res = await this.hubChannel.unsubscribe(pushSubscription);\n\n      if (res && res.has_remaining_subscriptions === false) {\n        pushSubscription.unsubscribe();\n      }\n    } else {\n      let pushSubscription = await this.registration.pushManager.getSubscription();\n\n      if (!pushSubscription) {\n        const convertedVapidKey = urlBase64ToUint8Array(this.vapidPublicKey);\n\n        pushSubscription = await this.registration.pushManager.subscribe({\n          userVisibleOnly: true,\n          applicationServerKey: convertedVapidKey\n        });\n      }\n\n      this.hubChannel.subscribe(pushSubscription);\n    }\n\n    this._isSubscribed = !this._isSubscribed;\n  };\n}\n","import { forEachMaterial } from \"../utils/material-utils\";\n\nconst invaderPos = new AFRAME.THREE.Vector3();\nconst bubblePos = new AFRAME.THREE.Vector3();\n\n/**\n * Iterates through bubbles and invaders on every tick and sets invader state accordingly.\n * testing multiline things\n * @namespace avatar/personal-space-bubble\n * @system personal-space-bubble\n */\nAFRAME.registerSystem(\"personal-space-bubble\", {\n  schema: {\n    debug: { default: false },\n    enabled: { default: true }\n  },\n\n  init() {\n    this.invaders = [];\n    this.bubbles = [];\n\n    this.el.addEventListener(\"action_space_bubble\", () => {\n      this.el.setAttribute(\"personal-space-bubble\", { enabled: !this.data.enabled });\n    });\n  },\n\n  registerBubble(bubble) {\n    this.bubbles.push(bubble);\n  },\n\n  unregisterBubble(bubble) {\n    const index = this.bubbles.indexOf(bubble);\n\n    if (index !== -1) {\n      this.bubbles.splice(index, 1);\n    }\n  },\n\n  registerInvader(invader) {\n    NAF.utils.getNetworkedEntity(invader.el).then(networkedEl => {\n      const owner = NAF.utils.getNetworkOwner(networkedEl);\n\n      if (owner !== NAF.clientId) {\n        this.invaders.push(invader);\n      }\n    });\n  },\n\n  unregisterInvader(invader) {\n    const index = this.invaders.indexOf(invader);\n\n    if (index !== -1) {\n      this.invaders.splice(index, 1);\n    }\n  },\n\n  update() {\n    for (let i = 0; i < this.bubbles.length; i++) {\n      this.bubbles[i].updateDebug();\n    }\n\n    for (let i = 0; i < this.invaders.length; i++) {\n      this.invaders[i].updateDebug();\n      if (!this.data.enabled) {\n        this.invaders[i].setInvading(false);\n      }\n    }\n\n    if (this.data.enabled) {\n      this.el.addState(\"spacebubble\");\n    } else {\n      this.el.removeState(\"spacebubble\");\n    }\n  },\n\n  tick: (function() {\n    const tempInvasionFlags = [];\n\n    return function() {\n      if (!this.data.enabled) return;\n\n      tempInvasionFlags.length = 0;\n\n      // precondition for this stuff -- the bubbles and invaders need updated world matrices.\n      // right now this is satisfied because we update the world matrices in the character controller\n      for (let i = 0; i < this.invaders.length; i++) {\n        this.invaders[i].el.object3D.updateMatrices(); // We read matrixWorld below, update matrices here\n        tempInvasionFlags[i] = false;\n      }\n\n      // Loop through all of the space bubbles (usually one)\n      for (let i = 0; i < this.bubbles.length; i++) {\n        const bubble = this.bubbles[i];\n\n        bubble.el.object3D.updateMatrices();\n        bubblePos.setFromMatrixPosition(bubble.el.object3D.matrixWorld);\n\n        // Hide the invader if inside the bubble\n        for (let j = 0; j < this.invaders.length; j++) {\n          const invader = this.invaders[j];\n\n          invaderPos.setFromMatrixPosition(invader.el.object3D.matrixWorld);\n\n          const distanceSquared = bubblePos.distanceToSquared(invaderPos);\n          const radiusSum = bubble.data.radius + invader.data.radius;\n          if (distanceSquared < radiusSum * radiusSum) {\n            tempInvasionFlags[j] = true;\n          }\n        }\n      }\n\n      for (let i = 0; i < this.invaders.length; i++) {\n        if (this.invaders[i].invading !== tempInvasionFlags[i]) {\n          this.invaders[i].setInvading(tempInvasionFlags[i]);\n        }\n      }\n    };\n  })()\n});\n\nfunction createSphereGizmo(radius) {\n  const geometry = new THREE.SphereBufferGeometry(radius, 10, 10);\n  const wireframe = new THREE.WireframeGeometry(geometry);\n  const line = new THREE.LineSegments(wireframe);\n  line.material.opacity = 0.5;\n  line.material.transparent = true;\n  return line;\n}\n\n// TODO: we need to come up with a more generic way of doing this as this is very specific to our avatars.\n/**\n * Specifies a mesh associated with an invader.\n * @namespace avatar/personal-space-bubble\n * @component space-invader-mesh\n */\nAFRAME.registerComponent(\"space-invader-mesh\", {\n  schema: {\n    meshName: { type: \"string\" }\n  },\n  update() {\n    this.targetMesh = this.el.object3D.getObjectByName(this.data.meshName);\n  }\n});\n\nfunction findInvaderMesh(entity) {\n  while (entity && !(entity.components && entity.components[\"space-invader-mesh\"])) {\n    entity = entity.parentNode;\n  }\n  return entity && entity.components[\"space-invader-mesh\"].targetMesh;\n}\n\nconst DEBUG_OBJ = \"psb-debug\";\n\n/**\n * Represents an entity that can invade a personal space bubble\n * @namespace avatar/personal-space-bubble\n * @component personal-space-invader\n */\nAFRAME.registerComponent(\"personal-space-invader\", {\n  schema: {\n    radius: { type: \"number\", default: 0.1 },\n    useMaterial: { default: false },\n    debug: { default: false },\n    invadingOpacity: { default: 0.3 }\n  },\n\n  init() {\n    const system = this.el.sceneEl.systems[\"personal-space-bubble\"];\n    system.registerInvader(this);\n    if (this.data.useMaterial) {\n      const mesh = findInvaderMesh(this.el);\n      if (mesh) {\n        this.targetMesh = mesh;\n      }\n    }\n    this.invading = false;\n  },\n\n  update() {\n    this.radiusSquared = this.data.radius * this.data.radius;\n    this.updateDebug();\n  },\n\n  updateDebug() {\n    const system = this.el.sceneEl.systems[\"personal-space-bubble\"];\n    if (system.data.debug || this.data.debug) {\n      !this.el.object3DMap[DEBUG_OBJ] && this.el.setObject3D(DEBUG_OBJ, createSphereGizmo(this.data.radius));\n    } else if (this.el.object3DMap[DEBUG_OBJ]) {\n      this.el.removeObject3D(DEBUG_OBJ);\n    }\n  },\n\n  remove() {\n    this.el.sceneEl.systems[\"personal-space-bubble\"].unregisterInvader(this);\n  },\n\n  setInvading(invading) {\n    if (this.invading === invading) return;\n\n    if (this.targetMesh && this.targetMesh.material) {\n      forEachMaterial(this.targetMesh, material => {\n        material.opacity = invading ? this.data.invadingOpacity : 1;\n        material.transparent = invading;\n      });\n    } else {\n      this.el.object3D.visible = !invading;\n    }\n    this.invading = invading;\n  }\n});\n\n/**\n * Represents a personal space bubble on an entity.\n * @namespace avatar/personal-space-bubble\n * @component personal-space-bubble\n */\nAFRAME.registerComponent(\"personal-space-bubble\", {\n  schema: {\n    radius: { type: \"number\", default: 0.8 },\n    debug: { default: false }\n  },\n  init() {\n    this.system.registerBubble(this);\n  },\n\n  update() {\n    this.radiusSquared = this.data.radius * this.data.radius;\n    this.updateDebug();\n  },\n\n  updateDebug() {\n    if (this.system.data.debug || this.data.debug) {\n      !this.el.object3DMap[DEBUG_OBJ] && this.el.setObject3D(DEBUG_OBJ, createSphereGizmo(this.data.radius));\n    } else if (this.el.object3DMap[DEBUG_OBJ]) {\n      this.el.removeObject3D(DEBUG_OBJ);\n    }\n  },\n\n  remove() {\n    this.system.unregisterBubble(this);\n  }\n});\n","import { paths } from \"../paths\";\n\n// TODO: Where do these values (500, 10, 2) come from?\nconst modeMod = {\n  [WheelEvent.DOM_DELTA_PIXEL]: 500,\n  [WheelEvent.DOM_DELTA_LINE]: 10,\n  [WheelEvent.DOM_DELTA_PAGE]: 2\n};\n\nconst isInModal = (() => {\n  let uiRoot = null;\n\n  return function() {\n    if (!uiRoot) {\n      uiRoot = document.querySelector(\".ui-root\");\n    }\n\n    return uiRoot && uiRoot.classList.contains(\"in-modal-or-overlay\");\n  };\n})();\n\nexport class MouseDevice {\n  constructor() {\n    this.events = [];\n    this.coords = [0, 0]; // normalized screenspace coordinates in [(-1, 1), (-1, 1)]\n    this.movementXY = [0, 0]; // deltas\n    this.buttonLeft = false;\n    this.buttonRight = false;\n    this.wheel = 0; // delta\n\n    const queueEvent = this.events.push.bind(this.events);\n    const canvas = document.querySelector(\"canvas\");\n    [\"mousedown\", \"wheel\"].map(x => canvas.addEventListener(x, queueEvent));\n    [\"mousemove\", \"mouseup\"].map(x => window.addEventListener(x, queueEvent));\n\n    document.addEventListener(\"wheel\", e => {\n      // Do not capture wheel events if they are being sent to an modal/overlay\n      if (!isInModal()) {\n        e.preventDefault();\n      }\n    });\n  }\n\n  process(event) {\n    if (event.type === \"wheel\") {\n      this.wheel += (event.deltaX + event.deltaY) / modeMod[event.deltaMode];\n      return;\n    }\n\n    const left = event.button === 0;\n    const right = event.button === 2;\n    this.coords[0] = (event.clientX / window.innerWidth) * 2 - 1;\n    this.coords[1] = -(event.clientY / window.innerHeight) * 2 + 1;\n    this.movementXY[0] += event.movementX;\n    this.movementXY[1] += event.movementY;\n    if (event.type === \"mousedown\" && left) {\n      this.buttonLeft = true;\n    } else if (event.type === \"mousedown\" && right) {\n      this.buttonRight = true;\n    } else if (event.type === \"mouseup\" && left) {\n      this.buttonLeft = false;\n    } else if (event.type === \"mouseup\" && right) {\n      this.buttonRight = false;\n    }\n  }\n\n  write(frame) {\n    this.movementXY[0] = 0; // deltas\n    this.movementXY[1] = 0; // deltas\n    this.wheel = 0; // delta\n\n    for (let i = 0; i < this.events.length; i++) {\n      const event = this.events[i];\n      this.process(event);\n    }\n\n    this.events.length = 0;\n\n    frame.setVector2(paths.device.mouse.coords, this.coords[0], this.coords[1]);\n    frame.setVector2(paths.device.mouse.movementXY, this.movementXY[0], this.movementXY[1]);\n    frame.setValueType(paths.device.mouse.buttonLeft, this.buttonLeft);\n    frame.setValueType(paths.device.mouse.buttonRight, this.buttonRight);\n    frame.setValueType(paths.device.mouse.wheel, this.wheel);\n  }\n}\n\nwindow.oncontextmenu = e => {\n  if (!isInModal()) {\n    e.preventDefault();\n  }\n};\n","// You might prefer to use this over a Set because iterating over a set allocates memory\nexport function ArrayBackedSet(initialItems) {\n  return {\n    items: initialItems || [],\n    has(item) {\n      return this.items.indexOf(item) !== -1;\n    },\n    add(item) {\n      if (!this.has(item)) {\n        this.items.push(item);\n      }\n    },\n    delete(item) {\n      const index = this.items.indexOf(item);\n      if (index !== -1) {\n        this.items[index] = this.items[this.items.length - 1];\n        this.items.pop();\n      }\n    },\n    clear() {\n      this.items.length = 0;\n    }\n  };\n}\n","import { paths } from \"../paths\";\nimport { ArrayBackedSet } from \"../array-backed-set\";\nexport class KeyboardDevice {\n  constructor() {\n    this.seenKeys = new ArrayBackedSet();\n    this.keys = {};\n    this.events = [];\n\n    [\"keydown\", \"keyup\"].map(x =>\n      document.addEventListener(x, e => {\n        if (!e.key) return;\n        this.events.push(e);\n\n        // Block browser hotkeys for chat command, media browser and freeze\n        if (\n          (e.type === \"keydown\" &&\n            e.key === \"/\" &&\n            ![\"TEXTAREA\", \"INPUT\"].includes(document.activeElement && document.activeElement.nodeName)) ||\n          (e.ctrlKey &&\n            (e.key === \"1\" ||\n              e.key === \"2\" ||\n              e.key === \"3\" ||\n              e.key === \"4\" ||\n              e.key === \"5\" ||\n              e.key === \"6\" ||\n              e.key === \"7\" ||\n              e.key === \"8\" ||\n              e.key === \"9\" ||\n              e.key === \"0\")) ||\n          e.key === \"Tab\"\n        ) {\n          e.preventDefault();\n          return false;\n        }\n      })\n    );\n    [\"blur\"].map(x => window.addEventListener(x, this.events.push.bind(this.events)));\n  }\n\n  write(frame) {\n    for (let i = 0; i < this.events.length; i++) {\n      const event = this.events[i];\n      if (event.type === \"blur\") {\n        this.keys = {};\n        this.seenKeys.clear();\n      } else {\n        const key = event.key.toLowerCase();\n        this.keys[key] = event.type === \"keydown\";\n        this.seenKeys.add(key);\n      }\n    }\n\n    this.events.length = 0;\n\n    for (let i = 0; i < this.seenKeys.items.length; i++) {\n      const key = this.seenKeys.items[i];\n      const path = paths.device.keyboard.key(key);\n      frame.setValueType(path, this.keys[key]);\n    }\n  }\n}\n","import { paths } from \"../paths\";\n\nexport class HudDevice {\n  constructor() {\n    this.events = [];\n    document.querySelector(\"a-scene\").addEventListener(\"penButtonPressed\", this.events.push.bind(this.events));\n  }\n\n  write(frame) {\n    frame.setValueType(paths.device.hud.penButton, this.events.length !== 0);\n    while (this.events.length) {\n      this.events.pop();\n    }\n  }\n}\n","import { paths } from \"../paths\";\n\nexport class XboxControllerDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n    this.buttonMap = [\n      { name: \"a\", buttonId: 0 },\n      { name: \"b\", buttonId: 1 },\n      { name: \"x\", buttonId: 2 },\n      { name: \"y\", buttonId: 3 },\n      { name: \"leftBumper\", buttonId: 4 },\n      { name: \"rightBumper\", buttonId: 5 },\n      { name: \"leftTrigger\", buttonId: 6 },\n      { name: \"rightTrigger\", buttonId: 7 },\n      { name: \"back\", buttonId: 8 },\n      { name: \"start\", buttonId: 9 },\n      { name: \"leftJoystick\", buttonId: 10 },\n      { name: \"rightJoystick\", buttonId: 11 },\n      { name: \"dpadUp\", buttonId: 12 },\n      { name: \"dpadDown\", buttonId: 13 },\n      { name: \"dpadLeft\", buttonId: 14 },\n      { name: \"dpadRight\", buttonId: 15 }\n    ];\n    this.axisMap = [\n      { name: \"leftJoystickHorizontal\", axisId: 0 },\n      { name: \"leftJoystickVertical\", axisId: 1 },\n      { name: \"rightJoystickHorizontal\", axisId: 2 },\n      { name: \"rightJoystickVertical\", axisId: 3 }\n    ];\n  }\n\n  write(frame) {\n    this.gamepad = navigator.getGamepads()[this.gamepad.index];\n    if (this.gamepad.connected) {\n      this.buttonMap.forEach(b => {\n        const path = paths.device.xbox.button(b.name);\n        const button = this.gamepad.buttons[b.buttonId];\n        frame.setValueType(path.pressed, !!button.pressed);\n        frame.setValueType(path.touched, !!button.touched);\n        frame.setValueType(path.value, button.value);\n      });\n      this.axisMap.forEach(axis => {\n        frame.setValueType(paths.device.xbox.axis(axis.name), this.gamepad.axes[axis.axisId]);\n      });\n\n      if (this.gamepad.hapticActuators && this.gamepad.hapticActuators[0]) {\n        frame.setValueType(paths.haptics.actuators[this.gamepad.hand], this.gamepad.hapticActuators[0]);\n      }\n    }\n  }\n}\n","const THREE = typeof window !== \"undefined\" && window.THREE;\nconst Vector3 = (THREE && THREE.Vector3) || function() {};\nconst Quaternion = (THREE && THREE.Quaternion) || function() {};\nconst forward = typeof window !== \"undefined\" && window.THREE && new THREE.Vector3(0, 0, -1);\nexport function Pose() {\n  return {\n    position: new Vector3(),\n    direction: new Vector3(),\n    orientation: new Quaternion(),\n    fromOriginAndDirection: function(origin, direction) {\n      this.position = origin;\n      this.direction = direction;\n      this.orientation = this.orientation.setFromUnitVectors(forward, direction);\n      return this;\n    },\n    fromCameraProjection: function(camera, normalizedX, normalizedY) {\n      this.position.setFromMatrixPosition(camera.matrixWorld);\n      this.direction\n        .set(normalizedX, normalizedY, 0.5)\n        .unproject(camera)\n        .sub(this.position)\n        .normalize();\n      this.fromOriginAndDirection(this.position, this.direction);\n      return this;\n    },\n    copy: function(pose) {\n      this.position.copy(pose.position);\n      this.direction.copy(pose.direction);\n      this.orientation.copy(pose.orientation);\n    }\n  };\n}\n","// Vector from eyes to elbow (divided by user height).\nconst EYES_TO_ELBOW = { x: 0.175, y: -0.3, z: -0.03 };\n// Vector from eyes to elbow (divided by user height).\nconst FOREARM = { x: 0, y: 0, z: -0.175 };\n\nexport const applyArmModel = (function() {\n  const controllerEuler = new THREE.Euler();\n  const deltaControllerPosition = new THREE.Vector3();\n  const controllerQuaternion = new THREE.Quaternion();\n  const controllerPosition = new THREE.Vector3();\n  return function applyArmModel(gamepadPose, hand, headObject3D, userHeight) {\n    headObject3D.updateMatrices();\n    controllerPosition.copy(headObject3D.position);\n    controllerPosition.y = controllerPosition.y - userHeight;\n    deltaControllerPosition.set(\n      EYES_TO_ELBOW.x * (hand === \"left\" ? -1 : hand === \"right\" ? 1 : 0),\n      EYES_TO_ELBOW.y,\n      EYES_TO_ELBOW.z\n    );\n    deltaControllerPosition.multiplyScalar(userHeight);\n    deltaControllerPosition.applyAxisAngle(headObject3D.up, headObject3D.rotation.y);\n    controllerPosition.add(deltaControllerPosition);\n    deltaControllerPosition.set(FOREARM.x, FOREARM.y, FOREARM.z);\n    deltaControllerPosition.multiplyScalar(userHeight);\n    controllerQuaternion.fromArray(gamepadPose.orientation);\n    controllerEuler.setFromQuaternion(controllerQuaternion);\n    controllerEuler.set(controllerEuler.x, controllerEuler.y, 0);\n    deltaControllerPosition.applyEuler(controllerEuler);\n    controllerPosition.add(deltaControllerPosition);\n    return controllerPosition;\n  };\n})();\n","export const copySittingToStandingTransform = function copySittingToStandingTransform(matrix) {\n  navigator.getVRDisplays &&\n    navigator.getVRDisplays().then(displays => {\n      if (displays[0] && displays[0].stageParameters && displays[0].stageParameters.sittingToStandingTransform) {\n        matrix.fromArray(displays[0].stageParameters.sittingToStandingTransform);\n      }\n    });\n};\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { applyArmModel } from \"../arm-model.js\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\n\nconst TOUCHPAD = paths.device.oculusgo.touchpad;\nconst TRIGGER = paths.device.oculusgo.trigger;\n\nexport class OculusGoControllerDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n    this.rayObjectRotation = new THREE.Quaternion();\n    this.pose = new Pose();\n    this.q = new THREE.Quaternion();\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n    this.matrix = new THREE.Matrix4();\n    this.orientation = new THREE.Quaternion();\n\n    // TODO ideally we should just be getting pose from the gamepad\n    // TODO if controller is set to left hand, we still use right hand query here\n    // because otherwise things break.\n    this.rayObject = document.querySelector(\"#player-right-controller\").object3D;\n    this.headObject3D = document.querySelector(\"#player-camera\").object3D;\n    navigator.getGamepads();\n  }\n\n  write(frame) {\n    // Have to call navigator.getGamepads() in order for the gamepad object to update.\n    navigator.getGamepads();\n    if (this.gamepad.connected) {\n      frame.setValueType(TOUCHPAD.axisX, this.gamepad.axes[0]);\n      frame.setValueType(TOUCHPAD.axisY, this.gamepad.axes[1]);\n      frame.setValueType(TOUCHPAD.pressed, this.gamepad.buttons[0].pressed);\n      frame.setValueType(TOUCHPAD.touched, this.gamepad.buttons[0].touched);\n      frame.setValueType(TOUCHPAD.value, this.gamepad.buttons[0].value);\n      frame.setValueType(TRIGGER.pressed, this.gamepad.buttons[1].pressed);\n      frame.setValueType(TRIGGER.touched, this.gamepad.buttons[1].touched);\n      frame.setValueType(TRIGGER.value, this.gamepad.buttons[1].value);\n\n      this.rayObject.updateMatrices();\n      this.rayObject.getWorldQuaternion(this.q);\n      frame.setValueType(paths.actions.rayObjectRotation, this.q);\n      const rayMatrixWorld = this.rayObject.matrixWorld;\n      this.rayObjectRotation.setFromRotationMatrix(rayMatrixWorld);\n      this.pose.position.setFromMatrixPosition(rayMatrixWorld);\n      this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n      this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n      frame.setPose(paths.device.oculusgo.pose, this.pose);\n\n      if (this.gamepad.pose.orientation) {\n        // TODO if controller is set to left hand, we still draw right hand until\n        // bindings are overhauled to handle primary/secondary hands.\n        frame.setMatrix4(\n          paths.device.oculusgo.matrix,\n          this.matrix\n            .compose(\n              applyArmModel(this.gamepad.pose, this.gamepad.hand, this.headObject3D, 1.6),\n              this.orientation.fromArray(this.gamepad.pose.orientation),\n              ONES\n            )\n            .premultiply(this.sittingToStandingMatrix)\n        );\n      }\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { applyArmModel } from \"../arm-model.js\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\n\nconst TOUCHPAD = paths.device.gearVRController.button(\"touchpad\");\nconst TRIGGER = paths.device.gearVRController.button(\"trigger\");\nconst TOUCHPAD_X = paths.device.gearVRController.axis(\"touchpadX\");\nconst TOUCHPAD_Y = paths.device.gearVRController.axis(\"touchpadY\");\n\nexport class GearVRControllerDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n    this.buttonMap = [{ name: \"touchpad\", buttonId: 0 }, { name: \"trigger\", buttonId: 1 }];\n    this.axisMap = [{ name: \"touchpadX\", axisId: 0 }, { name: \"touchpadY\", axisId: 1 }];\n\n    this.rayObjectRotation = new THREE.Quaternion();\n    this.selector = `#player-${gamepad.hand}-controller`;\n    this.pose = new Pose();\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n\n    this.matrix = new THREE.Matrix4();\n    this.orientation = new THREE.Quaternion();\n  }\n\n  write(frame) {\n    // Chrome requires a call to getGamepads() for the gamepad state to update.\n    navigator.getGamepads();\n    if (this.gamepad.connected) {\n      const touchpad = this.gamepad.buttons[0];\n      frame.setValueType(TOUCHPAD.pressed, !!touchpad.pressed);\n      frame.setValueType(TOUCHPAD.touched, !!touchpad.touched);\n      frame.setValueType(TOUCHPAD.value, !!touchpad.value);\n\n      const trigger = this.gamepad.buttons[1];\n      frame.setValueType(TRIGGER.pressed, !!trigger.pressed);\n      frame.setValueType(TRIGGER.touched, !!trigger.touched);\n      frame.setValueType(TRIGGER.value, !!trigger.value);\n\n      frame.setValueType(TOUCHPAD_X, this.gamepad.axes[0]);\n      frame.setValueType(TOUCHPAD_Y, this.gamepad.axes[1]);\n\n      // TODO we should just be getting pose from the gamepad\n      if (!this.rayObject) {\n        this.rayObject = document.querySelector(this.selector).object3D;\n      }\n      this.rayObject.updateMatrixWorld();\n      this.rayObjectRotation.setFromRotationMatrix(this.rayObject.matrixWorld);\n      this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\n      this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n      this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n      frame.setPose(paths.device.gearVRController.pose, this.pose);\n      this.headObject3D = this.headObject3D || document.querySelector(\"#player-camera\").object3D;\n      if (this.gamepad.pose.orientation) {\n        frame.setMatrix4(\n          paths.device.gearVRController.matrix,\n          this.matrix\n            .compose(\n              applyArmModel(this.gamepad.pose, this.gamepad.hand, this.headObject3D, 1.6),\n              this.orientation.fromArray(this.gamepad.pose.orientation),\n              ONES\n            )\n            .premultiply(this.sittingToStandingMatrix)\n        );\n      }\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\n\nexport const leftOculusTouchButtonMap = [\n  { name: \"thumbStick\", buttonId: 0 },\n  { name: \"trigger\", buttonId: 1 },\n  { name: \"grip\", buttonId: 2 },\n  { name: \"x\", buttonId: 3 },\n  { name: \"y\", buttonId: 4 }\n];\nexport const rightOculusTouchButtonMap = [\n  { name: \"thumbStick\", buttonId: 0 },\n  { name: \"trigger\", buttonId: 1 },\n  { name: \"grip\", buttonId: 2 },\n  { name: \"a\", buttonId: 3 },\n  { name: \"b\", buttonId: 4 }\n];\n\nconst LEFT_HAND_OFFSET = new THREE.Matrix4().makeTranslation(-0.025, -0.03, 0.1);\nconst RIGHT_HAND_OFFSET = new THREE.Matrix4().makeTranslation(0.025, -0.03, 0.1);\n\nexport class OculusTouchControllerDevice {\n  constructor(gamepad) {\n    this.rayObjectRotation = new THREE.Quaternion();\n\n    // wake the gamepad api up. otherwise it does not report touch controllers.\n    // in chrome it still won't unless you enter vr.\n    navigator.getVRDisplays();\n\n    const buttonMaps = {\n      left: leftOculusTouchButtonMap,\n      right: rightOculusTouchButtonMap\n    };\n\n    const devicePaths = {\n      left: paths.device.leftOculusTouch,\n      right: paths.device.rightOculusTouch\n    };\n\n    this.gamepad = gamepad;\n    this.pose = new Pose();\n    this.buttonMap = buttonMaps[gamepad.hand];\n    this.axisMap = [{ name: \"joyX\", axisId: 0 }, { name: \"joyY\", axisId: 1 }];\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n    this.matrix = new THREE.Matrix4();\n    this.path = devicePaths[gamepad.hand];\n    this.selector = `#player-${gamepad.hand}-controller`;\n\n    this.position = new THREE.Vector3();\n    this.orientation = new THREE.Quaternion();\n    this.handOffset = this.gamepad.hand === \"left\" ? LEFT_HAND_OFFSET : RIGHT_HAND_OFFSET;\n  }\n\n  write(frame) {\n    this.gamepad = navigator.getGamepads()[this.gamepad.index];\n    if (!this.gamepad.connected) return;\n\n    this.buttonMap.forEach(b => {\n      const path = this.path.button(b.name);\n      const button = this.gamepad.buttons[b.buttonId];\n      frame.setValueType(path.pressed, !!button.pressed);\n      frame.setValueType(path.touched, !!button.touched);\n      frame.setValueType(path.value, button.value);\n    });\n    this.axisMap.forEach(axis => {\n      frame.setValueType(this.path.axis(axis.name), this.gamepad.axes[axis.axisId]);\n    });\n\n    this.rayObject = this.rayObject || document.querySelector(this.selector).object3D;\n    this.rayObject.updateMatrixWorld();\n    this.rayObjectRotation.setFromRotationMatrix(this.rayObject.matrixWorld);\n    this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\n    this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n    this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n    frame.setPose(this.path.pose, this.pose);\n    if (this.gamepad.pose.position && this.gamepad.pose.orientation) {\n      frame.setMatrix4(\n        this.path.matrix,\n        this.matrix\n          .compose(\n            this.position.fromArray(this.gamepad.pose.position),\n            this.orientation.fromArray(this.gamepad.pose.orientation),\n            ONES\n          )\n          .premultiply(this.sittingToStandingMatrix)\n          .multiply(this.handOffset)\n      );\n    }\n    if (this.gamepad.hapticActuators && this.gamepad.hapticActuators[0]) {\n      frame.setValueType(paths.haptics.actuators[this.gamepad.hand], this.gamepad.hapticActuators[0]);\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { applyArmModel } from \"../arm-model\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\nconst HAND_OFFSET = new THREE.Matrix4().makeTranslation(0, 0, -0.04);\n\nconst TOUCHPAD = paths.device.daydream.button(\"touchpad\");\nconst TOUCHPAD_X = paths.device.daydream.axis(\"touchpadX\");\nconst TOUCHPAD_Y = paths.device.daydream.axis(\"touchpadY\");\nconst POSE = paths.device.daydream.pose;\nconst MATRIX = paths.device.daydream.matrix;\n\nexport class DaydreamControllerDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n\n    this.rayObjectRotation = new THREE.Quaternion();\n    this.selector = `#player-${gamepad.hand || \"right\"}-controller`;\n    this.pose = new Pose();\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n    this.matrix = new THREE.Matrix4();\n    this.orientation = new THREE.Quaternion();\n  }\n\n  write(frame) {\n    this.gamepad = navigator.getGamepads()[0];\n    if (this.gamepad && this.gamepad.connected) {\n      const button = this.gamepad.buttons[0];\n      frame.setValueType(TOUCHPAD.pressed, !!button.pressed);\n      frame.setValueType(TOUCHPAD.touched, !!button.touched);\n      frame.setValueType(TOUCHPAD.value, !!button.value);\n\n      frame.setValueType(TOUCHPAD_X, this.gamepad.axes[0]);\n      frame.setValueType(TOUCHPAD_Y, this.gamepad.axes[1]);\n\n      // TODO ideally we should just be getting pose from the gamepad\n      if (!this.rayObject) {\n        this.rayObject = document.querySelector(this.selector).object3D;\n      }\n      this.rayObject.updateMatrixWorld();\n      this.rayObjectRotation.setFromRotationMatrix(this.rayObject.matrixWorld);\n      this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\n      this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n      this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n      frame.setPose(POSE, this.pose);\n\n      this.headObject3D = this.headObject3D || document.querySelector(\"#player-camera\").object3D;\n\n      if (this.gamepad.pose.orientation) {\n        frame.setMatrix4(\n          MATRIX,\n          this.matrix\n            .compose(\n              applyArmModel(this.gamepad.pose, this.gamepad.hand, this.headObject3D, 1.6),\n              this.orientation.fromArray(this.gamepad.pose.orientation),\n              ONES\n            )\n            .premultiply(this.sittingToStandingMatrix)\n            .multiply(HAND_OFFSET)\n        );\n      }\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\nconst HAND_OFFSET = new THREE.Matrix4().compose(\n  new THREE.Vector3(0, 0, 0.13),\n  new THREE.Quaternion().setFromEuler(new THREE.Euler(-40 * THREE.Math.DEG2RAD, 0, 0)),\n  new THREE.Vector3(1, 1, 1)\n);\nconst RAY_ROTATION = new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(1, 0, 0), -Math.PI / 12);\n\nexport class ViveControllerDevice {\n  constructor(gamepad) {\n    // wake the gamepad api up. otherwise it does not report touch controllers.\n    // in chrome it still won't unless you enter vr.\n    navigator.getVRDisplays();\n    this.gamepad = gamepad;\n\n    if (this.gamepad.id === \"HTC Vive Focus Plus Controller\") {\n      this.buttonMap = [\n        { name: \"touchpad\", buttonId: 0 },\n        { name: \"trigger\", buttonId: 1 },\n        { name: \"grip\", buttonId: 2 }\n      ];\n    } else {\n      this.buttonMap = [\n        { name: \"touchpad\", buttonId: 0 },\n        { name: \"trigger\", buttonId: 1 },\n        { name: \"grip\", buttonId: 2 },\n        { name: \"top\", buttonId: 3 }\n      ];\n    }\n    this.axisMap = [{ name: \"joyX\", axisId: 0 }, { name: \"joyY\", axisId: 1 }];\n\n    this.pose = new Pose();\n    this.rayObjectRotation = new THREE.Quaternion();\n    this.path = paths.device.vive[gamepad.hand || \"right\"];\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n\n    this.matrix = new THREE.Matrix4();\n    this.position = new THREE.Vector3();\n    this.orientation = new THREE.Quaternion();\n  }\n\n  write(frame) {\n    this.gamepad = navigator.getGamepads()[this.gamepad.index];\n    if (!this.gamepad.connected) return;\n\n    this.buttonMap.forEach(b => {\n      const path = this.path.button(b.name);\n      const button = this.gamepad.buttons[b.buttonId];\n      frame.setValueType(path.pressed, !!button.pressed);\n      frame.setValueType(path.touched, !!button.touched);\n      frame.setValueType(path.value, button.value);\n    });\n    this.axisMap.forEach(axis => {\n      frame.setValueType(this.path.axis(axis.name), this.gamepad.axes[axis.axisId]);\n    });\n\n    if (!this.selector) {\n      if (this.gamepad.hand) {\n        this.path = paths.device.vive[this.gamepad.hand];\n        this.selector = `#player-${this.gamepad.hand}-controller`;\n        console.warn(\"gamepad hand eventually specified\");\n      } else {\n        return;\n      }\n    }\n    const el = document.querySelector(this.selector);\n    const rayObject = el.object3D;\n    rayObject.updateMatrixWorld();\n    this.rayObjectRotation.setFromRotationMatrix(rayObject.matrixWorld);\n    this.pose.position.setFromMatrixPosition(rayObject.matrixWorld);\n    this.pose.direction\n      .set(0, 0, -1)\n      .applyQuaternion(RAY_ROTATION)\n      .applyQuaternion(this.rayObjectRotation);\n    this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n    frame.setPose(this.path.pose, this.pose);\n\n    if (this.gamepad.pose.position && this.gamepad.pose.orientation) {\n      frame.setMatrix4(\n        this.path.matrix,\n        this.matrix\n          .compose(\n            this.position.fromArray(this.gamepad.pose.position),\n            this.orientation.fromArray(this.gamepad.pose.orientation),\n            ONES\n          )\n          .premultiply(this.sittingToStandingMatrix)\n          .multiply(HAND_OFFSET)\n      );\n    }\n\n    if (this.gamepad.hapticActuators && this.gamepad.hapticActuators[0]) {\n      frame.setValueType(paths.haptics.actuators[this.gamepad.hand], this.gamepad.hapticActuators[0]);\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\nconst ONES = new THREE.Vector3(1, 1, 1);\nconst HAND_OFFSET = new THREE.Matrix4().compose(\n  new THREE.Vector3(0, -0.017, 0.13),\n  new THREE.Quaternion().setFromEuler(new THREE.Euler(-40 * THREE.Math.DEG2RAD, 0, 0)),\n  new THREE.Vector3(1, 1, 1)\n);\n\nexport class WindowsMixedRealityControllerDevice {\n  constructor(gamepad) {\n    this.rayObject = null;\n    this.rayObjectRotation = new THREE.Quaternion();\n\n    // wake the gamepad api up. otherwise it does not report touch controllers.\n    // in chrome it still won't unless you enter vr.\n    navigator.getVRDisplays();\n\n    this.gamepad = gamepad;\n    this.pose = new Pose();\n\n    if (gamepad.hand) {\n      this.selector = `#player-${gamepad.hand}-controller`;\n    }\n\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n    this.matrix = new THREE.Matrix4();\n    this.position = new THREE.Vector3();\n    this.orientation = new THREE.Quaternion();\n  }\n  write(frame) {\n    this.gamepad = navigator.getGamepads()[this.gamepad.index];\n    if (!this.gamepad.connected) return;\n\n    const path = paths.device.wmr[this.gamepad.hand || \"right\"];\n\n    frame.setValueType(path.touchpad.pressed, this.gamepad.buttons[0].pressed);\n    frame.setValueType(path.touchpad.touched, this.gamepad.buttons[0].touched);\n    frame.setValueType(path.touchpad.value, this.gamepad.buttons[0].value);\n\n    frame.setValueType(path.trigger.pressed, this.gamepad.buttons[1].pressed);\n    frame.setValueType(path.trigger.touched, this.gamepad.buttons[1].touched);\n    frame.setValueType(path.trigger.value, this.gamepad.buttons[1].value);\n\n    frame.setValueType(path.grip.pressed, this.gamepad.buttons[2].pressed);\n    frame.setValueType(path.grip.touched, this.gamepad.buttons[2].touched);\n    frame.setValueType(path.grip.value, this.gamepad.buttons[2].value);\n\n    frame.setValueType(path.menu.pressed, this.gamepad.buttons[3].pressed);\n    frame.setValueType(path.menu.touched, this.gamepad.buttons[3].touched);\n    frame.setValueType(path.menu.value, this.gamepad.buttons[3].value);\n\n    frame.setValueType(path.touchpad.axisX, this.gamepad.axes[0]);\n    frame.setValueType(path.touchpad.axisY, this.gamepad.axes[1]);\n    frame.setValueType(path.joystick.axisX, this.gamepad.axes[2]);\n    frame.setValueType(path.joystick.axisY, this.gamepad.axes[3]);\n\n    if (!this.selector) {\n      if (!this.gamepad.hand) return;\n      this.selector = `#player-${this.gamepad.hand}-controller`;\n    }\n\n    this.rayObject = this.rayObject || document.querySelector(this.selector).object3D;\n    this.rayObject.updateMatrixWorld();\n    this.rayObjectRotation.setFromRotationMatrix(this.rayObject.matrixWorld);\n\n    this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\n    this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n    this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n    frame.setPose(path.pose, this.pose);\n\n    if (this.gamepad.pose.position && this.gamepad.pose.orientation) {\n      frame.setMatrix4(\n        path.matrix,\n        this.matrix\n          .compose(\n            this.position.fromArray(this.gamepad.pose.position),\n            this.orientation.fromArray(this.gamepad.pose.orientation),\n            ONES\n          )\n          .premultiply(this.sittingToStandingMatrix)\n          .multiply(HAND_OFFSET)\n      );\n    }\n\n    if (this.gamepad.hapticActuators && this.gamepad.hapticActuators[0]) {\n      frame.setValueType(paths.haptics.actuators[this.gamepad.hand], this.gamepad.hapticActuators[0]);\n    }\n  }\n}\n","import { paths } from \"../paths\";\n\nconst TWOPI = Math.PI * 2;\n\nclass CircularBuffer {\n  constructor(length) {\n    this.items = new Array(length).fill(0);\n    this.writePtr = 0;\n  }\n\n  push(item) {\n    this.items[this.writePtr] = item;\n    this.writePtr = (this.writePtr + 1) % this.items.length;\n  }\n}\n\nconst abs = Math.abs;\n// Input: two numbers between [-Math.PI, Math.PI]\n// Output: difference between them, where -Math.PI === Math.PI\nconst difference = (curr, prev) => {\n  const a = curr - prev;\n  const b = curr + TWOPI - prev;\n  const c = curr - (prev + TWOPI);\n  if (abs(a) < abs(b)) {\n    if (abs(a) < abs(c)) {\n      return a;\n    }\n  }\n  if (abs(b) < abs(c)) {\n    return b;\n  }\n\n  return c;\n};\n\nconst average = a => {\n  let sum = 0;\n  for (let i = 0; i < a.length; i++) {\n    const n = a[i];\n    sum += n;\n  }\n  return sum / a.length;\n};\n\nexport class GyroDevice {\n  constructor() {\n    this.hmdEuler = new THREE.Euler();\n    this.hmdQuaternion = new THREE.Quaternion();\n    this.prevX = this.hmdEuler.x;\n    this.prevY = this.hmdEuler.y;\n    this.dXBuffer = new CircularBuffer(6);\n    this.dYBuffer = new CircularBuffer(6);\n    this.hasPolyfill = window.webvrpolyfill;\n    if (this.hasPolyfill) {\n      this.vrDisplay = window.webvrpolyfill.getPolyfillDisplays()[0];\n      this.frameData = new window.webvrpolyfill.constructor.VRFrameData();\n    }\n  }\n\n  write(frame) {\n    if (!this.hasPolyfill) {\n      return;\n    }\n    const hmdEuler = this.hmdEuler;\n    this.vrDisplay.getFrameData(this.frameData);\n    if (this.frameData.pose.orientation !== null) {\n      this.hmdQuaternion.fromArray(this.frameData.pose.orientation);\n      hmdEuler.setFromQuaternion(this.hmdQuaternion, \"YXZ\");\n    }\n\n    // Don't use gyro values when device is lying flat\n    if (hmdEuler.x < -Math.PI * 0.475) return;\n\n    const dX = THREE.Math.RAD2DEG * difference(hmdEuler.x, this.prevX);\n    const dY = THREE.Math.RAD2DEG * difference(hmdEuler.y, this.prevY);\n\n    this.dXBuffer.push(Math.abs(dX) < 0.001 ? 0 : dX);\n    this.dYBuffer.push(Math.abs(dY) < 0.001 ? 0 : dY);\n\n    this.averageDeltaX = average(this.dXBuffer.items);\n    this.averageDeltaY = average(this.dYBuffer.items);\n\n    this.prevX = hmdEuler.x;\n    this.prevY = hmdEuler.y;\n    frame.setValueType(paths.device.gyro.averageDeltaX, this.averageDeltaX);\n    frame.setValueType(paths.device.gyro.averageDeltaY, this.averageDeltaY);\n  }\n}\n","import { sets } from \"../sets\";\nimport { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\n\nconst calculateCursorPose = function(camera, coords, origin, direction, cursorPose) {\n  origin.setFromMatrixPosition(camera.matrixWorld);\n  direction\n    .set(coords[0], coords[1], 0.5)\n    .unproject(camera)\n    .sub(origin)\n    .normalize();\n  cursorPose.fromOriginAndDirection(origin, direction);\n  return cursorPose;\n};\n\nexport class AppAwareMouseDevice {\n  constructor() {\n    this.prevButtonLeft = false;\n    this.clickedOnAnything = false;\n    this.cursorPose = new Pose();\n    this.prevCursorPose = new Pose();\n    this.origin = new THREE.Vector3();\n    this.prevOrigin = new THREE.Vector3();\n    this.direction = new THREE.Vector3();\n    this.prevDirection = new THREE.Vector3();\n  }\n\n  write(frame) {\n    this.prevCursorPose.copy(this.cursorPose);\n    this.prevOrigin.copy(this.origin);\n    this.prevDirection.copy(this.prevDirection);\n\n    if (!this.cursorController) {\n      this.cursorController = document.querySelector(\"[cursor-controller]\").components[\"cursor-controller\"];\n    }\n\n    if (!this.camera) {\n      this.camera = document.querySelector(\"#player-camera\").components.camera.camera;\n    }\n\n    const buttonLeft = frame.get(paths.device.mouse.buttonLeft);\n    const buttonRight = frame.get(paths.device.mouse.buttonRight);\n    if (buttonLeft && !this.prevButtonLeft) {\n      const rawIntersections = [];\n      this.cursorController.raycaster.intersectObjects(\n        AFRAME.scenes[0].systems[\"hubs-systems\"].cursorTargettingSystem.targets,\n        true,\n        rawIntersections\n      );\n      const intersection = rawIntersections.find(x => x.object.el);\n      const userinput = AFRAME.scenes[0].systems.userinput;\n      this.clickedOnAnything =\n        (intersection &&\n          intersection.object.el.matches(\".pen, .pen *, .video, .video *, .interactable, .interactable *\")) ||\n        userinput.activeSets.includes(sets.cursorHoldingPen) ||\n        userinput.activeSets.includes(sets.cursorHoldingInteractable) ||\n        userinput.activeSets.includes(sets.cursorHoldingCamera);\n    }\n    this.prevButtonLeft = buttonLeft;\n\n    if (!buttonLeft) {\n      this.clickedOnAnything = false;\n    }\n\n    if ((!this.clickedOnAnything && buttonLeft) || buttonRight) {\n      const movementXY = frame.get(paths.device.mouse.movementXY);\n      if (movementXY) {\n        frame.setVector2(paths.device.smartMouse.cameraDelta, movementXY[0], movementXY[1]);\n      }\n    }\n\n    const coords = frame.get(paths.device.mouse.coords);\n    frame.setPose(\n      paths.device.smartMouse.cursorPose,\n      calculateCursorPose(this.camera, coords, this.origin, this.direction, this.cursorPose)\n    );\n  }\n}\n","export function touchIsAssigned(touch, assignments) {\n  return (\n    assignments.find(assignment => {\n      return assignment.touch.identifier === touch.identifier;\n    }) !== undefined\n  );\n}\n\nexport function jobIsAssigned(job, assignments) {\n  return (\n    assignments.find(assignment => {\n      return assignment.job === job;\n    }) !== undefined\n  );\n}\n\nexport function assign(touch, job, assignments) {\n  if (touchIsAssigned(touch, assignments) || jobIsAssigned(job, assignments)) {\n    console.error(\"cannot reassign touches or jobs. unassign first\");\n    return undefined;\n  }\n  const assignment = { job, touch };\n  assignments.push(assignment);\n  return assignment;\n}\n\nexport function unassign(touch, job, assignments) {\n  function match(assignment) {\n    return assignment.touch.identifier === touch.identifier && assignment.job === job;\n  }\n  assignments.splice(assignments.findIndex(match), 1);\n}\n\nexport function findByJob(job, assignments) {\n  return assignments.find(assignment => {\n    return assignment.job === job;\n  });\n}\n\nexport function findByTouch(touch, assignments) {\n  return assignments.find(assignment => {\n    return assignment.touch.identifier === touch.identifier;\n  });\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { touchIsAssigned, jobIsAssigned, assign, unassign, findByJob, findByTouch } from \"./touchscreen/assignments\";\n\nconst MOVE_CURSOR_JOB = \"MOVE CURSOR\";\nconst MOVE_CAMERA_JOB = \"MOVE CAMERA\";\nconst FIRST_PINCHER_JOB = \"FIRST PINCHER\";\nconst SECOND_PINCHER_JOB = \"SECOND PINCHER\";\n\nconst TAP_PATHS = [\n  paths.device.touchscreen.tap1,\n  paths.device.touchscreen.tap2,\n  paths.device.touchscreen.tap3,\n  paths.device.touchscreen.tap4,\n  paths.device.touchscreen.tap5\n];\n\nfunction distance(x1, y1, x2, y2) {\n  const dx = x1 - x2;\n  const dy = y1 - y2;\n  return Math.sqrt(dx * dx + dy * dy);\n}\n\nconst getPlayerCamera = (() => {\n  let playerCamera;\n\n  return function() {\n    if (!playerCamera) {\n      playerCamera = document.querySelector(\"#player-camera\").components.camera.camera;\n    }\n\n    return playerCamera;\n  };\n})();\n\nfunction shouldMoveCursor(touch, raycaster) {\n  const isCursorGrabbing = !!AFRAME.scenes[0].systems.interaction.state.rightRemote.held;\n  if (isCursorGrabbing) {\n    return true;\n  }\n  const rawIntersections = [];\n  raycaster.setFromCamera(\n    {\n      x: (touch.clientX / window.innerWidth) * 2 - 1,\n      y: -(touch.clientY / window.innerHeight) * 2 + 1\n    },\n    getPlayerCamera()\n  );\n  raycaster.intersectObjects(\n    AFRAME.scenes[0].systems[\"hubs-systems\"].cursorTargettingSystem.targets,\n    true,\n    rawIntersections\n  );\n  const intersection = rawIntersections.find(x => x.object.el);\n  return intersection && intersection.object.el.matches(\".interactable, .interactable *\");\n}\n\nexport class AppAwareTouchscreenDevice {\n  constructor() {\n    this.raycaster = new THREE.Raycaster(new THREE.Vector3(), new THREE.Vector3(), 0, 4);\n    this.assignments = [];\n    this.pinch = { initialDistance: 0, currentDistance: 0, delta: 0 };\n\n    // When touches appear, this timestamps and then watches for the high water mark of # of touches\n    this.pendingTap = { maxTouchCount: 0, startedAt: 0 };\n    this.tapIndexToWriteNextFrame = 0;\n\n    this.events = [];\n    [\"touchstart\", \"touchend\", \"touchmove\", \"touchcancel\"].map(x =>\n      document.querySelector(\"canvas\").addEventListener(x, this.events.push.bind(this.events))\n    );\n  }\n\n  end(touch) {\n    if (!touchIsAssigned(touch, this.assignments)) {\n      console.warn(\"touch does not have a job\", touch);\n    } else {\n      const assignment = findByTouch(touch, this.assignments);\n      switch (assignment.job) {\n        case MOVE_CURSOR_JOB:\n        case MOVE_CAMERA_JOB:\n          // If grab was being delayed, we should fire the initial grab and also delay the unassignment\n          // to ensure we write at least two frames with the grab down (since the action set will change)\n          // and otherwise we'd not see the falling xform.\n          if (assignment.framesUntilGrab >= 0) {\n            assignment.framesUntilUnassign = assignment.framesUntilGrab + 2;\n          } else {\n            unassign(assignment.touch, assignment.job, this.assignments);\n          }\n\n          break;\n        case FIRST_PINCHER_JOB:\n          unassign(assignment.touch, assignment.job, this.assignments);\n          this.pinch = { initialDistance: 0, currentDistance: 0, delta: 0 };\n\n          if (jobIsAssigned(SECOND_PINCHER_JOB, this.assignments)) {\n            const second = findByJob(SECOND_PINCHER_JOB, this.assignments);\n            unassign(second.touch, second.job, this.assignments);\n            if (jobIsAssigned(MOVE_CAMERA_JOB, this.assignments)) {\n              // reassign secondPincher to firstPincher\n              const first = assign(second.touch, FIRST_PINCHER_JOB, this.assignments);\n              first.clientX = second.clientX;\n              first.clientY = second.clientY;\n            } else {\n              // reassign secondPincher to moveCamera\n              const cameraMover = assign(second.touch, MOVE_CAMERA_JOB, this.assignments);\n              cameraMover.clientX = second.clientX;\n              cameraMover.clientY = second.clientY;\n              cameraMover.delta = [0, 0];\n            }\n          }\n          break;\n        case SECOND_PINCHER_JOB:\n          unassign(assignment.touch, assignment.job, this.assignments);\n          this.pinch = { initialDistance: 0, currentDistance: 0, delta: 0 };\n          if (jobIsAssigned(FIRST_PINCHER_JOB, this.assignments) && !jobIsAssigned(MOVE_CAMERA_JOB, this.assignments)) {\n            //reassign firstPincher to moveCamera\n            const first = findByJob(FIRST_PINCHER_JOB, this.assignments);\n            unassign(first.touch, first.job, this.assignments);\n            const cameraMover = assign(first.touch, MOVE_CAMERA_JOB, this.assignments);\n            cameraMover.clientX = first.clientX;\n            cameraMover.clientY = first.clientY;\n            cameraMover.delta = [0, 0];\n          }\n          break;\n      }\n    }\n\n    // Touches cleared, determine what to do with pending tap\n    if (this.assignments.length === 0) {\n      if (this.pendingTap.maxTouchCount > 0 && performance.now() - this.pendingTap.startedAt <= 125) {\n        this.tapIndexToWriteNextFrame = this.pendingTap.maxTouchCount;\n      }\n\n      this.pendingTap = { maxTouchCount: 0 };\n    }\n  }\n\n  move(touch) {\n    if (!touchIsAssigned(touch, this.assignments)) {\n      if (!touch.target.classList[0] || !touch.target.classList[0].startsWith(\"virtual-gamepad-controls\")) {\n        console.warn(\"touch does not have job\", touch);\n      }\n      return;\n    }\n\n    const assignment = findByTouch(touch, this.assignments);\n    switch (assignment.job) {\n      case MOVE_CURSOR_JOB:\n        assignment.cursorPose.fromCameraProjection(\n          getPlayerCamera(),\n          (touch.clientX / window.innerWidth) * 2 - 1,\n          -(touch.clientY / window.innerHeight) * 2 + 1\n        );\n        break;\n      case MOVE_CAMERA_JOB:\n        assignment.delta[0] += touch.clientX - assignment.clientX;\n        assignment.delta[1] += touch.clientY - assignment.clientY;\n        assignment.clientX = touch.clientX;\n        assignment.clientY = touch.clientY;\n        break;\n      case FIRST_PINCHER_JOB:\n      case SECOND_PINCHER_JOB:\n        assignment.clientX = touch.clientX;\n        assignment.clientY = touch.clientY;\n        if (jobIsAssigned(FIRST_PINCHER_JOB, this.assignments) && jobIsAssigned(SECOND_PINCHER_JOB, this.assignments)) {\n          const first = findByJob(FIRST_PINCHER_JOB, this.assignments);\n          const second = findByJob(SECOND_PINCHER_JOB, this.assignments);\n          const currentDistance = distance(first.clientX, first.clientY, second.clientX, second.clientY);\n          this.pinch.delta += currentDistance - this.pinch.currentDistance;\n          this.pinch.currentDistance = currentDistance;\n        }\n        break;\n    }\n  }\n\n  start(touch) {\n    if (touchIsAssigned(touch, this.assignments)) {\n      console.error(\"touch already has a job\");\n      return;\n    }\n\n    const isFirstTouch = this.assignments.length === 0;\n    const isSecondTouch = this.assignments.length === 1;\n    const isThirdTouch = this.assignments.length === 2;\n\n    const hasSecondPinch = !!findByJob(SECOND_PINCHER_JOB, this.assignments);\n\n    if (isFirstTouch || (isThirdTouch && hasSecondPinch)) {\n      let assignment;\n\n      // First touch or third touch and other two fingers were pinching\n      if (shouldMoveCursor(touch, this.raycaster)) {\n        assignment = assign(touch, MOVE_CURSOR_JOB, this.assignments);\n\n        // Grabbing objects is delayed by several frames:\n        // - We don't want the physics constraint to be applied too early, which results in crazy velocities\n        // - We don't want to mis-trigger grabs if the user is about to put down a second finger.\n        assignment.framesUntilGrab = 2;\n      } else {\n        assignment = assign(touch, MOVE_CAMERA_JOB, this.assignments);\n        assignment.delta = [0, 0];\n      }\n\n      assignment.clientX = touch.clientX;\n      assignment.clientY = touch.clientY;\n\n      // On touch down, we always move the cursor on the first frame, but the MOVE_CURSOR_JOB indicates\n      // the touch will then track the cursor (instead of the camera)\n      assignment.cursorPose = new Pose().fromCameraProjection(\n        getPlayerCamera(),\n        (touch.clientX / window.innerWidth) * 2 - 1,\n        -(touch.clientY / window.innerHeight) * 2 + 1\n      );\n    } else if (isSecondTouch || isThirdTouch) {\n      const cursorJob = findByJob(MOVE_CURSOR_JOB, this.assignments);\n\n      if (isSecondTouch && cursorJob && cursorJob.framesUntilGrab < 0) {\n        // The second touch is happening after grab activated, so assign this touch to first pinch.\n        const first = assign(touch, FIRST_PINCHER_JOB, this.assignments);\n        first.clientX = touch.clientX;\n        first.clientY = touch.clientY;\n      } else {\n        // Second or third touch, but third touch only if not pinching\n        if (isSecondTouch) {\n          // The second touch is happening before the grab activated, so re-assign the first\n          // to the first pinch, and effectively cancel the grab.\n          const previousAssignment = this.assignments[0];\n          unassign(previousAssignment.touch, previousAssignment.job, this.assignments);\n          const first = assign(previousAssignment.touch, FIRST_PINCHER_JOB, this.assignments);\n          first.clientX = previousAssignment.clientX;\n          first.clientY = previousAssignment.clientY;\n        }\n\n        const first = findByJob(FIRST_PINCHER_JOB, this.assignments);\n\n        if (!first) {\n          const first = assign(touch, FIRST_PINCHER_JOB, this.assignments);\n          first.clientX = touch.clientX;\n          first.clientY = touch.clientY;\n          return;\n        } else {\n          const second = assign(touch, SECOND_PINCHER_JOB, this.assignments);\n          second.clientX = touch.clientX;\n          second.clientY = touch.clientY;\n\n          const initialDistance = distance(first.clientX, first.clientY, second.clientX, second.clientY);\n\n          this.pinch = {\n            initialDistance,\n            currentDistance: initialDistance,\n            delta: 0\n          };\n        }\n      }\n    }\n\n    if (this.pendingTap.maxTouchCount === 0 && this.assignments.length > 0) {\n      this.pendingTap.startedAt = performance.now();\n    }\n\n    this.pendingTap.maxTouchCount = Math.max(this.pendingTap.maxTouchCount, this.assignments.length);\n  }\n\n  process(event) {\n    switch (event.type) {\n      case \"touchstart\":\n        for (const touch of event.changedTouches) {\n          this.start(touch);\n        }\n        break;\n      case \"touchmove\":\n        for (const touch of event.touches) {\n          this.move(touch);\n        }\n        break;\n      case \"touchend\":\n      case \"touchcancel\":\n        for (const touch of event.changedTouches) {\n          this.end(touch);\n        }\n        break;\n    }\n  }\n\n  write(frame) {\n    if (this.pinch) {\n      this.pinch.delta = 0;\n    }\n    const cameraMover =\n      jobIsAssigned(MOVE_CAMERA_JOB, this.assignments) && findByJob(MOVE_CAMERA_JOB, this.assignments);\n    if (cameraMover) {\n      cameraMover.delta[0] = 0;\n      cameraMover.delta[1] = 0;\n    }\n\n    this.events.forEach(event => {\n      this.process(event);\n    });\n    while (this.events.length) {\n      this.events.pop();\n    }\n\n    const path = paths.device.touchscreen;\n    const hasCursorJob = jobIsAssigned(MOVE_CURSOR_JOB, this.assignments);\n    const hasCameraJob = jobIsAssigned(MOVE_CAMERA_JOB, this.assignments);\n\n    if (hasCursorJob || hasCameraJob) {\n      frame.setValueType(path.isTouching, true);\n\n      const assignment = findByJob(MOVE_CURSOR_JOB, this.assignments) || findByJob(MOVE_CAMERA_JOB, this.assignments);\n      frame.setPose(path.cursorPose, assignment.cursorPose);\n    }\n\n    frame.setValueType(path.isTouchingGrabbable, false);\n\n    if (hasCursorJob) {\n      const assignment = findByJob(MOVE_CURSOR_JOB, this.assignments);\n      frame.setValueType(path.isTouchingGrabbable, assignment.framesUntilGrab <= 0);\n      assignment.framesUntilGrab--;\n\n      if (assignment.framesUntilUnassign >= 0) {\n        if (assignment.framesUntilUnassign === 0) {\n          unassign(assignment.touch, assignment.job, this.assignments);\n        }\n\n        assignment.framesUntilUnassign--;\n      }\n    }\n\n    if (hasCameraJob) {\n      const delta = findByJob(MOVE_CAMERA_JOB, this.assignments).delta;\n      frame.setVector2(path.touchCameraDelta, delta[0], delta[1]);\n    }\n\n    frame.setValueType(path.pinch.delta, this.pinch.delta);\n    frame.setValueType(path.pinch.initialDistance, this.pinch.initialDistance);\n    frame.setValueType(path.pinch.currentDistance, this.pinch.currentDistance);\n\n    if (this.tapIndexToWriteNextFrame && this.tapIndexToWriteNextFrame < TAP_PATHS.length) {\n      // write to tap-X path if we had an X-fingered tap\n      frame.setValueType(TAP_PATHS[this.tapIndexToWriteNextFrame - 1], true);\n    }\n\n    this.tapIndexToWriteNextFrame = 0;\n  }\n}\n","import { Pose } from \"../pose\";\nimport { angleTo4Direction } from \"../../../utils/dpad\";\n\nexport const xforms = {\n  noop: function() {},\n  copy: function(frame, src, dest) {\n    frame.setValueType(dest.value, frame.get(src.value));\n  },\n  scale: function(scalar) {\n    return function scale(frame, src, dest) {\n      if (frame.get(src.value) !== undefined) {\n        frame.setValueType(dest.value, frame.get(src.value) * scalar);\n      }\n    };\n  },\n  scaleExp: function(scalar, exp = 1) {\n    return function scale(frame, src, dest) {\n      if (frame.get(src.value) !== undefined) {\n        if (exp === 1) {\n          frame.setValueType(dest.value, frame.get(src.value) * scalar);\n        } else {\n          frame.setValueType(dest.value, Math.pow(frame.get(src.value), exp) * scalar);\n        }\n      }\n    };\n  },\n  deadzone: function(deadzoneSize) {\n    return function deadzone(frame, src, dest) {\n      frame.setValueType(dest.value, Math.abs(frame.get(src.value)) < deadzoneSize ? 0 : frame.get(src.value));\n    };\n  },\n  split_vec2: function(frame, src, dest) {\n    const value = frame.get(src.value);\n    if (value !== undefined) {\n      frame.setValueType(dest.x, value[0]);\n      frame.setValueType(dest.y, value[1]);\n    }\n  },\n  compose_vec2: function(frame, src, dest) {\n    const x = frame.get(src.x);\n    const y = frame.get(src.y);\n    if (x !== undefined && y !== undefined) {\n      frame.setVector2(dest.value, x, y);\n    }\n  },\n  negate: function(frame, src, dest) {\n    frame.setValueType(dest.value, -frame.get(src.value));\n  },\n  copyIfFalse: function(frame, src, dest) {\n    frame.setValueType(dest.value, frame.get(src.bool) ? undefined : frame.get(src.value));\n  },\n  copyIfTrue: function(frame, src, dest) {\n    frame.setValueType(dest.value, frame.get(src.bool) ? frame.get(src.value) : undefined);\n  },\n  zeroIfDefined: function(frame, src, dest) {\n    frame.setValueType(dest.value, frame.get(src.bool) !== undefined ? 0 : frame.get(src.value));\n  },\n  true: function(frame, src, dest) {\n    frame.setValueType(dest.value, true);\n  },\n  rising: function rising(frame, src, dest, prevState) {\n    frame.setValueType(dest.value, frame.get(src.value) && prevState === false);\n    return !!frame.get(src.value);\n  },\n  risingWithFrameDelay: function(n) {\n    return function risingWithFrameDelay(frame, src, dest, state = { values: new Array(n) }) {\n      frame.setValueType(dest.value, state.values.shift());\n      state.values.push(frame.get(src.value) && !state.prev);\n      state.prev = frame.get(src.value);\n      return state;\n    };\n  },\n  falling: function falling(frame, src, dest, prevState) {\n    frame.setValueType(dest.value, !frame.get(src.value) && prevState);\n    return !!frame.get(src.value);\n  },\n  vec2Zero: function(frame, _, dest) {\n    frame.setVector2(dest.value, 0, 0);\n  },\n  poseFromCameraProjection: function() {\n    let camera;\n    const pose = new Pose();\n    return function poseFromCameraProjection(frame, src, dest) {\n      if (!camera) {\n        camera = document.querySelector(\"#player-camera\").components.camera.camera;\n      }\n      const value = frame.get(src.value);\n      frame.setPose(dest.value, pose.fromCameraProjection(camera, value[0], value[1]));\n    };\n  },\n  vec2dpad: function(deadzoneRadius, invertX = false, invertY = false) {\n    const deadzoneRadiusSquared = deadzoneRadius * deadzoneRadius;\n\n    return function vec2dpad(frame, src, dest) {\n      if (!frame.get(src.value)) return;\n      const [x, y] = frame.get(src.value);\n      const inCenter = x * x + y * y < deadzoneRadiusSquared;\n      const direction = inCenter ? \"center\" : angleTo4Direction(Math.atan2(invertX ? -x : x, invertY ? -y : y));\n      if (!dest[direction]) return;\n      frame.setValueType(dest[direction], true);\n    };\n  },\n  always: function(constValue) {\n    return function always(frame, _, dest) {\n      frame.setValueType(dest.value, constValue);\n    };\n  },\n  wasd_to_vec2: function(frame, { w, a, s, d }, { vec2 }) {\n    let x = 0;\n    let y = 0;\n    if (frame.get(a)) x -= 1;\n    if (frame.get(d)) x += 1;\n    if (frame.get(w)) y += 1;\n    if (frame.get(s)) y -= 1;\n    frame.setVector2(vec2, x, y);\n  },\n  add_vec2: function(frame, src, dest) {\n    const first = frame.get(src.first);\n    const second = frame.get(src.second);\n    if (first && second) {\n      frame.setVector2(dest.value, first[0] + second[0], first[1] + second[1]);\n    } else if (second) {\n      frame.setVector2(dest.value, second[0], second[1]);\n    } else if (first) {\n      frame.setVector2(dest.value, first[0], first[1]);\n    }\n  },\n  max_vec2: function(frame, src, dest) {\n    const first = frame.get(src.first);\n    const second = frame.get(src.second);\n    if (first && second) {\n      const max =\n        first[0] * first[0] + first[1] * first[1] > second[0] * second[0] + second[1] * second[1] ? first : second;\n      frame.setVector2(dest.value, max[0], max[1]);\n    } else if (second) {\n      frame.setVector2(dest.value, second[0], second[1]);\n    } else if (first) {\n      frame.setVector2(dest.value, first[0], first[1]);\n    }\n  },\n  normalize_vec2: function(frame, src, dest) {\n    const vec2 = frame.get(src.value);\n    if (vec2) {\n      if (vec2[0] === 0 && vec2[0] === 0) {\n        frame.setVector2(dest.value, vec2[0], vec2[1]);\n      } else {\n        const l = Math.sqrt(vec2[0] * vec2[0] + vec2[1] * vec2[1]);\n        frame.setVector2(dest.value, vec2[0] / l, vec2[1] / l);\n      }\n    }\n  },\n  all: function(frame, src, dest) {\n    for (let i = 0, l = src.length; i < l; i++) {\n      const path = src[i];\n      if (!frame.get(path)) {\n        frame.setValueType(dest.value, false);\n        return;\n      }\n    }\n    frame.setValueType(dest.value, true);\n  },\n  any: function(frame, src, dest) {\n    for (let i = 0, l = src.length; i < l; i++) {\n      const path = src[i];\n      if (frame.get(path)) {\n        frame.setValueType(dest.value, true);\n        return;\n      }\n    }\n    frame.setValueType(dest.value, false);\n  },\n  touch_axis_scroll(scale = 1, snap_to) {\n    return function touch_axis_scroll(frame, src, dest, state = { value: 0, touching: false }) {\n      if (snap_to === undefined || Math.abs(frame.get(src.value) - state.value) >= snap_to) {\n        frame.setValueType(\n          dest.value,\n          state.touching && frame.get(src.touching) ? scale * (frame.get(src.value) - state.value) : 0\n        );\n      }\n\n      state.value = frame.get(src.value);\n      state.touching = frame.get(src.touching);\n\n      return state;\n    };\n  }\n};\n","export function angleTo4Direction(angle) {\n  angle = (angle * THREE.Math.RAD2DEG + 180 + 45) % 360;\n  if (angle > 0 && angle < 90) {\n    return \"north\";\n  } else if (angle >= 90 && angle < 180) {\n    return \"west\";\n  } else if (angle >= 180 && angle < 270) {\n    return \"south\";\n  } else {\n    return \"east\";\n  }\n}\n\nexport function angleTo8Direction(angle) {\n  angle = (angle * THREE.Math.RAD2DEG + 180 + 45) % 360;\n  let direction = \"\";\n  if ((angle >= 0 && angle < 120) || angle >= 330) {\n    direction += \"north\";\n  }\n  if (angle >= 150 && angle < 300) {\n    direction += \"south\";\n  }\n  if (angle >= 60 && angle < 210) {\n    direction += \"west\";\n  }\n  if ((angle >= 240 && angle < 360) || angle < 30) {\n    direction += \"east\";\n  }\n  return direction;\n}\n","export const addSetsToBindings = mapping => {\n  for (const setName in mapping) {\n    for (const binding of mapping[setName]) {\n      if (!binding.sets) {\n        binding.sets = [];\n      }\n      binding.sets.push(setName);\n    }\n  }\n  return mapping;\n};\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\n// import { Pose } from \"../pose\";\n\nconst wasd_vec2 = \"/var/mouse-and-keyboard/wasd_vec2\";\nconst keyboardCharacterAcceleration = \"/var/mouse-and-keyboard/keyboardCharacterAcceleration\";\nconst arrows_vec2 = \"/var/mouse-and-keyboard/arrows_vec2\";\nconst togglePenWithRMB = \"/vars/mouse-and-keyboard/drop_pen_with_RMB\";\nconst togglePenWithEsc = \"/vars/mouse-and-keyboard/drop_pen_with_esc\";\nconst togglePenWithP = \"/vars/mouse-and-keyboard/drop_pen_with_p\";\nconst togglePenWithHud = \"/vars/mouse-and-keyboard/drop_pen_with_hud\";\nconst togglePen = \"/vars/mouse-and-keyboard/togglePen\";\n\nconst k = name => {\n  return `/keyboard-mouse-user/keyboard-var/${name}`;\n};\n\nexport const keyboardMouseUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {\n        w: paths.device.keyboard.key(\"arrowup\"),\n        a: paths.device.keyboard.key(\"arrowleft\"),\n        s: paths.device.keyboard.key(\"arrowdown\"),\n        d: paths.device.keyboard.key(\"arrowright\")\n      },\n      dest: { vec2: arrows_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"w\"),\n        a: paths.device.keyboard.key(\"a\"),\n        s: paths.device.keyboard.key(\"s\"),\n        d: paths.device.keyboard.key(\"d\")\n      },\n      dest: { vec2: wasd_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        first: wasd_vec2,\n        second: arrows_vec2\n      },\n      dest: { value: keyboardCharacterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: { value: keyboardCharacterAcceleration },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.normalize_vec2\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"shift\") },\n      dest: { value: paths.actions.boost },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: paths.actions.camera.exitMirror },\n      xform: xforms.falling\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"q\") },\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"e\") },\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Tab\") },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: paths.actions.thaw },\n      xform: xforms.falling\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"p\") },\n      dest: { value: togglePenWithP },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.hud.penButton },\n      dest: { value: togglePenWithHud },\n      xform: xforms.rising\n    },\n    {\n      src: [togglePenWithHud, togglePenWithP],\n      dest: { value: togglePen },\n      xform: xforms.any\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.spawnPen },\n      xform: xforms.rising,\n      priority: 100\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"c\") },\n      dest: { value: paths.actions.toggleCamera },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"x\") },\n      dest: { value: paths.actions.takeSnapshot },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.smartMouse.cursorPose },\n      dest: { value: paths.actions.cursor.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.smartMouse.cameraDelta },\n      dest: { x: \"/var/smartMouseCamDeltaX\", y: \"/var/smartMouseCamDeltaY\" },\n      xform: xforms.split_vec2\n    },\n    {\n      src: { value: \"/var/smartMouseCamDeltaX\" },\n      dest: { value: \"/var/smartMouseCamDeltaXScaled\" },\n      xform: xforms.scale(-0.2)\n    },\n    {\n      src: { value: \"/var/smartMouseCamDeltaY\" },\n      dest: { value: \"/var/smartMouseCamDeltaYScaled\" },\n      xform: xforms.scale(-0.1)\n    },\n    {\n      src: { x: \"/var/smartMouseCamDeltaXScaled\", y: \"/var/smartMouseCamDeltaYScaled\" },\n      dest: { value: paths.actions.cameraDelta },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"m\")\n      },\n      dest: {\n        value: paths.actions.muteMic\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"t\")\n      },\n      dest: {\n        value: paths.actions.focusChat\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"/\")\n      },\n      dest: {\n        value: paths.actions.focusChatCommand\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: paths.actions.mediaExit },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"1\")\n      },\n      dest: { value: \"/var/shift+1\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+1\" },\n      dest: { value: paths.actions.mediaSearch1 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"2\")\n      },\n      dest: { value: \"/var/shift+2\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+2\" },\n      dest: { value: paths.actions.mediaSearch2 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"3\")\n      },\n      dest: { value: \"/var/shift+3\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+3\" },\n      dest: { value: paths.actions.mediaSearch3 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"4\")\n      },\n      dest: { value: \"/var/shift+4\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+4\" },\n      dest: { value: paths.actions.mediaSearch4 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"5\")\n      },\n      dest: { value: \"/var/shift+5\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+5\" },\n      dest: { value: paths.actions.mediaSearch5 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"6\")\n      },\n      dest: { value: \"/var/shift+6\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+6\" },\n      dest: { value: paths.actions.mediaSearch6 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"7\")\n      },\n      dest: { value: \"/var/shift+7\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+7\" },\n      dest: { value: paths.actions.mediaSearch7 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"8\")\n      },\n      dest: { value: \"/var/shift+8\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+8\" },\n      dest: { value: paths.actions.mediaSearch8 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"l\")\n      },\n      dest: {\n        value: paths.actions.logDebugFrame\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"k\")\n      },\n      dest: {\n        value: paths.actions.logInteractionState\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.mouse.buttonRight\n      },\n      dest: {\n        value: paths.actions.startGazeTeleport\n      },\n      xform: xforms.rising,\n      priority: 100\n    },\n    {\n      src: {\n        value: paths.device.mouse.buttonRight\n      },\n      dest: {\n        value: paths.actions.stopGazeTeleport\n      },\n      xform: xforms.falling,\n      priority: 100\n    }\n\n    // Helpful bindings for debugging hands in 2D\n    // {\n    //   src: {},\n    //   dest: { value: paths.actions.rightHand.matrix },\n    //   xform: xforms.always(\n    //     new THREE.Matrix4().compose(\n    //       new THREE.Vector3(0.2, 1.3, -0.8),\n    //       new THREE.Quaternion(0, 0, 0, 0),\n    //       new THREE.Vector3(1, 1, 1)\n    //     )\n    //   )\n    // },\n    // {\n    //   src: {},\n    //   dest: { value: paths.actions.leftHand.matrix },\n    //   xform: xforms.always(\n    //     new THREE.Matrix4().compose(\n    //       new THREE.Vector3(-0.2, 1.4, -0.8),\n    //       new THREE.Quaternion(0, 0, 0, 0),\n    //       new THREE.Vector3(1, 1, 1)\n    //     )\n    //   )\n    // }\n  ],\n\n  [sets.cursorHoldingPen]: [\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.keyboard.key(\"q\")\n      },\n      dest: { value: \"/var/shift+q\" },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+q\" },\n      dest: { value: paths.actions.cursor.penPrevColor },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.keyboard.key(\"e\")\n      },\n      dest: { value: \"/var/shift+e\" },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+e\" },\n      dest: { value: paths.actions.cursor.penNextColor },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.keyboard.key(\"q\")\n      },\n      dest: { value: \"/var/notshift+q\" },\n      xform: xforms.copyIfFalse\n    },\n    {\n      src: { value: \"/var/notshift+q\" },\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.keyboard.key(\"e\")\n      },\n      dest: { value: \"/var/notshift+e\" },\n      xform: xforms.copyIfFalse\n    },\n    {\n      src: { value: \"/var/notshift+e\" },\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        value: k(\"wheelWithShift\")\n      },\n      dest: { value: \"/var/cursorScalePenTipWheel\" },\n      xform: xforms.copy,\n      priority: 200\n    },\n    {\n      src: { value: \"/var/cursorScalePenTipWheel\" },\n      dest: { value: paths.actions.cursor.scalePenTip },\n      xform: xforms.scale(0.03)\n    },\n    {\n      src: { value: paths.device.mouse.buttonRight },\n      dest: { value: togglePenWithRMB },\n      xform: xforms.falling,\n      priority: 200\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: togglePenWithEsc },\n      xform: xforms.rising\n    },\n    {\n      src: [togglePenWithRMB, togglePenWithEsc, togglePenWithP, togglePenWithHud],\n      dest: { value: togglePen },\n      xform: xforms.any\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"z\")\n      },\n      dest: { value: paths.actions.cursor.undoDrawing },\n      priority: 1001,\n      xform: xforms.rising\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.pen.remove },\n      xform: xforms.rising,\n      priority: 200\n    }\n  ],\n\n  [sets.cursorHoldingCamera]: [\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.falling,\n      priority: 2\n    }\n  ],\n\n  [sets.cursorHoldingInteractable]: [\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.mouse.wheel\n      },\n      dest: {\n        value: k(\"wheelWithShift\")\n      },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.mouse.wheel\n      },\n      dest: {\n        value: k(\"wheelWithoutShift\")\n      },\n      xform: xforms.copyIfFalse\n    },\n    {\n      src: {\n        value: k(\"wheelWithoutShift\")\n      },\n      dest: { value: paths.actions.cursor.modDelta },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: k(\"wheelWithShift\")\n      },\n      dest: { value: paths.actions.cursor.scaleGrabbedGrabbable },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.falling,\n      priority: 2\n    }\n  ],\n  [sets.cursorHoldingUI]: [\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"shift\") },\n      dest: { value: paths.actions.transformModifier },\n      xform: xforms.copy\n    }\n  ],\n  [sets.cursorHoveringOnInteractable]: [\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n  [sets.cursorHoveringOnVideo]: [\n    {\n      src: { value: paths.device.mouse.wheel },\n      dest: { value: paths.actions.cursor.mediaVolumeMod },\n      xform: xforms.scale(-0.3)\n    }\n  ],\n  [sets.inputFocused]: [\n    {\n      src: { value: \"/device/keyboard\" },\n      dest: { value: paths.noop },\n      xform: xforms.noop,\n      priority: 1000\n    }\n  ],\n\n  [sets.cursorHoveringOnUI]: [\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.rising\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst zero = \"/vars/touchscreen/zero\";\nconst forward = \"/vars/touchscreen/pinchDeltaForward\";\nconst touchCamDelta = \"vars/touchscreen/touchCameraDelta\";\nconst touchCamDeltaX = \"vars/touchscreen/touchCameraDelta/x\";\nconst touchCamDeltaY = \"vars/touchscreen/touchCameraDelta/y\";\nconst touchCamDeltaXScaled = \"vars/touchscreen/touchCameraDelta/x/scaled\";\nconst touchCamDeltaYScaled = \"vars/touchscreen/touchCameraDelta/y/scaled\";\nconst gyroCamDelta = \"vars/gyro/gyroCameraDelta\";\nconst gyroCamDeltaXScaled = \"vars/gyro/gyroCameraDelta/x/scaled\";\nconst gyroCamDeltaYScaled = \"vars/gyro/gyroCameraDelta/y/scaled\";\nconst togglePen = \"/vars/touchscreen/togglePen\";\n\nexport const touchscreenUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: { value: paths.device.touchscreen.pinch.delta },\n      dest: { value: forward },\n      xform: xforms.scale(0.25)\n    },\n    {\n      src: { value: paths.device.touchscreen.tap2 },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.copy\n    },\n    {\n      src: {},\n      dest: { value: zero },\n      xform: xforms.always(0)\n    },\n    {\n      src: { x: zero, y: forward },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: paths.device.touchscreen.cursorPose },\n      dest: { value: paths.actions.cursor.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.touchscreen.touchCameraDelta },\n      dest: { x: touchCamDeltaX, y: touchCamDeltaY },\n      xform: xforms.split_vec2\n    },\n    {\n      src: { value: touchCamDeltaX },\n      dest: { value: touchCamDeltaXScaled },\n      xform: xforms.scale(0.18)\n    },\n    {\n      src: { value: touchCamDeltaY },\n      dest: { value: touchCamDeltaYScaled },\n      xform: xforms.scale(0.35)\n    },\n    {\n      src: { x: touchCamDeltaXScaled, y: touchCamDeltaYScaled },\n      dest: { value: touchCamDelta },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: paths.device.gyro.averageDeltaX },\n      dest: { value: gyroCamDeltaXScaled },\n      xform: xforms.scale(1.0)\n    },\n    {\n      src: { value: paths.device.gyro.averageDeltaY },\n      dest: { value: gyroCamDeltaYScaled },\n      xform: xforms.scale(1.0)\n    },\n    {\n      src: { x: gyroCamDeltaYScaled, y: gyroCamDeltaXScaled },\n      dest: { value: gyroCamDelta },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        first: touchCamDelta,\n        second: gyroCamDelta\n      },\n      dest: { value: paths.actions.cameraDelta },\n      xform: xforms.add_vec2\n    },\n    {\n      src: { value: paths.device.touchscreen.isTouchingGrabbable },\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.hud.penButton },\n      dest: { value: togglePen },\n      xform: xforms.rising\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.spawnPen },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n  [sets.cursorHoldingInteractable]: [\n    {\n      src: { value: paths.device.touchscreen.isTouchingGrabbable },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.falling,\n      priority: 1\n    }\n  ],\n\n  [sets.cursorHoveringOnPen]: [],\n  [sets.cursorHoldingPen]: [\n    {\n      src: { value: paths.device.touchscreen.isTouchingGrabbable },\n      dest: { value: paths.actions.cursor.startDrawing },\n      xform: xforms.risingWithFrameDelay(5),\n      priority: 2\n    },\n    {\n      src: { value: paths.device.touchscreen.isTouchingGrabbable },\n      dest: { value: paths.actions.cursor.stopDrawing },\n      xform: xforms.falling,\n      priority: 2\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.pen.remove },\n      xform: xforms.rising,\n      priority: 3\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nexport const keyboardDebuggingBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {\n        value: paths.device.keyboard.key(\"l\")\n      },\n      dest: {\n        value: paths.actions.logDebugFrame\n      },\n      xform: xforms.rising\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst name = \"/touch/var/\";\n\nconst leftButton = paths.device.leftOculusTouch.button;\nconst leftAxis = paths.device.leftOculusTouch.axis;\nconst leftPose = paths.device.leftOculusTouch.pose;\nconst rightButton = paths.device.rightOculusTouch.button;\nconst rightAxis = paths.device.rightOculusTouch.axis;\nconst rightPose = paths.device.rightOculusTouch.pose;\n\nconst leftJoyXDeadzoned = `${name}left/joy/x/deadzoned`;\nconst leftJoyYDeadzoned = `${name}left/joy/y/deadzoned`;\nconst scaledLeftJoyX = `${name}left/scaledJoyX`;\nconst scaledLeftJoyY = `${name}left/scaledJoyY`;\nconst cursorDrop2 = `${name}right/cursorDrop2`;\nconst cursorDrop1 = `${name}right/cursorDrop1`;\nconst rightHandDrop2 = `${name}right/rightHandDrop2`;\nconst rightGripRisingGrab = `${name}right/grip/RisingGrab`;\nconst rightTriggerRisingGrab = `${name}right/trigger/RisingGrab`;\nconst leftGripRisingGrab = `${name}left/grip/RisingGrab`;\nconst leftTriggerRisingGrab = `${name}left/trigger/RisingGrab`;\nconst rightDpadNorth = `${name}rightDpad/north`;\nconst rightDpadSouth = `${name}rightDpad/south`;\nconst rightDpadEast = `${name}rightDpad/east`;\nconst rightDpadWest = `${name}rightDpad/west`;\nconst rightDpadCenter = `${name}rightDpad/center`;\nconst rightJoy = `${name}right/joy`;\nconst rightJoyY1 = `${name}right/joyY1`;\nconst rightJoyY2 = `${name}right/joyY2`;\nconst rightJoyYDeadzoned = `${name}left/joy/y/deadzoned`;\nconst leftDpadNorth = `${name}leftDpad/north`;\nconst leftDpadSouth = `${name}leftDpad/south`;\nconst leftDpadEast = `${name}leftDpad/east`;\nconst leftDpadWest = `${name}leftDpad/west`;\nconst leftDpadCenter = `${name}leftDpad/center`;\nconst leftJoy = `${name}left/joy`;\nconst oculusTouchCharacterAcceleration = `${name}characterAcceleration`;\nconst keyboardCharacterAcceleration = \"/var/keyboard/characterAcceleration\";\nconst characterAcceleration = \"/var/oculus-touch/nonNormalizedCharacterAcceleration\";\nconst wasd_vec2 = \"/var/keyboard/wasd_vec2\";\nconst arrows_vec2 = \"/var/keyboard/arrows_vec2\";\nconst keyboardBoost = \"/var/keyboard-oculus/boost\";\nconst rightBoost = \"/var/right-oculus/boost\";\nconst leftBoost = \"/var/left-oculus/boost\";\nconst rightTouchSnapRight = `${name}/right/snap-right`;\nconst rightTouchSnapLeft = `${name}/right/snap-left`;\nconst keyboardSnapRight = `${name}/keyboard/snap-right`;\nconst keyboardSnapLeft = `${name}/keyboard/snap-left`;\n\nconst lowerButtons = `${name}buttons/lower`;\n\nconst ensureFrozenViaButtons = `${name}buttons/ensureFrozen`;\nconst ensureFrozenViaKeyboard = `${name}keyboard/ensureFrozen`;\n\nconst thawViaButtons = `${name}buttons/thaw`;\nconst thawViaKeyboard = `${name}keyboard/thaw`;\n\nconst v = s => {\n  return \"/oculus-touch-user-vars/\" + s;\n};\nconst leftGripPressed1 = v(\"leftGripPressed1\");\nconst leftGripPressed2 = v(\"leftGripPressed2\");\nconst rightGripPressed1 = v(\"rightGripPressed1\");\nconst rightGripPressed2 = v(\"rightGripPressed2\");\nconst leftTriggerPressed1 = v(\"leftTriggerPressed1\");\nconst leftTriggerPressed2 = v(\"leftTriggerPressed2\");\nconst rightTriggerPressed1 = v(\"rightTriggerPressed1\");\nconst rightTriggerPressed2 = v(\"rightTriggerPressed2\");\n\nexport const oculusTouchUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {\n        value: paths.device.leftOculusTouch.matrix\n      },\n      dest: {\n        value: paths.actions.leftHand.matrix\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: paths.device.rightOculusTouch.matrix\n      },\n      dest: {\n        value: paths.actions.rightHand.matrix\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [ensureFrozenViaButtons, ensureFrozenViaKeyboard],\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.any\n    },\n    {\n      src: [thawViaButtons, thawViaKeyboard],\n      dest: { value: paths.actions.thaw },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: leftButton(\"grip\").pressed\n      },\n      dest: {\n        value: leftGripPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: leftButton(\"grip\").pressed\n      },\n      dest: {\n        value: leftGripPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: leftGripPressed1\n      },\n      dest: {\n        value: paths.actions.leftHand.middleRingPinky\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [leftButton(\"x\").touched, leftButton(\"y\").touched, leftButton(\"thumbStick\").touched],\n      dest: {\n        value: paths.actions.leftHand.thumb\n      },\n      xform: xforms.any\n    },\n    {\n      src: { value: leftButton(\"trigger\").pressed },\n      dest: {\n        value: leftTriggerPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftButton(\"trigger\").pressed },\n      dest: {\n        value: leftTriggerPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftTriggerPressed1 },\n      dest: {\n        value: paths.actions.leftHand.index\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightButton(\"grip\").pressed\n      },\n      dest: {\n        value: rightGripPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightButton(\"grip\").pressed\n      },\n      dest: {\n        value: rightGripPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightGripPressed1\n      },\n      dest: {\n        value: paths.actions.rightHand.middleRingPinky\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [rightButton(\"a\").touched, rightButton(\"b\").touched, rightButton(\"thumbStick\").touched],\n      dest: {\n        value: paths.actions.rightHand.thumb\n      },\n      xform: xforms.any\n    },\n    {\n      src: { value: rightButton(\"trigger\").pressed },\n      dest: {\n        value: rightTriggerPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightButton(\"trigger\").pressed },\n      dest: {\n        value: rightTriggerPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightTriggerPressed1 },\n      dest: {\n        value: paths.actions.rightHand.index\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: leftAxis(\"joyX\"),\n        y: leftAxis(\"joyY\")\n      },\n      dest: {\n        value: leftJoy\n      },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: leftJoy\n      },\n      dest: {\n        north: leftDpadNorth,\n        south: leftDpadSouth,\n        east: leftDpadEast,\n        west: leftDpadWest,\n        center: leftDpadCenter\n      },\n      xform: xforms.vec2dpad(0.2, false, true)\n    },\n    {\n      src: {\n        value: rightAxis(\"joyY\")\n      },\n      dest: { value: rightJoyY1 },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightAxis(\"joyY\")\n      },\n      dest: { value: rightJoyY2 },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: rightAxis(\"joyX\"),\n        y: rightJoyY1\n      },\n      dest: {\n        value: rightJoy\n      },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: rightJoy\n      },\n      dest: {\n        north: rightDpadNorth,\n        south: rightDpadSouth,\n        east: rightDpadEast,\n        west: rightDpadWest,\n        center: rightDpadCenter\n      },\n      xform: xforms.vec2dpad(0.2, false, true)\n    },\n    {\n      src: {\n        value: rightDpadEast\n      },\n      dest: {\n        value: rightTouchSnapRight\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"e\") },\n      dest: { value: keyboardSnapRight },\n      xform: xforms.rising\n    },\n    {\n      src: [rightTouchSnapRight, keyboardSnapRight],\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.any\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Tab\") },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: ensureFrozenViaKeyboard },\n      xform: xforms.copy\n    },\n    {\n      src: [leftButton(\"x\").pressed, rightButton(\"a\").pressed],\n      dest: { value: lowerButtons },\n      xform: xforms.any\n    },\n    {\n      src: { value: lowerButtons },\n      dest: { value: ensureFrozenViaButtons },\n      xform: xforms.copy\n    },\n    {\n      src: { value: lowerButtons },\n      dest: { value: thawViaButtons },\n      xform: xforms.falling\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: thawViaKeyboard },\n      xform: xforms.falling\n    },\n    {\n      src: {\n        value: rightDpadWest\n      },\n      dest: {\n        value: rightTouchSnapLeft\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"q\") },\n      dest: { value: keyboardSnapLeft },\n      xform: xforms.rising\n    },\n    {\n      src: [rightTouchSnapLeft, keyboardSnapLeft],\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: leftAxis(\"joyY\")\n      },\n      dest: {\n        value: leftJoyYDeadzoned\n      },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: {\n        value: leftJoyYDeadzoned\n      },\n      dest: {\n        value: scaledLeftJoyY\n      },\n      xform: xforms.scale(-1.5) // horizontal character speed modifier\n    },\n    {\n      src: {\n        value: leftAxis(\"joyX\")\n      },\n      dest: {\n        value: leftJoyXDeadzoned\n      },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: {\n        value: leftJoyXDeadzoned\n      },\n      dest: {\n        value: scaledLeftJoyX\n      },\n      xform: xforms.scale(1.5) // horizontal character speed modifier\n    },\n    {\n      src: {\n        x: scaledLeftJoyX,\n        y: scaledLeftJoyY\n      },\n      dest: { value: oculusTouchCharacterAcceleration },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"arrowup\"),\n        a: paths.device.keyboard.key(\"arrowleft\"),\n        s: paths.device.keyboard.key(\"arrowdown\"),\n        d: paths.device.keyboard.key(\"arrowright\")\n      },\n      dest: { vec2: arrows_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"w\"),\n        a: paths.device.keyboard.key(\"a\"),\n        s: paths.device.keyboard.key(\"s\"),\n        d: paths.device.keyboard.key(\"d\")\n      },\n      dest: { vec2: wasd_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        first: wasd_vec2,\n        second: arrows_vec2\n      },\n      dest: { value: keyboardCharacterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: {\n        first: oculusTouchCharacterAcceleration,\n        second: keyboardCharacterAcceleration\n      },\n      dest: {\n        value: characterAcceleration\n      },\n      xform: xforms.max_vec2\n    },\n    {\n      src: {\n        value: characterAcceleration,\n        override: \"/device/overrides/foo\"\n      },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"shift\") },\n      dest: { value: keyboardBoost },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: leftButton(\"y\").pressed\n      },\n      dest: {\n        value: leftBoost\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightButton(\"b\").pressed\n      },\n      dest: {\n        value: rightBoost\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [keyboardBoost, leftBoost, rightBoost],\n      dest: { value: paths.actions.boost },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"t\")\n      },\n      dest: {\n        value: paths.actions.focusChat\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"/\")\n      },\n      dest: {\n        value: paths.actions.focusChatCommand\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: paths.actions.mediaExit },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"p\") },\n      dest: { value: paths.actions.spawnPen },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"c\") },\n      dest: { value: paths.actions.toggleCamera },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"x\") },\n      dest: { value: paths.actions.takeSnapshot },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"1\")\n      },\n      dest: { value: \"/var/shift+1\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+1\" },\n      dest: { value: paths.actions.mediaSearch1 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"2\")\n      },\n      dest: { value: \"/var/shift+2\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+2\" },\n      dest: { value: paths.actions.mediaSearch2 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"3\")\n      },\n      dest: { value: \"/var/shift+3\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+3\" },\n      dest: { value: paths.actions.mediaSearch3 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"4\")\n      },\n      dest: { value: \"/var/shift+4\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+4\" },\n      dest: { value: paths.actions.mediaSearch4 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"5\")\n      },\n      dest: { value: \"/var/shift+5\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+5\" },\n      dest: { value: paths.actions.mediaSearch5 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"6\")\n      },\n      dest: { value: \"/var/shift+6\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+6\" },\n      dest: { value: paths.actions.mediaSearch6 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"7\")\n      },\n      dest: { value: \"/var/shift+7\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+7\" },\n      dest: { value: paths.actions.mediaSearch7 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"8\")\n      },\n      dest: { value: \"/var/shift+8\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+8\" },\n      dest: { value: paths.actions.mediaSearch8 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"l\")\n      },\n      dest: {\n        value: paths.actions.logDebugFrame\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"k\")\n      },\n      dest: {\n        value: paths.actions.logInteractionState\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"m\")\n      },\n      dest: {\n        value: paths.actions.muteMic\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rightPose },\n      dest: { value: paths.actions.cursor.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightPose },\n      dest: { value: paths.actions.rightHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftPose },\n      dest: { value: paths.actions.leftHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    }\n  ],\n\n  [sets.leftHandHoveringOnNothing]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startTeleport },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.cursorHoveringOnUI]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.cursorHoveringOnVideo]: [\n    {\n      src: { value: rightAxis(\"joyY\") },\n      dest: { value: paths.actions.cursor.mediaVolumeMod },\n      xform: xforms.scale(-0.01)\n    }\n  ],\n\n  [sets.cursorHoveringOnNothing]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.leftHandHoveringOnInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: leftGripRisingGrab },\n      xform: xforms.rising\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: leftTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [leftGripRisingGrab],\n      dest: { value: paths.actions.leftHand.grab },\n      xform: xforms.any,\n      priority: 2\n    }\n  ],\n\n  [sets.leftHandHoldingInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.falling\n    },\n    {\n      src: {},\n      dest: { value: ensureFrozenViaButtons },\n      priority: 1,\n      xform: xforms.always(false)\n    }\n  ],\n\n  [sets.leftHandHoveringOnPen]: [],\n  [sets.leftHandHoldingPen]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        value: leftDpadEast,\n        override: \"/device/overrides/foo\"\n      },\n      dest: {\n        value: paths.actions.leftHand.penNextColor\n      },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: {\n        value: leftDpadWest,\n        override: \"/device/overrides/foo\"\n      },\n      dest: {\n        value: paths.actions.leftHand.penPrevColor\n      },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: leftJoyYDeadzoned },\n      dest: { value: paths.actions.leftHand.scalePenTip },\n      xform: xforms.scaleExp(-0.005, 5),\n      priority: 1\n    },\n    {\n      src: { value: leftButton(\"y\").pressed },\n      dest: { value: paths.actions.leftHand.undoDrawing },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.cursorHoveringOnInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rightGripRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: rightTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [rightGripRisingGrab],\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.any,\n      priority: 2\n    }\n  ],\n\n  [sets.cursorHoldingUI]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: cursorDrop2 },\n      xform: xforms.falling,\n      priority: 5\n    }\n  ],\n\n  [sets.cursorHoldingInteractable]: [\n    {\n      src: { value: rightAxis(\"joyY\") },\n      dest: { value: paths.actions.cursor.modDelta },\n      xform: xforms.scale(0.1)\n    },\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: cursorDrop1 },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: [cursorDrop1, cursorDrop2],\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.any,\n      priority: 2\n    },\n    {\n      src: {},\n      dest: { value: ensureFrozenViaButtons },\n      priority: 1,\n      xform: xforms.always(false)\n    }\n  ],\n\n  [sets.cursorHoveringOnPen]: [],\n\n  [sets.cursorHoldingPen]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: rightButton(\"b\").pressed },\n      dest: { value: paths.actions.cursor.undoDrawing },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.rightHandHoveringOnInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rightGripRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: rightTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [rightGripRisingGrab],\n      dest: { value: paths.actions.rightHand.grab },\n      xform: xforms.any,\n      priority: 2\n    }\n  ],\n\n  [sets.rightHandHoldingInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: {\n        value: rightHandDrop2\n      },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: [rightHandDrop2],\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.any,\n      priority: 2\n    },\n    {\n      src: {},\n      dest: { value: ensureFrozenViaButtons },\n      priority: 1,\n      xform: xforms.always(false)\n    }\n  ],\n  [sets.rightHandHoveringOnPen]: [],\n  [sets.rightHandHoldingPen]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        value: rightDpadEast\n      },\n      dest: {\n        value: paths.actions.rightHand.penNextColor\n      },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: {\n        value: rightDpadWest\n      },\n      dest: {\n        value: paths.actions.rightHand.penPrevColor\n      },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: {\n        value: rightAxis(\"joyY\")\n      },\n      dest: {\n        value: rightJoyYDeadzoned\n      },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: rightJoyYDeadzoned },\n      dest: { value: paths.actions.rightHand.scalePenTip },\n      xform: xforms.scaleExp(-0.005, 5),\n      priority: 2\n    },\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: rightButton(\"b\").pressed },\n      dest: { value: paths.actions.rightHand.undoDrawing },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.cursorHoveringOnCamera]: [],\n  [sets.rightHandHoveringOnCamera]: [],\n  [sets.leftHandHoveringOnCamera]: [],\n\n  [sets.rightHandHoldingCamera]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.takeSnapshot },\n      xform: xforms.rising,\n      priority: 4\n    }\n  ],\n  [sets.leftHandHoldingCamera]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.takeSnapshot },\n      xform: xforms.rising,\n      priority: 4\n    }\n  ],\n  [sets.cursorHoldingCamera]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.takeSnapshot },\n      xform: xforms.rising,\n      priority: 4\n    }\n  ],\n\n  [sets.rightHandHoveringOnNothing]: [],\n  [sets.inputFocused]: [\n    {\n      src: { value: \"/device/keyboard\" },\n      dest: { value: paths.noop },\n      xform: xforms.noop,\n      priority: 1000\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst v = name => {\n  return `/vive-user/vive-var/${name}`;\n};\n\nconst lButton = paths.device.vive.left.button;\nconst lAxis = paths.device.vive.left.axis;\nconst lPose = paths.device.vive.left.pose;\nconst lJoy = v(\"left/joy\");\nconst lJoyScaled = v(\"left/joy/scaled\");\nconst lJoyXScaled = v(\"left/joyX/scaled\");\nconst lJoyYScaled = v(\"left/joyY/scaled\");\nconst lDpadNorth = v(\"left/dpad/north\");\nconst lDpadSouth = v(\"left/dpad/south\");\nconst lDpadEast = v(\"left/dpad/east\");\nconst lDpadWest = v(\"left/dpad/west\");\nconst lDpadCenter = v(\"left/dpad/center\");\nconst lTriggerFallingStopDrawing = v(\"left/trigger/falling/stopDrawing\");\nconst lGripFallingStopDrawing = v(\"left/grip/falling/stopDrawing\");\nconst lTriggerRisingGrab = v(\"right/trigger/rising/grab\");\nconst lGripRisingGrab = v(\"right/grab/rising/grab\");\nconst lTouchpadRising2 = v(\"left/touchpad/rising2\");\nconst lTouchpadRising1 = v(\"left/touchpad/rising1\");\nconst lCharacterAcceleration = v(\"left/characterAcceleration\");\nconst characterAcceleration = v(\"nonNormalizedCharacterAcceleration\");\nconst leftBoost = v(\"left/boost\");\n\nconst rButton = paths.device.vive.right.button;\nconst rAxis = paths.device.vive.right.axis;\nconst rPose = paths.device.vive.right.pose;\nconst rJoy = v(\"right/joy\");\nconst rDpadNorth = v(\"right/dpad/north\");\nconst rDpadSouth = v(\"right/dpad/south\");\nconst rDpadEast = v(\"right/dpad/east\");\nconst rDpadWest = v(\"right/dpad/west\");\nconst rDpadCenter = v(\"right/dpad/center\");\nconst rDpadCenterStrip = v(\"right/dpad/centerStrip\");\nconst rTouchpadRising = v(\"right/touchpad/rising\");\nconst rTouchpadFalling = v(\"right/touchpad/falling\");\nconst rightBoost = v(\"right/boost\");\nconst rTriggerRisingGrab = v(\"right/trigger/rising/grab\");\nconst rGripRisingGrab = v(\"right/grab/rising/grab\");\nconst cursorDrop1 = v(\"right/cursorDrop1\");\nconst cursorDrop2 = v(\"right/cursorDrop2\");\nconst rHandDrop1 = v(\"right/drop1\");\nconst rHandDrop2 = v(\"right/drop2\");\nconst rTriggerStopTeleport = v(\"right/trigger/stopTeleport\");\nconst rTouchpadStopTeleport = v(\"right/touchpad/stopTeleport\");\nconst rootForFrozenOverrideWhenHolding = \"rootForFrozenOverrideWhenHolding\";\n\nconst ensureFrozenViaDpad = v(\"dpad/ensureFrozen\");\nconst ensureFrozenViaKeyboard = v(\"keyboard/ensureFrozen\");\n\nconst thawViaDpad = v(\"dpad/thaw\");\nconst thawViaKeyboard = v(\"keyboard/thaw\");\n\nconst rSnapRight = v(\"right/snap-right\");\nconst rSnapLeft = v(\"right/snap-left\");\n\nconst k = name => {\n  return `/vive-user/keyboard-var/${name}`;\n};\nconst keyboardSnapRight = k(\"snap-right\");\nconst keyboardSnapLeft = k(\"snap-left\");\nconst keyboardCharacterAcceleration = k(\"characterAcceleration\");\nconst wasd_vec2 = k(\"wasd_vec2\");\nconst arrows_vec2 = k(\"arrows_vec2\");\nconst keyboardBoost = k(\"boost\");\n\nconst leftGripPressed1 = v(\"leftGripPressed1\");\nconst leftGripPressed2 = v(\"leftGripPressed2\");\nconst rightGripPressed1 = v(\"rightGripPressed1\");\nconst rightGripPressed2 = v(\"rightGripPressed2\");\nconst leftTriggerPressed1 = v(\"leftTriggerPressed1\");\nconst leftTriggerPressed2 = v(\"leftTriggerPressed2\");\nconst leftTouchpadPressed1 = v(\"leftTouchpadPressed1\");\nconst leftTouchpadPressed2 = v(\"leftTouchpadPressed2\");\nconst rightTriggerPressed1 = v(\"rightTriggerPressed1\");\nconst rightTriggerPressed2 = v(\"rightTriggerPressed2\");\nconst leftTouchpadFallingStopTeleport = v(\"leftTouchpadFallingStopTeleport\");\nconst leftTriggerFallingStopTeleport = v(\"leftTriggerFallingStopTeleport\");\nconst leftGripFallingWhileHoldingPen = v(\"leftGripFallingWhileHoldingPen\");\n\nexport const viveUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {\n        value: paths.device.vive.left.matrix\n      },\n      dest: {\n        value: paths.actions.leftHand.matrix\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: paths.device.vive.right.matrix\n      },\n      dest: {\n        value: paths.actions.rightHand.matrix\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [ensureFrozenViaDpad, ensureFrozenViaKeyboard],\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.any\n    },\n    {\n      src: [thawViaDpad, thawViaKeyboard],\n      dest: { value: paths.actions.thaw },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: lButton(\"grip\").pressed\n      },\n      dest: {\n        value: leftGripPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: leftGripPressed1\n      },\n      dest: {\n        value: paths.actions.leftHand.middleRingPinky\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: lButton(\"grip\").pressed\n      },\n      dest: {\n        value: leftGripPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [lButton(\"touchpad\").touched, lButton(\"top\").touched],\n      dest: {\n        value: paths.actions.leftHand.thumb\n      },\n      xform: xforms.any\n    },\n    {\n      src: { value: leftTriggerPressed1 },\n      dest: {\n        value: paths.actions.leftHand.index\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: lButton(\"trigger\").pressed },\n      dest: {\n        value: leftTriggerPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: lButton(\"trigger\").pressed },\n      dest: {\n        value: leftTriggerPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rButton(\"grip\").pressed\n      },\n      dest: {\n        value: rightGripPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rButton(\"grip\").pressed\n      },\n      dest: {\n        value: rightGripPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightGripPressed1\n      },\n      dest: {\n        value: paths.actions.rightHand.middleRingPinky\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [rButton(\"touchpad\").touched, rButton(\"top\").touched],\n      dest: {\n        value: paths.actions.rightHand.thumb\n      },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: rButton(\"trigger\").pressed\n      },\n      dest: { value: rightTriggerPressed1 },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rButton(\"trigger\").pressed\n      },\n      dest: { value: rightTriggerPressed2 },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightTriggerPressed1 },\n      dest: {\n        value: paths.actions.rightHand.index\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: lAxis(\"joyX\"),\n        y: lAxis(\"joyY\")\n      },\n      dest: {\n        value: lJoy\n      },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: lJoy\n      },\n      dest: {\n        north: lDpadNorth,\n        south: lDpadSouth,\n        east: lDpadEast,\n        west: lDpadWest,\n        center: lDpadCenter\n      },\n      xform: xforms.vec2dpad(0.35)\n    },\n    {\n      src: {\n        value: lButton(\"touchpad\").pressed\n      },\n      dest: {\n        value: leftTouchpadPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: lButton(\"touchpad\").pressed\n      },\n      dest: {\n        value: leftTouchpadPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: rAxis(\"joyX\"),\n        y: rAxis(\"joyY\")\n      },\n      dest: {\n        value: rJoy\n      },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: rJoy\n      },\n      dest: {\n        north: rDpadNorth,\n        south: rDpadSouth,\n        east: rDpadEast,\n        west: rDpadWest,\n        center: rDpadCenter\n      },\n      xform: xforms.vec2dpad(0.35, false, true)\n    },\n    {\n      src: [rDpadNorth, rDpadSouth, rDpadCenter],\n      dest: { value: rDpadCenterStrip },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: rButton(\"touchpad\").pressed\n      },\n      dest: {\n        value: rTouchpadRising\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: rButton(\"touchpad\").pressed\n      },\n      dest: {\n        value: rTouchpadFalling\n      },\n      xform: xforms.falling\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadEast\n      },\n      dest: {\n        value: rSnapRight\n      },\n      xform: xforms.copyIfTrue,\n      priority: 1\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"e\") },\n      dest: { value: keyboardSnapRight },\n      xform: xforms.rising\n    },\n    {\n      src: [rSnapRight, keyboardSnapRight],\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.any\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Tab\") },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: ensureFrozenViaKeyboard },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: thawViaKeyboard },\n      xform: xforms.falling\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"p\") },\n      dest: { value: paths.actions.spawnPen },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"c\") },\n      dest: { value: paths.actions.toggleCamera },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"x\") },\n      dest: { value: paths.actions.takeSnapshot },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rButton(\"touchpad\").pressed, bool: rDpadCenterStrip },\n      dest: { value: ensureFrozenViaDpad },\n      root: rootForFrozenOverrideWhenHolding,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: rTouchpadFalling },\n      dest: { value: thawViaDpad },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadWest\n      },\n      dest: {\n        value: rSnapLeft\n      },\n      xform: xforms.copyIfTrue,\n      priority: 1\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"q\") },\n      dest: { value: keyboardSnapLeft },\n      xform: xforms.rising\n    },\n    {\n      src: [rSnapLeft, keyboardSnapLeft],\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.any\n    },\n\n    {\n      src: {\n        value: lAxis(\"joyX\")\n      },\n      dest: {\n        value: lJoyXScaled\n      },\n      xform: xforms.scale(1.5) // horizontal character speed modifier\n    },\n    {\n      src: {\n        value: lAxis(\"joyY\")\n      },\n      dest: { value: lJoyYScaled },\n      xform: xforms.scale(1.5) // vertical character speed modifier\n    },\n    {\n      src: {\n        x: lJoyXScaled,\n        y: lJoyYScaled\n      },\n      dest: { value: lJoyScaled },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        bool: leftTouchpadPressed2,\n        value: lJoyScaled\n      },\n      dest: { value: lCharacterAcceleration },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"arrowup\"),\n        a: paths.device.keyboard.key(\"arrowleft\"),\n        s: paths.device.keyboard.key(\"arrowdown\"),\n        d: paths.device.keyboard.key(\"arrowright\")\n      },\n      dest: { vec2: arrows_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"w\"),\n        a: paths.device.keyboard.key(\"a\"),\n        s: paths.device.keyboard.key(\"s\"),\n        d: paths.device.keyboard.key(\"d\")\n      },\n      dest: { vec2: wasd_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"t\")\n      },\n      dest: {\n        value: paths.actions.focusChat\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"/\")\n      },\n      dest: {\n        value: paths.actions.focusChatCommand\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: paths.actions.mediaExit },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"1\")\n      },\n      dest: { value: \"/var/shift+1\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+1\" },\n      dest: { value: paths.actions.mediaSearch1 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"2\")\n      },\n      dest: { value: \"/var/shift+2\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+2\" },\n      dest: { value: paths.actions.mediaSearch2 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"3\")\n      },\n      dest: { value: \"/var/shift+3\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+3\" },\n      dest: { value: paths.actions.mediaSearch3 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"4\")\n      },\n      dest: { value: \"/var/shift+4\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+4\" },\n      dest: { value: paths.actions.mediaSearch4 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"5\")\n      },\n      dest: { value: \"/var/shift+5\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+5\" },\n      dest: { value: paths.actions.mediaSearch5 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"6\")\n      },\n      dest: { value: \"/var/shift+6\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+6\" },\n      dest: { value: paths.actions.mediaSearch6 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"7\")\n      },\n      dest: { value: \"/var/shift+7\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+7\" },\n      dest: { value: paths.actions.mediaSearch7 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"8\")\n      },\n      dest: { value: \"/var/shift+8\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+8\" },\n      dest: { value: paths.actions.mediaSearch8 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"l\")\n      },\n      dest: {\n        value: paths.actions.logDebugFrame\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"k\")\n      },\n      dest: {\n        value: paths.actions.logInteractionState\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"m\")\n      },\n      dest: {\n        value: paths.actions.muteMic\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        first: wasd_vec2,\n        second: arrows_vec2\n      },\n      dest: { value: keyboardCharacterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: {\n        first: lCharacterAcceleration,\n        second: keyboardCharacterAcceleration\n      },\n      dest: {\n        value: characterAcceleration\n      },\n      xform: xforms.max_vec2\n    },\n    {\n      src: { value: characterAcceleration },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.normalize_vec2\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"shift\") },\n      dest: { value: keyboardBoost },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: lButton(\"top\").pressed\n      },\n      dest: {\n        value: leftBoost\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rButton(\"top\").pressed\n      },\n      dest: {\n        value: rightBoost\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [keyboardBoost, leftBoost, rightBoost],\n      dest: { value: paths.actions.boost },\n      xform: xforms.any\n    },\n    {\n      src: { value: rPose },\n      dest: { value: paths.actions.cursor.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rPose },\n      dest: { value: paths.actions.rightHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: lPose },\n      dest: { value: paths.actions.leftHand.pose },\n      xform: xforms.copy\n    }\n  ],\n  [sets.rightHandTeleporting]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: rTriggerStopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: { value: rButton(\"touchpad\").pressed },\n      dest: { value: rTouchpadStopTeleport },\n      xform: xforms.falling\n    },\n    {\n      src: [rTriggerStopTeleport, rTouchpadStopTeleport],\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.any\n    }\n  ],\n  [sets.leftHandHoveringOnNothing]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startTeleport },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.leftHandTeleporting]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: leftTriggerFallingStopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: [leftTriggerFallingStopTeleport, leftTouchpadFallingStopTeleport, leftGripFallingWhileHoldingPen],\n      dest: { value: paths.actions.leftHand.stopTeleport },\n      xform: xforms.any\n    }\n  ],\n\n  [sets.rightHandHoveringOnNothing]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.cursorHoveringOnNothing]: [],\n\n  [sets.cursorHoveringOnUI]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.cursorHoveringOnVideo]: [\n    {\n      src: {\n        value: rAxis(\"joyY\"),\n        touching: rButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.mediaVolumeMod },\n      xform: xforms.touch_axis_scroll(0.1)\n    }\n  ],\n\n  [sets.leftHandHoveringOnInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: lGripRisingGrab },\n      xform: xforms.rising\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: lTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: [lGripRisingGrab],\n      dest: { value: paths.actions.leftHand.grab },\n      xform: xforms.any\n    }\n  ],\n\n  [sets.leftHandHoldingInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.falling,\n      priority: 1\n    }\n  ],\n\n  [sets.leftHandHoveringOnPen]: [],\n  [sets.leftHandHoldingPen]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.noop,\n      priority: 2\n    },\n    {\n      src: { value: leftTouchpadPressed2 },\n      dest: { value: leftTouchpadFallingStopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: {\n        value: leftTouchpadPressed2\n      },\n      dest: {\n        value: lTouchpadRising1\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: {\n        bool: lTouchpadRising1,\n        value: lDpadCenter\n      },\n      dest: { value: paths.actions.leftHand.startTeleport },\n      xform: xforms.copyIfTrue,\n      priority: 1\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startDrawing },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: lTriggerFallingStopDrawing },\n      xform: xforms.falling,\n      priority: 2\n    },\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: lGripFallingStopDrawing },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: leftGripFallingWhileHoldingPen },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: [lTriggerFallingStopDrawing, lGripFallingStopDrawing],\n      dest: { value: paths.actions.leftHand.stopDrawing },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: leftTouchpadPressed2\n      },\n      dest: {\n        value: lTouchpadRising2\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: {\n        bool: lTouchpadRising2,\n        value: lDpadNorth\n      },\n      dest: {\n        value: paths.actions.leftHand.penNextColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        bool: lTouchpadRising2,\n        value: lDpadSouth\n      },\n      dest: {\n        value: paths.actions.leftHand.penPrevColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        value: lAxis(\"joyX\"),\n        touching: lButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.leftHand.scalePenTip },\n      xform: xforms.touch_axis_scroll(0.05)\n    },\n    {\n      src: { value: lButton(\"top\").pressed },\n      dest: { value: paths.actions.leftHand.undoDrawing },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.cursorHoveringOnInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rGripRisingGrab },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: rTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: [rGripRisingGrab],\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.any\n    }\n  ],\n\n  [sets.cursorHoldingUI]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: {\n        value: cursorDrop2\n      },\n      xform: xforms.falling,\n      priority: 4\n    }\n  ],\n\n  [sets.cursorHoldingInteractable]: [\n    {\n      src: {\n        value: rAxis(\"joyY\"),\n        touching: rButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.modDelta },\n      xform: xforms.touch_axis_scroll(-1)\n    },\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: cursorDrop1 },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: [cursorDrop1, cursorDrop2],\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.any\n    },\n    {\n      src: {},\n      dest: { value: ensureFrozenViaDpad },\n      root: rootForFrozenOverrideWhenHolding,\n      xform: xforms.always(false)\n    }\n  ],\n\n  [sets.cursorHoveringOnPen]: [],\n\n  [sets.cursorHoldingPen]: [\n    {\n      src: [cursorDrop1],\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.noop,\n      priority: 1\n    },\n    {\n      src: [cursorDrop2],\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.noop,\n      priority: 1\n    },\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadCenter\n      },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        value: rAxis(\"joyX\"),\n        touching: rButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.scalePenTip },\n      xform: xforms.touch_axis_scroll(0.1)\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadNorth\n      },\n      dest: {\n        value: paths.actions.cursor.penNextColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadSouth\n      },\n      dest: {\n        value: paths.actions.cursor.penPrevColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: { value: rButton(\"top\").pressed },\n      dest: { value: paths.actions.cursor.undoDrawing },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.rightHandHoveringOnInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rGripRisingGrab },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: rTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [rGripRisingGrab],\n      dest: { value: paths.actions.rightHand.grab },\n      xform: xforms.any\n    }\n  ],\n\n  [sets.rightHandHoldingInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rHandDrop1 },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: {\n        value: rHandDrop2\n      },\n      xform: xforms.falling,\n      priority: 2\n    },\n    {\n      src: [rHandDrop1],\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.any,\n      priority: 2\n    },\n    {\n      src: {},\n      dest: { value: ensureFrozenViaDpad },\n      root: rootForFrozenOverrideWhenHolding,\n      xform: xforms.always(false)\n    }\n  ],\n  [sets.rightHandHoveringOnPen]: [],\n  [sets.rightHandHoldingPen]: [\n    {\n      src: [rHandDrop1],\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.noop,\n      priority: 1\n    },\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadCenter\n      },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadNorth\n      },\n      dest: {\n        value: paths.actions.rightHand.penNextColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadSouth\n      },\n      dest: {\n        value: paths.actions.rightHand.penPrevColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        value: rAxis(\"joyX\"),\n        touching: rButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.rightHand.scalePenTip },\n      xform: xforms.touch_axis_scroll(0.05)\n    },\n    {\n      src: { value: rButton(\"top\").pressed },\n      dest: { value: paths.actions.rightHand.undoDrawing },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.cursorHoveringOnCamera]: [],\n  [sets.rightHandHoveringOnCamera]: [],\n  [sets.leftHandHoveringOnCamera]: [],\n\n  [sets.rightHandHoldingCamera]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.takeSnapshot },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.noop },\n      xform: xforms.falling,\n      priority: 3\n    }\n  ],\n  [sets.leftHandHoldingCamera]: [\n    {\n      src: { value: lButton(\"trigger\").pressed },\n      dest: { value: paths.actions.leftHand.takeSnapshot },\n      xform: xforms.rising\n    }\n  ],\n  [sets.cursorHoldingCamera]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.takeSnapshot },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.noop },\n      xform: xforms.falling,\n      priority: 3\n    }\n  ],\n  [sets.inputFocused]: [\n    {\n      src: { value: \"/device/keyboard\" },\n      dest: { value: paths.noop },\n      xform: xforms.noop,\n      priority: 1000\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst lGripPressed = paths.device.wmr.left.grip.pressed;\nconst rGripPressed = paths.device.wmr.right.grip.pressed;\nconst rTriggerPressed = paths.device.wmr.right.trigger.pressed;\n\nconst rJoyNorth = paths.device.wmr.v(\"right/joy/north\");\nconst rGripRising = paths.device.wmr.v(\"right/grip/rising\");\nconst rTriggerRising = paths.device.wmr.v(\"right/trigger/rising\");\nconst rGripFalling = paths.device.wmr.v(\"right/grip/falling\");\nconst rTriggerFalling = paths.device.wmr.v(\"right/trigger/falling\");\n\nfunction dpadVariables(hand) {\n  return {\n    padWest: paths.device.wmr.v(hand + \"/pad/west\"),\n    padEast: paths.device.wmr.v(hand + \"/pad/east\"),\n    padNorth: paths.device.wmr.v(hand + \"/pad/north\"),\n    padSouth: paths.device.wmr.v(hand + \"/pad/south\"),\n    padCenter: paths.device.wmr.v(hand + \"/pad/center\"),\n    padCenterStrip: paths.device.wmr.v(hand + \"/pad/centerStrip\")\n  };\n}\n\nfunction dpadBindings(hand) {\n  const { padWest, padEast, padNorth, padSouth, padCenter, padCenterStrip } = dpadVariables(hand);\n  const pad = paths.device.wmr.v(hand + \"/pad\");\n  return [\n    {\n      src: {\n        x: paths.device.wmr[hand].touchpad.axisX,\n        y: paths.device.wmr[hand].touchpad.axisY\n      },\n      dest: { value: pad },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: pad },\n      dest: {\n        west: padWest,\n        east: padEast,\n        north: padNorth,\n        south: padSouth,\n        center: padCenter\n      },\n      xform: xforms.vec2dpad(0.5, false, false)\n    },\n    {\n      src: [padNorth, padCenter, padSouth],\n      dest: { value: padCenterStrip },\n      xform: xforms.any\n    }\n  ];\n}\n\nconst neverFrozenBinding = {\n  src: {},\n  dest: { value: paths.actions.ensureFrozen },\n  xform: xforms.always(false)\n};\n\nfunction penBindings(hand, forCursor) {\n  const padY = paths.device.wmr[hand].touchpad.axisY;\n  const triggerPressed = paths.device.wmr[hand].trigger.pressed;\n  const padPressed = paths.device.wmr[hand].touchpad.pressed;\n  const padTouched = paths.device.wmr[hand].touchpad.touched;\n\n  const padRising = paths.device.wmr.v(hand + \"/pad/rising\");\n  const padCenterStripTouched = paths.device.wmr.v(hand + \"/pad/centerStrip/touched\");\n  const { padWest, padEast, padCenter, padCenterStrip } = dpadVariables(hand);\n\n  const actions = paths.actions[forCursor ? \"cursor\" : hand + \"Hand\"];\n\n  return [\n    neverFrozenBinding,\n    ...dpadBindings(hand),\n    {\n      src: { value: triggerPressed },\n      dest: { value: actions.startDrawing },\n      xform: xforms.rising\n    },\n    {\n      src: { value: triggerPressed },\n      dest: { value: actions.stopDrawing },\n      xform: xforms.falling\n    },\n    {\n      src: { value: padPressed },\n      dest: { value: padRising },\n      xform: xforms.rising\n    },\n    {\n      src: { bool: padRising, value: padWest },\n      dest: { value: actions.penPrevColor },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { bool: padRising, value: padEast },\n      dest: { value: actions.penNextColor },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: [padCenterStrip, padTouched],\n      dest: { value: padCenterStripTouched },\n      xform: xforms.all\n    },\n    {\n      src: { value: padY, touching: padCenterStripTouched },\n      dest: { value: actions.scalePenTip },\n      xform: xforms.touch_axis_scroll(-0.05)\n    },\n    {\n      src: [padRising, padCenter],\n      dest: { value: actions.undoDrawing },\n      xform: xforms.all\n    }\n  ];\n}\n\nfunction handPoseBindings(hand) {\n  const padTouched = paths.device.wmr[hand].touchpad.touched;\n  const triggerPressed = paths.device.wmr[hand].trigger.pressed;\n  const gripPressed = paths.device.wmr[hand].grip.pressed;\n  const actions = paths.actions[hand + \"Hand\"];\n  return [\n    {\n      src: { value: padTouched },\n      dest: { value: actions.thumb },\n      xform: xforms.copy\n    },\n    {\n      src: { value: triggerPressed },\n      dest: { value: actions.index },\n      xform: xforms.copy\n    },\n    {\n      src: { value: gripPressed },\n      dest: { value: actions.middleRingPinky },\n      xform: xforms.copy\n    }\n  ];\n}\n\nfunction freezeBindings() {\n  const leftPadPressed = paths.device.wmr.left.touchpad.pressed;\n  const rightPadPressed = paths.device.wmr.right.touchpad.pressed;\n  const leftPadFalling = paths.device.wmr.v(\"left/touchpad/falling\");\n  const rightPadFalling = paths.device.wmr.v(\"right/touchpad/falling\");\n  const keyboardSaceFalling = paths.device.wmr.k(\"space/falling\");\n  return [\n    {\n      src: [paths.device.keyboard.key(\" \"), leftPadPressed, rightPadPressed],\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.any\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: keyboardSaceFalling },\n      xform: xforms.falling\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Tab\") },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.rising\n    },\n    {\n      src: { value: leftPadPressed },\n      dest: { value: leftPadFalling },\n      xform: xforms.falling\n    },\n    {\n      src: { value: rightPadPressed },\n      dest: { value: rightPadFalling },\n      xform: xforms.falling\n    },\n    {\n      src: [keyboardSaceFalling, leftPadFalling, rightPadFalling],\n      dest: { value: paths.actions.thaw },\n      xform: xforms.any\n    }\n  ];\n}\n\nfunction characterAccelerationBindings() {\n  const wasd_vec2 = paths.device.wmr.k(\"wasd_vec2\");\n  const arrows_vec2 = paths.device.wmr.k(\"arrows_vec2\");\n  const keyboardCharacterAcceleration = paths.device.wmr.k(\"characterAcceleration\");\n  const lJoyXDeadzoned = paths.device.wmr.v(\"left/joy/x/deadzoned\");\n  const lJoyYDeadzoned = paths.device.wmr.v(\"left/joy/y/deadzoned\");\n  const lJoyXScaled = paths.device.wmr.v(\"left/joy/x/scaled\");\n  const lJoyYScaled = paths.device.wmr.v(\"left/joy/y/scaled\");\n  const lCharacterAcceleration = paths.device.wmr.v(\"left/characterAcceleration\");\n  return [\n    {\n      src: {\n        w: paths.device.keyboard.key(\"arrowup\"),\n        a: paths.device.keyboard.key(\"arrowleft\"),\n        s: paths.device.keyboard.key(\"arrowdown\"),\n        d: paths.device.keyboard.key(\"arrowright\")\n      },\n      dest: { vec2: arrows_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"w\"),\n        a: paths.device.keyboard.key(\"a\"),\n        s: paths.device.keyboard.key(\"s\"),\n        d: paths.device.keyboard.key(\"d\")\n      },\n      dest: { vec2: wasd_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        first: wasd_vec2,\n        second: arrows_vec2\n      },\n      dest: { value: keyboardCharacterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: { value: paths.device.wmr.left.joystick.axisX },\n      dest: { value: lJoyXDeadzoned },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: lJoyXDeadzoned },\n      dest: { value: lJoyXScaled },\n      xform: xforms.scale(1.5) // horizontal character speed modifier\n    },\n    {\n      src: { value: paths.device.wmr.left.joystick.axisY },\n      dest: { value: lJoyYDeadzoned },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: lJoyYDeadzoned },\n      dest: { value: lJoyYScaled },\n      xform: xforms.scale(-1.5) // vertical character speed modifier\n    },\n    {\n      src: { x: lJoyXScaled, y: lJoyYScaled },\n      dest: { value: lCharacterAcceleration },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        first: lCharacterAcceleration,\n        second: keyboardCharacterAcceleration\n      },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: [\n        paths.device.wmr.left.trigger.pressed,\n        paths.device.wmr.right.trigger.pressed,\n        paths.device.keyboard.key(\"shift\")\n      ],\n      dest: { value: paths.actions.boost },\n      xform: xforms.any\n    }\n  ];\n}\n\nfunction cursorModDeltaBindings() {\n  const { padNorth, padSouth } = dpadVariables(\"right\");\n  const rPadNorthOrSouth = paths.device.wmr.v(\"right/pad/northOrSouth\");\n  const rPadNorthOrSouthPressed = paths.device.wmr.v(\"right/pad/northOrSouth/pressed\");\n  const rPadNorthOrSouthPressedY = paths.device.wmr.v(\"right/pad/northOrSouthpressed/y\");\n  return [\n    ...dpadBindings(\"right\"),\n    {\n      src: [padNorth, padSouth],\n      dest: { value: rPadNorthOrSouth },\n      xform: xforms.any\n    },\n    {\n      src: [rPadNorthOrSouth, paths.device.wmr.right.touchpad.pressed],\n      dest: { value: rPadNorthOrSouthPressed },\n      xform: xforms.all\n    },\n    {\n      src: {\n        bool: rPadNorthOrSouthPressed,\n        value: paths.device.wmr.right.touchpad.axisY\n      },\n      dest: { value: rPadNorthOrSouthPressedY },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: rPadNorthOrSouthPressedY },\n      dest: { value: paths.actions.cursor.modDelta },\n      xform: xforms.scale(0.1)\n    }\n  ];\n}\n\nfunction cursorMediaVolumeModBindings() {\n  const hand = \"right\";\n  const padY = paths.device.wmr[hand].touchpad.axisY;\n  const padTouched = paths.device.wmr[hand].touchpad.touched;\n\n  const padCenterStripTouched = paths.device.wmr.v(hand + \"/pad/centerStrip/touched\");\n  const { padCenterStrip } = dpadVariables(hand);\n\n  return [\n    ...dpadBindings(hand),\n    {\n      src: [padCenterStrip, padTouched],\n      dest: { value: padCenterStripTouched },\n      xform: xforms.all\n    },\n    {\n      src: { value: padY, touching: padCenterStripTouched },\n      dest: { value: paths.actions.cursor.mediaVolumeMod },\n      xform: xforms.touch_axis_scroll(-0.1)\n    }\n  ];\n}\n\nfunction holdingCameraBindings(hand, forCursor) {\n  const actions = paths.actions[forCursor ? \"cursor\" : hand + \"Hand\"];\n  return [\n    neverFrozenBinding,\n    {\n      src: { value: paths.device.wmr[hand].trigger.pressed },\n      dest: { value: actions.takeSnapshot },\n      xform: xforms.rising\n    }\n  ];\n}\n\nfunction teleportationAndRotationBindings() {\n  const rJoy = paths.device.wmr.v(\"right/joy\");\n  const rJoyWest = paths.device.wmr.v(\"right/joy/west\");\n  const rJoyEast = paths.device.wmr.v(\"right/joy/East\");\n  const rJoyWestRising = paths.device.wmr.v(\"right/joy/west/rising\");\n  const rJoyEastRising = paths.device.wmr.v(\"right/joy/east/rising\");\n  const keyboardQRising = paths.device.wmr.k(\"q/rising\");\n  const keyboardERising = paths.device.wmr.k(\"e/rising\");\n  return [\n    {\n      src: {\n        x: paths.device.wmr.right.joystick.axisX,\n        y: paths.device.wmr.right.joystick.axisY\n      },\n      dest: { value: rJoy },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: rJoy },\n      dest: {\n        north: rJoyNorth,\n        west: rJoyWest,\n        east: rJoyEast\n      },\n      xform: xforms.vec2dpad(0.2, false, false)\n    },\n    {\n      src: { value: rJoyNorth },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rJoyWest },\n      dest: { value: rJoyWestRising },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rJoyEast },\n      dest: { value: rJoyEastRising },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"q\") },\n      dest: { value: keyboardQRising },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"e\") },\n      dest: { value: keyboardERising },\n      xform: xforms.rising\n    },\n    {\n      src: [rJoyWestRising, keyboardQRising],\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.any\n    },\n    {\n      src: [rJoyEastRising, keyboardERising],\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.any\n    }\n  ];\n}\n\nexport const wmrUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: { value: paths.device.wmr.left.matrix },\n      dest: { value: paths.actions.leftHand.matrix },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.wmr.right.matrix },\n      dest: { value: paths.actions.rightHand.matrix },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.wmr.left.pose },\n      dest: { value: paths.actions.leftHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.wmr.right.pose },\n      dest: { value: paths.actions.cursor.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.wmr.right.pose },\n      dest: { value: paths.actions.rightHand.pose },\n      xform: xforms.copy\n    },\n    ...handPoseBindings(\"left\"),\n    ...handPoseBindings(\"right\"),\n    ...freezeBindings(),\n    ...teleportationAndRotationBindings(),\n    ...characterAccelerationBindings(),\n    {\n      src: {\n        value: paths.device.keyboard.key(\"m\")\n      },\n      dest: {\n        value: paths.actions.muteMic\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"t\")\n      },\n      dest: {\n        value: paths.actions.focusChat\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"/\")\n      },\n      dest: {\n        value: paths.actions.focusChatCommand\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: paths.actions.mediaExit },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"1\")\n      },\n      dest: { value: \"/var/shift+1\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+1\" },\n      dest: { value: paths.actions.mediaSearch1 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"2\")\n      },\n      dest: { value: \"/var/shift+2\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+2\" },\n      dest: { value: paths.actions.mediaSearch2 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"3\")\n      },\n      dest: { value: \"/var/shift+3\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+3\" },\n      dest: { value: paths.actions.mediaSearch3 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"4\")\n      },\n      dest: { value: \"/var/shift+4\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+4\" },\n      dest: { value: paths.actions.mediaSearch4 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"5\")\n      },\n      dest: { value: \"/var/shift+5\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+5\" },\n      dest: { value: paths.actions.mediaSearch5 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"6\")\n      },\n      dest: { value: \"/var/shift+6\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+6\" },\n      dest: { value: paths.actions.mediaSearch6 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"7\")\n      },\n      dest: { value: \"/var/shift+7\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+7\" },\n      dest: { value: paths.actions.mediaSearch7 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"8\")\n      },\n      dest: { value: \"/var/shift+8\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+8\" },\n      dest: { value: paths.actions.mediaSearch8 },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.leftHandHoveringOnNothing]: [],\n  [sets.cursorHoveringOnNothing]: [],\n  [sets.rightHandHoveringOnNothing]: [],\n\n  [sets.rightHandTeleporting]: [\n    {\n      src: { value: rJoyNorth },\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.falling\n    }\n  ],\n\n  [sets.cursorHoveringOnUI]: [\n    {\n      src: { value: rTriggerPressed },\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.cursorHoveringOnVideo]: [...cursorMediaVolumeModBindings()],\n\n  [sets.leftHandHoveringOnInteractable]: [\n    {\n      src: { value: lGripPressed },\n      dest: { value: paths.actions.leftHand.grab },\n      xform: xforms.rising\n    }\n  ],\n  [sets.cursorHoveringOnInteractable]: [\n    {\n      src: { value: rGripPressed },\n      dest: { value: rGripRising },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rTriggerPressed },\n      dest: { value: rTriggerRising },\n      xform: xforms.rising\n    },\n    {\n      src: [rGripRising, rTriggerRising],\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.any\n    }\n  ],\n  [sets.rightHandHoveringOnInteractable]: [\n    {\n      src: { value: rGripPressed },\n      dest: { value: paths.actions.rightHand.grab },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.leftHandHoldingInteractable]: [\n    neverFrozenBinding,\n    {\n      src: { value: lGripPressed },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.falling\n    }\n  ],\n  [sets.cursorHoldingInteractable]: [\n    neverFrozenBinding,\n    ...cursorModDeltaBindings(),\n    {\n      src: { value: rGripPressed },\n      dest: { value: rGripFalling },\n      xform: xforms.falling\n    },\n    {\n      src: { value: rTriggerPressed },\n      dest: { value: rTriggerFalling },\n      xform: xforms.falling\n    },\n    {\n      src: [rGripFalling, rTriggerFalling],\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.any\n    }\n  ],\n  [sets.rightHandHoldingInteractable]: [\n    neverFrozenBinding,\n    {\n      src: { value: rGripPressed },\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.falling\n    }\n  ],\n\n  [sets.leftHandHoveringOnPen]: [],\n  [sets.cursorHoveringOnPen]: [],\n  [sets.rightHandHoveringOnPen]: [],\n\n  [sets.leftHandHoldingPen]: penBindings(\"left\"),\n  [sets.cursorHoldingPen]: penBindings(\"right\", true),\n  [sets.rightHandHoldingPen]: penBindings(\"right\"),\n\n  [sets.leftHandHoveringOnCamera]: [],\n  [sets.cursorHoveringOnCamera]: [],\n  [sets.rightHandHoveringOnCamera]: [],\n\n  [sets.leftHandHoldingCamera]: holdingCameraBindings(\"left\"),\n  [sets.cursorHoldingCamera]: holdingCameraBindings(\"right\", true),\n  [sets.rightHandHoldingCamera]: holdingCameraBindings(\"right\"),\n\n  [sets.inputFocused]: [\n    {\n      src: { value: \"/device/keyboard\" },\n      dest: { value: paths.noop },\n      xform: xforms.noop,\n      priority: 1000\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst xboxUnscaledCursorScalePenTip = \"foobarbazbotbooch\";\n\nconst button = paths.device.xbox.button;\nconst axis = paths.device.xbox.axis;\nconst rightTriggerFalling = \"/vars/xbox/rightTriggerFalling\";\n\nexport const xboxControllerUserBindings = addSetsToBindings({\n  [sets.cursorHoldingInteractable]: [\n    {\n      src: { value: button(\"rightTrigger\").pressed },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.falling,\n      root: rightTriggerFalling,\n      priority: 100\n    },\n    {\n      src: {\n        bool: button(\"leftTrigger\").pressed,\n        value: axis(\"leftJoystickVertical\")\n      },\n      dest: { value: \"/vars/xbox/cursorModDelta\" },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: {\n        value: \"/vars/xbox/cursorModDelta\"\n      },\n      dest: { value: paths.actions.cursor.modDelta },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        bool: button(\"leftTrigger\").pressed,\n        value: axis(\"leftJoystickVertical\")\n      },\n      dest: { value: \"/var/xbox/leftJoystickVertical\" },\n      xform: xforms.copyIfFalse,\n      root: \"xbox/leftJoystick\",\n      priority: 200\n    }\n  ],\n  [sets.cursorHoldingPen]: [\n    {\n      src: { value: button(\"rightTrigger\").pressed },\n      dest: { value: paths.actions.cursor.startDrawing },\n      xform: xforms.rising,\n      root: \"xboxRightTriggerRising\",\n      priority: 200\n    },\n    {\n      src: { value: button(\"rightTrigger\").pressed },\n      dest: { value: paths.actions.cursor.stopDrawing },\n      xform: xforms.falling,\n      root: rightTriggerFalling,\n      priority: 200\n    },\n    {\n      src: { value: button(\"b\").pressed },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.rising\n    },\n    {\n      src: { value: button(\"y\").pressed },\n      dest: { value: paths.actions.cursor.undoDrawing },\n      xform: xforms.rising,\n      root: \"xbox/y\",\n      priority: 200\n    },\n    {\n      src: { value: button(\"a\").pressed },\n      dest: { value: paths.actions.cursor.penNextColor },\n      xform: xforms.rising\n    },\n    {\n      src: { value: button(\"x\").pressed },\n      dest: { value: paths.actions.cursor.penPrevColor },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: button(\"leftTrigger\").pressed,\n        value: axis(\"rightJoystickVertical\")\n      },\n      dest: { value: xboxUnscaledCursorScalePenTip },\n      xform: xforms.copyIfTrue\n    },\n    {\n      dest: {\n        value: paths.actions.cursorScalePenTip\n      },\n      src: { value: xboxUnscaledCursorScalePenTip },\n      xform: xforms.scale(0.01)\n    }\n  ],\n  [sets.global]: [\n    {\n      src: {\n        value: axis(\"rightJoystickHorizontal\")\n      },\n      dest: { value: \"/var/xbox/scaledRightJoystickHorizontal\" },\n      xform: xforms.scale(-1.5) // horizontal look speed modifier\n    },\n    {\n      src: {\n        value: axis(\"rightJoystickVertical\")\n      },\n      dest: { value: \"/var/xbox/scaledRightJoystickVertical\" },\n      xform: xforms.scale(-1.25) // vertical look speed modifier\n    },\n    {\n      src: {\n        x: \"/var/xbox/scaledRightJoystickHorizontal\",\n        y: \"/var/xbox/scaledRightJoystickVertical\"\n      },\n      dest: { value: paths.actions.cameraDelta },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: axis(\"leftJoystickHorizontal\")\n      },\n      dest: { value: \"/var/xbox/scaledLeftJoystickHorizontal\" },\n      xform: xforms.scale(1.5) // horizontal move speed modifier\n    },\n    {\n      src: { value: axis(\"leftJoystickVertical\") },\n      dest: { value: \"/var/xbox/leftJoystickVertical\" },\n      xform: xforms.copy,\n      root: \"xbox/leftJoystick\",\n      priority: 100\n    },\n    {\n      src: { value: \"/var/xbox/leftJoystickVertical\" },\n      dest: { value: \"/var/xbox/scaledLeftJoystickVertical\" },\n      xform: xforms.scale(-1.25) // vertical move speed modifier\n    },\n    {\n      src: {\n        x: \"/var/xbox/scaledLeftJoystickHorizontal\",\n        y: \"/var/xbox/scaledLeftJoystickVertical\"\n      },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: button(\"leftTrigger\").pressed },\n      dest: { value: paths.actions.boost },\n      xform: xforms.copy\n    },\n    {\n      src: { value: button(\"leftBumper\").pressed },\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.rising\n    },\n    {\n      src: { value: button(\"rightBumper\").pressed },\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.rising\n    },\n    {\n      dest: { value: \"var/vec2/zero\" },\n      xform: xforms.vec2Zero\n    },\n    {\n      src: { value: \"var/vec2/zero\" },\n      dest: { value: paths.actions.cursor.pose },\n      xform: xforms.poseFromCameraProjection()\n    },\n    {\n      src: { value: button(\"y\").pressed },\n      dest: { value: paths.actions.spawnPen },\n      xform: xforms.rising,\n      root: \"xbox/y\",\n      priority: 100\n    }\n  ],\n  [sets.cursorHoveringOnInteractable]: [\n    {\n      src: { value: button(\"rightTrigger\").pressed },\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.rising,\n      root: \"xboxRightTriggerRising\",\n      priority: 100\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\n// vars\nconst v = s => `/vars/daydream/${s}`;\nconst touchpad = v(\"touchpad/axis\");\nconst touchpadRising = v(\"touchpad/rising\");\nconst touchpadFalling = v(\"touchpad/falling\");\nconst touchpadPressed = v(\"touchpad/pressed\");\nconst dpadNorth = v(\"dpad/north\");\nconst dpadSouth = v(\"dpad/south\");\nconst dpadEast = v(\"dpad/east\");\nconst dpadWest = v(\"dpad/west\");\nconst dpadCenter = v(\"dpad/center\");\nconst brushSizeDelta = v(\"brushSizeDelta\");\nconst cursorModDelta = v(\"cursorModDelta\");\nconst dpadSouthDrop = v(\"dropSouth\");\nconst dpadCenterDrop = v(\"dropCenter\");\n\nconst grabBinding = [\n  {\n    src: { value: dpadCenter, bool: touchpadRising },\n    dest: { value: paths.actions.cursor.grab },\n    xform: xforms.copyIfTrue,\n    priority: 100\n  }\n];\n\nconst dropOnCenterOrSouth = [\n  {\n    src: { value: dpadCenter, bool: touchpadRising },\n    dest: { value: dpadCenterDrop },\n    xform: xforms.copyIfTrue,\n    priority: 100\n  },\n  {\n    src: { value: dpadSouth, bool: touchpadRising },\n    dest: { value: dpadSouthDrop },\n    xform: xforms.copyIfTrue,\n    priority: 100\n  },\n  {\n    src: [dpadCenterDrop, dpadSouthDrop],\n    dest: { value: paths.actions.cursor.drop },\n    xform: xforms.any\n  }\n];\n\nexport const daydreamUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: { value: paths.device.daydream.matrix },\n      dest: { value: paths.actions.rightHand.matrix },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: paths.device.daydream.axis(\"touchpadX\"),\n        y: paths.device.daydream.axis(\"touchpadY\")\n      },\n      dest: { value: touchpad },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: paths.device.daydream.button(\"touchpad\").pressed\n      },\n      dest: { value: touchpadRising },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.daydream.button(\"touchpad\").pressed\n      },\n      dest: { value: touchpadFalling },\n      xform: xforms.falling\n    },\n    {\n      src: {\n        value: paths.device.daydream.button(\"touchpad\").pressed\n      },\n      dest: { value: touchpadPressed },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: touchpad\n      },\n      dest: {\n        north: dpadNorth,\n        south: dpadSouth,\n        east: dpadEast,\n        west: dpadWest,\n        center: dpadCenter\n      },\n      xform: xforms.vec2dpad(0.5)\n    },\n    {\n      src: {\n        value: dpadEast,\n        bool: touchpadRising\n      },\n      dest: {\n        value: paths.actions.snapRotateRight\n      },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: {\n        value: dpadWest,\n        bool: touchpadRising\n      },\n      dest: {\n        value: paths.actions.snapRotateLeft\n      },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: {\n        value: dpadCenter,\n        bool: touchpadRising\n      },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: paths.device.daydream.pose },\n      dest: { value: paths.actions.cursor.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.daydream.pose },\n      dest: { value: paths.actions.rightHand.pose },\n      xform: xforms.copy\n    }\n  ],\n\n  [sets.cursorHoveringOnInteractable]: grabBinding,\n  [sets.cursorHoveringOnUI]: grabBinding,\n\n  [sets.cursorHoveringOnVideo]: [\n    {\n      src: {\n        value: paths.device.daydream.axis(\"touchpadY\"),\n        touching: paths.device.daydream.button(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.mediaVolumeMod },\n      xform: xforms.touch_axis_scroll(-0.1)\n    }\n  ],\n\n  [sets.cursorHoldingInteractable]: [\n    {\n      src: { value: touchpadFalling },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: paths.device.daydream.axis(\"touchpadY\"),\n        touching: paths.device.daydream.button(\"touchpad\").touched\n      },\n      dest: { value: cursorModDelta },\n      xform: xforms.touch_axis_scroll()\n    },\n    {\n      src: { value: cursorModDelta },\n      dest: { value: paths.actions.cursor.modDelta },\n      xform: xforms.copy\n    }\n  ],\n\n  [sets.rightHandTeleporting]: [\n    {\n      src: { value: touchpadFalling },\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.copy\n    }\n  ],\n\n  [sets.cursorHoldingPen]: [\n    {\n      src: { value: dpadNorth, bool: touchpadRising },\n      dest: { value: paths.actions.cursor.startDrawing },\n      xform: xforms.copyIfTrue,\n      priority: 100\n    },\n    {\n      src: { value: touchpadFalling },\n      dest: { value: paths.actions.cursor.stopDrawing },\n      xform: xforms.copy,\n      priority: 100\n    },\n    {\n      src: {\n        value: paths.device.daydream.axis(\"touchpadX\"),\n        touching: paths.device.daydream.button(\"touchpad\").touched\n      },\n      dest: { value: brushSizeDelta },\n      xform: xforms.touch_axis_scroll(-0.1)\n    },\n    {\n      src: {\n        value: brushSizeDelta,\n        bool: touchpadPressed\n      },\n      dest: { value: paths.actions.cursor.scalePenTip },\n      xform: xforms.copyIfFalse,\n      priority: 100\n    },\n    {\n      src: { value: dpadEast, bool: touchpadRising },\n      dest: {\n        value: paths.actions.cursor.penPrevColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 100\n    },\n    {\n      src: { value: dpadWest, bool: touchpadRising },\n      dest: {\n        value: paths.actions.cursor.penNextColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 100\n    },\n    {\n      src: {\n        value: cursorModDelta,\n        bool: touchpadPressed\n      },\n      dest: { value: paths.actions.cursor.modDelta },\n      xform: xforms.copyIfFalse,\n      priority: 100\n    },\n    ...dropOnCenterOrSouth\n  ],\n\n  [sets.cursorHoldingCamera]: [\n    // Don't drop on touchpad release\n    {\n      src: {\n        value: touchpadFalling\n      },\n      xform: xforms.noop,\n      priority: 100\n    },\n    {\n      src: {\n        value: dpadNorth,\n        bool: touchpadRising\n      },\n      dest: { value: paths.actions.cursor.takeSnapshot },\n      xform: xforms.copyIfTrue,\n      priority: 100\n    },\n    ...dropOnCenterOrSouth\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nexport const cardboardUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: { value: paths.device.touchscreen.isTouching },\n      dest: {\n        value: paths.actions.startGazeTeleport\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.touchscreen.isTouching },\n      dest: {\n        value: paths.actions.stopGazeTeleport\n      },\n      xform: xforms.falling\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nexport default function generate3DOFTriggerBindings(device) {\n  const touchpad = device.v(\"touchpad\");\n  const touchpadButton = device.button(\"touchpad\");\n  const triggerButton = device.button(\"trigger\");\n  const touchpadX = device.axis(\"touchpadX\");\n  const touchpadXForPen = device.axis(\"touchpadXForPen\");\n  const touchpadY = device.axis(\"touchpadY\");\n  const touchpadYForPen = device.axis(\"touchpadYForPen\");\n  const touchpadRising = device.v(\"touchpad/rising\");\n  const touchpadFalling = device.v(\"touchpad/falling\");\n  const triggerRising = device.v(\"trigger/rising\");\n  const triggerFalling = device.v(\"trigger/falling\");\n  const dpadNorth = device.v(\"dpad/north\");\n  const dpadSouth = device.v(\"dpad/south\");\n  const dpadEast = device.v(\"dpad/east\");\n  const dpadWest = device.v(\"dpad/west\");\n  const dpadCenter = device.v(\"dpad/center\");\n  const dpadCenterStrip = device.v(\"dpad/centerStrip\");\n  const dpadBottomCenterStrip = device.v(\"dpad/bottomCenterStrip\");\n  const togglePen = \"/vars/oculus-go/togglePen\";\n\n  const grabBinding = {\n    src: {\n      value: triggerRising\n    },\n    dest: { value: paths.actions.cursor.grab },\n    xform: xforms.copy,\n    priority: 200\n  };\n  const dropBinding = {\n    src: {\n      value: triggerFalling\n    },\n    dest: { value: paths.actions.cursor.drop },\n    xform: xforms.copy,\n    priority: 200\n  };\n\n  return addSetsToBindings({\n    [sets.global]: [\n      {\n        src: { value: device.matrix },\n        dest: { value: paths.actions.rightHand.matrix },\n        xform: xforms.copy\n      },\n      {\n        src: {\n          value: triggerButton.pressed\n        },\n        dest: { value: triggerRising },\n        xform: xforms.rising\n      },\n      {\n        src: {\n          value: triggerButton.pressed\n        },\n        dest: { value: triggerFalling },\n        xform: xforms.falling\n      },\n      {\n        src: {\n          value: touchpadButton.pressed\n        },\n        dest: { value: touchpadRising },\n        xform: xforms.rising,\n        priority: 100\n      },\n      {\n        src: {\n          value: touchpadButton.pressed\n        },\n        dest: { value: touchpadFalling },\n        xform: xforms.falling,\n        priority: 100\n      },\n      {\n        src: {\n          x: touchpadX,\n          y: touchpadY\n        },\n        dest: { value: touchpad },\n        xform: xforms.compose_vec2\n      },\n      {\n        src: { value: touchpadX },\n        dest: { value: touchpadXForPen },\n        xform: xforms.copy\n      },\n      {\n        src: { value: touchpadY },\n        dest: { value: touchpadYForPen },\n        xform: xforms.copy\n      },\n      {\n        src: {\n          value: touchpad\n        },\n        dest: {\n          north: dpadNorth,\n          south: dpadSouth,\n          east: dpadEast,\n          west: dpadWest,\n          center: dpadCenter\n        },\n        xform: xforms.vec2dpad(0.3)\n      },\n      {\n        src: [dpadCenter, dpadSouth],\n        dest: { value: dpadBottomCenterStrip },\n        xform: xforms.any\n      },\n      {\n        src: [dpadNorth, dpadBottomCenterStrip],\n        dest: { value: dpadCenterStrip },\n        xform: xforms.any\n      },\n      {\n        src: {\n          value: dpadCenterStrip,\n          bool: touchpadButton.pressed\n        },\n        dest: {\n          value: paths.actions.ensureFrozen\n        },\n        priority: 100,\n        xform: xforms.copyIfTrue\n      },\n      {\n        src: { value: touchpadFalling },\n        dest: {\n          value: paths.actions.thaw\n        },\n        xform: xforms.copy\n      },\n      {\n        src: {\n          value: dpadEast,\n          bool: touchpadRising\n        },\n        dest: {\n          value: paths.actions.snapRotateRight\n        },\n        xform: xforms.copyIfTrue,\n        priority: 100\n      },\n      {\n        src: {\n          value: dpadWest,\n          bool: touchpadRising\n        },\n        dest: {\n          value: paths.actions.snapRotateLeft\n        },\n        xform: xforms.copyIfTrue,\n        priority: 100\n      },\n      {\n        src: {\n          value: triggerRising\n        },\n        dest: { value: paths.actions.rightHand.startTeleport },\n        xform: xforms.copy,\n        priority: 100\n      },\n      {\n        src: { value: device.pose },\n        dest: { value: paths.actions.cursor.pose },\n        xform: xforms.copy\n      },\n      {\n        src: { value: device.pose },\n        dest: { value: paths.actions.rightHand.pose },\n        xform: xforms.copy\n      },\n      {\n        src: { value: touchpadButton.touched },\n        dest: { value: paths.actions.rightHand.thumb },\n        xform: xforms.copy\n      },\n      {\n        src: { value: triggerButton.pressed },\n        dest: { value: paths.actions.rightHand.index },\n        xform: xforms.copy\n      },\n      {\n        src: { value: triggerButton.pressed },\n        dest: { value: paths.actions.rightHand.middleRingPinky },\n        xform: xforms.copy\n      }\n    ],\n\n    [sets.cursorHoveringOnInteractable]: [grabBinding],\n    [sets.cursorHoveringOnUI]: [grabBinding],\n    [sets.cursorHoldingUI]: [dropBinding],\n    [sets.cursorHoveringOnVideo]: [\n      {\n        src: {\n          value: touchpadY,\n          touching: touchpadButton.touched\n        },\n        dest: { value: paths.actions.cursor.mediaVolumeMod },\n        xform: xforms.touch_axis_scroll(-0.1)\n      }\n    ],\n\n    [sets.cursorHoldingInteractable]: [\n      {\n        src: {\n          value: triggerFalling\n        },\n        dest: { value: paths.actions.cursor.drop },\n        xform: xforms.copy,\n        priority: 200\n      },\n      {\n        src: {\n          value: touchpadY,\n          touching: touchpadButton.touched\n        },\n        dest: { value: paths.actions.cursor.modDelta },\n        xform: xforms.touch_axis_scroll()\n      },\n      {\n        src: { value: dpadCenterStrip },\n        priority: 200,\n        xform: xforms.noop\n      }\n    ],\n\n    [sets.rightHandTeleporting]: [\n      {\n        src: {\n          value: triggerFalling\n        },\n        dest: { value: paths.actions.rightHand.stopTeleport },\n        xform: xforms.copy,\n        priority: 100\n      }\n    ],\n\n    [sets.cursorHoldingPen]: [\n      {\n        src: {\n          value: triggerRising\n        },\n        dest: { value: paths.actions.cursor.startDrawing },\n        xform: xforms.copy,\n        priority: 300\n      },\n      {\n        src: {\n          value: triggerFalling\n        },\n        dest: { value: paths.actions.cursor.stopDrawing },\n        xform: xforms.copy,\n        priority: 300\n      },\n      {\n        src: {\n          value: touchpadXForPen,\n          touching: touchpadButton.touched\n        },\n        dest: { value: paths.actions.cursor.scalePenTip },\n        xform: xforms.touch_axis_scroll(0.1, 0.1),\n        priority: 200\n      },\n      {\n        src: {\n          value: touchpadYForPen,\n          touching: touchpadButton.touched\n        },\n        dest: { value: paths.actions.cursor.modDelta },\n        xform: xforms.touch_axis_scroll(1, 0.1),\n        priority: 200\n      },\n      {\n        src: {\n          value: dpadBottomCenterStrip,\n          bool: touchpadFalling\n        },\n        dest: { value: togglePen },\n        xform: xforms.copyIfTrue,\n        priority: 300\n      },\n      {\n        src: { value: togglePen },\n        dest: { value: paths.actions.cursor.drop },\n        xform: xforms.rising,\n        priority: 200\n      },\n      {\n        src: { value: togglePen },\n        dest: { value: paths.actions.pen.remove },\n        xform: xforms.rising,\n        priority: 200\n      },\n      {\n        src: {\n          value: dpadEast,\n          bool: touchpadRising\n        },\n        dest: {\n          value: paths.actions.cursor.penPrevColor\n        },\n        xform: xforms.copyIfTrue,\n        priority: 200\n      },\n      {\n        src: {\n          value: dpadWest,\n          bool: touchpadRising\n        },\n        dest: {\n          value: paths.actions.cursor.penNextColor\n        },\n        xform: xforms.copyIfTrue,\n        priority: 200\n      },\n      {\n        src: {\n          value: dpadNorth,\n          bool: touchpadRising\n        },\n        dest: {\n          value: paths.actions.cursor.undoDrawing\n        },\n        xform: xforms.copyIfTrue,\n        priority: 200\n      }\n    ],\n\n    [sets.cursorHoldingCamera]: [\n      {\n        src: {\n          value: triggerRising\n        },\n        dest: { value: paths.actions.cursor.takeSnapshot },\n        xform: xforms.copy,\n        priority: 300\n      }\n    ]\n  });\n}\n","import { sets } from \"./sets\";\n\nlet leftTeleporter, rightTeleporter;\n\nexport function resolveActionSets() {\n  leftTeleporter = leftTeleporter || document.querySelector(\"#player-left-controller\").components.teleporter;\n  rightTeleporter = rightTeleporter || document.querySelector(\"#player-right-controller\").components.teleporter;\n  const userinput = AFRAME.scenes[0].systems.userinput;\n  const { leftHand, rightHand, rightRemote } = AFRAME.scenes[0].systems.interaction.state;\n\n  userinput.toggleSet(sets.leftHandHoveringOnNothing, !leftHand.held && !leftHand.hovered);\n  userinput.toggleSet(\n    sets.leftHandHoveringOnPen,\n    !leftHand.held &&\n      leftHand.hovered &&\n      leftHand.hovered.components.tags &&\n      leftHand.hovered.components.tags.data.isPen\n  );\n  userinput.toggleSet(\n    sets.leftHandHoveringOnCamera,\n    !leftHand.held && leftHand.hovered && leftHand.hovered.components[\"camera-tool\"]\n  );\n  userinput.toggleSet(\n    sets.leftHandHoveringOnInteractable,\n    !leftHand.held &&\n      (leftHand.hovered &&\n        ((leftHand.hovered.components.tags && leftHand.hovered.components.tags.data.offersRemoteConstraint) ||\n          leftHand.hovered.components[\"super-spawner\"]))\n  );\n  userinput.toggleSet(\n    sets.leftHandHoveringOnVideo,\n    !leftHand.held && leftHand.hovered && leftHand.hovered.components[\"media-video\"]\n  );\n  userinput.toggleSet(\n    sets.leftHandHoldingPen,\n    leftHand.held && leftHand.held.components.tags && leftHand.held.components.tags.data.isPen\n  );\n  userinput.toggleSet(sets.leftHandHoldingCamera, leftHand.held && leftHand.held.components[\"camera-tool\"]);\n  userinput.toggleSet(sets.leftHandHoldingInteractable, leftHand.held);\n\n  userinput.toggleSet(\n    sets.rightHandHoveringOnNothing,\n    !rightRemote.held && !rightRemote.hovered && !rightHand.held && !rightHand.hovered\n  );\n  userinput.toggleSet(\n    sets.rightHandHoveringOnPen,\n    !rightHand.held &&\n      rightHand.hovered &&\n      rightHand.hovered.components.tags &&\n      rightHand.hovered.components.tags.data.isPen\n  );\n  userinput.toggleSet(\n    sets.rightHandHoveringOnCamera,\n    !rightHand.held && rightHand.hovered && rightHand.hovered.components[\"camera-tool\"]\n  );\n  userinput.toggleSet(\n    sets.rightHandHoveringOnInteractable,\n    !rightHand.held &&\n      (rightHand.hovered &&\n        ((rightHand.hovered.components.tags && rightHand.hovered.components.tags.data.offersRemoteConstraint) ||\n          rightHand.hovered.components[\"super-spawner\"]))\n  );\n  userinput.toggleSet(\n    sets.rightHandHoveringOnVideo,\n    !rightHand.held && rightHand.hovered && rightHand.hovered.components[\"media-video\"]\n  );\n  userinput.toggleSet(\n    sets.rightHandHoldingPen,\n    rightHand.held && rightHand.held.components.tags && rightHand.held.components.tags.data.isPen\n  );\n  userinput.toggleSet(sets.rightHandHoldingCamera, rightHand.held && rightHand.held.components[\"camera-tool\"]);\n  userinput.toggleSet(sets.rightHandHoldingInteractable, rightHand.held);\n\n  userinput.toggleSet(\n    sets.cursorHoveringOnNothing,\n    !rightHand.held && !rightHand.hovered && !rightRemote.held && !rightRemote.hovered\n  );\n  userinput.toggleSet(\n    sets.cursorHoveringOnPen,\n    !rightHand.held &&\n      !rightHand.hovered &&\n      !rightRemote.held &&\n      rightRemote.hovered &&\n      rightRemote.hovered.components.tags &&\n      rightRemote.hovered.components.tags.data.isPen\n  );\n  userinput.toggleSet(\n    sets.cursorHoveringOnCamera,\n\n    !rightHand.held &&\n      !rightHand.hovered &&\n      !rightRemote.held &&\n      rightRemote.hovered &&\n      rightRemote.hovered.components[\"camera-tool\"]\n  );\n  userinput.toggleSet(\n    sets.cursorHoveringOnInteractable,\n    !rightHand.held &&\n      !rightHand.hovered &&\n      !rightRemote.held &&\n      rightRemote.hovered &&\n      ((rightRemote.hovered.components.tags && rightRemote.hovered.components.tags.data.offersRemoteConstraint) ||\n        rightRemote.hovered.components[\"super-spawner\"])\n  );\n  userinput.toggleSet(\n    sets.cursorHoveringOnUI,\n    !rightHand.held &&\n      !rightHand.hovered &&\n      !rightRemote.held &&\n      rightRemote.hovered &&\n      (rightRemote.hovered.components.tags &&\n        (rightRemote.hovered.components.tags.data.singleActionButton ||\n          rightRemote.hovered.components.tags.data.holdableButton))\n  );\n  userinput.toggleSet(\n    sets.cursorHoveringOnVideo,\n    !rightHand.held &&\n      !rightHand.hovered &&\n      !rightRemote.held &&\n      rightRemote.hovered &&\n      rightRemote.hovered.components[\"media-video\"]\n  );\n\n  userinput.toggleSet(\n    sets.cursorHoldingPen,\n\n    !rightHand.held &&\n      !rightHand.hovered &&\n      rightRemote.held &&\n      rightRemote.held.components.tags &&\n      rightRemote.held.components.tags.data.isPen\n  );\n  userinput.toggleSet(\n    sets.cursorHoldingCamera,\n    !rightHand.held && !rightHand.hovered && rightRemote.held && rightRemote.held.components[\"camera-tool\"]\n  );\n  userinput.toggleSet(\n    sets.cursorHoldingUI,\n    !rightHand.held &&\n      !rightHand.hovered &&\n      rightRemote.held &&\n      rightRemote.held.components.tags &&\n      rightRemote.held.components.tags.data.holdableButton\n  );\n  userinput.toggleSet(sets.cursorHoldingInteractable, rightRemote.held);\n\n  userinput.toggleSet(sets.leftHandTeleporting, leftTeleporter.isTeleporting);\n  userinput.toggleSet(sets.rightHandTeleporting, rightTeleporter.isTeleporting);\n\n  userinput.toggleSet(\n    sets.inputFocused,\n    document.activeElement.nodeName === \"INPUT\" || document.activeElement.nodeName === \"TEXTAREA\"\n  );\n}\n","import { paths } from \"../paths\";\n\nexport class GamepadDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n  }\n\n  write(frame) {\n    if (this.gamepad.connected) {\n      this.gamepad.buttons.forEach((button, i) => {\n        const buttonPath = paths.device.gamepad(this.gamepad.index).button(i);\n        frame.setValueType(buttonPath.pressed, !!button.pressed);\n        frame.setValueType(buttonPath.touched, !!button.touched);\n        frame.setValueType(buttonPath.value, button.value);\n      });\n      this.gamepad.axes.forEach((axis, i) => {\n        frame.setValueType(paths.device.gamepad(this.gamepad.index).axis(i), axis);\n      });\n    }\n  }\n}\n","export const gamepadBindings = {};\n","import { sets } from \"./sets\";\nimport { paths } from \"./paths\";\n\nimport { MouseDevice } from \"./devices/mouse\";\nimport { KeyboardDevice } from \"./devices/keyboard\";\nimport { HudDevice } from \"./devices/hud\";\nimport { XboxControllerDevice } from \"./devices/xbox-controller\";\nimport { OculusGoControllerDevice } from \"./devices/oculus-go-controller\";\nimport { GearVRControllerDevice } from \"./devices/gear-vr-controller\";\nimport { OculusTouchControllerDevice } from \"./devices/oculus-touch-controller\";\nimport { DaydreamControllerDevice } from \"./devices/daydream-controller\";\nimport { ViveControllerDevice } from \"./devices/vive-controller\";\nimport { WindowsMixedRealityControllerDevice } from \"./devices/windows-mixed-reality-controller\";\nimport { GyroDevice } from \"./devices/gyro\";\n\nimport { AppAwareMouseDevice } from \"./devices/app-aware-mouse\";\nimport { AppAwareTouchscreenDevice } from \"./devices/app-aware-touchscreen\";\n\nimport { keyboardMouseUserBindings } from \"./bindings/keyboard-mouse-user\";\nimport { touchscreenUserBindings } from \"./bindings/touchscreen-user\";\nimport { keyboardDebuggingBindings } from \"./bindings/keyboard-debugging\";\nimport { oculusTouchUserBindings } from \"./bindings/oculus-touch-user\";\nimport { viveUserBindings } from \"./bindings/vive-user\";\nimport { wmrUserBindings } from \"./bindings/windows-mixed-reality-user\";\nimport { xboxControllerUserBindings } from \"./bindings/xbox-controller-user\";\nimport { daydreamUserBindings } from \"./bindings/daydream-user\";\nimport { cardboardUserBindings } from \"./bindings/cardboard-user\";\n\nimport generate3DOFTriggerBindings from \"./bindings/oculus-go-user\";\nconst oculusGoUserBindings = generate3DOFTriggerBindings(paths.device.oculusgo);\nconst gearVRControllerUserBindings = generate3DOFTriggerBindings(paths.device.gearVRController);\n\nimport { resolveActionSets } from \"./resolve-action-sets\";\nimport { GamepadDevice } from \"./devices/gamepad\";\nimport { gamepadBindings } from \"./bindings/generic-gamepad\";\nimport { getAvailableVREntryTypes, VR_DEVICE_AVAILABILITY } from \"../../utils/vr-caps-detect\";\nimport { ArrayBackedSet } from \"./array-backed-set\";\n\nfunction arrayContentsDiffer(a, b) {\n  if (a.length !== b.length) return true;\n\n  for (let i = 0, il = a.length; i < il; i++) {\n    const elem = a[i];\n    let found = false;\n\n    for (let j = 0, jl = b.length; j < jl; j++) {\n      if (elem === b[j]) {\n        found = true;\n        break;\n      }\n    }\n\n    if (!found) return true;\n  }\n\n  return false;\n}\n\nconst satisfiesPath = (binding, path) => {\n  for (const key in binding.dest) {\n    if (binding.dest[key].indexOf(path) !== -1) {\n      return true;\n    }\n  }\n  return false;\n};\n\nconst satisfyPath = (bindings, path) => {\n  for (const binding of bindings) {\n    if (satisfiesPath(binding, path)) {\n      return true;\n    }\n  }\n  return false;\n};\n\nconst satisfiedBy = (binding, bindings) => {\n  for (const path of Object.values(binding.src)) {\n    if (path.startsWith(\"/device/\")) continue;\n    if (!satisfyPath(bindings, path)) return false;\n  }\n  return true;\n};\n\nfunction dependencySort(mappings) {\n  const unsorted = [];\n  for (const mapping of mappings) {\n    for (const setName in mapping) {\n      for (const binding of mapping[setName]) {\n        unsorted.push(binding);\n      }\n    }\n  }\n\n  const sorted = [];\n  while (unsorted.length > 0) {\n    const binding = unsorted.shift();\n    if (satisfiedBy(binding, sorted)) {\n      sorted.push(binding);\n    } else {\n      unsorted.push(binding);\n    }\n  }\n\n  return sorted;\n}\n\nfunction canMask(masker, masked) {\n  if (masker.priority === undefined) {\n    masker.priority = 0;\n  }\n  if (masked.priority === undefined) {\n    masked.priority = 0;\n  }\n  if (masked.priority >= masker.priority) return false;\n  for (const maskerKey in masker.src) {\n    const maskerPath = masker.src[maskerKey];\n    for (const maskedKey in masked.src) {\n      const maskedPath = masked.src[maskedKey];\n      if (maskedPath.indexOf(maskerPath) !== -1) {\n        return true;\n      }\n    }\n  }\n  return false;\n}\n\nfunction computeMasks(bindings) {\n  const masks = new Array(bindings.length);\n  for (let row = 0; row < bindings.length; row++) {\n    const masksRow = (masks[row] = []);\n    const bindingsRow = bindings[row];\n    for (let col = 0; col < bindings.length; col++) {\n      if (canMask(bindings[col], bindingsRow)) {\n        masksRow.push(col);\n      }\n    }\n  }\n  return masks;\n}\n\nfunction isActive(binding, sets) {\n  for (let i = 0; i < binding.sets.length; i++) {\n    if (sets.includes(binding.sets[i])) {\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction computeExecutionStrategy(sortedBindings, masks, activeSets) {\n  const actives = new Array(sortedBindings.length);\n  for (let row = 0; row < sortedBindings.length; row++) {\n    actives[row] = isActive(sortedBindings[row], activeSets);\n  }\n\n  const masked = new Array(sortedBindings.length);\n  for (let row = 0; row < sortedBindings.length; row++) {\n    const maskedRow = (masked[row] = []);\n    const masksRow = masks[row];\n    for (let col = 0; col < sortedBindings.length; col++) {\n      if (actives[col] && masksRow.indexOf(col) !== -1) {\n        maskedRow.push(col);\n      }\n    }\n  }\n\n  return { actives, masked };\n}\n\nAFRAME.registerSystem(\"userinput\", {\n  get(path) {\n    if (!this.frame) return;\n    return this.frame.get(path);\n  },\n\n  toggleSet(set, value) {\n    this.pendingSetChanges.push(set);\n    this.pendingSetChanges.push(!!value);\n  },\n\n  init() {\n    this.frame = {\n      generation: 0,\n      values: {},\n      generations: {},\n      get: function(path) {\n        if (this.generations[path] !== this.generation) return undefined;\n        return this.values[path];\n      },\n      setValueType: function(path, value) {\n        this.values[path] = value;\n        this.generations[path] = this.generation;\n      },\n      setVector2: function(path, a, b) {\n        const value = this.values[path] || [];\n        value[0] = a;\n        value[1] = b;\n        this.values[path] = value;\n        this.generations[path] = this.generation;\n      },\n      setPose: function(path, pose) {\n        this.setValueType(path, pose);\n      },\n      setMatrix4: function(path, mat4) {\n        // Should we assume the incoming mat4 is safe to store instead of copying values?\n        const value = this.values[path] || new THREE.Matrix4();\n        value.copy(mat4);\n        this.values[path] = value;\n        this.generations[path] = this.generation;\n      }\n    };\n\n    this.prevActiveSets = [];\n    this.activeSets = [sets.global];\n    this.pendingSetChanges = [];\n    this.xformStates = new Map();\n    this.activeDevices = new ArrayBackedSet([new HudDevice()]);\n\n    const isMobile = AFRAME.utils.device.isMobile();\n    const isMobileVR = AFRAME.utils.device.isMobileVR();\n\n    if (!(isMobile || isMobileVR)) {\n      this.activeDevices.add(new MouseDevice());\n      this.activeDevices.add(new AppAwareMouseDevice());\n      this.activeDevices.add(new KeyboardDevice());\n    } else if (!isMobileVR) {\n      this.activeDevices.add(new AppAwareTouchscreenDevice());\n      this.activeDevices.add(new KeyboardDevice());\n      this.activeDevices.add(new GyroDevice());\n    }\n\n    this.registeredMappings = new Set([keyboardDebuggingBindings]);\n    this.registeredMappingsChanged = true;\n\n    const vrGamepadMappings = new Map();\n    vrGamepadMappings.set(WindowsMixedRealityControllerDevice, wmrUserBindings);\n    vrGamepadMappings.set(ViveControllerDevice, viveUserBindings);\n    vrGamepadMappings.set(OculusTouchControllerDevice, oculusTouchUserBindings);\n    vrGamepadMappings.set(OculusGoControllerDevice, oculusGoUserBindings);\n    vrGamepadMappings.set(GearVRControllerDevice, gearVRControllerUserBindings);\n    vrGamepadMappings.set(DaydreamControllerDevice, daydreamUserBindings);\n\n    const nonVRGamepadMappings = new Map();\n    nonVRGamepadMappings.set(XboxControllerDevice, xboxControllerUserBindings);\n    nonVRGamepadMappings.set(GamepadDevice, gamepadBindings);\n\n    const updateBindingsForVRMode = () => {\n      const inVRMode = this.el.sceneEl.is(\"vr-mode\");\n      const isMobile = AFRAME.utils.device.isMobile();\n\n      if (inVRMode) {\n        console.log(\"Using VR bindings.\");\n        this.registeredMappings.delete(isMobile ? touchscreenUserBindings : keyboardMouseUserBindings);\n        // add mappings for all active VR input devices\n        for (let i = 0; i < this.activeDevices.items.length; i++) {\n          const activeDevice = this.activeDevices.items[i];\n          const mapping = vrGamepadMappings.get(activeDevice.constructor);\n          mapping && this.registeredMappings.add(mapping);\n        }\n\n        // Handle cardboard by looking of VR device caps\n        if (isMobile) {\n          getAvailableVREntryTypes().then(availableVREntryTypes => {\n            if (availableVREntryTypes.cardboard === VR_DEVICE_AVAILABILITY.yes) {\n              this.registeredMappings.add(cardboardUserBindings);\n              this.registeredMappingsChanged = true;\n            }\n          });\n        }\n      } else {\n        console.log(\"Using Non-VR bindings.\");\n        // remove mappings for all active VR input devices\n        for (let i = 0; i < this.activeDevices.items.length; i++) {\n          const activeDevice = this.activeDevices.items[i];\n          this.registeredMappings.delete(vrGamepadMappings.get(activeDevice.constructor));\n        }\n        this.registeredMappings.add(isMobile ? touchscreenUserBindings : keyboardMouseUserBindings);\n      }\n\n      for (let i = 0; i < this.activeDevices.items.length; i++) {\n        const activeDevice = this.activeDevices.items[i];\n        const mapping = nonVRGamepadMappings.get(activeDevice.constructor);\n        mapping && this.registeredMappings.add(mapping);\n      }\n\n      this.registeredMappingsChanged = true;\n    };\n\n    const gamepadConnected = e => {\n      let gamepadDevice;\n      for (let i = 0; i < this.activeDevices.items.length; i++) {\n        const activeDevice = this.activeDevices.items[i];\n        if (activeDevice.gamepad && activeDevice.gamepad.index === e.gamepad.index) {\n          console.warn(\"connected already fired for gamepad\", e.gamepad);\n          return; // multiple connect events without a disconnect event\n        }\n      }\n      // HACK Firefox Nightly bug causes corrupt gamepad names for OpenVR, so do startsWith\n      if (e.gamepad.id.startsWith(\"OpenVR Gamepad\") || e.gamepad.id === \"HTC Vive Focus Plus Controller\") {\n        gamepadDevice = new ViveControllerDevice(e.gamepad);\n      } else if (e.gamepad.id.startsWith(\"Oculus Touch\")) {\n        gamepadDevice = new OculusTouchControllerDevice(e.gamepad);\n      } else if (e.gamepad.id.startsWith(\"Spatial Controller\")) {\n        gamepadDevice = new WindowsMixedRealityControllerDevice(e.gamepad);\n      } else if (e.gamepad.id === \"Oculus Go Controller\") {\n        gamepadDevice = new OculusGoControllerDevice(e.gamepad);\n      } else if (e.gamepad.id === \"Gear VR Controller\" || e.gamepad.id === \"HTC Vive Focus Controller\") {\n        gamepadDevice = new GearVRControllerDevice(e.gamepad);\n      } else if (e.gamepad.id === \"Daydream Controller\") {\n        gamepadDevice = new DaydreamControllerDevice(e.gamepad);\n      } else if (e.gamepad.id.includes(\"Xbox\")) {\n        gamepadDevice = new XboxControllerDevice(e.gamepad);\n      } else {\n        gamepadDevice = new GamepadDevice(e.gamepad);\n      }\n\n      this.activeDevices.add(gamepadDevice);\n\n      updateBindingsForVRMode();\n    };\n\n    const gamepadDisconnected = e => {\n      for (let i = 0; i < this.activeDevices.items.length; i++) {\n        const device = this.activeDevices.items[i];\n        if (device.gamepad && device.gamepad.index === e.gamepad.index) {\n          this.registeredMappings.delete(\n            vrGamepadMappings.get(device.constructor) || nonVRGamepadMappings.get(device.constructor)\n          );\n          this.activeDevices.delete(device);\n          return;\n        }\n      }\n\n      updateBindingsForVRMode();\n    };\n\n    window.addEventListener(\"gamepadconnected\", gamepadConnected, false);\n    window.addEventListener(\"gamepaddisconnected\", gamepadDisconnected, false);\n    for (const gamepad of navigator.getGamepads()) {\n      gamepad && gamepadConnected({ gamepad });\n    }\n\n    this.el.sceneEl.addEventListener(\"enter-vr\", updateBindingsForVRMode);\n    this.el.sceneEl.addEventListener(\"exit-vr\", updateBindingsForVRMode);\n\n    updateBindingsForVRMode();\n  },\n\n  tick2() {\n    this.frame.generation += 1;\n    const registeredMappingsChanged = this.registeredMappingsChanged;\n    if (registeredMappingsChanged) {\n      this.registeredMappingsChanged = false;\n      this.prevSortedBindings = this.sortedBindings;\n      this.sortedBindings = dependencySort(this.registeredMappings);\n      if (!this.prevSortedBindings) {\n        this.prevSortedBindings = this.sortedBindings;\n      }\n      this.masks = computeMasks(this.sortedBindings);\n    }\n\n    this.prevActiveSets.length = 0;\n    for (let i = 0; i < this.activeSets.length; i++) {\n      const item = this.activeSets[i];\n      this.prevActiveSets.push(item);\n    }\n    resolveActionSets();\n    for (let i = 0, l = this.pendingSetChanges.length; i < l; i += 2) {\n      const set = this.pendingSetChanges[i];\n      const value = this.pendingSetChanges[i + 1];\n\n      if (value) {\n        if (!this.activeSets.includes(set)) {\n          this.activeSets.push(set);\n        }\n      } else {\n        const idx = this.activeSets.indexOf(set);\n\n        if (idx > -1) {\n          this.activeSets.splice(idx, 1);\n        }\n      }\n    }\n    const activeSetsChanged = arrayContentsDiffer(this.prevActiveSets, this.activeSets);\n    this.pendingSetChanges.length = 0;\n    if (registeredMappingsChanged || activeSetsChanged || (!this.actives && !this.masked)) {\n      this.prevActives = this.actives;\n      this.prevMasked = this.masked;\n      const { actives, masked } = computeExecutionStrategy(this.sortedBindings, this.masks, this.activeSets);\n      this.actives = actives;\n      this.masked = masked;\n    }\n\n    for (let i = 0; i < this.activeDevices.items.length; i++) {\n      this.activeDevices.items[i].write(this.frame);\n    }\n\n    for (let i = 0; i < this.sortedBindings.length; i++) {\n      if (!this.actives[i] || this.masked[i].length > 0) continue;\n\n      const binding = this.sortedBindings[i];\n\n      let bindingExistedLastFrame = true;\n      if (!registeredMappingsChanged && activeSetsChanged && this.prevSortedBindings) {\n        const j = this.prevSortedBindings.indexOf(binding);\n        bindingExistedLastFrame = j > -1 && this.prevActives[j] && this.prevMasked[j].length === 0;\n      }\n      if (!bindingExistedLastFrame) {\n        this.xformStates.delete(binding);\n      }\n\n      const { src, dest, xform, debug } = binding;\n\n      let oldValue;\n\n      if (debug) {\n        oldValue = this.frame.get(dest.value);\n      }\n\n      const newState = xform(this.frame, src, dest, this.xformStates.get(binding));\n\n      if (debug) {\n        // Note for now this only works with bindings that have { value: } sources and dests\n        console.log(\n          `${JSON.stringify(src.value)} (${src.value && JSON.stringify(this.frame.get(src.value))}) to ${JSON.stringify(\n            dest\n          )}: ${oldValue} -> ${this.frame.get(dest.value)}`\n        );\n      }\n\n      if (newState !== undefined) {\n        this.xformStates.set(binding, newState);\n      }\n    }\n\n    this.prevSortedBindings = this.sortedBindings;\n  }\n});\n","import { paths } from \"./userinput/paths\";\n\nAFRAME.registerSystem(\"camera-mirror\", {\n  init() {\n    this._onWindowResize = this._onWindowResize.bind(this);\n    window.addEventListener(\"resize\", this._onWindowResize, false);\n  },\n\n  tick() {\n    const userinput = this.el.systems.userinput;\n\n    if (userinput.get(paths.actions.camera.exitMirror) && this.mirrorEl) {\n      this.unmirrorCameraAtEl(this.mirrorEl);\n    }\n  },\n\n  // Adds a camera under el, and starts mirroring\n  mirrorCameraAtEl(el) {\n    // TODO probably should explicitly check for immersive mode here.\n    if (AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR()) return;\n    if (this.mirrorEl && this.mirrorEl !== el) this.unmirrorCameraAtEl(this.mirrorEl);\n\n    this.mirrorEl = el;\n    this.mirrorCamera = new THREE.PerspectiveCamera(80, window.innerWidth / window.innerHeight, 0.1, 30000);\n    this.mirrorCamera.rotation.set(0, Math.PI, 0);\n    el.setObject3D(\"mirror-camera\", this.mirrorCamera);\n\n    document.body.classList.add(\"mirrored-camera\");\n\n    if (!this.directRenderFunc) {\n      this._patchRenderFunc();\n    }\n\n    this.mirrorEl.emit(\"mirrored\", { el: this.mirrorEl });\n    this.mirrorEl.sceneEl.addState(\"mirroring\");\n  },\n\n  unmirrorCameraAtEl(el) {\n    if (this.mirrorEl !== el) return;\n\n    el.removeObject3D(\"mirror-camera\");\n    document.body.classList.remove(\"mirrored-camera\");\n    const oldEl = this.mirrorEl;\n\n    this.mirrorEl = null;\n    this.mirrorCamera = null;\n\n    oldEl.emit(\"unmirrored\", { el: oldEl });\n    oldEl.sceneEl.removeState(\"mirroring\");\n  },\n\n  getMirroredCameraEl() {\n    return this.mirrorEl;\n  },\n\n  _onWindowResize() {\n    if (!this.mirrorCamera) return;\n    this.mirrorCamera.aspect = window.innerWidth / window.innerHeight;\n    this.mirrorCamera.updateProjectionMatrix();\n    this.el.sceneEl.renderer.setSize(window.innerWidth, window.innerHeight);\n  },\n\n  _patchRenderFunc() {\n    const headEl = document.getElementById(\"player-head\");\n    const hudEl = document.getElementById(\"player-hud\");\n    const tempHeadScale = new THREE.Vector3();\n    const renderer = this.el.renderer;\n    const playerHead = headEl && headEl.object3D;\n    const playerHud = hudEl && hudEl.object3D;\n\n    this.directRenderFunc = renderer.render;\n\n    this.el.sceneEl.renderer.render = (scene, camera, renderTarget) => {\n      const wasVREnabled = renderer.vr.enabled;\n\n      if (wasVREnabled || renderTarget || !this.mirrorCamera) {\n        this.directRenderFunc.call(renderer, scene, camera, renderTarget);\n        if (!this.mirrorCamera || renderTarget) return;\n      }\n\n      if (playerHead) {\n        tempHeadScale.copy(playerHead.scale);\n        playerHead.scale.set(1, 1, 1);\n        playerHead.updateMatrices(true, true);\n        playerHead.updateMatrixWorld(true, true);\n      }\n\n      let playerHudWasVisible;\n\n      if (playerHud) {\n        playerHudWasVisible = playerHud.visible;\n        playerHud.visible = false;\n      }\n      renderer.vr.enabled = false;\n      const tmpOnAfterRender = this.el.object3D.onAfterRender;\n      delete this.el.object3D.onAfterRender;\n      this.directRenderFunc.call(renderer, scene, this.mirrorCamera);\n      this.el.object3D.onAfterRender = tmpOnAfterRender;\n      renderer.vr.enabled = wasVREnabled;\n      if (playerHead) {\n        playerHead.scale.copy(tempHeadScale);\n        playerHead.updateMatrices(true, true);\n        playerHead.updateMatrixWorld(true);\n      }\n      if (playerHud) {\n        playerHud.visible = playerHudWasVisible;\n      }\n    };\n  }\n});\n","import { paths } from \"./paths\";\nimport qsTruthy from \"../../utils/qs_truthy\";\n\nAFRAME.registerSystem(\"userinput-debug\", {\n  active: true,\n\n  tick() {\n    if (!this.active) return;\n\n    const userinput = AFRAME.scenes[0].systems.userinput;\n\n    if (this.userinputFrameStatus) {\n      const replacer = (k, v) => {\n        if (typeof v === \"number\") {\n          return `${v >= 0 ? \"+\" : \"\"}${v.toFixed(3)}`;\n        }\n        return v;\n      };\n      const pathsOutput = [];\n      const { frame } = userinput;\n      for (const key in frame.values) {\n        if (!frame.get(key)) continue;\n        if (![\"/actions/\"].some(x => key.startsWith(x))) continue;\n        let val = JSON.stringify(frame.get(key), replacer);\n        if (val) val = val.replace(/{\"(\\w{3,})\":/g, '{\\n  \"$1\":').replace(/,\"(\\w{3,})\":/g, ',\\n  \"$1\":');\n        pathsOutput.push(`${key} -> ${val}`);\n      }\n      this.userinputFrameStatus.textContent = pathsOutput.join(\"\\n\");\n    }\n\n    if (userinput.get(paths.actions.logDebugFrame)) {\n      if (qsTruthy(\"userinput_debug\") && !this.userinputFrameStatus) {\n        this.userinputFrameStatus = document.createElement(\"div\");\n        this.userinputFrameStatus.id = \"userinput-frame-status\";\n        this.userinputFrameStatus.style = `\n          position: absolute;\n          left: 0; bottom: 0;\n          background: white;\n          white-space: pre;\n          font-family: monospace;\n          font-size: 8pt;\n        `;\n        document.body.append(this.userinputFrameStatus);\n      }\n\n      console.log(userinput);\n      console.log(\"sorted\", userinput.sortedBindings);\n      console.log(\"actives\", userinput.actives);\n      console.log(\"masks\", userinput.masks);\n      console.log(\"masked\", userinput.masked);\n      console.log(\"devices\", userinput.activeDevices);\n      console.log(\"activeSets\", userinput.activeSets);\n      console.log(\"frame\", userinput.frame);\n      console.log(\"xformStates\", userinput.xformStates);\n      const { sortedBindings, actives, masked } = userinput;\n      for (const i in sortedBindings) {\n        const sb = [];\n        if (masked[i].length > 0) {\n          for (const j of masked[i]) {\n            sb.push(JSON.stringify(sortedBindings[j]));\n          }\n        }\n\n        if (this.logBindings) {\n          console.log(\n            \"binding: \",\n            i,\n            \"\\n\",\n            sortedBindings[i],\n            \"\\n\",\n            \"dest: \",\n            sortedBindings[i].dest && Object.values(sortedBindings[i].dest),\n            \"\\n\",\n            \"active: \",\n            actives[i],\n            \"\\n\",\n            \"maskedBy: \",\n            masked[i],\n            \"\\n\",\n            sb.join(\"\\n\"),\n            \"\\n\"\n          );\n        }\n      }\n    }\n  }\n});\n","import { paths } from \"./userinput/paths\";\nimport { SOURCES } from \"../storage/media-search-store\";\n\nconst MEDIA_SEARCH_PATHS = [\n  paths.actions.mediaSearch1,\n  paths.actions.mediaSearch2,\n  paths.actions.mediaSearch3,\n  paths.actions.mediaSearch4,\n  paths.actions.mediaSearch5,\n  paths.actions.mediaSearch6,\n  paths.actions.mediaSearch7,\n  paths.actions.mediaSearch8\n];\n\n// Every frame, looks for input paths that trigger UI-relevant events and handles them.\nAFRAME.registerSystem(\"ui-hotkeys\", {\n  init() {\n    this.mediaSearchStore = window.APP.mediaSearchStore;\n  },\n\n  tick: function() {\n    if (!this.userinput) {\n      this.userinput = this.el.systems.userinput;\n    }\n\n    if (this.userinput.get(paths.actions.focusChat)) {\n      this.focusChat();\n    }\n\n    if (this.userinput.get(paths.actions.focusChatCommand)) {\n      this.focusChat(\"/\");\n    }\n\n    if (this.userinput.get(paths.actions.mediaExit)) {\n      if (window.APP.history.location.state.value !== \"avatar-editor\") {\n        this.mediaSearchStore.pushExitMediaBrowserHistory();\n      }\n    }\n\n    for (let i = 0; i < MEDIA_SEARCH_PATHS.length; i++) {\n      if (this.userinput.get(MEDIA_SEARCH_PATHS[i])) {\n        this.mediaSearchStore.sourceNavigate(SOURCES[i]);\n      }\n    }\n\n    if (this.userinput.get(paths.actions.toggleCamera)) {\n      this.el.emit(\"action_toggle_camera\");\n    }\n  },\n\n  focusChat: function(prefix) {\n    const target = document.querySelector(\".chat-focus-target\");\n    if (!target) return;\n\n    target.focus();\n\n    if (prefix) {\n      target.value = prefix;\n    }\n  }\n});\n","/* global AFRAME Ammo NAF */\nimport { paths } from \"./userinput/paths\";\nimport { SOUND_HOVER_OR_GRAB } from \"./sound-effects-system\";\n\nfunction findHandCollisionTargetForHand(body) {\n  const driver = AFRAME.scenes[0].systems.physics.driver;\n  const numManifolds = driver.dispatcher.getNumManifolds();\n  const handPtr = Ammo.getPointer(body);\n  for (let i = 0; i < numManifolds; i++) {\n    const persistentManifold = driver.dispatcher.getManifoldByIndexInternal(i);\n    const body0ptr = Ammo.getPointer(persistentManifold.getBody0());\n    const body1ptr = Ammo.getPointer(persistentManifold.getBody1());\n    if (handPtr !== body0ptr && handPtr !== body1ptr) {\n      continue;\n    }\n    const numContacts = persistentManifold.getNumContacts();\n    for (let j = 0; j < numContacts; j++) {\n      const manifoldPoint = persistentManifold.getContactPoint(j);\n      if (manifoldPoint.getDistance() <= 10e-6) {\n        const object3D = driver.els.get(handPtr === body0ptr ? body1ptr : body0ptr).object3D;\n        if (object3D.el && object3D.el.components.tags && object3D.el.components.tags.data.isHandCollisionTarget) {\n          return object3D.el;\n        }\n        return null;\n      }\n    }\n  }\n  return null;\n}\n\nconst remoteHoverTargets = new Map();\nfunction findRemoteHoverTarget(object3D) {\n  if (!object3D) return null;\n  const target = remoteHoverTargets.get(object3D);\n  return target || findRemoteHoverTarget(object3D.parent);\n}\nAFRAME.registerComponent(\"is-remote-hover-target\", {\n  init: function() {\n    remoteHoverTargets.set(this.el.object3D, this.el);\n  },\n  remove: function() {\n    remoteHoverTargets.delete(this.el.object3D);\n  }\n});\n\nfunction isUI(el) {\n  return (\n    el && el.components.tags && (el.components.tags.data.singleActionButton || el.components.tags.data.holdableButton)\n  );\n}\n\nAFRAME.registerSystem(\"interaction\", {\n  updateCursorIntersection: function(intersection) {\n    this.rightRemoteHoverTarget = intersection && findRemoteHoverTarget(intersection.object);\n  },\n\n  isHeld(el) {\n    return this.state.leftHand.held === el || this.state.rightHand.held === el || this.state.rightRemote.held === el;\n  },\n\n  init: function() {\n    this.options = {\n      leftHand: {\n        entity: document.querySelector(\"#player-left-controller\"),\n        grabPath: paths.actions.leftHand.grab,\n        dropPath: paths.actions.leftHand.drop,\n        hoverFn: findHandCollisionTargetForHand\n      },\n      rightHand: {\n        entity: document.querySelector(\"#player-right-controller\"),\n        grabPath: paths.actions.rightHand.grab,\n        dropPath: paths.actions.rightHand.drop,\n        hoverFn: findHandCollisionTargetForHand\n      },\n      rightRemote: {\n        entity: document.querySelector(\"#cursor\"),\n        grabPath: paths.actions.cursor.grab,\n        dropPath: paths.actions.cursor.drop,\n        hoverFn: this.getRightRemoteHoverTarget\n      }\n    };\n    this.state = {\n      leftHand: {\n        hovered: null,\n        held: null,\n        spawning: null\n      },\n      rightHand: {\n        hovered: null,\n        held: null,\n        spawning: null\n      },\n      rightRemote: {\n        hovered: null,\n        held: null,\n        spawning: null\n      }\n    };\n    this.previousState = {\n      leftHand: {\n        hovered: null,\n        held: null,\n        spawning: null\n      },\n      rightHand: {\n        hovered: null,\n        held: null,\n        spawning: null\n      },\n      rightRemote: {\n        hovered: null,\n        held: null,\n        spawning: null\n      }\n    };\n\n    this.cursorController = document.querySelector(\"#cursor-controller\");\n  },\n\n  getRightRemoteHoverTarget() {\n    return this.rightRemoteHoverTarget;\n  },\n\n  tickInteractor(options, state) {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    if (state.held) {\n      const networked = state.held.components[\"networked\"];\n      const lostOwnership = networked && networked.data && networked.data.owner !== NAF.clientId;\n      if (userinput.get(options.dropPath) || lostOwnership) {\n        state.held = null;\n      }\n    } else {\n      state.hovered = options.hoverFn.call(this, options.entity.body);\n      if (\n        state.hovered &&\n        state.hovered.components.tags &&\n        state.hovered.components.tags.data.isHoldable &&\n        userinput.get(options.grabPath) &&\n        (this.el.is(\"frozen\") || !state.hovered.components.pinnable || !state.hovered.components.pinnable.data.pinned)\n      ) {\n        state.held = state.hovered;\n      }\n    }\n  },\n\n  tick2(sfx) {\n    if (!this.el.is(\"entered\")) return;\n\n    Object.assign(this.previousState.rightHand, this.state.rightHand);\n    Object.assign(this.previousState.rightRemote, this.state.rightRemote);\n    Object.assign(this.previousState.leftHand, this.state.leftHand);\n\n    this.rightHandTeleporter =\n      this.rightHandTeleporter || document.querySelector(\"#player-right-controller\").components[\"teleporter\"];\n    this.gazeTeleporter = this.gazeTeleporter || document.querySelector(\"#gaze-teleport\").components[\"teleporter\"];\n\n    if (this.options.leftHand.entity.object3D.visible) {\n      this.tickInteractor(this.options.leftHand, this.state.leftHand);\n    }\n    if (this.options.rightHand.entity.object3D.visible && !this.state.rightRemote.held) {\n      this.tickInteractor(this.options.rightHand, this.state.rightHand);\n    }\n\n    if (!this.state.rightHand.held && !this.state.rightHand.hovered) {\n      this.tickInteractor(this.options.rightRemote, this.state.rightRemote);\n    }\n\n    const enableRightRemote =\n      !this.state.rightHand.hovered &&\n      !this.state.rightHand.held &&\n      !this.rightHandTeleporter.isTeleporting &&\n      !this.gazeTeleporter.isTeleporting;\n    this.cursorController.components[\"cursor-controller\"].enabled = enableRightRemote;\n    if (!enableRightRemote) {\n      this.state.rightRemote.hovered = null;\n    }\n\n    if (\n      this.state.leftHand.held !== this.previousState.leftHand.held ||\n      this.state.rightHand.held !== this.previousState.rightHand.held ||\n      this.state.rightRemote.held !== this.previousState.rightRemote.held ||\n      (isUI(this.state.rightRemote.hovered) &&\n        this.state.rightRemote.hovered !== this.previousState.rightRemote.hovered)\n    ) {\n      sfx.playSoundOneShot(SOUND_HOVER_OR_GRAB);\n    }\n\n    if (this.el.systems.userinput.get(paths.actions.logInteractionState)) {\n      console.log(\n        \"Interaction System State\\nleftHand held\",\n        this.state.leftHand.held,\n        \"\\nleftHand hovered\",\n        this.state.leftHand.hovered,\n        \"\\nrightHand held\",\n        this.state.rightHand.held,\n        \"\\nrightHand hovered\",\n        this.state.rightHand.hovered,\n        \"\\nrightRemote held\",\n        this.state.rightRemote.held,\n        \"\\nrightRemote hovered\",\n        this.state.rightRemote.hovered\n      );\n    }\n  }\n});\n","export class CursorTargettingSystem {\n  constructor() {\n    this.targets = [];\n    this.setDirty = this.setDirty.bind(this);\n    this.dirty = true;\n    // TODO: Use the MutationRecords passed into the callback function to determine added/removed nodes!\n    this.observer = new MutationObserver(this.setDirty);\n    const scene = document.querySelector(\"a-scene\");\n    this.observer.observe(scene, { childList: true, attributes: true, subtree: true });\n    scene.addEventListener(\"object3dset\", this.setDirty);\n    scene.addEventListener(\"object3dremove\", this.setDirty);\n    this.rightRemote = document.querySelector(\"#cursor-controller\");\n  }\n\n  setDirty() {\n    this.dirty = true;\n  }\n\n  tick(t) {\n    if (this.dirty) {\n      this.populateEntities(this.targets);\n      this.dirty = false;\n    }\n\n    this.rightRemote.components[\"cursor-controller\"].tick2(t);\n  }\n\n  populateEntities(targets) {\n    targets.length = 0;\n    // TODO: Do not querySelectorAll on the entire scene every time anything changes!\n    const els = AFRAME.scenes[0].querySelectorAll(\".collidable, .interactable, .ui\");\n    for (let i = 0; i < els.length; i++) {\n      if (els[i].object3D) {\n        targets.push(els[i].object3D);\n      }\n    }\n  }\n\n  remove() {\n    this.observer.disconnect();\n    AFRAME.scenes[0].removeEventListener(\"object3dset\", this.setDirty);\n    AFRAME.scenes[0].removeEventListener(\"object3dremove\", this.setDirty);\n  }\n}\n","/* global NAF AFRAME */\nconst ACTIVATION_STATE = require(\"aframe-physics-system/src/constants\").ACTIVATION_STATE;\n\nexport class ConstraintsSystem {\n  constructor() {\n    this.prevLeftHand = {\n      held: null,\n      hovered: null,\n      spawning: null\n    };\n    this.prevRightHand = {\n      held: null,\n      hovered: null,\n      spawning: null\n    };\n    this.prevRightRemote = {\n      held: null,\n      hovered: null,\n      spawning: null\n    };\n  }\n\n  tickInteractor(constraintTag, entityId, state, prevState) {\n    if (prevState.held === state.held) {\n      if (!state.spawning && prevState.spawning && state.held && state.held.components.tags.data[constraintTag]) {\n        state.held.setAttribute(\"ammo-body\", {\n          type: \"dynamic\",\n          activationState: ACTIVATION_STATE.DISABLE_DEACTIVATION\n        });\n        state.held.setAttribute(\"ammo-constraint__\" + entityId, { target: \"#\" + entityId });\n      }\n      return;\n    }\n    if (prevState.held && prevState.held.components.tags.data[constraintTag]) {\n      prevState.held.removeAttribute(\"ammo-constraint__\" + entityId);\n      let hasAnotherConstraint = false;\n      for (const componentName in prevState.held.components) {\n        if (componentName.startsWith(\"ammo-constraint\")) {\n          hasAnotherConstraint = true;\n        }\n      }\n      if (!hasAnotherConstraint) {\n        prevState.held.setAttribute(\"ammo-body\", { activationState: ACTIVATION_STATE.ACTIVE_TAG });\n      }\n    }\n    if (!state.spawning && state.held && state.held.components.tags.data[constraintTag]) {\n      if (!state.held.components[\"networked\"] || NAF.utils.isMine(state.held) || NAF.utils.takeOwnership(state.held)) {\n        state.held.setAttribute(\"ammo-body\", {\n          type: \"dynamic\",\n          activationState: ACTIVATION_STATE.DISABLE_DEACTIVATION\n        });\n        state.held.setAttribute(\"ammo-constraint__\" + entityId, { target: \"#\" + entityId });\n      } else {\n        console.log(\"Failed to obtain ownership while trying to create constraint on networked object.\");\n      }\n    }\n  }\n\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n\n    this.tickInteractor(\n      \"offersHandConstraint\",\n      interaction.options.leftHand.entity.id,\n      interaction.state.leftHand,\n      this.prevLeftHand\n    );\n    this.tickInteractor(\n      \"offersHandConstraint\",\n      interaction.options.rightHand.entity.id,\n      interaction.state.rightHand,\n      this.prevRightHand\n    );\n    this.tickInteractor(\n      \"offersRemoteConstraint\",\n      interaction.options.rightRemote.entity.id,\n      interaction.state.rightRemote,\n      this.prevRightRemote\n    );\n\n    Object.assign(this.prevLeftHand, interaction.state.leftHand);\n    Object.assign(this.prevRightHand, interaction.state.rightHand);\n    Object.assign(this.prevRightRemote, interaction.state.rightRemote);\n  }\n}\n","/* global THREE AFRAME */\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\nconst COLLISION_FILTER_MASK_HANDS = { collisionFilterMask: COLLISION_LAYERS.HANDS };\nexport const distanceBetweenStretchers = (() => {\n  const a = new THREE.Vector3();\n  const b = new THREE.Vector3();\n  return function distanceBetweenStretchers(obj1, obj2) {\n    obj1.getWorldPosition(a);\n    obj2.getWorldPosition(b);\n    return a.distanceTo(b);\n  };\n})();\n\nexport class TwoPointStretchingSystem {\n  constructor() {\n    this.initialScale = new THREE.Vector3();\n  }\n\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const { leftHand, rightHand, rightRemote } = interaction.state;\n\n    const stretching = leftHand.held && (leftHand.held === rightHand.held || leftHand.held === rightRemote.held);\n    let leftStretcher, rightStretcher;\n    if (stretching) {\n      leftStretcher = interaction.options.leftHand.entity.object3D;\n      rightStretcher =\n        leftHand.held === rightHand.held\n          ? interaction.options.rightHand.entity.object3D\n          : interaction.options.rightRemote.entity.object3D;\n      if (\n        leftStretcher !== this.previousLeftStretcher ||\n        rightStretcher !== this.previousRightStretcher ||\n        leftHand.held !== this.stretched\n      ) {\n        this.initialStretchDistance = distanceBetweenStretchers(leftStretcher, rightStretcher);\n        this.stretched = leftHand.held;\n        this.initialScale.copy(this.stretched.object3D.scale);\n        if (this.stretched.components[\"ammo-body\"]) {\n          this.stretched.setAttribute(\"ammo-body\", COLLISION_FILTER_MASK_HANDS);\n        }\n      }\n\n      this.stretched.object3D.scale\n        .copy(this.initialScale)\n        .multiplyScalar(distanceBetweenStretchers(leftStretcher, rightStretcher) / this.initialStretchDistance);\n      this.stretched.object3D.matrixNeedsUpdate = true;\n    }\n\n    this.previousLeftStretcher = leftStretcher;\n    this.previousRightStretcher = rightStretcher;\n  }\n}\n","export class SingleActionButtonSystem {\n  tick() {\n    this.didInteractThisFrame = false;\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const hovered = interaction.state.rightRemote.hovered;\n    if (\n      hovered &&\n      userinput.get(interaction.options.rightRemote.grabPath) &&\n      hovered.components.tags &&\n      hovered.components.tags.data.singleActionButton\n    ) {\n      this.didInteractThisFrame = true;\n      hovered.object3D.dispatchEvent({\n        type: \"interact\",\n        object3D: interaction.options.rightRemote.entity.object3D\n      });\n    }\n  }\n}\n\nexport class HoldableButtonSystem {\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const held = interaction.state.rightRemote.held;\n\n    if (this.prevHeld && this.prevHeld !== held) {\n      this.prevHeld.object3D.dispatchEvent({\n        type: \"holdable-button-up\",\n        object3D: interaction.options.rightRemote.entity.object3D\n      });\n    }\n    if (held && this.prevHeld !== held) {\n      held.object3D.dispatchEvent({\n        type: \"holdable-button-down\",\n        object3D: interaction.options.rightRemote.entity.object3D\n      });\n    }\n\n    this.prevHeld = held;\n  }\n}\n\nfunction getHoverableButton(hovered) {\n  if (!hovered) return null;\n  if (\n    hovered.components[\"icon-button\"] ||\n    hovered.components[\"text-button\"] ||\n    hovered.components[\"pin-networked-object-button\"]\n  )\n    return hovered;\n  // TODO: fix this so that we aren't looping thru children here. I just did this to accomodate the new rounded buttons\n  if (hovered.children) {\n    for (let i = 0; i < hovered.children.length; i++) {\n      if (\n        hovered.children[i].components[\"icon-button\"] ||\n        hovered.children[i].components[\"text-button\"] ||\n        hovered.components[\"pin-networked-object-button\"]\n      ) {\n        return hovered.children[i];\n      }\n    }\n  }\n  return null;\n}\nconst HOVERED = { type: \"hovered\" };\nconst UNHOVERED = { type: \"unhovered\" };\nexport class HoverButtonSystem {\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const button = getHoverableButton(interaction.state.rightRemote.hovered);\n\n    if (this.prevButton && this.prevButton !== button) {\n      this.prevButton.object3D.dispatchEvent(UNHOVERED);\n    }\n\n    if (button && this.prevButton !== button) {\n      button.object3D.dispatchEvent(HOVERED);\n    }\n\n    this.prevButton = button;\n  }\n}\n","function getSpecificHoverMenu(el) {\n  return (\n    el.components[\"hover-menu\"] ||\n    el.components[\"hover-menu__video\"] ||\n    el.components[\"hover-menu__camera\"] ||\n    el.components[\"hover-menu__hubs-item\"] ||\n    el.components[\"hover-menu__link\"]\n  );\n}\n\nfunction findHoverMenu(hovered) {\n  if (!hovered) return null;\n  const hoverMenu = getSpecificHoverMenu(hovered);\n  if (hoverMenu) {\n    return hoverMenu;\n  }\n  if (!(hovered.components.tags && hovered.components.tags.data.isHoverMenuChild)) {\n    return null;\n  }\n  let el = hovered.parentNode;\n  while (!getSpecificHoverMenu(el)) {\n    el = el.parentNode;\n  }\n  return getSpecificHoverMenu(el);\n}\n\nexport class HoverMenuSystem {\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const hoverMenu = findHoverMenu(interaction.state.rightRemote.hovered);\n\n    if (this.prevHoverMenu && this.prevHoverMenu !== hoverMenu) {\n      this.prevHoverMenu.hovering = false;\n      this.prevHoverMenu.applyHoverState();\n    }\n\n    if (hoverMenu && this.prevHoverMenu !== hoverMenu) {\n      hoverMenu.hovering = true;\n      hoverMenu.applyHoverState();\n    }\n\n    this.prevHoverMenu = hoverMenu;\n  }\n}\n","import { addMedia } from \"../utils/media-utils\";\nimport { ObjectContentOrigins } from \"../object-types\";\n\n// WARNING: This system mutates interaction system state!\nexport class SuperSpawnerSystem {\n  maybeSpawn(state, entity, grabPath) {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const superSpawner = state.hovered && state.hovered.components[\"super-spawner\"];\n    if (superSpawner && !superSpawner.cooldownTimeout && userinput.get(grabPath)) {\n      this.performSpawn(state, entity, grabPath, userinput, superSpawner);\n    }\n  }\n\n  performSpawn(state, entity, grabPath, userinput, superSpawner) {\n    entity.object3D.updateMatrices();\n    entity.object3D.matrix.decompose(entity.object3D.position, entity.object3D.quaternion, entity.object3D.scale);\n    const data = superSpawner.data;\n    const spawnedEntity = addMedia(\n      data.src,\n      data.template,\n      ObjectContentOrigins.SPAWNER,\n      data.resolve,\n      data.resize,\n      false\n    ).entity;\n    spawnedEntity.object3D.position.copy(\n      data.useCustomSpawnPosition ? data.spawnPosition : superSpawner.el.object3D.position\n    );\n    spawnedEntity.object3D.rotation.copy(\n      data.useCustomSpawnRotation ? data.spawnRotation : superSpawner.el.object3D.rotation\n    );\n    spawnedEntity.object3D.scale.copy(data.useCustomSpawnScale ? data.spawnScale : superSpawner.el.object3D.scale);\n    spawnedEntity.object3D.matrixNeedsUpdate = true;\n    state.held = spawnedEntity;\n\n    superSpawner.activateCooldown();\n    state.spawning = true;\n    // WARNING: previously used waitForEvent which is semantically different than\n    // entity.addEventListener(\"body-loaded\", ...) and adding a callback fn via\n    // addEventListener will not work unless the callback function wraps its code in setTimeout(()=>{...}, 0)\n    spawnedEntity.addEventListener(\n      \"body-loaded\",\n      () => {\n        setTimeout(() => {\n          state.spawning = false;\n          spawnedEntity.object3D.position.copy(\n            data.useCustomSpawnPosition ? data.spawnPosition : superSpawner.el.object3D.position\n          );\n          if (data.centerSpawnedObject) {\n            spawnedEntity.body.position.copy(entity.object3D.position);\n          }\n          spawnedEntity.object3D.matrixNeedsUpdate = true;\n        });\n      },\n      { once: true }\n    );\n  }\n\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    this.maybeSpawn(\n      interaction.state.leftHand,\n      interaction.options.leftHand.entity,\n      interaction.options.leftHand.grabPath\n    );\n    this.maybeSpawn(\n      interaction.state.rightHand,\n      interaction.options.rightHand.entity,\n      interaction.options.rightHand.grabPath\n    );\n    this.maybeSpawn(\n      interaction.state.rightRemote,\n      interaction.options.rightRemote.entity,\n      interaction.options.rightRemote.grabPath\n    );\n  }\n}\n","import { paths } from \"./userinput/paths\";\nimport { distanceBetweenStretchers } from \"./two-point-stretching-system\";\n\nfunction copyState(previous, current, isTeleporting) {\n  previous.held = current.held;\n  previous.hovered = current.hovered;\n  previous.isTeleporting = isTeleporting;\n}\n\n// TODO: These strengths should be written into bindings, since vibration strength varies across devices.\nconst STRENGTH = {\n  DROP: 0.1,\n  PICKUP: 0.2,\n  BUTTON_PRESSED: 0.2,\n  HOVER: 0.08,\n  STRETCH_BASE: 0.05,\n  STRETCH_DISTANCE: 0.2,\n  TELEPORTING: 0.08,\n  TELEPORTED: 0.2\n};\n\nfunction determineStrength(previous, current, isTeleporting) {\n  if (previous.held && !current.held) {\n    return STRENGTH.DROP;\n  } else if (!previous.held && current.held) {\n    return STRENGTH.PICKUP;\n  } else if (!previous.hovered && current.hovered) {\n    return STRENGTH.HOVER;\n  } else if (isTeleporting) {\n    return STRENGTH.TELEPORTING;\n  } else if (previous.isTeleporting && !isTeleporting) {\n    return STRENGTH.TELEPORTED;\n  } else {\n    return 0;\n  }\n}\n\nfunction determineStretchStrength(stretchSystem) {\n  if (!stretchSystem.stretcherLeft || !stretchSystem.stretcherRight) {\n    return 0;\n  }\n\n  return THREE.Math.clamp(\n    STRENGTH.STRETCH_BASE +\n      STRENGTH.STRETCH_DISTANCE *\n        Math.abs(\n          distanceBetweenStretchers(stretchSystem.stretcherLeft, stretchSystem.stretcherRight) -\n            stretchSystem.initialStretchDistance\n        ),\n    0,\n    0.5\n  );\n}\n\nexport class HapticFeedbackSystem {\n  constructor() {\n    this.state = {\n      rightHand: {\n        held: null,\n        hovered: null,\n        isTeleporting: false\n      },\n      rightRemote: {\n        held: null,\n        hovered: null,\n        isTeleporting: false\n      },\n      leftHand: {\n        held: null,\n        hovered: null,\n        isTeleporting: false\n      }\n    };\n  }\n\n  tick(twoPointStretchingSystem, didClickButton) {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const leftActuator = userinput.get(paths.haptics.actuators.left);\n    const rightActuator = userinput.get(paths.haptics.actuators.right);\n    if (!leftActuator && !rightActuator) {\n      return;\n    }\n\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const { leftHand, rightHand, rightRemote } = interaction.state;\n    this.leftTeleporter =\n      this.leftTeleporter || document.querySelector(\"#player-left-controller\").components.teleporter;\n    this.rightTeleporter =\n      this.rightTeleporter || document.querySelector(\"#player-right-controller\").components.teleporter;\n\n    const leftHandStrength = determineStrength(this.state.leftHand, leftHand, this.leftTeleporter.isTeleporting);\n    const rightHandStrength = determineStrength(this.state.rightHand, rightHand, this.rightTeleporter.isTeleporting);\n    const rightRemoteStrength = determineStrength(this.state.rightRemote, rightRemote, false);\n    const buttonPressedStrength = didClickButton ? STRENGTH.BUTTON_PRESSED : 0;\n    const stretchingStrength = determineStretchStrength(twoPointStretchingSystem);\n\n    const leftStrength = Math.max(leftHandStrength, stretchingStrength);\n    const rightStrength = Math.max(rightHandStrength, rightRemoteStrength, stretchingStrength, buttonPressedStrength);\n\n    if (leftStrength && leftActuator) {\n      leftActuator.pulse(leftStrength, 15);\n    }\n\n    if (rightStrength && rightActuator) {\n      rightActuator.pulse(rightStrength, 15);\n    }\n\n    copyState(this.state.rightHand, rightHand, this.rightTeleporter.isTeleporting);\n    copyState(this.state.leftHand, leftHand, this.leftTeleporter.isTeleporting);\n    copyState(this.state.rightRemote, rightRemote, false);\n  }\n}\n","import { CursorTargettingSystem } from \"./cursor-targetting-system\";\nimport { ConstraintsSystem } from \"./constraints-system\";\nimport { TwoPointStretchingSystem } from \"./two-point-stretching-system\";\nimport { SingleActionButtonSystem, HoldableButtonSystem, HoverButtonSystem } from \"./button-systems\";\nimport { HoverMenuSystem } from \"./hover-menu-system\";\nimport { SuperSpawnerSystem } from \"./super-spawner-system\";\nimport { HapticFeedbackSystem } from \"./haptic-feedback-system\";\nimport { SoundEffectsSystem } from \"./sound-effects-system\";\n\nAFRAME.registerSystem(\"hubs-systems\", {\n  init() {\n    this.cursorTargettingSystem = new CursorTargettingSystem();\n    this.constraintsSystem = new ConstraintsSystem();\n    this.twoPointStretchingSystem = new TwoPointStretchingSystem();\n    this.singleActionButtonSystem = new SingleActionButtonSystem();\n    this.holdableButtonSystem = new HoldableButtonSystem();\n    this.hoverButtonSystem = new HoverButtonSystem();\n    this.hoverMenuSystem = new HoverMenuSystem();\n    this.superSpawnerSystem = new SuperSpawnerSystem();\n    this.hapticFeedbackSystem = new HapticFeedbackSystem();\n    this.soundEffectsSystem = new SoundEffectsSystem();\n  },\n\n  tick(t) {\n    const systems = AFRAME.scenes[0].systems;\n    systems.userinput.tick2();\n    systems.interaction.tick2(this.soundEffectsSystem);\n    this.superSpawnerSystem.tick();\n    this.cursorTargettingSystem.tick(t);\n    this.constraintsSystem.tick();\n    this.twoPointStretchingSystem.tick();\n    this.singleActionButtonSystem.tick();\n    this.holdableButtonSystem.tick();\n    this.hoverButtonSystem.tick();\n    this.hoverMenuSystem.tick();\n    this.hapticFeedbackSystem.tick(this.twoPointStretchingSystem, this.singleActionButtonSystem.didInteractThisFrame);\n    this.soundEffectsSystem.tick();\n  },\n\n  remove() {\n    this.cursorTargettingSystem.remove();\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\n\nAFRAME.registerComponent(\"scalable-when-grabbed\", {\n  tick: function() {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    if (interaction.state.rightRemote.held !== this.el) return;\n    const deltaScale = userinput.get(paths.actions.cursor.scaleGrabbedGrabbable);\n    if (!deltaScale) return;\n\n    this.el.object3D.scale.addScalar(deltaScale).clampScalar(0.1, 100);\n    this.el.object3D.matrixNeedsUpdate = true;\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\nimport { sets } from \"../systems/userinput/sets\";\nimport { getLastWorldPosition } from \"../utils/three-utils\";\n\nconst HIGHLIGHT = new THREE.Color(23 / 255, 64 / 255, 118 / 255);\nconst NO_HIGHLIGHT = new THREE.Color(190 / 255, 190 / 255, 190 / 255);\nconst TRANSFORM_COLOR_1 = new THREE.Color(150 / 255, 80 / 255, 150 / 255);\nconst TRANSFORM_COLOR_2 = new THREE.Color(23 / 255, 64 / 255, 118 / 255);\nAFRAME.registerComponent(\"cursor-controller\", {\n  schema: {\n    cursor: { type: \"selector\" },\n    camera: { type: \"selector\" },\n    far: { default: 4 },\n    near: { default: 0.01 },\n    minDistance: { default: 0.18 }\n  },\n\n  init: function() {\n    this.enabled = true;\n\n    this.data.cursor.addEventListener(\n      \"loaded\",\n      () => {\n        this.data.cursor.object3DMap.mesh.renderOrder = window.APP.RENDER_ORDER.CURSOR;\n      },\n      { once: true }\n    );\n\n    this.raycaster = new THREE.Raycaster();\n    this.raycaster.firstHitOnly = true; // flag specific to three-mesh-bvh\n    this.distance = this.data.far;\n    this.color = new THREE.Color(0, 0, 0);\n\n    const lineGeometry = new THREE.BufferGeometry();\n    lineGeometry.addAttribute(\"position\", new THREE.BufferAttribute(new Float32Array(2 * 3), 3));\n\n    this.line = new THREE.Line(\n      lineGeometry,\n      new THREE.LineBasicMaterial({\n        color: \"white\",\n        opacity: 0.2,\n        transparent: true,\n        visible: false\n      })\n    );\n    this.el.setObject3D(\"line\", this.line);\n  },\n\n  update: function() {\n    this.raycaster.far = this.data.far;\n    this.raycaster.near = this.data.near;\n  },\n\n  tick2: (() => {\n    const rawIntersections = [];\n    const cameraPos = new THREE.Vector3();\n\n    return function(t) {\n      const userinput = AFRAME.scenes[0].systems.userinput;\n      const cursorPose = userinput.get(paths.actions.cursor.pose);\n      const rightHandPose = userinput.get(paths.actions.rightHand.pose);\n\n      this.data.cursor.object3D.visible = this.enabled && !!cursorPose;\n      this.line.material.visible = !!(this.enabled && rightHandPose);\n\n      if (!this.enabled || !cursorPose) {\n        return;\n      }\n\n      const interaction = AFRAME.scenes[0].systems.interaction;\n      let intersection;\n      const isGrabbing = !!interaction.state.rightRemote.held;\n      if (!isGrabbing) {\n        rawIntersections.length = 0;\n        this.raycaster.ray.origin = cursorPose.position;\n        this.raycaster.ray.direction = cursorPose.direction;\n        this.raycaster.intersectObjects(\n          AFRAME.scenes[0].systems[\"hubs-systems\"].cursorTargettingSystem.targets,\n          true,\n          rawIntersections\n        );\n        intersection = rawIntersections[0];\n        interaction.updateCursorIntersection(intersection);\n        this.distance = intersection ? intersection.distance : this.data.far;\n      }\n\n      const { cursor, minDistance, far, camera } = this.data;\n\n      const cursorModDelta = userinput.get(paths.actions.cursor.modDelta) || 0;\n      if (isGrabbing && !userinput.activeSets.includes(sets.cursorHoldingUI)) {\n        this.distance = THREE.Math.clamp(this.distance - cursorModDelta, minDistance, far);\n      }\n      cursor.object3D.position.copy(cursorPose.position).addScaledVector(cursorPose.direction, this.distance);\n      // The cursor will always be oriented towards the player about its Y axis, so objects held by the cursor will rotate towards the player.\n      getLastWorldPosition(camera.object3D, cameraPos);\n      cameraPos.y = cursor.object3D.position.y;\n      cursor.object3D.lookAt(cameraPos);\n      cursor.object3D.scale.setScalar(Math.pow(this.distance, 0.315) * 0.75);\n      cursor.object3D.matrixNeedsUpdate = true;\n\n      if (AFRAME.scenes[0].systems[\"transform-selected-object\"].transforming) {\n        this.color.copy(TRANSFORM_COLOR_1).lerpHSL(TRANSFORM_COLOR_2, 0.5 + 0.5 * Math.sin(t / 1000.0));\n      } else if (intersection || isGrabbing) {\n        this.color.copy(HIGHLIGHT);\n      } else {\n        this.color.copy(NO_HIGHLIGHT);\n      }\n\n      if (!this.data.cursor.object3DMap.mesh.material.color.equals(this.color)) {\n        this.data.cursor.object3DMap.mesh.material.color.copy(this.color);\n        this.data.cursor.object3DMap.mesh.material.needsUpdate = true;\n      }\n\n      if (this.line.material.visible) {\n        const posePosition = cursorPose.position;\n        const cursorPosition = cursor.object3D.position;\n        const positionArray = this.line.geometry.attributes.position.array;\n\n        positionArray[0] = posePosition.x;\n        positionArray[1] = posePosition.y;\n        positionArray[2] = posePosition.z;\n        positionArray[3] = cursorPosition.x;\n        positionArray[4] = cursorPosition.y;\n        positionArray[5] = cursorPosition.z;\n\n        this.line.geometry.attributes.position.needsUpdate = true;\n        this.line.geometry.computeBoundingSphere();\n      }\n    };\n  })()\n});\n","import { paths } from \"../../systems/userinput/paths\";\nimport { getLastWorldPosition } from \"../../utils/three-utils\";\nimport {\n  SOUND_PEN_START_DRAW,\n  SOUND_PEN_STOP_DRAW,\n  SOUND_PEN_UNDO_DRAW,\n  SOUND_PEN_CHANGE_COLOR\n} from \"../../systems/sound-effects-system\";\n\nconst pathsMap = {\n  \"player-right-controller\": {\n    startDrawing: paths.actions.rightHand.startDrawing,\n    stopDrawing: paths.actions.rightHand.stopDrawing,\n    undoDrawing: paths.actions.rightHand.undoDrawing,\n    penNextColor: paths.actions.rightHand.penNextColor,\n    penPrevColor: paths.actions.rightHand.penPrevColor,\n    scalePenTip: paths.actions.rightHand.scalePenTip\n  },\n  \"player-left-controller\": {\n    startDrawing: paths.actions.leftHand.startDrawing,\n    stopDrawing: paths.actions.leftHand.stopDrawing,\n    undoDrawing: paths.actions.leftHand.undoDrawing,\n    penNextColor: paths.actions.leftHand.penNextColor,\n    penPrevColor: paths.actions.leftHand.penPrevColor,\n    scalePenTip: paths.actions.leftHand.scalePenTip\n  },\n  cursor: {\n    startDrawing: paths.actions.cursor.startDrawing,\n    stopDrawing: paths.actions.cursor.stopDrawing,\n    undoDrawing: paths.actions.cursor.undoDrawing,\n    penNextColor: paths.actions.cursor.penNextColor,\n    penPrevColor: paths.actions.cursor.penPrevColor,\n    scalePenTip: paths.actions.cursor.scalePenTip\n  }\n};\n/**\n * Pen tool\n * A tool that allows drawing on networked-drawing components.\n * @namespace drawing\n * @component pen\n */\n\nfunction almostEquals(epsilon, u, v) {\n  return Math.abs(u.x - v.x) < epsilon && Math.abs(u.y - v.y) < epsilon && Math.abs(u.z - v.z) < epsilon;\n}\n\nAFRAME.registerComponent(\"pen\", {\n  schema: {\n    drawFrequency: { default: 5 }, //frequency of polling for drawing points\n    minDistanceBetweenPoints: { default: 0.01 }, //minimum distance to register new drawing point\n    camera: { type: \"selector\" },\n    drawingManager: { type: \"string\" },\n    color: { type: \"color\", default: \"#FF0033\" },\n    availableColors: {\n      default: [\n        \"#FF0033\",\n        \"#FFFF00\",\n        \"#0099FF\",\n        \"#00FF33\",\n        \"#9900FF\",\n        \"#FF6600\",\n        \"#8D5524\",\n        \"#C68642\",\n        \"#E0AC69\",\n        \"#F1C27D\",\n        \"#FFDBAC\",\n        \"#FFFFFF\",\n        \"#222222\",\n        \"#111111\",\n        \"#000000\"\n      ]\n    },\n    radius: { default: 0.01 }, //drawing geometry radius\n    minRadius: { default: 0.005 },\n    maxRadius: { default: 0.2 }\n  },\n\n  init() {\n    this.timeSinceLastDraw = 0;\n\n    this.lastPosition = new THREE.Vector3();\n    this.lastPosition.copy(this.el.object3D.position);\n\n    this.direction = new THREE.Vector3(1, 0, 0);\n\n    this.currentDrawing = null;\n\n    this.normal = new THREE.Vector3();\n\n    this.worldPosition = new THREE.Vector3();\n\n    this.colorIndex = 0;\n\n    this.grabbed = false;\n  },\n\n  play() {\n    this.drawingManager = document.querySelector(this.data.drawingManager).components[\"drawing-manager\"];\n    this.drawingManager.createDrawing();\n  },\n\n  update(prevData) {\n    if (prevData.color != this.data.color) {\n      this.el.setAttribute(\"color\", this.data.color);\n    }\n    if (prevData.radius != this.data.radius) {\n      this.el.setAttribute(\"radius\", this.data.radius);\n    }\n  },\n\n  tick(t, dt) {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const interaction = AFRAME.scenes[0].systems.interaction;\n\n    if (interaction.state.rightHand.held === this.el.parentNode) {\n      this.grabberId = \"player-right-controller\";\n    } else if (interaction.state.leftHand.held === this.el.parentNode) {\n      this.grabberId = \"player-left-controller\";\n    } else if (interaction.state.rightRemote.held === this.el.parentNode) {\n      this.grabberId = \"cursor\";\n    } else {\n      this.grabberId = null;\n    }\n\n    getLastWorldPosition(this.el.object3D, this.worldPosition);\n\n    if (this.grabberId && pathsMap[this.grabberId]) {\n      const sfx = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem;\n      const paths = pathsMap[this.grabberId];\n      if (userinput.get(paths.startDrawing)) {\n        this._startDraw();\n        sfx.playSoundOneShot(SOUND_PEN_START_DRAW);\n      }\n      if (userinput.get(paths.stopDrawing)) {\n        this._endDraw();\n        sfx.playSoundOneShot(SOUND_PEN_STOP_DRAW);\n      }\n      if (userinput.get(paths.undoDrawing)) {\n        this._undoDraw();\n        sfx.playSoundOneShot(SOUND_PEN_UNDO_DRAW);\n      }\n      const penScaleMod = userinput.get(paths.scalePenTip);\n      if (penScaleMod) {\n        this._changeRadius(penScaleMod);\n      }\n      if (userinput.get(paths.penNextColor)) {\n        this._changeColor(1);\n        sfx.playSoundOneShot(SOUND_PEN_CHANGE_COLOR);\n      }\n      if (userinput.get(paths.penPrevColor)) {\n        this._changeColor(-1);\n        sfx.playSoundOneShot(SOUND_PEN_CHANGE_COLOR);\n      }\n    }\n\n    if (!almostEquals(0.005, this.worldPosition, this.lastPosition)) {\n      this.direction.subVectors(this.worldPosition, this.lastPosition).normalize();\n      this.lastPosition.copy(this.worldPosition);\n    }\n\n    if (this.currentDrawing) {\n      const time = this.timeSinceLastDraw + dt;\n      if (\n        time >= this.data.drawFrequency &&\n        this.currentDrawing.getLastPoint().distanceTo(this.worldPosition) >= this.data.minDistanceBetweenPoints\n      ) {\n        this._getNormal(this.normal, this.worldPosition, this.direction);\n        this.currentDrawing.draw(this.worldPosition, this.direction, this.normal, this.data.color, this.data.radius);\n      }\n\n      this.timeSinceLastDraw = time % this.data.drawFrequency;\n    }\n\n    if (this.currentDrawing && !this.grabberId) {\n      this._endDraw();\n    }\n  },\n\n  //helper function to get normal of direction of drawing cross direction to camera\n  _getNormal: (() => {\n    const directionToCamera = new THREE.Vector3();\n    return function(normal, position, direction) {\n      directionToCamera.subVectors(position, this.data.camera.object3D.position).normalize();\n      normal.crossVectors(direction, directionToCamera);\n    };\n  })(),\n\n  _startDraw() {\n    this.currentDrawing = this.drawingManager.getDrawing(this);\n    if (this.currentDrawing) {\n      this._getNormal(this.normal, this.worldPosition, this.direction);\n      this.currentDrawing.startDraw(this.worldPosition, this.direction, this.normal, this.data.color, this.data.radius);\n    }\n  },\n\n  _endDraw() {\n    if (this.currentDrawing) {\n      this.timeSinceLastDraw = 0;\n      this._getNormal(this.normal, this.worldPosition, this.direction);\n      this.currentDrawing.endDraw(this.worldPosition, this.direction, this.normal);\n      this.drawingManager.returnDrawing(this);\n      this.currentDrawing = null;\n    }\n  },\n\n  _undoDraw() {\n    const drawing = this.drawingManager.getDrawing(this);\n    if (drawing) {\n      drawing.undoDraw();\n      this.drawingManager.returnDrawing(this);\n    }\n  },\n\n  _changeColor(mod) {\n    this.colorIndex = (this.colorIndex + mod + this.data.availableColors.length) % this.data.availableColors.length;\n    this.data.color = this.data.availableColors[this.colorIndex];\n    this.el.setAttribute(\"color\", this.data.color);\n  },\n\n  _changeRadius(mod) {\n    this.data.radius = Math.max(this.data.minRadius, Math.min(this.data.radius + mod, this.data.maxRadius));\n    this.el.setAttribute(\"radius\", this.data.radius);\n  }\n});\n","export default class SharedBufferGeometry {\n  constructor(material, primitiveMode, maxBufferSize) {\n    this.material = material;\n    this.primitiveMode = primitiveMode;\n\n    this.maxBufferSize = maxBufferSize;\n    this.geometries = [];\n    this.current = null;\n    this.drawing = new THREE.Object3D();\n    this.addBuffer();\n  }\n\n  restartPrimitive() {\n    if (this.idx.position >= this.current.attributes.position.count) {\n      console.error(\"maxBufferSize limit exceeded\");\n    } else if (this.idx.position !== 0) {\n      let prev = (this.idx.position - 1) * 3;\n      const position = this.current.attributes.position.array;\n      this.addVertex(position[prev++], position[prev++], position[prev++]);\n\n      this.idx.color++;\n      this.idx.normal++;\n    }\n  }\n\n  remove(prevIdx, idx) {\n    // Loop through all the attributes: position, color, normal,...\n    if (this.idx.position > idx.position) {\n      for (const key in this.idx) {\n        const componentSize = 3;\n        let pos = prevIdx[key] * componentSize;\n        const start = (idx[key] + 1) * componentSize;\n        const end = this.idx[key] * componentSize;\n        for (let i = start; i < end; i++) {\n          this.current.attributes[key].array[pos++] = this.current.attributes[key].array[i];\n        }\n        const diff = idx[key] - prevIdx[key] + 1;\n        this.idx[key] -= diff;\n      }\n    } else {\n      for (const key in this.idx) {\n        const diff = idx[key] - prevIdx[key];\n        this.idx[key] -= diff;\n      }\n    }\n\n    this.update();\n  }\n\n  undo(prevIdx) {\n    this.idx = prevIdx;\n    this.update();\n  }\n\n  addBuffer() {\n    const geometry = new THREE.BufferGeometry();\n\n    const vertices = new Float32Array(this.maxBufferSize * 3);\n    const normals = new Float32Array(this.maxBufferSize * 3);\n    const colors = new Float32Array(this.maxBufferSize * 3);\n\n    const mesh = new THREE.Mesh(geometry, this.material);\n\n    mesh.drawMode = this.primitiveMode;\n\n    mesh.frustumCulled = false;\n    mesh.vertices = vertices;\n\n    const object3D = new THREE.Object3D();\n    this.drawing.add(object3D);\n    object3D.add(mesh);\n\n    geometry.setDrawRange(0, 0);\n    geometry.addAttribute(\"position\", new THREE.BufferAttribute(vertices, 3).setDynamic(true));\n    geometry.addAttribute(\"normal\", new THREE.BufferAttribute(normals, 3).setDynamic(true));\n    geometry.addAttribute(\"color\", new THREE.BufferAttribute(colors, 3).setDynamic(true));\n\n    this.previous = null;\n    if (this.geometries.length > 0) {\n      this.previous = this.current;\n    }\n\n    this.idx = {\n      position: 0,\n      normal: 0,\n      color: 0\n    };\n\n    this.geometries.push(geometry);\n    this.current = geometry;\n  }\n\n  addColor(r, g, b) {\n    this.current.attributes.color.setXYZ(this.idx.color++, r, g, b);\n  }\n\n  addNormal(x, y, z) {\n    this.current.attributes.normal.setXYZ(this.idx.normal++, x, y, z);\n  }\n\n  addVertex(x, y, z) {\n    const buffer = this.current.attributes.position;\n    if (this.idx.position === buffer.count) {\n      console.error(\"maxBufferSize limit exceeded\");\n    }\n    buffer.setXYZ(this.idx.position++, x, y, z);\n  }\n\n  update() {\n    this.current.setDrawRange(0, this.idx.position);\n\n    this.current.attributes.color.needsUpdate = true;\n    this.current.attributes.normal.needsUpdate = true;\n    this.current.attributes.position.needsUpdate = true;\n  }\n}\n","import SharedBufferGeometry from \"./sharedbuffergeometry\";\n\nexport default class SharedBufferGeometryManager {\n  constructor() {\n    this.sharedBuffers = {};\n  }\n\n  addSharedBuffer(name, material, primitiveMode, maxBufferSize) {\n    this.sharedBuffers[name] = new SharedBufferGeometry(material, primitiveMode, maxBufferSize);\n  }\n\n  getSharedBuffer(name) {\n    return this.sharedBuffers[name];\n  }\n}\n","/* global THREE */\n/**\n * Networked Drawing\n * Creates procedurally generated 'lines' (or tubes) that are networked.\n * @namespace drawing\n * @component networked-drawing\n */\n\nimport SharedBufferGeometryManager from \"../../utils/sharedbuffergeometrymanager\";\n\nconst MSG_CONFIRM_CONNECT = 0;\nconst MSG_BUFFER_DATA = 1;\nconst MSG_BUFFER_DATA_FULL = 2;\n\nfunction copyData(fromArray, toArray, fromIndex, toIndex) {\n  let i = fromIndex - 1;\n  let j = -1;\n  while (i + 1 <= toIndex) {\n    toArray[++j] = fromArray[++i];\n  }\n}\n\nAFRAME.registerComponent(\"networked-drawing\", {\n  schema: {\n    segments: { default: 8 }, //the number of \"sides\" the procedural tube should have\n    defaultRadius: { default: 0.01 }, //the radius of the procedural tube\n    maxDrawTimeout: { default: 600000 }, //the maximum time a drawn line will live\n    maxLines: { default: 50 }, //how many lines can persist before lines older than minDrawTime are removed\n    maxPointsPerLine: { default: 250 } //the max number of points a single line can have\n  },\n\n  init() {\n    this._receiveData = this._receiveData.bind(this);\n\n    this.networkBuffer = [];\n\n    this.sendNetworkBufferQueue = [];\n\n    this.drawStarted = false;\n    this.lineStarted = false;\n    this.remoteLineStarted = false;\n\n    this.receivedBufferParts = 0;\n    this.bufferIndex = 0;\n    this.connectedToOwner = false;\n    this.networkBufferInitialized = false;\n\n    const options = {\n      vertexColors: THREE.VertexColors\n    };\n\n    this.color = new THREE.Color();\n    this.radius = this.data.defaultRadius;\n    this.segments = this.data.segments;\n\n    const material = new THREE.MeshStandardMaterial(options);\n    this.sharedBufferGeometryManager = new SharedBufferGeometryManager();\n    // NOTE: 20 is approximate for how many floats per point are added.\n    // maxLines + 1 because a line can be currently drawing while at maxLines.\n    // Multiply by 1/3 (0.333) because 3 floats per vertex (x, y, z).\n    const maxBufferSize = Math.round(this.data.maxPointsPerLine * 20 * (this.data.maxLines + 1) * 0.333);\n    this.sharedBufferGeometryManager.addSharedBuffer(0, material, THREE.TriangleStripDrawMode, maxBufferSize);\n\n    this.lastPoint = new THREE.Vector3();\n\n    this.lastSegments = [];\n    this.currentSegments = [];\n    for (let x = 0; x < this.segments; x++) {\n      this.lastSegments[x] = {\n        position: new THREE.Vector3(),\n        normal: new THREE.Vector3()\n      };\n      this.currentSegments[x] = {\n        position: new THREE.Vector3(),\n        normal: new THREE.Vector3()\n      };\n    }\n\n    this.sharedBuffer = this.sharedBufferGeometryManager.getSharedBuffer(0);\n    this.drawing = this.sharedBuffer.drawing;\n    const sceneEl = document.querySelector(\"a-scene\");\n    this.scene = sceneEl.object3D;\n    this.scene.add(this.drawing);\n\n    this.prevIdx = Object.assign({}, this.sharedBuffer.idx);\n    this.idx = Object.assign({}, this.sharedBuffer.idx);\n    this.vertexCount = 0; //number of vertices added for current line (used for line deletion).\n    this.networkBufferCount = 0; //number of items added to networkBuffer for current line (used for line deletion).\n    this.currentPointCount = 0; //number of points added for current line (used for maxPointsPerLine).\n    this.invalidPointRead = false; //flag flipped if we read a bad point anywhere during this line\n    this.lastReadPointCount = 0; //last read point count read off of the network, used for sanity checking\n    this.networkBufferHistory = []; //tracks vertexCount and networkBufferCount so that lines can be deleted.\n\n    NAF.connection.onConnect(() => {\n      NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n        this.networkedEl = networkedEl;\n        this.networkId = NAF.utils.getNetworkId(this.networkedEl);\n        this.drawingId = \"drawing-\" + this.networkId;\n        NAF.connection.subscribeToDataChannel(this.drawingId, this._receiveData);\n      });\n    });\n  },\n\n  remove() {\n    NAF.connection.unsubscribeToDataChannel(this.drawingId, this._receiveData);\n\n    this.scene.remove(this.drawing);\n  },\n\n  tick(t) {\n    const connected = NAF.connection.isConnected() && this.networkedEl;\n    const isMine = connected && NAF.utils.isMine(this.networkedEl);\n\n    if (!this.connectedToOwner && connected) {\n      const owner = NAF.utils.getNetworkOwner(this.networkedEl);\n      if (!isMine && NAF.connection.hasActiveDataChannel(owner)) {\n        NAF.connection.sendDataGuaranteed(owner, this.drawingId, {\n          type: MSG_CONFIRM_CONNECT,\n          clientId: NAF.clientId\n        });\n        this.connectedToOwner = true;\n      }\n    }\n\n    if (this.networkBuffer.length > 0 && connected) {\n      if (!isMine) {\n        this._drawFromNetwork();\n      } else if (this.bufferIndex < this.networkBuffer.length) {\n        this._broadcastDrawing();\n      }\n    }\n\n    //TODO: handle possibility that a clientId gets stuck in sendNetworkBufferQueue\n    //if that client disconnects before this executes and an activeDataChannel is opened.\n    if (isMine && this.sendNetworkBufferQueue.length > 0) {\n      const connected = [];\n      for (let i = 0; i < this.sendNetworkBufferQueue.length; i++) {\n        if (NAF.connection.hasActiveDataChannel(this.sendNetworkBufferQueue[i])) {\n          connected.push(this.sendNetworkBufferQueue[i]);\n        }\n      }\n      for (let j = 0; j < connected.length; j++) {\n        const pos = this.sendNetworkBufferQueue.indexOf(connected[j]);\n        this._sendNetworkBuffer(connected[j]);\n        this.sendNetworkBufferQueue.splice(pos, 1);\n      }\n    }\n\n    this._deleteExpiredLines(t);\n  },\n\n  _broadcastDrawing: (() => {\n    const copyArray = [];\n    return function() {\n      copyArray.length = 0;\n      copyData(this.networkBuffer, copyArray, this.bufferIndex, this.networkBuffer.length - 1);\n\n      //remove undo's from networkBuffer after they've been sent so that\n      //newly joining clients don't get them\n      let index = -1;\n      while ((index = this.networkBuffer.indexOf(\"-\")) != -1) {\n        this.networkBuffer.splice(index, 1);\n      }\n      this.bufferIndex = this.networkBuffer.length;\n      NAF.connection.broadcastDataGuaranteed(this.drawingId, { type: MSG_BUFFER_DATA, buffer: copyArray });\n    };\n  })(),\n\n  _drawFromNetwork: (() => {\n    const position = new THREE.Vector3();\n    const direction = new THREE.Vector3();\n    const normal = new THREE.Vector3();\n    return function() {\n      let head = this.networkBuffer[0];\n      if (head === \"-\") {\n        this._undoDraw();\n        this.networkBuffer.shift();\n        head = this.networkBuffer[0];\n      }\n      let didWork = false;\n      while (head != null && this.networkBuffer.length >= 11) {\n        const pointCount = this.networkBuffer[0];\n\n        // This is a sanity check against the sequence number to help uncover remaining bugs.\n        // If the point is out-of-order, report the error and stop drawing this line.\n        if (pointCount !== this.lastReadPointCount + 1) {\n          this.invalidPointRead = true;\n\n          console.error(\n            `Draw networking error: ID ${this.drawingId} expected point ${this.lastReadPointCount +\n              1} but received ${pointCount}`\n          );\n        }\n\n        this.lastReadPointCount = pointCount;\n        position.set(this.networkBuffer[1], this.networkBuffer[2], this.networkBuffer[3]);\n        direction.set(this.networkBuffer[4], this.networkBuffer[5], this.networkBuffer[6]);\n        this.radius = Math.round(direction.length() * 1000) / 1000; //radius is encoded as length of direction vector\n        direction.normalize();\n        normal.set(this.networkBuffer[7], this.networkBuffer[8], this.networkBuffer[9]);\n        this.color.setHex(Math.round(normal.length()) - 1); //color is encoded as length of normal vector\n        normal.normalize();\n\n        this.networkBuffer.splice(0, 10);\n\n        if (!this.remoteLineStarted) {\n          this.startDraw(position, direction, normal);\n          this.remoteLineStarted = true;\n        }\n\n        if (this.networkBuffer[0] === null) {\n          if (!this.invalidPointRead) {\n            this._endDraw(position, direction, normal);\n          }\n\n          this.remoteLineStarted = false;\n          this.networkBuffer.shift();\n          this.lastReadPointCount = 0;\n          this.invalidPointRead = false;\n        } else {\n          if (!this.invalidPointRead) {\n            this._draw(position, direction, normal);\n            didWork = true;\n          }\n        }\n      }\n      if (didWork) this._updateBuffer();\n    };\n  })(),\n\n  _deleteExpiredLines(time) {\n    const length = this.networkBufferHistory.length;\n    if (length > 0) {\n      const drawTime = this.networkBufferHistory[0].time;\n      if (length > this.data.maxLines || drawTime + this.data.maxDrawTimeout <= time) {\n        const datum = this.networkBufferHistory[0];\n        if (length > 1) {\n          datum.idxLength += 2 - (this.segments % 2); //account for extra verts added for degenerate triangles\n          this.networkBufferHistory[1].idxLength -= 2 - (this.segments % 2);\n        }\n        this.idx.position = datum.idxLength;\n        this.idx.uv = datum.idxLength;\n        this.idx.normal = datum.idxLength;\n        this.idx.color = datum.idxLength;\n        this.sharedBuffer.remove(this.prevIdx, this.idx);\n        this.networkBufferHistory.shift();\n        if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n          this.networkBuffer.splice(0, datum.networkBufferCount);\n          this.bufferIndex -= datum.networkBufferCount;\n        }\n      }\n    }\n  },\n\n  _sendNetworkBuffer: (() => {\n    const copyArray = [];\n    //This number needs to be approx. < ~6000 based on napkin math\n    //see: https://github.com/webrtc/adapter/blob/682e0f2439e139da6c0c406370eae820637b8sc1a/src/js/common_shim.js#L157\n    const chunkAmount = 3000;\n    return function(clientId) {\n      if (NAF.utils.isMine(this.networkedEl)) {\n        if (this.networkBuffer.length <= chunkAmount) {\n          NAF.connection.sendDataGuaranteed(clientId, this.drawingId, {\n            type: MSG_BUFFER_DATA_FULL,\n            parts: 1,\n            buffer: this.networkBuffer\n          });\n        } else {\n          let start = 0;\n          let end = 0;\n          while (end < this.networkBuffer.length) {\n            end = Math.min(end + chunkAmount, this.networkBuffer.length);\n            copyArray.length = 0;\n            copyData(this.networkBuffer, copyArray, start, end - 1);\n            start = end;\n            NAF.connection.sendDataGuaranteed(clientId, this.drawingId, {\n              type: MSG_BUFFER_DATA_FULL,\n              parts: Math.ceil(this.networkBuffer.length / chunkAmount),\n              buffer: copyArray\n            });\n          }\n        }\n      }\n    };\n  })(),\n\n  _receiveData(_, dataType, data) {\n    switch (data.type) {\n      case MSG_CONFIRM_CONNECT:\n        this.sendNetworkBufferQueue.push(data.clientId);\n        break;\n      case MSG_BUFFER_DATA:\n        if (this.networkBufferInitialized) {\n          this.networkBuffer.push.apply(this.networkBuffer, data.buffer);\n        }\n        break;\n      case MSG_BUFFER_DATA_FULL:\n        this.networkBuffer.push.apply(this.networkBuffer, data.buffer);\n        if (++this.receivedBufferParts >= data.parts) {\n          this.networkBufferInitialized = true;\n        }\n        break;\n    }\n  },\n\n  getLastPoint() {\n    return this.lastPoint;\n  },\n\n  startDraw(position, direction, normal, color, radius) {\n    if (!NAF.connection.isConnected()) {\n      return;\n    }\n\n    this.drawStarted = true;\n\n    if (color) {\n      this.color.set(color);\n    }\n    if (radius) this.radius = radius;\n\n    this.lastPoint.copy(position);\n    this._addToNetworkBuffer(position, direction, normal);\n  },\n\n  draw(position, direction, normal, color, radius) {\n    if (!NAF.connection.isConnected() || !this.drawStarted) {\n      return;\n    }\n\n    if (color && color != \"#\" + this.color.getHexString().toUpperCase()) {\n      this.color.set(color);\n    }\n    if (radius) this.radius = radius;\n\n    this._addToNetworkBuffer(position, direction, normal);\n    this._draw(position, direction, normal);\n\n    this._updateBuffer();\n  },\n\n  _draw: (() => {\n    const capNormal = new THREE.Vector3();\n    return function(position, direction, normal, radiusMultiplier = 1.0) {\n      if (!this.lineStarted) {\n        this._generateSegments(this.lastSegments, position, direction, normal, this.radius * radiusMultiplier);\n\n        if (this.networkBufferHistory.length === 0) {\n          //start with CW faceculling order\n          this._addDegenerateTriangle();\n        } else {\n          //only do the following if the sharedBuffer is not empty\n          this._restartPrimitive();\n          this._addDegenerateTriangle();\n          if (this.segments % 2 === 0) {\n            //flip faceculling order if even numbered segments\n            this._addDegenerateTriangle();\n          }\n        }\n\n        //get normal for tip of cap\n        capNormal.copy(direction).negate();\n        //get normals for rim of cap\n        for (let i = 0; i < this.segments; i++) {\n          this.lastSegments[i].normal.add(capNormal).multiplyScalar(0.5);\n        }\n\n        this._drawCap(this.lastPoint, this.lastSegments, capNormal);\n        if (this.segments % 2 !== 0) {\n          //flip faceculling order if odd numbered segments\n          this._addDegenerateTriangle();\n        }\n\n        this.lineStarted = true;\n      } else {\n        this._generateSegments(this.currentSegments, position, direction, normal, this.radius * radiusMultiplier);\n        this._drawCylinder();\n\n        if (this.currentPointCount > this.data.maxPointsPerLine) {\n          this._drawEndCap(position, direction);\n          this._endLine();\n        }\n      }\n      this.lastPoint.copy(position);\n    };\n  })(),\n\n  undoDraw() {\n    if (!NAF.connection.isConnected() || this.drawStarted) {\n      return;\n    }\n    this._undoDraw();\n    this._pushToNetworkBuffer(\"-\");\n  },\n\n  _undoDraw() {\n    const length = this.networkBufferHistory.length;\n    if (length > 0) {\n      const datum = this.networkBufferHistory.pop();\n      this.idx.position = 0;\n      this.idx.uv = 0;\n      this.idx.normal = 0;\n      this.idx.color = 0;\n      if (length > 1) {\n        datum.idxLength += 1 - (this.segments % 2); //account for extra verts added for degenerate triangles\n        this.idx.position = this.sharedBuffer.idx.position - datum.idxLength;\n        this.idx.uv = this.sharedBuffer.idx.uv - datum.idxLength;\n        this.idx.normal = this.sharedBuffer.idx.normal - datum.idxLength;\n        this.idx.color = this.sharedBuffer.idx.color - datum.idxLength;\n      }\n      this.sharedBuffer.remove(this.idx, this.sharedBuffer.idx);\n      if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n        this.networkBuffer.splice(this.networkBuffer.length - datum.networkBufferCount, datum.networkBufferCount);\n        this.bufferIndex -= datum.networkBufferCount;\n      }\n    }\n  },\n\n  endDraw(position, direction, normal) {\n    this._endDraw(position, direction, normal);\n    this._updateBuffer();\n  },\n\n  _endDraw(position, direction, normal) {\n    if (!this.lineStarted && this.drawStarted) {\n      this._drawPoint(position);\n    } else if (this.lineStarted && this.drawStarted) {\n      this._addToNetworkBuffer(position, direction, normal);\n      this._draw(position, direction, normal);\n      this._drawEndCap(position, direction);\n    }\n    this._endLine();\n  },\n\n  _drawEndCap: (() => {\n    const projectedDirection = new THREE.Vector3();\n    const projectedPoint = new THREE.Vector3();\n    return function(position, direction) {\n      if (this.lineStarted && this.drawStarted) {\n        projectedDirection.copy(direction).multiplyScalar(this.radius);\n        projectedPoint.copy(position).add(projectedDirection);\n        this._addDegenerateTriangle(); //flip faceculling order before drawing end-cap\n        this._drawCap(projectedPoint, this.lastSegments, direction);\n      }\n    };\n  })(),\n\n  _endLine() {\n    if (!this.drawStarted) return;\n\n    if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) this._pushToNetworkBuffer(null);\n\n    const datum = {\n      networkBufferCount: this.networkBufferCount,\n      idxLength: this.vertexCount - 1,\n      time: this.el.sceneEl.clock.elapsedTime * 1000\n    };\n    this.networkBufferHistory.push(datum);\n    this.vertexCount = 0;\n    this.networkBufferCount = 0;\n    this.currentPointCount = 0;\n    this.lineStarted = false;\n    this.drawStarted = false;\n  },\n\n  _addToNetworkBuffer: (() => {\n    const copyDirection = new THREE.Vector3();\n    const copyNormal = new THREE.Vector3();\n    return function(position, direction, normal) {\n      if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n        ++this.currentPointCount;\n        this._pushToNetworkBuffer(this.currentPointCount);\n        this._pushToNetworkBuffer(position.x);\n        this._pushToNetworkBuffer(position.y);\n        this._pushToNetworkBuffer(position.z);\n        copyDirection.copy(direction);\n        copyDirection.setLength(this.radius); //encode radius as length of direction vector\n        this._pushToNetworkBuffer(copyDirection.x);\n        this._pushToNetworkBuffer(copyDirection.y);\n        this._pushToNetworkBuffer(copyDirection.z);\n        copyNormal.copy(normal);\n        copyNormal.setLength(this.color.getHex() + 1); //encode color as length, add one in case color is black\n        this._pushToNetworkBuffer(copyNormal.x);\n        this._pushToNetworkBuffer(copyNormal.y);\n        this._pushToNetworkBuffer(copyNormal.z);\n      }\n    };\n  })(),\n\n  _pushToNetworkBuffer(val) {\n    //don't increment networkBufferCount if undo, because the undo character\n    //will be removed in tick() on the next frame\n    if (val !== \"-\") {\n      ++this.networkBufferCount;\n    }\n    this.networkBuffer.push(val);\n  },\n\n  //draw a cylinder from last to current segments\n  _drawCylinder() {\n    //average the normals with the normals from the lastSegment\n    //not a perfect normal calculation, but works well enough\n    for (let i = 0; i < this.segments; i++) {\n      this.currentSegments[i].normal.add(this.lastSegments[i].normal).multiplyScalar(0.5);\n    }\n\n    for (let i = 0; i != this.segments + 1; i++) {\n      this._addVertex(this.lastSegments[i % this.segments]);\n      this._addVertex(this.currentSegments[i % this.segments]);\n    }\n\n    for (let i = 0; i < this.segments; i++) {\n      this.lastSegments[i].position.copy(this.currentSegments[i].position);\n      this.lastSegments[i].normal.copy(this.currentSegments[i].normal);\n    }\n  },\n\n  //draw a standalone point in space\n  _drawPoint: (() => {\n    const up = new THREE.Vector3(0, 1, 0);\n    const down = new THREE.Vector3(0, -1, 0);\n    const left = new THREE.Vector3(1, 0, 0);\n    const projectedDirection = new THREE.Vector3();\n    const projectedPoint = new THREE.Vector3();\n    return function(position) {\n      projectedDirection.copy(up).multiplyScalar(this.radius * 0.75);\n      projectedPoint.copy(position).add(projectedDirection);\n      this.lastPoint.copy(projectedPoint);\n\n      projectedDirection.copy(up).multiplyScalar(this.radius * 0.5);\n      projectedPoint.copy(position).add(projectedDirection);\n      this._draw(projectedPoint, down, left, 0.75);\n\n      this._draw(position, down, left);\n\n      projectedDirection.copy(down).multiplyScalar(this.radius * 0.5);\n      projectedPoint.copy(position).add(projectedDirection);\n      this._draw(projectedPoint, down, left, 0.75);\n\n      projectedDirection.copy(down).multiplyScalar(this.radius * 0.75);\n      projectedPoint.copy(position).add(projectedDirection);\n\n      this._addDegenerateTriangle(); //discarded\n      this._drawCap(projectedPoint, this.lastSegments, down);\n    };\n  })(),\n\n  //draw a cap to start/end a line\n  _drawCap(point, segments, normal) {\n    let segmentIndex = 0;\n    for (let i = 0; i < this.segments * 2 - (this.segments % 2); i++) {\n      if ((i - 2) % 4 === 0) {\n        this._addVertex({ position: point, normal: normal });\n      } else {\n        this._addVertex(segments[segmentIndex % this.segments]);\n        if ((i + 1) % 5 !== 0) {\n          ++segmentIndex;\n        }\n      }\n    }\n  },\n\n  _restartPrimitive() {\n    this.sharedBuffer.restartPrimitive();\n    ++this.vertexCount;\n  },\n\n  _updateBuffer() {\n    this.sharedBuffer.update();\n  },\n\n  _addVertex(segment) {\n    const point = segment.position;\n    const normal = segment.normal;\n    this.sharedBuffer.addVertex(point.x, point.y, point.z);\n    this.sharedBuffer.addColor(this.color.r, this.color.g, this.color.b);\n\n    if (normal) {\n      this.sharedBuffer.addNormal(normal.x, normal.y, normal.z);\n    } else {\n      ++this.sharedBuffer.idx.normal;\n    }\n\n    ++this.sharedBuffer.idx.uv;\n    ++this.vertexCount;\n  },\n\n  _addDegenerateTriangle() {\n    this._addVertex(this.lastSegments[0]);\n  },\n\n  //calculate the segments for a given point\n  _generateSegments(segmentsList, point, forward, up, radius) {\n    const angleIncrement = (Math.PI * 2) / this.segments;\n    for (let i = 0; i < this.segments; i++) {\n      const segment = segmentsList[i].position;\n      this._rotatePointAroundAxis(segment, point, forward, up, angleIncrement * i, radius);\n      segmentsList[i].normal.subVectors(segment, point).normalize();\n    }\n  },\n\n  _rotatePointAroundAxis: (() => {\n    const calculatedDirection = new THREE.Vector3();\n    return function(out, point, axis, up, angle, radius) {\n      calculatedDirection.copy(up);\n      calculatedDirection.applyAxisAngle(axis, angle);\n      out.copy(point).add(calculatedDirection.normalize().multiplyScalar(radius));\n    };\n  })()\n});\n","function registerNetworkSchemas() {\n  const vectorRequiresUpdate = epsilon => {\n    return () => {\n      let prev = null;\n\n      return curr => {\n        if (prev === null) {\n          prev = new THREE.Vector3(curr.x, curr.y, curr.z);\n          return true;\n        } else if (!NAF.utils.almostEqualVec3(prev, curr, epsilon)) {\n          prev.copy(curr);\n          return true;\n        }\n\n        return false;\n      };\n    };\n  };\n\n  NAF.schemas.add({\n    template: \"#remote-avatar-template\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      \"scale\",\n      \"player-info\",\n      \"networked-avatar\",\n      {\n        selector: \".camera\",\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        selector: \".camera\",\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        selector: \".left-controller\",\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        selector: \".left-controller\",\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        selector: \".left-controller\",\n        component: \"visible\"\n      },\n      {\n        selector: \".right-controller\",\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        selector: \".right-controller\",\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        selector: \".right-controller\",\n        component: \"visible\"\n      }\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#interactable-media\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      \"scale\",\n      // TODO: Optimize checking mediaOptions with requiresNetworkUpdate.\n      \"media-loader\",\n      {\n        component: \"media-video\",\n        property: \"time\"\n      },\n      {\n        component: \"media-video\",\n        property: \"videoPaused\"\n      },\n      {\n        component: \"media-pager\",\n        property: \"index\"\n      },\n      \"pinnable\"\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#static-media\",\n    components: [\n      // TODO: Optimize checking mediaOptions with requiresNetworkUpdate.\n      \"media-loader\",\n      {\n        component: \"media-video\",\n        property: \"time\"\n      }\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#static-controlled-media\",\n    components: [\n      // TODO: Optimize checking mediaOptions with requiresNetworkUpdate.\n      \"media-loader\",\n      {\n        component: \"media-video\",\n        property: \"time\"\n      },\n      {\n        component: \"media-video\",\n        property: \"videoPaused\"\n      },\n      {\n        component: \"media-pager\",\n        property: \"index\"\n      }\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#interactable-drawing\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      \"scale\",\n      \"networked-drawing\"\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#interactable-camera\",\n    components: [\"position\", \"rotation\"]\n  });\n\n  NAF.schemas.add({\n    template: \"#pen-interactable\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      \"scale\",\n      \"media-loader\",\n      {\n        selector: \"#pen\",\n        component: \"pen\",\n        property: \"radius\"\n      },\n      {\n        selector: \"#pen\",\n        component: \"pen\",\n        property: \"color\"\n      }\n    ]\n  });\n}\n\nexport default registerNetworkSchemas;\n","import \"./utils/debug-log\";\n\nconsole.log(`Hubs version: ${process.env.BUILD_VERSION || \"?\"}`);\n\nimport \"./assets/stylesheets/hub.scss\";\n\nimport \"aframe\";\nimport \"./utils/logging\";\nimport { patchWebGLRenderingContext } from \"./utils/webgl\";\npatchWebGLRenderingContext();\n\nimport \"three/examples/js/loaders/GLTFLoader\";\nimport \"networked-aframe/src/index\";\nimport \"naf-janus-adapter\";\nimport \"aframe-billboard-component\";\nimport \"aframe-rounded\";\nimport \"webrtc-adapter\";\nimport \"aframe-slice9-component\";\nimport \"./utils/audio-context-fix\";\nimport \"./utils/threejs-positional-audio-updatematrixworld\";\nimport \"./utils/threejs-world-update\";\nimport patchThreeAllocations from \"./utils/threejs-allocation-patches\";\nimport { detectOS, detect } from \"detect-browser\";\nimport {\n  getReticulumFetchUrl,\n  getReticulumMeta,\n  invalidateReticulumMeta,\n  migrateChannelToSocket\n} from \"./utils/phoenix-utils\";\n\nimport nextTick from \"./utils/next-tick\";\nimport { addAnimationComponents } from \"./utils/animation\";\nimport Cookies from \"js-cookie\";\n\nimport \"./components/scene-components\";\nimport \"./components/mute-mic\";\nimport \"./components/bone-mute-state-indicator\";\nimport \"./components/bone-visibility\";\nimport \"./components/in-world-hud\";\nimport \"./components/virtual-gamepad-controls\";\nimport \"./components/ik-controller\";\nimport \"./components/hand-controls2\";\nimport \"./components/character-controller\";\nimport \"./components/hoverable-visuals\";\nimport \"./components/hover-visuals\";\nimport \"./components/offset-relative-to\";\nimport \"./components/player-info\";\nimport \"./components/debug\";\nimport \"./components/hand-poses\";\nimport \"./components/hud-controller\";\nimport \"./components/freeze-controller\";\nimport \"./components/icon-button\";\nimport \"./components/text-button\";\nimport \"./components/block-button\";\nimport \"./components/mute-button\";\nimport \"./components/kick-button\";\nimport \"./components/close-vr-notice-button\";\nimport \"./components/leave-room-button\";\nimport \"./components/visible-if-permitted\";\nimport \"./components/visibility-while-frozen\";\nimport \"./components/stats-plus\";\nimport \"./components/networked-avatar\";\nimport \"./components/media-views\";\nimport \"./components/avatar-volume-controls\";\nimport \"./components/pinch-to-move\";\nimport \"./components/pitch-yaw-rotator\";\nimport \"./components/position-at-box-shape-border\";\nimport \"./components/pinnable\";\nimport \"./components/pin-networked-object-button\";\nimport \"./components/drop-object-button\";\nimport \"./components/remove-networked-object-button\";\nimport \"./components/camera-focus-button\";\nimport \"./components/mirror-camera-button\";\nimport \"./components/unmute-video-button\";\nimport \"./components/destroy-at-extreme-distances\";\nimport \"./components/visible-to-owner\";\nimport \"./components/camera-tool\";\nimport \"./components/emit-state-change\";\nimport \"./components/action-to-event\";\nimport \"./components/action-to-remove\";\nimport \"./components/emit-scene-event-on-remove\";\nimport \"./components/follow-in-fov\";\nimport \"./components/matrix-auto-update\";\nimport \"./components/clone-media-button\";\nimport \"./components/open-media-button\";\nimport \"./components/transform-object-button\";\nimport \"./components/hover-menu\";\nimport \"./components/disable-frustum-culling\";\nimport \"./components/teleporter\";\nimport \"./components/set-active-camera\";\nimport \"./components/track-pose\";\nimport \"./components/replay\";\nimport \"./components/visibility-by-path\";\nimport \"./components/tags\";\nimport { sets as userinputSets } from \"./systems/userinput/sets\";\n\nimport ReactDOM from \"react-dom\";\nimport React from \"react\";\nimport { Router, Route } from \"react-router-dom\";\nimport { createBrowserHistory } from \"history\";\nimport { pushHistoryState } from \"./utils/history\";\nimport UIRoot from \"./react-components/ui-root\";\nimport AuthChannel from \"./utils/auth-channel\";\nimport HubChannel from \"./utils/hub-channel\";\nimport LinkChannel from \"./utils/link-channel\";\nimport { connectToReticulum } from \"./utils/phoenix-utils\";\nimport { disableiOSZoom } from \"./utils/disable-ios-zoom\";\nimport { traverseMeshesAndAddShapes, proxiedUrlFor } from \"./utils/media-utils\";\nimport { handleExitTo2DInterstitial, handleReEntryToVRFrom2DInterstitial } from \"./utils/vr-interstitial\";\nimport MessageDispatch from \"./message-dispatch\";\nimport SceneEntryManager from \"./scene-entry-manager\";\nimport Subscriptions from \"./subscriptions\";\nimport { createInWorldLogMessage } from \"./react-components/chat-message\";\n\nimport \"./systems/nav\";\nimport \"./systems/personal-space-bubble\";\nimport \"./systems/app-mode\";\nimport \"./systems/permissions\";\nimport \"./systems/exit-on-blur\";\nimport \"./systems/camera-tools\";\nimport \"./systems/userinput/userinput\";\nimport \"./systems/camera-mirror\";\nimport \"./systems/userinput/userinput-debug\";\nimport \"./systems/frame-scheduler\";\nimport \"./systems/ui-hotkeys\";\nimport \"./systems/tips\";\nimport \"./systems/interactions\";\nimport \"./systems/hubs-systems\";\nimport { SOUND_CHAT_MESSAGE } from \"./systems/sound-effects-system\";\n\nimport \"./gltf-component-mappings\";\n\nimport { App } from \"./App\";\n\nwindow.APP = new App();\nwindow.APP.RENDER_ORDER = {\n  HUD_BACKGROUND: 1,\n  HUD_ICONS: 2,\n  CURSOR: 3\n};\nconst store = window.APP.store;\nconst mediaSearchStore = window.APP.mediaSearchStore;\nconst OAUTH_FLOW_PERMS_TOKEN_KEY = \"ret-oauth-flow-perms-token\";\n\nconst qs = new URLSearchParams(location.search);\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\n\nTHREE.Object3D.DefaultMatrixAutoUpdate = false;\nwindow.APP.quality = qs.get(\"quality\") || (isMobile || isMobileVR) ? \"low\" : \"high\";\n\nconst Ammo = require(\"ammo.js/builds/ammo.wasm.js\");\nconst AmmoWasm = require(\"ammo.js/builds/ammo.wasm.wasm\");\nwindow.Ammo = Ammo.bind(undefined, {\n  locateFile(path) {\n    if (path.endsWith(\".wasm\")) {\n      return AmmoWasm;\n    }\n    return path;\n  }\n});\nrequire(\"aframe-physics-system\");\nimport \"./components/owned-object-limiter\";\nimport \"./components/set-unowned-body-kinematic\";\nimport \"./components/scalable-when-grabbed\";\nimport \"./components/networked-counter\";\nimport \"./components/event-repeater\";\nimport \"./components/set-yxz-order\";\n\nimport \"./components/cursor-controller\";\n\nimport \"./components/nav-mesh-helper\";\n\nimport \"./components/tools/pen\";\nimport \"./components/tools/networked-drawing\";\nimport \"./components/tools/drawing-manager\";\n\nimport registerNetworkSchemas from \"./network-schemas\";\nimport registerTelemetry from \"./telemetry\";\nimport { warmSerializeElement } from \"./utils/serialize-element\";\n\nimport { getAvailableVREntryTypes, VR_DEVICE_AVAILABILITY } from \"./utils/vr-caps-detect.js\";\nimport detectConcurrentLoad from \"./utils/concurrent-load-detector.js\";\n\nimport qsTruthy from \"./utils/qs_truthy\";\n\nconst PHOENIX_RELIABLE_NAF = \"phx-reliable\";\nNAF.options.firstSyncSource = PHOENIX_RELIABLE_NAF;\n\nconst isBotMode = qsTruthy(\"bot\");\nconst isTelemetryDisabled = qsTruthy(\"disable_telemetry\");\nconst isDebug = qsTruthy(\"debug\");\nconst loadingEnvironmentURL = proxiedUrlFor(\n  \"https://uploads-prod.reticulum.io/files/61d77151-7a74-40a6-b427-0c5a350c4502.glb\"\n);\n\nif (!isBotMode && !isTelemetryDisabled) {\n  registerTelemetry(\"/hub\", \"Room Landing Page\");\n}\n\ndisableiOSZoom();\ndetectConcurrentLoad();\n\nstore.init();\n\nfunction getPlatformUnsupportedReason() {\n  if (typeof RTCDataChannelEvent === \"undefined\") return \"no_data_channels\";\n  return null;\n}\n\nfunction setupLobbyCamera() {\n  const camera = document.querySelector(\"#player-camera\");\n  const previewCamera = document.querySelector(\"#environment-scene\").object3D.getObjectByName(\"scene-preview-camera\");\n\n  if (previewCamera) {\n    camera.object3D.position.copy(previewCamera.position);\n    camera.object3D.rotation.copy(previewCamera.rotation);\n    camera.object3D.rotation.reorder(\"YXZ\");\n  } else {\n    const cameraPos = camera.object3D.position;\n    camera.object3D.position.set(cameraPos.x, 2.5, cameraPos.z);\n  }\n\n  camera.object3D.matrixNeedsUpdate = true;\n\n  camera.setAttribute(\"scene-preview-camera\", \"positionOnly: true; duration: 60\");\n  camera.components[\"pitch-yaw-rotator\"].set(camera.object3D.rotation.x, camera.object3D.rotation.y);\n}\n\nlet uiProps = {};\n\n// Hub ID and slug are the basename\nlet routerBaseName = document.location.pathname\n  .split(\"/\")\n  .slice(0, 2)\n  .join(\"/\");\n\nif (document.location.pathname.includes(\"hub.html\")) {\n  routerBaseName = \"\";\n}\n\nconst history = createBrowserHistory({ basename: routerBaseName });\nwindow.APP.history = history;\n\nfunction mountUI(props = {}) {\n  const scene = document.querySelector(\"a-scene\");\n  const disableAutoExitOnConcurrentLoad = qsTruthy(\"allow_multi\");\n  const forcedVREntryType = qs.get(\"vr_entry_type\");\n  const isCursorHoldingPen = scene && scene.systems.userinput.activeSets.includes(userinputSets.cursorHoldingPen);\n  const hasActiveCamera = scene && !!scene.systems[\"camera-tools\"].getMyCamera();\n\n  ReactDOM.render(\n    <Router history={history}>\n      <Route\n        render={routeProps => (\n          <UIRoot\n            {...{\n              scene,\n              isBotMode,\n              disableAutoExitOnConcurrentLoad,\n              forcedVREntryType,\n              store,\n              mediaSearchStore,\n              isCursorHoldingPen,\n              hasActiveCamera,\n              ...props,\n              ...routeProps\n            }}\n          />\n        )}\n      />\n    </Router>,\n    document.getElementById(\"ui-root\")\n  );\n}\n\nfunction remountUI(props) {\n  uiProps = { ...uiProps, ...props };\n  mountUI(uiProps);\n}\n\nasync function updateUIForHub(hub) {\n  remountUI({\n    hubId: hub.hub_id,\n    hubName: hub.name,\n    hubScene: hub.scene,\n    hubEntryCode: hub.entry_code\n  });\n}\n\nasync function updateEnvironmentForHub(hub) {\n  let sceneUrl;\n  let isLegacyBundle; // Deprecated\n\n  const environmentScene = document.querySelector(\"#environment-scene\");\n  const sceneEl = document.querySelector(\"a-scene\");\n\n  if (hub.scene) {\n    isLegacyBundle = false;\n    sceneUrl = hub.scene.model_url;\n  } else if (hub.scene === null) {\n    // delisted/removed scene\n    sceneUrl = loadingEnvironmentURL;\n  } else {\n    const defaultSpaceTopic = hub.topics[0];\n    const glbAsset = defaultSpaceTopic.assets.find(a => a.asset_type === \"glb\");\n    const bundleAsset = defaultSpaceTopic.assets.find(a => a.asset_type === \"gltf_bundle\");\n    sceneUrl = (glbAsset || bundleAsset).src;\n    const hasExtension = /\\.gltf/i.test(sceneUrl) || /\\.glb/i.test(sceneUrl);\n    isLegacyBundle = !(glbAsset || hasExtension);\n  }\n\n  if (isLegacyBundle) {\n    // Deprecated\n    const res = await fetch(sceneUrl);\n    const data = await res.json();\n    const baseURL = new URL(THREE.LoaderUtils.extractUrlBase(sceneUrl), window.location.href);\n    sceneUrl = new URL(data.assets[0].src, baseURL).href;\n  } else {\n    sceneUrl = proxiedUrlFor(sceneUrl);\n  }\n\n  console.log(`Scene URL: ${sceneUrl}`);\n\n  let environmentEl = null;\n\n  if (environmentScene.childNodes.length === 0) {\n    const environmentEl = document.createElement(\"a-entity\");\n    environmentEl.setAttribute(\"gltf-model-plus\", { src: sceneUrl, useCache: false, inflate: true });\n\n    environmentScene.appendChild(environmentEl);\n\n    environmentEl.addEventListener(\n      \"model-loaded\",\n      () => {\n        //TODO: check if the environment was made with spoke to determine if a shape should be added\n        traverseMeshesAndAddShapes(environmentEl);\n      },\n      { once: true }\n    );\n  } else {\n    // Change environment\n    environmentEl = environmentScene.childNodes[0];\n\n    // Clear the three.js image cache and load the loading environment before switching to the new one.\n    THREE.Cache.clear();\n\n    environmentEl.addEventListener(\n      \"model-loaded\",\n      () => {\n        environmentEl.addEventListener(\n          \"model-loaded\",\n          () => {\n            traverseMeshesAndAddShapes(environmentEl);\n\n            // We've already entered, so move to new spawn point once new environment is loaded\n            if (sceneEl.is(\"entered\")) {\n              document.querySelector(\"#player-rig\").components[\"spawn-controller\"].moveToSpawnPoint();\n            }\n          },\n          { once: true }\n        );\n\n        environmentEl.setAttribute(\"gltf-model-plus\", { src: sceneUrl });\n      },\n      { once: true }\n    );\n\n    environmentEl.setAttribute(\"gltf-model-plus\", { src: loadingEnvironmentURL });\n  }\n}\n\nasync function handleHubChannelJoined(entryManager, hubChannel, messageDispatch, data) {\n  const scene = document.querySelector(\"a-scene\");\n  const isRejoin = NAF.connection.isConnected();\n\n  if (isRejoin) {\n    // Slight hack, to ensure correct presence state we need to re-send the entry event\n    // on re-join. Ideally this would be updated into the channel socket state but this\n    // would require significant changes to the hub channel events and socket management.\n    if (scene.is(\"entered\")) {\n      hubChannel.sendEntryEvent();\n    }\n\n    // Send complete sync on phoenix re-join.\n    NAF.connection.entities.completeSync(null, true);\n    return;\n  }\n\n  const hub = data.hubs[0];\n\n  console.log(`Janus host: ${hub.host}`);\n\n  const objectsScene = document.querySelector(\"#objects-scene\");\n  const objectsUrl = getReticulumFetchUrl(`/${hub.hub_id}/objects.gltf`);\n  const objectsEl = document.createElement(\"a-entity\");\n  objectsEl.setAttribute(\"gltf-model-plus\", { src: objectsUrl, useCache: false, inflate: true });\n\n  if (!isBotMode) {\n    objectsScene.appendChild(objectsEl);\n  }\n\n  updateEnvironmentForHub(hub);\n  updateUIForHub(hub);\n\n  remountUI({\n    onSendMessage: messageDispatch.dispatch,\n    onMediaSearchResultEntrySelected: entry => scene.emit(\"action_selected_media_result_entry\", entry),\n    onMediaSearchCancelled: entry => scene.emit(\"action_media_search_cancelled\", entry)\n  });\n\n  scene.addEventListener(\"action_selected_media_result_entry\", e => {\n    const entry = e.detail;\n    if (entry.type !== \"scene_listing\" && entry.type !== \"scene\") return;\n    if (!hubChannel.can(\"update_hub\")) return;\n\n    hubChannel.updateScene(entry.url);\n  });\n\n  scene.addEventListener(\"scene_media_selected\", e => {\n    hubChannel.updateScene(e.detail);\n  });\n\n  // Handle request for user gesture\n  scene.addEventListener(\"2d-interstitial-gesture-required\", () => {\n    remountUI({\n      showInterstitialPrompt: true,\n      onInterstitialPromptClicked: () => {\n        scene.emit(\"2d-interstitial-gesture-complete\");\n        remountUI({ showInterstitialPrompt: false, onInterstitialPromptClicked: null });\n      }\n    });\n  });\n\n  // Wait for scene objects to load before connecting, so there is no race condition on network state.\n  const connectToScene = async () => {\n    scene.setAttribute(\"networked-scene\", {\n      room: hub.hub_id,\n      serverURL: `wss://${hub.host}`,\n      debug: !!isDebug\n    });\n\n    while (!scene.components[\"networked-scene\"] || !scene.components[\"networked-scene\"].data) await nextTick();\n\n    scene.addEventListener(\"adapter-ready\", ({ detail: adapter }) => {\n      let newHostPollInterval = null;\n\n      // When reconnecting, update the server URL if necessary\n      adapter.setReconnectionListeners(\n        () => {\n          if (newHostPollInterval) return;\n\n          newHostPollInterval = setInterval(async () => {\n            const currentServerURL = NAF.connection.adapter.serverUrl;\n            const newHubHost = await hubChannel.getHost();\n            const newServerURL = `wss://${newHubHost}`;\n\n            if (currentServerURL !== newServerURL) {\n              console.log(\"Connecting to new Janus server \" + newServerURL);\n              scene.setAttribute(\"networked-scene\", { serverURL: newServerURL });\n              adapter.serverUrl = newServerURL;\n            }\n          }, 1000);\n        },\n        () => {\n          clearInterval(newHostPollInterval);\n          newHostPollInterval = null;\n        },\n        null\n      );\n\n      const sendViaPhoenix = reliable => (clientId, dataType, data) => {\n        const payload = { dataType, data };\n\n        if (clientId) {\n          payload.clientId = clientId;\n        }\n\n        const isOpen = hubChannel.channel.socket.connectionState() === \"open\";\n\n        if (isOpen || reliable) {\n          if (isOpen) {\n            hubChannel.channel.push(\"naf\", payload);\n          } else {\n            // Memory is re-used, so make a copy\n            hubChannel.channel.push(\"naf\", AFRAME.utils.clone(payload));\n          }\n        }\n      };\n\n      adapter.reliableTransport = sendViaPhoenix(true);\n      adapter.unreliableTransport = sendViaPhoenix(false);\n    });\n\n    scene.components[\"networked-scene\"]\n      .connect()\n      .then(() => scene.emit(\"didConnectToNetworkedScene\"))\n      .catch(connectError => {\n        // hacky until we get return codes\n        const isFull = connectError.error && connectError.error.msg.match(/\\bfull\\b/i);\n        console.error(connectError);\n        remountUI({ roomUnavailableReason: isFull ? \"full\" : \"connect_error\" });\n        entryManager.exitScene();\n\n        return;\n      });\n  };\n\n  if (!isBotMode) {\n    objectsEl.addEventListener(\"model-loaded\", async el => {\n      if (el.target !== objectsEl) return;\n      connectToScene();\n    });\n  } else {\n    connectToScene();\n  }\n}\n\nasync function runBotMode(scene, entryManager) {\n  const noop = () => {};\n  scene.renderer = { setAnimationLoop: noop, render: noop };\n\n  while (!NAF.connection.isConnected()) await nextTick();\n  entryManager.enterSceneWhenLoaded(new MediaStream(), false);\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", async () => {\n  warmSerializeElement();\n\n  // HACK: On Safari for iOS & MacOS, if mic permission is not granted, subscriber webrtc negotiation fails.\n  const detectedOS = detectOS(navigator.userAgent);\n  const browser = detect();\n  if ([\"iOS\", \"Mac OS\"].includes(detectedOS) && [\"safari\", \"ios\"].includes(browser.name)) {\n    try {\n      await navigator.mediaDevices.getUserMedia({ audio: true });\n    } catch (e) {\n      remountUI({ showSafariMicDialog: true });\n      return;\n    }\n  }\n\n  const hubId = qs.get(\"hub_id\") || document.location.pathname.substring(1).split(\"/\")[0];\n  console.log(`Hub ID: ${hubId}`);\n\n  const subscriptions = new Subscriptions(hubId);\n\n  if (navigator.serviceWorker) {\n    try {\n      navigator.serviceWorker\n        .register(\"/hub.service.js\")\n        .then(() => {\n          navigator.serviceWorker.ready\n            .then(registration => subscriptions.setRegistration(registration))\n            .catch(() => subscriptions.setRegistrationFailed());\n        })\n        .catch(() => subscriptions.setRegistrationFailed());\n    } catch (e) {\n      subscriptions.setRegistrationFailed();\n    }\n  } else {\n    subscriptions.setRegistrationFailed();\n  }\n\n  const scene = document.querySelector(\"a-scene\");\n  scene.setAttribute(\"shadow\", { enabled: window.APP.quality !== \"low\" }); // Disable shadows on low quality\n\n  // Physics needs to be ready before spawning anything.\n  while (!scene.systems.physics.initialized) await nextTick();\n\n  const onSceneLoaded = () => {\n    const physicsSystem = scene.systems.physics;\n    physicsSystem.setDebug(isDebug || physicsSystem.data.debug);\n    patchThreeAllocations();\n  };\n\n  if (scene.hasLoaded) {\n    onSceneLoaded();\n  } else {\n    scene.addEventListener(\"loaded\", onSceneLoaded, { once: true });\n  }\n\n  const authChannel = new AuthChannel(store);\n  const hubChannel = new HubChannel(store, hubId);\n  const availableVREntryTypes = await getAvailableVREntryTypes();\n  const entryManager = new SceneEntryManager(hubChannel, authChannel, availableVREntryTypes, history);\n  const performConditionalSignIn = async (predicate, action, messageId, onFailure) => {\n    if (predicate()) return action();\n\n    const signInContinueTextId = scene.is(\"vr-mode\") ? \"entry.return-to-vr\" : \"dialog.close\";\n\n    handleExitTo2DInterstitial(true, () => remountUI({ showSignInDialog: false }));\n\n    remountUI({\n      showSignInDialog: true,\n      signInMessageId: `sign-in.${messageId}`,\n      signInCompleteMessageId: `sign-in.${messageId}-complete`,\n      signInContinueTextId,\n      onContinueAfterSignIn: async () => {\n        remountUI({ showSignInDialog: false });\n        let actionError = null;\n        if (predicate()) {\n          try {\n            await action();\n          } catch (e) {\n            actionError = e;\n          }\n        } else {\n          actionError = new Error(\"Predicate failed post sign-in\");\n        }\n\n        if (actionError && onFailure) onFailure(actionError);\n        handleReEntryToVRFrom2DInterstitial();\n      }\n    });\n  };\n\n  window.addEventListener(\"action_create_avatar\", () => {\n    performConditionalSignIn(\n      () => hubChannel.signedIn,\n      () => pushHistoryState(history, \"overlay\", \"avatar-editor\"),\n      \"create-avatar\"\n    );\n  });\n\n  remountUI({ performConditionalSignIn });\n  entryManager.performConditionalSignIn = performConditionalSignIn;\n  entryManager.init();\n\n  const linkChannel = new LinkChannel(store);\n\n  window.APP.scene = scene;\n  window.APP.hubChannel = hubChannel;\n\n  const handleEarlyVRMode = () => {\n    // If VR headset is activated, refreshing page will fire vrdisplayactivate\n    // which puts A-Frame in VR mode, so exit VR mode whenever it is attempted\n    // to be entered and we haven't entered the room yet.\n    if (scene.is(\"vr-mode\") && !scene.is(\"vr-entered\")) {\n      console.log(\"Pre-emptively exiting VR mode.\");\n      scene.exitVR();\n      return true;\n    }\n\n    return false;\n  };\n\n  scene.addEventListener(\"enter-vr\", () => {\n    if (handleEarlyVRMode()) return true;\n\n    if (isMobileVR) {\n      // Optimization, stop drawing UI if not visible\n      remountUI({ hide: true });\n    }\n\n    document.body.classList.add(\"vr-mode\");\n\n    // Don't stretch canvas on cardboard, since that's drawing the actual VR view :)\n    if ((!isMobile && !isMobileVR) || availableVREntryTypes.cardboard !== VR_DEVICE_AVAILABILITY.yes) {\n      document.body.classList.add(\"vr-mode-stretch\");\n    }\n  });\n\n  handleEarlyVRMode();\n\n  // HACK A-Frame 0.9.0 seems to fail to wire up vrdisplaypresentchange early enough\n  // to catch presentation state changes and recognize that an HMD is presenting on startup.\n  window.addEventListener(\n    \"vrdisplaypresentchange\",\n    () => {\n      if (scene.is(\"vr-entered\")) return;\n      if (scene.is(\"vr-mode\")) return;\n\n      const device = AFRAME.utils.device.getVRDisplay();\n\n      if (device && device.isPresenting) {\n        if (!scene.is(\"vr-mode\")) {\n          console.warn(\"Hit A-Frame bug where VR display is presenting but A-Frame has not entered VR mode.\");\n          scene.enterVR();\n        }\n      }\n    },\n    { once: true }\n  );\n\n  scene.addEventListener(\"exit-vr\", () => {\n    document.body.classList.remove(\"vr-mode\");\n    document.body.classList.remove(\"vr-mode-stretch\");\n\n    remountUI({ hide: false });\n\n    // HACK: Oculus browser pauses videos when exiting VR mode, so we need to resume them after a timeout.\n    if (/OculusBrowser/i.test(window.navigator.userAgent)) {\n      document.querySelectorAll(\"[media-video]\").forEach(m => {\n        const video = m.components[\"media-video\"].video;\n\n        if (!video.paused) {\n          setTimeout(() => video.play(), 1000);\n        }\n      });\n    }\n  });\n\n  registerNetworkSchemas();\n\n  remountUI({\n    authChannel,\n    hubChannel,\n    linkChannel,\n    subscriptions,\n    enterScene: entryManager.enterScene,\n    exitScene: reason => {\n      entryManager.exitScene();\n\n      if (reason) {\n        remountUI({ roomUnavailableReason: reason });\n      }\n    },\n    initialIsSubscribed: subscriptions.isSubscribed(),\n    activeTips: scene.systems.tips.activeTips\n  });\n\n  scene.addEventListener(\"action_focus_chat\", () => {\n    const chatFocusTarget = document.querySelector(\".chat-focus-target\");\n    chatFocusTarget && chatFocusTarget.focus();\n  });\n\n  scene.addEventListener(\"tips_changed\", e => {\n    remountUI({ activeTips: e.detail });\n  });\n\n  scene.addEventListener(\"leave_room_requested\", () => {\n    scene.exitVR();\n    entryManager.exitScene(\"left\");\n    remountUI({ roomUnavailableReason: \"left\" });\n  });\n\n  scene.addEventListener(\"camera_toggled\", () => remountUI({}));\n\n  scene.addEventListener(\"camera_removed\", () => remountUI({}));\n\n  scene.addEventListener(\"hub_closed\", () => {\n    scene.exitVR();\n    entryManager.exitScene(\"closed\");\n    remountUI({ roomUnavailableReason: \"closed\" });\n  });\n\n  const platformUnsupportedReason = getPlatformUnsupportedReason();\n\n  if (platformUnsupportedReason) {\n    remountUI({ platformUnsupportedReason });\n    entryManager.exitScene();\n    return;\n  }\n\n  if (qs.get(\"required_version\") && process.env.BUILD_VERSION) {\n    const buildNumber = process.env.BUILD_VERSION.split(\" \", 1)[0]; // e.g. \"123 (abcd5678)\"\n\n    if (qs.get(\"required_version\") !== buildNumber) {\n      remountUI({ roomUnavailableReason: \"version_mismatch\" });\n      setTimeout(() => document.location.reload(), 5000);\n      entryManager.exitScene();\n      return;\n    }\n  }\n\n  getReticulumMeta().then(reticulumMeta => {\n    console.log(`Reticulum @ ${reticulumMeta.phx_host}: v${reticulumMeta.version} on ${reticulumMeta.pool}`);\n\n    if (\n      qs.get(\"required_ret_version\") &&\n      (qs.get(\"required_ret_version\") !== reticulumMeta.version || qs.get(\"required_ret_pool\") !== reticulumMeta.pool)\n    ) {\n      remountUI({ roomUnavailableReason: \"version_mismatch\" });\n      setTimeout(() => document.location.reload(), 5000);\n      entryManager.exitScene();\n      return;\n    }\n  });\n\n  if (isMobileVR) {\n    remountUI({ availableVREntryTypes, forcedVREntryType: \"vr\" });\n\n    if (/Oculus/.test(navigator.userAgent)) {\n      // HACK - The polyfill reports Cardboard as the primary VR display on startup out ahead of Oculus Go on Oculus Browser 5.5.0 beta. This display is cached by A-Frame,\n      // so we need to resolve that and get the real VRDisplay before entering as well.\n      const displays = await navigator.getVRDisplays();\n      const vrDisplay = displays.length && displays[0];\n      AFRAME.utils.device.getVRDisplay = () => vrDisplay;\n    }\n  } else {\n    remountUI({ availableVREntryTypes });\n  }\n\n  const environmentScene = document.querySelector(\"#environment-scene\");\n\n  const onFirstEnvironmentLoad = () => {\n    if (!scene.is(\"entered\")) {\n      setupLobbyCamera();\n    }\n\n    // Replace renderer with a noop renderer to reduce bot resource usage.\n    if (isBotMode) {\n      runBotMode(scene, entryManager);\n    }\n\n    environmentScene.removeEventListener(\"model-loaded\", onFirstEnvironmentLoad);\n  };\n\n  environmentScene.addEventListener(\"model-loaded\", onFirstEnvironmentLoad);\n\n  environmentScene.addEventListener(\"model-loaded\", () => {\n    // This will be run every time the environment is changed (including the first load.)\n    remountUI({ environmentSceneLoaded: true });\n    scene.emit(\"environment-scene-loaded\");\n\n    // Re-bind the teleporter controls collision meshes in case the scene changed.\n    document.querySelectorAll(\"a-entity[teleporter]\").forEach(x => x.components[\"teleporter\"].queryCollisionEntities());\n\n    for (const modelEl of environmentScene.children) {\n      addAnimationComponents(modelEl);\n    }\n  });\n\n  const socket = await connectToReticulum(isDebug);\n\n  socket.onClose(e => {\n    // The socket should close normally if the server has explicitly killed it.\n    const NORMAL_CLOSURE = 1000;\n    if (e.code === NORMAL_CLOSURE) {\n      entryManager.exitScene();\n      remountUI({ roomUnavailableReason: \"kicked\" });\n    }\n  });\n\n  let retDeployReconnectInterval;\n  const retReconnectMaxDelayMs = 15000;\n\n  // Reticulum global channel\n  let retPhxChannel = socket.channel(`ret`, { hub_id: hubId });\n  retPhxChannel\n    .join()\n    .receive(\"ok\", async data => subscriptions.setVapidPublicKey(data.vapid_public_key))\n    .receive(\"error\", res => {\n      subscriptions.setVapidPublicKey(null);\n      console.error(res);\n    });\n\n  const pushSubscriptionEndpoint = await subscriptions.getCurrentEndpoint();\n\n  const oauthFlowPermsToken = Cookies.get(OAUTH_FLOW_PERMS_TOKEN_KEY);\n\n  if (oauthFlowPermsToken) {\n    Cookies.remove(OAUTH_FLOW_PERMS_TOKEN_KEY);\n  }\n\n  const createHubChannelParams = permsToken => {\n    const params = {\n      profile: store.state.profile,\n      push_subscription_endpoint: pushSubscriptionEndpoint,\n      auth_token: null,\n      perms_token: null,\n      context: {\n        mobile: isMobile || isMobileVR,\n        hmd: availableVREntryTypes.isInHMD\n      }\n    };\n\n    if (permsToken) {\n      params.perms_token = permsToken;\n    }\n\n    const { token } = store.state.credentials;\n    if (token) {\n      console.log(`Logged into account ${store.credentialsAccountId}`);\n      params.auth_token = token;\n    }\n\n    return params;\n  };\n\n  const migrateToNewReticulumServer = async deployNotification => {\n    // On Reticulum deploys, reconnect after a random delay until pool + version match deployed version/pool\n    console.log(`Reticulum deploy detected v${deployNotification.ret_version} on ${deployNotification.ret_pool}`);\n    clearInterval(retDeployReconnectInterval);\n\n    setTimeout(() => {\n      const tryReconnect = async () => {\n        invalidateReticulumMeta();\n        const reticulumMeta = await getReticulumMeta();\n\n        if (\n          reticulumMeta.pool === deployNotification.ret_pool &&\n          reticulumMeta.version === deployNotification.ret_version\n        ) {\n          console.log(\"Reticulum reconnecting.\");\n          clearInterval(retDeployReconnectInterval);\n          const oldSocket = retPhxChannel.socket;\n          const socket = await connectToReticulum(isDebug, oldSocket.params());\n          retPhxChannel = await migrateChannelToSocket(retPhxChannel, socket);\n          await hubChannel.migrateToSocket(socket, createHubChannelParams());\n          authChannel.setSocket(socket);\n          linkChannel.setSocket(socket);\n\n          // Disconnect old socket after a delay to ensure this user is always registered in presence.\n          setTimeout(() => {\n            console.log(\"Reconnection complete. Disconnecting old reticulum socket.\");\n            oldSocket.teardown();\n          }, 10000);\n        }\n      };\n\n      retDeployReconnectInterval = setInterval(tryReconnect, 5000);\n      tryReconnect();\n    }, Math.floor(Math.random() * retReconnectMaxDelayMs));\n  };\n\n  retPhxChannel.on(\"notice\", async data => {\n    // On Reticulum deploys, reconnect after a random delay until pool + version match deployed version/pool\n    if (data.event === \"ret-deploy\") {\n      await migrateToNewReticulumServer(data);\n    }\n  });\n\n  const hubPhxChannel = socket.channel(`hub:${hubId}`, createHubChannelParams(oauthFlowPermsToken));\n\n  const presenceLogEntries = [];\n  const addToPresenceLog = entry => {\n    entry.key = Date.now().toString();\n\n    presenceLogEntries.push(entry);\n    remountUI({ presenceLogEntries });\n    if (entry.type === \"chat\") {\n      scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CHAT_MESSAGE);\n    }\n\n    // Fade out and then remove\n    setTimeout(() => {\n      entry.expired = true;\n      remountUI({ presenceLogEntries });\n\n      setTimeout(() => {\n        presenceLogEntries.splice(presenceLogEntries.indexOf(entry), 1);\n        remountUI({ presenceLogEntries });\n      }, 5000);\n    }, 20000);\n  };\n\n  const messageDispatch = new MessageDispatch(\n    scene,\n    entryManager,\n    hubChannel,\n    addToPresenceLog,\n    remountUI,\n    mediaSearchStore\n  );\n\n  let isInitialJoin = true;\n\n  hubChannel.setPhoenixChannel(hubPhxChannel);\n\n  hubPhxChannel\n    .join()\n    .receive(\"ok\", async data => {\n      socket.params().session_id = data.session_id;\n      socket.params().session_token = data.session_token;\n\n      const vrHudPresenceCount = document.querySelector(\"#hud-presence-count\");\n\n      if (isInitialJoin) {\n        store.addEventListener(\"statechanged\", hubChannel.sendProfileUpdate.bind(hubChannel));\n        hubChannel.presence.onSync(() => {\n          const presence = hubChannel.presence;\n\n          remountUI({\n            sessionId: socket.params().session_id,\n            presences: presence.state\n          });\n\n          const occupantCount = Object.entries(presence.state).length;\n          vrHudPresenceCount.setAttribute(\"text\", \"value\", occupantCount.toString());\n\n          if (occupantCount > 1) {\n            scene.addState(\"copresent\");\n          } else {\n            scene.removeState(\"copresent\");\n          }\n\n          // HACK - Set a flag on the presence object indicating if the initial sync has completed,\n          // which is used to determine if we should fire join/leave messages into the presence log.\n          presence.__hadInitialSync = true;\n\n          presence.onJoin((sessionId, current, info) => {\n            // Ignore presence join/leaves if this Presence has not yet had its initial sync (o/w the user\n            // will see join messages for every user.)\n            if (!hubChannel.presence.__hadInitialSync) return;\n\n            const meta = info.metas[info.metas.length - 1];\n\n            if (current) {\n              // Change to existing presence\n              const isSelf = sessionId === socket.params().session_id;\n              const currentMeta = current.metas[0];\n\n              if (\n                !isSelf &&\n                currentMeta.presence !== meta.presence &&\n                meta.presence === \"room\" &&\n                meta.profile.displayName\n              ) {\n                addToPresenceLog({\n                  type: \"entered\",\n                  presence: meta.presence,\n                  name: meta.profile.displayName\n                });\n              }\n\n              if (currentMeta.profile && meta.profile && currentMeta.profile.displayName !== meta.profile.displayName) {\n                addToPresenceLog({\n                  type: \"display_name_changed\",\n                  oldName: currentMeta.profile.displayName,\n                  newName: meta.profile.displayName\n                });\n              }\n            } else if (info.metas.length === 1) {\n              // New presence\n              const meta = info.metas[0];\n\n              if (meta.presence && meta.profile.displayName) {\n                addToPresenceLog({\n                  type: \"join\",\n                  presence: meta.presence,\n                  name: meta.profile.displayName\n                });\n              }\n            }\n\n            scene.emit(\"presence_updated\", { sessionId, profile: meta.profile, roles: meta.roles });\n          });\n\n          presence.onLeave((sessionId, current, info) => {\n            // Ignore presence join/leaves if this Presence has not yet had its initial sync\n            if (!hubChannel.presence.__hadInitialSync) return;\n\n            if (current && current.metas.length > 0) return;\n\n            const meta = info.metas[0];\n\n            if (meta.profile.displayName) {\n              addToPresenceLog({\n                type: \"leave\",\n                name: meta.profile.displayName\n              });\n            }\n          });\n        });\n      }\n\n      isInitialJoin = false;\n\n      const permsToken = oauthFlowPermsToken || data.perms_token;\n      hubChannel.setPermissionsFromToken(permsToken);\n\n      scene.addEventListener(\"adapter-ready\", ({ detail: adapter }) => {\n        adapter.setClientId(socket.params().session_id);\n        adapter.setJoinToken(data.perms_token);\n        hubChannel.addEventListener(\"permissions-refreshed\", e => adapter.setJoinToken(e.detail.permsToken));\n      });\n      subscriptions.setHubChannel(hubChannel);\n\n      subscriptions.setSubscribed(data.subscriptions.web_push);\n\n      remountUI({\n        hubIsBound: data.hub_requires_oauth,\n        initialIsSubscribed: subscriptions.isSubscribed()\n      });\n\n      await handleHubChannelJoined(entryManager, hubChannel, messageDispatch, data);\n    })\n    .receive(\"error\", res => {\n      if (res.reason === \"closed\") {\n        entryManager.exitScene();\n        remountUI({ roomUnavailableReason: \"closed\" });\n      } else if (res.reason === \"oauth_required\") {\n        entryManager.exitScene();\n        remountUI({ oauthInfo: res.oauth_info, showOAuthDialog: true });\n      } else if (res.reason === \"join_denied\") {\n        entryManager.exitScene();\n        remountUI({ roomUnavailableReason: \"denied\" });\n      }\n\n      console.error(res);\n    });\n\n  hubPhxChannel.on(\"naf\", data => {\n    if (!NAF.connection.adapter) return;\n    NAF.connection.adapter.onData(data, PHOENIX_RELIABLE_NAF);\n  });\n\n  hubPhxChannel.on(\"message\", ({ session_id, type, body, from }) => {\n    const getAuthor = () => {\n      const userInfo = hubChannel.presence.state[session_id];\n      if (from) {\n        return from;\n      } else if (userInfo) {\n        return userInfo.metas[0].profile.displayName;\n      } else {\n        return \"Mystery user\";\n      }\n    };\n\n    const name = getAuthor();\n    const maySpawn = scene.is(\"entered\");\n\n    const incomingMessage = { name, type, body, maySpawn, sessionId: session_id };\n\n    if (scene.is(\"vr-mode\")) {\n      createInWorldLogMessage(incomingMessage);\n    }\n\n    addToPresenceLog(incomingMessage);\n  });\n\n  hubPhxChannel.on(\"hub_refresh\", ({ session_id, hubs, stale_fields }) => {\n    const hub = hubs[0];\n    const userInfo = hubChannel.presence.state[session_id];\n\n    updateUIForHub(hub);\n\n    if (stale_fields.includes(\"scene\")) {\n      updateEnvironmentForHub(hub);\n\n      addToPresenceLog({\n        type: \"scene_changed\",\n        name: userInfo.metas[0].profile.displayName,\n        sceneName: hub.scene ? hub.scene.name : \"a custom URL\"\n      });\n    }\n\n    if (stale_fields.includes(\"name\")) {\n      const titleParts = document.title.split(\" | \"); // Assumes title has | trailing site name\n      titleParts[0] = hub.name;\n      document.title = titleParts.join(\" | \");\n\n      // Re-write the slug in the browser history\n      const pathParts = history.location.pathname.split(\"/\");\n      const oldSlug = pathParts[1];\n      const { search, state } = history.location;\n      const pathname = history.location.pathname.replace(`/${oldSlug}`, `/${hub.slug}`);\n\n      history.replace({ pathname, search, state });\n\n      addToPresenceLog({\n        type: \"hub_name_changed\",\n        name: userInfo.metas[0].profile.displayName,\n        hubName: hub.name\n      });\n    }\n\n    if (hub.entry_mode === \"deny\") {\n      scene.emit(\"hub_closed\");\n    }\n  });\n\n  hubPhxChannel.on(\"mute\", ({ session_id }) => {\n    if (session_id === NAF.clientId && !scene.is(\"muted\")) {\n      scene.emit(\"action_mute\");\n    }\n  });\n\n  authChannel.setSocket(socket);\n  linkChannel.setSocket(socket);\n});\n","// Stores a key in localStorage and registeres a listener for the same key being set (by another tab).\n// When detected, fire a \"concurrentload\" event.\nexport default function detectConcurrentLoad(instanceKey = \"global\") {\n  const key = `___concurrent_load_detector_${instanceKey}`;\n  localStorage.setItem(key, JSON.stringify({ started_at: new Date() }));\n  const onStorageEvent = e => {\n    if (e.key !== key) return;\n    window.dispatchEvent(new CustomEvent(\"concurrentload\"));\n    window.removeEventListener(\"storage\", onStorageEvent);\n  };\n  window.addEventListener(\"storage\", onStorageEvent);\n}\n","export default function patchThreeAllocations() {\n  const renderer = AFRAME.scenes[0].renderer;\n  const gl = renderer.context;\n\n  // These functions in three.js uses the arguments object, which allocates.\n  renderer.state.texImage2D = function(a, b, c, d, e, f, g, h, i) {\n    try {\n      if (g === undefined) {\n        gl.texImage2D(a, b, c, d, e, f);\n      } else {\n        gl.texImage2D(a, b, c, d, e, f, g, h, i);\n      }\n    } catch (error) {\n      console.error(\"THREE.WebGLState:\", error);\n    }\n  };\n\n  renderer.state.compressedTexImage2D = function(a, b, c, d, e, f, g, h, i, j) {\n    try {\n      if (h === undefined) {\n        gl.compressedTexImage2D(a, b, c, d, e, f, g);\n      } else if (i === undefined) {\n        gl.compressedTexImage2D(a, b, c, d, e, f, g, h);\n      } else if (j === undefined) {\n        gl.compressedTexImage2D(a, b, c, d, e, f, g, h, i);\n      } else {\n        gl.compressedTexImage2D(a, b, c, d, e, f, g, h, i, j);\n      }\n    } catch (error) {\n      console.error(\"THREE.WebGLState:\", error);\n    }\n  };\n}\n","module.exports = {\n  COLLISION_LAYERS: {\n    ALL: -1,\n    NONE: 0,\n    INTERACTABLES: 1,\n    ENVIRONMENT: 2,\n    AVATAR: 4,\n    HANDS: 8,\n    DEFAULT_INTERACTABLE: 1 | 2 | 4 | 8,\n    UNOWNED_INTERACTABLE: 1 | 8,\n    DEFAULT_SPAWNER: 1 | 8\n  }\n};\n","const VERTEX_SHADER = `\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n  #include <uv_vertex>\n  #include <uv2_vertex>\n  #include <color_vertex>\n  #include <skinbase_vertex>\n\n  #include <begin_vertex>\n  #include <morphtarget_vertex>\n  #include <skinning_vertex>\n  #include <project_vertex>\n  #include <logdepthbuf_vertex>\n\n  #include <worldpos_vertex>\n  #include <clipping_planes_vertex>\n  #include <fog_vertex>\n}\n`;\n\nconst FRAGMENT_SHADER = `\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <aomap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n  #include <clipping_planes_fragment>\n\n  vec4 diffuseColor = vec4(diffuse, opacity);\n  ReflectedLight reflectedLight = ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0), vec3(0.0));\n  vec3 totalEmissiveRadiance = emissive;\n\n  #include <logdepthbuf_fragment>\n  #include <map_fragment>\n  #include <color_fragment>\n  #include <alphatest_fragment>\n  #include <emissivemap_fragment>\n\n  reflectedLight.indirectDiffuse += vec3(1.0);\n\n  #include <aomap_fragment>\n\n  reflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\n  vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n  gl_FragColor = vec4(outgoingLight, diffuseColor.a);\n\n  #include <premultiplied_alpha_fragment>\n  #include <tonemapping_fragment>\n  #include <encodings_fragment>\n  #include <fog_fragment>\n}\n`;\n\nexport default class MobileStandardMaterial extends THREE.ShaderMaterial {\n  type = \"MobileStandardMaterial\";\n  isMobileStandardMaterial = true;\n  static fromStandardMaterial(material) {\n    const parameters = {\n      vertexShader: VERTEX_SHADER,\n      fragmentShader: FRAGMENT_SHADER,\n      uniforms: {\n        uvTransform: { value: new THREE.Matrix3() },\n        diffuse: { value: material.color },\n        opacity: { value: material.opacity },\n        map: { value: material.map },\n        aoMapIntensity: { value: material.aoMapIntensity },\n        aoMap: { value: material.aoMap },\n        emissive: { value: material.emissive },\n        emissiveMap: { value: material.emissiveMap }\n      },\n      fog: true,\n      lights: false,\n      opacity: material.opacity,\n      transparent: material.transparent,\n      skinning: material.skinning,\n      morphTargets: material.morphTargets,\n      vertexColors: material.vertexColors\n    };\n\n    const mobileMaterial = new MobileStandardMaterial(parameters);\n\n    mobileMaterial.color = material.color;\n    mobileMaterial.map = material.map;\n    mobileMaterial.aoMap = material.aoMap;\n    mobileMaterial.aoMapIntensity = material.aoMapIntensity;\n    mobileMaterial.emissive = material.emissive;\n    mobileMaterial.emissiveMap = material.emissiveMap;\n\n    return mobileMaterial;\n  }\n  clone() {\n    return MobileStandardMaterial.fromStandardMaterial(this);\n  }\n}\n","import nextTick from \"../utils/next-tick\";\nimport { mapMaterials } from \"../utils/material-utils\";\nimport SketchfabZipWorker from \"../workers/sketchfab-zip.worker.js\";\nimport MobileStandardMaterial from \"../materials/MobileStandardMaterial\";\nimport { getCustomGLTFParserURLResolver } from \"../utils/media-utils\";\nimport { promisifyWorker } from \"../utils/promisify-worker.js\";\nimport { MeshBVH, acceleratedRaycast } from \"three-mesh-bvh\";\nTHREE.Mesh.prototype.raycast = acceleratedRaycast;\n\nconst GLTFCache = {};\nconst extractZipFile = promisifyWorker(new SketchfabZipWorker());\n\nfunction defaultInflator(el, componentName, componentData) {\n  if (!AFRAME.components[componentName]) {\n    throw new Error(`Inflator failed. \"${componentName}\" component does not exist.`);\n  }\n  if (AFRAME.components[componentName].multiple && Array.isArray(componentData)) {\n    for (let i = 0; i < componentData.length; i++) {\n      el.setAttribute(componentName + \"__\" + i, componentData[i]);\n    }\n  } else {\n    el.setAttribute(componentName, componentData);\n  }\n}\n\nAFRAME.GLTFModelPlus = {\n  // eslint-disable-next-line no-unused-vars\n  components: {},\n  registerComponent(componentKey, componentName, inflator) {\n    inflator = inflator || defaultInflator;\n    AFRAME.GLTFModelPlus.components[componentKey] = { inflator, componentName };\n  }\n};\n\nfunction parallelTraverse(a, b, callback) {\n  callback(a, b);\n\n  for (let i = 0; i < a.children.length; i++) {\n    parallelTraverse(a.children[i], b.children[i], callback);\n  }\n}\n\nfunction generateMeshBVH(object3D) {\n  object3D.traverse(obj => {\n    // note that we might already have a bounds tree if this was a clone of an object with one\n    const hasBufferGeometry = obj.isMesh && obj.geometry.isBufferGeometry;\n    const hasBoundsTree = hasBufferGeometry && obj.geometry.boundsTree;\n    if (hasBufferGeometry && !hasBoundsTree && obj.geometry.attributes.position) {\n      const geo = obj.geometry;\n      const triCount = geo.index ? geo.index.count / 3 : geo.attributes.position.count / 3;\n      // only bother using memory and time making a BVH if there are a reasonable number of tris,\n      // and if there are too many it's too painful and large to tolerate doing it (at least until\n      // we put this in a web worker)\n      if (triCount > 1000 && triCount < 1000000) {\n        // note that bounds tree construction creates an index as a side effect if one doesn't already exist\n        geo.boundsTree = new MeshBVH(obj.geometry, { strategy: 0, maxDepth: 30 });\n      }\n    }\n  });\n}\n\n// Modified version of Don McCurdy's AnimationUtils.clone\n// https://github.com/mrdoob/three.js/pull/14494\nfunction cloneSkinnedMesh(source) {\n  const cloneLookup = new Map();\n\n  const clone = source.clone();\n\n  parallelTraverse(source, clone, function(sourceNode, clonedNode) {\n    cloneLookup.set(sourceNode, clonedNode);\n    if (sourceNode.isMesh && sourceNode.geometry.boundsTree) {\n      clonedNode.geometry.boundsTree = sourceNode.geometry.boundsTree;\n    }\n  });\n\n  source.traverse(function(sourceMesh) {\n    if (!sourceMesh.isSkinnedMesh) return;\n\n    const sourceBones = sourceMesh.skeleton.bones;\n    const clonedMesh = cloneLookup.get(sourceMesh);\n\n    clonedMesh.skeleton = sourceMesh.skeleton.clone();\n\n    clonedMesh.skeleton.bones = sourceBones.map(function(sourceBone) {\n      if (!cloneLookup.has(sourceBone)) {\n        throw new Error(\"Required bones are not descendants of the given object.\");\n      }\n\n      return cloneLookup.get(sourceBone);\n    });\n\n    clonedMesh.bind(clonedMesh.skeleton, sourceMesh.bindMatrix);\n  });\n\n  return clone;\n}\n\nfunction cloneGltf(gltf) {\n  return {\n    animations: gltf.animations,\n    scene: cloneSkinnedMesh(gltf.scene)\n  };\n}\n\nfunction getHubsComponents(node) {\n  const hubsComponents =\n    node.userData.gltfExtensions &&\n    (node.userData.gltfExtensions.MOZ_hubs_components || node.userData.gltfExtensions.HUBS_components);\n\n  // We can remove support for legacy components when our environment, avatar and interactable models are\n  // updated to match Spoke output.\n  const legacyComponents = node.userData.components;\n\n  return hubsComponents || legacyComponents;\n}\n\n/// Walks the tree of three.js objects starting at the given node, using the GLTF data\n/// and template data to construct A-Frame entities and components when necessary.\n/// (It's unnecessary to construct entities for subtrees that have no component data\n/// or templates associated with any of their nodes.)\n///\n/// Returns the A-Frame entity associated with the given node, if one was constructed.\nconst inflateEntities = function(indexToEntityMap, node, templates, isRoot, modelToWorldScale = 1) {\n  // TODO: Remove this once we update the legacy avatars to the new node names\n  if (node.name === \"Chest\") {\n    node.name = \"Spine\";\n  } else if (node.name === \"Root Scene\") {\n    node.name = \"AvatarRoot\";\n  } else if (node.name === \"Bot_Skinned\") {\n    node.name = \"AvatarMesh\";\n  }\n\n  // inflate subtrees first so that we can determine whether or not this node needs to be inflated\n  const childEntities = [];\n  const children = node.children.slice(0); // setObject3D mutates the node's parent, so we have to copy\n  for (const child of children) {\n    const el = inflateEntities(indexToEntityMap, child, templates);\n    if (el) {\n      childEntities.push(el);\n    }\n  }\n\n  const entityComponents = getHubsComponents(node);\n\n  const nodeHasBehavior = !!entityComponents || node.name in templates;\n  if (!nodeHasBehavior && !childEntities.length && !isRoot) {\n    return null; // we don't need an entity for this node\n  }\n\n  const el = document.createElement(\"a-entity\");\n  el.append.apply(el, childEntities);\n\n  // Remove invalid CSS class name characters.\n  const className = (node.name || node.uuid).replace(/[^\\w-]/g, \"\");\n  el.classList.add(className);\n\n  // AFRAME rotation component expects rotations in YXZ, convert it\n  if (node.rotation.order !== \"YXZ\") {\n    node.rotation.setFromQuaternion(node.quaternion, \"YXZ\");\n  }\n\n  // Copy over the object's transform to the THREE.Group and reset the actual transform of the Object3D\n  // all updates to the object should be done through the THREE.Group wrapper\n  el.object3D.position.copy(node.position);\n  el.object3D.rotation.copy(node.rotation);\n  el.object3D.scale.copy(node.scale).multiplyScalar(modelToWorldScale);\n  el.object3D.matrixNeedsUpdate = true;\n\n  node.matrixAutoUpdate = false;\n  node.matrix.identity();\n  node.matrix.decompose(node.position, node.rotation, node.scale);\n\n  el.setObject3D(node.type.toLowerCase(), node);\n  if (entityComponents && \"nav-mesh\" in entityComponents) {\n    el.setObject3D(\"mesh\", node);\n  }\n\n  // Set the name of the `THREE.Group` to match the name of the node,\n  // so that `THREE.PropertyBinding` will find (and later animate)\n  // the group. See `PropertyBinding.findNode`:\n  // https://github.com/mrdoob/three.js/blob/dev/src/animation/PropertyBinding.js#L211\n  el.object3D.name = node.name;\n  if (node.animations) {\n    // Pass animations up to the group object so that when we can pass the group as\n    // the optional root in `THREE.AnimationMixer.clipAction` and use the hierarchy\n    // preserved under the group (but not the node). Otherwise `clipArray` will be\n    // `null` in `THREE.AnimationClip.findByName`.\n    node.parent.animations = node.animations;\n  }\n\n  const gltfIndex = node.userData.gltfIndex;\n  if (gltfIndex !== undefined) {\n    indexToEntityMap[gltfIndex] = el;\n  }\n\n  return el;\n};\n\nfunction inflateComponents(inflatedEntity, indexToEntityMap) {\n  inflatedEntity.object3D.traverse(object3D => {\n    const entityComponents = getHubsComponents(object3D);\n    const el = object3D.el;\n\n    if (entityComponents && el) {\n      for (const prop in entityComponents) {\n        if (entityComponents.hasOwnProperty(prop) && AFRAME.GLTFModelPlus.components.hasOwnProperty(prop)) {\n          const { componentName, inflator } = AFRAME.GLTFModelPlus.components[prop];\n          inflator(el, componentName, entityComponents[prop], entityComponents, indexToEntityMap);\n        }\n      }\n    }\n  });\n}\n\nfunction attachTemplate(root, name, templateRoot) {\n  const targetEls = root.querySelectorAll(\".\" + name);\n  for (const el of targetEls) {\n    const root = templateRoot.cloneNode(true);\n    // Merge root element attributes with the target element\n    for (const { name, value } of root.attributes) {\n      el.setAttribute(name, value);\n    }\n\n    // Append all child elements\n    while (root.children.length > 0) {\n      el.appendChild(root.children[0]);\n    }\n  }\n}\n\nexport async function loadGLTF(src, contentType, preferredTechnique, onProgress) {\n  let gltfUrl = src;\n  let fileMap;\n\n  if (contentType.includes(\"model/gltf+zip\") || contentType.includes(\"application/x-zip-compressed\")) {\n    fileMap = await extractZipFile(gltfUrl);\n    gltfUrl = fileMap[\"scene.gtlf\"];\n  }\n\n  const loadingManager = new THREE.LoadingManager();\n  loadingManager.setURLModifier(getCustomGLTFParserURLResolver(gltfUrl));\n  const gltfLoader = new THREE.GLTFLoader(loadingManager);\n\n  const parser = await new Promise((resolve, reject) => gltfLoader.createParser(gltfUrl, resolve, onProgress, reject));\n\n  const materials = parser.json.materials;\n  if (materials) {\n    for (let i = 0; i < materials.length; i++) {\n      const material = materials[i];\n\n      if (\n        material.extensions &&\n        material.extensions.MOZ_alt_materials &&\n        material.extensions.MOZ_alt_materials[preferredTechnique] !== undefined\n      ) {\n        const altMaterialIndex = material.extensions.MOZ_alt_materials[preferredTechnique];\n        materials[i] = materials[altMaterialIndex];\n      }\n    }\n  }\n\n  const nodes = parser.json.nodes;\n\n  if (nodes) {\n    for (let i = 0; i < nodes.length; i++) {\n      const node = nodes[i];\n\n      if (!node.extras) {\n        node.extras = {};\n      }\n\n      node.extras.gltfIndex = i;\n    }\n  }\n\n  const gltf = await new Promise(parser.parse.bind(parser));\n\n  gltf.scene.traverse(object => {\n    // GLTFLoader sets matrixAutoUpdate on animated objects, we want to keep the defaults\n    object.matrixAutoUpdate = THREE.Object3D.DefaultMatrixAutoUpdate;\n\n    object.material = mapMaterials(object, material => {\n      if (material.isMeshStandardMaterial && preferredTechnique === \"KHR_materials_unlit\") {\n        return MobileStandardMaterial.fromStandardMaterial(material);\n      }\n\n      return material;\n    });\n  });\n\n  if (fileMap) {\n    // The GLTF is now cached as a THREE object, we can get rid of the original blobs\n    Object.keys(fileMap).forEach(URL.revokeObjectURL);\n  }\n\n  return gltf;\n}\n\n/**\n * Loads a GLTF model, optionally recursively \"inflates\" the child nodes of a model into a-entities and sets\n * whitelisted components on them if defined in the node's extras.\n * @namespace gltf\n * @component gltf-model-plus\n */\nAFRAME.registerComponent(\"gltf-model-plus\", {\n  schema: {\n    src: { type: \"string\" },\n    contentType: { type: \"string\" },\n    useCache: { default: true },\n    inflate: { default: false },\n    modelToWorldScale: { type: \"number\", default: 1 }\n  },\n\n  init() {\n    this.preferredTechnique =\n      window.APP && window.APP.quality === \"low\" ? \"KHR_materials_unlit\" : \"pbrMetallicRoughness\";\n    this.loadTemplates();\n  },\n\n  update() {\n    this.applySrc(this.data.src, this.data.contentType);\n  },\n\n  loadTemplates() {\n    this.templates = {};\n    this.el.querySelectorAll(\":scope > template\").forEach(templateEl => {\n      const root = document.importNode(templateEl.firstElementChild || templateEl.content.firstElementChild, true);\n      this.templates[templateEl.getAttribute(\"data-name\")] = root;\n    });\n  },\n\n  async loadModel(src, contentType, technique, useCache) {\n    if (useCache) {\n      if (!GLTFCache[src]) {\n        GLTFCache[src] = await loadGLTF(src, contentType, technique);\n      }\n\n      return cloneGltf(GLTFCache[src]);\n    } else {\n      return await loadGLTF(src, contentType, technique);\n    }\n  },\n\n  async applySrc(src, contentType) {\n    try {\n      // If the src attribute is a selector, get the url from the asset item.\n      if (src && src.charAt(0) === \"#\") {\n        const assetEl = document.getElementById(src.substring(1));\n        src = assetEl.getAttribute(\"src\");\n      }\n\n      if (src === this.lastSrc) return;\n      this.lastSrc = src;\n\n      if (!src) {\n        if (this.inflatedEl) {\n          console.warn(\"gltf-model-plus set to an empty source, unloading inflated model.\");\n          this.disposeLastInflatedEl();\n        }\n        return;\n      }\n\n      this.el.emit(\"model-loading\");\n      const gltf = await this.loadModel(src, contentType, this.preferredTechnique, this.data.useCache);\n\n      // If we started loading something else already\n      // TODO: there should be a way to cancel loading instead\n      if (src != this.lastSrc) return;\n\n      // If we had inflated something already before, clean that up\n      this.disposeLastInflatedEl();\n\n      this.model = gltf.scene || gltf.scenes[0];\n      this.model.animations = gltf.animations;\n\n      if (gltf.animations.length > 0) {\n        this.el.setAttribute(\"animation-mixer\", {});\n        this.el.components[\"animation-mixer\"].initMixer(gltf.animations);\n      } else {\n        generateMeshBVH(this.model);\n      }\n\n      const indexToEntityMap = {};\n\n      let object3DToSet = this.model;\n      if (\n        this.data.inflate &&\n        (this.inflatedEl = inflateEntities(\n          indexToEntityMap,\n          this.model,\n          this.templates,\n          true,\n          this.data.modelToWorldScale\n        ))\n      ) {\n        this.el.appendChild(this.inflatedEl);\n\n        object3DToSet = this.inflatedEl.object3D;\n        // TODO: Still don't fully understand the lifecycle here and how it differs between browsers, we should dig in more\n        // Wait one tick for the appended custom elements to be connected before attaching templates\n        await nextTick();\n        if (src != this.lastSrc) return; // TODO: there must be a nicer pattern for this\n\n        inflateComponents(this.inflatedEl, indexToEntityMap);\n\n        for (const name in this.templates) {\n          attachTemplate(this.el, name, this.templates[name]);\n        }\n      }\n\n      // The call to setObject3D below recursively clobbers any `el` backreferences to entities\n      // in the entire inflated entity graph to point to `object3DToSet`.\n      //\n      // We don't want those overwritten, since lots of code assumes `object3d.el` points to the relevant\n      // A-Frame entity for that three.js object, so we back them up and re-wire them here. If we didn't do\n      // this, all the `el` properties on these object3ds would point to the `object3DToSet` which is either\n      // the model or the root GLTF inflated entity.\n      const rewires = [];\n\n      object3DToSet.traverse(o => {\n        const el = o.el;\n        if (el) rewires.push(() => (o.el = el));\n      });\n\n      const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\n\n      if (environmentMapComponent) {\n        environmentMapComponent.applyEnvironmentMap(object3DToSet);\n      }\n\n      this.el.setObject3D(\"mesh\", object3DToSet);\n\n      rewires.forEach(f => f());\n\n      this.el.emit(\"model-loaded\", { format: \"gltf\", model: this.model });\n    } catch (e) {\n      delete GLTFCache[src];\n      console.error(\"Failed to load glTF model\", e, this);\n      this.el.emit(\"model-error\", { format: \"gltf\", src });\n    }\n  },\n\n  disposeLastInflatedEl() {\n    if (this.inflatedEl) {\n      this.inflatedEl.parentNode.removeChild(this.inflatedEl);\n\n      this.inflatedEl.object3D.traverse(x => {\n        if (x.material && x.material.dispose) {\n          x.material.dispose();\n        }\n\n        if (x.geometry) {\n          if (x.geometry.dispose) {\n            x.geometry.dispose();\n          }\n\n          x.geometry.boundsTree = null;\n        }\n      });\n\n      delete this.inflatedEl;\n\n      this.el.removeAttribute(\"animation-mixer\");\n    }\n  }\n});\n","const adjectives = [\n  \"able\",\n  \"absolute\",\n  \"acceptable\",\n  \"acclaimed\",\n  \"accomplished\",\n  \"accurate\",\n  \"aching\",\n  \"acrobatic\",\n  \"adorable\",\n  \"adventurous\",\n  \"basic\",\n  \"belated\",\n  \"beloved\",\n  \"calm\",\n  \"candid\",\n  \"capital\",\n  \"carefree\",\n  \"caring\",\n  \"cautious\",\n  \"celebrated\",\n  \"charming\",\n  \"daring\",\n  \"darling\",\n  \"dearest\",\n  \"each\",\n  \"eager\",\n  \"early\",\n  \"earnest\",\n  \"easy\",\n  \"easygoing\",\n  \"ecstatic\",\n  \"edible\",\n  \"fabulous\",\n  \"fair\",\n  \"faithful\",\n  \"familiar\",\n  \"famous\",\n  \"fancy\",\n  \"fantastic\",\n  \"far\",\n  \"generous\",\n  \"gentle\",\n  \"genuine\",\n  \"giant\",\n  \"handmade\",\n  \"handsome\",\n  \"handy\",\n  \"happy\",\n  \"icy\",\n  \"ideal\",\n  \"identical\",\n  \"keen\",\n  \"lasting\",\n  \"lavish\",\n  \"magnificent\",\n  \"majestic\",\n  \"mammoth\",\n  \"marvelous\",\n  \"natural\",\n  \"obedient\",\n  \"palatable\",\n  \"parched\",\n  \"passionate\",\n  \"pastel\",\n  \"peaceful\",\n  \"perfect\",\n  \"perfumed\",\n  \"quaint\",\n  \"qualified\",\n  \"radiant\",\n  \"rapid\",\n  \"rare\",\n  \"safe\",\n  \"sandy\",\n  \"satisfied\",\n  \"scaly\",\n  \"scarce\",\n  \"scared\",\n  \"scary\",\n  \"scented\",\n  \"scientific\",\n  \"secret\",\n  \"sentimental\",\n  \"talkative\",\n  \"tangible\",\n  \"tart\",\n  \"tasty\",\n  \"tattered\",\n  \"teeming\",\n  \"ultimate\",\n  \"uncommon\",\n  \"unconscious\",\n  \"understated\",\n  \"warm\",\n  \"active\",\n  \"adept\",\n  \"admirable\",\n  \"admired\",\n  \"adorable\",\n  \"adored\",\n  \"advanced\",\n  \"affectionate\",\n  \"beneficial\",\n  \"best\",\n  \"better\",\n  \"big\",\n  \"cheerful\",\n  \"cheery\",\n  \"chief\",\n  \"chilly\",\n  \"classic\",\n  \"clean\",\n  \"clear\",\n  \"clever\",\n  \"decent\",\n  \"decisive\",\n  \"deep\",\n  \"defiant\",\n  \"definitive\",\n  \"delectable\",\n  \"delicious\",\n  \"elaborate\",\n  \"elastic\",\n  \"elated\",\n  \"elegant\",\n  \"elementary\",\n  \"elliptical\",\n  \"fast\",\n  \"favorable\",\n  \"favorite\",\n  \"fearless\",\n  \"gifted\",\n  \"glamorous\",\n  \"gleaming\",\n  \"glittering\",\n  \"harmonious\",\n  \"imaginative\",\n  \"immense\",\n  \"jealous\",\n  \"kind\",\n  \"leafy\",\n  \"legal\",\n  \"mature\",\n  \"mean\",\n  \"nautical\",\n  \"neat\",\n  \"necessary\",\n  \"needy\",\n  \"oddball\",\n  \"offbeat\",\n  \"periodic\",\n  \"perky\",\n  \"personal\",\n  \"pertinent\",\n  \"petty\",\n  \"quarterly\",\n  \"ready\",\n  \"real\",\n  \"realistic\",\n  \"reasonable\",\n  \"regal\",\n  \"serene\",\n  \"shabby\",\n  \"sharp\",\n  \"shiny\",\n  \"showy\",\n  \"shy\",\n  \"silky\",\n  \"tempting\",\n  \"tense\",\n  \"terrific\",\n  \"testy\",\n  \"thankful\",\n  \"uniform\",\n  \"unique\",\n  \"vast\",\n  \"weary\",\n  \"wee\",\n  \"welcome\",\n  \"agile\",\n  \"alarmed\",\n  \"alert\",\n  \"alive\",\n  \"bleak\",\n  \"blissful\",\n  \"blushing\",\n  \"coarse\",\n  \"colorful\",\n  \"colossal\",\n  \"comfortable\",\n  \"compassionate\",\n  \"complete\",\n  \"delightful\",\n  \"dense\",\n  \"dependable\",\n  \"dependent\",\n  \"descriptive\",\n  \"detailed\",\n  \"determined\",\n  \"devoted\",\n  \"different\",\n  \"eminent\",\n  \"emotional\",\n  \"enchanted\",\n  \"enchanting\",\n  \"energetic\",\n  \"enormous\",\n  \"fine\",\n  \"finished\",\n  \"firm\",\n  \"firsthand\",\n  \"fixed\",\n  \"flashy\",\n  \"flawless\",\n  \"glorious\",\n  \"glossy\",\n  \"golden\",\n  \"good\",\n  \"gorgeous\",\n  \"graceful\",\n  \"healthy\",\n  \"heartfelt\",\n  \"hearty\",\n  \"helpful\",\n  \"impartial\",\n  \"impressive\",\n  \"jolly\",\n  \"jovial\",\n  \"lighthearted\",\n  \"likable\",\n  \"lined\",\n  \"mellow\",\n  \"melodic\",\n  \"memorable\",\n  \"mild\",\n  \"new\",\n  \"opulent\",\n  \"playful\",\n  \"pleasant\",\n  \"pleasing\",\n  \"plump\",\n  \"plush\",\n  \"polished\",\n  \"polite\",\n  \"reliable\",\n  \"relieved\",\n  \"remarkable\",\n  \"remote\",\n  \"respectful\",\n  \"responsible\",\n  \"simple\",\n  \"simplistic\",\n  \"sizzling\",\n  \"sleepy\",\n  \"slight\",\n  \"slim\",\n  \"smart\",\n  \"smooth\",\n  \"snappy\",\n  \"snoopy\",\n  \"thirsty\",\n  \"this\",\n  \"thorough\",\n  \"those\",\n  \"thoughtful\",\n  \"united\",\n  \"vibrant\",\n  \"vicious\",\n  \"wellmade\",\n  \"whimsical\",\n  \"whirlwind\",\n  \"zesty\",\n  \"amazing\",\n  \"ambitious\",\n  \"ample\",\n  \"amused\",\n  \"amusing\",\n  \"ancient\",\n  \"angelic\",\n  \"antique\",\n  \"bold\",\n  \"bossy\",\n  \"both\",\n  \"bouncy\",\n  \"bountiful\",\n  \"complex\",\n  \"conscious\",\n  \"considerate\",\n  \"constant\",\n  \"content\",\n  \"conventional\",\n  \"cooked\",\n  \"cool\",\n  \"cooperative\",\n  \"diligent\",\n  \"dimwitted\",\n  \"direct\",\n  \"discrete\",\n  \"envious\",\n  \"essential\",\n  \"ethical\",\n  \"euphoric\",\n  \"flippant\",\n  \"fluffy\",\n  \"flustered\",\n  \"focused\",\n  \"fond\",\n  \"gracious\",\n  \"grand\",\n  \"grandiose\",\n  \"granular\",\n  \"grateful\",\n  \"grave\",\n  \"great\",\n  \"hidden\",\n  \"high\",\n  \"hilarious\",\n  \"homely\",\n  \"incomparable\",\n  \"incredible\",\n  \"infamous\",\n  \"joyful\",\n  \"lively\",\n  \"loathsome\",\n  \"lonely\",\n  \"long\",\n  \"mindless\",\n  \"miniature\",\n  \"minor\",\n  \"misty\",\n  \"next\",\n  \"nice\",\n  \"nifty\",\n  \"nimble\",\n  \"orderly\",\n  \"organic\",\n  \"ornate\",\n  \"popular\",\n  \"posh\",\n  \"positive\",\n  \"potable\",\n  \"powerful\",\n  \"powerless\",\n  \"precious\",\n  \"present\",\n  \"prestigious\",\n  \"quick\",\n  \"rewarding\",\n  \"rich\",\n  \"right\",\n  \"sociable\",\n  \"soft\",\n  \"solid\",\n  \"some\",\n  \"sophisticated\",\n  \"soulful\",\n  \"sparkling\",\n  \"spectacular\",\n  \"speedy\",\n  \"spicy\",\n  \"spiffy\",\n  \"spirited\",\n  \"spiteful\",\n  \"splendid\",\n  \"spotless\",\n  \"spry\",\n  \"thrifty\",\n  \"tidy\",\n  \"tight\",\n  \"timely\",\n  \"tinted\",\n  \"unruly\",\n  \"untimely\",\n  \"violet\",\n  \"wicked\",\n  \"wide\",\n  \"wild\",\n  \"willing\",\n  \"winding\",\n  \"windy\",\n  \"zigzag\",\n  \"apprehensive\",\n  \"appropriate\",\n  \"artistic\",\n  \"assured\",\n  \"astonishing\",\n  \"bright\",\n  \"brilliant\",\n  \"bronze\",\n  \"coordinated\",\n  \"courageous\",\n  \"courteous\",\n  \"crafty\",\n  \"crazy\",\n  \"creamy\",\n  \"creative\",\n  \"crisp\",\n  \"distant\",\n  \"distinct\",\n  \"downright\",\n  \"evergreen\",\n  \"everlasting\",\n  \"every\",\n  \"evil\",\n  \"excellent\",\n  \"excitable\",\n  \"exemplary\",\n  \"exhausted\",\n  \"forthright\",\n  \"fortunate\",\n  \"fragrant\",\n  \"frank\",\n  \"free\",\n  \"frequent\",\n  \"fresh\",\n  \"friendly\",\n  \"frightened\",\n  \"frigid\",\n  \"gripping\",\n  \"grounded\",\n  \"honest\",\n  \"honorable\",\n  \"honored\",\n  \"hopeful\",\n  \"hospitable\",\n  \"hot\",\n  \"huge\",\n  \"infatuated\",\n  \"infinite\",\n  \"informal\",\n  \"insistent\",\n  \"instructive\",\n  \"juicy\",\n  \"jumbo\",\n  \"knowing\",\n  \"knowledgeable\",\n  \"longterm\",\n  \"loud\",\n  \"lovable\",\n  \"loving\",\n  \"modern\",\n  \"modest\",\n  \"monumental\",\n  \"normal\",\n  \"notable\",\n  \"outgoing\",\n  \"precious\",\n  \"pretty\",\n  \"prickly\",\n  \"primary\",\n  \"pristine\",\n  \"private\",\n  \"prize\",\n  \"productive\",\n  \"profitable\",\n  \"quiet\",\n  \"quintessential\",\n  \"roasted\",\n  \"robust\",\n  \"square\",\n  \"squiggly\",\n  \"stable\",\n  \"staid\",\n  \"starry\",\n  \"steel\",\n  \"stimulating\",\n  \"striking\",\n  \"striped\",\n  \"strong\",\n  \"studious\",\n  \"stunning\",\n  \"tough\",\n  \"trained\",\n  \"treasured\",\n  \"tremendous\",\n  \"triangular\",\n  \"tricky\",\n  \"unused\",\n  \"unusual\",\n  \"upbeat\",\n  \"virtual\",\n  \"witty\",\n  \"wonderful\",\n  \"wooden\",\n  \"worldly\",\n  \"youthful\",\n  \"attached\",\n  \"attentive\",\n  \"attractive\",\n  \"austere\",\n  \"authentic\",\n  \"automatic\",\n  \"aware\",\n  \"awesome\",\n  \"bubbly\",\n  \"bustling\",\n  \"busy\",\n  \"buttery\",\n  \"cuddly\",\n  \"cultured\",\n  \"curly\",\n  \"curvy\",\n  \"cute\",\n  \"cylindrical\",\n  \"downright\",\n  \"dramatic\",\n  \"excited\",\n  \"exciting\",\n  \"exotic\",\n  \"experienced\",\n  \"expert\",\n  \"frosty\",\n  \"fruitful\",\n  \"full\",\n  \"fumbling\",\n  \"funny\",\n  \"fussy\",\n  \"growing\",\n  \"grown\",\n  \"gummy\",\n  \"humble\",\n  \"humongous\",\n  \"hungry\",\n  \"intelligent\",\n  \"interesting\",\n  \"known\",\n  \"kooky\",\n  \"loyal\",\n  \"lucky\",\n  \"luminous\",\n  \"lustrous\",\n  \"luxurious\",\n  \"multicolored\",\n  \"mysterious\",\n  \"noteworthy\",\n  \"numb\",\n  \"nutritious\",\n  \"outstanding\",\n  \"overjoyed\",\n  \"proper\",\n  \"proud\",\n  \"prudent\",\n  \"punctual\",\n  \"puny\",\n  \"pure\",\n  \"puzzled\",\n  \"puzzling\",\n  \"quirky\",\n  \"stupendous\",\n  \"sturdy\",\n  \"stylish\",\n  \"subdued\",\n  \"subtle\",\n  \"sunny\",\n  \"super\",\n  \"superb\",\n  \"supportive\",\n  \"surprised\",\n  \"sweet\",\n  \"swift\",\n  \"sympathetic\",\n  \"trivial\",\n  \"trusting\",\n  \"trustworthy\",\n  \"trusty\",\n  \"truthful\",\n  \"twin\",\n  \"usable\",\n  \"used\",\n  \"useful\",\n  \"utilized\",\n  \"vital\",\n  \"vivid\",\n  \"worried\",\n  \"worthwhile\",\n  \"worthy\",\n  \"writhing\",\n  \"wry\",\n  \"yummy\",\n  \"chocolate\",\n  \"crimson\",\n  \"cyan\",\n  \"fuchsia\",\n  \"gold\",\n  \"honeydew\",\n  \"lime\",\n  \"linen\",\n  \"magenta\",\n  \"olive\",\n  \"peru\",\n  \"salmon\",\n  \"seashell\",\n  \"sienna\",\n  \"snow\",\n  \"thistle\",\n  \"tomato\",\n  \"transparent\",\n  \"turquoise\",\n  \"violet\"\n];\n\nconst nouns = [\n  \"space\",\n  \"land\",\n  \"world\",\n  \"universe\",\n  \"plane\",\n  \"room\",\n  \"nation\",\n  \"plaza\",\n  \"gathering\",\n  \"meetup\",\n  \"get together\",\n  \"conclave\",\n  \"party\",\n  \"domain\",\n  \"dominion\",\n  \"realm\",\n  \"square\",\n  \"commons\",\n  \"park\",\n  \"cosmos\",\n  \"sphere\",\n  \"terrain\",\n  \"spot\",\n  \"zone\",\n  \"area\",\n  \"tract\",\n  \"turf\",\n  \"place\",\n  \"territory\",\n  \"volume\",\n  \"camp\",\n  \"picnic\",\n  \"outing\",\n  \"vacation\",\n  \"adventure\",\n  \"exploration\",\n  \"outing\",\n  \"walkabout\",\n  \"safari\",\n  \"venture\",\n  \"roundtable\",\n  \"barbecue\",\n  \"celebration\",\n  \"festivity\",\n  \"gala\",\n  \"shindig\",\n  \"social\",\n  \"convention\",\n  \"assembly\",\n  \"congregation\",\n  \"rendezvous\",\n  \"huddle\",\n  \"meet\",\n  \"soiree\"\n];\n\nexport function generateHubName() {\n  const randItem = set => {\n    const s = set[Math.floor(Math.random() * set.length)];\n    return s.charAt(0).toUpperCase() + s.slice(1);\n  };\n\n  return `${randItem(adjectives)} ${randItem(adjectives)} ${randItem(nouns)}`;\n}\n","import { Socket } from \"phoenix\";\nimport { generateHubName } from \"../utils/name-generation\";\n\nimport Store from \"../storage/store\";\n\nconst resolverLink = document.createElement(\"a\");\nexport function getReticulumFetchUrl(path, absolute = false) {\n  if (process.env.RETICULUM_SERVER) {\n    return `https://${process.env.RETICULUM_SERVER}${path}`;\n  } else if (absolute) {\n    resolverLink.href = path;\n    return resolverLink.href;\n  } else {\n    return path;\n  }\n}\n\nlet reticulumMeta = null;\nlet invalidatedReticulumMetaThisSession = false;\n\nexport async function invalidateReticulumMeta() {\n  invalidatedReticulumMetaThisSession = true;\n  reticulumMeta = null;\n}\n\nexport async function getReticulumMeta() {\n  if (!reticulumMeta) {\n    // Initially look up version based upon page, avoiding round-trip, otherwise fetch.\n    if (!invalidatedReticulumMetaThisSession && document.querySelector(\"meta[name='ret:version']\")) {\n      reticulumMeta = {\n        version: document.querySelector(\"meta[name='ret:version']\").getAttribute(\"value\"),\n        pool: document.querySelector(\"meta[name='ret:pool']\").getAttribute(\"value\"),\n        phx_host: document.querySelector(\"meta[name='ret:phx_host']\").getAttribute(\"value\")\n      };\n    } else {\n      await fetch(getReticulumFetchUrl(\"/api/v1/meta\")).then(async res => {\n        reticulumMeta = await res.json();\n      });\n    }\n  }\n\n  const qs = new URLSearchParams(location.search);\n  const phxHostOverride = qs.get(\"phx_host\");\n\n  if (phxHostOverride) {\n    reticulumMeta.phx_host = phxHostOverride;\n  }\n\n  return reticulumMeta;\n}\n\nexport async function connectToReticulum(debug = false, params = null) {\n  const qs = new URLSearchParams(location.search);\n\n  const getNewSocketUrl = async () => {\n    const socketProtocol = qs.get(\"phx_protocol\") || (document.location.protocol === \"https:\" ? \"wss:\" : \"ws:\");\n    let socketHost = qs.get(\"phx_host\");\n    let socketPort = qs.get(\"phx_port\");\n\n    const reticulumMeta = await getReticulumMeta();\n    socketHost = socketHost || reticulumMeta.phx_host;\n    socketPort = socketPort || (process.env.RETICULUM_SERVER.includes(\"hubs.local\") ? \"4000\" : \"443\"); // TODO phx_port\n    return `${socketProtocol}//${socketHost}${socketPort ? `:${socketPort}` : \"\"}`;\n  };\n\n  const socketUrl = await getNewSocketUrl();\n  console.log(`Phoenix Socket URL: ${socketUrl}`);\n\n  const socketSettings = {};\n\n  if (debug) {\n    socketSettings.logger = (kind, msg, data) => {\n      console.log(`${kind}: ${msg}`, data);\n    };\n  }\n\n  if (params) {\n    socketSettings.params = params;\n  }\n\n  const socket = new Socket(`${socketUrl}/socket`, socketSettings);\n  socket.connect();\n  socket.onError(async () => {\n    // On error, underlying reticulum node may have died, so rebalance by\n    // fetching a new healthy node to connect to.\n    invalidateReticulumMeta();\n\n    const endPointPath = new URL(socket.endPoint).pathname;\n    const newSocketUrl = await getNewSocketUrl();\n    const newEndPoint = `${newSocketUrl}${endPointPath}`;\n    console.log(`Socket error, changed endpoint to ${newEndPoint}`);\n    socket.endPoint = newEndPoint;\n  });\n\n  return socket;\n}\n\nexport function getLandingPageForPhoto(photoUrl) {\n  const parsedUrl = new URL(photoUrl);\n  return getReticulumFetchUrl(parsedUrl.pathname.replace(\".png\", \".html\") + parsedUrl.search, true);\n}\n\nexport function fetchReticulumAuthenticated(url, method = \"GET\", payload) {\n  const { token } = window.APP.store.state.credentials;\n  const retUrl = getReticulumFetchUrl(url);\n  const params = {\n    headers: {\n      \"content-type\": \"application/json\",\n      authorization: `bearer ${token}`\n    },\n    method\n  };\n  if (payload) {\n    params.body = JSON.stringify(payload);\n  }\n  return fetch(retUrl, params).then(async r => {\n    const result = await r.text();\n    try {\n      return JSON.parse(result);\n    } catch (e) {\n      // Some reticulum responses, particularly DELETE requests, don't return json.\n      return result;\n    }\n  });\n}\n\nexport async function createAndRedirectToNewHub(name, sceneId, sceneUrl, replace) {\n  const createUrl = getReticulumFetchUrl(\"/api/v1/hubs\");\n  const payload = { hub: { name: name || generateHubName() } };\n\n  if (sceneId) {\n    payload.hub.scene_id = sceneId;\n  } else {\n    payload.hub.default_environment_gltf_bundle_url = sceneUrl;\n  }\n\n  const headers = { \"content-type\": \"application/json\" };\n  const store = new Store();\n  if (store.state && store.state.credentials.token) {\n    headers.authorization = `bearer ${store.state.credentials.token}`;\n  }\n\n  let res = await fetch(createUrl, {\n    body: JSON.stringify(payload),\n    headers,\n    method: \"POST\"\n  }).then(r => r.json());\n\n  if (res.error === \"invalid_token\") {\n    // Clear the invalid token from store.\n    store.update({ credentials: { token: null, email: null } });\n\n    // Create hub anonymously\n    delete headers.authorization;\n    res = await fetch(createUrl, {\n      body: JSON.stringify(payload),\n      headers,\n      method: \"POST\"\n    }).then(r => r.json());\n  }\n\n  const hub = res;\n  let url = hub.url;\n\n  const creatorAssignmentToken = hub.creator_assignment_token;\n  if (creatorAssignmentToken) {\n    store.update({ creatorAssignmentTokens: [{ hubId: hub.hub_id, creatorAssignmentToken: creatorAssignmentToken }] });\n  }\n\n  if (process.env.RETICULUM_SERVER && document.location.host !== process.env.RETICULUM_SERVER) {\n    url = `/hub.html?hub_id=${hub.hub_id}`;\n  }\n\n  if (replace) {\n    document.location.replace(url);\n  } else {\n    document.location = url;\n  }\n}\n\nexport function getPresenceProfileForSession(presences, sessionId) {\n  const entry = Object.entries(presences || {}).find(([k]) => k === sessionId) || [];\n  const presence = entry[1];\n  return (presence && presence.metas && presence.metas[0].profile) || {};\n}\n\n// Takes the given channel, and creates a new channel with the same bindings\n// with the given socket, joins it, and leaves the old channel after joining.\n//\n// NOTE: This function relies upon phoenix channel object internals, so this\n// function will need to be reviewed if/when we ever update phoenix.js\nexport function migrateChannelToSocket(oldChannel, socket, params) {\n  const channel = socket.channel(oldChannel.topic, params || oldChannel.params);\n\n  for (let i = 0, l = oldChannel.bindings.length; i < l; i++) {\n    const item = oldChannel.bindings[i];\n    channel.on(item.event, item.callback);\n  }\n\n  for (let i = 0, l = oldChannel.pushBuffer.length; i < l; i++) {\n    const item = oldChannel.pushBuffer[i];\n    channel.push(item.event, item.payload, item.timeout);\n  }\n\n  const oldJoinPush = oldChannel.joinPush;\n  const joinPush = channel.join();\n\n  for (let i = 0, l = oldJoinPush.recHooks.length; i < l; i++) {\n    const item = oldJoinPush.recHooks[i];\n    joinPush.receive(item.status, item.callback);\n  }\n\n  return new Promise(resolve => {\n    joinPush.receive(\"ok\", () => {\n      // Clear all event handlers first so no duplicate messages come in.\n      oldChannel.bindings = [];\n      resolve(channel);\n    });\n  });\n}\n","export function findAncestorWithComponent(entity, componentName) {\n  while (entity && !(entity.components && entity.components[componentName])) {\n    entity = entity.parentNode;\n  }\n  return entity;\n}\n","module.exports = __webpack_public_path__ + \"assets/images/hub-preview-light-no-shadow-5ebb166e8580d819b445892173ec0286.png\";","module.exports = \"if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\\n  float ratio = 0.0;\\n\\n  if (hubs_EnableSweepingEffect) {\\n    float size = hubs_SweepParams.t - hubs_SweepParams.s;\\n    float line = mod(hubs_Time / 500.0 * size, size * 3.0) + hubs_SweepParams.s - size / 3.0;\\n\\n    if (hubs_WorldPosition.y < line) {\\n      // Highlight with a sweeping gradient.\\n      ratio = max(0.0, 1.0 - (line - hubs_WorldPosition.y) / (size * 1.5));\\n    }\\n  }\\n\\n  // Highlight with a gradient falling off with distance.\\n  float pulse = 9.0 + 3.0 * (sin(hubs_Time / 1000.0) + 1.0);\\n\\n  if (hubs_HighlightInteractorOne) {\\n    float dist1 = distance(hubs_WorldPosition, hubs_InteractorOnePos);\\n    ratio += -min(1.0, pow(dist1 * pulse, 3.0)) + 1.0;\\n  } \\n\\n  if (hubs_HighlightInteractorTwo) {\\n    float dist2 = distance(hubs_WorldPosition, hubs_InteractorTwoPos);\\n    ratio += -min(1.0, pow(dist2 * pulse, 3.0)) + 1.0;\\n  }\\n\\n  ratio = min(1.0, ratio);\\n\\n  // Gamma corrected highlight color\\n  vec3 highlightColor = vec3(0.184, 0.499, 0.933);\\n\\n  gl_FragColor.rgb = (gl_FragColor.rgb * (1.0 - ratio)) + (highlightColor * ratio);\\n}\\n\"","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posx-d235fb97df77b607be04b84125f40e7c.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negx-35034574e114423babdea92b6a2eb97a.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posy-d0c4e1e7979d75923d4d8b49c191bc6e.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negy-35808d21d1d17ac1b84d3184e365093b.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posz-de29aa8396196e4b040cd5305e351dbe.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negz-d73d18a8b7994524dc39a6ea3fcf43fc.jpg\";","import Store from \"./storage/store\";\nimport MediaSearchStore from \"./storage/media-search-store\";\n\nexport class App {\n  constructor() {\n    this.scene = null;\n    this.quality = \"low\";\n    this.store = new Store();\n    this.mediaSearchStore = new MediaSearchStore();\n  }\n\n  setQuality(quality) {\n    if (this.quality === quality) {\n      return false;\n    }\n\n    this.quality = quality;\n\n    if (this.scene) {\n      this.scene.dispatchEvent(new CustomEvent(\"quality-changed\", { detail: quality }));\n    }\n\n    return true;\n  }\n}\n","// removed by extract-text-webpack-plugin\nmodule.exports = {\"email-field\":\"sign-in-dialog__email-field__g3xRW\",\"emailField\":\"sign-in-dialog__email-field__g3xRW\",\"next-button\":\"sign-in-dialog__next-button__2pGtq\",\"nextButton\":\"sign-in-dialog__next-button__2pGtq\",\"continue-button\":\"sign-in-dialog__continue-button__kFN6Z\",\"continueButton\":\"sign-in-dialog__continue-button__kFN6Z\",\"sign-in-form\":\"sign-in-dialog__sign-in-form__3Muog\",\"signInForm\":\"sign-in-dialog__sign-in-form__3Muog\",\"sign-in-complete\":\"sign-in-dialog__sign-in-complete__3JMkv\",\"signInComplete\":\"sign-in-dialog__sign-in-complete__3JMkv\",\"terms\":\"sign-in-dialog__terms__3TT6i\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"ui\":\"hub__ui__3UYRO\",\"ui-dialog\":\"hub__ui-dialog__vlyfc\",\"uiDialog\":\"hub__ui-dialog__vlyfc\",\"ui-interactive\":\"hub__ui-interactive__3bdyc\",\"uiInteractive\":\"hub__ui-interactive__3bdyc\",\"presence-info\":\"hub__presence-info__dqWyo\",\"presenceInfo\":\"hub__presence-info__dqWyo\",\"settings-info\":\"hub__settings-info__S1Ve-\",\"settingsInfo\":\"hub__settings-info__S1Ve-\",\"profile-entry\":\"hub__profile-entry__1RY0R\",\"profileEntry\":\"hub__profile-entry__1RY0R\",\"form-submit\":\"hub__form-submit__12yem\",\"formSubmit\":\"hub__form-submit__12yem\",\"nag-corner-button\":\"hub__nag-corner-button__lNoyE\",\"nagCornerButton\":\"hub__nag-corner-button__lNoyE\",\"entry-button-secondary\":\"hub__entry-button-secondary__2ui-g\",\"entryButtonSecondary\":\"hub__entry-button-secondary__2ui-g\",\"leave-button\":\"hub__leave-button__1YK4o\",\"leaveButton\":\"hub__leave-button__1YK4o\",\"interstitial\":\"hub__interstitial__3WXbJ\",\"entry-button\":\"hub__entry-button__1e9jM\",\"entryButton\":\"hub__entry-button__1e9jM\",\"entry-panel\":\"hub__entry-panel__cCmIv\",\"entryPanel\":\"hub__entry-panel__cCmIv\",\"button-container\":\"hub__button-container__38FOc\",\"buttonContainer\":\"hub__button-container__38FOc\",\"action-button\":\"hub__action-button__3zqlu\",\"actionButton\":\"hub__action-button__3zqlu\",\"edit-button\":\"hub__edit-button__3Pw5z\",\"editButton\":\"hub__edit-button__3Pw5z\",\"info-button\":\"hub__info-button__1_6mY\",\"infoButton\":\"hub__info-button__1_6mY\",\"back\":\"hub__back__3AZh2\",\"form-field-text\":\"hub__form-field-text__tR1Lt\",\"formFieldText\":\"hub__form-field-text__tR1Lt\",\"lobby-label\":\"hub__lobby-label__2ktmo\",\"lobbyLabel\":\"hub__lobby-label__2ktmo\",\"label\":\"hub__label__1kjp1\",\"title\":\"hub__title__ezGEu\",\"name\":\"hub__name__2umw1\",\"center\":\"hub__center__1Mvfu\",\"wide-button\":\"hub__wide-button__1yqDc\",\"wideButton\":\"hub__wide-button__1yqDc\",\"screen-sharing\":\"hub__screen-sharing__2VF91\",\"screenSharing\":\"hub__screen-sharing__2VF91\",\"checkbox\":\"hub__checkbox__32dyv\",\"subscribe\":\"hub__subscribe__6Bn_L\",\"bottom-tip\":\"hub__bottom-tip__1-9c8\",\"bottomTip\":\"hub__bottom-tip__1-9c8\",\"loading-text\":\"hub__loading-text__1WDud\",\"loadingText\":\"hub__loading-text__1WDud\",\"ui-dialog-box-contents\":\"hub__ui-dialog-box-contents__PZ5qP\",\"uiDialogBoxContents\":\"hub__ui-dialog-box-contents__PZ5qP\",\"backgrounded\":\"hub__backgrounded__30IfD\",\"occupant-count\":\"hub__occupant-count__3eAEj\",\"occupantCount\":\"hub__occupant-count__3eAEj\",\"presence-info-selected\":\"hub__presence-info-selected__FRBSA\",\"presenceInfoSelected\":\"hub__presence-info-selected__FRBSA\",\"settings-info-selected\":\"hub__settings-info-selected__87DJe\",\"settingsInfoSelected\":\"hub__settings-info-selected__87DJe\",\"tip-cancel\":\"hub__tip-cancel__inNaZ\",\"tipCancel\":\"hub__tip-cancel__inNaZ\",\"tip\":\"hub__tip__2fJVE\",\"split-tip\":\"hub__split-tip__1ZzAR\",\"splitTip\":\"hub__split-tip__1ZzAR\",\"split-tip-icon\":\"hub__split-tip-icon__U8mYn\",\"splitTipIcon\":\"hub__split-tip-icon__U8mYn\",\"spawn_menu-icon\":\"hub__spawn_menu-icon__2OAkM\",\"spawnMenuIcon\":\"hub__spawn_menu-icon__2OAkM\",\"object_rotate_button-icon\":\"hub__object_rotate_button-icon__imE5p\",\"objectRotateButtonIcon\":\"hub__object_rotate_button-icon__imE5p\",\"object_scale_button-icon\":\"hub__object_scale_button-icon__3dQUx\",\"objectScaleButtonIcon\":\"hub__object_scale_button-icon__3dQUx\",\"object_recenter_button-icon\":\"hub__object_recenter_button-icon__3JV-m\",\"objectRecenterButtonIcon\":\"hub__object_recenter_button-icon__3JV-m\",\"avatar-editor\":\"hub__avatar-editor__2b8-H\",\"avatarEditor\":\"hub__avatar-editor__2b8-H\",\"logo\":\"hub__logo__3kJSj\",\"form\":\"hub__form__3kQXh\",\"box\":\"hub__box__2SMbn\",\"links\":\"hub__links__1C6Ce\",\"darkened\":\"hub__darkened__1gqMQ\",\"display-name\":\"hub__display-name__36hFZ\",\"displayName\":\"hub__display-name__36hFZ\",\"preview\":\"hub__preview__2UUoU\",\"choose-avatar\":\"hub__choose-avatar__22JJm\",\"chooseAvatar\":\"hub__choose-avatar__22JJm\",\"edit-avatar\":\"hub__edit-avatar__22A53\",\"editAvatar\":\"hub__edit-avatar__22A53\",\"entry-dialog\":\"hub__entry-dialog__2Ljux\",\"entryDialog\":\"hub__entry-dialog__2Ljux\",\"icon\":\"hub__icon__1pzf7\",\"bolded\":\"hub__bolded__2MYLZ\",\"subtitle\":\"hub__subtitle__3kYcd\",\"room-subtitle\":\"hub__room-subtitle__GhUCG\",\"roomSubtitle\":\"hub__room-subtitle__GhUCG\",\"lobby\":\"hub__lobby__2VW6G\",\"choose-scene\":\"hub__choose-scene__2bgB3\",\"chooseScene\":\"hub__choose-scene__2bgB3\",\"profile-icon\":\"hub__profile-icon__fwSfD\",\"profileIcon\":\"hub__profile-icon__fwSfD\",\"audio-loader\":\"hub__audio-loader__F5ovU\",\"audioLoader\":\"hub__audio-loader__F5ovU\",\"webvr-link-container\":\"hub__webvr-link-container__1Vq5m\",\"webvrLinkContainer\":\"hub__webvr-link-container__1Vq5m\",\"webvr-link\":\"hub__webvr-link__xW04U\",\"webvrLink\":\"hub__webvr-link__xW04U\",\"secondary\":\"hub__secondary__22yt_\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"touchZone\":\"virtual-gamepad-controls__touchZone__1KF_C\",\"left\":\"virtual-gamepad-controls__left__1-URB\",\"right\":\"virtual-gamepad-controls__right__1cgnU\",\"mockJoystickContainer\":\"virtual-gamepad-controls__mockJoystickContainer__1aH3e\",\"mockJoystick\":\"virtual-gamepad-controls__mockJoystick__2CuCG\",\"inner\":\"virtual-gamepad-controls__inner__1Bn3C\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"ui\":\"ui-root__ui__33CMU\",\"ui-dialog\":\"ui-root__ui-dialog__2TY9Y\",\"uiDialog\":\"ui-root__ui-dialog__2TY9Y\",\"ui-interactive\":\"ui-root__ui-interactive__2mtC4\",\"uiInteractive\":\"ui-root__ui-interactive__2mtC4\",\"presence-info\":\"ui-root__presence-info__3cieq\",\"presenceInfo\":\"ui-root__presence-info__3cieq\",\"settings-info\":\"ui-root__settings-info__HS4df\",\"settingsInfo\":\"ui-root__settings-info__HS4df\",\"nag-corner-button\":\"ui-root__nag-corner-button__3TFW5\",\"nagCornerButton\":\"ui-root__nag-corner-button__3TFW5\",\"leave-button\":\"ui-root__leave-button__29u2_\",\"leaveButton\":\"ui-root__leave-button__29u2_\",\"interstitial\":\"ui-root__interstitial__1cotl\",\"bottom-tip\":\"ui-root__bottom-tip__2Ycb0\",\"bottomTip\":\"ui-root__bottom-tip__2Ycb0\",\"ui-dialog-box-contents\":\"ui-root__ui-dialog-box-contents__3XWtl\",\"uiDialogBoxContents\":\"ui-root__ui-dialog-box-contents__3XWtl\",\"backgrounded\":\"ui-root__backgrounded__34j0m\",\"occupant-count\":\"ui-root__occupant-count__34rGX\",\"occupantCount\":\"ui-root__occupant-count__34rGX\",\"presence-info-selected\":\"ui-root__presence-info-selected__1Jhbw\",\"presenceInfoSelected\":\"ui-root__presence-info-selected__1Jhbw\",\"settings-info-selected\":\"ui-root__settings-info-selected__3W2A7\",\"settingsInfoSelected\":\"ui-root__settings-info-selected__3W2A7\",\"tip-cancel\":\"ui-root__tip-cancel__7ueO9\",\"tipCancel\":\"ui-root__tip-cancel__7ueO9\",\"tip\":\"ui-root__tip__ACGnW\",\"split-tip\":\"ui-root__split-tip__3eFQg\",\"splitTip\":\"ui-root__split-tip__3eFQg\",\"split-tip-icon\":\"ui-root__split-tip-icon__3GoW3\",\"splitTipIcon\":\"ui-root__split-tip-icon__3GoW3\",\"spawn_menu-icon\":\"ui-root__spawn_menu-icon__354r7\",\"spawnMenuIcon\":\"ui-root__spawn_menu-icon__354r7\",\"object_rotate_button-icon\":\"ui-root__object_rotate_button-icon__3rIrf\",\"objectRotateButtonIcon\":\"ui-root__object_rotate_button-icon__3rIrf\",\"object_scale_button-icon\":\"ui-root__object_scale_button-icon__1wcZr\",\"objectScaleButtonIcon\":\"ui-root__object_scale_button-icon__1wcZr\",\"object_recenter_button-icon\":\"ui-root__object_recenter_button-icon__3Yf-9\",\"objectRecenterButtonIcon\":\"ui-root__object_recenter_button-icon__3Yf-9\",\"avatar-editor\":\"ui-root__avatar-editor__2mO8z\",\"avatarEditor\":\"ui-root__avatar-editor__2mO8z\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"entry-button-secondary\":\"entry__entry-button-secondary__1Fr_E\",\"entryButtonSecondary\":\"entry__entry-button-secondary__1Fr_E\",\"entry-button\":\"entry__entry-button__G7PQF\",\"entryButton\":\"entry__entry-button__G7PQF\",\"entry-panel\":\"entry__entry-panel__34CD9\",\"entryPanel\":\"entry__entry-panel__34CD9\",\"button-container\":\"entry__button-container__3Blog\",\"buttonContainer\":\"entry__button-container__3Blog\",\"action-button\":\"entry__action-button__3Vnab\",\"actionButton\":\"entry__action-button__3Vnab\",\"edit-button\":\"entry__edit-button__22l1B\",\"editButton\":\"entry__edit-button__22l1B\",\"info-button\":\"entry__info-button__3u0qj\",\"infoButton\":\"entry__info-button__3u0qj\",\"back\":\"entry__back__J4Sgl\",\"lobby-label\":\"entry__lobby-label__2Nj9w\",\"lobbyLabel\":\"entry__lobby-label__2Nj9w\",\"label\":\"entry__label__fUhpb\",\"title\":\"entry__title__1GITj\",\"name\":\"entry__name__sYOeV\",\"center\":\"entry__center__1105W\",\"wide-button\":\"entry__wide-button__2tfMM\",\"wideButton\":\"entry__wide-button__2tfMM\",\"screen-sharing\":\"entry__screen-sharing__NBXQu\",\"screenSharing\":\"entry__screen-sharing__NBXQu\",\"checkbox\":\"entry__checkbox__3SoPk\",\"subscribe\":\"entry__subscribe__3vddd\",\"entry-dialog\":\"entry__entry-dialog__30kMs\",\"entryDialog\":\"entry__entry-dialog__30kMs\",\"icon\":\"entry__icon__3JiUl\",\"bolded\":\"entry__bolded__13B4f\",\"subtitle\":\"entry__subtitle__1BC2y\",\"room-subtitle\":\"entry__room-subtitle__7MSMo\",\"roomSubtitle\":\"entry__room-subtitle__7MSMo\",\"lobby\":\"entry__lobby__3AxfL\",\"choose-scene\":\"entry__choose-scene__3p4dH\",\"chooseScene\":\"entry__choose-scene__3p4dH\",\"profile-icon\":\"entry__profile-icon__3BAWG\",\"profileIcon\":\"entry__profile-icon__3BAWG\",\"audio-loader\":\"entry__audio-loader__1YCJd\",\"audioLoader\":\"entry__audio-loader__1YCJd\",\"webvr-link-container\":\"entry__webvr-link-container__3scWP\",\"webvrLinkContainer\":\"entry__webvr-link-container__3scWP\",\"webvr-link\":\"entry__webvr-link__3eWuZ\",\"webvrLink\":\"entry__webvr-link__3eWuZ\",\"secondary\":\"entry__secondary__3uhYE\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"invite-container\":\"invite-dialog__invite-container__1c0Jw\",\"inviteContainer\":\"invite-dialog__invite-container__1c0Jw\",\"dialog\":\"invite-dialog__dialog__1XbxO\",\"link-button\":\"invite-dialog__link-button__S_o-t\",\"linkButton\":\"invite-dialog__link-button__S_o-t\",\"enter-vr-button\":\"invite-dialog__enter-vr-button__3y1BF\",\"enterVrButton\":\"invite-dialog__enter-vr-button__3y1BF\",\"invite-button\":\"invite-dialog__invite-button__3cjFw\",\"inviteButton\":\"invite-dialog__invite-button__3cjFw\",\"enter-button\":\"invite-dialog__enter-button__2Z5EY\",\"enterButton\":\"invite-dialog__enter-button__2Z5EY\",\"invite-mini-button\":\"invite-dialog__invite-mini-button__2zWJj\",\"inviteMiniButton\":\"invite-dialog__invite-mini-button__2zWJj\",\"domain\":\"invite-dialog__domain__2Q8Wr\",\"invite-container-inverted\":\"invite-dialog__invite-container-inverted__1E3hR\",\"inviteContainerInverted\":\"invite-dialog__invite-container-inverted__1E3hR\",\"modal\":\"invite-dialog__modal__1hbVP\",\"hide-small-screens\":\"invite-dialog__hide-small-screens__3UCeH\",\"hideSmallScreens\":\"invite-dialog__hide-small-screens__3UCeH\",\"invite-container-below-hud\":\"invite-dialog__invite-container-below-hud__30RHX\",\"inviteContainerBelowHud\":\"invite-dialog__invite-container-below-hud__30RHX\",\"attach-point\":\"invite-dialog__attach-point__otyII\",\"attachPoint\":\"invite-dialog__attach-point__otyII\",\"code\":\"invite-dialog__code__13AIx\",\"keep-open\":\"invite-dialog__keep-open__229sO\",\"keepOpen\":\"invite-dialog__keep-open__229sO\",\"digit\":\"invite-dialog__digit__2w64P\",\"digit_2\":\"invite-dialog__digit_2__pQCJ3\",\"digit2\":\"invite-dialog__digit_2__pQCJ3\",\"digit_3\":\"invite-dialog__digit_3__1bWtt\",\"digit3\":\"invite-dialog__digit_3__1bWtt\",\"code-loading-panel\":\"invite-dialog__code-loading-panel__1gghm\",\"codeLoadingPanel\":\"invite-dialog__code-loading-panel__1gghm\",\"hub-link-link\":\"invite-dialog__hub-link-link__2guVF\",\"hubLinkLink\":\"invite-dialog__hub-link-link__2guVF\",\"buttons\":\"invite-dialog__buttons__1yN_j\",\"close\":\"invite-dialog__close__3PAxl\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"client-action-buttons\":\"client-info-dialog__client-action-buttons__3u-6v\",\"clientActionButtons\":\"client-info-dialog__client-action-buttons__3u-6v\",\"cancel\":\"client-info-dialog__cancel__2BguV\",\"client-info-dialog\":\"client-info-dialog__client-info-dialog__2e1dc\",\"clientInfoDialog\":\"client-info-dialog__client-info-dialog__2e1dc\",\"title\":\"client-info-dialog__title__3FGPe\",\"community-identifier\":\"client-info-dialog__community-identifier__g3lbP\",\"communityIdentifier\":\"client-info-dialog__community-identifier__g3lbP\",\"client-info\":\"client-info-dialog__client-info__1MUSa\",\"clientInfo\":\"client-info-dialog__client-info__1MUSa\",\"client-profile-image\":\"client-info-dialog__client-profile-image__zt1EA\",\"clientProfileImage\":\"client-info-dialog__client-profile-image__zt1EA\",\"client-details\":\"client-info-dialog__client-details__1F5zy\",\"clientDetails\":\"client-info-dialog__client-details__1F5zy\",\"client-main\":\"client-info-dialog__client-main__2BC1s\",\"clientMain\":\"client-info-dialog__client-main__2BC1s\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"loading-text\":\"loader__loading-text__QVcF3\",\"loadingText\":\"loader__loading-text__QVcF3\"};","import { forEachMaterial } from \"../utils/material-utils\";\nimport cubeMapPosX from \"../assets/images/cubemap/posx.jpg\";\nimport cubeMapNegX from \"../assets/images/cubemap/negx.jpg\";\nimport cubeMapPosY from \"../assets/images/cubemap/posy.jpg\";\nimport cubeMapNegY from \"../assets/images/cubemap/negy.jpg\";\nimport cubeMapPosZ from \"../assets/images/cubemap/posz.jpg\";\nimport cubeMapNegZ from \"../assets/images/cubemap/negz.jpg\";\n\nexport async function createDefaultEnvironmentMap() {\n  const urls = [cubeMapPosX, cubeMapNegX, cubeMapPosY, cubeMapNegY, cubeMapPosZ, cubeMapNegZ];\n  const texture = await new Promise((resolve, reject) =>\n    new THREE.CubeTextureLoader().load(urls, resolve, undefined, reject)\n  );\n  texture.format = THREE.RGBFormat;\n  return texture;\n}\n\nAFRAME.registerComponent(\"environment-map\", {\n  schema: {\n    loadDefault: { type: \"boolean\", default: true }\n  },\n\n  init() {\n    this.environmentMap = null;\n\n    this.updateEnvironmentMap = this.updateEnvironmentMap.bind(this);\n\n    if (this.data.loadDefault) {\n      // Used in the avatar selector scene because there is no skybox.\n      createDefaultEnvironmentMap().then(this.updateEnvironmentMap);\n    }\n  },\n\n  updateEnvironmentMap(environmentMap) {\n    this.environmentMap = environmentMap;\n    this.applyEnvironmentMap(this.el.object3D);\n  },\n\n  applyEnvironmentMap(object3D) {\n    object3D.traverse(object => {\n      forEachMaterial(object, material => {\n        if (material.isMeshStandardMaterial) {\n          material.envMap = this.environmentMap;\n          material.needsUpdate = true;\n        }\n      });\n    });\n  }\n});\n","// removed by extract-text-webpack-plugin\nmodule.exports = {\"profile-entry\":\"profile__profile-entry__1pJKZ\",\"profileEntry\":\"profile__profile-entry__1pJKZ\",\"form-submit\":\"profile__form-submit__2y7xb\",\"formSubmit\":\"profile__form-submit__2y7xb\",\"form-field-text\":\"profile__form-field-text__1bzeV\",\"formFieldText\":\"profile__form-field-text__1bzeV\",\"title\":\"profile__title__Vcynv\",\"logo\":\"profile__logo__1JZAd\",\"form\":\"profile__form__1-hBO\",\"box\":\"profile__box__oJXQD\",\"links\":\"profile__links__2hukW\",\"darkened\":\"profile__darkened__1rVba\",\"display-name\":\"profile__display-name__auABh\",\"displayName\":\"profile__display-name__auABh\",\"preview\":\"profile__preview__3QjLq\",\"choose-avatar\":\"profile__choose-avatar__2EV0F\",\"chooseAvatar\":\"profile__choose-avatar__2EV0F\",\"edit-avatar\":\"profile__edit-avatar__3386A\",\"editAvatar\":\"profile__edit-avatar__3386A\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"preview\":\"avatar-preview__preview__2I8qx\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"media-browser\":\"media-browser__media-browser__y0Hsu\",\"mediaBrowser\":\"media-browser__media-browser__y0Hsu\",\"facets\":\"media-browser__facets__1Yz65\",\"facet\":\"media-browser__facet__2uP6U\",\"body\":\"media-browser__body__j6Tv2\",\"pager\":\"media-browser__pager__RKx5O\",\"header-center\":\"media-browser__header-center__2D9CW\",\"headerCenter\":\"media-browser__header-center__2D9CW\",\"search\":\"media-browser__search__3gQ84\",\"engine-attribution\":\"media-browser__engine-attribution__2P2aD\",\"engineAttribution\":\"media-browser__engine-attribution__2P2aD\",\"engine-attribution-contents\":\"media-browser__engine-attribution-contents__gCdfr\",\"engineAttributionContents\":\"media-browser__engine-attribution-contents__gCdfr\",\"box\":\"media-browser__box__1KHYi\",\"header\":\"media-browser__header__zqZ09\",\"no-search\":\"media-browser__no-search__3N90H\",\"noSearch\":\"media-browser__no-search__3N90H\",\"nav\":\"media-browser__nav__9J5If\",\"nav-right-pad\":\"media-browser__nav-right-pad__1qH0B\",\"navRightPad\":\"media-browser__nav-right-pad__1qH0B\",\"nav-source\":\"media-browser__nav-source__o6NI6\",\"navSource\":\"media-browser__nav-source__o6NI6\",\"nav-source-selected\":\"media-browser__nav-source-selected__2osjH\",\"navSourceSelected\":\"media-browser__nav-source-selected__2osjH\",\"nav-scroll-arrow\":\"media-browser__nav-scroll-arrow__2Nikk\",\"navScrollArrow\":\"media-browser__nav-scroll-arrow__2Nikk\",\"tiles\":\"media-browser__tiles__1BYEY\",\"tile\":\"media-browser__tile__2lzHU\",\"info\":\"media-browser__info__2c8Zs\",\"name\":\"media-browser__name__RFiE4\",\"attribution\":\"media-browser__attribution__3glgj\",\"creator\":\"media-browser__creator__3LDPh\",\"publisher\":\"media-browser__publisher__mTzsX\",\"tile-link\":\"media-browser__tile-link__IXyUO\",\"tileLink\":\"media-browser__tile-link__IXyUO\",\"tile-content\":\"media-browser__tile-content__1QYSP\",\"tileContent\":\"media-browser__tile-content__1QYSP\",\"avatar-tile\":\"media-browser__avatar-tile__qNo2r\",\"avatarTile\":\"media-browser__avatar-tile__qNo2r\",\"edit-avatar\":\"media-browser__edit-avatar__2HBfV\",\"editAvatar\":\"media-browser__edit-avatar__2HBfV\",\"create-tile\":\"media-browser__create-tile__RL9vr\",\"createTile\":\"media-browser__create-tile__RL9vr\",\"tiles-variable\":\"media-browser__tiles-variable__1ZNxg\",\"tilesVariable\":\"media-browser__tiles-variable__1ZNxg\",\"page-number\":\"media-browser__page-number__OTpSH\",\"pageNumber\":\"media-browser__page-number__OTpSH\",\"pager-button-disabled\":\"media-browser__pager-button-disabled__ytlSN\",\"pagerButtonDisabled\":\"media-browser__pager-button-disabled__ytlSN\",\"header-left\":\"media-browser__header-left__1ObQh\",\"headerLeft\":\"media-browser__header-left__1ObQh\",\"header-right\":\"media-browser__header-right__3k3JZ\",\"headerRight\":\"media-browser__header-right__3k3JZ\",\"create-button\":\"media-browser__create-button__30hMV\",\"createButton\":\"media-browser__create-button__30hMV\",\"create-link\":\"media-browser__create-link__28Bpj\",\"createLink\":\"media-browser__create-link__28Bpj\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"action-button\":\"create-object-dialog__action-button__3OIJQ\",\"actionButton\":\"create-object-dialog__action-button__3OIJQ\",\"buttons\":\"create-object-dialog__buttons__1zA-b\",\"small-button\":\"create-object-dialog__small-button__7UxXQ\",\"smallButton\":\"create-object-dialog__small-button__7UxXQ\",\"input-border\":\"create-object-dialog__input-border__1N9AV\",\"inputBorder\":\"create-object-dialog__input-border__1N9AV\",\"left-side-of-input\":\"create-object-dialog__left-side-of-input__zyV06\",\"leftSideOfInput\":\"create-object-dialog__left-side-of-input__zyV06\",\"add-media-form\":\"create-object-dialog__add-media-form__10Wh-\",\"addMediaForm\":\"create-object-dialog__add-media-form__10Wh-\",\"cancel-icon\":\"create-object-dialog__cancel-icon__yD-8A\",\"cancelIcon\":\"create-object-dialog__cancel-icon__yD-8A\",\"upload-icon\":\"create-object-dialog__upload-icon__19g9k\",\"uploadIcon\":\"create-object-dialog__upload-icon__19g9k\",\"hide-file-input\":\"create-object-dialog__hide-file-input__2myDe\",\"hideFileInput\":\"create-object-dialog__hide-file-input__2myDe\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"action-button\":\"change-scene-dialog__action-button__1xtdK\",\"actionButton\":\"change-scene-dialog__action-button__1xtdK\",\"buttons\":\"change-scene-dialog__buttons__2QE34\",\"spoke-launch\":\"change-scene-dialog__spoke-launch__YObDn\",\"spokeLaunch\":\"change-scene-dialog__spoke-launch__YObDn\",\"input-border\":\"change-scene-dialog__input-border__30jd6\",\"inputBorder\":\"change-scene-dialog__input-border__30jd6\",\"left-side-of-input\":\"change-scene-dialog__left-side-of-input__14WKu\",\"leftSideOfInput\":\"change-scene-dialog__left-side-of-input__14WKu\",\"change-scene-button\":\"change-scene-dialog__change-scene-button__ckfZW\",\"changeSceneButton\":\"change-scene-dialog__change-scene-button__ckfZW\",\"spoke-create\":\"change-scene-dialog__spoke-create__2krL-\",\"spokeCreate\":\"change-scene-dialog__spoke-create__2krL-\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"avatar-url-dialog\":\"avatar-url-dialog__avatar-url-dialog__17OoD\",\"avatarUrlDialog\":\"avatar-url-dialog__avatar-url-dialog__17OoD\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"close-button\":\"link-dialog__close-button__2THTw\",\"closeButton\":\"link-dialog__close-button__2THTw\",\"domain\":\"link-dialog__domain__1WbPJ\",\"dialog\":\"link-dialog__dialog__1zbyG\",\"header\":\"link-dialog__header__1A06x\",\"contents\":\"link-dialog__contents__3ODVz\",\"code\":\"link-dialog__code__259RI\",\"imageHeader\":\"link-dialog__imageHeader__eaJe6\",\"keep-open\":\"link-dialog__keep-open__DYcUI\",\"keepOpen\":\"link-dialog__keep-open__DYcUI\",\"digit\":\"link-dialog__digit___zoC4\",\"code-loading-panel\":\"link-dialog__code-loading-panel__WKkNk\",\"codeLoadingPanel\":\"link-dialog__code-loading-panel__WKkNk\",\"close\":\"link-dialog__close__2TTmg\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"name-field\":\"rename-room-dialog__name-field__1Huun\",\"nameField\":\"rename-room-dialog__name-field__1Huun\",\"next-button\":\"rename-room-dialog__next-button__3OH0z\",\"nextButton\":\"rename-room-dialog__next-button__3OH0z\",\"continue-button\":\"rename-room-dialog__continue-button__2xIHQ\",\"continueButton\":\"rename-room-dialog__continue-button__2xIHQ\",\"rename-room-form\":\"rename-room-dialog__rename-room-form__2B6N7\",\"renameRoomForm\":\"rename-room-dialog__rename-room-form__2B6N7\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"cancel-button\":\"close-room-dialog__cancel-button__MmtAo\",\"cancelButton\":\"close-room-dialog__cancel-button__MmtAo\",\"confirm-button\":\"close-room-dialog__confirm-button__Bs9y3\",\"confirmButton\":\"close-room-dialog__confirm-button__Bs9y3\",\"message\":\"close-room-dialog__message__1Rvh3\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"title\":\"room-info-dialog__title__3-3CO\",\"room-info\":\"room-info-dialog__room-info__3XkbS\",\"roomInfo\":\"room-info-dialog__room-info__3XkbS\",\"scene-screenshot\":\"room-info-dialog__scene-screenshot__3PWz-\",\"sceneScreenshot\":\"room-info-dialog__scene-screenshot__3PWz-\",\"scene-details\":\"room-info-dialog__scene-details__2pYml\",\"sceneDetails\":\"room-info-dialog__scene-details__2pYml\",\"scene-main\":\"room-info-dialog__scene-main__2mhXj\",\"sceneMain\":\"room-info-dialog__scene-main__2mhXj\",\"scene-name\":\"room-info-dialog__scene-name__1bqGh\",\"sceneName\":\"room-info-dialog__scene-name__1bqGh\",\"scene-creator\":\"room-info-dialog__scene-creator__3_za4\",\"sceneCreator\":\"room-info-dialog__scene-creator__3_za4\",\"scene-attributions\":\"room-info-dialog__scene-attributions__QpYVd\",\"sceneAttributions\":\"room-info-dialog__scene-attributions__QpYVd\",\"attribution\":\"room-info-dialog__attribution__I9_V-\",\"attribution-name\":\"room-info-dialog__attribution-name__3JTpI\",\"attributionName\":\"room-info-dialog__attribution-name__3JTpI\",\"attribution-author\":\"room-info-dialog__attribution-author__BouZB\",\"attributionAuthor\":\"room-info-dialog__attribution-author__BouZB\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"oauth-button\":\"oauth-dialog__oauth-button__25RiO\",\"oauthButton\":\"oauth-dialog__oauth-button__25RiO\",\"oauth-type-name\":\"oauth-dialog__oauth-type-name__jPyhW\",\"oauthTypeName\":\"oauth-dialog__oauth-type-name__jPyhW\",\"oauth-icon\":\"oauth-dialog__oauth-icon__v1G6W\",\"oauthIcon\":\"oauth-dialog__oauth-icon__v1G6W\",\"privacy-notice\":\"oauth-dialog__privacy-notice__2R9ZT\",\"privacyNotice\":\"oauth-dialog__privacy-notice__2R9ZT\",\"oauth-buttons\":\"oauth-dialog__oauth-buttons__1U1Ni\",\"oauthButtons\":\"oauth-dialog__oauth-buttons__1U1Ni\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"message-entry-in-room\":\"message-entry__message-entry-in-room__1aN5s\",\"messageEntryInRoom\":\"message-entry__message-entry-in-room__1aN5s\",\"message-entry-spawn\":\"message-entry__message-entry-spawn__1_AF5\",\"messageEntrySpawn\":\"message-entry__message-entry-spawn__1_AF5\",\"message-entry-input\":\"message-entry__message-entry-input__2AtQE\",\"messageEntryInput\":\"message-entry__message-entry-input__2AtQE\",\"message-entry\":\"message-entry__message-entry__x7lQX\",\"messageEntry\":\"message-entry__message-entry__x7lQX\",\"message-entry-disabled\":\"message-entry__message-entry-disabled__25LSI\",\"messageEntryDisabled\":\"message-entry__message-entry-disabled__25LSI\",\"message-entry-button\":\"message-entry__message-entry-button__3xJhH\",\"messageEntryButton\":\"message-entry__message-entry-button__3xJhH\",\"message-entry-button-in-room\":\"message-entry__message-entry-button-in-room__2yMTR\",\"messageEntryButtonInRoom\":\"message-entry__message-entry-button-in-room__2yMTR\",\"message-entry-upload\":\"message-entry__message-entry-upload__3F0sX\",\"messageEntryUpload\":\"message-entry__message-entry-upload__3F0sX\",\"message-entry-input-in-room\":\"message-entry__message-entry-input-in-room__30ReF\",\"messageEntryInputInRoom\":\"message-entry__message-entry-input-in-room__30ReF\",\"message-entry-on-mobile\":\"message-entry__message-entry-on-mobile__2pSYF\",\"messageEntryOnMobile\":\"message-entry__message-entry-on-mobile__2pSYF\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"command-help\":\"chat-command-help__command-help__q0Wb8\",\"commandHelp\":\"chat-command-help__command-help__q0Wb8\",\"entry\":\"chat-command-help__entry__1E1un\",\"command\":\"chat-command-help__command__2GMyn\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"presence-log\":\"presence-log__presence-log__10oFj\",\"presenceLog\":\"presence-log__presence-log__10oFj\",\"presence-log-entry\":\"presence-log__presence-log-entry__dt0t4\",\"presenceLogEntry\":\"presence-log__presence-log-entry__dt0t4\",\"message-body\":\"presence-log__message-body__2L9jA\",\"messageBody\":\"presence-log__message-body__2L9jA\",\"message-body-multi\":\"presence-log__message-body-multi__2e-Sx\",\"messageBodyMulti\":\"presence-log__message-body-multi__2e-Sx\",\"message-body-mono\":\"presence-log__message-body-mono__3zuQE\",\"messageBodyMono\":\"presence-log__message-body-mono__3zuQE\",\"message-wrap\":\"presence-log__message-wrap__2aWCa\",\"messageWrap\":\"presence-log__message-wrap__2aWCa\",\"message-wrap-multi\":\"presence-log__message-wrap-multi__1eA6v\",\"messageWrapMulti\":\"presence-log__message-wrap-multi__1eA6v\",\"message-source\":\"presence-log__message-source__3CI4d\",\"messageSource\":\"presence-log__message-source__3CI4d\",\"message-source-link\":\"presence-log__message-source-link__1evTZ\",\"messageSourceLink\":\"presence-log__message-source-link__1evTZ\",\"icon-button\":\"presence-log__icon-button__2Shbm\",\"iconButton\":\"presence-log__icon-button__2Shbm\",\"spawn-message\":\"presence-log__spawn-message__14Ne8\",\"spawnMessage\":\"presence-log__spawn-message__14Ne8\",\"share\":\"presence-log__share__37U7E\",\"media\":\"presence-log__media__2qG_d\",\"mediaBody\":\"presence-log__mediaBody__1rByA\",\"expired\":\"presence-log__expired__2wMJc\",\"presence-log-entry-with-button\":\"presence-log__presence-log-entry-with-button__1PxTw\",\"presenceLogEntryWithButton\":\"presence-log__presence-log-entry-with-button__1PxTw\",\"presence-log-in-room\":\"presence-log__presence-log-in-room__17h3n\",\"presenceLogInRoom\":\"presence-log__presence-log-in-room__17h3n\",\"presence-log-spawn\":\"presence-log__presence-log-spawn__3jlmT\",\"presenceLogSpawn\":\"presence-log__presence-log-spawn__3jlmT\",\"presence-log-entry-one-line\":\"presence-log__presence-log-entry-one-line__bRXfp\",\"presenceLogEntryOneLine\":\"presence-log__presence-log-entry-one-line__bRXfp\",\"presence-log-emoji\":\"presence-log__presence-log-emoji__1_3Yn\",\"presenceLogEmoji\":\"presence-log__presence-log-emoji__1_3Yn\",\"emoji\":\"presence-log__emoji__10b18\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"client-link\":\"presence-list__client-link__3tkyz\",\"clientLink\":\"presence-list__client-link__3tkyz\",\"presence-list\":\"presence-list__presence-list__1KERe\",\"presenceList\":\"presence-list__presence-list__1KERe\",\"attach-point\":\"presence-list__attach-point__kIdfx\",\"attachPoint\":\"presence-list__attach-point__kIdfx\",\"contents\":\"presence-list__contents__1B7bz\",\"rows\":\"presence-list__rows__1B6KS\",\"row\":\"presence-list__row__1D2j2\",\"row-header\":\"presence-list__row-header__3kl1w\",\"rowHeader\":\"presence-list__row-header__3kl1w\",\"list-item\":\"presence-list__list-item__2YARP\",\"listItem\":\"presence-list__list-item__2YARP\",\"list-item-link\":\"presence-list__list-item-link__2DLC2\",\"listItemLink\":\"presence-list__list-item-link__2DLC2\",\"presence\":\"presence-list__presence__15DJe\",\"sign-in\":\"presence-list__sign-in__28eVu\",\"signIn\":\"presence-list__sign-in__28eVu\",\"icon\":\"presence-list__icon__1t8iB\",\"self\":\"presence-list__self__1g-bw\",\"moderator-badge\":\"presence-list__moderator-badge__2njku\",\"moderatorBadge\":\"presence-list__moderator-badge__2njku\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"avatar-editor\":\"avatar-editor__avatar-editor__xtJ6P\",\"avatarEditor\":\"avatar-editor__avatar-editor__xtJ6P\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"bottom-links-main\":\"settings-menu__bottom-links-main__Vtlje\",\"bottomLinksMain\":\"settings-menu__bottom-links-main__Vtlje\",\"settings-menu\":\"settings-menu__settings-menu__3x1Pv\",\"settingsMenu\":\"settings-menu__settings-menu__3x1Pv\",\"attach-point\":\"settings-menu__attach-point__2gV3g\",\"attachPoint\":\"settings-menu__attach-point__2gV3g\",\"contents\":\"settings-menu__contents__3GQlW\",\"rows\":\"settings-menu__rows__2OtlS\",\"row\":\"settings-menu__row__3w7fz\",\"row-header\":\"settings-menu__row-header__2oCqk\",\"rowHeader\":\"settings-menu__row-header__2oCqk\",\"list-item\":\"settings-menu__list-item__1__z6\",\"listItem\":\"settings-menu__list-item__1__z6\",\"list-item-link\":\"settings-menu__list-item-link__2ovr3\",\"listItemLink\":\"settings-menu__list-item-link__2ovr3\",\"settings-row\":\"settings-menu__settings-row__1sDDk\",\"settingsRow\":\"settings-menu__settings-row__1sDDk\",\"icon\":\"settings-menu__icon__3KMMz\",\"bottom-links\":\"settings-menu__bottom-links__b1tDE\",\"bottomLinks\":\"settings-menu__bottom-links__b1tDE\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"panel\":\"_2d-hud__panel__2oM_T\",\"top-tip\":\"_2d-hud__top-tip__E5uti\",\"topTip\":\"_2d-hud__top-tip__E5uti\",\"container\":\"_2d-hud__container__66GRt\",\"top\":\"_2d-hud__top__3PiNe\",\"column\":\"_2d-hud__column__1y7XY\",\"bottom\":\"_2d-hud__bottom__2jUcT\",\"hide\":\"_2d-hud__hide__3HJO8\",\"attach-point\":\"_2d-hud__attach-point__17FSc\",\"attachPoint\":\"_2d-hud__attach-point__17FSc\",\"attach_video_share_mode\":\"_2d-hud__attach_video_share_mode__21PhM\",\"attachVideoShareMode\":\"_2d-hud__attach_video_share_mode__21PhM\",\"attach_pen_mode\":\"_2d-hud__attach_pen_mode__cI1AW\",\"attachPenMode\":\"_2d-hud__attach_pen_mode__cI1AW\",\"attach_mute_mode\":\"_2d-hud__attach_mute_mode__153iB\",\"attachMuteMode\":\"_2d-hud__attach_mute_mode__153iB\",\"attach_freeze_mode\":\"_2d-hud__attach_freeze_mode__3UIHP\",\"attachFreezeMode\":\"_2d-hud__attach_freeze_mode__3UIHP\",\"video-share-extra-options\":\"_2d-hud__video-share-extra-options__31VMr\",\"videoShareExtraOptions\":\"_2d-hud__video-share-extra-options__31VMr\",\"iconButton\":\"_2d-hud__iconButton__3faJz\",\"up\":\"_2d-hud__up__1lyhr\",\"small\":\"_2d-hud__small__2rqgF\",\"large\":\"_2d-hud__large__2bHqH\",\"video-share\":\"_2d-hud__video-share__38X7W\",\"videoShare\":\"_2d-hud__video-share__38X7W\",\"mute\":\"_2d-hud__mute__25kHI\",\"active\":\"_2d-hud__active__1TMB8\",\"pen\":\"_2d-hud__pen__3uTC7\",\"camera\":\"_2d-hud__camera__84ksg\",\"freeze\":\"_2d-hud__freeze__26rlJ\",\"spawn\":\"_2d-hud__spawn__1FoBz\",\"mobile-media-picker\":\"_2d-hud__mobile-media-picker__3ZXHc\",\"mobileMediaPicker\":\"_2d-hud__mobile-media-picker__3ZXHc\",\"share_camera\":\"_2d-hud__share_camera__v67Il\",\"shareCamera\":\"_2d-hud__share_camera__v67Il\",\"share_screen\":\"_2d-hud__share_screen__1HQ8E\",\"shareScreen\":\"_2d-hud__share_screen__1HQ8E\",\"share_window\":\"_2d-hud__share_window__stsD3\",\"shareWindow\":\"_2d-hud__share_window__stsD3\"};","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\n\nimport styles from \"../assets/stylesheets/sign-in-dialog.scss\";\nimport DialogContainer from \"./dialog-container\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\n\nexport default class SignInDialog extends Component {\n  static propTypes = {\n    authStarted: PropTypes.bool,\n    authComplete: PropTypes.bool,\n    onSignIn: PropTypes.func,\n    onContinue: PropTypes.func,\n    message: PropTypes.string,\n    continueText: PropTypes.string\n  };\n\n  state = {\n    email: \"\"\n  };\n\n  onSubmit = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    this.props.onSignIn(this.state.email);\n  };\n\n  render() {\n    let contents;\n    if (this.props.authStarted) {\n      contents = (\n        <p>\n          <FormattedMessage className=\"preformatted\" id=\"sign-in.auth-started\" />\n        </p>\n      );\n    } else if (this.props.authComplete) {\n      contents = (\n        <div className={styles.signInComplete}>\n          <p>{this.props.message}</p>\n          <button onClick={this.props.onContinue} className={styles.continueButton}>\n            {this.props.continueText}\n          </button>\n        </div>\n      );\n    } else {\n      contents = (\n        <form onSubmit={this.onSubmit} className={styles.signInForm}>\n          <span>{this.props.message}</span>\n          <input\n            name=\"email\"\n            type=\"email\"\n            required\n            placeholder=\"Your email address\"\n            value={this.state.email}\n            onFocus={e => handleTextFieldFocus(e.target)}\n            onBlur={() => handleTextFieldBlur()}\n            onChange={e => this.setState({ email: e.target.value })}\n            className={styles.emailField}\n          />\n          <p className={styles.terms}>\n            By proceeding, you agree to the{\" \"}\n            <a rel=\"noopener noreferrer\" target=\"_blank\" href=\"https://github.com/mozilla/hubs/blob/master/TERMS.md\">\n              terms of use\n            </a>{\" \"}\n            and{\" \"}\n            <a rel=\"noopener noreferrer\" target=\"_blank\" href=\"https://github.com/mozilla/hubs/blob/master/PRIVACY.md\">\n              privacy notice\n            </a>.\n          </p>\n          <button type=\"submit\" className={styles.nextButton}>\n            next\n          </button>\n        </form>\n      );\n    }\n\n    return (\n      <DialogContainer title=\"Sign In\" {...this.props}>\n        {contents}\n      </DialogContainer>\n    );\n  }\n}\n","export const paths = {};\npaths.noop = \"/noop\";\npaths.actions = {};\npaths.actions.log = \"/actions/log\";\npaths.actions.toggleScreenShare = \"/actions/toggleScreenShare\";\npaths.actions.snapRotateLeft = \"/actions/snapRotateLeft\";\npaths.actions.snapRotateRight = \"/actions/snapRotateRight\";\npaths.actions.logDebugFrame = \"/actions/logDebugFrame\";\npaths.actions.logInteractionState = \"/actions/logInteractionState\";\npaths.actions.cameraDelta = \"/actions/cameraDelta\";\npaths.actions.characterAcceleration = \"/actions/characterAcceleration\";\npaths.actions.boost = \"/actions/boost\";\npaths.actions.startGazeTeleport = \"/actions/startTeleport\";\npaths.actions.stopGazeTeleport = \"/actions/stopTeleport\";\npaths.actions.spawnPen = \"/actions/spawnPen\";\npaths.actions.ensureFrozen = \"/actions/ensureFrozen\";\npaths.actions.toggleFreeze = \"/actions/toggleFreeze\";\npaths.actions.thaw = \"/actions/thaw\";\npaths.actions.muteMic = \"/actions/muteMic\";\npaths.actions.focusChat = \"/actions/focusChat\";\npaths.actions.focusChatCommand = \"/actions/focusChatCommand\";\npaths.actions.toggleCamera = \"/actions/toggleCamera\";\npaths.actions.takeSnapshot = \"/actions/takeSnapshot\";\npaths.actions.mediaExit = \"/actions/mediaExit\";\npaths.actions.mediaSearch1 = \"/actions/mediaSearch1\";\npaths.actions.mediaSearch2 = \"/actions/mediaSearch2\";\npaths.actions.mediaSearch3 = \"/actions/mediaSearch3\";\npaths.actions.mediaSearch4 = \"/actions/mediaSearch4\";\npaths.actions.mediaSearch5 = \"/actions/mediaSearch5\";\npaths.actions.mediaSearch6 = \"/actions/mediaSearch6\";\npaths.actions.mediaSearch7 = \"/actions/mediaSearch7\";\npaths.actions.mediaSearch8 = \"/actions/mediaSearch8\";\npaths.actions.transformModifier = \"/actions/transformModifier\";\npaths.actions.rayObjectRotation = \"/actions/rayObjectRotation\";\npaths.actions.cursor = {};\npaths.actions.cursor.pose = \"/actions/cursorPose\";\npaths.actions.cursor.grab = \"/actions/cursorGrab\";\npaths.actions.cursor.drop = \"/actions/cursorDrop\";\npaths.actions.cursor.modDelta = \"/actions/cursorModDelta\";\npaths.actions.cursor.startDrawing = \"/actions/cursorStartDrawing\";\npaths.actions.cursor.stopDrawing = \"/actions/cursorStopDrawing\";\npaths.actions.cursor.undoDrawing = \"/actions/cursorUndoDrawing\";\npaths.actions.cursor.penNextColor = \"/actions/cursorPenNextColor\";\npaths.actions.cursor.penPrevColor = \"/actions/cursorPenPrevColor\";\npaths.actions.cursor.scalePenTip = \"/actions/cursorScalePenTip\";\npaths.actions.cursor.scaleGrabbedGrabbable = \"/actions/cursorScaleGrabbedGrabbable\";\npaths.actions.cursor.mediaVolumeMod = \"/actions/cursor/mediaVolumeMod\";\npaths.actions.cursor.takeSnapshot = \"/actions/cursorTakeSnapshot\";\npaths.actions.pen = {};\npaths.actions.pen.remove = \"/actions/pen/remove\";\npaths.actions.rightHand = {};\npaths.actions.rightHand.matrix = \"/actions/rightHand/matrix\";\npaths.actions.rightHand.pose = \"/actions/rightHandPose\";\npaths.actions.rightHand.grab = \"/actions/rightHandGrab\";\npaths.actions.rightHand.drop = \"/actions/rightHandDrop\";\npaths.actions.rightHand.modDelta = \"/actions/rightHandModDelta\";\npaths.actions.rightHand.startDrawing = \"/actions/rightHandStartDrawing\";\npaths.actions.rightHand.stopDrawing = \"/actions/rightHandStopDrawing\";\npaths.actions.rightHand.undoDrawing = \"/actions/rightHandUndoDrawing\";\npaths.actions.rightHand.penNextColor = \"/actions/rightHandPenNextColor\";\npaths.actions.rightHand.penPrevColor = \"/actions/rightHandPenPrevColor\";\npaths.actions.rightHand.scalePenTip = \"/actions/rightHandScalePenTip\";\npaths.actions.rightHand.startTeleport = \"/actions/rightHand/startTeleport\";\npaths.actions.rightHand.stopTeleport = \"/actions/rightHand/stopTeleport\";\npaths.actions.rightHand.takeSnapshot = \"/actions/rightHandTakeSnapshot\";\npaths.actions.rightHand.thumb = \"/actions/rightHand/thumbDown\";\npaths.actions.rightHand.index = \"/actions/rightHand/indexDown\";\npaths.actions.rightHand.middleRingPinky = \"/actions/rightHand/middleRingPinkyDown\";\npaths.actions.leftHand = {};\npaths.actions.leftHand.matrix = \"/actions/leftHand/matrix\";\npaths.actions.leftHand.pose = \"/actions/leftHandPose\";\npaths.actions.leftHand.grab = \"/actions/leftHandGrab\";\npaths.actions.leftHand.drop = \"/actions/leftHandDrop\";\npaths.actions.leftHand.modDelta = \"/actions/leftHandModDelta\";\npaths.actions.leftHand.startDrawing = \"/actions/leftHandStartDrawing\";\npaths.actions.leftHand.stopDrawing = \"/actions/leftHandStopDrawing\";\npaths.actions.leftHand.undoDrawing = \"/actions/leftHandUndoDrawing\";\npaths.actions.leftHand.penNextColor = \"/actions/leftHandPenNextColor\";\npaths.actions.leftHand.penPrevColor = \"/actions/leftHandPenPrevColor\";\npaths.actions.leftHand.scalePenTip = \"/actions/leftHandScalePenTip\";\npaths.actions.leftHand.startTeleport = \"/actions/leftHand/startTeleport\";\npaths.actions.leftHand.stopTeleport = \"/actions/leftHand/stopTeleport\";\npaths.actions.leftHand.takeSnapshot = \"/actions/leftHandTakeSnapshot\";\npaths.actions.leftHand.thumb = \"/actions/leftHand/thumbDown\";\npaths.actions.leftHand.index = \"/actions/leftHand/indexDown\";\npaths.actions.leftHand.middleRingPinky = \"/actions/leftHand/middleRingPinkyDown\";\npaths.actions.camera = {};\npaths.actions.camera.exitMirror = \"/actions/cameraExitMirror\";\npaths.haptics = {};\npaths.haptics.actuators = {};\npaths.haptics.actuators.left = \"/haptics/actuators/left\";\npaths.haptics.actuators.right = \"/haptics/actuators/right\";\n\npaths.device = {};\npaths.device.mouse = {};\npaths.device.mouse.coords = \"/device/mouse/coords\";\npaths.device.mouse.movementXY = \"/device/mouse/movementXY\";\npaths.device.mouse.buttonLeft = \"/device/mouse/buttonLeft\";\npaths.device.mouse.buttonRight = \"/device/mouse/buttonRight\";\npaths.device.mouse.wheel = \"/device/mouse/wheel\";\npaths.device.smartMouse = {};\npaths.device.smartMouse.cursorPose = \"/device/smartMouse/cursorPose\";\npaths.device.smartMouse.cameraDelta = \"/device/smartMouse/cameraDelta\";\npaths.device.touchscreen = {};\npaths.device.touchscreen.cursorPose = \"/device/touchscreen/cursorPose\";\npaths.device.touchscreen.touchCameraDelta = \"/device/touchscreen/touchCameraDelta\";\npaths.device.touchscreen.gyroCameraDelta = \"/device/touchscreen/gyroCameraDelta\";\npaths.device.touchscreen.cameraDelta = \"/device/touchscreen/cameraDelta\";\npaths.device.touchscreen.pinch = {};\npaths.device.touchscreen.pinch.delta = \"/device/touchscreen/pinch/delta\";\npaths.device.touchscreen.pinch.initialDistance = \"/device/touchscreen/pinch/initialDistance\";\npaths.device.touchscreen.pinch.currentDistance = \"/device/touchscreen/pinch/currentDistance\";\npaths.device.touchscreen.isTouching = \"/device/touchscreen/isTouching\";\npaths.device.touchscreen.isTouchingGrabbable = \"/device/touchscreen/isTouchingGrabbable\";\npaths.device.touchscreen.tap1 = \"/device/touchscreen/tap1\";\npaths.device.touchscreen.tap2 = \"/device/touchscreen/tap2\";\npaths.device.touchscreen.tap3 = \"/device/touchscreen/tap3\";\npaths.device.touchscreen.tap4 = \"/device/touchscreen/tap4\";\npaths.device.touchscreen.tap5 = \"/device/touchscreen/tap5\";\npaths.device.gyro = {};\npaths.device.gyro.averageDeltaX = \"/device/gyro/averageDeltaX\";\npaths.device.gyro.averageDeltaY = \"/device/gyro/averageDeltaY\";\npaths.device.hud = {};\npaths.device.hud.penButton = \"/device/hud/penButton\";\n\npaths.device.keyboard = {\n  map: new Map(),\n  key: function(k) {\n    let path = this.map.get(k);\n    if (path) {\n      return path;\n    }\n    path = `/device/keyboard/${k.toLowerCase()}`;\n    this.map.set(k, path);\n    return path;\n  }\n};\n\npaths.device.gamepad = gamepadIndex => ({\n  button: buttonIndex => ({\n    pressed: `/device/gamepad/${gamepadIndex}/button/${buttonIndex}/pressed`,\n    touched: `/device/gamepad/${gamepadIndex}/button/${buttonIndex}/touched`,\n    value: `/device/gamepad/${gamepadIndex}/button/${buttonIndex}/value`\n  }),\n  axis: axisIndex => `/device/gamepad/${gamepadIndex}/axis/${axisIndex}`\n});\n\nconst xbox = \"/device/xbox/\";\npaths.device.xbox = {\n  button: buttonName => ({\n    pressed: `${xbox}button/${buttonName}/pressed`,\n    touched: `${xbox}button/${buttonName}/touched`,\n    value: `${xbox}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${xbox}axis/${axisName}`;\n  }\n};\n\npaths.device.oculusgo = {\n  // TODO remove these in favor of the direct accessors\n  button: buttonName => ({\n    pressed: `/device/oculusgo/button/${buttonName}/pressed`,\n    touched: `/device/oculusgo/button/${buttonName}/touched`,\n    value: `/device/oculusgo/button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `/device/oculusgo/axis/${axisName}`;\n  },\n  //\n  trigger: {\n    pressed: \"/device/oculusgo/button/trigger/pressed\",\n    touched: \"/device/oculusgo/button/trigger/touched\",\n    value: \"/device/oculusgo/button/trigger/value\"\n  },\n  touchpad: {\n    pressed: \"/device/oculusgo/button/touchpad/pressed\",\n    touched: \"/device/oculusgo/button/touchpad/touched\",\n    value: \"/device/oculusgo/button/touchpad/value\",\n    axisX: \"/device/oculusgo/axis/touchpadX\",\n    axisY: \"/device/oculusgo/axis/touchpadY\"\n  },\n  pose: \"/device/oculusgo/pose\",\n  matrix: \"/device/oculusgo/matrix\",\n  v: name => {\n    return `/vars/oculusgo/${name}`;\n  }\n};\n\nconst gearVRController = \"/device/gearVRController/\";\npaths.device.gearVRController = {\n  button: buttonName => ({\n    pressed: `${gearVRController}button/${buttonName}/pressed`,\n    touched: `${gearVRController}button/${buttonName}/touched`,\n    value: `${gearVRController}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${gearVRController}axis/${axisName}`;\n  },\n  pose: `${gearVRController}pose`,\n  matrix: `${gearVRController}matrix`,\n  v: name => {\n    return `/vars/gearVRController/${name}`;\n  }\n};\n\nconst daydream = \"/device/daydream/\";\npaths.device.daydream = {\n  button: buttonName => ({\n    pressed: `${daydream}button/${buttonName}/pressed`,\n    touched: `${daydream}button/${buttonName}/touched`,\n    value: `${daydream}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${daydream}axis/${axisName}`;\n  },\n  pose: `${daydream}pose`,\n  matrix: `${daydream}matrix`\n};\n\nconst rightOculusTouch = \"/device/rightOculusTouch/\";\npaths.device.rightOculusTouch = {\n  button: buttonName => ({\n    pressed: `${rightOculusTouch}button/${buttonName}/pressed`,\n    touched: `${rightOculusTouch}button/${buttonName}/touched`,\n    value: `${rightOculusTouch}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${rightOculusTouch}axis/${axisName}`;\n  },\n  pose: `${rightOculusTouch}pose`,\n  matrix: `${rightOculusTouch}matrix`\n};\n\nconst leftOculusTouch = \"/device/leftOculusTouch/\";\npaths.device.leftOculusTouch = {\n  button: buttonName => ({\n    pressed: `${leftOculusTouch}button/${buttonName}/pressed`,\n    touched: `${leftOculusTouch}button/${buttonName}/touched`,\n    value: `${leftOculusTouch}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${leftOculusTouch}axis/${axisName}`;\n  },\n  pose: `${leftOculusTouch}pose`,\n  matrix: `${leftOculusTouch}matrix`\n};\n\npaths.device.vive = {};\npaths.device.vive.left = {\n  button: buttonName => ({\n    pressed: `/device/vive/left/button/${buttonName}/pressed`,\n    touched: `/device/vive/left/button/${buttonName}/touched`,\n    value: `/device/vive/left/button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `/device/vive/left/axis/${axisName}`;\n  },\n  pose: `/device/vive/left/pose`,\n  matrix: `/device/vive/left/matrix`\n};\npaths.device.vive.right = {\n  button: buttonName => ({\n    pressed: `/device/vive/right/button/${buttonName}/pressed`,\n    touched: `/device/vive/right/button/${buttonName}/touched`,\n    value: `/device/vive/right/button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `/device/vive/right/axis/${axisName}`;\n  },\n  pose: `/device/vive/right/pose`,\n  matrix: `/device/vive/right/matrix`\n};\n\nfunction button(device, side, name) {\n  return {\n    pressed: `${device}${side}/button/${name}/pressed`,\n    touched: `${device}${side}/button/${name}/touched`,\n    value: `${device}${side}/button/${name}/value`\n  };\n}\n\nfunction axes(device, side, name) {\n  return {\n    axisX: `${device}${side}/axis/${name}X`,\n    axisY: `${device}${side}/axis/${name}Y`\n  };\n}\n\nfunction wmrController(side) {\n  const wmr = \"/device/wmr/\";\n  return {\n    touchpad: {\n      ...button(wmr, side, \"touchpad\"),\n      ...axes(wmr, side, \"touchpad\")\n    },\n    trigger: button(wmr, side, \"trigger\"),\n    grip: button(wmr, side, \"grip\"),\n    menu: button(wmr, side, \"menu\"),\n    joystick: axes(wmr, side, \"joystick\"),\n    pose: `${wmr}${side}/pose`,\n    matrix: `${wmr}${side}/matrix`\n  };\n}\npaths.device.wmr = {};\npaths.device.wmr.v = name => `/vars/wmr/${name}`;\npaths.device.wmr.k = name => `/vars/wmr/keyboard/${name}`;\npaths.device.wmr.left = wmrController(\"left\");\npaths.device.wmr.right = wmrController(\"right\");\n","/* global fetch THREE */\nimport URL_TICK from \"../assets/sfx/tick.mp3\";\nimport URL_TELEPORT_LOOP from \"../assets/sfx/teleport-loop.mp3\";\nimport URL_QUICK_TURN from \"../assets/sfx/quickTurn.mp3\";\nimport URL_TAP_MELLOW from \"../assets/sfx/tap_mellow.mp3\";\nimport URL_PEN_SPAWN from \"../assets/sfx/PenSpawn.mp3\";\nimport URL_PEN_DRAW from \"../assets/sfx/PenDraw1.mp3\";\nimport URL_CAMERA_SNAPSHOT from \"../assets/sfx/PicSnapHey.mp3\";\nimport URL_WELCOME from \"../assets/sfx/welcome.mp3\";\nimport URL_QUACK from \"../assets/sfx/quack.mp3\";\nimport URL_SPECIAL_QUACK from \"../assets/sfx/specialquack.mp3\";\nimport URL_POP from \"../assets/sfx/pop.mp3\";\nimport URL_FREEZE from \"../assets/sfx/Eb_blip.mp3\";\nimport URL_TACK from \"../assets/sfx/tack.mp3\";\nimport URL_MEDIA_LOADED from \"../assets/sfx/A_bendUp.mp3\";\nimport URL_MEDIA_LOADING from \"../assets/sfx/suspense.mp3\";\n\nlet soundEnum = 0;\nexport const SOUND_HOVER_OR_GRAB = soundEnum++;\nexport const SOUND_THAW = soundEnum++;\nexport const SOUND_PEN_STOP_DRAW = soundEnum++;\nexport const SOUND_PEN_UNDO_DRAW = soundEnum++;\nexport const SOUND_PEN_CHANGE_COLOR = soundEnum++;\nexport const SOUND_TOGGLE_MIC = soundEnum++;\nexport const SOUND_TELEPORT_START = soundEnum++;\nexport const SOUND_TELEPORT_END = soundEnum++;\nexport const SOUND_SNAP_ROTATE = soundEnum++;\nexport const SOUND_SPAWN_PEN = soundEnum++;\nexport const SOUND_PEN_START_DRAW = soundEnum++;\nexport const SOUND_CAMERA_TOOL_TOOK_SNAPSHOT = soundEnum++;\nexport const SOUND_ENTER_SCENE = soundEnum++;\nexport const SOUND_QUACK = soundEnum++;\nexport const SOUND_SPECIAL_QUACK = soundEnum++;\nexport const SOUND_CHAT_MESSAGE = soundEnum++;\nexport const SOUND_FREEZE = soundEnum++;\nexport const SOUND_PIN = soundEnum++;\nexport const SOUND_MEDIA_LOADING = soundEnum++;\nexport const SOUND_MEDIA_LOADED = soundEnum++;\n\nexport class SoundEffectsSystem {\n  constructor() {\n    this.pendingEffects = [];\n    this.audioContext = THREE.AudioContext.getContext();\n    const soundsAndUrls = [\n      [SOUND_HOVER_OR_GRAB, URL_TICK],\n      [SOUND_THAW, URL_TICK],\n      [SOUND_PEN_STOP_DRAW, URL_TICK],\n      [SOUND_PEN_UNDO_DRAW, URL_TICK],\n      [SOUND_PEN_CHANGE_COLOR, URL_TICK],\n      [SOUND_TOGGLE_MIC, URL_TICK],\n      [SOUND_TELEPORT_START, URL_TELEPORT_LOOP],\n      [SOUND_TELEPORT_END, URL_QUICK_TURN],\n      [SOUND_SNAP_ROTATE, URL_TAP_MELLOW],\n      [SOUND_SPAWN_PEN, URL_PEN_SPAWN],\n      [SOUND_PEN_START_DRAW, URL_PEN_DRAW],\n      [SOUND_CAMERA_TOOL_TOOK_SNAPSHOT, URL_CAMERA_SNAPSHOT],\n      [SOUND_ENTER_SCENE, URL_WELCOME],\n      [SOUND_QUACK, URL_QUACK],\n      [SOUND_SPECIAL_QUACK, URL_SPECIAL_QUACK],\n      [SOUND_CHAT_MESSAGE, URL_POP],\n      [SOUND_FREEZE, URL_FREEZE],\n      [SOUND_PIN, URL_TACK],\n      [SOUND_MEDIA_LOADING, URL_MEDIA_LOADING],\n      [SOUND_MEDIA_LOADED, URL_MEDIA_LOADED]\n    ];\n    const loading = new Map();\n    const load = url => {\n      let audioBufferPromise = loading.get(url);\n      if (!audioBufferPromise) {\n        audioBufferPromise = fetch(url)\n          .then(r => r.arrayBuffer())\n          .then(arrayBuffer => this.audioContext.decodeAudioData(arrayBuffer));\n        loading.set(url, audioBufferPromise);\n      }\n      return audioBufferPromise;\n    };\n    this.sounds = new Map();\n    soundsAndUrls.map(([sound, url]) => {\n      load(url).then(audioBuffer => {\n        this.sounds.set(sound, audioBuffer);\n      });\n    });\n  }\n\n  enqueueSound(sound, loop) {\n    const audioBuffer = this.sounds.get(sound);\n    if (!audioBuffer) return null;\n    // The nodes are very inexpensive to create, according to\n    // https://developer.mozilla.org/en-US/docs/Web/API/AudioBufferSourceNode\n    const source = this.audioContext.createBufferSource();\n    source.buffer = audioBuffer;\n    source.connect(this.audioContext.destination);\n    source.loop = loop;\n    this.pendingEffects.push(source);\n    return source;\n  }\n\n  playSoundOneShot(sound) {\n    return this.enqueueSound(sound, false);\n  }\n\n  playSoundLooped(sound) {\n    return this.enqueueSound(sound, true);\n  }\n\n  playSoundLoopedWithGain(sound) {\n    const audioBuffer = this.sounds.get(sound);\n    if (!audioBuffer) return null;\n\n    const source = this.audioContext.createBufferSource();\n    const gain = this.audioContext.createGain();\n    source.buffer = audioBuffer;\n    source.connect(gain);\n    gain.connect(this.audioContext.destination);\n    source.loop = true;\n    this.pendingEffects.push(source);\n    return { gain, source };\n  }\n\n  stopSoundNode(node) {\n    const index = this.pendingEffects.indexOf(node);\n    if (index !== -1) {\n      this.pendingEffects.splice(index, 1);\n    } else {\n      node.stop();\n    }\n  }\n\n  tick() {\n    for (let i = 0; i < this.pendingEffects.length; i++) {\n      this.pendingEffects[i].start();\n    }\n    this.pendingEffects.length = 0;\n  }\n}\n","// Computes an AABB that surrounds the object in question and all of its children.\n// Note that if the children have rotations, this probably won't return the tightest\n// possible AABB -- we could return a tighter one if we examined all of the vertices\n// of the geometry for ourselves, but we don't care enough for what we're using this\n// for to do so much work.\nconst computeObjectAABB = (function() {\n  const bounds = new THREE.Box3();\n  return function(root, target) {\n    target.makeEmpty();\n    root.traverse(node => {\n      const geometry = node.geometry;\n      if (geometry != null) {\n        if (geometry.boundingBox == null) {\n          geometry.computeBoundingBox();\n        }\n        target.union(bounds.copy(geometry.boundingBox).applyMatrix4(node.matrixWorld));\n      }\n    });\n    return target;\n  };\n})();\n\nconst rotation = new THREE.Euler();\nexport function getBox(entity, boxRoot) {\n  const box = new THREE.Box3();\n\n  rotation.copy(entity.object3D.rotation);\n  entity.object3D.rotation.set(0, 0, 0);\n\n  entity.object3D.updateMatrices(true, true);\n  boxRoot.updateMatrices(true, true);\n  boxRoot.updateMatrixWorld(true);\n\n  computeObjectAABB(boxRoot, box);\n\n  if (!box.isEmpty()) {\n    entity.object3D.worldToLocal(box.min);\n    entity.object3D.worldToLocal(box.max);\n    entity.object3D.rotation.copy(rotation);\n    entity.object3D.matrixNeedsUpdate = true;\n  }\n\n  boxRoot.matrixWorldNeedsUpdate = true;\n  boxRoot.updateMatrices();\n\n  return box;\n}\n\nexport function getScaleCoefficient(length, box) {\n  if (box.isEmpty()) return 1.0;\n\n  const { max, min } = box;\n  const dX = Math.abs(max.x - min.x);\n  const dY = Math.abs(max.y - min.y);\n  const dZ = Math.abs(max.z - min.z);\n  const lengthOfLongestComponent = Math.max(dX, dY, dZ);\n  return length / lengthOfLongestComponent;\n}\n","const THREE = AFRAME.THREE;\n\nfunction checkFloatTextureSupport() {\n  const renderer = new THREE.WebGLRenderer();\n\n  const scene = new THREE.Scene();\n  const size = 2;\n  const data = new Float32Array(size * size * 4);\n  const dataTexture = new THREE.DataTexture(data, size, size, THREE.RGBAFormat, THREE.FloatType);\n  const box = new THREE.Mesh(new THREE.PlaneBufferGeometry(1, 1), new THREE.MeshBasicMaterial({ map: dataTexture }));\n  box.material.map.needsUpdate = true;\n  scene.add(box);\n\n  renderer.render(scene, new THREE.Camera());\n  const result = renderer.context.getError() === 0;\n  renderer.dispose();\n  return result;\n}\n\nexport function patchWebGLRenderingContext() {\n  if (/Android.+Firefox/.test(navigator.userAgent)) {\n    // It appears that Galaxy S6 devices falsely report that they support\n    // OES_texture_float in Firefox. This workaround disables float textures\n    // for those devices.\n    // See https://github.com/mozilla/hubs/issues/32 and\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1338656\n    const originalGetExtension = WebGLRenderingContext.prototype.getExtension;\n    const supportsFloatTextures = checkFloatTextureSupport();\n    WebGLRenderingContext.prototype.getExtension = function patchedGetExtension(name) {\n      if (name === \"OES_texture_float\" && !supportsFloatTextures) {\n        return null;\n      }\n      return originalGetExtension.call(this, name);\n    };\n  }\n}\n","import { detectOS } from \"detect-browser\";\n\nexport function disableiOSZoom() {\n  if (detectOS(navigator.userAgent) !== \"iOS\") return;\n\n  let lastTouchAtMs = 0;\n\n  document.addEventListener(\"touchmove\", ev => {\n    if (ev.scale === 1) return;\n\n    ev.preventDefault();\n  });\n\n  document.addEventListener(\"touchend\", ev => {\n    const now = new Date().getTime();\n    const isDoubleTouch = now - lastTouchAtMs <= 300;\n    lastTouchAtMs = now;\n\n    if (isDoubleTouch) {\n      ev.preventDefault();\n    }\n  });\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nexport default class DialogContainer extends Component {\n  static propTypes = {\n    title: PropTypes.node,\n    children: PropTypes.node.isRequired,\n    onClose: PropTypes.func,\n    closable: PropTypes.bool,\n    wide: PropTypes.bool,\n    className: PropTypes.string\n  };\n\n  static defaultProps = {\n    closable: true\n  };\n\n  constructor(props) {\n    super(props);\n    this.onKeyDown = this.onKeyDown.bind(this);\n    this.onContainerClicked = this.onContainerClicked.bind(this);\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"keydown\", this.onKeyDown);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"keydown\", this.onKeyDown);\n  }\n\n  onKeyDown(e) {\n    if (this.props.closable && e.key === \"Escape\") {\n      this.props.onClose();\n    }\n  }\n\n  onContainerClicked = e => {\n    if (this.props.closable && e.currentTarget === e.target) {\n      this.props.onClose();\n    }\n  };\n\n  render() {\n    return (\n      <div className={classNames(\"dialog-overlay\", this.props.className)}>\n        <div className=\"dialog\" onClick={this.onContainerClicked}>\n          <div className={`dialog__box ${this.props.wide ? \"dialog__wide\" : \"\"} `}>\n            <div className=\"dialog__box__contents\">\n              {this.props.closable &&\n                this.props.onClose && (\n                  <WithHoverSound>\n                    <button className=\"dialog__box__contents__close\" onClick={() => this.props.onClose()}>\n                      <i>\n                        <FontAwesomeIcon icon={faTimes} />\n                      </i>\n                    </button>\n                  </WithHoverSound>\n                )}\n              <div className=\"dialog__box__contents__title\">{this.props.title}</div>\n              <div className=\"dialog__box__contents__body\">{this.props.children}</div>\n              <div className=\"dialog__box__contents__button-container\" />\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","export function addAnimationComponents(modelEl) {\n  if (!modelEl.components[\"animation-mixer\"]) {\n    return;\n  }\n\n  if (!modelEl.querySelector(\"[loop-animation]\")) {\n    modelEl.setAttribute(\"loop-animation\", \"\");\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport \"three/examples/js/controls/OrbitControls\";\nimport classNames from \"classnames\";\n\nimport { createDefaultEnvironmentMap } from \"../components/environment-map\";\nimport { loadGLTF } from \"../components/gltf-model-plus\";\nimport { disposeNode } from \"../utils/three-utils\";\nimport { createImageBitmap, disposeImageBitmap } from \"../utils/image-bitmap-utils\";\nimport styles from \"../assets/stylesheets/avatar-preview.scss\";\n\nconst TEXTURE_PROPS = {\n  base_map: [\"map\"],\n  emissive_map: [\"emissiveMap\"],\n  normal_map: [\"normalMap\"],\n  orm_map: [\"aoMap\", \"roughnessMap\", \"metalnessMap\"]\n};\n\nconst ALL_MAPS = Object.keys(TEXTURE_PROPS);\n\n// This should match our aframe renderer=\"antialias: true; colorManagement: true; sortObjects: true;\n// physicallyCorrectLights: true; webgl2: true; multiview: false;\"\nfunction createRenderer(canvas, alpha = false, useDevicePixelRatio = true) {\n  const context = canvas.getContext(\"webgl2\", {\n    alpha,\n    depth: true,\n    antialias: true,\n    premultipliedAlpha: true,\n    preserveDrawingBuffer: false,\n    powerPreference: \"default\"\n  });\n\n  const renderer = new THREE.WebGLRenderer({ alpha, canvas, context });\n  renderer.gammaOutput = true;\n  renderer.gammaFactor = 2.2;\n  renderer.physicallyCorrectLights = true;\n  if (useDevicePixelRatio) {\n    renderer.setPixelRatio(window.devicePixelRatio);\n  }\n  return renderer;\n}\n\nconst createImageBitmapFromURL = url =>\n  fetch(url)\n    .then(r => r.blob())\n    .then(createImageBitmap);\n\nconst ORBIT_ANGLE = new THREE.Euler(-30 * THREE.Math.DEG2RAD, 30 * THREE.Math.DEG2RAD, 0);\nconst DEFAULT_MARGIN = 1;\n\nfunction fitBoxInFrustum(camera, box, center, margin = DEFAULT_MARGIN) {\n  const halfYExtents = Math.max(box.max.y - center.y, center.y - box.min.y);\n  const halfVertFOV = THREE.Math.degToRad(camera.fov / 2);\n  camera.position.set(0, 0, (halfYExtents / Math.tan(halfVertFOV) + box.max.z) * margin);\n  camera.position.applyEuler(ORBIT_ANGLE);\n  camera.position.add(center);\n  camera.lookAt(center);\n}\n\nexport default class AvatarPreview extends Component {\n  static propTypes = {\n    avatarGltfUrl: PropTypes.string,\n    className: PropTypes.string\n  };\n  constructor(props) {\n    super(props);\n    this.state = { loading: true };\n    this.avatar = null;\n    this.imageBitmaps = {};\n  }\n\n  componentDidMount = () => {\n    this.scene = new THREE.Scene();\n\n    this.camera = new THREE.PerspectiveCamera(55, this.canvas.clientWidth / this.canvas.clientHeight, 0.1, 1000);\n    this.controls = new THREE.OrbitControls(this.camera, this.canvas);\n    this.controls.enablePan = false;\n\n    const light = new THREE.DirectionalLight(0xfdf5c2, 3);\n    light.position.set(0, 10, 10);\n    this.scene.add(light);\n    this.scene.add(new THREE.HemisphereLight(0xb1e3ff, 0xb1e3ff, 3));\n\n    this.camera.position.set(-0.2, 0.5, 0.5);\n    this.camera.matrixAutoUpdate = true;\n\n    this.controls.target.set(0, 0.45, 0);\n    this.controls.update();\n\n    if (this.props.avatarGltfUrl) {\n      this.loadPreviewAvatar(this.props.avatarGltfUrl).then(this.setAvatar);\n    }\n\n    const clock = new THREE.Clock();\n\n    this.snapshotCanvas = document.createElement(\"canvas\");\n    this.snapshotCanvas.width = 720;\n    this.snapshotCanvas.height = 1280;\n    this.snapshotCamera = new THREE.PerspectiveCamera(55, 720 / 1280, 0.1, 1000);\n    this.snapshotCamera.matrixAutoUpdate = true;\n    this.snapshotRenderer = createRenderer(this.snapshotCanvas, true, false);\n    this.snapshotRenderer.setClearAlpha(0);\n\n    this.previewRenderer = createRenderer(this.canvas);\n    this.previewRenderer.setClearColor(0xeaeaea);\n    this.previewRenderer.setAnimationLoop(() => {\n      const dt = clock.getDelta();\n      this.mixer && this.mixer.update(dt);\n      this.previewRenderer.render(this.scene, this.camera);\n      this.snapshotRenderer.render(this.scene, this.snapshotCamera);\n    });\n    window.addEventListener(\"resize\", this.resize);\n    this.resize();\n  };\n\n  resize = () => {\n    const width = this.canvas.parentElement.offsetWidth;\n    const height = this.canvas.parentElement.offsetHeight;\n    this.previewRenderer.setSize(width, height);\n    this.camera.aspect = width / height;\n    this.camera.updateProjectionMatrix();\n  };\n\n  setAvatar = avatar => {\n    if (!avatar) return;\n    this.avatar = avatar;\n    this.scene.add(avatar);\n    this.resetCamera();\n    this.setState({ loading: false });\n  };\n\n  resetCamera = (() => {\n    const box = new THREE.Box3();\n    const center = new THREE.Vector3();\n    return () => {\n      box.setFromObject(this.avatar);\n      box.getCenter(center);\n\n      // Shift the center vertically in order to frame the avatar nicely.\n      center.y = (box.max.y - box.min.y) * 0.6 + box.min.y;\n\n      fitBoxInFrustum(this.camera, box, center);\n      fitBoxInFrustum(this.snapshotCamera, box, center, 0.7);\n\n      this.controls.target.copy(center);\n      this.controls.update();\n    };\n  })();\n\n  componentWillUnmount = () => {\n    this.scene && this.scene.traverse(disposeNode);\n    this.previewRenderer && this.previewRenderer.dispose();\n    Object.values(this.imageBitmaps).forEach(img => disposeImageBitmap(img));\n    window.removeEventListener(\"resize\", this.resize);\n  };\n\n  componentDidUpdate = async oldProps => {\n    if (oldProps.avatarGltfUrl !== this.props.avatarGltfUrl) {\n      if (this.avatar) {\n        this.scene.remove(this.avatar);\n        this.avatar = null;\n      }\n      if (this.props.avatarGltfUrl) {\n        this.setState({ loading: true });\n        await this.loadPreviewAvatar(this.props.avatarGltfUrl).then(this.setAvatar);\n      }\n    }\n    this.applyMaps(oldProps, this.props);\n  };\n\n  applyMaps(oldProps, newProps) {\n    return Promise.all(\n      ALL_MAPS.map(mapName => {\n        const applyMap = this.applyMapToPreview.bind(this, mapName);\n        if (oldProps[mapName] != newProps[mapName]) {\n          if (newProps[mapName] instanceof File) {\n            return createImageBitmap(newProps[mapName]).then(applyMap);\n          } else if (newProps[mapName]) {\n            return createImageBitmapFromURL(newProps[mapName]).then(applyMap);\n          } else {\n            return this.revertMap(mapName);\n          }\n        }\n      })\n    );\n  }\n\n  loadPreviewAvatar = async avatarGltfUrl => {\n    const gltf = await loadGLTF(avatarGltfUrl, \"model/gltf\");\n\n    // On the bckend we look for a material called Bot_PBS, here we are looking for a mesh called Avatar.\n    // When we \"officially\" support uploading custom GLTFs we need to decide what we are going to key things on\n    this.previewMesh =\n      gltf.scene.getObjectByName(\"AvatarMesh\") ||\n      gltf.scene.getObjectByName(\"Avatar\") ||\n      gltf.scene.getObjectByName(\"Bot_Skinned\") ||\n      gltf.scene;\n\n    const idleAnimation = gltf.animations && gltf.animations.find(({ name }) => name === \"idle_eyes\");\n    if (idleAnimation) {\n      this.mixer = new THREE.AnimationMixer(this.previewMesh);\n      const action = this.mixer.clipAction(idleAnimation);\n      action.enabled = true;\n      action.setLoop(THREE.LoopRepeat, Infinity).play();\n      this.idleAnimationAction = action;\n    }\n\n    const { material } = this.previewMesh;\n    if (material) {\n      // We delete onUpdate here to opt out of the auto texture cleanup after GPU upload.\n      const getImage = p => delete material[p].onUpdate && material[p].image;\n      this.originalMaps = {\n        base_map: TEXTURE_PROPS[\"base_map\"].map(getImage),\n        emissive_map: TEXTURE_PROPS[\"emissive_map\"].map(getImage),\n        normal_map: TEXTURE_PROPS[\"normal_map\"].map(getImage),\n        orm_map: TEXTURE_PROPS[\"orm_map\"].map(getImage)\n      };\n\n      await Promise.all([\n        this.applyMaps({}, this.props), // Apply initial maps\n        createDefaultEnvironmentMap().then(t => {\n          this.previewMesh.material.envMap = t;\n          this.previewMesh.material.needsUpdate = true;\n        })\n      ]);\n    } else {\n      this.originalMaps = {};\n    }\n\n    return gltf.scene;\n  };\n\n  applyMapToPreview = (name, image) => {\n    if (this.imageBitmaps[name]) {\n      disposeImageBitmap(this.imageBitmaps[name]);\n    }\n    this.imageBitmaps[name] = image;\n    TEXTURE_PROPS[name].forEach(prop => {\n      const texture = this.previewMesh.material[prop];\n      texture.image = image;\n      texture.needsUpdate = true;\n    });\n  };\n\n  revertMap = name => {\n    if (this.imageBitmaps[name]) {\n      disposeImageBitmap(this.imageBitmaps[name]);\n    }\n    delete this.imageBitmaps[name];\n    this.originalMaps[name].forEach((bm, i) => {\n      const texture = this.previewMesh.material[TEXTURE_PROPS[name][i]];\n      texture.image = bm;\n      texture.needsUpdate = true;\n    });\n  };\n\n  snapshot = () => {\n    return new Promise(resolve => {\n      if (this.idleAnimationAction) this.idleAnimationAction.stop();\n      this.snapshotRenderer.render(this.scene, this.snapshotCamera);\n      this.snapshotCanvas.toBlob(blob => {\n        if (this.idleAnimationAction) this.idleAnimationAction.play();\n        resolve(blob);\n      });\n    });\n  };\n\n  render() {\n    return (\n      <div className={classNames(styles.preview, this.props.className)}>\n        {this.state.loading && (\n          <div className=\"loader\">\n            <div className=\"loader-center\" />\n          </div>\n        )}\n        <canvas ref={c => (this.canvas = c)} />\n      </div>\n    );\n  }\n}\n","// A-Frame blows away any npm debug log filters so this allow the user to set the log filter\n// via the query string.\nimport debug from \"debug\";\nimport qsTruthy from \"./qs_truthy\";\n\nconst qs = new URLSearchParams(location.search);\nconst isDebug = qsTruthy(\"debug\");\nconst logFilter = qs.get(\"log_filter\") || (isDebug && \"naf-janus-adapter:*\");\n\nif (logFilter) {\n  debug.enable(logFilter);\n}\n","/* eslint-disable */\n\n// Modified version of A-Frame's animation component to set matrixNeedsUpdate = true in the\n// scenario where the transform changes on an object during an animation.\n//\n// Changes are identified w comment // hubs\n//\n// Bugfix added 3/1/19 - If an animation component is removed before its delay setting, then\n// it erroneously restarts.\n\nvar anime = require(\"animejs\");\nvar components = AFRAME.components; // hubs\nvar registerComponent = AFRAME.registerComponent; // hubs\n//var THREE = require('../lib/three'); // hubs\nvar utils = AFRAME.utils; // hubs\n\ndelete AFRAME.components.animation; // hubs\n\nvar colorHelperFrom = new THREE.Color();\nvar colorHelperTo = new THREE.Color();\n\nvar getComponentProperty = utils.entity.getComponentProperty;\nvar setComponentProperty = utils.entity.setComponentProperty;\nvar splitCache = {};\n\nvar TYPE_COLOR = \"color\";\nvar PROP_POSITION = \"position\";\nvar PROP_ROTATION = \"rotation\";\nvar PROP_SCALE = \"scale\";\nvar STRING_COMPONENTS = \"components\";\nvar STRING_OBJECT3D = \"object3D\";\n\n/**\n * Animation component for A-Frame using anime.js.\n *\n * The component manually controls the tick by setting `autoplay: false` on anime.js and\n * manually * calling `animation.tick()` in the tick handler. To pause or resume, we toggle a\n * boolean * flag * `isAnimationPlaying`.\n *\n * anime.js animation config for tweenining Javascript objects and values works as:\n *\n *  config = {\n *    targets: {foo: 0.0, bar: '#000'},\n *    foo: 1.0,\n *    bar: '#FFF'\n *  }\n *\n * The above will tween each property in `targets`. The `to` values are set in the root of\n * the config.\n *\n * @member {object} animation - anime.js instance.\n * @member {boolean} animationIsPlaying - Control if animation is playing.\n */\nmodule.exports.Component = registerComponent(\"animation\", {\n  schema: {\n    autoplay: { default: true },\n    delay: { default: 0 },\n    dir: { default: \"\" },\n    dur: { default: 1000 },\n    easing: { default: \"easeInQuad\" },\n    elasticity: { default: 400 },\n    enabled: { default: true },\n    from: { default: \"\" },\n    loop: {\n      default: 0,\n      parse: function(value) {\n        // Boolean or integer.\n        if (value === true || value === \"true\") {\n          return true;\n        }\n        if (value === false || value === \"false\") {\n          return false;\n        }\n        return parseInt(value, 10);\n      }\n    },\n    property: { default: \"\" },\n    startEvents: { type: \"array\" },\n    pauseEvents: { type: \"array\" },\n    resumeEvents: { type: \"array\" },\n    round: { default: false },\n    to: { default: \"\" },\n    type: { default: \"\" },\n    isRawProperty: { default: false }\n  },\n\n  multiple: true,\n\n  init: function() {\n    var self = this;\n\n    this.eventDetail = { name: this.attrName };\n    this.time = 0;\n\n    this.animation = null;\n    this.animationIsPlaying = false;\n    this.onStartEvent = this.onStartEvent.bind(this);\n    this.beginAnimation = this.beginAnimation.bind(this);\n    this.pauseAnimation = this.pauseAnimation.bind(this);\n    this.resumeAnimation = this.resumeAnimation.bind(this);\n\n    this.fromColor = {};\n    this.toColor = {};\n    this.targets = {};\n    this.targetsArray = [];\n\n    this.updateConfigForDefault = this.updateConfigForDefault.bind(this);\n    this.updateConfigForRawColor = this.updateConfigForRawColor.bind(this);\n\n    this.config = {\n      complete: function() {\n        self.animationIsPlaying = false;\n        self.el.emit(\"animationcomplete\", self.eventDetail, false);\n        if (self.id) {\n          self.el.emit(\"animationcomplete__\" + self.id, self.eventDetail, false);\n        }\n      }\n    };\n  },\n\n  update: function(oldData) {\n    var config = this.config;\n    var data = this.data;\n\n    this.animationIsPlaying = false;\n\n    if (!this.data.enabled) {\n      return;\n    }\n\n    if (!data.property) {\n      return;\n    }\n\n    // Base config.\n    config.autoplay = false;\n    config.direction = data.dir;\n    config.duration = data.dur;\n    config.easing = data.easing;\n    config.elasticity = data.elasticity;\n    config.loop = data.loop;\n    config.round = data.round;\n\n    // Start new animation.\n    this.createAndStartAnimation();\n  },\n\n  tick: function(t, dt) {\n    if (!this.animationIsPlaying) {\n      return;\n    }\n    this.time += dt;\n    this.animation.tick(this.time);\n  },\n\n  remove: function() {\n    this.pauseAnimation();\n    this.removeEventListeners();\n    this.cancelDelayedStart(); // hubs\n  },\n\n  pause: function() {\n    this.paused = true;\n    this.pausedWasPlaying = this.animationIsPlaying;\n    this.pauseAnimation();\n    this.removeEventListeners();\n    this.cancelDelayedStart(); // hubs\n  },\n\n  /**\n   * `play` handler only for resuming scene.\n   */\n  play: function() {\n    if (!this.paused) {\n      return;\n    }\n    this.paused = false;\n    this.addEventListeners();\n    if (this.pausedWasPlaying) {\n      this.resumeAnimation();\n      this.pausedWasPlaying = false;\n    }\n  },\n\n  /**\n   * Start animation from scratch.\n   */\n  createAndStartAnimation: function() {\n    var data = this.data;\n\n    this.updateConfig();\n    this.animationIsPlaying = false;\n    this.animation = anime(this.config);\n\n    this.removeEventListeners();\n    this.cancelDelayedStart(); // hubs\n    this.addEventListeners();\n\n    // Wait for start events for animation.\n    if (!data.autoplay || (data.startEvents && data.startEvents.length)) {\n      return;\n    }\n\n    // Delay animation.\n    if (data.delay) {\n      // hubs\n      this.delayTimeout = setTimeout(this.beginAnimation, data.delay);\n      return;\n    }\n\n    // Play animation.\n    this.beginAnimation();\n  },\n\n  /**\n   * This is before animation start (including from startEvents).\n   * Set to initial state (config.from, time = 0, seekTime = 0).\n   */\n  beginAnimation: function() {\n    this.updateConfig();\n    this.time = 0;\n    this.animationIsPlaying = true;\n    this.stopRelatedAnimations();\n    this.el.emit(\"animationbegin\", this.eventDetail, false);\n  },\n\n  pauseAnimation: function() {\n    this.animationIsPlaying = false;\n  },\n\n  resumeAnimation: function() {\n    this.animationIsPlaying = true;\n  },\n\n  /**\n   * startEvents callback.\n   */\n  onStartEvent: function() {\n    if (!this.data.enabled) {\n      return;\n    }\n\n    this.updateConfig();\n    if (this.animation) {\n      this.animation.pause();\n    }\n    this.animation = anime(this.config);\n\n    // Include the delay before each start event.\n    if (this.data.delay) {\n      setTimeout(this.beginAnimation, this.data.delay);\n      return;\n    }\n    this.beginAnimation();\n  },\n\n  /**\n   * rawProperty: true and type: color;\n   */\n  updateConfigForRawColor: function() {\n    var config = this.config;\n    var data = this.data;\n    var el = this.el;\n    var from;\n    var key;\n    var to;\n\n    if (this.waitComponentInitRawProperty(this.updateConfigForRawColor)) {\n      return;\n    }\n\n    from = data.from === \"\" ? getRawProperty(el, data.property) : data.from;\n    to = data.to;\n\n    // Use r/g/b vector for color type.\n    this.setColorConfig(from, to);\n    from = this.fromColor;\n    to = this.toColor;\n\n    this.targetsArray.length = 0;\n    this.targetsArray.push(from);\n    config.targets = this.targetsArray;\n    for (key in to) {\n      config[key] = to[key];\n    }\n\n    config.update = (function() {\n      var lastValue = {};\n      return function(anim) {\n        var value;\n        value = anim.animatables[0].target;\n        // For animation timeline.\n        if (value.r === lastValue.r && value.g === lastValue.g && value.b === lastValue.b) {\n          return;\n        }\n\n        setRawProperty(el, data.property, value, data.type);\n      };\n    })();\n  },\n\n  /**\n   * Stuff property into generic `property` key.\n   */\n  updateConfigForDefault: function() {\n    var config = this.config;\n    var data = this.data;\n    var el = this.el;\n    var from;\n    var isBoolean;\n    var isNumber;\n    var to;\n\n    if (this.waitComponentInitRawProperty(this.updateConfigForDefault)) {\n      return;\n    }\n\n    if (data.from === \"\") {\n      // Infer from.\n      from = isRawProperty(data) ? getRawProperty(el, data.property) : getComponentProperty(el, data.property);\n    } else {\n      // Explicit from.\n      from = data.from;\n    }\n\n    to = data.to;\n\n    isNumber = !isNaN(from || to);\n    if (isNumber) {\n      from = parseFloat(from);\n      to = parseFloat(to);\n    } else {\n      from = from ? from.toString() : from;\n      to = to ? to.toString() : to;\n    }\n\n    // Convert booleans to integer to allow boolean flipping.\n    isBoolean = data.to === \"true\" || data.to === \"false\" || data.to === true || data.to === false;\n    if (isBoolean) {\n      from = data.from === \"true\" || data.from === true ? 1 : 0;\n      to = data.to === \"true\" || data.to === true ? 1 : 0;\n    }\n\n    this.targets.aframeProperty = from;\n    config.targets = this.targets;\n    config.aframeProperty = to;\n    config.update = (function() {\n      var lastValue;\n\n      return function(anim) {\n        var value;\n        value = anim.animatables[0].target.aframeProperty;\n\n        // Need to do a last value check for animation timeline since all the tweening\n        // begins simultaenously even if the value has not changed. Also better for perf\n        // anyways.\n        if (value === lastValue) {\n          return;\n        }\n        lastValue = value;\n\n        if (isBoolean) {\n          value = value >= 1;\n        }\n\n        if (isRawProperty(data)) {\n          setRawProperty(el, data.property, value, data.type);\n        } else {\n          setComponentProperty(el, data.property, value);\n        }\n      };\n    })();\n  },\n\n  /**\n   * Extend x/y/z/w onto the config.\n   * Update vector by modifying object3D.\n   */\n  updateConfigForVector: function() {\n    var config = this.config;\n    var data = this.data;\n    var el = this.el;\n    var key;\n    var from;\n    var to;\n\n    // Parse coordinates.\n    from =\n      data.from !== \"\"\n        ? utils.coordinates.parse(data.from) // If data.from defined, use that.\n        : getComponentProperty(el, data.property); // If data.from not defined, get on the fly.\n    to = utils.coordinates.parse(data.to);\n\n    if (data.property === PROP_ROTATION) {\n      toRadians(from);\n      toRadians(to);\n    }\n\n    // Set to and from.\n    this.targetsArray.length = 0;\n    this.targetsArray.push(from);\n    config.targets = this.targetsArray;\n    for (key in to) {\n      config[key] = to[key];\n    }\n\n    // If animating object3D transformation, run more optimized updater.\n    if (data.property === PROP_POSITION || data.property === PROP_ROTATION || data.property === PROP_SCALE) {\n      config.update = (function() {\n        var lastValue = {};\n        return function(anim) {\n          var value = anim.animatables[0].target;\n\n          if (data.property === PROP_SCALE) {\n            value.x = Math.max(0.0001, value.x);\n            value.y = Math.max(0.0001, value.y);\n            value.z = Math.max(0.0001, value.z);\n          }\n\n          // For animation timeline.\n          if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\n            return;\n          }\n\n          lastValue.x = value.x;\n          lastValue.y = value.y;\n          lastValue.z = value.z;\n\n          el.object3D[data.property].set(value.x, value.y, value.z);\n          el.object3D.matrixNeedsUpdate = true; // hubs\n        };\n      })();\n      return;\n    }\n\n    // Animating some vector.\n    config.update = (function() {\n      var lastValue = {};\n      return function(anim) {\n        var value = anim.animations[0].target;\n\n        // Animate rotation through radians.\n        // For animation timeline.\n        if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\n          return;\n        }\n        lastValue.x = value.x;\n        lastValue.y = value.y;\n        lastValue.z = value.z;\n        setComponentProperty(el, data.property, value);\n      };\n    })();\n  },\n\n  /**\n   * Update the config before each run.\n   */\n  updateConfig: function() {\n    var propType;\n\n    // Route config type.\n    propType = getPropertyType(this.el, this.data.property);\n    if (isRawProperty(this.data) && this.data.type === TYPE_COLOR) {\n      this.updateConfigForRawColor();\n    } else if (propType === \"vec2\" || propType === \"vec3\" || propType === \"vec4\") {\n      this.updateConfigForVector();\n    } else {\n      this.updateConfigForDefault();\n    }\n  },\n\n  /**\n   * Wait for component to initialize.\n   */\n  waitComponentInitRawProperty: function(cb) {\n    var componentName;\n    var data = this.data;\n    var el = this.el;\n    var self = this;\n\n    if (data.from !== \"\") {\n      return false;\n    }\n\n    if (!data.property.startsWith(STRING_COMPONENTS)) {\n      return false;\n    }\n\n    componentName = splitDot(data.property)[1];\n    if (el.components[componentName]) {\n      return false;\n    }\n\n    el.addEventListener(\"componentinitialized\", function wait(evt) {\n      if (evt.detail.name !== componentName) {\n        return;\n      }\n      cb();\n      // Since the config was created async, create the animation now since we missed it\n      // earlier.\n      self.animation = anime(self.config);\n      el.removeEventListener(\"componentinitialized\", wait);\n    });\n    return true;\n  },\n\n  /**\n   * Make sure two animations on the same property don't fight each other.\n   * e.g., animation__mouseenter=\"property: material.opacity\"\n   *       animation__mouseleave=\"property: material.opacity\"\n   */\n  stopRelatedAnimations: function() {\n    var component;\n    var componentName;\n    for (componentName in this.el.components) {\n      component = this.el.components[componentName];\n      if (componentName === this.attrName) {\n        continue;\n      }\n      if (component.name !== \"animation\") {\n        continue;\n      }\n      if (!component.animationIsPlaying) {\n        continue;\n      }\n      if (component.data.property !== this.data.property) {\n        continue;\n      }\n      component.animationIsPlaying = false;\n    }\n  },\n\n  addEventListeners: function() {\n    var data = this.data;\n    var el = this.el;\n    addEventListeners(el, data.startEvents, this.onStartEvent);\n    addEventListeners(el, data.pauseEvents, this.pauseAnimation);\n    addEventListeners(el, data.resumeEvents, this.resumeAnimation);\n  },\n\n  removeEventListeners: function() {\n    var data = this.data;\n    var el = this.el;\n    removeEventListeners(el, data.startEvents, this.onStartEvent);\n    removeEventListeners(el, data.pauseEvents, this.pauseAnimation);\n    removeEventListeners(el, data.resumeEvents, this.resumeAnimation);\n  },\n\n  // hubs\n  cancelDelayedStart: function() {\n    if (this.delayTimeout) {\n      clearTimeout(this.delayTimeout);\n      this.delayTimeout = null;\n    }\n  },\n\n  setColorConfig: function(from, to) {\n    colorHelperFrom.set(from);\n    colorHelperTo.set(to);\n    from = this.fromColor;\n    to = this.toColor;\n    from.r = colorHelperFrom.r;\n    from.g = colorHelperFrom.g;\n    from.b = colorHelperFrom.b;\n    to.r = colorHelperTo.r;\n    to.g = colorHelperTo.g;\n    to.b = colorHelperTo.b;\n  }\n});\n\n/**\n * Given property name, check schema to see what type we are animating.\n * We just care whether the property is a vector.\n */\nfunction getPropertyType(el, property) {\n  var component;\n  var componentName;\n  var split;\n  var propertyName;\n\n  split = property.split(\".\");\n  componentName = split[0];\n  propertyName = split[1];\n  component = el.components[componentName] || components[componentName];\n\n  // Primitives.\n  if (!component) {\n    return null;\n  }\n\n  // Dynamic schema. We only care about vectors anyways.\n  if (propertyName && !component.schema[propertyName]) {\n    return null;\n  }\n\n  // Multi-prop.\n  if (propertyName) {\n    return component.schema[propertyName].type;\n  }\n\n  // Single-prop.\n  return component.schema.type;\n}\n\n/**\n * Convert object to radians.\n */\nfunction toRadians(obj) {\n  obj.x = THREE.Math.degToRad(obj.x);\n  obj.y = THREE.Math.degToRad(obj.y);\n  obj.z = THREE.Math.degToRad(obj.z);\n}\n\nfunction addEventListeners(el, eventNames, handler) {\n  var i;\n  for (i = 0; i < eventNames.length; i++) {\n    el.addEventListener(eventNames[i], handler);\n  }\n}\n\nfunction removeEventListeners(el, eventNames, handler) {\n  var i;\n  for (i = 0; i < eventNames.length; i++) {\n    el.removeEventListener(eventNames[i], handler);\n  }\n}\n\nfunction getRawProperty(el, path) {\n  var i;\n  var split;\n  var value;\n  split = splitDot(path);\n  value = el;\n  for (i = 0; i < split.length; i++) {\n    value = value[split[i]];\n  }\n  return value;\n}\n\nfunction setRawProperty(el, path, value, type) {\n  var i;\n  var split;\n  var propertyName;\n  var targetValue;\n\n  if (path.startsWith(\"object3D.rotation\")) {\n    value = THREE.Math.degToRad(value);\n  }\n\n  // Walk.\n  split = splitDot(path);\n  targetValue = el;\n  for (i = 0; i < split.length - 1; i++) {\n    targetValue = targetValue[split[i]];\n  }\n  propertyName = split[split.length - 1];\n\n  // Raw color.\n  if (type === TYPE_COLOR) {\n    if (\"r\" in targetValue[propertyName]) {\n      targetValue[propertyName].r = value.r;\n      targetValue[propertyName].g = value.g;\n      targetValue[propertyName].b = value.b;\n    } else {\n      targetValue[propertyName].x = value.r;\n      targetValue[propertyName].y = value.g;\n      targetValue[propertyName].z = value.b;\n    }\n    return;\n  }\n\n  targetValue[propertyName] = value;\n}\n\nfunction splitDot(path) {\n  if (path in splitCache) {\n    return splitCache[path];\n  }\n  splitCache[path] = path.split(\".\");\n  return splitCache[path];\n}\n\nfunction isRawProperty(data) {\n  return data.isRawProperty || data.property.startsWith(STRING_COMPONENTS) || data.property.startsWith(STRING_OBJECT3D);\n}\n","/**\n * Instantiates and updates a THREE.AnimationMixer on an entity.\n * @component animation-mixer\n */\nAFRAME.registerComponent(\"animation-mixer\", {\n  initMixer(animations) {\n    this.mixer = new THREE.AnimationMixer(this.el.object3D);\n    this.el.object3D.animations = animations;\n    this.animations = animations;\n  },\n\n  tick: function(t, dt) {\n    if (this.mixer) {\n      this.mixer.update(dt / 1000);\n    }\n  }\n});\n","/**\n * Emits audioFrequencyChange events based on a networked audio source\n * @namespace avatar\n * @component networked-audio-analyser\n */\nAFRAME.registerComponent(\"networked-audio-analyser\", {\n  async init() {\n    this.volume = 0;\n    this.prevVolume = 0;\n    this.smoothing = 0.3;\n    this.threshold = 0.01;\n    this.el.addEventListener(\"sound-source-set\", event => {\n      const ctx = THREE.AudioContext.getContext();\n      this.analyser = ctx.createAnalyser();\n      this.analyser.fftSize = 32;\n      this.levels = new Uint8Array(this.analyser.frequencyBinCount);\n      event.detail.soundSource.connect(this.analyser);\n    });\n  },\n\n  tick: function() {\n    if (!this.analyser) return;\n\n    // take care with compatibility, e.g. safari doesn't support getFloatTimeDomainData\n    this.analyser.getByteTimeDomainData(this.levels);\n\n    let sum = 0;\n    for (let i = 0; i < this.levels.length; i++) {\n      const amplitude = (this.levels[i] - 128) / 128;\n      sum += amplitude * amplitude;\n    }\n    let currVolume = Math.sqrt(sum / this.levels.length);\n    if (currVolume < this.threshold) {\n      currVolume = 0;\n    }\n    this.volume = this.smoothing * currVolume + (1 - this.smoothing) * this.prevVolume;\n    this.prevVolume = this.volume;\n  }\n});\n\n/**\n * Sets an entity's scale base on audioFrequencyChange events.\n * @namespace avatar\n * @component scale-audio-feedback\n */\nAFRAME.registerComponent(\"scale-audio-feedback\", {\n  schema: {\n    minScale: { default: 1 },\n    maxScale: { default: 2 }\n  },\n\n  init() {\n    this._playerCamera = document.getElementById(\"player-camera\").object3D;\n    this._playerCameraWorldPosition = new THREE.Vector3();\n    this._worldPosition = new THREE.Vector3();\n  },\n\n  tick() {\n    // TODO: come up with a cleaner way to handle this.\n    // bone's are \"hidden\" by scaling them with bone-visibility, without this we would overwrite that.\n    if (!this.el.object3D.visible) return;\n\n    const { minScale, maxScale } = this.data;\n\n    const audioAnalyser = this.el.components[\"networked-audio-analyser\"];\n\n    if (!audioAnalyser) return;\n\n    const { object3D } = this.el;\n\n    this._playerCameraWorldPosition.setFromMatrixPosition(this._playerCamera.matrixWorld);\n    this._worldPosition.setFromMatrixPosition(object3D.matrixWorld);\n    const distance = this._worldPosition.distanceTo(this._playerCameraWorldPosition) / 10;\n\n    const scale = Math.min(maxScale, minScale + (maxScale - minScale) * audioAnalyser.volume * 8 * distance);\n\n    object3D.scale.setScalar(scale);\n    object3D.matrixNeedsUpdate = true;\n  }\n});\n","import { findAncestorWithComponent } from \"../utils/scene-graph\";\n\n/**\n * Loops the given clip using this entity's animation mixer\n * @component loop-animation\n */\nAFRAME.registerComponent(\"loop-animation\", {\n  schema: {\n    paused: { type: \"boolean\", default: false },\n    clip: { type: \"string\" }\n  },\n\n  init() {\n    this.mixerEl = findAncestorWithComponent(this.el, \"animation-mixer\");\n\n    if (!this.mixerEl) {\n      console.warn(\"loop-animation component could not find an animation-mixer in its ancestors.\");\n      return;\n    }\n\n    this.updateClip();\n  },\n\n  update(oldData) {\n    if ((oldData.clip !== this.data.clip || oldData.paused !== this.data.paused) && this.mixerEl) {\n      if (oldData.clip !== this.data.clip) {\n        this.updateClip();\n      }\n\n      if (this.currentAction) {\n        this.currentAction.paused = this.data.paused;\n      }\n    }\n  },\n\n  updateClip() {\n    const { mixer, animations } = this.mixerEl.components[\"animation-mixer\"];\n    const clipName = this.data.clip;\n\n    if (animations.length === 0) {\n      return;\n    }\n\n    let clip;\n\n    if (!clipName) {\n      clip = animations[0];\n    } else {\n      clip = animations.find(({ name }) => name === clipName);\n    }\n\n    if (!clip) {\n      return;\n    }\n\n    const action = mixer.clipAction(clip, this.el.object3D);\n    action.enabled = true;\n    action.setLoop(THREE.LoopRepeat, Infinity).play();\n    this.currentAction = action;\n  },\n\n  destroy() {\n    if (this.currentAction) {\n      this.currentAction.enabled = false;\n      this.currentAction.stop();\n    }\n  }\n});\n","import \"three/examples/js/pmrem/PMREMGenerator\";\nimport \"three/examples/js/pmrem/PMREMCubeUVPacker\";\nimport qsTruthy from \"../utils/qs_truthy\";\nconst isBotMode = qsTruthy(\"bot\");\n\n/**\n * @author zz85 / https://github.com/zz85\n *\n * Based on \"A Practical Analytic Model for Daylight\"\n * aka The Preetham Model, the de facto standard analytic skydome model\n * http://www.cs.utah.edu/~shirley/papers/sunsky/sunsky.pdf\n *\n * First implemented by Simon Wallner\n * http://www.simonwallner.at/projects/atmospheric-scattering\n *\n * Improved by Martin Upitis\n * http://blenderartists.org/forum/showthread.php?245954-preethams-sky-impementation-HDR\n *\n * Three.js integration by zz85 http://twitter.com/blurspline\n */\n\nTHREE.Sky = function() {\n  const shader = THREE.Sky.SkyShader;\n\n  const material = new THREE.ShaderMaterial({\n    fragmentShader: shader.fragmentShader,\n    vertexShader: shader.vertexShader,\n    uniforms: THREE.UniformsUtils.clone(shader.uniforms),\n    side: THREE.BackSide\n  });\n\n  THREE.Mesh.call(this, new THREE.BoxBufferGeometry(1, 1, 1), material);\n};\n\nTHREE.Sky.prototype = Object.create(THREE.Mesh.prototype);\nTHREE.Sky.prototype.constructor = THREE.Sky;\n\nTHREE.Sky.SkyShader = {\n  uniforms: {\n    luminance: { value: 1 },\n    turbidity: { value: 2 },\n    rayleigh: { value: 1 },\n    mieCoefficient: { value: 0.005 },\n    mieDirectionalG: { value: 0.8 },\n    sunPosition: { value: new THREE.Vector3() }\n  },\n\n  vertexShader: [\n    \"uniform vec3 sunPosition;\",\n    \"uniform float rayleigh;\",\n    \"uniform float turbidity;\",\n    \"uniform float mieCoefficient;\",\n\n    \"varying vec3 vWorldPosition;\",\n    \"varying vec3 vSunDirection;\",\n    \"varying float vSunfade;\",\n    \"varying vec3 vBetaR;\",\n    \"varying vec3 vBetaM;\",\n    \"varying float vSunE;\",\n\n    \"const vec3 up = vec3( 0.0, 1.0, 0.0 );\",\n\n    // constants for atmospheric scattering\n    \"const float e = 2.71828182845904523536028747135266249775724709369995957;\",\n    \"const float pi = 3.141592653589793238462643383279502884197169;\",\n\n    // wavelength of used primaries, according to preetham\n    \"const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );\",\n    // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:\n    // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))\n    \"const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );\",\n\n    // mie stuff\n    // K coefficient for the primaries\n    \"const float v = 4.0;\",\n    \"const vec3 K = vec3( 0.686, 0.678, 0.666 );\",\n    // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K\n    \"const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );\",\n\n    // earth shadow hack\n    // cutoffAngle = pi / 1.95;\n    \"const float cutoffAngle = 1.6110731556870734;\",\n    \"const float steepness = 1.5;\",\n    \"const float EE = 1000.0;\",\n\n    \"float sunIntensity( float zenithAngleCos ) {\",\n    \"\tzenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );\",\n    \"\treturn EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );\",\n    \"}\",\n\n    \"vec3 totalMie( float T ) {\",\n    \"\tfloat c = ( 0.2 * T ) * 10E-18;\",\n    \"\treturn 0.434 * c * MieConst;\",\n    \"}\",\n\n    \"void main() {\",\n\n    \"\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\",\n    \"\tvWorldPosition = worldPosition.xyz;\",\n\n    \"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n    \"\tvSunDirection = normalize( sunPosition );\",\n\n    \"\tvSunE = sunIntensity( dot( vSunDirection, up ) );\",\n\n    \"\tvSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );\",\n\n    \"\tfloat rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );\",\n\n    // extinction (absorbtion + out scattering)\n    // rayleigh coefficients\n    \"\tvBetaR = totalRayleigh * rayleighCoefficient;\",\n\n    // mie coefficients\n    \"\tvBetaM = totalMie( turbidity ) * mieCoefficient;\",\n\n    \"}\"\n  ].join(\"\\n\"),\n\n  fragmentShader: [\n    \"varying vec3 vWorldPosition;\",\n    \"varying vec3 vSunDirection;\",\n    \"varying float vSunfade;\",\n    \"varying vec3 vBetaR;\",\n    \"varying vec3 vBetaM;\",\n    \"varying float vSunE;\",\n\n    \"uniform float luminance;\",\n    \"uniform float mieDirectionalG;\",\n\n    \"const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );\",\n\n    // constants for atmospheric scattering\n    \"const float pi = 3.141592653589793238462643383279502884197169;\",\n\n    \"const float n = 1.0003;\", // refractive index of air\n    \"const float N = 2.545E25;\", // number of molecules per unit volume for air at\n    // 288.15K and 1013mb (sea level -45 celsius)\n\n    // optical length at zenith for molecules\n    \"const float rayleighZenithLength = 8.4E3;\",\n    \"const float mieZenithLength = 1.25E3;\",\n    \"const vec3 up = vec3( 0.0, 1.0, 0.0 );\",\n    // 66 arc seconds -> degrees, and the cosine of that\n    \"const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;\",\n\n    // 3.0 / ( 16.0 * pi )\n    \"const float THREE_OVER_SIXTEENPI = 0.05968310365946075;\",\n    // 1.0 / ( 4.0 * pi )\n    \"const float ONE_OVER_FOURPI = 0.07957747154594767;\",\n\n    \"float rayleighPhase( float cosTheta ) {\",\n    \"\treturn THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );\",\n    \"}\",\n\n    \"float hgPhase( float cosTheta, float g ) {\",\n    \"\tfloat g2 = pow( g, 2.0 );\",\n    \"\tfloat inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );\",\n    \"\treturn ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );\",\n    \"}\",\n\n    // Filmic ToneMapping http://filmicgames.com/archives/75\n    \"const float A = 0.15;\",\n    \"const float B = 0.50;\",\n    \"const float C = 0.10;\",\n    \"const float D = 0.20;\",\n    \"const float E = 0.02;\",\n    \"const float F = 0.30;\",\n\n    \"const float whiteScale = 1.0748724675633854;\", // 1.0 / Uncharted2Tonemap(1000.0)\n\n    \"vec3 Uncharted2Tonemap( vec3 x ) {\",\n    \"\treturn ( ( x * ( A * x + C * B ) + D * E ) / ( x * ( A * x + B ) + D * F ) ) - E / F;\",\n    \"}\",\n\n    \"void main() {\",\n    // optical length\n    // cutoff angle at 90 to avoid singularity in next formula.\n    \"\tfloat zenithAngle = acos( max( 0.0, dot( up, normalize( vWorldPosition - cameraPos ) ) ) );\",\n    \"\tfloat inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );\",\n    \"\tfloat sR = rayleighZenithLength * inverse;\",\n    \"\tfloat sM = mieZenithLength * inverse;\",\n\n    // combined extinction factor\n    \"\tvec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );\",\n\n    // in scattering\n    \"\tfloat cosTheta = dot( normalize( vWorldPosition - cameraPos ), vSunDirection );\",\n\n    \"\tfloat rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );\",\n    \"\tvec3 betaRTheta = vBetaR * rPhase;\",\n\n    \"\tfloat mPhase = hgPhase( cosTheta, mieDirectionalG );\",\n    \"\tvec3 betaMTheta = vBetaM * mPhase;\",\n\n    \"\tvec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );\",\n    \"\tLin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );\",\n\n    // nightsky\n    \"\tvec3 direction = normalize( vWorldPosition - cameraPos );\",\n    \"\tfloat theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]\",\n    \"\tfloat phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]\",\n    \"\tvec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );\",\n    \"\tvec3 L0 = vec3( 0.1 ) * Fex;\",\n\n    // composition + solar disc\n    \"\tfloat sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );\",\n    \"\tL0 += ( vSunE * 19000.0 * Fex ) * sundisk;\",\n\n    \"\tvec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );\",\n\n    \"\tvec3 curr = Uncharted2Tonemap( ( log2( 2.0 / pow( luminance, 4.0 ) ) ) * texColor );\",\n    \"\tvec3 color = curr * whiteScale;\",\n\n    \"\tvec3 retColor = pow( color, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );\",\n\n    \"\tgl_FragColor = vec4( retColor, 1.0 );\",\n\n    \"}\"\n  ].join(\"\\n\")\n};\n\nAFRAME.registerComponent(\"skybox\", {\n  schema: {\n    turbidity: { type: \"number\", default: 10 },\n    rayleigh: { type: \"number\", default: 2 },\n    luminance: { type: \"number\", default: 1 },\n    mieCoefficient: { type: \"number\", default: 0.005 },\n    mieDirectionalG: { type: \"number\", default: 0.8 },\n    inclination: { type: \"number\", default: 0 },\n    azimuth: { type: \"number\", default: 0.15 },\n    distance: { type: \"number\", default: 8000 }\n  },\n\n  init() {\n    this.sky = new THREE.Sky();\n    this.el.setObject3D(\"mesh\", this.sky);\n    this.skyScene = new THREE.Scene();\n    this.cubeCamera = new THREE.CubeCamera(1, 100000, 512);\n    this.skyScene.add(this.cubeCamera);\n\n    this.updateEnvironmentMap = this.updateEnvironmentMap.bind(this);\n    // HACK: Render environment map on next frame to avoid bug where the render target texture is black.\n    // EXTRA HACK: Added timeout due to additional case where texture is black in avatar-selector in Firefox.\n    // This is likely due to the custom elements attached callback being synchronous on Chrome but not Firefox.\n    requestAnimationFrame(() => setTimeout(this.updateEnvironmentMap));\n  },\n\n  update(oldData) {\n    const uniforms = this.sky.material.uniforms;\n\n    if (this.data.turbidity !== oldData.turbidity) {\n      uniforms.turbidity.value = this.data.turbidity;\n    }\n\n    if (this.data.rayleigh !== oldData.rayleigh) {\n      uniforms.rayleigh.value = this.data.rayleigh;\n    }\n\n    if (this.data.luminance !== oldData.luminance) {\n      uniforms.luminance.value = this.data.luminance;\n    }\n\n    if (this.data.mieCoefficient !== oldData.mieCoefficient) {\n      uniforms.mieCoefficient.value = this.data.mieCoefficient;\n    }\n\n    if (this.data.mieDirectionalG !== oldData.mieDirectionalG) {\n      uniforms.mieDirectionalG.value = this.data.mieDirectionalG;\n    }\n\n    if (\n      this.data.inclination !== oldData.inclination ||\n      this.data.azimuth !== oldData.azimuth ||\n      this.data.distance !== oldData.distance\n    ) {\n      const theta = Math.PI * (this.data.inclination - 0.5);\n      const phi = 2 * Math.PI * (this.data.azimuth - 0.5);\n\n      const distance = this.data.distance;\n\n      const x = distance * Math.cos(phi);\n      const y = distance * Math.sin(phi) * Math.sin(theta);\n      const z = distance * Math.sin(phi) * Math.cos(theta);\n\n      uniforms.sunPosition.value.set(x, y, z).normalize();\n\n      // HACK Remove this if condition and always set the scale based on distance when the existing environments\n      // have their sky scales set to 1.\n      if (this.el.object3D.scale.x === 1) {\n        this.sky.scale.set(distance, distance, distance);\n      }\n\n      this.el.object3D.matrixNeedsUpdate = true;\n    }\n\n    this.updateEnvironmentMap();\n  },\n\n  updateEnvironmentMap() {\n    const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\n\n    if (environmentMapComponent && !isBotMode) {\n      const renderer = this.el.sceneEl.renderer;\n      this.skyScene.add(this.sky);\n      this.cubeCamera.update(renderer, this.skyScene);\n      this.el.setObject3D(\"mesh\", this.sky);\n      const vrEnabled = renderer.vr.enabled;\n      renderer.vr.enabled = false;\n      const pmremGenerator = new THREE.PMREMGenerator(this.cubeCamera.renderTarget.texture);\n      pmremGenerator.update(renderer);\n      const pmremCubeUVPacker = new THREE.PMREMCubeUVPacker(pmremGenerator.cubeLods);\n      pmremCubeUVPacker.update(renderer);\n      renderer.vr.enabled = vrEnabled;\n      environmentMapComponent.updateEnvironmentMap(pmremCubeUVPacker.CubeUVRenderTarget.texture);\n      pmremGenerator.dispose();\n      pmremCubeUVPacker.dispose();\n    }\n  },\n\n  remove() {\n    this.el.removeObject3D(\"mesh\");\n  }\n});\n","const qs = new URLSearchParams(location.search);\n\nexport default function qsTruthy(param) {\n  const val = qs.get(param);\n  // if the param exists but is not set (e.g. \"?foo&bar\"), its value is the empty string.\n  return val === \"\" || /1|on|true|yes/i.test(val);\n}\n","import localeData from \"../assets/translations.data.json\";\nconst navigatorLang = ((navigator.languages && navigator.languages[0]) || navigator.language || navigator.userLanguage)\n  .toLowerCase()\n  .split(/[_-]+/)[0];\nexport const lang = (localeData[navigatorLang] && navigatorLang) || \"en\";\nexport const messages = localeData[lang] || localeData.en;\n","export function getSanitizedComponentMapping(inputComponent, inputProperty, publicComponents) {\n  const publicComponent = publicComponents[inputComponent];\n\n  if (!publicComponent) {\n    throw new Error(`Component \"${inputComponent}\" is not public.`);\n  }\n\n  const publicProperty = publicComponent.publicProperties[inputProperty];\n\n  if (!publicProperty) {\n    throw new Error(`Component \"${inputComponent}\"'s property \"${inputProperty}\" is not public.`);\n  }\n\n  return {\n    mappedComponent: publicComponent.mappedComponent,\n    mappedProperty: publicProperty.mappedProperty,\n    getMappedValue: publicProperty.getMappedValue\n  };\n}\n","import \"./components/gltf-model-plus\";\nimport { getSanitizedComponentMapping } from \"./utils/component-mappings\";\nimport { isHubsDestinationUrl } from \"./utils/media-utils\";\nconst PHYSICS_CONSTANTS = require(\"aframe-physics-system/src/constants\"),\n  TYPE = PHYSICS_CONSTANTS.TYPE,\n  SHAPE = PHYSICS_CONSTANTS.SHAPE,\n  FIT = PHYSICS_CONSTANTS.FIT;\nconst COLLISION_LAYERS = require(\"./constants\").COLLISION_LAYERS;\n\nAFRAME.GLTFModelPlus.registerComponent(\"duck\", \"duck\");\nAFRAME.GLTFModelPlus.registerComponent(\"quack\", \"quack\");\nAFRAME.GLTFModelPlus.registerComponent(\"sound\", \"sound\");\nAFRAME.GLTFModelPlus.registerComponent(\"css-class\", \"css-class\");\nAFRAME.GLTFModelPlus.registerComponent(\"interactable\", \"css-class\", (el, componentName) => {\n  el.setAttribute(componentName, \"interactable\");\n});\nAFRAME.GLTFModelPlus.registerComponent(\"super-spawner\", \"super-spawner\", (el, componentName, componentData) => {\n  //TODO: Do not automatically add these components\n  el.setAttribute(\"is-remote-hover-target\", \"\");\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\n  el.setAttribute(\"hoverable-visuals\", {\n    cursorController: \"#cursor-controller\"\n  });\n  el.setAttribute(componentName, componentData);\n});\nAFRAME.GLTFModelPlus.registerComponent(\"gltf-model-plus\", \"gltf-model-plus\");\nAFRAME.GLTFModelPlus.registerComponent(\"media-loader\", \"media-loader\");\nAFRAME.GLTFModelPlus.registerComponent(\"body\", \"ammo-body\", el => {\n  //This is only required for migration of old environments with super-spawners\n  //will no longer be needed when spawners are added via Spoke instead.\n  el.setAttribute(\"ammo-body\", {\n    mass: 0,\n    type: TYPE.STATIC,\n    collisionFilterGroup: COLLISION_LAYERS.INTERACTABLES,\n    collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER\n  });\n});\nAFRAME.GLTFModelPlus.registerComponent(\"ammo-shape\", \"ammo-shape\");\nAFRAME.GLTFModelPlus.registerComponent(\"hide-when-quality\", \"hide-when-quality\");\nAFRAME.GLTFModelPlus.registerComponent(\"light\", \"light\", (el, componentName, componentData) => {\n  if (componentData.distance === 0) {\n    componentData.decay = 0;\n  }\n  el.setAttribute(componentName, componentData);\n  if (componentData.castShadow) {\n    // HACK: component.light isn't set until one frame after setArrtibute\n    setTimeout(() => {\n      el.components.light.light.shadow.camera.matrixNeedsUpdate = true;\n    }, 0);\n  }\n});\nAFRAME.GLTFModelPlus.registerComponent(\"ambient-light\", \"ambient-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"directional-light\", \"directional-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"hemisphere-light\", \"hemisphere-light\");\nfunction decayMigration(el, componentName, componentData) {\n  if (componentData.range === 0) {\n    componentData.decay = 0;\n  }\n  el.setAttribute(componentName, componentData);\n}\nAFRAME.GLTFModelPlus.registerComponent(\"point-light\", \"point-light\", decayMigration);\nAFRAME.GLTFModelPlus.registerComponent(\"spot-light\", \"spot-light\", decayMigration);\n\nAFRAME.GLTFModelPlus.registerComponent(\"skybox\", \"skybox\");\nAFRAME.GLTFModelPlus.registerComponent(\"layers\", \"layers\");\nAFRAME.GLTFModelPlus.registerComponent(\"shadow\", \"shadow\");\nAFRAME.GLTFModelPlus.registerComponent(\"water\", \"water\");\nAFRAME.GLTFModelPlus.registerComponent(\"scale-audio-feedback\", \"scale-audio-feedback\");\nAFRAME.GLTFModelPlus.registerComponent(\"animation-mixer\", \"animation-mixer\");\nAFRAME.GLTFModelPlus.registerComponent(\"loop-animation\", \"loop-animation\");\nAFRAME.GLTFModelPlus.registerComponent(\n  \"box-collider\",\n  \"ammo-shape\",\n  (() => {\n    const euler = new THREE.Euler();\n    return (el, componentName, componentData) => {\n      const { scale, rotation } = componentData;\n      euler.set(rotation.x, rotation.y, rotation.z);\n      const orientation = new THREE.Quaternion().setFromEuler(euler);\n      el.setAttribute(componentName, {\n        type: SHAPE.BOX,\n        fit: FIT.MANUAL,\n        offset: componentData.position,\n        halfExtents: { x: scale.x / 2, y: scale.y / 2, z: scale.z / 2 },\n        orientation\n      });\n    };\n  })()\n);\nAFRAME.GLTFModelPlus.registerComponent(\"visible\", \"visible\", (el, componentName, componentData) => {\n  if (typeof componentData === \"object\") {\n    el.setAttribute(componentName, componentData.visible);\n  } else {\n    el.setAttribute(componentName, componentData);\n  }\n});\nAFRAME.GLTFModelPlus.registerComponent(\"spawn-point\", \"spawn-point\");\nAFRAME.GLTFModelPlus.registerComponent(\"sticky-zone\", \"sticky-zone\");\nAFRAME.GLTFModelPlus.registerComponent(\"nav-mesh\", \"nav-mesh\", (el, _componentName, componentData) => {\n  const nav = AFRAME.scenes[0].systems.nav;\n  const zone = componentData.zone || \"character\";\n  let found = false;\n  el.object3D.traverse(node => {\n    if (node.isMesh && !found) {\n      found = true;\n      nav.loadMesh(node, zone);\n    }\n  });\n  // There isn't actually an a-frame nav-mesh component, but we want to tag this el as a nav-mesh since\n  // nav-mesh-helper will query for it later.\n  el.setAttribute(\"nav-mesh\");\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"pinnable\", \"pinnable\");\n\nAFRAME.GLTFModelPlus.registerComponent(\"media\", \"media\", (el, componentName, componentData) => {\n  if (componentData.id) {\n    el.setAttribute(\"networked\", {\n      template: \"#interactable-media\",\n      owner: \"scene\",\n      persistent: true,\n      networkId: componentData.id\n    });\n  }\n\n  el.setAttribute(\"media-loader\", {\n    src: componentData.src,\n    resize: true,\n    resolve: true,\n    fileIsOwned: true,\n    animate: false\n  });\n\n  if (componentData.pageIndex) {\n    el.setAttribute(\"media-pager\", { index: componentData.pageIndex });\n  }\n\n  if (componentData.paused !== undefined) {\n    el.setAttribute(\"media-video\", { videoPaused: componentData.paused });\n  }\n\n  if (componentData.time) {\n    el.setAttribute(\"media-video\", { time: componentData.time });\n  }\n});\n\nfunction mediaInflator(el, componentName, componentData, components) {\n  let isControlled = true;\n\n  if (components.networked) {\n    // TODO: When non-hubs links can be traversed, make all link components controlled so you can open them.\n    isControlled =\n      componentData.controls || isHubsDestinationUrl(componentData.src) || isHubsDestinationUrl(componentData.href);\n\n    const hasVolume = componentName === \"video\";\n    const templateName = isControlled || hasVolume ? \"#static-controlled-media\" : \"#static-media\";\n\n    el.setAttribute(\"networked\", {\n      template: templateName,\n      owner: \"scene\",\n      persistent: true,\n      networkId: components.networked.id\n    });\n  }\n\n  const mediaOptions = {};\n\n  if (componentName === \"video\" || componentName === \"image\") {\n    mediaOptions.projection = componentData.projection;\n  }\n\n  if (componentName === \"video\") {\n    mediaOptions.videoPaused = !componentData.autoPlay;\n    mediaOptions.volume = componentData.volume;\n    mediaOptions.loop = componentData.loop;\n    mediaOptions.audioType = componentData.audioType;\n    mediaOptions.hidePlaybackControls = !isControlled;\n\n    if (componentData.audioType === \"pannernode\") {\n      mediaOptions.distanceModel = componentData.distanceModel;\n      mediaOptions.rolloffFactor = componentData.rolloffFactor;\n      mediaOptions.refDistance = componentData.refDistance;\n      mediaOptions.maxDistance = componentData.maxDistance;\n      mediaOptions.coneInnerAngle = componentData.coneInnerAngle;\n      mediaOptions.coneOuterAngle = componentData.coneOuterAngle;\n      mediaOptions.coneOuterGain = componentData.coneOuterGain;\n    }\n\n    el.setAttribute(\"video-pause-state\", { paused: mediaOptions.videoPaused });\n  }\n\n  const src = componentName === \"link\" ? componentData.href : componentData.src;\n\n  el.setAttribute(\"media-loader\", {\n    src,\n    resize: true,\n    resolve: true,\n    fileIsOwned: true,\n    animate: false,\n    mediaOptions\n  });\n}\n\nAFRAME.GLTFModelPlus.registerComponent(\"image\", \"image\", mediaInflator);\nAFRAME.GLTFModelPlus.registerComponent(\"video\", \"video\", mediaInflator, (name, property, value) => {\n  if (property === \"paused\") {\n    return { name: \"video-pause-state\", property, value };\n  } else {\n    return null;\n  }\n});\nAFRAME.GLTFModelPlus.registerComponent(\"link\", \"link\", mediaInflator);\n\nAFRAME.GLTFModelPlus.registerComponent(\"hoverable\", \"is-remote-hover-target\", el => {\n  el.setAttribute(\"is-remote-hover-target\", \"\");\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"spawner\", \"spawner\", (el, componentName, componentData) => {\n  el.setAttribute(\"media-loader\", {\n    src: componentData.src,\n    resolve: true,\n    fileIsOwned: true,\n    animate: false\n  });\n  el.setAttribute(\"css-class\", \"interactable\");\n  el.setAttribute(\"super-spawner\", {\n    src: componentData.src,\n    resolve: true,\n    template: \"#interactable-media\"\n  });\n  el.setAttribute(\"hoverable-visuals\", {\n    cursorController: \"#cursor-controller\"\n  });\n  el.setAttribute(\"ammo-body\", {\n    mass: 0,\n    type: TYPE.STATIC,\n    collisionFilterGroup: COLLISION_LAYERS.INTERACTABLES,\n    collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER\n  });\n  el.setAttribute(\"is-remote-hover-target\", \"\");\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\n});\n\nconst publicComponents = {\n  video: {\n    mappedComponent: \"video-pause-state\",\n    publicProperties: {\n      paused: {\n        mappedProperty: \"paused\",\n        getMappedValue(value) {\n          return !!value;\n        }\n      }\n    }\n  },\n  \"loop-animation\": {\n    mappedComponent: \"loop-animation\",\n    publicProperties: {\n      paused: {\n        mappedProperty: \"paused\",\n        getMappedValue(value) {\n          return !!value;\n        }\n      }\n    }\n  }\n};\n\nAFRAME.GLTFModelPlus.registerComponent(\n  \"trigger-volume\",\n  \"trigger-volume\",\n  (el, componentName, componentData, components, indexToEntityMap) => {\n    const {\n      size,\n      target,\n      enterComponent,\n      enterProperty,\n      enterValue,\n      leaveComponent,\n      leaveProperty,\n      leaveValue\n    } = componentData;\n\n    let enterComponentMapping, leaveComponentMapping, targetEntity;\n\n    try {\n      enterComponentMapping = getSanitizedComponentMapping(enterComponent, enterProperty, publicComponents);\n      leaveComponentMapping = getSanitizedComponentMapping(leaveComponent, leaveProperty, publicComponents);\n\n      targetEntity = indexToEntityMap[target];\n\n      if (!targetEntity) {\n        throw new Error(`Couldn't find target entity with index: ${target}.`);\n      }\n    } catch (e) {\n      console.warn(`Error inflating gltf component \"trigger-volume\": ${e.message}`);\n      return;\n    }\n\n    // Filter out scope and colliders properties.\n    el.setAttribute(\"trigger-volume\", {\n      colliders: \"#player-camera\",\n      size,\n      target: targetEntity,\n      enterComponent: enterComponentMapping.mappedComponent,\n      enterProperty: enterComponentMapping.mappedProperty,\n      enterValue: enterComponentMapping.getMappedValue(enterValue),\n      leaveComponent: leaveComponentMapping.mappedComponent,\n      leaveProperty: leaveComponentMapping.mappedProperty,\n      leaveValue: leaveComponentMapping.getMappedValue(leaveValue)\n    });\n  }\n);\n","export default function maskEmail(email) {\n  if (!email) return \"\";\n  const emailParts = email.split(\"@\");\n  const emailIdentity = emailParts[0];\n  const emailDomain = emailParts[1];\n  const truncatedIdentity = emailIdentity.substring(0, Math.min(emailIdentity.length, 3));\n  return `${truncatedIdentity}...@${emailDomain}`;\n}\n","import uuid from \"uuid/v4\";\n\nexport default class AuthChannel {\n  constructor(store) {\n    this.store = store;\n    this.socket = null;\n    this._signedIn = !!this.store.state.credentials.token;\n  }\n\n  setSocket = socket => {\n    this.socket = socket;\n  };\n\n  get email() {\n    return this.store.state.credentials.email;\n  }\n\n  get signedIn() {\n    return this._signedIn;\n  }\n\n  signOut = async hubChannel => {\n    if (hubChannel) {\n      await hubChannel.signOut();\n    }\n    this.store.update({ credentials: { token: null, email: null } });\n    this.store.resetToRandomLegacyAvatar();\n    this._signedIn = false;\n  };\n\n  async startAuthentication(email, hubChannel) {\n    const channel = this.socket.channel(`auth:${uuid()}`);\n    await new Promise((resolve, reject) =>\n      channel\n        .join()\n        .receive(\"ok\", resolve)\n        .receive(\"error\", reject)\n    );\n\n    const authComplete = new Promise(resolve =>\n      channel.on(\"auth_credentials\", async ({ credentials: token }) => {\n        this.store.update({ credentials: { email, token } });\n        if (hubChannel) {\n          await hubChannel.signIn(token);\n        }\n        this._signedIn = true;\n        resolve();\n      })\n    );\n\n    channel.push(\"auth_request\", { email, origin: \"hubs\" });\n\n    // Returning an object with the authComplete promise since we want the caller to wait for the above await but not\n    // for authComplete.\n    return { authComplete };\n  }\n}\n","module.exports = __webpack_public_path__ + \"assets/LoadingObject_Atom-7dcc3b81897e68b740c1cf12b6cf4c3f.glb\";","module.exports = __webpack_public_path__ + \"assets/sfx/teleport-loop-84e2caa4f62e5c6d6ce339b0c715c06d.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/quickTurn-cda89edb1a7a32e4442cac70cd2694be.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/tap_mellow-673398d6e97818ec4b675708d460bd0f.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/PenSpawn-aac1f534773040f0fafa41e9db76017b.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/PenDraw1-ddbdc17a6beefecbca2685c8c9d0d2d5.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/PicSnapHey-0228ddd197e5a6d88f7bcd2ceb340f8e.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/welcome-0083300978d5dd05eaa376f65761da47.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/quack-1f18502834f8f1db43990b769c2ab193.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/specialquack-6d1a192a6092e8dfed5d3de063755ee2.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/pop-5784f3bcfaf98637147737448d6df8df.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/Eb_blip-8d7302990e83d6798400a6027dce3936.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/tack-0d55b064794faaa1733fcf6bc89cad0c.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/A_bendUp-de32e556413bb2a527fb514984738c70.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/suspense-f27c64840e5ede36ec694c22a030615c.mp3\";","module.exports = __webpack_public_path__ + \"assets/waternormals-4418dde3f6abc21dc32506acf5f5b093.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/hub-preview-white-ccefba3b70ae589a0ca5ae3230c39299.png\";","// NOTE: We do not use an IV since we generate a new keypair each time we use these routines.\n\nasync function deriveKey(privateKey, publicKey) {\n  return crypto.subtle.deriveKey(\n    { name: \"ECDH\", public: publicKey },\n    privateKey,\n    { name: \"AES-CBC\", length: 256 },\n    true,\n    [\"encrypt\", \"decrypt\"]\n  );\n}\n\nasync function publicKeyToString(key) {\n  return JSON.stringify(await crypto.subtle.exportKey(\"jwk\", key));\n}\n\nasync function stringToPublicKey(s) {\n  return await crypto.subtle.importKey(\"jwk\", JSON.parse(s), { name: \"ECDH\", namedCurve: \"P-256\" }, true, []);\n}\n\nfunction stringToArrayBuffer(s) {\n  const buf = new Uint8Array(s.length);\n\n  for (let i = 0; i < s.length; i++) {\n    buf[i] = s.charCodeAt(i);\n  }\n\n  return buf;\n}\n\nfunction arrayBufferToString(b) {\n  const buf = new Uint8Array(b);\n  let s = \"\";\n\n  for (let i = 0; i < buf.byteLength; i++) {\n    s += String.fromCharCode(buf[i]);\n  }\n\n  return s;\n}\n\n// This allows a single object to be passed encrypted from a receiver in a req -> response flow\n\n// Requestor generates a public key and private key, and should send the public key to receiver.\nexport async function generateKeys() {\n  const keyPair = await crypto.subtle.generateKey({ name: \"ECDH\", namedCurve: \"P-256\" }, true, [\"deriveKey\"]);\n  const publicKeyString = await publicKeyToString(keyPair.publicKey);\n  return { publicKeyString, privateKey: keyPair.privateKey };\n}\n\n// Receiver takes the public key from requestor and passes obj to get a response public key and the encrypted data to return.\nexport async function generatePublicKeyAndEncryptedObject(incomingPublicKeyString, obj) {\n  const iv = new Uint8Array(16);\n  const incomingPublicKey = await stringToPublicKey(incomingPublicKeyString);\n  const keyPair = await crypto.subtle.generateKey({ name: \"ECDH\", namedCurve: \"P-256\" }, true, [\"deriveKey\"]);\n  const publicKeyString = await publicKeyToString(keyPair.publicKey);\n  const secret = await deriveKey(keyPair.privateKey, incomingPublicKey);\n\n  const encryptedData = btoa(\n    arrayBufferToString(\n      await crypto.subtle.encrypt({ name: \"AES-CBC\", iv }, secret, stringToArrayBuffer(JSON.stringify(obj)))\n    )\n  );\n\n  return { publicKeyString, encryptedData };\n}\n\n// Requestor then takes the receiver's public key, the private key (returned from generateKeys()), and the data from the receiver.\nexport async function decryptObject(publicKeyString, privateKey, base64value) {\n  const iv = new Uint8Array(16);\n  const publicKey = await stringToPublicKey(publicKeyString);\n  const secret = await deriveKey(privateKey, publicKey);\n  const ciphertext = stringToArrayBuffer(atob(base64value));\n  const data = await crypto.subtle.decrypt({ name: \"AES-CBC\", iv }, secret, ciphertext);\n  return JSON.parse(arrayBufferToString(data));\n}\n","import { generatePublicKeyAndEncryptedObject, generateKeys, decryptObject } from \"./crypto\";\n\nconst LINK_ACTION_TIMEOUT = 10000;\n\nexport default class LinkChannel {\n  constructor(store) {\n    this.store = store;\n  }\n\n  setSocket = socket => {\n    this.socket = socket;\n  };\n\n  // Returns a promise that, when resolved, will forward an object with three keys:\n  //\n  // code: The code that was made available to use for link.\n  //\n  // cancel: A function that the caller can call to cancel the use of the code.\n  //\n  // onFinished: A promise that, when resolved, indicates the code is no longer usable,\n  // because it was either successfully used by the remote device or it has expired\n  // (\"used\" or \"expired\" is passed to the callback).\n  generateCode = () => {\n    return new Promise(resolve => {\n      const onFinished = new Promise(finished => {\n        const step = () => {\n          const getLetter = () => \"ABCDEFGHI\"[Math.floor(Math.random() * 9)];\n          const code = `${getLetter()}${getLetter()}${getLetter()}${getLetter()}`;\n\n          // Only respond to one link_request in this channel.\n          let readyToSend = false;\n          let leftChannel = false;\n\n          const channel = this.socket.channel(`link:${code}`, { timeout: LINK_ACTION_TIMEOUT });\n\n          const leave = () => {\n            if (!leftChannel) channel.leave();\n            leftChannel = true;\n          };\n\n          const cancel = () => leave();\n\n          channel.on(\"link_expired\", () => finished(\"expired\"));\n\n          channel.on(\"presence_state\", state => {\n            if (readyToSend) return;\n\n            if (Object.keys(state).length > 0) {\n              // Code is in use by someone else, try a new one\n              step();\n            } else {\n              readyToSend = true;\n              resolve({ code, cancel, onFinished });\n            }\n          });\n\n          channel.on(\"link_request\", incoming => {\n            if (readyToSend) {\n              const data = { path: location.pathname };\n\n              // Copy profile data to link'ed device if it's been set.\n              if (this.store.state.activity.hasChangedName) {\n                data.profile = { ...this.store.state.profile };\n              }\n              data.credentials = { ...this.store.state.credentials };\n\n              generatePublicKeyAndEncryptedObject(incoming.public_key, data).then(\n                ({ publicKeyString, encryptedData }) => {\n                  const payload = {\n                    target_session_id: incoming.reply_to_session_id,\n                    public_key: publicKeyString,\n                    data: encryptedData\n                  };\n\n                  if (!leftChannel) {\n                    channel.push(\"link_response\", payload);\n                  }\n\n                  leave();\n\n                  finished(\"used\");\n                  readyToSend = false;\n                }\n              );\n            }\n          });\n\n          channel.join().receive(\"error\", r => console.error(r));\n        };\n\n        step();\n      });\n    });\n  };\n\n  // Attempts to receive a link payload from a remote device using the given code.\n  //\n  // Promise rejects if the code is invalid or there is a problem with the channel.\n  // Promise resolves and passes payload of link source on successful link.\n  attemptLink = code => {\n    return new Promise((resolve, reject) => {\n      const channel = this.socket.channel(`link:${code}`, { timeout: LINK_ACTION_TIMEOUT });\n      let finished = false;\n\n      generateKeys().then(({ publicKeyString, privateKey }) => {\n        channel.on(\"presence_state\", state => {\n          const numOccupants = Object.keys(state).length;\n\n          if (numOccupants === 1) {\n            // Great, only sender is in topic, request link\n            channel.push(\"link_request\", {\n              reply_to_session_id: this.socket.params().session_id,\n              public_key: publicKeyString\n            });\n\n            setTimeout(() => {\n              if (finished) return;\n              channel.leave();\n              reject(new Error(\"no_response\"));\n            }, LINK_ACTION_TIMEOUT);\n          } else if (numOccupants === 0) {\n            // Nobody in this channel, probably a bad code.\n            channel.leave();\n            reject(new Error(\"failed\"));\n          } else {\n            console.warn(\"link code channel already has 2 or more occupants, something fishy is going on.\");\n            channel.leave();\n            reject(new Error(\"in_use\"));\n          }\n        });\n\n        channel.on(\"link_response\", payload => {\n          finished = true;\n          channel.leave();\n\n          decryptObject(payload.public_key, privateKey, payload.data).then(resolve);\n        });\n\n        channel\n          .join()\n          .receive(\"ok\", data => (this.socket.params().session_id = data.session_id))\n          .receive(\"error\", r => console.error(r));\n      });\n    });\n  };\n}\n","import { avatars } from \"../assets/avatars/avatars.js\";\n\nconst names = [\n  \"Baers-Pochard\",\n  \"Baikal-Teal\",\n  \"Barrows-Goldeneye\",\n  \"Blue-Billed\",\n  \"Blue-Duck\",\n  \"Blue-Winged\",\n  \"Brown-Teal\",\n  \"Bufflehead\",\n  \"Canvasback\",\n  \"Cape-Shoveler\",\n  \"Chestnut-Teal\",\n  \"Chiloe-Wigeon\",\n  \"Cinnamon-Teal\",\n  \"Comb-Duck\",\n  \"Common-Eider\",\n  \"Common-Goldeneye\",\n  \"Common-Merganser\",\n  \"Common-Pochard\",\n  \"Common-Scoter\",\n  \"Common-Shelduck\",\n  \"Cotton-Pygmy\",\n  \"Crested-Duck\",\n  \"Crested-Shelduck\",\n  \"Eatons-Pintail\",\n  \"Falcated\",\n  \"Ferruginous\",\n  \"Freckled-Duck\",\n  \"Gadwall\",\n  \"Garganey\",\n  \"Greater-Scaup\",\n  \"Green-Pygmy\",\n  \"Grey-Teal\",\n  \"Hardhead\",\n  \"Harlequin\",\n  \"Hartlaubs\",\n  \"Hooded-Merganser\",\n  \"Hottentot-Teal\",\n  \"Kelp-Goose\",\n  \"King-Eider\",\n  \"Lake-Duck\",\n  \"Laysan-Duck\",\n  \"Lesser-Scaup\",\n  \"Long-Tailed\",\n  \"Maccoa-Duck\",\n  \"Mallard\",\n  \"Mandarin\",\n  \"Marbled-Teal\",\n  \"Mellers-Duck\",\n  \"Merganser\",\n  \"Northern-Pintail\",\n  \"Orinoco-Goose\",\n  \"Paradise-Shelduck\",\n  \"Plumed-Whistler\",\n  \"Puna-Teal\",\n  \"Pygmy-Goose\",\n  \"Radjah-Shelduck\",\n  \"Red-Billed\",\n  \"Red-Crested\",\n  \"Red-Shoveler\",\n  \"Ring-Necked\",\n  \"Ringed-Teal\",\n  \"Rosy-Billed\",\n  \"Ruddy-Shelduck\",\n  \"Salvadoris-Teal\",\n  \"Scaly-Sided\",\n  \"Shelduck\",\n  \"Shoveler\",\n  \"Silver-Teal\",\n  \"Smew\",\n  \"Spectacled-Eider\",\n  \"Spot-Billed\",\n  \"Spotted-Whistler\",\n  \"Steamerduck\",\n  \"Stellers-Eider\",\n  \"Sunda-Teal\",\n  \"Surf-Scoter\",\n  \"Tufted-Duck\",\n  \"Velvet-Scoter\",\n  \"Wandering-Whistler\",\n  \"Whistling-duck\",\n  \"White-Backed\",\n  \"White-Cheeked\",\n  \"White-Winged\",\n  \"Wigeon\",\n  \"Wood-Duck\",\n  \"Yellow-Billed\"\n];\n\nfunction selectRandom(arr) {\n  return arr[Math.floor(Math.random() * arr.length)];\n}\n\nexport function generateRandomName() {\n  return `${selectRandom(names)}-${Math.floor(10000 + Math.random() * 10000)}`;\n}\n\nexport const avatarIds = avatars.map(av => av.id);\n\nexport function generateDefaultProfile() {\n  return {\n    avatarId: selectRandom(avatarIds)\n  };\n}\n","import { Validator } from \"jsonschema\";\nimport merge from \"deepmerge\";\nimport Cookies from \"js-cookie\";\nimport jwtDecode from \"jwt-decode\";\n\nconst LOCAL_STORE_KEY = \"___hubs_store\";\nconst STORE_STATE_CACHE_KEY = Symbol();\nconst OAUTH_FLOW_CREDENTIALS_KEY = \"ret-oauth-flow-account-credentials\";\nconst validator = new Validator();\nimport { EventTarget } from \"event-target-shim\";\nimport { generateDefaultProfile, generateRandomName } from \"../utils/identity.js\";\n\n// Durable (via local-storage) schema-enforced state that is meant to be consumed via forward data flow.\n// (Think flux but with way less incidental complexity, at least for now :))\nexport const SCHEMA = {\n  id: \"/HubsStore\",\n\n  definitions: {\n    profile: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        displayName: { type: \"string\", pattern: \"^[A-Za-z0-9-]{3,32}$\" },\n        avatarId: { type: \"string\" },\n        personalAvatarId: { type: \"string\" }\n      }\n    },\n\n    credentials: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        token: { type: [\"null\", \"string\"] },\n        email: { type: [\"null\", \"string\"] }\n      }\n    },\n\n    activity: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        hasFoundFreeze: { type: \"boolean\" },\n        hasChangedName: { type: \"boolean\" },\n        hasAcceptedProfile: { type: \"boolean\" },\n        lastEnteredAt: { type: \"string\" },\n        hasPinned: { type: \"boolean\" },\n        hasRotated: { type: \"boolean\" },\n        hasRecentered: { type: \"boolean\" },\n        hasScaled: { type: \"boolean\" },\n        hasHoveredInWorldHud: { type: \"boolean\" }\n      }\n    },\n\n    settings: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        lastUsedMicDeviceId: { type: \"string\" }\n      }\n    },\n\n    confirmedDiscordRooms: {\n      type: \"array\",\n      items: { type: \"string\" }\n    },\n\n    uploadPromotionTokens: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          fileId: { type: \"string\" },\n          promotionToken: { type: \"string\" }\n        }\n      }\n    },\n\n    creatorAssignmentTokens: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          hubId: { type: \"string\" },\n          creatorAssignmentToken: { type: \"string\" }\n        }\n      }\n    }\n  },\n\n  type: \"object\",\n\n  properties: {\n    profile: { $ref: \"#/definitions/profile\" },\n    credentials: { $ref: \"#/definitions/credentials\" },\n    activity: { $ref: \"#/definitions/activity\" },\n    settings: { $ref: \"#/definitions/settings\" },\n    confirmedDiscordRooms: { $ref: \"#/definitions/confirmedDiscordRooms\" },\n    uploadPromotionTokens: { $ref: \"#/definitions/uploadPromotionTokens\" },\n    creatorAssignmentTokens: { $ref: \"#/definitions/creatorAssignmentTokens\" }\n  },\n\n  additionalProperties: false\n};\n\nexport default class Store extends EventTarget {\n  constructor() {\n    super();\n\n    if (localStorage.getItem(LOCAL_STORE_KEY) === null) {\n      localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify({}));\n    }\n    this.update({\n      activity: {},\n      settings: {},\n      credentials: {},\n      profile: {},\n      confirmedDiscordRooms: [],\n      uploadPromotionTokens: [],\n      creatorAssignmentTokens: []\n    });\n\n    const oauthFlowCredentials = Cookies.getJSON(OAUTH_FLOW_CREDENTIALS_KEY);\n    if (oauthFlowCredentials) {\n      this.update({ credentials: oauthFlowCredentials });\n      this.resetToRandomLegacyAvatar();\n      Cookies.remove(OAUTH_FLOW_CREDENTIALS_KEY);\n    }\n  }\n\n  // Initializes store with any default bits\n  init = () => {\n    this.update({\n      profile: { ...generateDefaultProfile(), ...(this.state.profile || {}) }\n    });\n\n    // Regenerate name to encourage users to change it.\n    if (!this.state.activity.hasChangedName) {\n      this.update({ profile: { displayName: generateRandomName() } });\n    }\n  };\n\n  resetToRandomLegacyAvatar = () => {\n    this.update({\n      profile: { ...(this.state.profile || {}), ...generateDefaultProfile() }\n    });\n  };\n\n  get state() {\n    if (!this.hasOwnProperty(STORE_STATE_CACHE_KEY)) {\n      this[STORE_STATE_CACHE_KEY] = JSON.parse(localStorage.getItem(LOCAL_STORE_KEY));\n    }\n\n    return this[STORE_STATE_CACHE_KEY];\n  }\n\n  get credentialsAccountId() {\n    if (this.state.credentials.token) {\n      return jwtDecode(this.state.credentials.token).sub;\n    } else {\n      return null;\n    }\n  }\n\n  resetConfirmedDiscordRooms() {\n    // merge causing us some annoyance here :(\n    const overwriteMerge = (destinationArray, sourceArray) => sourceArray;\n    this.update({ confirmedDiscordRooms: [] }, { arrayMerge: overwriteMerge });\n  }\n\n  resetTipActivityFlags() {\n    this.update({ activity: { hasRotated: false, hasPinned: false, hasRecentered: false, hasScaled: false } });\n  }\n\n  update(newState, mergeOpts) {\n    const finalState = merge(this.state, newState, mergeOpts);\n    const { valid } = validator.validate(finalState, SCHEMA);\n\n    if (!valid) {\n      // Intentionally not including details about the state or validation result here, since we don't want to leak\n      // sensitive data in the error message.\n      throw new Error(`Write to store failed schema validation.`);\n    }\n\n    localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify(finalState));\n    delete this[STORE_STATE_CACHE_KEY];\n\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n\n    return finalState;\n  }\n}\n","export const avatars = [\n  {\n    id: \"botdefault\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotDefault_Avatar-9f71f8ff22.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botdefault-thumb-42C4C7D3C01D085EAFDAC8BACE591CE6.png\"\n  },\n  {\n    id: \"botbobo\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotBobo_Avatar-f9740a010b.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botbobo-thumb-261278FD5831E9CD89610D15948F23E4.png\"\n  },\n  {\n    id: \"botdom\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotDom_Avatar-0c48bf15a5.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botdom-thumb-1160EB5E81D24F12CE643C520CE1E99E.png\"\n  },\n  {\n    id: \"botgreg\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotGreg_Avatar-98d39797bb.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botgreg-thumb-F2A37F14F9C342EE44DDE9B24DD9B9FC.png\"\n  },\n  {\n    id: \"botguest\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotGuest_Avatar-78cd857332.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botguest-thumb-F7A471250E2C10C2709325C3B02A8BBB.png\"\n  },\n  {\n    id: \"botjim\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotJim_Avatar-d28005a687.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botjim-thumb-A2D195C1A51A082BCED58BD172481B39.png\"\n  },\n  {\n    id: \"botkev\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotKev_Avatar-a95787bb51.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botkev-thumb-90746A7349E3F964C913EA612EE9A53F.png\"\n  },\n  {\n    id: \"botpinky\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotPinky_Avatar-b0b93f8675.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botpinky-thumb-C2E69D4479077766B988DC3EE4F30BE5.png\"\n  },\n  {\n    id: \"botrobert\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotRobert_Avatar-e9554880f3.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botrobert-thumb-9C33F2C752326E2CF4321EAA7BDB4E47.png\"\n  },\n  {\n    id: \"botwoody\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotWoody_Avatar-0140485a23.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botwoody-thumb-F1F1FA7E21301B5AC1D8872B4ED0CC56.png\"\n  }\n];\n","import qsTruthy from \"./qs_truthy\";\n\nconst showLog = qsTruthy(\"debug_log\");\n\nif (showLog) {\n  const template = document.createElement(\"template\");\n  template.innerHTML = `\n\t<style>\n\t  #debug-log {\n\t\tposition: absolute;\n\t\ttop: 13em;\n\t\tbackground: white;\n\t\topacity: 0.7;\n      }\n      #debug-log, #debug-log-input {\n\t\tfont-family: monospace;\n\t\tfont-size: 11px;\n\t\twidth: 100%;\n\t  }\n\n      #debug-log-controls {\n        display: flex;\n        padding: 0.2em;\n      }\n\n      #debug-log-eval {\n        display: flex;\n        flex: 1;\n      }\n\n      #debug-log-log {\n        overflow: auto;\n        height: 30vh;\n      }\n      #debug-log-log.minimized {\n        height: auto;\n      }\n      #debug-log-log.minimized .entry {\n        display: none;\n      }\n      #debug-log-log.minimized .entry:last-child {\n        display: block;\n      }\n      #debug-log-log .entry {\n        border: 1px solid grey;\n        margin: 0.2em;\n        padding: 0.2em;\n      }\n      #debug-log-log .entry.error { background-color: pink; }\n      #debug-log-log .entry.warn { background-color: orange; }\n\t</style>\n\t<div id=\"debug-log\">\n        <div id=\"debug-log-controls\">\n          <form id=\"debug-log-eval\">\n            <input id=\"debug-log-input\" placeholder=\"&gt;&gt;\" autocorrect=\"off\" autocapitalize=\"none\" />\n            <button>&gt;</button>\n          </form>\n          <button id=\"debug-log-minimize\">_</button>\n        </div>\n\t\t<div id=\"debug-log-log\"></div>\n\t</div>\n  `;\n\n  document.addEventListener(\"DOMContentLoaded\", () => {\n    document.body.appendChild(template.content);\n  });\n\n  const debugLog = template.content.querySelector(\"#debug-log-log\");\n  debugLog.addEventListener(\"wheel\", e => e.stopPropagation());\n\n  const debugLogInput = template.content.querySelector(\"#debug-log-input\");\n  const debugLogEval = template.content.querySelector(\"#debug-log-eval\");\n  debugLogEval.onsubmit = e => {\n    e.preventDefault();\n    console.log(eval(`(${debugLogInput.value})`));\n  };\n\n  let minimized = false;\n  const debugLogMinimize = template.content.querySelector(\"#debug-log-minimize\");\n  debugLogMinimize.onclick = () => {\n    minimized = !minimized;\n    debugLog.className = minimized ? \"minimized\" : \"\";\n    debugLog.scrollTop = debugLog.scrollHeight - debugLog.clientHeight;\n  };\n\n  const origConsoleLog = console.log;\n  const origConsoleError = console.error;\n  const origConsoleWarn = console.warn;\n\n  const log = function(className, objs) {\n    let entry;\n    if (debugLog.childNodes.length > 1000) {\n      entry = debugLog.firstChild;\n    } else {\n      entry = document.createElement(\"div\");\n      entry.classList.add(\"entry\");\n    }\n    entry.classList.remove(\"warn\", \"error\");\n    entry.classList.add(className);\n\n    const arr = Array.from(objs);\n    const firstObj = arr[0];\n    let content;\n    if (typeof firstObj === \"string\" && firstObj.includes(\"%c\")) {\n      content = firstObj.replace(/%c/g, \"\");\n    } else if (firstObj instanceof Error) {\n      content = `${firstObj.message}\\n${firstObj.stack}`;\n    } else {\n      content = arr\n        .map(obj => {\n          if (typeof obj === \"string\") return obj;\n          return JSON.stringify(obj);\n        })\n        .join(\" \");\n    }\n\n    const time = new Date().toISOString().substring(11, 23);\n    entry.textContent = `[${time}] ${content}`;\n\n    const shouldScroll = debugLog.scrollTop === debugLog.scrollHeight - debugLog.clientHeight;\n    debugLog.append(entry);\n    if (shouldScroll) debugLog.scrollTop = debugLog.scrollHeight - debugLog.clientHeight;\n  };\n\n  console.warn = function() {\n    origConsoleWarn.apply(null, arguments);\n    log(\"warn\", arguments);\n  };\n\n  console.error = function() {\n    origConsoleError.apply(null, arguments);\n    log(\"error\", arguments);\n  };\n\n  console.log = function() {\n    origConsoleLog.apply(null, arguments);\n    log(\"log\", arguments);\n  };\n\n  window.onunhandledrejection = e => log(\"error\", [e.reason.message, e.reason.code, e.reason.name]);\n  window.onerror = e => log(\"error\", [e]);\n}\n","import screenfull from \"screenfull\";\nimport { showFullScreenIfWasFullScreen } from \"./fullscreen\";\nconst { detect } = require(\"detect-browser\");\n\nconst browser = detect();\nlet isExitingFullscreenDueToFocus = false;\n\n// Utility function that handles a bunch of incidental stuff related to text fields:\n//\n// - On non-mobile platforms, selects the value on focus\n// - If full screen, exits/enters full screen because of firefox full screen issues\nexport function handleTextFieldFocus(target) {\n  if (!window.AFRAME) return;\n  const isMobile = AFRAME.utils.device.isMobile();\n\n  if (screenfull.isFullscreen && !AFRAME.utils.device.isMobileVR() && browser.name === \"firefox\") {\n    // This will prevent focus, but its the only way to avoid getting into a\n    // weird \"firefox reports full screen but actually not\". You end up having to tap\n    // twice to ultimately get the focus.\n    //\n    // We need to keep track of a bit here so that we don't re-full screen when\n    // the text box is blurred by the browser.\n\n    isExitingFullscreenDueToFocus = true;\n    screenfull.exit().then(() => {\n      target.focus();\n    });\n  }\n\n  if (!isMobile) target.select();\n}\n\nexport function handleTextFieldBlur() {\n  // This is the incidental blur event when exiting fullscreen mode on mobile\n  if (isExitingFullscreenDueToFocus) {\n    isExitingFullscreenDueToFocus = false;\n    return;\n  }\n\n  showFullScreenIfWasFullScreen();\n}\n","export function forEachMaterial(object3D, fn) {\n  if (!object3D.material) return;\n\n  if (Array.isArray(object3D.material)) {\n    object3D.material.forEach(fn);\n  } else {\n    fn(object3D.material);\n  }\n}\n\nexport function mapMaterials(object3D, fn) {\n  if (!object3D.material) return;\n\n  if (Array.isArray(object3D.material)) {\n    return object3D.material.map(fn);\n  } else {\n    return fn(object3D.material);\n  }\n}\n","const zeroPos = new THREE.Vector3(0, 0, 0);\nconst zeroQuat = new THREE.Quaternion();\nconst oneScale = new THREE.Vector3(1, 1, 1);\nconst identity = new THREE.Matrix4();\nidentity.identity();\n\n// Patch animation system\nconst bindingSetters = THREE.PropertyBinding.prototype.SetterByBindingTypeAndVersioning;\nconst Versioning = THREE.PropertyBinding.prototype.Versioning;\n\n// For all binding types, monkey patch the setters that require world matrix\n// updates to also flip matrixNeedsUpdate\nfor (let i = 0; i < bindingSetters.length; i++) {\n  const setter = bindingSetters[i][Versioning.MatrixWorldNeedsUpdate];\n  if (!setter) continue;\n\n  bindingSetters[i][Versioning.MatrixWorldNeedsUpdate] = function() {\n    const v = setter.apply(this, arguments);\n    this.targetObject.matrixNeedsUpdate = true;\n    return v;\n  };\n}\n\nTHREE.Object3D.prototype.getWorldPosition = function(target) {\n  if (target === undefined) {\n    console.warn(\"THREE.Object3D: .getWorldPosition() target is now required\");\n    target = new THREE.Vector3();\n  }\n\n  // New function, defined below (used instead of updateMatrixWorld)\n  this.updateMatrices();\n\n  return target.setFromMatrixPosition(this.matrixWorld);\n};\n\nTHREE.Object3D.prototype.getWorldQuaternion = (function() {\n  const position = new THREE.Vector3();\n  const scale = new THREE.Vector3();\n\n  return function getWorldQuaternion(target) {\n    if (target === undefined) {\n      console.warn(\"THREE.Object3D: .getWorldQuaternion() target is now required\");\n      target = new THREE.Quaternion();\n    }\n\n    // New function, defined below (used instead of updateMatrixWorld)\n    this.updateMatrices();\n    this.matrixWorld.decompose(position, target, scale);\n\n    return target;\n  };\n})();\n\nTHREE.Object3D.getWorldScale = (function() {\n  const position = new THREE.Vector3();\n  const quaternion = new THREE.Quaternion();\n\n  return function getWorldScale(target) {\n    if (target === undefined) {\n      console.warn(\"THREE.Object3D: .getWorldScale() target is now required\");\n      target = new THREE.Vector3();\n    }\n\n    // New function, defined below (used instead of updateMatrixWorld)\n    this.updateMatrices();\n    this.matrixWorld.decompose(position, quaternion, target);\n\n    return target;\n  };\n})();\n\nconst handleMatrixModification = o => {\n  if (!o.matrixIsModified) {\n    o.matrixIsModified = true;\n\n    if (o.cachedMatrixWorld) {\n      o.cachedMatrixWorld.copy(o.matrixWorld);\n      o.matrixWorld = o.cachedMatrixWorld;\n    }\n  }\n};\n\nconst updateMatrix = THREE.Object3D.prototype.updateMatrix;\nTHREE.Object3D.prototype.updateMatrix = function() {\n  updateMatrix.apply(this, arguments);\n  handleMatrixModification(this);\n};\n\nconst applyMatrix = THREE.Object3D.prototype.applyMatrix;\nTHREE.Object3D.prototype.applyMatrix = function() {\n  applyMatrix.apply(this, arguments);\n  handleMatrixModification(this);\n};\n\n// By the end of this function this.matrix reflects the updated local matrix\n// and this.matrixWorld reflects the updated world matrix, taking into account\n// parent matrices.\n//\n// forceLocalUpdate - Forces the local matrix to be updated regardless of if it has not\n// been marked dirty.\n//\n// forceWorldUpdate - Forces the world matrix to be updated regardless of if the local matrix\n// has been updated since the last update.\n//\n// skipParents - unless true, all parent matricies are updated before updating this object's\n// local and world matrix.\n//\nTHREE.Object3D.prototype.updateMatrices = function(forceLocalUpdate, forceWorldUpdate, skipParents) {\n  if (!this.hasHadFirstMatrixUpdate) {\n    if (\n      !this.position.equals(zeroPos) ||\n      !this.quaternion.equals(zeroQuat) ||\n      !this.scale.equals(oneScale) ||\n      !this.matrix.equals(identity)\n    ) {\n      // Only update the matrix the first time if its non-identity, this way\n      // this.matrixIsModified will remain false until the default\n      // identity matrix is updated.\n      this.updateMatrix();\n    }\n\n    this.hasHadFirstMatrixUpdate = true;\n    this.matrixWorldNeedsUpdate = true;\n    this.cachedMatrixWorld = this.matrixWorld;\n  } else if (this.matrixNeedsUpdate || this.matrixAutoUpdate || forceLocalUpdate) {\n    this.updateMatrix();\n    if (this.matrixNeedsUpdate) this.matrixNeedsUpdate = false;\n  }\n\n  if (!skipParents && this.parent) {\n    this.parent.updateMatrices(false, forceWorldUpdate, false);\n    this.matrixWorldNeedsUpdate = this.matrixWorldNeedsUpdate || this.parent.childrenNeedMatrixWorldUpdate;\n  }\n\n  if (this.matrixWorldNeedsUpdate || forceWorldUpdate) {\n    if (this.parent === null) {\n      this.matrixWorld.copy(this.matrix);\n    } else {\n      // If the matrix is unmodified, it is the identity matrix,\n      // and hence we can use the parent's world matrix directly.\n      //\n      // Note this assumes all callers will either not pass skipParents=true\n      // *or* will update the parent themselves beforehand as is done in\n      // updateMatrixWorld.\n      if (!this.matrixIsModified) {\n        this.matrixWorld = this.parent.matrixWorld;\n      } else {\n        // Once matrixIsModified === true, this.matrixWorld has been updated to be a local\n        // copy, not a reference to this.parent.matrixWorld (see updateMatrix/applyMatrix)\n        this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix);\n      }\n    }\n\n    this.childrenNeedMatrixWorldUpdate = true;\n    this.matrixWorldNeedsUpdate = false;\n  }\n};\n\n// Computes this object's matrices and then the recursively computes the matrices of all the children.\n//\n// forceWorldUpdate - If true and the object is visible, will force the world matrix to be updated for\n// this node and all of its children.\n//\n// includeInvisible - If true, does not ignore non-visible objects.\nTHREE.Object3D.prototype.updateMatrixWorld = function(forceWorldUpdate, includeInvisible) {\n  if (!this.visible && !includeInvisible) return;\n\n  // Do not recurse upwards, since this is recursing downwards\n  this.updateMatrices(false, forceWorldUpdate, true);\n\n  const children = this.children;\n  const forceChildrenWorldUpdate = this.childrenNeedMatrixWorldUpdate || forceWorldUpdate;\n\n  for (let i = 0, l = children.length; i < l; i++) {\n    children[i].updateMatrixWorld(forceChildrenWorldUpdate, includeInvisible);\n  }\n\n  if (this.childrenNeedMatrixWorldUpdate) this.childrenNeedMatrixWorldUpdate = false;\n};\n\n// Updates this function to use updateMatrices() to avoid extra matrix computations\nTHREE.Object3D.prototype.lookAt = (function() {\n  // This method does not support objects having non-uniformly-scaled parent(s)\n\n  const q1 = new THREE.Quaternion();\n  const m1 = new THREE.Matrix4();\n  const target = new THREE.Vector3();\n  const position = new THREE.Vector3();\n\n  return function lookAt(x, y, z) {\n    if (x.isVector3) {\n      target.copy(x);\n    } else {\n      target.set(x, y, z);\n    }\n\n    const parent = this.parent;\n\n    this.updateMatrices(); // hubs change\n\n    position.setFromMatrixPosition(this.matrixWorld);\n\n    if (this.isCamera || this.isLight) {\n      m1.lookAt(position, target, this.up);\n    } else {\n      m1.lookAt(target, position, this.up);\n    }\n\n    this.quaternion.setFromRotationMatrix(m1);\n\n    if (parent) {\n      m1.extractRotation(parent.matrixWorld);\n      q1.setFromRotationMatrix(m1);\n      this.quaternion.premultiply(q1.inverse());\n    }\n  };\n})();\n","AFRAME.registerComponent(\"ambient-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 }\n  },\n\n  init() {\n    const el = this.el;\n    this.light = new THREE.AmbientLight();\n    this.el.setObject3D(\"ambient-light\", this.light);\n    this.el.sceneEl.systems.light.registerLight(el);\n    this.rendererSystem = this.el.sceneEl.systems.renderer;\n  },\n\n  update(prevData) {\n    if (this.data.color !== prevData.color) {\n      this.light.color.set(this.data.color);\n      this.rendererSystem.applyColorCorrection(this.light.color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      this.light.intensity = this.data.intensity;\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"ambient-light\");\n  }\n});\n","/**\n * Sets the CSS class on an entity.\n * @component css-class\n */\nAFRAME.registerComponent(\"css-class\", {\n  schema: {\n    type: \"string\"\n  },\n  multiple: true,\n  init() {\n    this.el.classList.add(this.data);\n  },\n  update(oldData) {\n    if (this.data !== oldData) {\n      this.el.classList.remove(oldData);\n      this.el.classList.add(this.data);\n    }\n  },\n  remove() {\n    this.el.classList.remove(this.data);\n  }\n});\n","/* global CANNON */\n/**\n * Floats a duck based on its scale.\n * @component duck\n */\nAFRAME.registerComponent(\"duck\", {\n  schema: {\n    initialForce: { default: 0 },\n    maxForce: { default: 6.5 },\n    maxScale: { default: 5 }\n  },\n\n  init: function() {\n    this.physicsSystem = this.el.sceneEl.systems.physics;\n    this.hasBody = false;\n    this.position = new CANNON.Vec3();\n    this.force = new CANNON.Vec3(0, this.data.initialForce, 0);\n    this.initialScale = this.el.object3D.scale.x;\n    this.maxScale = this.data.maxScale * this.initialScale;\n  },\n\n  play: function() {\n    this.physicsSystem.addComponent(this);\n  },\n\n  pause: function() {\n    this.physicsSystem.removeComponent(this);\n  },\n\n  beforeStep: function() {\n    if (this.el.body && NAF.utils.isMine(this.el)) {\n      const currentScale = this.el.object3D.scale.x;\n      const ratio = Math.min(1, (currentScale - this.initialScale) / (this.maxScale - this.initialScale));\n      const force = ratio * this.data.maxForce;\n      if (force > 0) {\n        const angle = Math.random() * Math.PI * 2;\n        const x = Math.cos(angle);\n        const z = Math.sin(angle);\n        this.force.set(x, force, z);\n        this.position.set(x * 0.01, 0, z * 0.01);\n        this.el.object3D.matrixNeedsUpdate = true;\n        this.el.body.applyForce(this.force, this.position);\n      }\n    }\n  }\n});\n","/* global CANNON */\nAFRAME.registerComponent(\"heightfield\", {\n  init() {\n    this.el.addEventListener(\"componentinitialized\", e => {\n      if (e.detail.name === \"static-body\") {\n        this.generateAndAddHeightfield(this.el.components[\"static-body\"]);\n      }\n    });\n    this.el.setAttribute(\"static-body\", { shape: \"none\", mass: 0 });\n  },\n  generateAndAddHeightfield(body) {\n    const { offset, distance, data } = this.data;\n\n    const orientation = new CANNON.Quaternion();\n    orientation.setFromAxisAngle(new CANNON.Vec3(1, 0, 0), -Math.PI / 2);\n\n    const rotation = new CANNON.Quaternion();\n    rotation.setFromAxisAngle(new CANNON.Vec3(0, 1, 0), -Math.PI / 2);\n    rotation.mult(orientation, orientation);\n\n    const cannonOffset = new CANNON.Vec3(offset.x, offset.y, offset.z);\n\n    const shape = new CANNON.Heightfield(data, { elementSize: distance });\n\n    body.addShape(shape, cannonOffset, orientation);\n  }\n});\n","AFRAME.registerComponent(\"hemisphere-light\", {\n  schema: {\n    skyColor: { type: \"color\" },\n    groundColor: { type: \"color\" },\n    intensity: { default: 1.0 }\n  },\n\n  init() {\n    const el = this.el;\n    this.light = new THREE.HemisphereLight();\n    this.light.position.set(0, 0, 0);\n    this.light.matrixNeedsUpdate = true;\n    this.el.setObject3D(\"hemisphere-light\", this.light);\n    this.el.sceneEl.systems.light.registerLight(el);\n  },\n\n  update(prevData) {\n    if (this.data.skyColor !== prevData.skyColor) {\n      this.light.color.set(this.data.skyColor);\n    }\n\n    if (this.data.groundColor !== prevData.groundColor) {\n      this.light.groundColor.set(this.data.groundColor);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      this.light.intensity = this.data.intensity;\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"hemisphere-light\");\n  }\n});\n","/**\n * Hides entities based on the scene's quality mode\n * @namespace environment\n * @component hide-when-quality\n */\nAFRAME.registerComponent(\"hide-when-quality\", {\n  schema: { type: \"string\", default: \"low\" },\n\n  init() {\n    this.onQualityChanged = this.onQualityChanged.bind(this);\n    this.el.sceneEl.addEventListener(\"quality-changed\", this.onQualityChanged);\n  },\n\n  onQualityChanged(event) {\n    this.updateComponentState(event.detail);\n  },\n\n  update(oldData) {\n    if (this.data !== oldData) {\n      this.updateComponentState(window.APP.quality);\n    }\n  },\n\n  updateComponentState(quality) {\n    this.el.setAttribute(\"visible\", quality !== this.data);\n  }\n});\n","AFRAME.registerComponent(\"point-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 },\n    range: { default: 0 },\n    decay: { default: 2 },\n    castShadow: { default: true },\n    shadowMapResolution: { default: [512, 512] },\n    shadowBias: { default: 0 },\n    shadowRadius: { default: 1 }\n  },\n\n  init() {\n    const el = this.el;\n    this.light = new THREE.PointLight();\n    this.light.shadow.camera.matrixAutoUpdate = true;\n    this.el.setObject3D(\"point-light\", this.light);\n    this.el.sceneEl.systems.light.registerLight(el);\n    this.rendererSystem = this.el.sceneEl.systems.renderer;\n  },\n\n  update(prevData) {\n    const light = this.light;\n\n    if (this.data.color !== prevData.color) {\n      const color = new THREE.Color(this.data.color);\n      this.rendererSystem.applyColorCorrection(color);\n      light.color.copy(color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      light.intensity = this.data.intensity;\n    }\n\n    if (this.data.range !== prevData.range) {\n      light.distance = this.data.range;\n    }\n\n    if (this.data.decay !== prevData.decay) {\n      light.decay = this.data.decay;\n    }\n\n    if (this.data.castShadow !== prevData.castShadow) {\n      light.castShadow = this.data.castShadow;\n    }\n\n    if (this.data.shadowBias !== prevData.shadowBias) {\n      light.shadow.bias = this.data.shadowBias;\n    }\n\n    if (this.data.shadowRadius !== prevData.shadowRadius) {\n      light.shadow.radius = this.data.shadowRadius;\n    }\n\n    const [width, height] = this.data.shadowMapResolution;\n    const [prevWidth, prevHeight] = prevData.shadowMapResolution ? prevData.shadowMapResolution : [512, 512];\n\n    if (width !== prevWidth || height !== prevHeight) {\n      light.shadow.mapSize.set(width, height);\n\n      if (light.shadow.map) {\n        light.shadow.map.dispose();\n        light.shadow.map = null;\n      }\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"point-light\");\n  }\n});\n","/**\n * Nicely pans the camera for previewing a scene. There's some weirdness with this right now\n * since it ends up panning in a direction dependent upon the start camera orientation,\n * but it's good enough for now.\n */\nfunction lerp(start, end, t) {\n  return (1 - t) * start + t * end;\n}\n\nconst newRot = new THREE.Quaternion();\n\nAFRAME.registerComponent(\"scene-preview-camera\", {\n  schema: {\n    duration: { default: 90, type: \"number\" },\n    positionOnly: { default: false, type: \"boolean\" }\n  },\n\n  init: function() {\n    this.startPoint = this.el.object3D.position.clone();\n    this.startRotation = new THREE.Quaternion();\n    this.startRotation.setFromEuler(this.el.object3D.rotation);\n\n    this.targetPoint = new THREE.Vector3(1, 0.5, -0.5);\n    this.targetPoint.applyMatrix4(this.el.object3D.matrix);\n    this.targetPoint.add(new THREE.Vector3(0, 0, -2));\n\n    const targetRotDelta = new THREE.Euler(-0.15, 0.0, 0.15);\n    this.targetRotation = new THREE.Quaternion();\n    this.targetRotation.setFromEuler(targetRotDelta);\n    this.targetRotation.premultiply(this.startRotation);\n\n    this.startTime = performance.now();\n    this.backwards = false;\n    this.ranOnePass = false;\n  },\n\n  tick: function() {\n    let t = (performance.now() - this.startTime) / (1000.0 * this.data.duration);\n    t = Math.min(1.0, Math.max(0.0, t));\n\n    if (!this.ranOnePass) {\n      t = t * (2 - t);\n    } else {\n      t = t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n    }\n\n    const from = this.backwards ? this.targetPoint : this.startPoint;\n    const to = this.backwards ? this.startPoint : this.targetPoint;\n    const fromRot = this.backwards ? this.targetRotation : this.startRotation;\n    const toRot = this.backwards ? this.startRotation : this.targetRotation;\n\n    THREE.Quaternion.slerp(fromRot, toRot, newRot, t);\n\n    this.el.object3D.position.set(lerp(from.x, to.x, t), lerp(from.y, to.y, t), lerp(from.z, to.z, t));\n\n    if (!this.data.positionOnly) {\n      this.el.object3D.rotation.setFromQuaternion(newRot);\n    }\n\n    this.el.object3D.matrixNeedsUpdate = true;\n\n    if (t >= 0.9999) {\n      this.ranOnePass = true;\n      this.backwards = !this.backwards;\n      this.startTime = performance.now();\n    }\n  }\n});\n","// Enumeration of spawned object content origins. URL means the content is\n// fetched from a URL, FILE means it was an uploaded/dropped file, and\n// CLIPBOARD means it was raw data pasted in from the clipboard, SPAWNER means\n// it was copied over from a spawner.\nexport const ObjectContentOrigins = {\n  URL: 1,\n  FILE: 2,\n  CLIPBOARD: 3,\n  SPAWNER: 4\n};\n\n// Enumeration of spawnable object types, used for telemetry, which encapsulates\n// both the origin of the content for the object and also the type of content\n// contained in the object.\nexport const ObjectTypes = {\n  URL_IMAGE: 0,\n  URL_VIDEO: 1,\n  URL_MODEL: 2,\n  URL_PDF: 3,\n  URL_AUDIO: 4,\n  //URL_TEXT: 5,\n  //URL_TELEPORTER: 6,\n  FILE_IMAGE: 8,\n  FILE_VIDEO: 9,\n  FILE_MODEL: 10,\n  FILE_PDF: 11,\n  FILE_AUDIO: 12,\n  //FILE_TEXT: 13,\n  CLIPBOARD_IMAGE: 16,\n  CLIPBOARD_VIDEO: 17,\n  CLIPBOARD_MODEL: 18,\n  CLIPBOARD_PDF: 19,\n  CLIPBOARD_AUDIO: 20,\n  //CLIPBOARD_TEXT: 21,\n  SPAWNER_IMAGE: 24,\n  SPAWNER_VIDEO: 25,\n  SPAWNER_MODEL: 26,\n  SPAWNER_PDF: 27,\n  SPAWNER_AUDIO: 28,\n  //SPAWNER_TEXT: 29,\n  CAMERA: 30,\n  UNKNOWN: 31\n};\n\n// Given an origin and three object type values for URL, FILE, and CLIPBOARD\n// origins respectively, return the appropriate one\nfunction objectTypeForOrigin(contentOrigin, urlType, fileType, clipboardType, spawnerType) {\n  if (contentOrigin === ObjectContentOrigins.URL) {\n    return urlType;\n  } else if (contentOrigin === ObjectContentOrigins.FILE) {\n    return fileType;\n  } else if (contentOrigin === ObjectContentOrigins.CLIPBOARD) {\n    return clipboardType;\n  } else {\n    return spawnerType;\n  }\n}\n\n// Lookup table of mime-type prefixes to the set of object types that we should use\n// for objects spawned matching their underlying Content-Type.\nconst objectTypeMimePrefixLookupMap = {\n  \"image/\": [ObjectTypes.URL_IMAGE, ObjectTypes.FILE_IMAGE, ObjectTypes.CLIPBOARD_IMAGE, ObjectTypes.SPAWNER_IMAGE],\n  \"model/\": [ObjectTypes.URL_MODEL, ObjectTypes.FILE_MODEL, ObjectTypes.CLIPBOARD_MODEL, ObjectTypes.SPAWNER_MODEL],\n  \"application/x-zip-compressed\": [\n    ObjectTypes.URL_MODEL,\n    ObjectTypes.FILE_MODEL,\n    ObjectTypes.CLIPBOARD_MODEL,\n    ObjectTypes.SPAWNER_MODEL\n  ],\n  \"video/\": [ObjectTypes.URL_VIDEO, ObjectTypes.FILE_VIDEO, ObjectTypes.CLIPBOARD_VIDEO, ObjectTypes.SPAWNER_VIDEO],\n  \"application/vnd.apple.mpegurl\": [\n    ObjectTypes.URL_VIDEO,\n    ObjectTypes.FILE_VIDEO,\n    ObjectTypes.CLIPBOARD_VIDEO,\n    ObjectTypes.SPAWNER_VIDEO\n  ],\n  \"application/x-mpegurl\": [\n    ObjectTypes.URL_VIDEO,\n    ObjectTypes.FILE_VIDEO,\n    ObjectTypes.CLIPBOARD_VIDEO,\n    ObjectTypes.SPAWNER_VIDEO\n  ],\n  \"audio/\": [ObjectTypes.URL_AUDIO, ObjectTypes.FILE_AUDIO, ObjectTypes.CLIPBOARD_AUDIO, ObjectTypes.SPAWNER_AUDIO],\n  \"application/pdf\": [ObjectTypes.URL_PDF, ObjectTypes.FILE_PDF, ObjectTypes.CLIPBOARD_PDF, ObjectTypes.SPAWNER_PDF]\n};\n\nconst srcSuffixLookupMap = {\n  \".m3u8\": [ObjectTypes.URL_VIDEO, ObjectTypes.FILE_VIDEO, ObjectTypes.CLIPBOARD_VIDEO, ObjectTypes.SPAWNER_VIDEO]\n};\n\n// Given an content origin and the resolved mime type of a piece of content, return\n// the ObjectType, if any, for that content.\nexport function objectTypeForOriginAndContentType(contentOrigin, contentType, src) {\n  for (const prefix in objectTypeMimePrefixLookupMap) {\n    if (contentType.toLowerCase().startsWith(prefix)) {\n      const types = objectTypeMimePrefixLookupMap[prefix];\n      return objectTypeForOrigin(contentOrigin, ...types);\n    }\n  }\n\n  if (src) {\n    for (const suffix in srcSuffixLookupMap) {\n      if (src.toLowerCase().endsWith(suffix)) {\n        const types = srcSuffixLookupMap[suffix];\n        return objectTypeForOrigin(contentOrigin, ...types);\n      }\n    }\n  }\n\n  return ObjectTypes.UNKNOWN;\n}\n","AFRAME.registerComponent(\"spot-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 },\n    range: { default: 0 },\n    decay: { default: 2 },\n    innerConeAngle: { default: 0 },\n    outerConeAngle: { default: Math.PI / 4.0 },\n    castShadow: { default: true },\n    shadowMapResolution: { default: [512, 512] },\n    shadowBias: { default: 0 },\n    shadowRadius: { default: 1 }\n  },\n\n  init() {\n    const el = this.el;\n    this.light = new THREE.SpotLight();\n    this.light.position.set(0, 0, 0);\n    this.light.target.position.set(0, 0, 1);\n    this.light.add(this.light.target);\n    this.light.matrixNeedsUpdate = true;\n    this.light.target.matrixNeedsUpdate = true;\n    this.el.setObject3D(\"spot-light\", this.light);\n    this.el.sceneEl.systems.light.registerLight(el);\n  },\n\n  update(prevData) {\n    const light = this.light;\n\n    if (this.data.color !== prevData.color) {\n      light.color.set(this.data.color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      light.intensity = this.data.intensity;\n    }\n\n    if (this.data.range !== prevData.range) {\n      light.distance = this.data.range;\n    }\n\n    if (this.data.decay !== prevData.decay) {\n      light.decay = this.data.decay;\n    }\n\n    if (this.data.innerConeAngle !== prevData.innerConeAngle || this.data.outerConeAngle !== prevData.outerConeAngle) {\n      light.angle = this.data.outerConeAngle;\n      light.penumbra = 1.0 - this.data.innerConeAngle / this.data.outerConeAngle;\n    }\n\n    if (this.data.castShadow !== prevData.castShadow) {\n      light.castShadow = this.data.castShadow;\n    }\n\n    if (this.data.shadowBias !== prevData.shadowBias) {\n      light.shadow.bias = this.data.shadowBias;\n    }\n\n    if (this.data.shadowRadius !== prevData.shadowRadius) {\n      light.shadow.radius = this.data.shadowRadius;\n    }\n\n    const [width, height] = this.data.shadowMapResolution;\n    const [prevWidth, prevHeight] = prevData.shadowMapResolution ? prevData.shadowMapResolution : [512, 512];\n\n    if (width !== prevWidth || height !== prevHeight) {\n      light.shadow.mapSize.set(width, height);\n\n      if (light.shadow.map) {\n        light.shadow.map.dispose();\n        light.shadow.map = null;\n      }\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"spot-light\");\n  }\n});\n","/* global AFRAME */\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\n\nAFRAME.registerComponent(\"floaty-object\", {\n  schema: {\n    // Make the object locked/kinematic upon load\n    autoLockOnLoad: { default: false },\n\n    // Make the object kinematic immediately upon release\n    autoLockOnRelease: { default: false },\n\n    // On release, modify the gravity based upon gravitySpeedLimit. If less than this, let the object float\n    // otherwise apply releaseGravity.\n    modifyGravityOnRelease: { default: false },\n\n    // Gravity to apply if object is thrown at a speed greated than speed limit.\n    releaseGravity: { default: -2 },\n\n    // If true, the degree to which angular rotation is allowed when floating is reduced (useful for 2d media)\n    reduceAngularFloat: { default: false },\n\n    // Velocity speed limit under which gravity will not be added if modifyGravityOnRelease is true\n    gravitySpeedLimit: { default: 1.85 } // Set to 0 to never apply gravity\n  },\n\n  init() {\n    this.onGrab = this.onGrab.bind(this);\n    this.onRelease = this.onRelease.bind(this);\n  },\n\n  tick() {\n    if (!this.ammoBody) {\n      this.ammoBody = this.el.components[\"ammo-body\"];\n    }\n\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const isHeld = interaction.isHeld(this.el);\n    if (isHeld && !this.wasHeld) {\n      this.onGrab();\n    }\n    if (this.wasHeld && !isHeld) {\n      this.onRelease();\n    }\n\n    if (this._makeStaticWhenAtRest) {\n      const isMine = this.el.components.networked && NAF.utils.isMine(this.el);\n      const linearThreshold = this.ammoBody.data.linearSleepingThreshold;\n      const angularThreshold = this.ammoBody.data.angularSleepingThreshold;\n      const isAtRest =\n        this.ammoBody.body.getLinearVelocity().length2() < linearThreshold * linearThreshold &&\n        this.ammoBody.body.getAngularVelocity().length2() < angularThreshold * angularThreshold;\n\n      if (isAtRest && isMine) {\n        this.el.setAttribute(\"ammo-body\", { type: \"static\" });\n      }\n\n      if (isAtRest || !isMine) {\n        this._makeStaticWhenAtRest = false;\n      }\n    }\n\n    this.wasHeld = isHeld;\n  },\n\n  play() {\n    // We do this in play instead of in init because otherwise NAF.utils.isMine fails\n    if (this.hasBeenHereBefore) return;\n    this.hasBeenHereBefore = true;\n    if (this.el.body) {\n      this._onBodyLoaded();\n    } else {\n      this._onBodyLoaded = this._onBodyLoaded.bind(this);\n      this.el.addEventListener(\"body-loaded\", this._onBodyLoaded, { once: true });\n    }\n  },\n\n  setLocked(locked) {\n    if (this.el.components.networked && !NAF.utils.isMine(this.el)) return;\n\n    this.locked = locked;\n    this.el.setAttribute(\"ammo-body\", { type: locked ? \"kinematic\" : \"dynamic\" });\n  },\n\n  _onBodyLoaded() {\n    if (this.data.autoLockOnLoad) {\n      this.setLocked(true);\n    }\n  },\n\n  onRelease() {\n    if (this.data.modifyGravityOnRelease) {\n      if (\n        this.data.gravitySpeedLimit === 0 ||\n        this.ammoBody.getVelocity().length2() < this.data.gravitySpeedLimit * this.data.gravitySpeedLimit\n      ) {\n        this.el.setAttribute(\"ammo-body\", {\n          gravity: { x: 0, y: 0, z: 0 },\n          angularDamping: this.data.reduceAngularFloat ? 0.98 : 0.5,\n          linearDamping: 0.95,\n          linearSleepingThreshold: 0.1,\n          angularSleepingThreshold: 0.1\n        });\n\n        this._makeStaticWhenAtRest = true;\n      } else {\n        this.el.setAttribute(\"ammo-body\", {\n          gravity: { x: 0, y: this.data.releaseGravity, z: 0 },\n          angularDamping: 0.01,\n          linearDamping: 0.01,\n          linearSleepingThreshold: 1.6,\n          angularSleepingThreshold: 2.5\n        });\n      }\n    }\n\n    if (this.data.autoLockOnRelease) {\n      this.setLocked(true);\n    }\n\n    this.el.setAttribute(\"ammo-body\", { collisionFilterMask: COLLISION_LAYERS.DEFAULT_INTERACTABLE });\n  },\n\n  onGrab() {\n    this.el.setAttribute(\"ammo-body\", {\n      collisionFilterMask: this.locked ? COLLISION_LAYERS.HANDS : COLLISION_LAYERS.DEFAULT_INTERACTABLE\n    });\n    this.setLocked(false);\n  },\n\n  remove() {\n    this.el.removeEventListener(\"body-loaded\", this._onBodyLoaded);\n    if (this.stuckTo) {\n      const stuckTo = this.stuckTo;\n      delete this.stuckTo;\n      stuckTo._unstickObject();\n    }\n  }\n});\n","const sizeVec = new THREE.Vector3();\nconst boundingBoxWorldPositionVec = new THREE.Vector3();\nconst colliderWorldPositionVec = new THREE.Vector3();\n\nAFRAME.registerComponent(\"trigger-volume\", {\n  schema: {\n    colliders: { type: \"selectorAll\" },\n    size: { type: \"vec3\", default: { x: 1, y: 1, z: 1 } },\n    target: { type: \"selector\" },\n    enterComponent: { type: \"string\" },\n    enterProperty: { type: \"string\" },\n    enterValue: {\n      default: \"\",\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\n      stringify: JSON.stringify\n    },\n    leaveComponent: { type: \"string\" },\n    leaveProperty: { type: \"string\" },\n    leaveValue: {\n      default: \"\",\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\n      stringify: JSON.stringify\n    }\n  },\n  init() {\n    this.boundingBox = new THREE.Box3();\n    this.collidingLastFrame = {};\n  },\n  update() {\n    this.el.object3D.getWorldPosition(boundingBoxWorldPositionVec);\n    sizeVec.copy(this.data.size);\n    this.boundingBox.setFromCenterAndSize(boundingBoxWorldPositionVec, sizeVec);\n  },\n  tick() {\n    const colliders = this.data.colliders;\n\n    for (let i = 0; i < colliders.length; i++) {\n      const collider = colliders[i];\n      const object3D = collider.object3D;\n\n      object3D.getWorldPosition(colliderWorldPositionVec);\n      const isColliding = this.boundingBox.containsPoint(colliderWorldPositionVec);\n      const collidingLastFrame = this.collidingLastFrame[object3D.id];\n\n      if (isColliding && !collidingLastFrame) {\n        this.data.target.setAttribute(this.data.enterComponent, this.data.enterProperty, this.data.enterValue);\n      } else if (!isColliding && collidingLastFrame) {\n        this.data.target.setAttribute(this.data.leaveComponent, this.data.leaveProperty, this.data.leaveValue);\n      }\n\n      this.collidingLastFrame[object3D.id] = isColliding;\n    }\n  }\n});\n","// HACK: Setting videoPaused on media-video doesn't work if you are the owner.\n// This component gets around that by calling .togglePlaying() to play/pause the video based on a property change.\nAFRAME.registerComponent(\"video-pause-state\", {\n  schema: {\n    paused: { default: false }\n  },\n\n  init() {\n    this.onPauseStateChange = this.onPauseStateChange.bind(this);\n    this.videoComponent = this.el.components[\"media-video\"];\n\n    if (this.videoComponent) {\n      this.onVideoLoaded();\n    } else {\n      this.onVideoLoaded = this.onVideoLoaded.bind(this);\n      this.el.addEventListener(\"video-loaded\", this.onVideoLoaded);\n    }\n  },\n\n  onVideoLoaded() {\n    this.videoComponent = this.el.components[\"media-video\"];\n    this.video = this.videoComponent.video;\n    this.video.addEventListener(\"pause\", this.onPauseStateChange);\n  },\n\n  onPauseStateChange() {\n    this.el.setAttribute(\"paused\", this.video.paused);\n  },\n\n  update() {\n    if (this.video && this.data.paused !== this.video.paused) {\n      this.videoComponent.togglePlaying();\n    }\n  },\n\n  remove() {\n    this.video.removeEventListener(\"pause\", this.onPauseStateChange);\n    this.el.removeEventListener(\"video-loaded\", this.onVideoLoaded);\n  }\n});\n","/**\n * Logs all events dispatched on an entity\n * @namespace debug\n * @component log-events\n */\nAFRAME.registerComponent(\"log-events\", {\n  init: function() {\n    const el = this.el;\n    const log = this.log.bind(this);\n    const origDispatch = this.el.dispatchEvent;\n    this.el.dispatchEvent = function() {\n      log(Array.from(arguments));\n      return origDispatch.apply(el, arguments);\n    };\n  },\n  log: function([e]) {\n    if ([\"componentchanged\"].includes(e.type)) return;\n    let firstObject = true;\n    const replacer = (k, x) => {\n      if (!x) return x;\n      if (typeof x === \"object\" && x.length === undefined) {\n        if (firstObject) {\n          firstObject = false;\n          return x;\n        }\n        return \"[object]\";\n      }\n      return x;\n    };\n    console.info(`log-events: ${this.el.id} ${e.type} ${JSON.stringify(e.detail, replacer)}`);\n  }\n});\n\n/**\n * Logs all life cycle phases on an entity.\n * @namespace debug\n * @component lifecycle-checker\n */\nAFRAME.registerComponent(\"lifecycle-checker\", {\n  schema: {\n    name: { type: \"string\" },\n    tick: { default: false }\n  },\n  init: function() {\n    this.log(\"init\");\n  },\n  update: function() {\n    this.log(\"update\");\n  },\n  tick: function() {\n    if (this.data.tick) {\n      this.log(\"tick\");\n    }\n  },\n  remove: function() {\n    this.log(\"remove\");\n  },\n  pause: function() {\n    this.log(\"pause\");\n  },\n  play: function() {\n    this.log(\"play\");\n  },\n\n  log: function(method) {\n    console.info(`lifecycle-checker:${this.data.name} ${method}`);\n  }\n});\n","const { Pathfinding } = require(\"three-pathfinding\");\n\nAFRAME.registerSystem(\"nav\", {\n  init: function() {\n    this.pathfinder = new Pathfinding();\n  },\n\n  loadMesh: function(mesh, zone) {\n    this.el.object3D.updateMatrixWorld();\n\n    if (this.mesh && this.mesh.geometry && this.mesh.geometry.dispose) {\n      this.mesh.geometry.dispose();\n    }\n\n    this.mesh = mesh;\n    const geometry = new THREE.Geometry().fromBufferGeometry(mesh.geometry);\n    geometry.applyMatrix(mesh.matrixWorld);\n    this.pathfinder.setZoneData(zone, Pathfinding.createZone(geometry));\n    this.el.sceneEl.emit(\"nav-mesh-loaded\");\n  }\n});\n","/**\n * Listens to events from an event source and re-emits them on this entity\n * @component event-repeater\n */\nAFRAME.registerComponent(\"event-repeater\", {\n  schema: {\n    eventSource: { type: \"selector\" },\n    events: { type: \"array\" }\n  },\n\n  play: function() {\n    this.data.eventListeners = [];\n    const events = this.data.events;\n    for (let i = 0; i < events.length; i++) {\n      const event = events[i];\n      this.data.eventListeners[event] = this._handleEvent.bind(this, event);\n      this.data.eventSource.addEventListener(event, this.data.eventListeners[event]);\n    }\n  },\n\n  pause: function() {\n    const events = this.data.events;\n    for (let i = 0; i < events.length; i++) {\n      const event = events[i];\n      this.data.eventSource.removeEventListener(event, this.data.eventListeners[event]);\n    }\n    this.data.eventListeners = [];\n  },\n\n  _handleEvent: function(event, e) {\n    this.el.emit(event, e.detail);\n  }\n});\n","import Raven from \"raven-js\";\n\nconst ga = window.ga;\n\nexport default function registerTelemetry(trackedPage, trackedTitle) {\n  const sentryDsn = process.env.SENTRY_DSN;\n  const gaTrackingId = process.env.GA_TRACKING_ID;\n\n  if (sentryDsn) {\n    console.log(\"Tracking: Sentry DSN: \" + sentryDsn);\n    Raven.config(sentryDsn).install();\n  }\n\n  if (ga && gaTrackingId) {\n    console.log(\"Tracking: Google Analytics ID: \" + gaTrackingId);\n\n    ga(\"create\", gaTrackingId, \"auto\");\n\n    if (trackedPage) {\n      ga(\"set\", \"page\", trackedPage);\n    }\n\n    if (trackedTitle) {\n      ga(\"set\", \"title\", trackedTitle);\n    }\n\n    ga(\"send\", \"pageview\");\n  }\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nexport const ReactAudioContext = React.createContext({});\n\nexport const hudHoverSound = \"play_sound-hud_hover_start\";\n\nexport const WithHoverSound = ({ sound, children }) => {\n  return (\n    <ReactAudioContext.Consumer>\n      {context => {\n        return React.cloneElement(children, {\n          onMouseEnter: e => {\n            if (context && context.playSound) {\n              context.playSound(sound || hudHoverSound);\n            }\n            children.props.onMouseEnter && children.props.onMouseEnter(e);\n          }\n        });\n      }}\n    </ReactAudioContext.Consumer>\n  );\n};\n\nWithHoverSound.propTypes = {\n  children: PropTypes.object,\n  sound: PropTypes.string\n};\n","const boundingBox = new THREE.Box3();\nconst frustumBox = new THREE.Box3();\nconst inverseLightMatrixWorld = new THREE.Matrix4();\nconst tempBox = new THREE.Box3();\nconst FRUSTUM_PADDING = 1;\nconst NEAR_CLIPPING_PLANE = -500;\nconst FAR_CLIPPING_PLANE = 500;\nconst verts = [\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3()\n];\n\nexport default function resizeShadowCameraFrustum(light, scene) {\n  // Reset bounding box\n  frustumBox.makeEmpty();\n  boundingBox.makeEmpty();\n\n  // Grow the extents of boundingBox for every geometry in the scene that has castShadow set to true.\n  scene.traverse(node => {\n    const geometry = node.geometry;\n\n    if (geometry && node.castShadow) {\n      if (!geometry.boundingBox) {\n        geometry.computeBoundingBox();\n      }\n\n      tempBox.copy(geometry.boundingBox);\n\n      // Apply matrix transforming bounding box from model space to world space\n      tempBox.applyMatrix4(node.matrixWorld);\n\n      boundingBox.union(tempBox);\n    }\n  });\n\n  // Transform the resulting bounding box from world space to light space.\n  // Construct a new bounding box in light space that contains the corners of the bounding box in world space.\n  const min = boundingBox.min;\n  const max = boundingBox.max;\n\n  verts[0].set(min.x, min.y, min.z);\n  verts[1].set(min.x, min.y, max.z);\n  verts[2].set(min.x, max.y, min.z);\n  verts[3].set(min.x, max.y, max.z);\n  verts[4].set(max.x, min.y, min.z);\n  verts[5].set(max.x, min.y, max.z);\n  verts[6].set(max.x, max.y, min.z);\n  verts[7].set(max.x, max.y, max.z);\n\n  inverseLightMatrixWorld.getInverse(light.shadow.camera.matrixWorld);\n\n  for (let i = 0; i < verts.length; i++) {\n    verts[i].applyMatrix4(inverseLightMatrixWorld);\n    frustumBox.expandByPoint(verts[i]);\n  }\n\n  // Update the camera frustum to fit the resulting bounding box.\n  // Everything in the frustum that has castShadow set to true will cast a shadow.\n  // Everything in the frustum that has receiveShadow set to true will receive a shadow.\n  // FRUSTUM_PADDING is added to avoid clipping the edges of shadows.\n  // TODO: Determine why shadows flicker when light is moved fast. The light's matrixWorld is probably being updated a frame behind.\n  const camera = light.shadow.camera;\n  camera.left = frustumBox.min.x - FRUSTUM_PADDING;\n  camera.right = frustumBox.max.x + FRUSTUM_PADDING;\n  camera.bottom = frustumBox.min.y - FRUSTUM_PADDING;\n  camera.top = frustumBox.max.y + FRUSTUM_PADDING;\n  camera.near = frustumBox.min.z + NEAR_CLIPPING_PLANE;\n  camera.far = frustumBox.max.z + FAR_CLIPPING_PLANE;\n  camera.updateProjectionMatrix();\n}\n","import resizeShadowCameraFrustum from \"../utils/resizeShadowCameraFrustum\";\n\nAFRAME.registerComponent(\"directional-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 },\n    castShadow: { default: true },\n    shadowMapResolution: { default: [512, 512] },\n    shadowBias: { default: 0 },\n    shadowRadius: { default: 1 }\n  },\n\n  init() {\n    const el = this.el;\n    this.light = new THREE.DirectionalLight();\n    this.light.position.set(0, 0, 0);\n    this.light.target.position.set(0, 0, 1);\n    this.light.add(this.light.target);\n    this.el.setObject3D(\"directional-light\", this.light);\n    this.el.sceneEl.systems.light.registerLight(el);\n    this.rendererSystem = this.el.sceneEl.systems.renderer;\n  },\n\n  update(prevData) {\n    const light = this.light;\n\n    if (this.data.color !== prevData.color) {\n      const color = new THREE.Color(this.data.color);\n      this.rendererSystem.applyColorCorrection(color);\n      light.color.copy(color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      light.intensity = this.data.intensity;\n    }\n\n    if (this.data.castShadow !== prevData.castShadow) {\n      light.castShadow = this.data.castShadow;\n    }\n\n    if (this.data.shadowBias !== prevData.shadowBias) {\n      light.shadow.bias = this.data.shadowBias;\n    }\n\n    if (this.data.shadowRadius !== prevData.shadowRadius) {\n      light.shadow.radius = this.data.shadowRadius;\n    }\n\n    const [width, height] = this.data.shadowMapResolution;\n    const [prevWidth, prevHeight] = prevData.shadowMapResolution ? prevData.shadowMapResolution : [512, 512];\n\n    if (width !== prevWidth || height !== prevHeight) {\n      light.shadow.mapSize.set(width, height);\n\n      if (light.shadow.map) {\n        light.shadow.map.dispose();\n        light.shadow.map = null;\n      }\n    }\n\n    this.light.shadow.camera.matrixNeedsUpdate = true;\n  },\n\n  tick() {\n    if (window.APP && window.APP.quality === \"low\") {\n      return;\n    }\n\n    resizeShadowCameraFrustum(this.light, this.el.sceneEl.object3D);\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"directional-light\");\n  }\n});\n","export const Layers = {\n  // Layers 0 - 2 reserverd by ThreeJS and AFrame.\n  reflection: 3\n};\n\n/**\n * Sets layer flags on the underlying Object3D\n * @namespace environment\n * @component layers\n */\nAFRAME.registerComponent(\"layers\", {\n  schema: {\n    reflection: { type: \"boolean\", default: false },\n    inWorldHud: { type: \"boolean\", default: false },\n    exclusive: { type: \"boolean\", default: false } // if true, only these layers will be set\n  },\n  init() {\n    this.update = this.update.bind(this);\n    this.el.addEventListener(\"model-loaded\", this.update);\n  },\n  update(oldData) {\n    const obj = this.el.object3D;\n\n    if (this.data.exclusive) {\n      obj.traverse(o => (o.layers.mask = 0));\n    }\n\n    for (const [name, layer] of Object.entries(Layers)) {\n      const oldValue = oldData[name];\n      const newValue = this.data[name];\n\n      if (oldValue !== newValue) {\n        if (newValue) {\n          obj.traverse(o => o.layers.enable(layer));\n        } else {\n          obj.traverse(o => o.layers.disable(layer));\n        }\n      }\n    }\n  },\n  remove() {\n    this.el.removeEventListener(\"model-loaded\", this.update);\n  }\n});\n","import { getBox, getScaleCoefficient } from \"../utils/auto-box-collider\";\nimport {\n  guessContentType,\n  proxiedUrlFor,\n  resolveUrl,\n  injectCustomShaderChunks,\n  isHubsRoomUrl,\n  isHubsSceneUrl\n} from \"../utils/media-utils\";\nimport { addAnimationComponents } from \"../utils/animation\";\nimport \"three/examples/js/loaders/GLTFLoader\";\nimport loadingObjectSrc from \"../assets/LoadingObject_Atom.glb\";\nimport { SOUND_MEDIA_LOADING, SOUND_MEDIA_LOADED } from \"../systems/sound-effects-system\";\n\nconst anime = require(\"animejs\");\n\nconst SHAPE = require(\"aframe-physics-system/src/constants\").SHAPE;\n\nconst gltfLoader = new THREE.GLTFLoader();\nlet loadingObject;\ngltfLoader.load(loadingObjectSrc, gltf => {\n  loadingObject = gltf;\n});\n\nconst fetchContentType = url => {\n  return fetch(url, { method: \"HEAD\" }).then(r => r.headers.get(\"content-type\"));\n};\n\nconst fetchMaxContentIndex = url => {\n  return fetch(url).then(r => parseInt(r.headers.get(\"x-max-content-index\")));\n};\n\nconst boundingBox = new THREE.Box3();\n\nAFRAME.registerComponent(\"media-loader\", {\n  schema: {\n    fileId: { type: \"string\" },\n    fileIsOwned: { type: \"boolean\" },\n    src: { type: \"string\" },\n    resize: { default: false },\n    resolve: { default: false },\n    contentType: { default: null },\n    animate: { default: true },\n    mediaOptions: {\n      default: {},\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\n      stringify: JSON.stringify\n    }\n  },\n\n  init() {\n    this.onError = this.onError.bind(this);\n    this.showLoader = this.showLoader.bind(this);\n    this.clearLoadingTimeout = this.clearLoadingTimeout.bind(this);\n    this.onMediaLoaded = this.onMediaLoaded.bind(this);\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.networkedEl = networkedEl;\n    });\n  },\n\n  updateScale: (function() {\n    const center = new THREE.Vector3();\n    return function(resize) {\n      const mesh = this.el.getObject3D(\"mesh\");\n      const box = getBox(this.el, mesh);\n      const scaleCoefficient = resize ? getScaleCoefficient(0.5, box) : 1;\n      mesh.scale.multiplyScalar(scaleCoefficient);\n      const { min, max } = box;\n      center.addVectors(min, max).multiplyScalar(0.5 * scaleCoefficient);\n      mesh.position.sub(center);\n      mesh.matrixNeedsUpdate = true;\n    };\n  })(),\n\n  removeShape(id) {\n    if (this.el.getAttribute(\"ammo-shape__\" + id)) {\n      this.el.removeAttribute(\"ammo-shape__\" + id);\n    }\n  },\n\n  tick(t, dt) {\n    if (this.loaderMixer) {\n      this.loaderMixer.update(dt / 1000);\n    }\n  },\n\n  remove() {\n    if (this.loadingSoundNode) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.stopSoundNode(this.loadingSoundNode);\n      this.loadingSoundNode = null;\n    }\n  },\n\n  onError() {\n    this.el.removeAttribute(\"gltf-model-plus\");\n    this.el.removeAttribute(\"media-pager\");\n    this.el.removeAttribute(\"media-video\");\n    this.el.setAttribute(\"media-image\", { src: \"error\" });\n    this.clearLoadingTimeout();\n  },\n\n  showLoader() {\n    if (this.el.object3DMap.mesh) {\n      this.clearLoadingTimeout();\n      return;\n    }\n    const useFancyLoader = !!loadingObject;\n    const mesh = useFancyLoader\n      ? loadingObject.scene.clone()\n      : new THREE.Mesh(new THREE.BoxGeometry(), new THREE.MeshBasicMaterial());\n    this.el.setObject3D(\"mesh\", mesh);\n    this.updateScale(true);\n    if (useFancyLoader) {\n      this.loaderMixer = new THREE.AnimationMixer(mesh);\n\n      this.loadingClip = this.loaderMixer.clipAction(loadingObject.animations[0]);\n      this.loadingScaleClip = this.loaderMixer.clipAction(\n        new THREE.AnimationClip(null, 1000, [\n          new THREE.VectorKeyframeTrack(\".scale\", [0, 0.2], [0, 0, 0, mesh.scale.x, mesh.scale.y, mesh.scale.z])\n        ])\n      );\n      setTimeout(() => {\n        if (!this.loaderMixer) return; // Animation/loader was stopped early\n        this.el.setAttribute(\"ammo-shape__loader\", { type: SHAPE.BOX });\n      }, 200);\n\n      this.loadingClip.play();\n      this.loadingScaleClip.play();\n    }\n    if (this.el.sceneEl.is(\"entered\") && (!this.networkedEl || NAF.utils.isMine(this.networkedEl))) {\n      this.loadingSoundNode = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundLooped(\n        SOUND_MEDIA_LOADING\n      );\n    }\n    delete this.showLoaderTimeout;\n  },\n\n  clearLoadingTimeout() {\n    clearTimeout(this.showLoaderTimeout);\n    if (this.loadingSoundNode) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.stopSoundNode(this.loadingSoundNode);\n      this.loadingSoundNode = null;\n    }\n    if (this.loaderMixer) {\n      this.loadingClip.stop();\n      this.loadingScaleClip.stop();\n      delete this.loaderMixer;\n      delete this.loadingScaleClip;\n      delete this.loadingClip;\n    }\n    delete this.showLoaderTimeout;\n    this.removeShape(\"loader\");\n  },\n\n  updateHoverableVisuals() {\n    const hoverableVisuals = this.el.components[\"hoverable-visuals\"];\n\n    if (hoverableVisuals) {\n      if (!this.injectedCustomShaderChunks) {\n        this.injectedCustomShaderChunks = true;\n        hoverableVisuals.uniforms = injectCustomShaderChunks(this.el.object3D);\n      }\n\n      boundingBox.setFromObject(this.el.object3DMap.mesh);\n      boundingBox.getBoundingSphere(hoverableVisuals.boundingSphere);\n    }\n  },\n\n  onMediaLoaded(physicsShape = null) {\n    const el = this.el;\n    this.clearLoadingTimeout();\n\n    if (this.el.sceneEl.is(\"entered\")) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_MEDIA_LOADED);\n    }\n\n    const finish = () => {\n      if (physicsShape) {\n        el.setAttribute(\"ammo-shape\", {\n          type: physicsShape,\n          minHalfExtent: 0.04\n        });\n      }\n\n      this.updateHoverableVisuals();\n\n      const pager = el.components[\"media-pager\"];\n\n      if (pager) {\n        pager.repositionToolbar();\n      }\n    };\n\n    if (this.data.animate) {\n      this.addMeshScaleAnimation(this.el.getObject3D(\"mesh\"), { x: 0.001, y: 0.001, z: 0.001 }, finish);\n    } else {\n      finish();\n    }\n  },\n\n  addMeshScaleAnimation(mesh, initialScale, onComplete) {\n    const config = {\n      duration: 400,\n      easing: \"easeOutElastic\",\n      elasticity: 400,\n      loop: 0,\n      round: false,\n      x: mesh.scale.x,\n      y: mesh.scale.y,\n      z: mesh.scale.z,\n      targets: [initialScale],\n      update: (function() {\n        const lastValue = {};\n        return function(anim) {\n          const value = anim.animatables[0].target;\n\n          value.x = Math.max(0.0001, value.x);\n          value.y = Math.max(0.0001, value.y);\n          value.z = Math.max(0.0001, value.z);\n\n          // For animation timeline.\n          if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\n            return;\n          }\n\n          lastValue.x = value.x;\n          lastValue.y = value.y;\n          lastValue.z = value.z;\n\n          mesh.scale.set(value.x, value.y, value.z);\n          mesh.matrixNeedsUpdate = true;\n        };\n      })(),\n      complete: onComplete\n    };\n\n    mesh.scale.copy(initialScale);\n    mesh.matrixNeedsUpdate = true;\n\n    return anime(config);\n  },\n\n  async update(oldData) {\n    try {\n      const { src } = this.data;\n\n      if (src !== oldData.src && !this.showLoaderTimeout) {\n        this.showLoaderTimeout = setTimeout(this.showLoader, 100);\n      }\n\n      if (!src) return;\n\n      let canonicalUrl = src;\n      let accessibleUrl = src;\n      let contentType = this.data.contentType;\n      let thumbnail;\n\n      if (this.data.resolve) {\n        const result = await resolveUrl(src);\n        canonicalUrl = result.origin;\n        // handle protocol relative urls\n        if (canonicalUrl.startsWith(\"//\")) {\n          canonicalUrl = location.protocol + canonicalUrl;\n        }\n        contentType = (result.meta && result.meta.expected_content_type) || contentType;\n        thumbnail = result.meta && result.meta.thumbnail && proxiedUrlFor(result.meta.thumbnail);\n      }\n\n      // todo: we don't need to proxy for many things if the canonical URL has permissive CORS headers\n      accessibleUrl = proxiedUrlFor(canonicalUrl, null);\n\n      // if the component creator didn't know the content type, we didn't get it from reticulum, and\n      // we don't think we can infer it from the extension, we need to make a HEAD request to find it out\n      contentType = contentType || guessContentType(canonicalUrl) || (await fetchContentType(accessibleUrl));\n\n      // We don't want to emit media_resolved for index updates.\n      if (src !== oldData.src) {\n        this.el.emit(\"media_resolved\", { src, raw: accessibleUrl, contentType });\n      }\n\n      if (\n        contentType.startsWith(\"video/\") ||\n        contentType.startsWith(\"audio/\") ||\n        AFRAME.utils.material.isHLS(canonicalUrl, contentType)\n      ) {\n        const parsedUrl = new URL(src);\n        const qsTime = parseInt(parsedUrl.searchParams.get(\"t\"));\n        const hashTime = parseInt(new URLSearchParams(parsedUrl.hash.substring(1)).get(\"t\"));\n        const startTime = hashTime || qsTime || 0;\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-image\");\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\n        this.el.addEventListener(\n          \"video-loaded\",\n          e => {\n            this.onMediaLoaded(e.detail.projection === \"flat\" ? SHAPE.BOX : null);\n          },\n          { once: true }\n        );\n        this.el.setAttribute(\n          \"media-video\",\n          Object.assign({}, this.data.mediaOptions, { src: accessibleUrl, time: startTime, contentType })\n        );\n        if (this.el.components[\"position-at-box-shape-border__freeze\"]) {\n          this.el.setAttribute(\"position-at-box-shape-border__freeze\", { dirs: [\"forward\", \"back\"] });\n        }\n      } else if (contentType.startsWith(\"image/\")) {\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-video\");\n        this.el.removeAttribute(\"media-pager\");\n        this.el.addEventListener(\n          \"image-loaded\",\n          e => {\n            this.onMediaLoaded(e.detail.projection === \"flat\" ? SHAPE.BOX : null);\n          },\n          { once: true }\n        );\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\n        this.el.setAttribute(\n          \"media-image\",\n          Object.assign({}, this.data.mediaOptions, { src: accessibleUrl, contentType })\n        );\n\n        if (this.el.components[\"position-at-box-shape-border__freeze\"]) {\n          this.el.setAttribute(\"position-at-box-shape-border__freeze\", { dirs: [\"forward\", \"back\"] });\n        }\n      } else if (contentType.startsWith(\"application/pdf\")) {\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-video\");\n        // two small differences:\n        // 1. we pass the canonical URL to the pager so it can easily make subresource URLs\n        // 2. we don't remove the media-image component -- media-pager uses that internally\n        this.el.setAttribute(\"media-pager\", Object.assign({}, this.data.mediaOptions, { src: canonicalUrl }));\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\n        this.el.addEventListener(\"image-loaded\", this.clearLoadingTimeout, { once: true });\n        this.el.addEventListener(\"preview-loaded\", () => this.onMediaLoaded(SHAPE.BOX), { once: true });\n\n        if (this.el.components[\"position-at-box-shape-border__freeze\"]) {\n          this.el.setAttribute(\"position-at-box-shape-border__freeze\", { dirs: [\"forward\", \"back\"] });\n        }\n      } else if (\n        contentType.includes(\"application/octet-stream\") ||\n        contentType.includes(\"x-zip-compressed\") ||\n        contentType.startsWith(\"model/gltf\")\n      ) {\n        this.el.removeAttribute(\"media-image\");\n        this.el.removeAttribute(\"media-video\");\n        this.el.removeAttribute(\"media-pager\");\n        this.el.addEventListener(\n          \"model-loaded\",\n          () => {\n            this.updateScale(this.data.resize);\n            this.onMediaLoaded(SHAPE.HULL);\n            addAnimationComponents(this.el);\n          },\n          { once: true }\n        );\n        this.el.addEventListener(\"model-error\", this.onError, { once: true });\n        this.el.setAttribute(\n          \"gltf-model-plus\",\n          Object.assign({}, this.data.mediaOptions, {\n            src: accessibleUrl,\n            contentType: contentType,\n            inflate: true,\n            modelToWorldScale: this.data.resize ? 0.0001 : 1.0\n          })\n        );\n      } else if (contentType.startsWith(\"text/html\")) {\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-video\");\n        this.el.removeAttribute(\"media-pager\");\n        this.el.addEventListener(\n          \"image-loaded\",\n          () => {\n            const mayChangeScene = this.el.sceneEl.systems.permissions.can(\"update_hub\");\n\n            if (isHubsRoomUrl(src) || (isHubsSceneUrl(src) && mayChangeScene)) {\n              this.el.setAttribute(\"hover-menu__hubs-item\", {\n                template: \"#hubs-destination-hover-menu\",\n                dirs: [\"forward\", \"back\"]\n              });\n            } else {\n              this.el.setAttribute(\"hover-menu__link\", { template: \"#link-hover-menu\", dirs: [\"forward\", \"back\"] });\n            }\n            this.onMediaLoaded(SHAPE.BOX);\n          },\n          { once: true }\n        );\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\n        this.el.setAttribute(\n          \"media-image\",\n          Object.assign({}, this.data.mediaOptions, { src: thumbnail, contentType: \"image/png\" })\n        );\n        if (this.el.components[\"position-at-box-shape-border__freeze\"]) {\n          this.el.setAttribute(\"position-at-box-shape-border__freeze\", { dirs: [\"forward\", \"back\"] });\n        }\n      } else {\n        throw new Error(`Unsupported content type: ${contentType}`);\n      }\n    } catch (e) {\n      console.error(\"Error adding media\", e);\n      this.onError();\n    }\n  }\n});\n\nAFRAME.registerComponent(\"media-pager\", {\n  schema: {\n    src: { type: \"string\" },\n    index: { default: 0 }\n  },\n\n  init() {\n    this.toolbar = null;\n    this.imageSrc = null;\n    this.onNext = this.onNext.bind(this);\n    this.onPrev = this.onPrev.bind(this);\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.networkedEl = networkedEl;\n    });\n\n    this.el.addEventListener(\"image-loaded\", async e => {\n      this.imageSrc = e.detail.src;\n      await this._ensureUI();\n      this.update();\n    });\n  },\n\n  async _ensureUI() {\n    if (this.hasSetupUI || !this.imageSrc) return;\n    this.hasSetupUI = true;\n\n    // unfortunately, since we loaded the page image in an img tag inside media-image, we have to make a second\n    // request for the same page to read out the max-content-index header\n    this.maxIndex = await fetchMaxContentIndex(this.imageSrc);\n    const template = document.getElementById(\"paging-toolbar\");\n    this.el.querySelector(\".interactable-ui\").appendChild(document.importNode(template.content, true));\n    this.toolbar = this.el.querySelector(\".paging-toolbar\");\n    // we have to wait a tick for the attach callbacks to get fired for the elements in a template\n    setTimeout(() => {\n      this.nextButton = this.el.querySelector(\".next-button [text-button]\");\n      this.prevButton = this.el.querySelector(\".prev-button [text-button]\");\n      this.pageLabel = this.el.querySelector(\".page-label\");\n\n      this.nextButton.object3D.addEventListener(\"interact\", this.onNext);\n      this.prevButton.object3D.addEventListener(\"interact\", this.onPrev);\n\n      this.update();\n      this.el.emit(\"preview-loaded\");\n    }, 0);\n  },\n\n  async update() {\n    if (!this.data.src) return;\n\n    const pageSrc = proxiedUrlFor(this.data.src, this.data.index);\n    this.el.setAttribute(\"media-image\", { src: pageSrc, contentType: \"image/png\" });\n\n    await this._ensureUI();\n\n    if (this.pageLabel) {\n      this.pageLabel.setAttribute(\"text\", \"value\", `${this.data.index + 1}/${this.maxIndex + 1}`);\n      this.repositionToolbar();\n    }\n  },\n\n  remove() {\n    if (this.toolbar) {\n      this.toolbar.parentNode.removeChild(this.toolbar);\n    }\n  },\n\n  onNext() {\n    if (!NAF.utils.isMine(this.networkedEl) && !NAF.utils.takeOwnership(this.networkedEl)) return;\n    this.el.setAttribute(\"media-pager\", \"index\", Math.min(this.data.index + 1, this.maxIndex));\n    this.el.emit(\"pager-page-changed\");\n  },\n\n  onPrev() {\n    if (!NAF.utils.isMine(this.networkedEl) && !NAF.utils.takeOwnership(this.networkedEl)) return;\n    this.el.setAttribute(\"media-pager\", \"index\", Math.max(this.data.index - 1, 0));\n    this.el.emit(\"pager-page-changed\");\n  },\n\n  repositionToolbar() {\n    const ammoShape = this.el.getAttribute(\"ammo-shape\");\n    if (!ammoShape) return;\n\n    this.toolbar.object3D.position.y = -0.7;\n    this.toolbar.object3D.matrixNeedsUpdate = true;\n  }\n});\n","import { SOUND_QUACK, SOUND_SPECIAL_QUACK } from \"../systems/sound-effects-system\";\n\nAFRAME.registerComponent(\"quack\", {\n  schema: {\n    quackPercentage: { default: 1 },\n    specialQuackPercentage: { default: 0.01 }\n  },\n\n  init: function() {\n    this._handleGrabStart = this._handleGrabStart.bind(this);\n  },\n\n  play: function() {\n    this.el.object3D.addEventListener(\"interact\", this._handleGrabStart);\n  },\n\n  pause: function() {\n    this.el.object3D.removeEventListener(\"interact\", this._handleGrabStart);\n  },\n\n  _handleGrabStart: function() {\n    const rand = Math.random();\n    if (rand < this.data.specialQuackPercentage) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SPECIAL_QUACK);\n    } else if (rand < this.data.quackPercentage) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_QUACK);\n    }\n  }\n});\n","import { getLastWorldPosition } from \"../utils/three-utils\";\n\n/**\n * Used on a player-rig to move the player to a random spawn point on entry.\n * @namespace avatar\n * @component spawn-controller\n */\nAFRAME.registerComponent(\"spawn-controller\", {\n  schema: {\n    target: { type: \"selector\" },\n    camera: { type: \"selector\", default: \"#player-camera\" },\n    playerHeight: { default: 1.6 },\n    loadedEvent: { type: \"string\" }\n  },\n  init() {\n    this.moveToSpawnPoint = this.moveToSpawnPoint.bind(this);\n    this.data.target.addEventListener(this.data.loadedEvent, this.moveToSpawnPoint);\n  },\n  moveToSpawnPoint() {\n    const spawnPoints = document.querySelectorAll(\"[spawn-point]\");\n\n    if (spawnPoints.length === 0) {\n      // Keep default position\n      return;\n    }\n\n    const camera = this.data.camera;\n    const spawnPointIndex = Math.round((spawnPoints.length - 1) * Math.random());\n    const spawnPoint = spawnPoints[spawnPointIndex];\n\n    getLastWorldPosition(spawnPoint.object3D, this.el.object3D.position);\n    this.el.object3D.rotation.copy(spawnPoint.object3D.rotation);\n\n    if (this.el.sceneEl.is(\"vr-mode\")) {\n      // Rotate the player rig such that the vr-camera faces forward.\n      this.el.object3D.rotation.y -= this.data.camera.object3D.rotation.y;\n    } else {\n      // Reset the camera transform in 2D mode.\n      camera.object3D.position.set(0, this.data.playerHeight, 0);\n      camera.object3D.rotation.set(0, 0, 0);\n      camera.object3D.matrixNeedsUpdate = true;\n    }\n\n    // Camera faces -Z direction. Flip rotation on Y axis to face the correct direction.\n    this.el.object3D.rotation.y += Math.PI;\n    this.el.object3D.matrixNeedsUpdate = true;\n\n    // Reset pitch-yaw-rotator after any scene-preview-camera rotation.\n    if (camera.components[\"pitch-yaw-rotator\"]) {\n      camera.components[\"pitch-yaw-rotator\"].set(camera.object3D.rotation.x, camera.object3D.rotation.y);\n    }\n  }\n});\n\n/**\n * Marks an entity as a potential spawn point.\n * @namespace environment\n * @component spawn-point\n */\nAFRAME.registerComponent(\"spawn-point\", {\n  init() {\n    this.el.object3D.visible = false;\n  }\n});\n","/* global require AFRAME THREE setTimeout clearTimeout */\nimport { addMedia } from \"../utils/media-utils\";\nimport { waitForEvent } from \"../utils/async-utils\";\nimport { ObjectContentOrigins } from \"../object-types\";\nimport { paths } from \"../systems/userinput/paths\";\n\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\n\n/**\n * Spawns networked objects when grabbed or when a specified event is fired.\n * @namespace network\n * @component super-spawner\n */\nAFRAME.registerComponent(\"super-spawner\", {\n  schema: {\n    /**\n     * Source of the media asset the spawner will spawn when grabbed. This can be a gltf, video, or image, or a url that the reticiulm media API can resolve to a gltf, video, or image.\n     */\n    src: { default: \"\" },\n\n    /**\n     * Whether to use the Reticulum media resolution API to interpret the src URL (e.g. find a video URL for Youtube videos.)\n     */\n    resolve: { default: false },\n\n    /**\n     * Whether to resize the media on load.\n     */\n    resize: { default: false },\n\n    /**\n     * The template to use for this object\n     */\n    template: { default: \"\" },\n\n    /**\n     * Spawn the object at a custom position, rather than at the center of the spanwer.\n     */\n    useCustomSpawnPosition: { default: false },\n    spawnPosition: { type: \"vec3\" },\n\n    /**\n     * Spawn the object with a custom orientation, rather than copying that of the spawner.\n     */\n    useCustomSpawnRotation: { default: false },\n    spawnRotation: { type: \"vec4\" },\n\n    /**\n     * Spawn the object with a custom scale, rather than copying that of the spawner.\n     */\n    useCustomSpawnScale: { default: false },\n    spawnScale: { type: \"vec3\" },\n\n    /**\n     * The spawner will become invisible and ungrabbable for this ammount of time after being grabbed. This can prevent rapidly spawning objects.\n     */\n    spawnCooldown: { default: 1 },\n\n    /**\n     * Center the spawned object on the hand that grabbed it after it finishes loading. By default the object will be grabbed relative to where the spawner was grabbed\n     */\n    centerSpawnedObject: { default: false },\n\n    /**\n     * Optional event to listen for to spawn an object on the preferred superHand\n     */\n    spawnEvent: { type: \"string\" },\n\n    /**\n     * If true, will spawn the object at the cursor and animate it into the hand.\n     */\n    animateFromCursor: { type: \"boolean\" }\n  },\n\n  init() {\n    this.cooldownTimeout = null;\n    this.handPosition = new THREE.Vector3();\n\n    this.onSpawnEvent = this.onSpawnEvent.bind(this);\n\n    this.sceneEl = document.querySelector(\"a-scene\");\n\n    this.tempSpawnHandPosition = new THREE.Vector3();\n  },\n\n  play() {\n    if (this.data.spawnEvent) {\n      this.el.sceneEl.addEventListener(this.data.spawnEvent, this.onSpawnEvent);\n    }\n  },\n\n  pause() {\n    if (this.data.spawnEvent) {\n      this.el.sceneEl.removeEventListener(this.data.spawnEvent, this.onSpawnEvent);\n    }\n    if (this.cooldownTimeout) {\n      clearTimeout(this.cooldownTimeout);\n      this.cooldownTimeout = null;\n      this.el.setAttribute(\"visible\", true);\n      this.el.classList.add(\"interactable\");\n    }\n  },\n\n  async onSpawnEvent() {\n    if (this.cooldownTimeout || !this.el.sceneEl.is(\"entered\")) {\n      return;\n    }\n\n    const entity = addMedia(this.data.src, this.data.template, ObjectContentOrigins.SPAWNER, this.data.resolve, false)\n      .entity;\n\n    const cursor = document.querySelector(\"#cursor\");\n    cursor.object3D.getWorldPosition(entity.object3D.position);\n    cursor.object3D.getWorldQuaternion(entity.object3D.quaternion);\n    entity.object3D.matrixNeedsUpdate = true;\n\n    if (this.data.useCustomSpawnScale) {\n      entity.object3D.scale.copy(this.data.spawnScale);\n    }\n\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const willAnimateFromCursor =\n      this.data.animateFromCursor && userinput.get(paths.actions.rightHand.matrix) && !AFRAME.utils.device.isMobileVR();\n    if (!willAnimateFromCursor) {\n      interaction.state.rightRemote.held = entity;\n      interaction.state.rightRemote.spawning = true;\n    }\n    this.activateCooldown();\n    await waitForEvent(\"body-loaded\", entity);\n\n    cursor.object3D.getWorldPosition(entity.object3D.position);\n    cursor.object3D.getWorldQuaternion(entity.object3D.quaternion);\n    entity.object3D.matrixNeedsUpdate = true;\n\n    if (willAnimateFromCursor) {\n      document.querySelector(\"#player-right-controller\").object3D.getWorldPosition(this.handPosition);\n      entity.setAttribute(\"animation__spawn-at-cursor\", {\n        property: \"position\",\n        delay: 500,\n        dur: 1500,\n        from: { x: entity.object3D.position.x, y: entity.object3D.position.y, z: entity.object3D.position.z },\n        to: { x: this.handPosition.x, y: this.handPosition.y, z: this.handPosition.z },\n        easing: \"easeInOutBack\"\n      });\n    } else {\n      interaction.state.rightRemote.spawning = false;\n    }\n    entity.components[\"ammo-body\"].syncToPhysics();\n  },\n\n  activateCooldown() {\n    if (this.data.spawnCooldown > 0) {\n      const [sx, sy, sz] = [this.el.object3D.scale.x, this.el.object3D.scale.y, this.el.object3D.scale.z];\n\n      this.el.setAttribute(\"visible\", false);\n      this.el.object3D.scale.set(0.001, 0.001, 0.001);\n      this.el.object3D.matrixNeedsUpdate = true;\n      this.el.classList.remove(\"interactable\");\n      this.el.setAttribute(\"ammo-body\", { collisionFilterMask: COLLISION_LAYERS.NONE });\n      this.cooldownTimeout = setTimeout(() => {\n        this.el.setAttribute(\"visible\", true);\n        this.el.classList.add(\"interactable\");\n        this.el.setAttribute(\"ammo-body\", { collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER });\n        this.el.removeAttribute(\"animation__spawner-cooldown\");\n        this.el.setAttribute(\"animation__spawner-cooldown\", {\n          property: \"scale\",\n          delay: 50,\n          dur: 350,\n          from: { x: 0.001, y: 0.001, z: 0.001 },\n          to: { x: sx, y: sy, z: sz },\n          easing: \"easeOutElastic\"\n        });\n\n        this.cooldownTimeout = null;\n      }, this.data.spawnCooldown * 1000);\n    }\n  }\n});\n","export const waitForEvent = function(eventName, eventObj) {\n  return new Promise(resolve => {\n    eventObj.addEventListener(eventName, resolve, { once: true });\n  });\n};\n","import { Layers } from \"./layers\";\nimport \"../vendor/Water\";\nimport waterNormalMap from \"../assets/waternormals.jpg\";\n\n/**\n * @author jbouny / https://github.com/jbouny\n *\n * Work based on :\n * @author Slayvin / http://slayvin.net : Flat mirror for three.js\n * @author Stemkoski / http://www.adelphi.edu/~stemkoski : An implementation of water shader based on the flat mirror\n * @author Jonas Wagner / http://29a.ch/ && http://29a.ch/slides/2012/webglwater/ : Water shader explanations in WebGL\n */\n\nfunction MobileWater(geometry, options) {\n  THREE.Mesh.call(this, geometry);\n\n  const scope = this;\n\n  options = options || {};\n\n  const time = options.time !== undefined ? options.time : 0.0;\n  const normalSampler = options.waterNormals !== undefined ? options.waterNormals : null;\n  const sunDirection =\n    options.sunDirection !== undefined ? options.sunDirection : new THREE.Vector3(0.70707, 0.70707, 0.0);\n  const sunColor = new THREE.Color(options.sunColor !== undefined ? options.sunColor : 0xffffff);\n  const waterColor = new THREE.Color(options.waterColor !== undefined ? options.waterColor : 0x7f7f7f);\n  const eye = options.eye !== undefined ? options.eye : new THREE.Vector3(0, 0, 0);\n  const distortionScale = options.distortionScale !== undefined ? options.distortionScale : 20.0;\n  const side = options.side !== undefined ? options.side : THREE.FrontSide;\n  const fog = options.fog !== undefined ? options.fog : false;\n\n  const mirrorShader = {\n    uniforms: THREE.UniformsUtils.merge([\n      THREE.UniformsLib[\"lights\"],\n      {\n        normalSampler: { value: null },\n        time: { value: 0.0 },\n        size: { value: 1.0 },\n        distortionScale: { value: 20.0 },\n        sunColor: { value: new THREE.Color(0x7f7f7f) },\n        sunDirection: { value: new THREE.Vector3(0.70707, 0.70707, 0) },\n        eye: { value: new THREE.Vector3() },\n        waterColor: { value: new THREE.Color(0x555555) }\n      }\n    ]),\n\n    vertexShader: `\n      uniform float time;\n      varying vec4 worldPosition;\n\n      void main() {\n      \tworldPosition = modelMatrix * vec4( position, 1.0 );\n      \tvec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );\n      \tgl_Position = projectionMatrix * mvPosition;\n\n      }\n    `,\n\n    fragmentShader: `\n      uniform float time;\n      uniform float size;\n      uniform float distortionScale;\n      uniform sampler2D normalSampler;\n      uniform vec3 sunColor;\n      uniform vec3 sunDirection;\n      uniform vec3 eye;\n      uniform vec3 waterColor;\n\n      varying vec4 worldPosition;\n\n      vec4 getNoise( vec2 uv ) {\n      \tvec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);\n      \tvec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );\n      \tvec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );\n      \tvec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );\n      \tvec4 noise = texture2D( normalSampler, uv0 ) +\n      \t\ttexture2D( normalSampler, uv1 ) +\n      \t\ttexture2D( normalSampler, uv2 ) +\n      \t\ttexture2D( normalSampler, uv3 );\n      \treturn noise * 0.5 - 1.0;\n      }\n\n      void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {\n      \tvec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );\n      \tfloat direction = max( 0.0, dot( eyeDirection, reflection ) );\n      \tspecularColor += pow( direction, shiny ) * sunColor * spec;\n      \tdiffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;\n      }\n\n      ${THREE.ShaderChunk[\"common\"]}\n      ${THREE.ShaderChunk[\"packing\"]}\n      ${THREE.ShaderChunk[\"bsdfs\"]}\n      ${THREE.ShaderChunk[\"lights_pars_begin\"]}\n\n      void main() {\n      \tvec4 noise = getNoise( worldPosition.xz * size );\n      \tvec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );\n\n      \tvec3 diffuseLight = vec3(0.0);\n      \tvec3 specularLight = vec3(0.0);\n\n      \tvec3 worldToEye = eye-worldPosition.xyz;\n      \tvec3 eyeDirection = normalize( worldToEye );\n      \tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );\n\n      \tfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );\n      \tfloat rf0 = 0.3;\n      \tfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );\n      \tvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;\n      \tvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ), ( 0.5 + specularLight ), reflectance);\n      \tvec3 outgoingLight = albedo;\n      \tgl_FragColor = vec4( outgoingLight, 1 );\n      }\n    `\n  };\n\n  const material = new THREE.ShaderMaterial({\n    fragmentShader: mirrorShader.fragmentShader,\n    vertexShader: mirrorShader.vertexShader,\n    uniforms: THREE.UniformsUtils.clone(mirrorShader.uniforms),\n    transparent: false,\n    lights: true,\n    side: side,\n    fog: fog\n  });\n\n  material.uniforms.time.value = time;\n  material.uniforms.normalSampler.value = normalSampler;\n  material.uniforms.sunColor.value = sunColor;\n  material.uniforms.waterColor.value = waterColor;\n  material.uniforms.sunDirection.value = sunDirection;\n  material.uniforms.distortionScale.value = distortionScale;\n\n  material.uniforms.eye.value = eye;\n\n  scope.material = material;\n}\n\nMobileWater.prototype = Object.create(THREE.Mesh.prototype);\nMobileWater.prototype.constructor = THREE.Water;\n\nasync function loadWaterNormals(url) {\n  const texture = await new Promise((resolve, reject) =>\n    new THREE.TextureLoader().load(url, resolve, undefined, reject)\n  );\n  texture.wrapS = texture.wrapT = THREE.RepeatWrapping;\n  texture.needsUpdate = true;\n  return texture;\n}\n\nAFRAME.registerComponent(\"water\", {\n  schema: {\n    waterColor: { type: \"color\", default: \"#001e0f\" },\n    distortionScale: { type: \"number\", default: 3.7 },\n    sunColor: { type: \"color\", default: \"#ffffff\" },\n    inclination: { type: \"number\", default: 0 },\n    azimuth: { type: \"number\", default: 0 },\n    distance: { type: \"number\", default: 1 },\n    speed: { type: \"number\", default: 0.1 },\n    forceMobile: { type: \"boolean\", default: false }\n  },\n  init() {\n    const waterMesh = this.el.getObject3D(\"mesh\");\n    const waterGeometry = waterMesh.geometry;\n\n    // Render THREE.Water shader instead of THREE.Mesh\n    waterMesh.visible = false;\n\n    loadWaterNormals(waterNormalMap).then(waterNormals => {\n      const waterConfig = {\n        textureWidth: 512,\n        textureHeight: 512,\n        waterNormals: waterNormals,\n        sunDirection: this.data.sunDirection,\n        sunColor: new THREE.Color(this.data.sunColor),\n        waterColor: new THREE.Color(this.data.waterColor),\n        distortionScale: this.data.distortionScale,\n        fog: false\n      };\n\n      if (AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR() || this.data.forceMobile) {\n        this.water = new MobileWater(waterGeometry, waterConfig);\n      } else {\n        this.water = new THREE.Water(waterGeometry, waterConfig);\n        this.water.mirrorCamera.layers.set(Layers.reflection);\n      }\n\n      this.el.setObject3D(\"water\", this.water);\n    });\n  },\n\n  update(oldData) {\n    if (this.data.forceMobile !== oldData.forceMobile) {\n      this.el.removeObject3D(\"water\");\n      this.init();\n      return;\n    }\n\n    if (!this.water) {\n      return;\n    }\n\n    const uniforms = this.water.material.uniforms;\n\n    if (this.data.waterColor !== oldData.waterColor) {\n      uniforms.waterColor.value.setStyle(this.data.waterColor);\n    }\n\n    if (this.data.distortionScale !== oldData.distortionScale) {\n      uniforms.distortionScale.value = this.data.distortionScale;\n    }\n\n    if (this.data.sunColor !== oldData.sunColor) {\n      uniforms.sunColor.value.setStyle(this.data.sunColor);\n    }\n\n    if (\n      this.data.inclination !== oldData.inclination ||\n      this.data.azimuth !== oldData.azimuth ||\n      this.data.distance !== oldData.distance\n    ) {\n      const theta = Math.PI * (this.data.inclination - 0.5);\n      const phi = 2 * Math.PI * (this.data.azimuth - 0.5);\n\n      const distance = this.data.distance;\n\n      const x = distance * Math.cos(phi);\n      const y = distance * Math.sin(phi) * Math.sin(theta);\n      const z = distance * Math.sin(phi) * Math.cos(theta);\n\n      uniforms.sunDirection.value.set(x, y, z);\n    }\n  },\n\n  tick(time) {\n    if (this.water) {\n      this.water.material.uniforms.time.value = (time / 1000) * this.data.speed;\n    }\n  },\n\n  remove() {\n    this.el.removeObject3D(\"water\");\n    const waterMesh = this.el.getObject3D(\"mesh\");\n    waterMesh.visible = true;\n  }\n});\n","export default function nextTick() {\n  return new Promise(resolve => {\n    setTimeout(resolve, 0);\n  });\n}\n","module.exports = __webpack_public_path__ + \"assets/images/logo-8f1dfd234d060073524bc29912a24f75.svg\";","module.exports = __webpack_public_path__ + \"assets/images/mic_denied-5ce12e4dc9b5eb42ce69b753c46c2174.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_denied@2x-127a94ff73b93a0b4ac89682ce836b91.png\";","module.exports = __webpack_public_path__ + \"assets/images/mobile_screen_entry-b29fcd32c8f70bb828c1abceb62f93e2.svg\";","module.exports = __webpack_public_path__ + \"assets/images/giphy_logo-1dcbee43e18919c0bd0c999be8602628.png\";","const tempVector3 = new THREE.Vector3();\nconst tempQuaternion = new THREE.Quaternion();\n\nexport function getLastWorldPosition(src, target) {\n  target.setFromMatrixPosition(src.matrixWorld);\n  return target;\n}\n\nexport function getLastWorldQuaternion(src, target) {\n  src.matrixWorld.decompose(tempVector3, target, tempVector3);\n  return target;\n}\n\nexport function getLastWorldScale(src, target) {\n  src.matrixWorld.decompose(tempVector3, tempQuaternion, target);\n  return target;\n}\n\nexport function disposeMaterial(mtrl) {\n  if (mtrl.map) mtrl.map.dispose();\n  if (mtrl.lightMap) mtrl.lightMap.dispose();\n  if (mtrl.bumpMap) mtrl.bumpMap.dispose();\n  if (mtrl.normalMap) mtrl.normalMap.dispose();\n  if (mtrl.specularMap) mtrl.specularMap.dispose();\n  if (mtrl.envMap) mtrl.envMap.dispose();\n  mtrl.dispose();\n}\n\nexport function disposeNode(node) {\n  if (!(node instanceof THREE.Mesh)) return;\n\n  if (node.geometry) {\n    node.geometry.dispose();\n  }\n\n  if (node.material) {\n    let materialArray;\n    if (node.material instanceof THREE.MeshFaceMaterial || node.material instanceof THREE.MultiMaterial) {\n      materialArray = node.material.materials;\n    } else if (node.material instanceof Array) {\n      materialArray = node.material;\n    }\n    if (materialArray) {\n      materialArray.forEach(disposeMaterial);\n    } else {\n      disposeMaterial(node.material);\n    }\n  }\n}\n","import { objectTypeForOriginAndContentType } from \"../object-types\";\nimport { getReticulumFetchUrl } from \"./phoenix-utils\";\nimport mediaHighlightFrag from \"./media-highlight-frag.glsl\";\nimport { mapMaterials } from \"./material-utils\";\n\nconst nonCorsProxyDomains = (process.env.NON_CORS_PROXY_DOMAINS || \"\").split(\",\");\nif (process.env.CORS_PROXY_SERVER) {\n  nonCorsProxyDomains.push(process.env.CORS_PROXY_SERVER);\n}\nconst mediaAPIEndpoint = getReticulumFetchUrl(\"/api/v1/media\");\n\nconst commonKnownContentTypes = {\n  gltf: \"model/gltf\",\n  glb: \"model/gltf-binary\",\n  png: \"image/png\",\n  jpg: \"image/jpeg\",\n  jpeg: \"image/jpeg\",\n  pdf: \"application/pdf\",\n  mp4: \"video/mp4\",\n  mp3: \"audio/mpeg\"\n};\n\nconst PHYSICS_CONSTANTS = require(\"aframe-physics-system/src/constants\"),\n  SHAPE = PHYSICS_CONSTANTS.SHAPE,\n  FIT = PHYSICS_CONSTANTS.FIT;\n\n// thanks to https://developer.mozilla.org/en-US/docs/Web/API/WindowBase64/Base64_encoding_and_decoding\nfunction b64EncodeUnicode(str) {\n  // first we use encodeURIComponent to get percent-encoded UTF-8, then we convert the percent-encodings\n  // into raw bytes which can be fed into btoa.\n  const CHAR_RE = /%([0-9A-F]{2})/g;\n  return btoa(encodeURIComponent(str).replace(CHAR_RE, (_, p1) => String.fromCharCode(\"0x\" + p1)));\n}\n\nconst farsparkEncodeUrl = url => {\n  // farspark doesn't know how to read '=' base64 padding characters\n  // translate base64 + to - and / to _ for URL safety\n  return b64EncodeUnicode(url)\n    .replace(/=+$/g, \"\")\n    .replace(/\\+/g, \"-\")\n    .replace(/\\//g, \"_\");\n};\n\nexport const scaledThumbnailUrlFor = (url, width, height) => {\n  if (\n    process.env.RETICULUM_SERVER &&\n    process.env.RETICULUM_SERVER.includes(\"hubs.local\") &&\n    url.includes(\"hubs.local\")\n  ) {\n    return url;\n  }\n\n  return `https://${process.env.FARSPARK_SERVER}/thumbnail/${farsparkEncodeUrl(url)}?w=${width}&h=${height}`;\n};\n\nexport const proxiedUrlFor = (url, index = null) => {\n  if (!(url.startsWith(\"http:\") || url.startsWith(\"https:\"))) return url;\n\n  const hasIndex = index !== null;\n\n  if (!hasIndex) {\n    // Skip known domains that do not require CORS proxying.\n    try {\n      const parsedUrl = new URL(url);\n      if (nonCorsProxyDomains.find(domain => parsedUrl.hostname.endsWith(domain))) return url;\n    } catch (e) {\n      // Ignore\n    }\n  }\n\n  if (hasIndex || !process.env.CORS_PROXY_SERVER) {\n    const method = hasIndex ? \"extract\" : \"raw\";\n    return `https://${process.env.FARSPARK_SERVER}/0/${method}/0/0/0/${index || 0}/${farsparkEncodeUrl(url)}`;\n  } else {\n    return `https://${process.env.CORS_PROXY_SERVER}/${url}`;\n  }\n};\n\nconst resolveUrlCache = new Map();\nexport const resolveUrl = async (url, index) => {\n  const cacheKey = `${url}|${index}`;\n  if (resolveUrlCache.has(cacheKey)) return resolveUrlCache.get(cacheKey);\n  const resolved = await fetch(mediaAPIEndpoint, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({ media: { url, index } })\n  }).then(r => r.json());\n  resolveUrlCache.set(cacheKey, resolved);\n  return resolved;\n};\n\nexport const getCustomGLTFParserURLResolver = gltfUrl => url => {\n  if (typeof url !== \"string\" || url === \"\") return \"\";\n  if (/^(https?:)?\\/\\//i.test(url)) return url;\n  if (/^data:.*,.*$/i.test(url)) return url;\n  if (/^blob:.*$/i.test(url)) return url;\n\n  if (process.env.CORS_PROXY_SERVER) {\n    // For absolute paths with a CORS proxied gltf URL, re-write the url properly to be proxied\n    const corsProxyPrefix = `https://${process.env.CORS_PROXY_SERVER}/`;\n\n    if (gltfUrl.startsWith(corsProxyPrefix)) {\n      const originalUrl = decodeURIComponent(gltfUrl.substring(corsProxyPrefix.length));\n      const originalUrlParts = originalUrl.split(\"/\");\n\n      // Drop the .gltf filename\n      const path = new URL(url).pathname;\n      const assetUrl = originalUrlParts.slice(0, originalUrlParts.length - 1).join(\"/\") + \"/\" + path;\n      return corsProxyPrefix + assetUrl;\n    }\n  }\n\n  return url;\n};\n\nexport const guessContentType = url => {\n  if (url.startsWith(\"hubs://\") && url.endsWith(\"/video\")) return \"video/vnd.hubs-webrtc\";\n  const extension = new URL(url).pathname.split(\".\").pop();\n  return commonKnownContentTypes[extension];\n};\n\nexport const upload = file => {\n  const formData = new FormData();\n  formData.append(\"media\", file);\n  formData.append(\"promotion_mode\", \"with_token\");\n  return fetch(mediaAPIEndpoint, {\n    method: \"POST\",\n    body: formData\n  }).then(r => r.json());\n};\n\n// https://stackoverflow.com/questions/7584794/accessing-jpeg-exif-rotation-data-in-javascript-on-the-client-side/32490603#32490603\nfunction getOrientation(file, callback) {\n  const reader = new FileReader();\n  reader.onload = function(e) {\n    const view = new DataView(e.target.result);\n    if (view.getUint16(0, false) != 0xffd8) {\n      return callback(-2);\n    }\n    const length = view.byteLength;\n    let offset = 2;\n    while (offset < length) {\n      if (view.getUint16(offset + 2, false) <= 8) return callback(-1);\n      const marker = view.getUint16(offset, false);\n      offset += 2;\n      if (marker == 0xffe1) {\n        if (view.getUint32((offset += 2), false) != 0x45786966) {\n          return callback(-1);\n        }\n\n        const little = view.getUint16((offset += 6), false) == 0x4949;\n        offset += view.getUint32(offset + 4, little);\n        const tags = view.getUint16(offset, little);\n        offset += 2;\n        for (let i = 0; i < tags; i++) {\n          if (view.getUint16(offset + i * 12, little) == 0x0112) {\n            return callback(view.getUint16(offset + i * 12 + 8, little));\n          }\n        }\n      } else if ((marker & 0xff00) != 0xff00) {\n        break;\n      } else {\n        offset += view.getUint16(offset, false);\n      }\n    }\n    return callback(-1);\n  };\n  reader.readAsArrayBuffer(file);\n}\n\nlet interactableId = 0;\nexport const addMedia = (src, template, contentOrigin, resolve = false, resize = false, animate = true) => {\n  const scene = AFRAME.scenes[0];\n\n  const entity = document.createElement(\"a-entity\");\n  entity.id = \"interactable-media-\" + interactableId++;\n  entity.setAttribute(\"networked\", { template: template });\n  const needsToBeUploaded = src instanceof File;\n  entity.setAttribute(\"media-loader\", {\n    resize,\n    resolve,\n    animate,\n    src: typeof src === \"string\" ? src : \"\",\n    fileIsOwned: !needsToBeUploaded\n  });\n\n  entity.object3D.matrixNeedsUpdate = true;\n\n  scene.appendChild(entity);\n\n  const fireLoadingTimeout = setTimeout(() => {\n    scene.emit(\"media-loading\", { src: src });\n  }, 100);\n\n  [\"model-loaded\", \"video-loaded\", \"image-loaded\"].forEach(eventName => {\n    entity.addEventListener(\n      eventName,\n      async () => {\n        clearTimeout(fireLoadingTimeout);\n        scene.emit(\"media-loaded\", { src: src });\n      },\n      { once: true }\n    );\n  });\n\n  const orientation = new Promise(function(resolve) {\n    if (needsToBeUploaded) {\n      getOrientation(src, x => {\n        resolve(x);\n      });\n    } else {\n      resolve(1);\n    }\n  });\n  if (needsToBeUploaded) {\n    upload(src)\n      .then(response => {\n        const srcUrl = new URL(response.raw);\n        srcUrl.searchParams.set(\"token\", response.meta.access_token);\n        entity.setAttribute(\"media-loader\", { resolve: false, src: srcUrl.href, fileId: response.file_id });\n        window.APP.store.update({\n          uploadPromotionTokens: [{ fileId: response.file_id, promotionToken: response.meta.promotion_token }]\n        });\n      })\n      .catch(e => {\n        console.error(\"Media upload failed\", e);\n        entity.setAttribute(\"media-loader\", { src: \"error\" });\n      });\n  } else if (src instanceof MediaStream) {\n    entity.setAttribute(\"media-loader\", { src: `hubs://clients/${NAF.clientId}/video` });\n  }\n\n  if (contentOrigin) {\n    entity.addEventListener(\"media_resolved\", ({ detail }) => {\n      const objectType = objectTypeForOriginAndContentType(contentOrigin, detail.contentType, detail.src);\n      scene.emit(\"object_spawned\", { objectType });\n    });\n  }\n\n  return { entity, orientation };\n};\n\nexport function injectCustomShaderChunks(obj) {\n  const vertexRegex = /\\bskinning_vertex\\b/;\n  const fragRegex = /\\bgl_FragColor\\b/;\n  const validMaterials = [\"MeshStandardMaterial\", \"MeshBasicMaterial\", \"MobileStandardMaterial\"];\n\n  const shaderUniforms = [];\n\n  obj.traverse(object => {\n    if (!object.material) return;\n\n    object.material = mapMaterials(object, material => {\n      if (!validMaterials.includes(material.type)) {\n        return material;\n      }\n\n      // HACK, this routine inadvertently leaves the A-Frame shaders wired to the old, dark\n      // material, so maps cannot be updated at runtime. This breaks UI elements who have\n      // hover/toggle state, so for now just skip these while we figure out a more correct\n      // solution.\n      if (object.el.classList.contains(\"ui\")) return material;\n      if (object.el.classList.contains(\"hud\")) return material;\n      if (object.el.getAttribute(\"text-button\")) return material;\n\n      const newMaterial = material.clone();\n      newMaterial.onBeforeCompile = shader => {\n        if (!vertexRegex.test(shader.vertexShader)) return;\n\n        shader.uniforms.hubs_IsFrozen = { value: false };\n        shader.uniforms.hubs_EnableSweepingEffect = { value: false };\n        shader.uniforms.hubs_SweepParams = { value: [0, 0] };\n        shader.uniforms.hubs_InteractorOnePos = { value: [0, 0, 0] };\n        shader.uniforms.hubs_InteractorTwoPos = { value: [0, 0, 0] };\n        shader.uniforms.hubs_HighlightInteractorOne = { value: false };\n        shader.uniforms.hubs_HighlightInteractorTwo = { value: false };\n        shader.uniforms.hubs_Time = { value: 0 };\n\n        const vchunk = `\n        if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\n          vec4 wt = modelMatrix * vec4(transformed, 1);\n\n          // Used in the fragment shader below.\n          hubs_WorldPosition = wt.xyz;\n        }\n      `;\n\n        const vlines = shader.vertexShader.split(\"\\n\");\n        const vindex = vlines.findIndex(line => vertexRegex.test(line));\n        vlines.splice(vindex + 1, 0, vchunk);\n        vlines.unshift(\"varying vec3 hubs_WorldPosition;\");\n        vlines.unshift(\"uniform bool hubs_IsFrozen;\");\n        vlines.unshift(\"uniform bool hubs_HighlightInteractorOne;\");\n        vlines.unshift(\"uniform bool hubs_HighlightInteractorTwo;\");\n        shader.vertexShader = vlines.join(\"\\n\");\n\n        const flines = shader.fragmentShader.split(\"\\n\");\n        const findex = flines.findIndex(line => fragRegex.test(line));\n        flines.splice(findex + 1, 0, mediaHighlightFrag);\n        flines.unshift(\"varying vec3 hubs_WorldPosition;\");\n        flines.unshift(\"uniform bool hubs_IsFrozen;\");\n        flines.unshift(\"uniform bool hubs_EnableSweepingEffect;\");\n        flines.unshift(\"uniform vec2 hubs_SweepParams;\");\n        flines.unshift(\"uniform bool hubs_HighlightInteractorOne;\");\n        flines.unshift(\"uniform vec3 hubs_InteractorOnePos;\");\n        flines.unshift(\"uniform bool hubs_HighlightInteractorTwo;\");\n        flines.unshift(\"uniform vec3 hubs_InteractorTwoPos;\");\n        flines.unshift(\"uniform float hubs_Time;\");\n        shader.fragmentShader = flines.join(\"\\n\");\n\n        shaderUniforms.push(shader.uniforms);\n      };\n      newMaterial.needsUpdate = true;\n      return newMaterial;\n    });\n  });\n\n  return shaderUniforms;\n}\n\nexport function getPromotionTokenForFile(fileId) {\n  return window.APP.store.state.uploadPromotionTokens.find(upload => upload.fileId === fileId);\n}\n\nexport const traverseMeshesAndAddShapes = (function() {\n  const vertexLimit = 200000;\n  const shapePrefix = \"ammo-shape__\";\n  const shapes = [];\n  return function(el) {\n    const meshRoot = el.object3DMap.mesh;\n    while (shapes.length > 0) {\n      const { id, entity } = shapes.pop();\n      entity.removeAttribute(id);\n    }\n\n    let vertexCount = 0;\n    meshRoot.traverse(o => {\n      if (\n        o.isMesh &&\n        (!THREE.Sky || o.__proto__ != THREE.Sky.prototype) &&\n        o.name !== \"Floor_Plan\" &&\n        o.name !== \"Ground_Plane\"\n      ) {\n        vertexCount += o.geometry.attributes.position.count;\n      }\n    });\n\n    console.group(\"traverseMeshesAndAddShapes\");\n\n    console.log(`scene has ${vertexCount} vertices from meshes`);\n\n    const floorPlan = meshRoot.children.find(obj => {\n      return obj.name === \"Floor_Plan\";\n    });\n    if ((vertexCount > vertexLimit || vertexCount === 0) && floorPlan) {\n      console.log(`vertex limit of ${vertexLimit} exceeded, using floor plan with mesh shape`);\n      floorPlan.el.setAttribute(shapePrefix + floorPlan.name, {\n        type: SHAPE.MESH,\n        margin: 0.01,\n        fit: FIT.ALL\n      });\n      shapes.push({ id: shapePrefix + floorPlan.name, entity: floorPlan.el });\n    } else if (vertexCount < vertexLimit && vertexCount > 0) {\n      el.setAttribute(shapePrefix + \"environment\", {\n        type: SHAPE.MESH,\n        margin: 0.01,\n        fit: FIT.ALL\n      });\n      shapes.push({ id: shapePrefix + \"environment\", entity: el });\n      console.log(\"adding compound mesh shape\");\n    } else {\n      el.setAttribute(shapePrefix + \"defaultFloor\", {\n        type: SHAPE.BOX,\n        margin: 0.01,\n        halfExtents: { x: 4000, y: 0.5, z: 4000 },\n        offset: { x: 0, y: -0.5, z: 0 },\n        fit: FIT.MANUAL\n      });\n      shapes.push({ id: shapePrefix + \"defaultFloor\", entity: el });\n      console.log(\"adding default floor collision\");\n    }\n    console.groupEnd();\n  };\n})();\n\nconst mediaPos = new THREE.Vector3();\n\nexport function spawnMediaAround(el, media, snapCount, mirrorOrientation = false) {\n  const { entity, orientation } = addMedia(media, \"#interactable-media\", undefined, false);\n\n  const pos = el.object3D.position;\n\n  entity.object3D.position.set(pos.x, pos.y, pos.z);\n  entity.object3D.rotation.copy(el.object3D.rotation);\n\n  if (mirrorOrientation) {\n    entity.object3D.rotateY(Math.PI);\n  }\n\n  // Generate photos in a circle around camera, starting from the bottom.\n  // Prevent z-fighting but place behind viewfinder\n  const idx = (snapCount % 6) + 3;\n\n  mediaPos.set(\n    Math.cos(Math.PI * 2 * (idx / 6.0)) * 0.75,\n    Math.sin(Math.PI * 2 * (idx / 6.0)) * 0.75,\n    -0.05 + idx * 0.001\n  );\n\n  el.object3D.localToWorld(mediaPos);\n  entity.object3D.visible = false;\n\n  entity.addEventListener(\n    \"image-loaded\",\n    () => {\n      entity.object3D.visible = true;\n      entity.setAttribute(\"animation__photo_pos\", {\n        property: \"position\",\n        dur: 800,\n        from: { x: pos.x, y: pos.y, z: pos.z },\n        to: { x: mediaPos.x, y: mediaPos.y, z: mediaPos.z },\n        easing: \"easeOutElastic\"\n      });\n    },\n    { once: true }\n  );\n\n  entity.object3D.matrixNeedsUpdate = true;\n\n  entity.addEventListener(\n    \"media_resolved\",\n    () => {\n      el.emit(\"photo_taken\", entity.components[\"media-loader\"].data.src);\n    },\n    { once: true }\n  );\n\n  return { entity, orientation };\n}\n\nconst hubsSceneRegex = /https?:\\/\\/(hubs.local(:\\d+)?|(smoke-)?hubs.mozilla.com)\\/scenes\\/(\\w+)\\/?\\S*/;\nconst hubsRoomRegex = /https?:\\/\\/(hubs.local(:\\d+)?|(smoke-)?hubs.mozilla.com)\\/(\\w+)\\/?\\S*/;\nexport const isHubsSceneUrl = hubsSceneRegex.test.bind(hubsSceneRegex);\nexport const isHubsRoomUrl = url => !isHubsSceneUrl(url) && hubsRoomRegex.test(url);\nexport const isHubsDestinationUrl = url => isHubsSceneUrl(url) || isHubsRoomUrl(url);\n","module.exports = \"data:image/gif;base64,R0lGODlhEAAQAIQaAAAAAAEBAQABBQEBAgEBBQMDAwAykwBk+wFk+/85Af47AwCIHgCJHgGJHgCKHgOJIPc63vc64Pc64YeHhwDySLu7wru8wru8w7y8wwD6/v///////////////////////yH+EUNyZWF0ZWQgd2l0aCBHSU1QACH5BAEKAB8ALAAAAAAQABAAAAVl4AeMZDl9KAqkLDqd6YrN9HzC4jdbTUPDMBnGQWEAKphBYKTSYR6LRQE5y+VmlUAAc+lWrMIa4nBYxXQJcabMkkUUtLGhJZNA4BiC4HyVSCJpKRhgOktmgoRVLDSELY5mTHQlKyEAOw==\"","module.exports = __webpack_public_path__ + \"assets/camera_tool-a25d0894a6b635779bd4ed41f2de0411.glb\";","module.exports = __webpack_public_path__ + \"assets/images/mic_granted-5d41c8098b2c1a084f07dd3a2473983f.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_granted@2x-f84d9eb002832eeeb768529e6cb1e93e.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_background-9744d0690bba7838e4a75949d9645c09.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_background@2x-bf55b6a808963d89ff7ce04c516c232c.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_fill-35626a008836cbdc34ec624e16f5b723.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_fill@2x-b3e3675f8281c84660fb5b47eb66126e.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_level-d197b930a4350dc80adb2446babb05e1.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_level@2x-9d49309c2f0e55e5c54193237658768b.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_action_background-5aeb2dca8113545a2bc3e56dc702001b.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_action_background@2x-3a7ab65c95a1b4037d701c8fa16c3cd6.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_action_fill-4e639ed717b8a9a7da4426665ec2dcf4.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_action_fill@2x-eb547f6337c0ea74b35da9812ee3e04b.png\";","module.exports = __webpack_public_path__ + \"assets/images/speaker_level-9567a1a6f33d4d0e59e57903b08369c9.png\";","module.exports = __webpack_public_path__ + \"assets/images/speaker_level@2x-b5e6a12f613576cf5c1a1b96e8c9d8d0.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_small-b81b3397cc985eb8d3d67a4f007158cc.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_small@2x-d04ff548fa26495f69249f0c34f44b72.png\";","module.exports = __webpack_public_path__ + \"assets/images/dropdown_arrow-601450f494125f8caccec2271aebd4cb.png\";","module.exports = __webpack_public_path__ + \"assets/images/dropdown_arrow@2x-1023ab0bd743b3525d99986de89f0c3b.png\";","module.exports = __webpack_public_path__ + \"assets/images/warning_icon-739d2a2ea906737505bcbc2cb51123a8.png\";","module.exports = __webpack_public_path__ + \"assets/images/warning_icon@2x-706e4a4db33f9456bac320e956b4120d.png\";","module.exports = __webpack_public_path__ + \"assets/images/desktop_screen_entry-e5ff9b5e64caa694e9b4183e532fcb17.svg\";","module.exports = __webpack_public_path__ + \"assets/images/generic_vr_entry-c648c26ce1388450df7edbd92ec00f5e.svg\";","module.exports = __webpack_public_path__ + \"assets/images/gearvr_entry-dcea59d35d7fae4c8b9c4985c1743851.svg\";","module.exports = __webpack_public_path__ + \"assets/images/daydream_entry-6e2716960046992dbd6b0e87bf8c2c3a.svg\";","module.exports = __webpack_public_path__ + \"assets/images/device_entry-af6395190efc39925304ae55d69dab2a.svg\";","module.exports = __webpack_public_path__ + \"assets/images/link_dialog_header-b15568ca2056d8be7a58c359e6a9ca51.svg\";","module.exports = __webpack_public_path__ + \"assets/images/presence_phone-fd7ea0e8be441172a758704055604e5f.png\";","module.exports = __webpack_public_path__ + \"assets/images/presence_desktop-be24a9f21df60cd831ad66b67282d6f2.png\";","module.exports = __webpack_public_path__ + \"assets/images/presence_discord-e05ead6e6ebc08df9291738d0aa6986d.png\";","module.exports = __webpack_public_path__ + \"assets/images/presence_vr-563f3bd1c0f37473a3303f4a6049288c.png\";","module.exports = __webpack_public_path__ + \"assets/images/change_avatar-a426739806600c28e20a614cbade29f2.svg\";","module.exports = __webpack_public_path__ + \"assets/sfx/tone-624e72d19fe0cea1b85ca174cb6be256.webm\";","module.exports = __webpack_public_path__ + \"assets/sfx/tone-3fa0defb5172b2533fedcc1929605799.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/tone-78ae5a60f0e336f384919eee9f5a2e18.ogg\";","module.exports = __webpack_public_path__ + \"assets/sfx/tone-4604a4c98f36f3e0c6980295bc5c7ffe.wav\";"],"sourceRoot":""}