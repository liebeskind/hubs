{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/utils/history.js","webpack:///./src/storage/media-search-store.js","webpack:///./src/assets/sfx/tick.mp3","webpack:///./src/utils/promisify-worker.js","webpack:///./src/react-components/create-room-dialog.js","webpack:///./src/react-components/scene-ui.js","webpack:///./src/scene.js","webpack:///./src/constants.js","webpack:///./src/materials/MobileStandardMaterial.js","webpack:///./src/components/gltf-model-plus.js","webpack:///./src/utils/name-generation.js","webpack:///./src/utils/phoenix-utils.js","webpack:///./src/utils/scene-graph.js","webpack:///./src/utils/media-highlight-frag.glsl","webpack:///./src/assets/images/cubemap/posx.jpg","webpack:///./src/assets/images/cubemap/negx.jpg","webpack:///./src/assets/images/cubemap/posy.jpg","webpack:///./src/assets/images/cubemap/negy.jpg","webpack:///./src/assets/images/cubemap/posz.jpg","webpack:///./src/assets/images/cubemap/negz.jpg","webpack:///./src/App.js","webpack:///./src/components/environment-map.js","webpack:///./src/assets/stylesheets/scene.scss","webpack:///./src/assets/stylesheets/scene-ui.scss","webpack:///./src/systems/userinput/paths.js","webpack:///./src/systems/sound-effects-system.js","webpack:///./src/utils/auto-box-collider.js","webpack:///./src/utils/webgl.js","webpack:///./src/utils/disable-ios-zoom.js","webpack:///./src/react-components/dialog-container.js","webpack:///./src/utils/animation.js","webpack:///./src/utils/logging.js","webpack:///./src/components/animation.js","webpack:///./src/components/animation-mixer.js","webpack:///./src/components/audio-feedback.js","webpack:///./src/components/loop-animation.js","webpack:///./src/components/skybox.js","webpack:///./src/utils/qs_truthy.js","webpack:///./src/utils/i18n.js","webpack:///./src/utils/component-mappings.js","webpack:///./src/gltf-component-mappings.js","webpack:///./src/assets/LoadingObject_Atom.glb","webpack:///./src/assets/sfx/teleport-loop.mp3","webpack:///./src/assets/sfx/quickTurn.mp3","webpack:///./src/assets/sfx/tap_mellow.mp3","webpack:///./src/assets/sfx/PenSpawn.mp3","webpack:///./src/assets/sfx/PenDraw1.mp3","webpack:///./src/assets/sfx/PicSnapHey.mp3","webpack:///./src/assets/sfx/welcome.mp3","webpack:///./src/assets/sfx/quack.mp3","webpack:///./src/assets/sfx/specialquack.mp3","webpack:///./src/assets/sfx/pop.mp3","webpack:///./src/assets/sfx/Eb_blip.mp3","webpack:///./src/assets/sfx/tack.mp3","webpack:///./src/assets/sfx/A_bendUp.mp3","webpack:///./src/assets/sfx/suspense.mp3","webpack:///./src/assets/waternormals.jpg","webpack:///./src/assets/images/hub-preview-white.png","webpack:///./src/utils/identity.js","webpack:///./src/storage/store.js","webpack:///./src/assets/avatars/avatars.js","webpack:///./src/utils/material-utils.js","webpack:///./src/utils/threejs-world-update.js","webpack:///./src/components/ambient-light.js","webpack:///./src/components/css-class.js","webpack:///./src/components/duck.js","webpack:///./src/components/heightfield.js","webpack:///./src/components/hemisphere-light.js","webpack:///./src/components/hide-when-quality.js","webpack:///./src/components/point-light.js","webpack:///./src/components/scene-preview-camera.js","webpack:///./src/object-types.js","webpack:///./src/components/spot-light.js","webpack:///./src/components/floaty-object.js","webpack:///./src/components/trigger-volume.js","webpack:///./src/components/video-pause-state.js","webpack:///./src/components/debug.js","webpack:///./src/systems/nav.js","webpack:///./src/components/event-repeater.js","webpack:///./src/telemetry.js","webpack:///./src/react-components/wrap-with-audio.js","webpack:///./src/utils/resizeShadowCameraFrustum.js","webpack:///./src/components/directional-light.js","webpack:///./src/components/layers.js","webpack:///./src/components/media-loader.js","webpack:///./src/components/quack.js","webpack:///./src/components/spawn-controller.js","webpack:///./src/components/super-spawner.js","webpack:///./src/utils/async-utils.js","webpack:///./src/components/water.js","webpack:///./src/utils/next-tick.js","webpack:///./src/utils/three-utils.js","webpack:///./src/utils/media-utils.js","webpack:///./src/assets/images/twitter.svg","webpack:///./src/assets/images/spoke_logo_black.png"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","9","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","pushOrUpdateHistory","history","replace","k","v","detail","newPathname","newSearch","state","newLength","location","__historyLength","_objectSpread","__duplicate","pathname","undefined","search","isDuplicate","method","pushHistoryState","replaceHistoryState","pushHistoryPath","path","clearHistoryState","popToBeginningOfHubHistory","navigateToPriorPage","len","Promise","resolve","unsubscribe","listen","go","sluglessPath","split","join","withSlug","SOURCES","URL_SOURCE_TO_TO_API_SOURCE","scenes","images","videos","youtube","gifs","sketchfab","poly","twitch","MEDIA_SOURCE_DEFAULT_FILTERS","SEARCH_CONTEXT_PARAMS","MediaSearchStore","EventTarget","constructor","super","_defineProperty","this","async","dispatchEvent","CustomEvent","urlSource","getUrlMediaSource","previousSource","urlParams","URLSearchParams","requestIndex","currentRequestIndex","searchParams","param","set","source","navigator","languages","singular","startsWith","APP","store","credentialsAccountId","url","getReticulumFetchUrl","toString","lastSavedUrl","_fetchMedia","nextCursor","meta","next_cursor","lastFetchedUrl","qsTruthy","entries","avatars","map","_legacyAvatarToSearchEntry","headers","Content-Type","credentialsToken","credentials","token","authorization","res","fetch","body","text","JSON","parse","e","legacyAvatar","id","type","preview","thumbnail","width","height","gltfs","avatar","model","delta","goBack","filter","query","delete","keepSource","keepNav","_stashedParams","_stashedSource","q","_sourceNavigate","hideNav","useLastStashedParams","currentQuery","getSearchClearedSearchParams","useValue","hasAccountWithAvatars","_hasAccountWithAvatars","process","document","host","substring","stashLastSearchParams","_stashLastSearchParams","hasMediaPath","setHistory","_update","promisifyWorker","worker","nextItemId","outstanding","onmessage","msg","err","handlers","console","error","reject","Error","transfer","promise","postMessage","payload","__webpack_exports__","HUB_NAME_PATTERN","CreateRoomDialog","Component","[object Object]","args","customRoomName","customSceneUrl","render","_this$props","props","onCustomScene","onClose","other","_objectWithoutProperties","react_default","a","createElement","dialog_container","_extends","title","includeScenePrompt","onSubmit","className","placeholder","pattern","onChange","setState","target","required","wrap_with_audio","PropTypes","bool","func","addLocaleData","en","SceneUI","scene_ui_defineProperty","showScreenshot","showCustomRoomDialog","createAndRedirectToNewHub","sceneId","setTimeout","sceneLoaded","componentDidMount","scene","addEventListener","onSceneLoaded","componentWillUnmount","removeEventListener","unavailable","index_es","locale","lang","messages","styles","ui","sceneUrl","protocol","tweetText","sceneName","tweetLink","encodeURIComponent","attributions","toAttributionSpan","includes","href","rel","author","sceneAttributions","extras","creator","content","classNames","screenshot","screenshotHidden","src","sceneScreenshotURL","whiteOverlay","grid","mainPanel","logo","hubLogo","logoTagline","createButtons","createButton","onClick","createRoom","optionsButton","react_fontawesome_index_es","icon","faEllipsisH","tweetButton","twitter_default","info","attribution","spoke","madeWith","spokeLogo","create_room_dialog_CreateRoomDialog","string","sceneDescription","log","BUILD_VERSION","patchWebGLRenderingContext","App","qs","isMobile","AFRAME","utils","device","isMobileVR","mountUI","ReactDOM","react_components_scene_ui","getElementById","quality","disableiOSZoom","querySelector","setAttribute","enabled","uiProps","remountUI","sceneRoot","sceneModelEntity","gltfEl","camera","previewCamera","object3D","getObjectByName","position","copy","rotation","matrixNeedsUpdate","sceneInfo","then","json","allow_promotion","registerTelemetry","modelUrl","model_url","useCache","inflate","emit","appendChild","description","screenshot_url","COLLISION_LAYERS","ALL","NONE","INTERACTABLES","ENVIRONMENT","AVATAR","HANDS","DEFAULT_INTERACTABLE","UNOWNED_INTERACTABLE","DEFAULT_SPAWNER","VERTEX_SHADER","FRAGMENT_SHADER","MobileStandardMaterial","THREE","ShaderMaterial","material","parameters","vertexShader","fragmentShader","uniforms","uvTransform","Matrix3","diffuse","color","opacity","aoMapIntensity","aoMap","emissive","emissiveMap","fog","lights","transparent","skinning","morphTargets","vertexColors","mobileMaterial","clone","fromStandardMaterial","loadGLTF","Mesh","raycast","acceleratedRaycast","GLTFCache","extractZipFile","SketchfabZipWorker","defaultInflator","el","componentName","componentData","components","multiple","Array","isArray","cloneSkinnedMesh","cloneLookup","Map","parallelTraverse","b","callback","children","sourceNode","clonedNode","isMesh","geometry","boundsTree","traverse","sourceMesh","isSkinnedMesh","sourceBones","skeleton","bones","clonedMesh","sourceBone","has","bindMatrix","getHubsComponents","node","hubsComponents","userData","gltfExtensions","MOZ_hubs_components","HUBS_components","legacyComponents","GLTFModelPlus","registerComponent","componentKey","inflator","inflateEntities","indexToEntityMap","templates","isRoot","modelToWorldScale","childEntities","child","entityComponents","append","uuid","classList","add","order","setFromQuaternion","quaternion","scale","multiplyScalar","matrixAutoUpdate","matrix","identity","decompose","setObject3D","toLowerCase","animations","parent","gltfIndex","attachTemplate","root","templateRoot","targetEls","querySelectorAll","cloneNode","_ref","attributes","contentType","preferredTechnique","onProgress","fileMap","gltfUrl","loadingManager","LoadingManager","setURLModifier","getCustomGLTFParserURLResolver","gltfLoader","GLTFLoader","parser","createParser","materials","extensions","MOZ_alt_materials","altMaterialIndex","nodes","gltf","Object3D","DefaultMatrixAutoUpdate","mapMaterials","isMeshStandardMaterial","keys","forEach","URL","revokeObjectURL","schema","default","init","loadTemplates","update","applySrc","templateEl","importNode","firstElementChild","getAttribute","technique","charAt","assetEl","lastSrc","inflatedEl","warn","disposeLastInflatedEl","loadModel","initMixer","obj","hasBufferGeometry","isBufferGeometry","hasBoundsTree","geo","triCount","index","count","MeshBVH","strategy","maxDepth","object3DToSet","nextTick","inflatedEntity","prop","inflateComponents","rewires","environmentMapComponent","sceneEl","applyEnvironmentMap","f","format","parentNode","removeChild","x","dispose","removeAttribute","adjectives","nouns","generateHubName","randItem","Math","floor","random","toUpperCase","invalidateReticulumMeta","getReticulumMeta","connectToReticulum","getLandingPageForPhoto","fetchReticulumAuthenticated","getPresenceProfileForSession","migrateChannelToSocket","absolute","reticulumMeta","invalidatedReticulumMetaThisSession","version","pool","phx_host","phxHostOverride","debug","params","getNewSocketUrl","socketProtocol","socketHost","socketPort","socketUrl","socketSettings","logger","kind","socket","Socket","connect","onError","endPointPath","endPoint","newEndPoint","photoUrl","parsedUrl","retUrl","content-type","stringify","createUrl","hub","scene_id","default_environment_gltf_bundle_url","Store","email","creatorAssignmentToken","creator_assignment_token","creatorAssignmentTokens","hubId","hub_id","presences","sessionId","presence","find","metas","profile","oldChannel","channel","topic","bindings","item","on","event","pushBuffer","timeout","oldJoinPush","joinPush","recHooks","receive","status","findAncestorWithComponent","entity","_storage_store__WEBPACK_IMPORTED_MODULE_0__","_storage_media_search_store__WEBPACK_IMPORTED_MODULE_1__","mediaSearchStore","setQuality","createDefaultEnvironmentMap","_utils_material_utils__WEBPACK_IMPORTED_MODULE_0__","_assets_images_cubemap_posx_jpg__WEBPACK_IMPORTED_MODULE_1__","_assets_images_cubemap_posx_jpg__WEBPACK_IMPORTED_MODULE_1___default","_assets_images_cubemap_negx_jpg__WEBPACK_IMPORTED_MODULE_2__","_assets_images_cubemap_negx_jpg__WEBPACK_IMPORTED_MODULE_2___default","_assets_images_cubemap_posy_jpg__WEBPACK_IMPORTED_MODULE_3__","_assets_images_cubemap_posy_jpg__WEBPACK_IMPORTED_MODULE_3___default","_assets_images_cubemap_negy_jpg__WEBPACK_IMPORTED_MODULE_4__","_assets_images_cubemap_negy_jpg__WEBPACK_IMPORTED_MODULE_4___default","_assets_images_cubemap_posz_jpg__WEBPACK_IMPORTED_MODULE_5__","_assets_images_cubemap_posz_jpg__WEBPACK_IMPORTED_MODULE_5___default","_assets_images_cubemap_negz_jpg__WEBPACK_IMPORTED_MODULE_6__","_assets_images_cubemap_negz_jpg__WEBPACK_IMPORTED_MODULE_6___default","urls","cubeMapPosX","cubeMapNegX","cubeMapPosY","cubeMapNegY","cubeMapPosZ","cubeMapNegZ","texture","CubeTextureLoader","load","RGBFormat","loadDefault","environmentMap","updateEnvironmentMap","forEachMaterial","envMap","needsUpdate","loading-text","loadingText","paths","actions","toggleScreenShare","snapRotateLeft","snapRotateRight","logDebugFrame","logInteractionState","cameraDelta","characterAcceleration","boost","startGazeTeleport","stopGazeTeleport","spawnPen","ensureFrozen","toggleFreeze","thaw","muteMic","focusChat","focusChatCommand","toggleCamera","takeSnapshot","mediaExit","mediaSearch1","mediaSearch2","mediaSearch3","mediaSearch4","mediaSearch5","mediaSearch6","mediaSearch7","mediaSearch8","transformModifier","rayObjectRotation","cursor","pose","grab","drop","modDelta","startDrawing","stopDrawing","undoDrawing","penNextColor","penPrevColor","scalePenTip","scaleGrabbedGrabbable","mediaVolumeMod","pen","remove","rightHand","startTeleport","stopTeleport","thumb","middleRingPinky","leftHand","exitMirror","haptics","actuators","left","right","mouse","coords","movementXY","buttonLeft","buttonRight","wheel","smartMouse","cursorPose","touchscreen","touchCameraDelta","gyroCameraDelta","pinch","initialDistance","currentDistance","isTouching","isTouchingGrabbable","tap1","tap2","tap3","tap4","tap5","gyro","averageDeltaX","averageDeltaY","hud","penButton","keyboard","gamepad","gamepadIndex","button","buttonIndex","pressed","touched","axis","axisIndex","xbox","buttonName","axisName","oculusgo","trigger","touchpad","axisX","axisY","gearVRController","daydream","rightOculusTouch","leftOculusTouch","side","axes","wmrController","wmr","grip","menu","joystick","vive","SOUND_HOVER_OR_GRAB","SOUND_THAW","SOUND_PEN_STOP_DRAW","SOUND_PEN_UNDO_DRAW","SOUND_PEN_CHANGE_COLOR","SOUND_TOGGLE_MIC","SOUND_TELEPORT_START","SOUND_TELEPORT_END","SOUND_SNAP_ROTATE","SOUND_SPAWN_PEN","SOUND_PEN_START_DRAW","SOUND_CAMERA_TOOL_TOOK_SNAPSHOT","SOUND_ENTER_SCENE","SOUND_QUACK","SOUND_SPECIAL_QUACK","SOUND_CHAT_MESSAGE","SOUND_FREEZE","SOUND_PIN","SOUND_MEDIA_LOADING","SOUND_MEDIA_LOADED","SoundEffectsSystem","_assets_sfx_tick_mp3__WEBPACK_IMPORTED_MODULE_0__","_assets_sfx_tick_mp3__WEBPACK_IMPORTED_MODULE_0___default","_assets_sfx_teleport_loop_mp3__WEBPACK_IMPORTED_MODULE_1__","_assets_sfx_teleport_loop_mp3__WEBPACK_IMPORTED_MODULE_1___default","_assets_sfx_quickTurn_mp3__WEBPACK_IMPORTED_MODULE_2__","_assets_sfx_quickTurn_mp3__WEBPACK_IMPORTED_MODULE_2___default","_assets_sfx_tap_mellow_mp3__WEBPACK_IMPORTED_MODULE_3__","_assets_sfx_tap_mellow_mp3__WEBPACK_IMPORTED_MODULE_3___default","_assets_sfx_PenSpawn_mp3__WEBPACK_IMPORTED_MODULE_4__","_assets_sfx_PenSpawn_mp3__WEBPACK_IMPORTED_MODULE_4___default","_assets_sfx_PenDraw1_mp3__WEBPACK_IMPORTED_MODULE_5__","_assets_sfx_PenDraw1_mp3__WEBPACK_IMPORTED_MODULE_5___default","_assets_sfx_PicSnapHey_mp3__WEBPACK_IMPORTED_MODULE_6__","_assets_sfx_PicSnapHey_mp3__WEBPACK_IMPORTED_MODULE_6___default","_assets_sfx_welcome_mp3__WEBPACK_IMPORTED_MODULE_7__","_assets_sfx_welcome_mp3__WEBPACK_IMPORTED_MODULE_7___default","_assets_sfx_quack_mp3__WEBPACK_IMPORTED_MODULE_8__","_assets_sfx_quack_mp3__WEBPACK_IMPORTED_MODULE_8___default","_assets_sfx_specialquack_mp3__WEBPACK_IMPORTED_MODULE_9__","_assets_sfx_specialquack_mp3__WEBPACK_IMPORTED_MODULE_9___default","_assets_sfx_pop_mp3__WEBPACK_IMPORTED_MODULE_10__","_assets_sfx_pop_mp3__WEBPACK_IMPORTED_MODULE_10___default","_assets_sfx_Eb_blip_mp3__WEBPACK_IMPORTED_MODULE_11__","_assets_sfx_Eb_blip_mp3__WEBPACK_IMPORTED_MODULE_11___default","_assets_sfx_tack_mp3__WEBPACK_IMPORTED_MODULE_12__","_assets_sfx_tack_mp3__WEBPACK_IMPORTED_MODULE_12___default","_assets_sfx_A_bendUp_mp3__WEBPACK_IMPORTED_MODULE_13__","_assets_sfx_A_bendUp_mp3__WEBPACK_IMPORTED_MODULE_13___default","_assets_sfx_suspense_mp3__WEBPACK_IMPORTED_MODULE_14__","_assets_sfx_suspense_mp3__WEBPACK_IMPORTED_MODULE_14___default","soundEnum","pendingEffects","audioContext","AudioContext","getContext","soundsAndUrls","URL_TICK","URL_TELEPORT_LOOP","URL_QUICK_TURN","URL_TAP_MELLOW","URL_PEN_SPAWN","URL_PEN_DRAW","URL_CAMERA_SNAPSHOT","URL_WELCOME","URL_QUACK","URL_SPECIAL_QUACK","URL_POP","URL_FREEZE","URL_TACK","URL_MEDIA_LOADING","URL_MEDIA_LOADED","loading","audioBufferPromise","arrayBuffer","decodeAudioData","sounds","sound","audioBuffer","enqueueSound","loop","createBufferSource","buffer","destination","playSoundOneShot","playSoundLooped","playSoundLoopedWithGain","gain","createGain","stopSoundNode","indexOf","stop","tick","start","getBox","getScaleCoefficient","computeObjectAABB","bounds","Box3","makeEmpty","boundingBox","computeBoundingBox","union","applyMatrix4","matrixWorld","Euler","boxRoot","box","updateMatrices","updateMatrixWorld","isEmpty","worldToLocal","min","max","matrixWorldNeedsUpdate","dX","abs","dY","y","dZ","z","test","userAgent","originalGetExtension","WebGLRenderingContext","getExtension","supportsFloatTextures","renderer","WebGLRenderer","Scene","Float32Array","size","dataTexture","DataTexture","RGBAFormat","FloatType","PlaneBufferGeometry","MeshBasicMaterial","Camera","context","getError","checkFloatTextureSupport","detect_browser__WEBPACK_IMPORTED_MODULE_0__","detectOS","lastTouchAtMs","ev","preventDefault","now","Date","getTime","isDoubleTouch","DialogContainer","closable","currentTarget","onKeyDown","onContainerClicked","react__WEBPACK_IMPORTED_MODULE_0___default","wide","_wrap_with_audio__WEBPACK_IMPORTED_MODULE_3__","_fortawesome_react_fontawesome__WEBPACK_IMPORTED_MODULE_5__","faTimes","isRequired","addAnimationComponents","modelEl","debug__WEBPACK_IMPORTED_MODULE_0__","debug__WEBPACK_IMPORTED_MODULE_0___default","_qs_truthy__WEBPACK_IMPORTED_MODULE_1__","isDebug","logFilter","enable","anime","require","animation","colorHelperFrom","Color","colorHelperTo","getComponentProperty","setComponentProperty","splitCache","TYPE_COLOR","STRING_COMPONENTS","STRING_OBJECT3D","toRadians","degToRad","addEventListeners","eventNames","handler","removeEventListeners","getRawProperty","splitDot","setRawProperty","propertyName","targetValue","g","isRawProperty","autoplay","delay","dir","dur","easing","elasticity","from","parseInt","startEvents","pauseEvents","resumeEvents","round","to","self","eventDetail","attrName","time","animationIsPlaying","onStartEvent","beginAnimation","pauseAnimation","resumeAnimation","fromColor","toColor","targets","targetsArray","updateConfigForDefault","updateConfigForRawColor","config","complete","oldData","direction","duration","createAndStartAnimation","dt","cancelDelayedStart","pause","paused","pausedWasPlaying","play","updateConfig","delayTimeout","stopRelatedAnimations","waitComponentInitRawProperty","setColorConfig","lastValue","anim","animatables","isBoolean","isNaN","parseFloat","aframeProperty","updateConfigForVector","coordinates","propType","component","getPropertyType","cb","wait","evt","clearTimeout","mixer","AnimationMixer","volume","prevVolume","smoothing","threshold","ctx","analyser","createAnalyser","fftSize","levels","Uint8Array","frequencyBinCount","soundSource","getByteTimeDomainData","sum","amplitude","currVolume","sqrt","minScale","maxScale","_playerCamera","_playerCameraWorldPosition","Vector3","_worldPosition","visible","audioAnalyser","setFromMatrixPosition","distance","distanceTo","setScalar","_utils_scene_graph__WEBPACK_IMPORTED_MODULE_0__","clip","mixerEl","updateClip","currentAction","clipName","action","clipAction","setLoop","LoopRepeat","Infinity","destroy","_utils_qs_truthy__WEBPACK_IMPORTED_MODULE_2__","isBotMode","Sky","shader","SkyShader","UniformsUtils","BackSide","BoxBufferGeometry","luminance","turbidity","rayleigh","mieCoefficient","mieDirectionalG","sunPosition","inclination","azimuth","sky","skyScene","cubeCamera","CubeCamera","requestAnimationFrame","theta","PI","phi","cos","sin","normalize","vrEnabled","vr","pmremGenerator","PMREMGenerator","renderTarget","pmremCubeUVPacker","PMREMCubeUVPacker","cubeLods","CubeUVRenderTarget","removeObject3D","val","_assets_translations_data_json__WEBPACK_IMPORTED_MODULE_0__","navigatorLang","language","userLanguage","localeData","getSanitizedComponentMapping","inputComponent","inputProperty","publicComponents","publicComponent","publicProperty","publicProperties","mappedComponent","mappedProperty","getMappedValue","PHYSICS_CONSTANTS","TYPE","SHAPE","FIT","decayMigration","range","decay","mediaInflator","isControlled","networked","hasVolume","templateName","controls","isHubsDestinationUrl","template","owner","persistent","networkId","mediaOptions","projection","videoPaused","autoPlay","audioType","hidePlaybackControls","distanceModel","rolloffFactor","refDistance","maxDistance","coneInnerAngle","coneOuterAngle","coneOuterGain","resize","fileIsOwned","animate","isHandCollisionTarget","cursorController","mass","STATIC","collisionFilterGroup","collisionFilterMask","castShadow","light","shadow","euler","orientation","Quaternion","setFromEuler","BOX","fit","MANUAL","offset","halfExtents","_componentName","nav","systems","zone","found","loadMesh","pageIndex","video","loop-animation","enterComponent","enterProperty","enterValue","leaveComponent","leaveProperty","leaveValue","enterComponentMapping","leaveComponentMapping","targetEntity","message","colliders","names","selectRandom","arr","avatarIds","av","generateDefaultProfile","avatarId","LOCAL_STORE_KEY","STORE_STATE_CACHE_KEY","OAUTH_FLOW_CREDENTIALS_KEY","validator","Validator","SCHEMA","definitions","additionalProperties","properties","displayName","personalAvatarId","activity","hasFoundFreeze","hasChangedName","hasAcceptedProfile","lastEnteredAt","hasPinned","hasRotated","hasRecentered","hasScaled","hasHoveredInWorldHud","settings","lastUsedMicDeviceId","confirmedDiscordRooms","items","uploadPromotionTokens","fileId","promotionToken","$ref","localStorage","getItem","setItem","oauthFlowCredentials","Cookies","getJSON","resetToRandomLegacyAvatar","jwtDecode","sub","resetConfirmedDiscordRooms","arrayMerge","destinationArray","sourceArray","resetTipActivityFlags","newState","mergeOpts","finalState","merge","valid","validate","fn","zeroPos","zeroQuat","oneScale","Matrix4","bindingSetters","PropertyBinding","SetterByBindingTypeAndVersioning","Versioning","setter","MatrixWorldNeedsUpdate","arguments","targetObject","getWorldPosition","getWorldQuaternion","getWorldScale","handleMatrixModification","matrixIsModified","cachedMatrixWorld","updateMatrix","applyMatrix","forceLocalUpdate","forceWorldUpdate","skipParents","hasHadFirstMatrixUpdate","equals","childrenNeedMatrixWorldUpdate","multiplyMatrices","includeInvisible","forceChildrenWorldUpdate","lookAt","q1","m1","isVector3","isCamera","isLight","up","setFromRotationMatrix","extractRotation","premultiply","inverse","intensity","AmbientLight","registerLight","rendererSystem","prevData","applyColorCorrection","initialForce","maxForce","physicsSystem","physics","hasBody","CANNON","Vec3","force","initialScale","addComponent","removeComponent","beforeStep","NAF","isMine","currentScale","angle","applyForce","generateAndAddHeightfield","shape","setFromAxisAngle","mult","cannonOffset","Heightfield","elementSize","addShape","skyColor","groundColor","HemisphereLight","onQualityChanged","updateComponentState","shadowMapResolution","shadowBias","shadowRadius","PointLight","bias","radius","prevWidth","prevHeight","mapSize","lerp","end","newRot","positionOnly","startPoint","startRotation","targetPoint","targetRotDelta","targetRotation","startTime","performance","backwards","ranOnePass","fromRot","toRot","slerp","ObjectContentOrigins","ObjectTypes","objectTypeForOriginAndContentType","FILE","CLIPBOARD","SPAWNER","URL_IMAGE","URL_VIDEO","URL_MODEL","URL_PDF","URL_AUDIO","FILE_IMAGE","FILE_VIDEO","FILE_MODEL","FILE_PDF","FILE_AUDIO","CLIPBOARD_IMAGE","CLIPBOARD_VIDEO","CLIPBOARD_MODEL","CLIPBOARD_PDF","CLIPBOARD_AUDIO","SPAWNER_IMAGE","SPAWNER_VIDEO","SPAWNER_MODEL","SPAWNER_PDF","SPAWNER_AUDIO","CAMERA","UNKNOWN","objectTypeForOrigin","contentOrigin","urlType","fileType","clipboardType","spawnerType","objectTypeMimePrefixLookupMap","image/","model/","application/x-zip-compressed","video/","application/vnd.apple.mpegurl","application/x-mpegurl","audio/","application/pdf","srcSuffixLookupMap",".m3u8","prefix","suffix","endsWith","innerConeAngle","outerConeAngle","SpotLight","penumbra","autoLockOnLoad","autoLockOnRelease","modifyGravityOnRelease","releaseGravity","reduceAngularFloat","gravitySpeedLimit","onGrab","onRelease","ammoBody","isHeld","interaction","wasHeld","_makeStaticWhenAtRest","linearThreshold","linearSleepingThreshold","angularThreshold","angularSleepingThreshold","isAtRest","getLinearVelocity","length2","getAngularVelocity","hasBeenHereBefore","_onBodyLoaded","once","setLocked","locked","getVelocity","gravity","angularDamping","linearDamping","stuckTo","_unstickObject","sizeVec","boundingBoxWorldPositionVec","colliderWorldPositionVec","collidingLastFrame","setFromCenterAndSize","isColliding","containsPoint","onPauseStateChange","videoComponent","onVideoLoaded","togglePlaying","origDispatch","firstObject","Pathfinding","registerSystem","pathfinder","mesh","Geometry","fromBufferGeometry","setZoneData","createZone","eventSource","events","eventListeners","_handleEvent","raven_js__WEBPACK_IMPORTED_MODULE_0__","raven_js__WEBPACK_IMPORTED_MODULE_0___default","ga","trackedPage","trackedTitle","sentryDsn","SENTRY_DSN","gaTrackingId","GA_TRACKING_ID","Raven","install","ReactAudioContext","WithHoverSound","react__WEBPACK_IMPORTED_MODULE_0__","prop_types__WEBPACK_IMPORTED_MODULE_1__","prop_types__WEBPACK_IMPORTED_MODULE_1___default","React","createContext","Consumer","cloneElement","onMouseEnter","playSound","propTypes","frustumBox","inverseLightMatrixWorld","tempBox","FRUSTUM_PADDING","NEAR_CLIPPING_PLANE","FAR_CLIPPING_PLANE","verts","DirectionalLight","getInverse","expandByPoint","bottom","top","near","far","updateProjectionMatrix","resizeShadowCameraFrustum","Layers","reflection","inWorldHud","exclusive","layers","mask","layer","oldValue","newValue","disable","loadingObject","loadingObjectSrc","showLoader","clearLoadingTimeout","onMediaLoaded","getNetworkedEntity","networkedEl","updateScale","center","getObject3D","scaleCoefficient","addVectors","removeShape","loaderMixer","loadingSoundNode","soundEffectsSystem","object3DMap","useFancyLoader","BoxGeometry","loadingClip","loadingScaleClip","AnimationClip","VectorKeyframeTrack","is","showLoaderTimeout","updateHoverableVisuals","hoverableVisuals","injectedCustomShaderChunks","injectCustomShaderChunks","setFromObject","getBoundingSphere","boundingSphere","physicsShape","finish","minHalfExtent","pager","repositionToolbar","addMeshScaleAnimation","onComplete","canonicalUrl","accessibleUrl","resolveUrl","origin","expected_content_type","proxiedUrlFor","guessContentType","fetchContentType","raw","isHLS","qsTime","hash","assign","dirs","HULL","mayChangeScene","permissions","can","isHubsRoomUrl","isHubsSceneUrl","toolbar","imageSrc","onNext","onPrev","_ensureUI","hasSetupUI","maxIndex","fetchMaxContentIndex","nextButton","prevButton","pageLabel","pageSrc","takeOwnership","quackPercentage","specialQuackPercentage","_handleGrabStart","rand","playerHeight","loadedEvent","moveToSpawnPoint","spawnPoints","spawnPoint","getLastWorldPosition","useCustomSpawnPosition","spawnPosition","useCustomSpawnRotation","spawnRotation","useCustomSpawnScale","spawnScale","spawnCooldown","centerSpawnedObject","spawnEvent","animateFromCursor","cooldownTimeout","handPosition","onSpawnEvent","tempSpawnHandPosition","addMedia","userinput","willAnimateFromCursor","eventName","eventObj","rightRemote","held","spawning","activateCooldown","syncToPhysics","sx","sy","sz","MobileWater","options","normalSampler","waterNormals","sunDirection","sunColor","waterColor","eye","distortionScale","FrontSide","mirrorShader","UniformsLib","ShaderChunk","Water","speed","forceMobile","waterMesh","waterGeometry","TextureLoader","wrapS","wrapT","RepeatWrapping","loadWaterNormals","waterNormalMap","waterConfig","textureWidth","textureHeight","water","mirrorCamera","setStyle","disposeNode","disposeMaterial","mtrl","lightMap","bumpMap","normalMap","specularMap","materialArray","MeshFaceMaterial","MultiMaterial","scaledThumbnailUrlFor","upload","getPromotionTokenForFile","traverseMeshesAndAddShapes","spawnMediaAround","_object_types__WEBPACK_IMPORTED_MODULE_0__","_phoenix_utils__WEBPACK_IMPORTED_MODULE_1__","_media_highlight_frag_glsl__WEBPACK_IMPORTED_MODULE_2__","_media_highlight_frag_glsl__WEBPACK_IMPORTED_MODULE_2___default","_material_utils__WEBPACK_IMPORTED_MODULE_3__","nonCorsProxyDomains","CORS_PROXY_SERVER","mediaAPIEndpoint","commonKnownContentTypes","glb","png","jpg","jpeg","pdf","mp4","mp3","farsparkEncodeUrl","str","btoa","_","p1","String","fromCharCode","b64EncodeUnicode","hasIndex","domain","hostname","resolveUrlCache","cacheKey","resolved","media","corsProxyPrefix","originalUrlParts","decodeURIComponent","extension","pop","file","formData","FormData","interactableId","needsToBeUploaded","File","fireLoadingTimeout","reader","FileReader","onload","view","DataView","getUint16","byteLength","marker","getUint32","little","tags","readAsArrayBuffer","getOrientation","response","srcUrl","access_token","file_id","promotion_token","catch","MediaStream","clientId","objectType","vertexRegex","fragRegex","validMaterials","shaderUniforms","contains","newMaterial","onBeforeCompile","hubs_IsFrozen","hubs_EnableSweepingEffect","hubs_SweepParams","hubs_InteractorOnePos","hubs_InteractorTwoPos","hubs_HighlightInteractorOne","hubs_HighlightInteractorTwo","hubs_Time","vlines","vindex","findIndex","line","unshift","flines","findex","mediaHighlightFrag","shapes","meshRoot","vertexCount","__proto__","group","floorPlan","MESH","margin","shapePrefix","groupEnd","mediaPos","snapCount","mirrorOrientation","pos","rotateY","idx","localToWorld","hubsSceneRegex","hubsRoomRegex"],"mappings":"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UACA,UACA,OACA,QACA,QACA,UACA,OACA,YACA,WACA,SACA,WACA,OACA,WACA,WACA,SACA,QACA,YACA,MACA,WACA,SACA,UACA,QACA,WACA,WACA,QACA,QACA,MACA,QACA,YACA,OACA,UACA,SACA,cACA,WACA,UACA,YACA,UACA,WACA,YACA,UACA,aACA,SACA,WACA,UACA,WACA,SACA,YACA,UACA,QACA,OACA,OACA,QACA,YACA,QACA,SACA,SACA,QACA,UACA,aACA,SACA,cACA,YACA,WACA,OACA,QACA,WACA,UACA,WACA,WACA,cACA,cACA,OACA,SACA,QACA,YACA,UACA,WACA,SACA,WACA,eACA,aACA,OACA,SACA,MACA,WACA,SACA,QACA,SACA,UACA,QACA,QACA,SACA,SACA,WACA,OACA,UACA,aACA,aACA,YACA,YACA,UACA,SACA,UACA,aACA,aACA,OACA,YACA,WACA,WACA,SACA,YACA,WACA,aACA,aACA,cACA,UACA,UACA,OACA,QACA,QACA,SACA,OACA,WACA,OACA,YACA,QACA,UACA,UACA,WACA,QACA,WACA,YACA,QACA,YACA,QACA,OACA,YACA,aACA,QACA,SACA,SACA,QACA,QACA,QACA,MACA,QACA,WACA,QACA,WACA,QACA,WACA,UACA,SACA,OACA,QACA,MACA,UACA,QACA,UACA,QACA,QACA,QACA,WACA,WACA,SACA,WACA,WACA,cACA,gBACA,WACA,aACA,QACA,aACA,YACA,cACA,WACA,aACA,UACA,YACA,UACA,YACA,YACA,aACA,YACA,WACA,OACA,WACA,OACA,YACA,QACA,SACA,WACA,WACA,SACA,SACA,OACA,WACA,WACA,UACA,YACA,SACA,UACA,YACA,aACA,QACA,SACA,eACA,UACA,QACA,SACA,UACA,YACA,OACA,MACA,UACA,UACA,WACA,WACA,QACA,QACA,WACA,SACA,WACA,WACA,aACA,SACA,aACA,cACA,SACA,aACA,WACA,SACA,SACA,OACA,QACA,SACA,SACA,SACA,UACA,OACA,WACA,QACA,aACA,SACA,UACA,UACA,WACA,YACA,YACA,QACA,UACA,YACA,QACA,SACA,UACA,UACA,UACA,UACA,OACA,QACA,OACA,SACA,YACA,UACA,YACA,cACA,WACA,UACA,eACA,SACA,OACA,cACA,WACA,YACA,SACA,WACA,UACA,YACA,UACA,WACA,WACA,SACA,YACA,UACA,OACA,WACA,QACA,YACA,WACA,WACA,QACA,QACA,SACA,OACA,YACA,SACA,eACA,aACA,WACA,SACA,SACA,YACA,SACA,OACA,WACA,YACA,QACA,QACA,OACA,OACA,QACA,SACA,UACA,UACA,SACA,UACA,OACA,WACA,UACA,WACA,YACA,WACA,UACA,cACA,QACA,YACA,OACA,QACA,WACA,OACA,QACA,OACA,gBACA,UACA,YACA,cACA,SACA,QACA,SACA,WACA,WACA,WACA,WACA,OACA,UACA,OACA,QACA,SACA,SACA,SACA,WACA,SACA,SACA,OACA,OACA,UACA,UACA,QACA,SACA,eACA,cACA,WACA,UACA,cACA,SACA,YACA,SACA,cACA,aACA,YACA,SACA,QACA,SACA,WACA,QACA,UACA,WACA,YACA,YACA,cACA,QACA,OACA,YACA,YACA,YACA,YACA,aACA,YACA,WACA,QACA,OACA,WACA,QACA,WACA,aACA,SACA,WACA,WACA,SACA,YACA,UACA,UACA,aACA,MACA,OACA,aACA,WACA,WACA,YACA,cACA,QACA,QACA,UACA,gBACA,WACA,OACA,UACA,SACA,SACA,SACA,aACA,SACA,UACA,WACA,WACA,SACA,UACA,UACA,WACA,UACA,QACA,aACA,aACA,QACA,iBACA,UACA,SACA,SACA,WACA,SACA,QACA,SACA,QACA,cACA,WACA,UACA,SACA,WACA,WACA,QACA,UACA,YACA,aACA,aACA,SACA,SACA,UACA,SACA,UACA,QACA,YACA,SACA,UACA,WACA,WACA,YACA,aACA,UACA,YACA,YACA,QACA,UACA,SACA,WACA,OACA,UACA,SACA,WACA,QACA,QACA,OACA,cACA,YACA,WACA,UACA,WACA,SACA,cACA,SACA,SACA,WACA,OACA,WACA,QACA,QACA,UACA,QACA,QACA,SACA,YACA,SACA,cACA,cACA,QACA,QACA,QACA,QACA,WACA,WACA,YACA,eACA,aACA,aACA,OACA,aACA,cACA,YACA,SACA,QACA,UACA,WACA,OACA,OACA,UACA,WACA,SACA,aACA,SACA,UACA,UACA,SACA,QACA,QACA,SACA,aACA,YACA,QACA,QACA,cACA,UACA,WACA,cACA,SACA,WACA,OACA,SACA,OACA,SACA,WACA,QACA,QACA,UACA,aACA,SACA,WACA,MACA,QACA,YACA,UACA,OACA,UACA,OACA,WACA,OACA,QACA,UACA,QACA,OACA,SACA,WACA,SACA,OACA,UACA,SACA,cACA,YACA,UAGIC,EAAQ,CACZ,QACA,OACA,QACA,WACA,QACA,OACA,SACA,QACA,YACA,SACA,eACA,WACA,QACA,SACA,WACA,QACA,SACA,UACA,OACA,SACA,SACA,UACA,OACA,OACA,OACA,QACA,OACA,QACA,YACA,SACA,OACA,SACA,SACA,WACA,YACA,cACA,SACA,YACA,SACA,UACA,aACA,WACA,cACA,YACA,OACA,UACA,SACA,aACA,WACA,eACA,aACA,SACA,OACA,UAGK,SAASC,IACd,MAAMC,EAAWjb,IACf,MAAMpG,EAAIoG,EAAIkb,KAAKC,MAAMD,KAAKE,SAAWpb,EAAIxH,SAC7C,OAAOoB,EAAE+e,OAAO,GAAG0C,cAAgBzhB,EAAEiC,MAAM,IAG7C,SAAUof,EAASH,MAAeG,EAASH,MAAeG,EAASF,iBCzpBrEphB,EAAAS,EAAAqL,EAAA,sBAAA/E,IAAA/G,EAAAS,EAAAqL,EAAA,sBAAA6V,IAAA3hB,EAAAS,EAAAqL,EAAA,sBAAA8V,IAAA5hB,EAAAS,EAAAqL,EAAA,sBAAA+V,IAAA7hB,EAAAS,EAAAqL,EAAA,sBAAAgW,IAAA9hB,EAAAS,EAAAqL,EAAA,sBAAAiW,IAAA/hB,EAAAS,EAAAqL,EAAA,sBAAAwC,IAAAtO,EAAA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","file":"assets/js/scene-58f39a01918e7bfc3bcd.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t9: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([1462,1,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","// Utilities for manipulating state history. This provides a number of functions which\n// need to be used to manipulate history state so we can deal with edge cases around\n// entry back button and refreshes once entered.\n//\n// These functions also transparently deal with the room slug, so incoming calls can ignore\n// dealing with it, and provides APIs for getting the non-slug part of the path.\n//\n// The slug cannot be part of the basename for history, because the slug changes intra-session\n// if the room is renamed.\n\n// This pushes/replaces a new k, v pair into the history, while maintaining all the other\n// keys, or clears state if k if null.\n//\n// Also maintains a length key that can be used to find the length of the history chain\n// (across refreshes) for the current room.\nfunction pushOrUpdateHistory(history, replace, k, v, detail, newPathname, newSearch) {\n  let state = {};\n  const newLength = ((history.location.state && history.location.state.__historyLength) || 0) + (replace ? 0 : 1);\n\n  if (k || newPathname || newSearch) {\n    state = history.location.state ? { ...history.location.state } : {};\n    delete state.__duplicate;\n\n    if (k) {\n      state[k] = v;\n      state.key = k;\n      state.value = v;\n      state.detail = detail;\n    }\n  }\n\n  const pathname =\n    newPathname !== undefined ? newPathname : history.location.pathname === \"/\" ? \"\" : history.location.pathname;\n\n  const search = newSearch !== undefined ? newSearch : history.location.search;\n\n  // If popToBeginningOfHubHistory was previously used, there is a duplicate entry\n  // at the top of the history stack (which was needed to wipe out forward history)\n  // so we use this opportunity to replace it.\n  const isDuplicate = history.location.state && history.location.state.__duplicate;\n  const method = replace || isDuplicate ? history.replace : history.push;\n  state.__historyLength = newLength;\n\n  method({ pathname, search, state });\n}\n\nexport function pushHistoryState(history, k, v, detail) {\n  pushOrUpdateHistory(history, false, k, v, detail);\n}\n\nexport function replaceHistoryState(history, k, v, detail) {\n  pushOrUpdateHistory(history, true, k, v, detail);\n}\n\nexport function pushHistoryPath(history, path, search) {\n  pushOrUpdateHistory(history, false, null, null, null, path, search);\n}\n\nexport function clearHistoryState(history) {\n  pushOrUpdateHistory(history, false);\n}\n\n// This will pop the browser history to the first entry that was for this hubs room,\n// and then push a duplicate entry onto the history stack in order to wipe out forward\n// history.\nexport function popToBeginningOfHubHistory(history, navigateToPriorPage) {\n  if (!history.location.state || history.location.state.__historyLength === undefined) return;\n\n  const len = history.location.state.__historyLength;\n  if (len === 0) return;\n\n  return new Promise(resolve => {\n    // After the go() completes, we push a duplicate history entry onto the stack\n    // in order to wipe out forward history. We also optionally go back -2 if we wanted\n    // to go back to the prior page.\n    const unsubscribe = history.listen(() => {\n      unsubscribe();\n      history.push({\n        pathname: history.location.pathname,\n        search: history.location.search,\n        state: { __historyLength: 0, __duplicate: true }\n      });\n      if (navigateToPriorPage) history.go(-2); // Go back to history entry before beginning.\n      resolve();\n    });\n\n    history.go(-len);\n  });\n}\n\n// This will pop the browser history to the entry before the first entry for this hubs room.\nexport function navigateToPriorPage(history) {\n  popToBeginningOfHubHistory(history, true);\n}\n\n// Returns the part of the pathname that does not include the slug\nexport function sluglessPath(location) {\n  const parts = location.pathname.split(\"/\");\n  return `/${parts.slice(2).join(\"/\")}`;\n}\n\n// Returns a new path that includes the current slug as a prefix to the\n// provided path.\nexport function withSlug(location, path) {\n  const parts = location.pathname.split(\"/\");\n  return `/${parts[1]}${path}`;\n}\n","import { EventTarget } from \"event-target-shim\";\nimport { getReticulumFetchUrl } from \"../utils/phoenix-utils\";\nimport { pushHistoryPath, sluglessPath, withSlug } from \"../utils/history\";\nimport { avatars } from \"../assets/avatars/avatars\";\nimport qsTruthy from \"../utils/qs_truthy\";\n\nexport const SOURCES = [\"videos\", \"sketchfab\", \"poly\", \"scenes\", \"gifs\", \"images\", \"twitch\"];\n\nconst URL_SOURCE_TO_TO_API_SOURCE = {\n  scenes: \"scene_listings\",\n  images: \"bing_images\",\n  videos: \"bing_videos\",\n  youtube: \"youtube_videos\",\n  gifs: \"tenor\",\n  sketchfab: \"sketchfab\",\n  poly: \"poly\",\n  twitch: \"twitch\"\n};\n\nexport const MEDIA_SOURCE_DEFAULT_FILTERS = {\n  gifs: \"trending\",\n  sketchfab: \"featured\",\n  scenes: \"featured\"\n};\n\nconst SEARCH_CONTEXT_PARAMS = [\"q\", \"filter\", \"cursor\"];\n\n// This class is responsible for fetching and storing media search results and provides a\n// convenience API for performing history updates relevant to search navigation.\nexport default class MediaSearchStore extends EventTarget {\n  constructor() {\n    super();\n\n    this.requestIndex = 0;\n  }\n\n  setHistory(history) {\n    this.history = history;\n\n    this._update(this.history.location);\n\n    this.history.listen(location => {\n      this._update(location);\n    });\n  }\n\n  _update = async location => {\n    this.result = null;\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n\n    const urlSource = this.getUrlMediaSource(location);\n    if (!urlSource) return;\n\n    if (!this.previousSource || this.previousSource !== urlSource) {\n      this.dispatchEvent(new CustomEvent(\"sourcechanged\"));\n      this.previousSource = urlSource;\n    }\n\n    const urlParams = new URLSearchParams(location.search);\n\n    this.requestIndex++;\n    const currentRequestIndex = this.requestIndex;\n    const searchParams = new URLSearchParams();\n\n    for (const param of SEARCH_CONTEXT_PARAMS) {\n      if (!urlParams.get(param)) continue;\n      searchParams.set(param, urlParams.get(param));\n    }\n\n    searchParams.get(\"locale\", navigator.languages[0]);\n\n    let source;\n    if (urlSource === \"avatars\" || urlSource === \"scenes\") {\n      // Avatars + scenes are special since we request them from a different source based on the facet.\n      const singular = urlSource === \"avatars\" ? \"avatar\" : \"scene\";\n      const filter = new URLSearchParams(location.search);\n      source = filter.get(\"filter\").startsWith(\"my-\") ? `${singular}s` : `${singular}_listings`;\n    } else {\n      source = URL_SOURCE_TO_TO_API_SOURCE[urlSource];\n    }\n    searchParams.set(\"source\", source);\n\n    if (source === \"avatars\" || source === \"scenes\") {\n      searchParams.set(\"user\", window.APP.store.credentialsAccountId);\n    }\n\n    const url = getReticulumFetchUrl(`/api/v1/media/search?${searchParams.toString()}`);\n    if (this.lastSavedUrl === url) return;\n\n    const result = await this._fetchMedia(url, source);\n\n    if (this.requestIndex != currentRequestIndex) return;\n\n    this.result = result;\n    this.nextCursor = this.result.meta && this.result.meta.next_cursor;\n    this.lastFetchedUrl = url;\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n  };\n\n  _fetchMedia = async (url, source) => {\n    if (source === \"avatar_listings\" && !qsTruthy(\"use_avatar_listings\")) {\n      // Use our legacy avatars until we are ready with real featured avatars.\n      return { entries: avatars.map(this._legacyAvatarToSearchEntry) };\n    }\n\n    const headers = { \"Content-Type\": \"application/json\" };\n    const credentialsToken = window.APP.store.state.credentials.token;\n    if (credentialsToken) headers.authorization = `bearer ${credentialsToken}`;\n\n    const res = await fetch(url, { method: \"GET\", headers });\n    const body = await res.text();\n\n    let result;\n    try {\n      result = JSON.parse(body);\n    } catch (e) {\n      result = body;\n    }\n\n    return result;\n  };\n\n  _legacyAvatarToSearchEntry = legacyAvatar => {\n    return {\n      id: legacyAvatar.id,\n      type: \"avatar_listing\",\n      url: legacyAvatar.url,\n      images: { preview: { url: legacyAvatar.thumbnail, width: 720, height: 1280 } },\n      gltfs: { avatar: legacyAvatar.model }\n    };\n  };\n\n  pageNavigate = delta => {\n    if (delta === -1) {\n      this.history.goBack();\n    } else {\n      const location = this.history.location;\n      const searchParams = new URLSearchParams(location.search);\n      searchParams.set(\"cursor\", this.nextCursor);\n      pushHistoryPath(this.history, location.pathname, searchParams.toString());\n    }\n  };\n\n  filterQueryNavigate = (filter, query) => {\n    const location = this.history.location;\n    const searchParams = new URLSearchParams(location.search);\n\n    if (query) {\n      searchParams.set(\"q\", query);\n    } else {\n      searchParams.delete(\"q\");\n    }\n\n    if (filter) {\n      searchParams.set(\"filter\", filter);\n    } else {\n      searchParams.delete(\"filter\");\n    }\n\n    if (filter) {\n      searchParams.set(\"cursor\", filter);\n    } else {\n      searchParams.delete(\"cursor\");\n    }\n\n    pushHistoryPath(this.history, location.pathname, searchParams.toString());\n  };\n\n  getSearchClearedSearchParams = (location, keepSource, keepNav) => {\n    const searchParams = new URLSearchParams(location.search);\n\n    // Strip browsing query params\n    searchParams.delete(\"q\");\n    searchParams.delete(\"filter\");\n    searchParams.delete(\"cursor\");\n\n    if (!keepNav) {\n      searchParams.delete(\"media_nav\");\n    }\n\n    if (!keepSource) {\n      searchParams.delete(\"media_source\");\n    }\n\n    return searchParams;\n  };\n\n  _stashLastSearchParams = location => {\n    const searchParams = new URLSearchParams(location.search);\n    this._stashedParams = {};\n    this._stashedSource = this.getUrlMediaSource(location);\n\n    for (const param of SEARCH_CONTEXT_PARAMS) {\n      const value = searchParams.get(param);\n\n      if (value) {\n        this._stashedParams[param] = value;\n      }\n    }\n  };\n\n  clearStashedQuery = () => {\n    if (!this._stashedParams) return;\n    delete this._stashedParams.q;\n  };\n\n  sourceNavigate = source => {\n    this._sourceNavigate(source, false, true);\n  };\n\n  sourceNavigateToDefaultSource = () => {\n    this._sourceNavigate(this._stashedSource ? this._stashedSource : SOURCES[0], false, true);\n  };\n\n  sourceNavigateWithNoNav = source => {\n    this._sourceNavigate(source, true, false);\n  };\n\n  _sourceNavigate = async (source, hideNav, useLastStashedParams) => {\n    const currentQuery = new URLSearchParams(this.history.location.search).get(\"q\");\n    const searchParams = this.getSearchClearedSearchParams(this.history.location);\n\n    if (currentQuery) {\n      searchParams.set(\"q\", currentQuery);\n    } else {\n      if (useLastStashedParams && this._stashedParams) {\n        for (const param of SEARCH_CONTEXT_PARAMS) {\n          const value = this._stashedParams[param];\n\n          // Only q param is compatible across sources, so keep it if is stashed.\n          const useValue = param === \"q\" || this._stashedSource === source;\n\n          if (value && useValue) {\n            searchParams.set(param, value);\n          }\n        }\n      } else {\n        if (source === \"avatars\") {\n          const hasAccountWithAvatars = await this._hasAccountWithAvatars();\n          searchParams.set(\"filter\", hasAccountWithAvatars ? \"my-avatars\" : \"featured\");\n        } else if (MEDIA_SOURCE_DEFAULT_FILTERS[source]) {\n          searchParams.set(\"filter\", MEDIA_SOURCE_DEFAULT_FILTERS[source]);\n        }\n      }\n    }\n\n    this._stashedParams = null;\n    this._stashedSource = null;\n\n    if (hideNav) {\n      searchParams.set(\"media_nav\", \"false\");\n    }\n\n    if (process.env.RETICULUM_SERVER && document.location.host !== process.env.RETICULUM_SERVER) {\n      searchParams.set(\"media_source\", source);\n      pushHistoryPath(this.history, this.history.location.pathname, searchParams.toString());\n    } else {\n      pushHistoryPath(this.history, withSlug(this.history.location, `/media/${source}`), searchParams.toString());\n    }\n  };\n\n  _hasAccountWithAvatars = async () => {\n    const { credentialsAccountId } = window.APP.store;\n    if (!credentialsAccountId) return false;\n\n    const searchParams = new URLSearchParams();\n    const source = \"avatars\";\n    searchParams.set(\"source\", source);\n    searchParams.set(\"user\", credentialsAccountId);\n    const url = getReticulumFetchUrl(`/api/v1/media/search?${searchParams.toString()}`);\n    const result = await this._fetchMedia(url, source);\n    return !!(result && result.entries) && result.entries.length > 0;\n  };\n\n  getUrlMediaSource = location => {\n    const { search } = location;\n    const urlParams = new URLSearchParams(search);\n    const pathname = sluglessPath(location);\n\n    if (!pathname.startsWith(\"/media\") && !urlParams.get(\"media_source\")) return null;\n    return urlParams.get(\"media_source\") || pathname.substring(7);\n  };\n\n  pushExitMediaBrowserHistory = (history, stashLastSearchParams = true) => {\n    if (!history) history = this.history;\n\n    if (stashLastSearchParams) this._stashLastSearchParams(history.location);\n\n    const { pathname } = history.location;\n    const hasMediaPath = sluglessPath(history.location).startsWith(\"/media\");\n    pushHistoryPath(\n      history,\n      hasMediaPath ? withSlug(history.location, \"/\") : pathname,\n      this.getSearchClearedSearchParams(history.location).toString()\n    );\n    this.dispatchEvent(new CustomEvent(\"media-exit\"));\n  };\n}\n","module.exports = __webpack_public_path__ + \"assets/sfx/tick-b0fcbf1d9b6f92a24bec12f9bae1e42a.mp3\";","// Wrapper for a worker which accepts work items and responds with results.\n//\n// The worker must receive messages with data of the shape { id, payload }, and then respond\n// with messages containing matching IDs of the shape { id, result, err }.\n//\n// Returns a function that accepts a work item, sends it to the worker, and returns a promise that\n// will resolve with the result or reject with the error.\n//\nexport function promisifyWorker(worker) {\n  let nextItemId = 0;\n  const outstanding = {}; // item ID: { resolve, reject }\n\n  worker.onmessage = msg => {\n    const { id, result, err } = msg.data;\n    const handlers = outstanding[id];\n    if (handlers == null) {\n      console.error(`Unknown message with ID ${id} received from ${worker}.`);\n    } else {\n      delete outstanding[id];\n      if (err != null) {\n        handlers.reject(new Error(err));\n      } else {\n        handlers.resolve(result);\n      }\n    }\n  };\n\n  return function(data, transfer) {\n    const id = nextItemId++;\n    const promise = new Promise((resolve, reject) => {\n      outstanding[id] = { resolve, reject };\n    });\n    worker.postMessage({ id, payload: data }, transfer);\n    return promise;\n  };\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport DialogContainer from \"./dialog-container.js\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nconst HUB_NAME_PATTERN = \"^.{1,64}$\";\n\nexport default class CreateRoomDialog extends Component {\n  static propTypes = {\n    includeScenePrompt: PropTypes.bool,\n    onCustomScene: PropTypes.func,\n    onClose: PropTypes.func\n  };\n\n  state = {\n    customRoomName: \"\",\n    customSceneUrl: \"\"\n  };\n\n  render() {\n    const { onCustomScene, onClose, ...other } = this.props;\n    const onCustomSceneClicked = () => {\n      onCustomScene(this.state.customRoomName, this.state.customSceneUrl);\n      onClose();\n    };\n\n    return (\n      <DialogContainer title=\"Create a Room\" onClose={onClose} {...other}>\n        <div>\n          {this.props.includeScenePrompt ? (\n            <div>Choose a name and GLTF URL for your room&apos;s scene:</div>\n          ) : (\n            <div>Choose a name for your room:</div>\n          )}\n\n          <form onSubmit={onCustomSceneClicked}>\n            <div className=\"custom-scene-form\">\n              <input\n                type=\"text\"\n                placeholder=\"Room name\"\n                className=\"custom-scene-form__link_field\"\n                value={this.state.customRoomName}\n                pattern={HUB_NAME_PATTERN}\n                title=\"Names must be at most 64 characters.\"\n                onChange={e => this.setState({ customRoomName: e.target.value })}\n                required\n              />\n              {this.props.includeScenePrompt && (\n                <input\n                  type=\"url\"\n                  placeholder=\"URL to Scene GLTF or GLB (Optional)\"\n                  className=\"custom-scene-form__link_field\"\n                  value={this.state.customSceneUrl}\n                  onChange={e => this.setState({ customSceneUrl: e.target.value })}\n                />\n              )}\n              <div className=\"custom-scene-form__buttons\">\n                <WithHoverSound>\n                  <button className=\"custom-scene-form__action-button\">\n                    <span>Create Room</span>\n                  </button>\n                </WithHoverSound>\n              </div>\n            </div>\n          </form>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { IntlProvider, FormattedMessage, addLocaleData } from \"react-intl\";\nimport en from \"react-intl/locale-data/en\";\nimport styles from \"../assets/stylesheets/scene-ui.scss\";\nimport hubLogo from \"../assets/images/hub-preview-white.png\";\nimport spokeLogo from \"../assets/images/spoke_logo_black.png\";\nimport { createAndRedirectToNewHub } from \"../utils/phoenix-utils\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\nimport CreateRoomDialog from \"./create-room-dialog.js\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faEllipsisH } from \"@fortawesome/free-solid-svg-icons/faEllipsisH\";\n\nimport { lang, messages } from \"../utils/i18n\";\n\naddLocaleData([...en]);\n\nclass SceneUI extends Component {\n  static propTypes = {\n    scene: PropTypes.object,\n    sceneLoaded: PropTypes.bool,\n    sceneId: PropTypes.string,\n    sceneName: PropTypes.string,\n    sceneDescription: PropTypes.string,\n    sceneAttributions: PropTypes.object,\n    sceneScreenshotURL: PropTypes.string,\n    unavailable: PropTypes.bool\n  };\n\n  state = {\n    showScreenshot: false,\n    showCustomRoomDialog: false\n  };\n\n  constructor(props) {\n    super(props);\n\n    // Show screenshot if scene isn't loaded in 5 seconds\n    setTimeout(() => {\n      if (!this.props.sceneLoaded) {\n        this.setState({ showScreenshot: true });\n      }\n    }, 5000);\n  }\n\n  componentDidMount() {\n    this.props.scene.addEventListener(\"loaded\", this.onSceneLoaded);\n  }\n\n  componentWillUnmount() {\n    this.props.scene.removeEventListener(\"loaded\", this.onSceneLoaded);\n  }\n\n  createRoom = () => {\n    createAndRedirectToNewHub(this.state.customRoomName, this.props.sceneId);\n  };\n\n  render() {\n    if (this.props.unavailable) {\n      return (\n        <IntlProvider locale={lang} messages={messages}>\n          <div className={styles.ui}>\n            <div className={styles.unavailable}>\n              <div>\n                <FormattedMessage id=\"scene.unavailable\" />\n              </div>\n            </div>\n          </div>\n        </IntlProvider>\n      );\n    }\n\n    const sceneUrl = [location.protocol, \"//\", location.host, location.pathname].join(\"\");\n    const tweetText = `${this.props.sceneName} in #hubs`;\n    const tweetLink = `https://twitter.com/share?url=${encodeURIComponent(sceneUrl)}&text=${encodeURIComponent(\n      tweetText\n    )}`;\n\n    let attributions;\n\n    const toAttributionSpan = a => {\n      if (a.url) {\n        const source = a.url.includes(\"sketchfab.com\")\n          ? \"on Sketchfab\"\n          : a.url.includes(\"poly.google.com\")\n            ? \"on Google Poly\"\n            : \"\";\n\n        return (\n          <span key={a.url}>\n            <a href={a.url} target=\"_blank\" rel=\"noopener noreferrer\">\n              {a.name} by {a.author} {source}\n            </a>\n            &nbsp;\n          </span>\n        );\n      } else {\n        return (\n          <span key={`${a.name} ${a.author}`}>\n            {a.name} by {a.author}\n            &nbsp;\n          </span>\n        );\n      }\n    };\n\n    if (this.props.sceneAttributions) {\n      if (!this.props.sceneAttributions.extras) {\n        attributions = (\n          <span>\n            <span>{this.props.sceneAttributions.creator ? `by ${this.props.sceneAttributions.creator}` : \"\"}</span>\n            &nbsp;\n            <br />\n            {this.props.sceneAttributions.content && this.props.sceneAttributions.content.map(toAttributionSpan)}\n          </span>\n        );\n      } else {\n        // Legacy\n        attributions = <span>{this.props.sceneAttributions.extras}</span>;\n      }\n    }\n\n    return (\n      <IntlProvider locale={lang} messages={messages}>\n        <div className={styles.ui}>\n          <div\n            className={classNames({\n              [styles.screenshot]: true,\n              [styles.screenshotHidden]: this.props.sceneLoaded\n            })}\n          >\n            {this.state.showScreenshot && <img src={this.props.sceneScreenshotURL} />}\n          </div>\n          <div className={styles.whiteOverlay} />\n          <div className={styles.grid}>\n            <div className={styles.mainPanel}>\n              <WithHoverSound>\n                <a href=\"/\" className={styles.logo}>\n                  <img src={hubLogo} />\n                </a>\n              </WithHoverSound>\n              <div className={styles.logoTagline}>\n                <FormattedMessage id=\"scene.logo_tagline\" />\n              </div>\n              <div className={styles.createButtons}>\n                <WithHoverSound>\n                  <button className={styles.createButton} onClick={this.createRoom}>\n                    <FormattedMessage id=\"scene.create_button\" />\n                  </button>\n                </WithHoverSound>\n                <WithHoverSound>\n                  <button\n                    className={styles.optionsButton}\n                    onClick={() => this.setState({ showCustomRoomDialog: true })}\n                  >\n                    <FontAwesomeIcon icon={faEllipsisH} />\n                  </button>\n                </WithHoverSound>\n              </div>\n              <WithHoverSound>\n                <a href={tweetLink} rel=\"noopener noreferrer\" target=\"_blank\" className={styles.tweetButton}>\n                  <img src=\"../assets/images/twitter.svg\" />\n                  <div>\n                    <FormattedMessage id=\"scene.tweet_button\" />\n                  </div>\n                </a>\n              </WithHoverSound>\n            </div>\n          </div>\n          <div className={styles.info}>\n            <div className={styles.name}>{this.props.sceneName}</div>\n            <div className={styles.attribution}>{attributions}</div>\n          </div>\n          <div className={styles.spoke}>\n            <div className={styles.madeWith}>made with</div>\n            <a href=\"/spoke\">\n              <img src={spokeLogo} />\n            </a>\n          </div>\n          {this.state.showCustomRoomDialog && (\n            <CreateRoomDialog\n              includeScenePrompt={false}\n              onClose={() => this.setState({ showCustomRoomDialog: false })}\n              onCustomScene={name => {\n                this.setState({ showCustomRoomDialog: false, customRoomName: name }, () => this.createRoom());\n              }}\n            />\n          )}\n        </div>\n      </IntlProvider>\n    );\n  }\n}\n\nexport default SceneUI;\n","console.log(`Hubs version: ${process.env.BUILD_VERSION || \"?\"}`);\n\nimport \"./assets/stylesheets/scene.scss\";\n\nimport \"aframe\";\nimport \"./utils/logging\";\nimport \"./utils/threejs-world-update\";\nimport { patchWebGLRenderingContext } from \"./utils/webgl\";\npatchWebGLRenderingContext();\n\nimport \"three/examples/js/loaders/GLTFLoader\";\n\nimport \"./components/scene-components\";\nimport \"./components/debug\";\nimport \"./systems/nav\";\n\nimport { getReticulumFetchUrl } from \"./utils/phoenix-utils\";\n\nimport ReactDOM from \"react-dom\";\nimport React from \"react\";\nimport SceneUI from \"./react-components/scene-ui\";\nimport { disableiOSZoom } from \"./utils/disable-ios-zoom\";\n\nimport \"./gltf-component-mappings\";\n\nimport { App } from \"./App\";\n\nwindow.APP = new App();\n\nconst qs = new URLSearchParams(location.search);\nconst isMobile = AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR();\n\nwindow.APP.quality = qs.get(\"quality\") || isMobile ? \"low\" : \"high\";\n\nimport \"aframe-physics-system\";\nimport \"./components/event-repeater\";\n\nimport registerTelemetry from \"./telemetry\";\n\ndisableiOSZoom();\n\nfunction mountUI(scene, props = {}) {\n  ReactDOM.render(\n    <SceneUI\n      {...{\n        scene,\n        ...props\n      }}\n    />,\n    document.getElementById(\"ui-root\")\n  );\n}\n\nconst onReady = async () => {\n  const scene = document.querySelector(\"a-scene\");\n  window.APP.scene = scene;\n\n  const sceneId = qs.get(\"scene_id\") || document.location.pathname.substring(1).split(\"/\")[1];\n  console.log(`Scene ID: ${sceneId}`);\n\n  // Disable shadows on low quality\n  scene.setAttribute(\"shadow\", { enabled: window.APP.quality !== \"low\" });\n\n  let uiProps = { sceneId: sceneId };\n\n  mountUI(scene);\n\n  const remountUI = props => {\n    uiProps = { ...uiProps, ...props };\n    mountUI(scene, uiProps);\n  };\n\n  const sceneRoot = document.querySelector(\"#scene-root\");\n  const sceneModelEntity = document.createElement(\"a-entity\");\n  const gltfEl = document.createElement(\"a-entity\");\n  const camera = document.getElementById(\"camera\");\n\n  sceneModelEntity.addEventListener(\"scene-loaded\", () => {\n    remountUI({ sceneLoaded: true });\n    const previewCamera = gltfEl.object3D.getObjectByName(\"scene-preview-camera\");\n\n    if (previewCamera) {\n      camera.object3D.position.copy(previewCamera.position);\n      camera.object3D.rotation.copy(previewCamera.rotation);\n      camera.object3D.matrixNeedsUpdate = true;\n    }\n\n    camera.setAttribute(\"scene-preview-camera\", \"\");\n  });\n\n  const res = await fetch(getReticulumFetchUrl(`/api/v1/scenes/${sceneId}`)).then(r => r.json());\n  const sceneInfo = res.scenes[0];\n\n  // Delisted/Removed\n  if (!sceneInfo) {\n    remountUI({ unavailable: true });\n    return;\n  }\n\n  if (sceneInfo.allow_promotion) {\n    registerTelemetry(`/scene/${sceneId}`, `Hubs Scene: ${sceneInfo.title}`);\n  } else {\n    registerTelemetry(\"/scene\", \"Hubs Non-Promotable Scene Page\");\n  }\n\n  const modelUrl = sceneInfo.model_url;\n  console.log(`Scene Model URL: ${modelUrl}`);\n\n  gltfEl.setAttribute(\"gltf-model-plus\", { src: modelUrl, useCache: false, inflate: true });\n  gltfEl.addEventListener(\"model-loaded\", () => sceneModelEntity.emit(\"scene-loaded\"));\n  sceneModelEntity.appendChild(gltfEl);\n  sceneRoot.appendChild(sceneModelEntity);\n\n  remountUI({\n    sceneName: sceneInfo.name,\n    sceneDescription: sceneInfo.description,\n    sceneAttributions: sceneInfo.attributions,\n    sceneScreenshotURL: sceneInfo.screenshot_url\n  });\n};\n\ndocument.addEventListener(\"DOMContentLoaded\", onReady);\n","module.exports = {\n  COLLISION_LAYERS: {\n    ALL: -1,\n    NONE: 0,\n    INTERACTABLES: 1,\n    ENVIRONMENT: 2,\n    AVATAR: 4,\n    HANDS: 8,\n    DEFAULT_INTERACTABLE: 1 | 2 | 4 | 8,\n    UNOWNED_INTERACTABLE: 1 | 8,\n    DEFAULT_SPAWNER: 1 | 8\n  }\n};\n","const VERTEX_SHADER = `\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n  #include <uv_vertex>\n  #include <uv2_vertex>\n  #include <color_vertex>\n  #include <skinbase_vertex>\n\n  #include <begin_vertex>\n  #include <morphtarget_vertex>\n  #include <skinning_vertex>\n  #include <project_vertex>\n  #include <logdepthbuf_vertex>\n\n  #include <worldpos_vertex>\n  #include <clipping_planes_vertex>\n  #include <fog_vertex>\n}\n`;\n\nconst FRAGMENT_SHADER = `\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <aomap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n  #include <clipping_planes_fragment>\n\n  vec4 diffuseColor = vec4(diffuse, opacity);\n  ReflectedLight reflectedLight = ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0), vec3(0.0));\n  vec3 totalEmissiveRadiance = emissive;\n\n  #include <logdepthbuf_fragment>\n  #include <map_fragment>\n  #include <color_fragment>\n  #include <alphatest_fragment>\n  #include <emissivemap_fragment>\n\n  reflectedLight.indirectDiffuse += vec3(1.0);\n\n  #include <aomap_fragment>\n\n  reflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\n  vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n  gl_FragColor = vec4(outgoingLight, diffuseColor.a);\n\n  #include <premultiplied_alpha_fragment>\n  #include <tonemapping_fragment>\n  #include <encodings_fragment>\n  #include <fog_fragment>\n}\n`;\n\nexport default class MobileStandardMaterial extends THREE.ShaderMaterial {\n  type = \"MobileStandardMaterial\";\n  isMobileStandardMaterial = true;\n  static fromStandardMaterial(material) {\n    const parameters = {\n      vertexShader: VERTEX_SHADER,\n      fragmentShader: FRAGMENT_SHADER,\n      uniforms: {\n        uvTransform: { value: new THREE.Matrix3() },\n        diffuse: { value: material.color },\n        opacity: { value: material.opacity },\n        map: { value: material.map },\n        aoMapIntensity: { value: material.aoMapIntensity },\n        aoMap: { value: material.aoMap },\n        emissive: { value: material.emissive },\n        emissiveMap: { value: material.emissiveMap }\n      },\n      fog: true,\n      lights: false,\n      opacity: material.opacity,\n      transparent: material.transparent,\n      skinning: material.skinning,\n      morphTargets: material.morphTargets,\n      vertexColors: material.vertexColors\n    };\n\n    const mobileMaterial = new MobileStandardMaterial(parameters);\n\n    mobileMaterial.color = material.color;\n    mobileMaterial.map = material.map;\n    mobileMaterial.aoMap = material.aoMap;\n    mobileMaterial.aoMapIntensity = material.aoMapIntensity;\n    mobileMaterial.emissive = material.emissive;\n    mobileMaterial.emissiveMap = material.emissiveMap;\n\n    return mobileMaterial;\n  }\n  clone() {\n    return MobileStandardMaterial.fromStandardMaterial(this);\n  }\n}\n","import nextTick from \"../utils/next-tick\";\nimport { mapMaterials } from \"../utils/material-utils\";\nimport SketchfabZipWorker from \"../workers/sketchfab-zip.worker.js\";\nimport MobileStandardMaterial from \"../materials/MobileStandardMaterial\";\nimport { getCustomGLTFParserURLResolver } from \"../utils/media-utils\";\nimport { promisifyWorker } from \"../utils/promisify-worker.js\";\nimport { MeshBVH, acceleratedRaycast } from \"three-mesh-bvh\";\nTHREE.Mesh.prototype.raycast = acceleratedRaycast;\n\nconst GLTFCache = {};\nconst extractZipFile = promisifyWorker(new SketchfabZipWorker());\n\nfunction defaultInflator(el, componentName, componentData) {\n  if (!AFRAME.components[componentName]) {\n    throw new Error(`Inflator failed. \"${componentName}\" component does not exist.`);\n  }\n  if (AFRAME.components[componentName].multiple && Array.isArray(componentData)) {\n    for (let i = 0; i < componentData.length; i++) {\n      el.setAttribute(componentName + \"__\" + i, componentData[i]);\n    }\n  } else {\n    el.setAttribute(componentName, componentData);\n  }\n}\n\nAFRAME.GLTFModelPlus = {\n  // eslint-disable-next-line no-unused-vars\n  components: {},\n  registerComponent(componentKey, componentName, inflator) {\n    inflator = inflator || defaultInflator;\n    AFRAME.GLTFModelPlus.components[componentKey] = { inflator, componentName };\n  }\n};\n\nfunction parallelTraverse(a, b, callback) {\n  callback(a, b);\n\n  for (let i = 0; i < a.children.length; i++) {\n    parallelTraverse(a.children[i], b.children[i], callback);\n  }\n}\n\nfunction generateMeshBVH(object3D) {\n  object3D.traverse(obj => {\n    // note that we might already have a bounds tree if this was a clone of an object with one\n    const hasBufferGeometry = obj.isMesh && obj.geometry.isBufferGeometry;\n    const hasBoundsTree = hasBufferGeometry && obj.geometry.boundsTree;\n    if (hasBufferGeometry && !hasBoundsTree && obj.geometry.attributes.position) {\n      const geo = obj.geometry;\n      const triCount = geo.index ? geo.index.count / 3 : geo.attributes.position.count / 3;\n      // only bother using memory and time making a BVH if there are a reasonable number of tris,\n      // and if there are too many it's too painful and large to tolerate doing it (at least until\n      // we put this in a web worker)\n      if (triCount > 1000 && triCount < 1000000) {\n        // note that bounds tree construction creates an index as a side effect if one doesn't already exist\n        geo.boundsTree = new MeshBVH(obj.geometry, { strategy: 0, maxDepth: 30 });\n      }\n    }\n  });\n}\n\n// Modified version of Don McCurdy's AnimationUtils.clone\n// https://github.com/mrdoob/three.js/pull/14494\nfunction cloneSkinnedMesh(source) {\n  const cloneLookup = new Map();\n\n  const clone = source.clone();\n\n  parallelTraverse(source, clone, function(sourceNode, clonedNode) {\n    cloneLookup.set(sourceNode, clonedNode);\n    if (sourceNode.isMesh && sourceNode.geometry.boundsTree) {\n      clonedNode.geometry.boundsTree = sourceNode.geometry.boundsTree;\n    }\n  });\n\n  source.traverse(function(sourceMesh) {\n    if (!sourceMesh.isSkinnedMesh) return;\n\n    const sourceBones = sourceMesh.skeleton.bones;\n    const clonedMesh = cloneLookup.get(sourceMesh);\n\n    clonedMesh.skeleton = sourceMesh.skeleton.clone();\n\n    clonedMesh.skeleton.bones = sourceBones.map(function(sourceBone) {\n      if (!cloneLookup.has(sourceBone)) {\n        throw new Error(\"Required bones are not descendants of the given object.\");\n      }\n\n      return cloneLookup.get(sourceBone);\n    });\n\n    clonedMesh.bind(clonedMesh.skeleton, sourceMesh.bindMatrix);\n  });\n\n  return clone;\n}\n\nfunction cloneGltf(gltf) {\n  return {\n    animations: gltf.animations,\n    scene: cloneSkinnedMesh(gltf.scene)\n  };\n}\n\nfunction getHubsComponents(node) {\n  const hubsComponents =\n    node.userData.gltfExtensions &&\n    (node.userData.gltfExtensions.MOZ_hubs_components || node.userData.gltfExtensions.HUBS_components);\n\n  // We can remove support for legacy components when our environment, avatar and interactable models are\n  // updated to match Spoke output.\n  const legacyComponents = node.userData.components;\n\n  return hubsComponents || legacyComponents;\n}\n\n/// Walks the tree of three.js objects starting at the given node, using the GLTF data\n/// and template data to construct A-Frame entities and components when necessary.\n/// (It's unnecessary to construct entities for subtrees that have no component data\n/// or templates associated with any of their nodes.)\n///\n/// Returns the A-Frame entity associated with the given node, if one was constructed.\nconst inflateEntities = function(indexToEntityMap, node, templates, isRoot, modelToWorldScale = 1) {\n  // TODO: Remove this once we update the legacy avatars to the new node names\n  if (node.name === \"Chest\") {\n    node.name = \"Spine\";\n  } else if (node.name === \"Root Scene\") {\n    node.name = \"AvatarRoot\";\n  } else if (node.name === \"Bot_Skinned\") {\n    node.name = \"AvatarMesh\";\n  }\n\n  // inflate subtrees first so that we can determine whether or not this node needs to be inflated\n  const childEntities = [];\n  const children = node.children.slice(0); // setObject3D mutates the node's parent, so we have to copy\n  for (const child of children) {\n    const el = inflateEntities(indexToEntityMap, child, templates);\n    if (el) {\n      childEntities.push(el);\n    }\n  }\n\n  const entityComponents = getHubsComponents(node);\n\n  const nodeHasBehavior = !!entityComponents || node.name in templates;\n  if (!nodeHasBehavior && !childEntities.length && !isRoot) {\n    return null; // we don't need an entity for this node\n  }\n\n  const el = document.createElement(\"a-entity\");\n  el.append.apply(el, childEntities);\n\n  // Remove invalid CSS class name characters.\n  const className = (node.name || node.uuid).replace(/[^\\w-]/g, \"\");\n  el.classList.add(className);\n\n  // AFRAME rotation component expects rotations in YXZ, convert it\n  if (node.rotation.order !== \"YXZ\") {\n    node.rotation.setFromQuaternion(node.quaternion, \"YXZ\");\n  }\n\n  // Copy over the object's transform to the THREE.Group and reset the actual transform of the Object3D\n  // all updates to the object should be done through the THREE.Group wrapper\n  el.object3D.position.copy(node.position);\n  el.object3D.rotation.copy(node.rotation);\n  el.object3D.scale.copy(node.scale).multiplyScalar(modelToWorldScale);\n  el.object3D.matrixNeedsUpdate = true;\n\n  node.matrixAutoUpdate = false;\n  node.matrix.identity();\n  node.matrix.decompose(node.position, node.rotation, node.scale);\n\n  el.setObject3D(node.type.toLowerCase(), node);\n  if (entityComponents && \"nav-mesh\" in entityComponents) {\n    el.setObject3D(\"mesh\", node);\n  }\n\n  // Set the name of the `THREE.Group` to match the name of the node,\n  // so that `THREE.PropertyBinding` will find (and later animate)\n  // the group. See `PropertyBinding.findNode`:\n  // https://github.com/mrdoob/three.js/blob/dev/src/animation/PropertyBinding.js#L211\n  el.object3D.name = node.name;\n  if (node.animations) {\n    // Pass animations up to the group object so that when we can pass the group as\n    // the optional root in `THREE.AnimationMixer.clipAction` and use the hierarchy\n    // preserved under the group (but not the node). Otherwise `clipArray` will be\n    // `null` in `THREE.AnimationClip.findByName`.\n    node.parent.animations = node.animations;\n  }\n\n  const gltfIndex = node.userData.gltfIndex;\n  if (gltfIndex !== undefined) {\n    indexToEntityMap[gltfIndex] = el;\n  }\n\n  return el;\n};\n\nfunction inflateComponents(inflatedEntity, indexToEntityMap) {\n  inflatedEntity.object3D.traverse(object3D => {\n    const entityComponents = getHubsComponents(object3D);\n    const el = object3D.el;\n\n    if (entityComponents && el) {\n      for (const prop in entityComponents) {\n        if (entityComponents.hasOwnProperty(prop) && AFRAME.GLTFModelPlus.components.hasOwnProperty(prop)) {\n          const { componentName, inflator } = AFRAME.GLTFModelPlus.components[prop];\n          inflator(el, componentName, entityComponents[prop], entityComponents, indexToEntityMap);\n        }\n      }\n    }\n  });\n}\n\nfunction attachTemplate(root, name, templateRoot) {\n  const targetEls = root.querySelectorAll(\".\" + name);\n  for (const el of targetEls) {\n    const root = templateRoot.cloneNode(true);\n    // Merge root element attributes with the target element\n    for (const { name, value } of root.attributes) {\n      el.setAttribute(name, value);\n    }\n\n    // Append all child elements\n    while (root.children.length > 0) {\n      el.appendChild(root.children[0]);\n    }\n  }\n}\n\nexport async function loadGLTF(src, contentType, preferredTechnique, onProgress) {\n  let gltfUrl = src;\n  let fileMap;\n\n  if (contentType.includes(\"model/gltf+zip\") || contentType.includes(\"application/x-zip-compressed\")) {\n    fileMap = await extractZipFile(gltfUrl);\n    gltfUrl = fileMap[\"scene.gtlf\"];\n  }\n\n  const loadingManager = new THREE.LoadingManager();\n  loadingManager.setURLModifier(getCustomGLTFParserURLResolver(gltfUrl));\n  const gltfLoader = new THREE.GLTFLoader(loadingManager);\n\n  const parser = await new Promise((resolve, reject) => gltfLoader.createParser(gltfUrl, resolve, onProgress, reject));\n\n  const materials = parser.json.materials;\n  if (materials) {\n    for (let i = 0; i < materials.length; i++) {\n      const material = materials[i];\n\n      if (\n        material.extensions &&\n        material.extensions.MOZ_alt_materials &&\n        material.extensions.MOZ_alt_materials[preferredTechnique] !== undefined\n      ) {\n        const altMaterialIndex = material.extensions.MOZ_alt_materials[preferredTechnique];\n        materials[i] = materials[altMaterialIndex];\n      }\n    }\n  }\n\n  const nodes = parser.json.nodes;\n\n  if (nodes) {\n    for (let i = 0; i < nodes.length; i++) {\n      const node = nodes[i];\n\n      if (!node.extras) {\n        node.extras = {};\n      }\n\n      node.extras.gltfIndex = i;\n    }\n  }\n\n  const gltf = await new Promise(parser.parse.bind(parser));\n\n  gltf.scene.traverse(object => {\n    // GLTFLoader sets matrixAutoUpdate on animated objects, we want to keep the defaults\n    object.matrixAutoUpdate = THREE.Object3D.DefaultMatrixAutoUpdate;\n\n    object.material = mapMaterials(object, material => {\n      if (material.isMeshStandardMaterial && preferredTechnique === \"KHR_materials_unlit\") {\n        return MobileStandardMaterial.fromStandardMaterial(material);\n      }\n\n      return material;\n    });\n  });\n\n  if (fileMap) {\n    // The GLTF is now cached as a THREE object, we can get rid of the original blobs\n    Object.keys(fileMap).forEach(URL.revokeObjectURL);\n  }\n\n  return gltf;\n}\n\n/**\n * Loads a GLTF model, optionally recursively \"inflates\" the child nodes of a model into a-entities and sets\n * whitelisted components on them if defined in the node's extras.\n * @namespace gltf\n * @component gltf-model-plus\n */\nAFRAME.registerComponent(\"gltf-model-plus\", {\n  schema: {\n    src: { type: \"string\" },\n    contentType: { type: \"string\" },\n    useCache: { default: true },\n    inflate: { default: false },\n    modelToWorldScale: { type: \"number\", default: 1 }\n  },\n\n  init() {\n    this.preferredTechnique =\n      window.APP && window.APP.quality === \"low\" ? \"KHR_materials_unlit\" : \"pbrMetallicRoughness\";\n    this.loadTemplates();\n  },\n\n  update() {\n    this.applySrc(this.data.src, this.data.contentType);\n  },\n\n  loadTemplates() {\n    this.templates = {};\n    this.el.querySelectorAll(\":scope > template\").forEach(templateEl => {\n      const root = document.importNode(templateEl.firstElementChild || templateEl.content.firstElementChild, true);\n      this.templates[templateEl.getAttribute(\"data-name\")] = root;\n    });\n  },\n\n  async loadModel(src, contentType, technique, useCache) {\n    if (useCache) {\n      if (!GLTFCache[src]) {\n        GLTFCache[src] = await loadGLTF(src, contentType, technique);\n      }\n\n      return cloneGltf(GLTFCache[src]);\n    } else {\n      return await loadGLTF(src, contentType, technique);\n    }\n  },\n\n  async applySrc(src, contentType) {\n    try {\n      // If the src attribute is a selector, get the url from the asset item.\n      if (src && src.charAt(0) === \"#\") {\n        const assetEl = document.getElementById(src.substring(1));\n        src = assetEl.getAttribute(\"src\");\n      }\n\n      if (src === this.lastSrc) return;\n      this.lastSrc = src;\n\n      if (!src) {\n        if (this.inflatedEl) {\n          console.warn(\"gltf-model-plus set to an empty source, unloading inflated model.\");\n          this.disposeLastInflatedEl();\n        }\n        return;\n      }\n\n      this.el.emit(\"model-loading\");\n      const gltf = await this.loadModel(src, contentType, this.preferredTechnique, this.data.useCache);\n\n      // If we started loading something else already\n      // TODO: there should be a way to cancel loading instead\n      if (src != this.lastSrc) return;\n\n      // If we had inflated something already before, clean that up\n      this.disposeLastInflatedEl();\n\n      this.model = gltf.scene || gltf.scenes[0];\n      this.model.animations = gltf.animations;\n\n      if (gltf.animations.length > 0) {\n        this.el.setAttribute(\"animation-mixer\", {});\n        this.el.components[\"animation-mixer\"].initMixer(gltf.animations);\n      } else {\n        generateMeshBVH(this.model);\n      }\n\n      const indexToEntityMap = {};\n\n      let object3DToSet = this.model;\n      if (\n        this.data.inflate &&\n        (this.inflatedEl = inflateEntities(\n          indexToEntityMap,\n          this.model,\n          this.templates,\n          true,\n          this.data.modelToWorldScale\n        ))\n      ) {\n        this.el.appendChild(this.inflatedEl);\n\n        object3DToSet = this.inflatedEl.object3D;\n        // TODO: Still don't fully understand the lifecycle here and how it differs between browsers, we should dig in more\n        // Wait one tick for the appended custom elements to be connected before attaching templates\n        await nextTick();\n        if (src != this.lastSrc) return; // TODO: there must be a nicer pattern for this\n\n        inflateComponents(this.inflatedEl, indexToEntityMap);\n\n        for (const name in this.templates) {\n          attachTemplate(this.el, name, this.templates[name]);\n        }\n      }\n\n      // The call to setObject3D below recursively clobbers any `el` backreferences to entities\n      // in the entire inflated entity graph to point to `object3DToSet`.\n      //\n      // We don't want those overwritten, since lots of code assumes `object3d.el` points to the relevant\n      // A-Frame entity for that three.js object, so we back them up and re-wire them here. If we didn't do\n      // this, all the `el` properties on these object3ds would point to the `object3DToSet` which is either\n      // the model or the root GLTF inflated entity.\n      const rewires = [];\n\n      object3DToSet.traverse(o => {\n        const el = o.el;\n        if (el) rewires.push(() => (o.el = el));\n      });\n\n      const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\n\n      if (environmentMapComponent) {\n        environmentMapComponent.applyEnvironmentMap(object3DToSet);\n      }\n\n      this.el.setObject3D(\"mesh\", object3DToSet);\n\n      rewires.forEach(f => f());\n\n      this.el.emit(\"model-loaded\", { format: \"gltf\", model: this.model });\n    } catch (e) {\n      delete GLTFCache[src];\n      console.error(\"Failed to load glTF model\", e, this);\n      this.el.emit(\"model-error\", { format: \"gltf\", src });\n    }\n  },\n\n  disposeLastInflatedEl() {\n    if (this.inflatedEl) {\n      this.inflatedEl.parentNode.removeChild(this.inflatedEl);\n\n      this.inflatedEl.object3D.traverse(x => {\n        if (x.material && x.material.dispose) {\n          x.material.dispose();\n        }\n\n        if (x.geometry) {\n          if (x.geometry.dispose) {\n            x.geometry.dispose();\n          }\n\n          x.geometry.boundsTree = null;\n        }\n      });\n\n      delete this.inflatedEl;\n\n      this.el.removeAttribute(\"animation-mixer\");\n    }\n  }\n});\n","const adjectives = [\n  \"able\",\n  \"absolute\",\n  \"acceptable\",\n  \"acclaimed\",\n  \"accomplished\",\n  \"accurate\",\n  \"aching\",\n  \"acrobatic\",\n  \"adorable\",\n  \"adventurous\",\n  \"basic\",\n  \"belated\",\n  \"beloved\",\n  \"calm\",\n  \"candid\",\n  \"capital\",\n  \"carefree\",\n  \"caring\",\n  \"cautious\",\n  \"celebrated\",\n  \"charming\",\n  \"daring\",\n  \"darling\",\n  \"dearest\",\n  \"each\",\n  \"eager\",\n  \"early\",\n  \"earnest\",\n  \"easy\",\n  \"easygoing\",\n  \"ecstatic\",\n  \"edible\",\n  \"fabulous\",\n  \"fair\",\n  \"faithful\",\n  \"familiar\",\n  \"famous\",\n  \"fancy\",\n  \"fantastic\",\n  \"far\",\n  \"generous\",\n  \"gentle\",\n  \"genuine\",\n  \"giant\",\n  \"handmade\",\n  \"handsome\",\n  \"handy\",\n  \"happy\",\n  \"icy\",\n  \"ideal\",\n  \"identical\",\n  \"keen\",\n  \"lasting\",\n  \"lavish\",\n  \"magnificent\",\n  \"majestic\",\n  \"mammoth\",\n  \"marvelous\",\n  \"natural\",\n  \"obedient\",\n  \"palatable\",\n  \"parched\",\n  \"passionate\",\n  \"pastel\",\n  \"peaceful\",\n  \"perfect\",\n  \"perfumed\",\n  \"quaint\",\n  \"qualified\",\n  \"radiant\",\n  \"rapid\",\n  \"rare\",\n  \"safe\",\n  \"sandy\",\n  \"satisfied\",\n  \"scaly\",\n  \"scarce\",\n  \"scared\",\n  \"scary\",\n  \"scented\",\n  \"scientific\",\n  \"secret\",\n  \"sentimental\",\n  \"talkative\",\n  \"tangible\",\n  \"tart\",\n  \"tasty\",\n  \"tattered\",\n  \"teeming\",\n  \"ultimate\",\n  \"uncommon\",\n  \"unconscious\",\n  \"understated\",\n  \"warm\",\n  \"active\",\n  \"adept\",\n  \"admirable\",\n  \"admired\",\n  \"adorable\",\n  \"adored\",\n  \"advanced\",\n  \"affectionate\",\n  \"beneficial\",\n  \"best\",\n  \"better\",\n  \"big\",\n  \"cheerful\",\n  \"cheery\",\n  \"chief\",\n  \"chilly\",\n  \"classic\",\n  \"clean\",\n  \"clear\",\n  \"clever\",\n  \"decent\",\n  \"decisive\",\n  \"deep\",\n  \"defiant\",\n  \"definitive\",\n  \"delectable\",\n  \"delicious\",\n  \"elaborate\",\n  \"elastic\",\n  \"elated\",\n  \"elegant\",\n  \"elementary\",\n  \"elliptical\",\n  \"fast\",\n  \"favorable\",\n  \"favorite\",\n  \"fearless\",\n  \"gifted\",\n  \"glamorous\",\n  \"gleaming\",\n  \"glittering\",\n  \"harmonious\",\n  \"imaginative\",\n  \"immense\",\n  \"jealous\",\n  \"kind\",\n  \"leafy\",\n  \"legal\",\n  \"mature\",\n  \"mean\",\n  \"nautical\",\n  \"neat\",\n  \"necessary\",\n  \"needy\",\n  \"oddball\",\n  \"offbeat\",\n  \"periodic\",\n  \"perky\",\n  \"personal\",\n  \"pertinent\",\n  \"petty\",\n  \"quarterly\",\n  \"ready\",\n  \"real\",\n  \"realistic\",\n  \"reasonable\",\n  \"regal\",\n  \"serene\",\n  \"shabby\",\n  \"sharp\",\n  \"shiny\",\n  \"showy\",\n  \"shy\",\n  \"silky\",\n  \"tempting\",\n  \"tense\",\n  \"terrific\",\n  \"testy\",\n  \"thankful\",\n  \"uniform\",\n  \"unique\",\n  \"vast\",\n  \"weary\",\n  \"wee\",\n  \"welcome\",\n  \"agile\",\n  \"alarmed\",\n  \"alert\",\n  \"alive\",\n  \"bleak\",\n  \"blissful\",\n  \"blushing\",\n  \"coarse\",\n  \"colorful\",\n  \"colossal\",\n  \"comfortable\",\n  \"compassionate\",\n  \"complete\",\n  \"delightful\",\n  \"dense\",\n  \"dependable\",\n  \"dependent\",\n  \"descriptive\",\n  \"detailed\",\n  \"determined\",\n  \"devoted\",\n  \"different\",\n  \"eminent\",\n  \"emotional\",\n  \"enchanted\",\n  \"enchanting\",\n  \"energetic\",\n  \"enormous\",\n  \"fine\",\n  \"finished\",\n  \"firm\",\n  \"firsthand\",\n  \"fixed\",\n  \"flashy\",\n  \"flawless\",\n  \"glorious\",\n  \"glossy\",\n  \"golden\",\n  \"good\",\n  \"gorgeous\",\n  \"graceful\",\n  \"healthy\",\n  \"heartfelt\",\n  \"hearty\",\n  \"helpful\",\n  \"impartial\",\n  \"impressive\",\n  \"jolly\",\n  \"jovial\",\n  \"lighthearted\",\n  \"likable\",\n  \"lined\",\n  \"mellow\",\n  \"melodic\",\n  \"memorable\",\n  \"mild\",\n  \"new\",\n  \"opulent\",\n  \"playful\",\n  \"pleasant\",\n  \"pleasing\",\n  \"plump\",\n  \"plush\",\n  \"polished\",\n  \"polite\",\n  \"reliable\",\n  \"relieved\",\n  \"remarkable\",\n  \"remote\",\n  \"respectful\",\n  \"responsible\",\n  \"simple\",\n  \"simplistic\",\n  \"sizzling\",\n  \"sleepy\",\n  \"slight\",\n  \"slim\",\n  \"smart\",\n  \"smooth\",\n  \"snappy\",\n  \"snoopy\",\n  \"thirsty\",\n  \"this\",\n  \"thorough\",\n  \"those\",\n  \"thoughtful\",\n  \"united\",\n  \"vibrant\",\n  \"vicious\",\n  \"wellmade\",\n  \"whimsical\",\n  \"whirlwind\",\n  \"zesty\",\n  \"amazing\",\n  \"ambitious\",\n  \"ample\",\n  \"amused\",\n  \"amusing\",\n  \"ancient\",\n  \"angelic\",\n  \"antique\",\n  \"bold\",\n  \"bossy\",\n  \"both\",\n  \"bouncy\",\n  \"bountiful\",\n  \"complex\",\n  \"conscious\",\n  \"considerate\",\n  \"constant\",\n  \"content\",\n  \"conventional\",\n  \"cooked\",\n  \"cool\",\n  \"cooperative\",\n  \"diligent\",\n  \"dimwitted\",\n  \"direct\",\n  \"discrete\",\n  \"envious\",\n  \"essential\",\n  \"ethical\",\n  \"euphoric\",\n  \"flippant\",\n  \"fluffy\",\n  \"flustered\",\n  \"focused\",\n  \"fond\",\n  \"gracious\",\n  \"grand\",\n  \"grandiose\",\n  \"granular\",\n  \"grateful\",\n  \"grave\",\n  \"great\",\n  \"hidden\",\n  \"high\",\n  \"hilarious\",\n  \"homely\",\n  \"incomparable\",\n  \"incredible\",\n  \"infamous\",\n  \"joyful\",\n  \"lively\",\n  \"loathsome\",\n  \"lonely\",\n  \"long\",\n  \"mindless\",\n  \"miniature\",\n  \"minor\",\n  \"misty\",\n  \"next\",\n  \"nice\",\n  \"nifty\",\n  \"nimble\",\n  \"orderly\",\n  \"organic\",\n  \"ornate\",\n  \"popular\",\n  \"posh\",\n  \"positive\",\n  \"potable\",\n  \"powerful\",\n  \"powerless\",\n  \"precious\",\n  \"present\",\n  \"prestigious\",\n  \"quick\",\n  \"rewarding\",\n  \"rich\",\n  \"right\",\n  \"sociable\",\n  \"soft\",\n  \"solid\",\n  \"some\",\n  \"sophisticated\",\n  \"soulful\",\n  \"sparkling\",\n  \"spectacular\",\n  \"speedy\",\n  \"spicy\",\n  \"spiffy\",\n  \"spirited\",\n  \"spiteful\",\n  \"splendid\",\n  \"spotless\",\n  \"spry\",\n  \"thrifty\",\n  \"tidy\",\n  \"tight\",\n  \"timely\",\n  \"tinted\",\n  \"unruly\",\n  \"untimely\",\n  \"violet\",\n  \"wicked\",\n  \"wide\",\n  \"wild\",\n  \"willing\",\n  \"winding\",\n  \"windy\",\n  \"zigzag\",\n  \"apprehensive\",\n  \"appropriate\",\n  \"artistic\",\n  \"assured\",\n  \"astonishing\",\n  \"bright\",\n  \"brilliant\",\n  \"bronze\",\n  \"coordinated\",\n  \"courageous\",\n  \"courteous\",\n  \"crafty\",\n  \"crazy\",\n  \"creamy\",\n  \"creative\",\n  \"crisp\",\n  \"distant\",\n  \"distinct\",\n  \"downright\",\n  \"evergreen\",\n  \"everlasting\",\n  \"every\",\n  \"evil\",\n  \"excellent\",\n  \"excitable\",\n  \"exemplary\",\n  \"exhausted\",\n  \"forthright\",\n  \"fortunate\",\n  \"fragrant\",\n  \"frank\",\n  \"free\",\n  \"frequent\",\n  \"fresh\",\n  \"friendly\",\n  \"frightened\",\n  \"frigid\",\n  \"gripping\",\n  \"grounded\",\n  \"honest\",\n  \"honorable\",\n  \"honored\",\n  \"hopeful\",\n  \"hospitable\",\n  \"hot\",\n  \"huge\",\n  \"infatuated\",\n  \"infinite\",\n  \"informal\",\n  \"insistent\",\n  \"instructive\",\n  \"juicy\",\n  \"jumbo\",\n  \"knowing\",\n  \"knowledgeable\",\n  \"longterm\",\n  \"loud\",\n  \"lovable\",\n  \"loving\",\n  \"modern\",\n  \"modest\",\n  \"monumental\",\n  \"normal\",\n  \"notable\",\n  \"outgoing\",\n  \"precious\",\n  \"pretty\",\n  \"prickly\",\n  \"primary\",\n  \"pristine\",\n  \"private\",\n  \"prize\",\n  \"productive\",\n  \"profitable\",\n  \"quiet\",\n  \"quintessential\",\n  \"roasted\",\n  \"robust\",\n  \"square\",\n  \"squiggly\",\n  \"stable\",\n  \"staid\",\n  \"starry\",\n  \"steel\",\n  \"stimulating\",\n  \"striking\",\n  \"striped\",\n  \"strong\",\n  \"studious\",\n  \"stunning\",\n  \"tough\",\n  \"trained\",\n  \"treasured\",\n  \"tremendous\",\n  \"triangular\",\n  \"tricky\",\n  \"unused\",\n  \"unusual\",\n  \"upbeat\",\n  \"virtual\",\n  \"witty\",\n  \"wonderful\",\n  \"wooden\",\n  \"worldly\",\n  \"youthful\",\n  \"attached\",\n  \"attentive\",\n  \"attractive\",\n  \"austere\",\n  \"authentic\",\n  \"automatic\",\n  \"aware\",\n  \"awesome\",\n  \"bubbly\",\n  \"bustling\",\n  \"busy\",\n  \"buttery\",\n  \"cuddly\",\n  \"cultured\",\n  \"curly\",\n  \"curvy\",\n  \"cute\",\n  \"cylindrical\",\n  \"downright\",\n  \"dramatic\",\n  \"excited\",\n  \"exciting\",\n  \"exotic\",\n  \"experienced\",\n  \"expert\",\n  \"frosty\",\n  \"fruitful\",\n  \"full\",\n  \"fumbling\",\n  \"funny\",\n  \"fussy\",\n  \"growing\",\n  \"grown\",\n  \"gummy\",\n  \"humble\",\n  \"humongous\",\n  \"hungry\",\n  \"intelligent\",\n  \"interesting\",\n  \"known\",\n  \"kooky\",\n  \"loyal\",\n  \"lucky\",\n  \"luminous\",\n  \"lustrous\",\n  \"luxurious\",\n  \"multicolored\",\n  \"mysterious\",\n  \"noteworthy\",\n  \"numb\",\n  \"nutritious\",\n  \"outstanding\",\n  \"overjoyed\",\n  \"proper\",\n  \"proud\",\n  \"prudent\",\n  \"punctual\",\n  \"puny\",\n  \"pure\",\n  \"puzzled\",\n  \"puzzling\",\n  \"quirky\",\n  \"stupendous\",\n  \"sturdy\",\n  \"stylish\",\n  \"subdued\",\n  \"subtle\",\n  \"sunny\",\n  \"super\",\n  \"superb\",\n  \"supportive\",\n  \"surprised\",\n  \"sweet\",\n  \"swift\",\n  \"sympathetic\",\n  \"trivial\",\n  \"trusting\",\n  \"trustworthy\",\n  \"trusty\",\n  \"truthful\",\n  \"twin\",\n  \"usable\",\n  \"used\",\n  \"useful\",\n  \"utilized\",\n  \"vital\",\n  \"vivid\",\n  \"worried\",\n  \"worthwhile\",\n  \"worthy\",\n  \"writhing\",\n  \"wry\",\n  \"yummy\",\n  \"chocolate\",\n  \"crimson\",\n  \"cyan\",\n  \"fuchsia\",\n  \"gold\",\n  \"honeydew\",\n  \"lime\",\n  \"linen\",\n  \"magenta\",\n  \"olive\",\n  \"peru\",\n  \"salmon\",\n  \"seashell\",\n  \"sienna\",\n  \"snow\",\n  \"thistle\",\n  \"tomato\",\n  \"transparent\",\n  \"turquoise\",\n  \"violet\"\n];\n\nconst nouns = [\n  \"space\",\n  \"land\",\n  \"world\",\n  \"universe\",\n  \"plane\",\n  \"room\",\n  \"nation\",\n  \"plaza\",\n  \"gathering\",\n  \"meetup\",\n  \"get together\",\n  \"conclave\",\n  \"party\",\n  \"domain\",\n  \"dominion\",\n  \"realm\",\n  \"square\",\n  \"commons\",\n  \"park\",\n  \"cosmos\",\n  \"sphere\",\n  \"terrain\",\n  \"spot\",\n  \"zone\",\n  \"area\",\n  \"tract\",\n  \"turf\",\n  \"place\",\n  \"territory\",\n  \"volume\",\n  \"camp\",\n  \"picnic\",\n  \"outing\",\n  \"vacation\",\n  \"adventure\",\n  \"exploration\",\n  \"outing\",\n  \"walkabout\",\n  \"safari\",\n  \"venture\",\n  \"roundtable\",\n  \"barbecue\",\n  \"celebration\",\n  \"festivity\",\n  \"gala\",\n  \"shindig\",\n  \"social\",\n  \"convention\",\n  \"assembly\",\n  \"congregation\",\n  \"rendezvous\",\n  \"huddle\",\n  \"meet\",\n  \"soiree\"\n];\n\nexport function generateHubName() {\n  const randItem = set => {\n    const s = set[Math.floor(Math.random() * set.length)];\n    return s.charAt(0).toUpperCase() + s.slice(1);\n  };\n\n  return `${randItem(adjectives)} ${randItem(adjectives)} ${randItem(nouns)}`;\n}\n","import { Socket } from \"phoenix\";\nimport { generateHubName } from \"../utils/name-generation\";\n\nimport Store from \"../storage/store\";\n\nconst resolverLink = document.createElement(\"a\");\nexport function getReticulumFetchUrl(path, absolute = false) {\n  if (process.env.RETICULUM_SERVER) {\n    return `https://${process.env.RETICULUM_SERVER}${path}`;\n  } else if (absolute) {\n    resolverLink.href = path;\n    return resolverLink.href;\n  } else {\n    return path;\n  }\n}\n\nlet reticulumMeta = null;\nlet invalidatedReticulumMetaThisSession = false;\n\nexport async function invalidateReticulumMeta() {\n  invalidatedReticulumMetaThisSession = true;\n  reticulumMeta = null;\n}\n\nexport async function getReticulumMeta() {\n  if (!reticulumMeta) {\n    // Initially look up version based upon page, avoiding round-trip, otherwise fetch.\n    if (!invalidatedReticulumMetaThisSession && document.querySelector(\"meta[name='ret:version']\")) {\n      reticulumMeta = {\n        version: document.querySelector(\"meta[name='ret:version']\").getAttribute(\"value\"),\n        pool: document.querySelector(\"meta[name='ret:pool']\").getAttribute(\"value\"),\n        phx_host: document.querySelector(\"meta[name='ret:phx_host']\").getAttribute(\"value\")\n      };\n    } else {\n      await fetch(getReticulumFetchUrl(\"/api/v1/meta\")).then(async res => {\n        reticulumMeta = await res.json();\n      });\n    }\n  }\n\n  const qs = new URLSearchParams(location.search);\n  const phxHostOverride = qs.get(\"phx_host\");\n\n  if (phxHostOverride) {\n    reticulumMeta.phx_host = phxHostOverride;\n  }\n\n  return reticulumMeta;\n}\n\nexport async function connectToReticulum(debug = false, params = null) {\n  const qs = new URLSearchParams(location.search);\n\n  const getNewSocketUrl = async () => {\n    const socketProtocol = qs.get(\"phx_protocol\") || (document.location.protocol === \"https:\" ? \"wss:\" : \"ws:\");\n    let socketHost = qs.get(\"phx_host\");\n    let socketPort = qs.get(\"phx_port\");\n\n    const reticulumMeta = await getReticulumMeta();\n    socketHost = socketHost || reticulumMeta.phx_host;\n    socketPort = socketPort || (process.env.RETICULUM_SERVER.includes(\"hubs.local\") ? \"4000\" : \"443\"); // TODO phx_port\n    return `${socketProtocol}//${socketHost}${socketPort ? `:${socketPort}` : \"\"}`;\n  };\n\n  const socketUrl = await getNewSocketUrl();\n  console.log(`Phoenix Socket URL: ${socketUrl}`);\n\n  const socketSettings = {};\n\n  if (debug) {\n    socketSettings.logger = (kind, msg, data) => {\n      console.log(`${kind}: ${msg}`, data);\n    };\n  }\n\n  if (params) {\n    socketSettings.params = params;\n  }\n\n  const socket = new Socket(`${socketUrl}/socket`, socketSettings);\n  socket.connect();\n  socket.onError(async () => {\n    // On error, underlying reticulum node may have died, so rebalance by\n    // fetching a new healthy node to connect to.\n    invalidateReticulumMeta();\n\n    const endPointPath = new URL(socket.endPoint).pathname;\n    const newSocketUrl = await getNewSocketUrl();\n    const newEndPoint = `${newSocketUrl}${endPointPath}`;\n    console.log(`Socket error, changed endpoint to ${newEndPoint}`);\n    socket.endPoint = newEndPoint;\n  });\n\n  return socket;\n}\n\nexport function getLandingPageForPhoto(photoUrl) {\n  const parsedUrl = new URL(photoUrl);\n  return getReticulumFetchUrl(parsedUrl.pathname.replace(\".png\", \".html\") + parsedUrl.search, true);\n}\n\nexport function fetchReticulumAuthenticated(url, method = \"GET\", payload) {\n  const { token } = window.APP.store.state.credentials;\n  const retUrl = getReticulumFetchUrl(url);\n  const params = {\n    headers: {\n      \"content-type\": \"application/json\",\n      authorization: `bearer ${token}`\n    },\n    method\n  };\n  if (payload) {\n    params.body = JSON.stringify(payload);\n  }\n  return fetch(retUrl, params).then(async r => {\n    const result = await r.text();\n    try {\n      return JSON.parse(result);\n    } catch (e) {\n      // Some reticulum responses, particularly DELETE requests, don't return json.\n      return result;\n    }\n  });\n}\n\nexport async function createAndRedirectToNewHub(name, sceneId, sceneUrl, replace) {\n  const createUrl = getReticulumFetchUrl(\"/api/v1/hubs\");\n  const payload = { hub: { name: name || generateHubName() } };\n\n  if (sceneId) {\n    payload.hub.scene_id = sceneId;\n  } else {\n    payload.hub.default_environment_gltf_bundle_url = sceneUrl;\n  }\n\n  const headers = { \"content-type\": \"application/json\" };\n  const store = new Store();\n  if (store.state && store.state.credentials.token) {\n    headers.authorization = `bearer ${store.state.credentials.token}`;\n  }\n\n  let res = await fetch(createUrl, {\n    body: JSON.stringify(payload),\n    headers,\n    method: \"POST\"\n  }).then(r => r.json());\n\n  if (res.error === \"invalid_token\") {\n    // Clear the invalid token from store.\n    store.update({ credentials: { token: null, email: null } });\n\n    // Create hub anonymously\n    delete headers.authorization;\n    res = await fetch(createUrl, {\n      body: JSON.stringify(payload),\n      headers,\n      method: \"POST\"\n    }).then(r => r.json());\n  }\n\n  const hub = res;\n  let url = hub.url;\n\n  const creatorAssignmentToken = hub.creator_assignment_token;\n  if (creatorAssignmentToken) {\n    store.update({ creatorAssignmentTokens: [{ hubId: hub.hub_id, creatorAssignmentToken: creatorAssignmentToken }] });\n  }\n\n  if (process.env.RETICULUM_SERVER && document.location.host !== process.env.RETICULUM_SERVER) {\n    url = `/hub.html?hub_id=${hub.hub_id}`;\n  }\n\n  if (replace) {\n    document.location.replace(url);\n  } else {\n    document.location = url;\n  }\n}\n\nexport function getPresenceProfileForSession(presences, sessionId) {\n  const entry = Object.entries(presences || {}).find(([k]) => k === sessionId) || [];\n  const presence = entry[1];\n  return (presence && presence.metas && presence.metas[0].profile) || {};\n}\n\n// Takes the given channel, and creates a new channel with the same bindings\n// with the given socket, joins it, and leaves the old channel after joining.\n//\n// NOTE: This function relies upon phoenix channel object internals, so this\n// function will need to be reviewed if/when we ever update phoenix.js\nexport function migrateChannelToSocket(oldChannel, socket, params) {\n  const channel = socket.channel(oldChannel.topic, params || oldChannel.params);\n\n  for (let i = 0, l = oldChannel.bindings.length; i < l; i++) {\n    const item = oldChannel.bindings[i];\n    channel.on(item.event, item.callback);\n  }\n\n  for (let i = 0, l = oldChannel.pushBuffer.length; i < l; i++) {\n    const item = oldChannel.pushBuffer[i];\n    channel.push(item.event, item.payload, item.timeout);\n  }\n\n  const oldJoinPush = oldChannel.joinPush;\n  const joinPush = channel.join();\n\n  for (let i = 0, l = oldJoinPush.recHooks.length; i < l; i++) {\n    const item = oldJoinPush.recHooks[i];\n    joinPush.receive(item.status, item.callback);\n  }\n\n  return new Promise(resolve => {\n    joinPush.receive(\"ok\", () => {\n      // Clear all event handlers first so no duplicate messages come in.\n      oldChannel.bindings = [];\n      resolve(channel);\n    });\n  });\n}\n","export function findAncestorWithComponent(entity, componentName) {\n  while (entity && !(entity.components && entity.components[componentName])) {\n    entity = entity.parentNode;\n  }\n  return entity;\n}\n","module.exports = \"if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\\n  float ratio = 0.0;\\n\\n  if (hubs_EnableSweepingEffect) {\\n    float size = hubs_SweepParams.t - hubs_SweepParams.s;\\n    float line = mod(hubs_Time / 500.0 * size, size * 3.0) + hubs_SweepParams.s - size / 3.0;\\n\\n    if (hubs_WorldPosition.y < line) {\\n      // Highlight with a sweeping gradient.\\n      ratio = max(0.0, 1.0 - (line - hubs_WorldPosition.y) / (size * 1.5));\\n    }\\n  }\\n\\n  // Highlight with a gradient falling off with distance.\\n  float pulse = 9.0 + 3.0 * (sin(hubs_Time / 1000.0) + 1.0);\\n\\n  if (hubs_HighlightInteractorOne) {\\n    float dist1 = distance(hubs_WorldPosition, hubs_InteractorOnePos);\\n    ratio += -min(1.0, pow(dist1 * pulse, 3.0)) + 1.0;\\n  } \\n\\n  if (hubs_HighlightInteractorTwo) {\\n    float dist2 = distance(hubs_WorldPosition, hubs_InteractorTwoPos);\\n    ratio += -min(1.0, pow(dist2 * pulse, 3.0)) + 1.0;\\n  }\\n\\n  ratio = min(1.0, ratio);\\n\\n  // Gamma corrected highlight color\\n  vec3 highlightColor = vec3(0.184, 0.499, 0.933);\\n\\n  gl_FragColor.rgb = (gl_FragColor.rgb * (1.0 - ratio)) + (highlightColor * ratio);\\n}\\n\"","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posx-d235fb97df77b607be04b84125f40e7c.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negx-35034574e114423babdea92b6a2eb97a.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posy-d0c4e1e7979d75923d4d8b49c191bc6e.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negy-35808d21d1d17ac1b84d3184e365093b.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posz-de29aa8396196e4b040cd5305e351dbe.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negz-d73d18a8b7994524dc39a6ea3fcf43fc.jpg\";","import Store from \"./storage/store\";\nimport MediaSearchStore from \"./storage/media-search-store\";\n\nexport class App {\n  constructor() {\n    this.scene = null;\n    this.quality = \"low\";\n    this.store = new Store();\n    this.mediaSearchStore = new MediaSearchStore();\n  }\n\n  setQuality(quality) {\n    if (this.quality === quality) {\n      return false;\n    }\n\n    this.quality = quality;\n\n    if (this.scene) {\n      this.scene.dispatchEvent(new CustomEvent(\"quality-changed\", { detail: quality }));\n    }\n\n    return true;\n  }\n}\n","import { forEachMaterial } from \"../utils/material-utils\";\nimport cubeMapPosX from \"../assets/images/cubemap/posx.jpg\";\nimport cubeMapNegX from \"../assets/images/cubemap/negx.jpg\";\nimport cubeMapPosY from \"../assets/images/cubemap/posy.jpg\";\nimport cubeMapNegY from \"../assets/images/cubemap/negy.jpg\";\nimport cubeMapPosZ from \"../assets/images/cubemap/posz.jpg\";\nimport cubeMapNegZ from \"../assets/images/cubemap/negz.jpg\";\n\nexport async function createDefaultEnvironmentMap() {\n  const urls = [cubeMapPosX, cubeMapNegX, cubeMapPosY, cubeMapNegY, cubeMapPosZ, cubeMapNegZ];\n  const texture = await new Promise((resolve, reject) =>\n    new THREE.CubeTextureLoader().load(urls, resolve, undefined, reject)\n  );\n  texture.format = THREE.RGBFormat;\n  return texture;\n}\n\nAFRAME.registerComponent(\"environment-map\", {\n  schema: {\n    loadDefault: { type: \"boolean\", default: true }\n  },\n\n  init() {\n    this.environmentMap = null;\n\n    this.updateEnvironmentMap = this.updateEnvironmentMap.bind(this);\n\n    if (this.data.loadDefault) {\n      // Used in the avatar selector scene because there is no skybox.\n      createDefaultEnvironmentMap().then(this.updateEnvironmentMap);\n    }\n  },\n\n  updateEnvironmentMap(environmentMap) {\n    this.environmentMap = environmentMap;\n    this.applyEnvironmentMap(this.el.object3D);\n  },\n\n  applyEnvironmentMap(object3D) {\n    object3D.traverse(object => {\n      forEachMaterial(object, material => {\n        if (material.isMeshStandardMaterial) {\n          material.envMap = this.environmentMap;\n          material.needsUpdate = true;\n        }\n      });\n    });\n  }\n});\n","// removed by extract-text-webpack-plugin\nmodule.exports = {\"loading-text\":\"scene__loading-text__2zWvK\",\"loadingText\":\"scene__loading-text__2zWvK\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"tweetButton\":\"scene-ui__tweetButton__NAR59\",\"createButton\":\"scene-ui__createButton__1DQtQ\",\"optionsButton\":\"scene-ui__optionsButton__lzUHO\",\"ui\":\"scene-ui__ui__3JHPz\",\"logoTagline\":\"scene-ui__logoTagline___LR3I\",\"whiteOverlay\":\"scene-ui__whiteOverlay__1Pz3I\",\"grid\":\"scene-ui__grid__34j9h\",\"mainPanel\":\"scene-ui__mainPanel__IuYxi\",\"logo\":\"scene-ui__logo__26JnS\",\"info\":\"scene-ui__info__3Nznh\",\"name\":\"scene-ui__name__2-7V_\",\"attribution\":\"scene-ui__attribution__3nlIi\",\"screenshot\":\"scene-ui__screenshot__279rF\",\"screenshotHidden\":\"scene-ui__screenshotHidden__3nHWx\",\"spoke\":\"scene-ui__spoke___KrWT\",\"madeWith\":\"scene-ui__madeWith__A5stW\",\"createButtons\":\"scene-ui__createButtons__1COLQ\",\"unavailable\":\"scene-ui__unavailable__21hgO\"};","export const paths = {};\npaths.noop = \"/noop\";\npaths.actions = {};\npaths.actions.log = \"/actions/log\";\npaths.actions.toggleScreenShare = \"/actions/toggleScreenShare\";\npaths.actions.snapRotateLeft = \"/actions/snapRotateLeft\";\npaths.actions.snapRotateRight = \"/actions/snapRotateRight\";\npaths.actions.logDebugFrame = \"/actions/logDebugFrame\";\npaths.actions.logInteractionState = \"/actions/logInteractionState\";\npaths.actions.cameraDelta = \"/actions/cameraDelta\";\npaths.actions.characterAcceleration = \"/actions/characterAcceleration\";\npaths.actions.boost = \"/actions/boost\";\npaths.actions.startGazeTeleport = \"/actions/startTeleport\";\npaths.actions.stopGazeTeleport = \"/actions/stopTeleport\";\npaths.actions.spawnPen = \"/actions/spawnPen\";\npaths.actions.ensureFrozen = \"/actions/ensureFrozen\";\npaths.actions.toggleFreeze = \"/actions/toggleFreeze\";\npaths.actions.thaw = \"/actions/thaw\";\npaths.actions.muteMic = \"/actions/muteMic\";\npaths.actions.focusChat = \"/actions/focusChat\";\npaths.actions.focusChatCommand = \"/actions/focusChatCommand\";\npaths.actions.toggleCamera = \"/actions/toggleCamera\";\npaths.actions.takeSnapshot = \"/actions/takeSnapshot\";\npaths.actions.mediaExit = \"/actions/mediaExit\";\npaths.actions.mediaSearch1 = \"/actions/mediaSearch1\";\npaths.actions.mediaSearch2 = \"/actions/mediaSearch2\";\npaths.actions.mediaSearch3 = \"/actions/mediaSearch3\";\npaths.actions.mediaSearch4 = \"/actions/mediaSearch4\";\npaths.actions.mediaSearch5 = \"/actions/mediaSearch5\";\npaths.actions.mediaSearch6 = \"/actions/mediaSearch6\";\npaths.actions.mediaSearch7 = \"/actions/mediaSearch7\";\npaths.actions.mediaSearch8 = \"/actions/mediaSearch8\";\npaths.actions.transformModifier = \"/actions/transformModifier\";\npaths.actions.rayObjectRotation = \"/actions/rayObjectRotation\";\npaths.actions.cursor = {};\npaths.actions.cursor.pose = \"/actions/cursorPose\";\npaths.actions.cursor.grab = \"/actions/cursorGrab\";\npaths.actions.cursor.drop = \"/actions/cursorDrop\";\npaths.actions.cursor.modDelta = \"/actions/cursorModDelta\";\npaths.actions.cursor.startDrawing = \"/actions/cursorStartDrawing\";\npaths.actions.cursor.stopDrawing = \"/actions/cursorStopDrawing\";\npaths.actions.cursor.undoDrawing = \"/actions/cursorUndoDrawing\";\npaths.actions.cursor.penNextColor = \"/actions/cursorPenNextColor\";\npaths.actions.cursor.penPrevColor = \"/actions/cursorPenPrevColor\";\npaths.actions.cursor.scalePenTip = \"/actions/cursorScalePenTip\";\npaths.actions.cursor.scaleGrabbedGrabbable = \"/actions/cursorScaleGrabbedGrabbable\";\npaths.actions.cursor.mediaVolumeMod = \"/actions/cursor/mediaVolumeMod\";\npaths.actions.cursor.takeSnapshot = \"/actions/cursorTakeSnapshot\";\npaths.actions.pen = {};\npaths.actions.pen.remove = \"/actions/pen/remove\";\npaths.actions.rightHand = {};\npaths.actions.rightHand.matrix = \"/actions/rightHand/matrix\";\npaths.actions.rightHand.pose = \"/actions/rightHandPose\";\npaths.actions.rightHand.grab = \"/actions/rightHandGrab\";\npaths.actions.rightHand.drop = \"/actions/rightHandDrop\";\npaths.actions.rightHand.modDelta = \"/actions/rightHandModDelta\";\npaths.actions.rightHand.startDrawing = \"/actions/rightHandStartDrawing\";\npaths.actions.rightHand.stopDrawing = \"/actions/rightHandStopDrawing\";\npaths.actions.rightHand.undoDrawing = \"/actions/rightHandUndoDrawing\";\npaths.actions.rightHand.penNextColor = \"/actions/rightHandPenNextColor\";\npaths.actions.rightHand.penPrevColor = \"/actions/rightHandPenPrevColor\";\npaths.actions.rightHand.scalePenTip = \"/actions/rightHandScalePenTip\";\npaths.actions.rightHand.startTeleport = \"/actions/rightHand/startTeleport\";\npaths.actions.rightHand.stopTeleport = \"/actions/rightHand/stopTeleport\";\npaths.actions.rightHand.takeSnapshot = \"/actions/rightHandTakeSnapshot\";\npaths.actions.rightHand.thumb = \"/actions/rightHand/thumbDown\";\npaths.actions.rightHand.index = \"/actions/rightHand/indexDown\";\npaths.actions.rightHand.middleRingPinky = \"/actions/rightHand/middleRingPinkyDown\";\npaths.actions.leftHand = {};\npaths.actions.leftHand.matrix = \"/actions/leftHand/matrix\";\npaths.actions.leftHand.pose = \"/actions/leftHandPose\";\npaths.actions.leftHand.grab = \"/actions/leftHandGrab\";\npaths.actions.leftHand.drop = \"/actions/leftHandDrop\";\npaths.actions.leftHand.modDelta = \"/actions/leftHandModDelta\";\npaths.actions.leftHand.startDrawing = \"/actions/leftHandStartDrawing\";\npaths.actions.leftHand.stopDrawing = \"/actions/leftHandStopDrawing\";\npaths.actions.leftHand.undoDrawing = \"/actions/leftHandUndoDrawing\";\npaths.actions.leftHand.penNextColor = \"/actions/leftHandPenNextColor\";\npaths.actions.leftHand.penPrevColor = \"/actions/leftHandPenPrevColor\";\npaths.actions.leftHand.scalePenTip = \"/actions/leftHandScalePenTip\";\npaths.actions.leftHand.startTeleport = \"/actions/leftHand/startTeleport\";\npaths.actions.leftHand.stopTeleport = \"/actions/leftHand/stopTeleport\";\npaths.actions.leftHand.takeSnapshot = \"/actions/leftHandTakeSnapshot\";\npaths.actions.leftHand.thumb = \"/actions/leftHand/thumbDown\";\npaths.actions.leftHand.index = \"/actions/leftHand/indexDown\";\npaths.actions.leftHand.middleRingPinky = \"/actions/leftHand/middleRingPinkyDown\";\npaths.actions.camera = {};\npaths.actions.camera.exitMirror = \"/actions/cameraExitMirror\";\npaths.haptics = {};\npaths.haptics.actuators = {};\npaths.haptics.actuators.left = \"/haptics/actuators/left\";\npaths.haptics.actuators.right = \"/haptics/actuators/right\";\n\npaths.device = {};\npaths.device.mouse = {};\npaths.device.mouse.coords = \"/device/mouse/coords\";\npaths.device.mouse.movementXY = \"/device/mouse/movementXY\";\npaths.device.mouse.buttonLeft = \"/device/mouse/buttonLeft\";\npaths.device.mouse.buttonRight = \"/device/mouse/buttonRight\";\npaths.device.mouse.wheel = \"/device/mouse/wheel\";\npaths.device.smartMouse = {};\npaths.device.smartMouse.cursorPose = \"/device/smartMouse/cursorPose\";\npaths.device.smartMouse.cameraDelta = \"/device/smartMouse/cameraDelta\";\npaths.device.touchscreen = {};\npaths.device.touchscreen.cursorPose = \"/device/touchscreen/cursorPose\";\npaths.device.touchscreen.touchCameraDelta = \"/device/touchscreen/touchCameraDelta\";\npaths.device.touchscreen.gyroCameraDelta = \"/device/touchscreen/gyroCameraDelta\";\npaths.device.touchscreen.cameraDelta = \"/device/touchscreen/cameraDelta\";\npaths.device.touchscreen.pinch = {};\npaths.device.touchscreen.pinch.delta = \"/device/touchscreen/pinch/delta\";\npaths.device.touchscreen.pinch.initialDistance = \"/device/touchscreen/pinch/initialDistance\";\npaths.device.touchscreen.pinch.currentDistance = \"/device/touchscreen/pinch/currentDistance\";\npaths.device.touchscreen.isTouching = \"/device/touchscreen/isTouching\";\npaths.device.touchscreen.isTouchingGrabbable = \"/device/touchscreen/isTouchingGrabbable\";\npaths.device.touchscreen.tap1 = \"/device/touchscreen/tap1\";\npaths.device.touchscreen.tap2 = \"/device/touchscreen/tap2\";\npaths.device.touchscreen.tap3 = \"/device/touchscreen/tap3\";\npaths.device.touchscreen.tap4 = \"/device/touchscreen/tap4\";\npaths.device.touchscreen.tap5 = \"/device/touchscreen/tap5\";\npaths.device.gyro = {};\npaths.device.gyro.averageDeltaX = \"/device/gyro/averageDeltaX\";\npaths.device.gyro.averageDeltaY = \"/device/gyro/averageDeltaY\";\npaths.device.hud = {};\npaths.device.hud.penButton = \"/device/hud/penButton\";\n\npaths.device.keyboard = {\n  map: new Map(),\n  key: function(k) {\n    let path = this.map.get(k);\n    if (path) {\n      return path;\n    }\n    path = `/device/keyboard/${k.toLowerCase()}`;\n    this.map.set(k, path);\n    return path;\n  }\n};\n\npaths.device.gamepad = gamepadIndex => ({\n  button: buttonIndex => ({\n    pressed: `/device/gamepad/${gamepadIndex}/button/${buttonIndex}/pressed`,\n    touched: `/device/gamepad/${gamepadIndex}/button/${buttonIndex}/touched`,\n    value: `/device/gamepad/${gamepadIndex}/button/${buttonIndex}/value`\n  }),\n  axis: axisIndex => `/device/gamepad/${gamepadIndex}/axis/${axisIndex}`\n});\n\nconst xbox = \"/device/xbox/\";\npaths.device.xbox = {\n  button: buttonName => ({\n    pressed: `${xbox}button/${buttonName}/pressed`,\n    touched: `${xbox}button/${buttonName}/touched`,\n    value: `${xbox}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${xbox}axis/${axisName}`;\n  }\n};\n\npaths.device.oculusgo = {\n  // TODO remove these in favor of the direct accessors\n  button: buttonName => ({\n    pressed: `/device/oculusgo/button/${buttonName}/pressed`,\n    touched: `/device/oculusgo/button/${buttonName}/touched`,\n    value: `/device/oculusgo/button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `/device/oculusgo/axis/${axisName}`;\n  },\n  //\n  trigger: {\n    pressed: \"/device/oculusgo/button/trigger/pressed\",\n    touched: \"/device/oculusgo/button/trigger/touched\",\n    value: \"/device/oculusgo/button/trigger/value\"\n  },\n  touchpad: {\n    pressed: \"/device/oculusgo/button/touchpad/pressed\",\n    touched: \"/device/oculusgo/button/touchpad/touched\",\n    value: \"/device/oculusgo/button/touchpad/value\",\n    axisX: \"/device/oculusgo/axis/touchpadX\",\n    axisY: \"/device/oculusgo/axis/touchpadY\"\n  },\n  pose: \"/device/oculusgo/pose\",\n  matrix: \"/device/oculusgo/matrix\",\n  v: name => {\n    return `/vars/oculusgo/${name}`;\n  }\n};\n\nconst gearVRController = \"/device/gearVRController/\";\npaths.device.gearVRController = {\n  button: buttonName => ({\n    pressed: `${gearVRController}button/${buttonName}/pressed`,\n    touched: `${gearVRController}button/${buttonName}/touched`,\n    value: `${gearVRController}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${gearVRController}axis/${axisName}`;\n  },\n  pose: `${gearVRController}pose`,\n  matrix: `${gearVRController}matrix`,\n  v: name => {\n    return `/vars/gearVRController/${name}`;\n  }\n};\n\nconst daydream = \"/device/daydream/\";\npaths.device.daydream = {\n  button: buttonName => ({\n    pressed: `${daydream}button/${buttonName}/pressed`,\n    touched: `${daydream}button/${buttonName}/touched`,\n    value: `${daydream}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${daydream}axis/${axisName}`;\n  },\n  pose: `${daydream}pose`,\n  matrix: `${daydream}matrix`\n};\n\nconst rightOculusTouch = \"/device/rightOculusTouch/\";\npaths.device.rightOculusTouch = {\n  button: buttonName => ({\n    pressed: `${rightOculusTouch}button/${buttonName}/pressed`,\n    touched: `${rightOculusTouch}button/${buttonName}/touched`,\n    value: `${rightOculusTouch}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${rightOculusTouch}axis/${axisName}`;\n  },\n  pose: `${rightOculusTouch}pose`,\n  matrix: `${rightOculusTouch}matrix`\n};\n\nconst leftOculusTouch = \"/device/leftOculusTouch/\";\npaths.device.leftOculusTouch = {\n  button: buttonName => ({\n    pressed: `${leftOculusTouch}button/${buttonName}/pressed`,\n    touched: `${leftOculusTouch}button/${buttonName}/touched`,\n    value: `${leftOculusTouch}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${leftOculusTouch}axis/${axisName}`;\n  },\n  pose: `${leftOculusTouch}pose`,\n  matrix: `${leftOculusTouch}matrix`\n};\n\npaths.device.vive = {};\npaths.device.vive.left = {\n  button: buttonName => ({\n    pressed: `/device/vive/left/button/${buttonName}/pressed`,\n    touched: `/device/vive/left/button/${buttonName}/touched`,\n    value: `/device/vive/left/button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `/device/vive/left/axis/${axisName}`;\n  },\n  pose: `/device/vive/left/pose`,\n  matrix: `/device/vive/left/matrix`\n};\npaths.device.vive.right = {\n  button: buttonName => ({\n    pressed: `/device/vive/right/button/${buttonName}/pressed`,\n    touched: `/device/vive/right/button/${buttonName}/touched`,\n    value: `/device/vive/right/button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `/device/vive/right/axis/${axisName}`;\n  },\n  pose: `/device/vive/right/pose`,\n  matrix: `/device/vive/right/matrix`\n};\n\nfunction button(device, side, name) {\n  return {\n    pressed: `${device}${side}/button/${name}/pressed`,\n    touched: `${device}${side}/button/${name}/touched`,\n    value: `${device}${side}/button/${name}/value`\n  };\n}\n\nfunction axes(device, side, name) {\n  return {\n    axisX: `${device}${side}/axis/${name}X`,\n    axisY: `${device}${side}/axis/${name}Y`\n  };\n}\n\nfunction wmrController(side) {\n  const wmr = \"/device/wmr/\";\n  return {\n    touchpad: {\n      ...button(wmr, side, \"touchpad\"),\n      ...axes(wmr, side, \"touchpad\")\n    },\n    trigger: button(wmr, side, \"trigger\"),\n    grip: button(wmr, side, \"grip\"),\n    menu: button(wmr, side, \"menu\"),\n    joystick: axes(wmr, side, \"joystick\"),\n    pose: `${wmr}${side}/pose`,\n    matrix: `${wmr}${side}/matrix`\n  };\n}\npaths.device.wmr = {};\npaths.device.wmr.v = name => `/vars/wmr/${name}`;\npaths.device.wmr.k = name => `/vars/wmr/keyboard/${name}`;\npaths.device.wmr.left = wmrController(\"left\");\npaths.device.wmr.right = wmrController(\"right\");\n","/* global fetch THREE */\nimport URL_TICK from \"../assets/sfx/tick.mp3\";\nimport URL_TELEPORT_LOOP from \"../assets/sfx/teleport-loop.mp3\";\nimport URL_QUICK_TURN from \"../assets/sfx/quickTurn.mp3\";\nimport URL_TAP_MELLOW from \"../assets/sfx/tap_mellow.mp3\";\nimport URL_PEN_SPAWN from \"../assets/sfx/PenSpawn.mp3\";\nimport URL_PEN_DRAW from \"../assets/sfx/PenDraw1.mp3\";\nimport URL_CAMERA_SNAPSHOT from \"../assets/sfx/PicSnapHey.mp3\";\nimport URL_WELCOME from \"../assets/sfx/welcome.mp3\";\nimport URL_QUACK from \"../assets/sfx/quack.mp3\";\nimport URL_SPECIAL_QUACK from \"../assets/sfx/specialquack.mp3\";\nimport URL_POP from \"../assets/sfx/pop.mp3\";\nimport URL_FREEZE from \"../assets/sfx/Eb_blip.mp3\";\nimport URL_TACK from \"../assets/sfx/tack.mp3\";\nimport URL_MEDIA_LOADED from \"../assets/sfx/A_bendUp.mp3\";\nimport URL_MEDIA_LOADING from \"../assets/sfx/suspense.mp3\";\n\nlet soundEnum = 0;\nexport const SOUND_HOVER_OR_GRAB = soundEnum++;\nexport const SOUND_THAW = soundEnum++;\nexport const SOUND_PEN_STOP_DRAW = soundEnum++;\nexport const SOUND_PEN_UNDO_DRAW = soundEnum++;\nexport const SOUND_PEN_CHANGE_COLOR = soundEnum++;\nexport const SOUND_TOGGLE_MIC = soundEnum++;\nexport const SOUND_TELEPORT_START = soundEnum++;\nexport const SOUND_TELEPORT_END = soundEnum++;\nexport const SOUND_SNAP_ROTATE = soundEnum++;\nexport const SOUND_SPAWN_PEN = soundEnum++;\nexport const SOUND_PEN_START_DRAW = soundEnum++;\nexport const SOUND_CAMERA_TOOL_TOOK_SNAPSHOT = soundEnum++;\nexport const SOUND_ENTER_SCENE = soundEnum++;\nexport const SOUND_QUACK = soundEnum++;\nexport const SOUND_SPECIAL_QUACK = soundEnum++;\nexport const SOUND_CHAT_MESSAGE = soundEnum++;\nexport const SOUND_FREEZE = soundEnum++;\nexport const SOUND_PIN = soundEnum++;\nexport const SOUND_MEDIA_LOADING = soundEnum++;\nexport const SOUND_MEDIA_LOADED = soundEnum++;\n\nexport class SoundEffectsSystem {\n  constructor() {\n    this.pendingEffects = [];\n    this.audioContext = THREE.AudioContext.getContext();\n    const soundsAndUrls = [\n      [SOUND_HOVER_OR_GRAB, URL_TICK],\n      [SOUND_THAW, URL_TICK],\n      [SOUND_PEN_STOP_DRAW, URL_TICK],\n      [SOUND_PEN_UNDO_DRAW, URL_TICK],\n      [SOUND_PEN_CHANGE_COLOR, URL_TICK],\n      [SOUND_TOGGLE_MIC, URL_TICK],\n      [SOUND_TELEPORT_START, URL_TELEPORT_LOOP],\n      [SOUND_TELEPORT_END, URL_QUICK_TURN],\n      [SOUND_SNAP_ROTATE, URL_TAP_MELLOW],\n      [SOUND_SPAWN_PEN, URL_PEN_SPAWN],\n      [SOUND_PEN_START_DRAW, URL_PEN_DRAW],\n      [SOUND_CAMERA_TOOL_TOOK_SNAPSHOT, URL_CAMERA_SNAPSHOT],\n      [SOUND_ENTER_SCENE, URL_WELCOME],\n      [SOUND_QUACK, URL_QUACK],\n      [SOUND_SPECIAL_QUACK, URL_SPECIAL_QUACK],\n      [SOUND_CHAT_MESSAGE, URL_POP],\n      [SOUND_FREEZE, URL_FREEZE],\n      [SOUND_PIN, URL_TACK],\n      [SOUND_MEDIA_LOADING, URL_MEDIA_LOADING],\n      [SOUND_MEDIA_LOADED, URL_MEDIA_LOADED]\n    ];\n    const loading = new Map();\n    const load = url => {\n      let audioBufferPromise = loading.get(url);\n      if (!audioBufferPromise) {\n        audioBufferPromise = fetch(url)\n          .then(r => r.arrayBuffer())\n          .then(arrayBuffer => this.audioContext.decodeAudioData(arrayBuffer));\n        loading.set(url, audioBufferPromise);\n      }\n      return audioBufferPromise;\n    };\n    this.sounds = new Map();\n    soundsAndUrls.map(([sound, url]) => {\n      load(url).then(audioBuffer => {\n        this.sounds.set(sound, audioBuffer);\n      });\n    });\n  }\n\n  enqueueSound(sound, loop) {\n    const audioBuffer = this.sounds.get(sound);\n    if (!audioBuffer) return null;\n    // The nodes are very inexpensive to create, according to\n    // https://developer.mozilla.org/en-US/docs/Web/API/AudioBufferSourceNode\n    const source = this.audioContext.createBufferSource();\n    source.buffer = audioBuffer;\n    source.connect(this.audioContext.destination);\n    source.loop = loop;\n    this.pendingEffects.push(source);\n    return source;\n  }\n\n  playSoundOneShot(sound) {\n    return this.enqueueSound(sound, false);\n  }\n\n  playSoundLooped(sound) {\n    return this.enqueueSound(sound, true);\n  }\n\n  playSoundLoopedWithGain(sound) {\n    const audioBuffer = this.sounds.get(sound);\n    if (!audioBuffer) return null;\n\n    const source = this.audioContext.createBufferSource();\n    const gain = this.audioContext.createGain();\n    source.buffer = audioBuffer;\n    source.connect(gain);\n    gain.connect(this.audioContext.destination);\n    source.loop = true;\n    this.pendingEffects.push(source);\n    return { gain, source };\n  }\n\n  stopSoundNode(node) {\n    const index = this.pendingEffects.indexOf(node);\n    if (index !== -1) {\n      this.pendingEffects.splice(index, 1);\n    } else {\n      node.stop();\n    }\n  }\n\n  tick() {\n    for (let i = 0; i < this.pendingEffects.length; i++) {\n      this.pendingEffects[i].start();\n    }\n    this.pendingEffects.length = 0;\n  }\n}\n","// Computes an AABB that surrounds the object in question and all of its children.\n// Note that if the children have rotations, this probably won't return the tightest\n// possible AABB -- we could return a tighter one if we examined all of the vertices\n// of the geometry for ourselves, but we don't care enough for what we're using this\n// for to do so much work.\nconst computeObjectAABB = (function() {\n  const bounds = new THREE.Box3();\n  return function(root, target) {\n    target.makeEmpty();\n    root.traverse(node => {\n      const geometry = node.geometry;\n      if (geometry != null) {\n        if (geometry.boundingBox == null) {\n          geometry.computeBoundingBox();\n        }\n        target.union(bounds.copy(geometry.boundingBox).applyMatrix4(node.matrixWorld));\n      }\n    });\n    return target;\n  };\n})();\n\nconst rotation = new THREE.Euler();\nexport function getBox(entity, boxRoot) {\n  const box = new THREE.Box3();\n\n  rotation.copy(entity.object3D.rotation);\n  entity.object3D.rotation.set(0, 0, 0);\n\n  entity.object3D.updateMatrices(true, true);\n  boxRoot.updateMatrices(true, true);\n  boxRoot.updateMatrixWorld(true);\n\n  computeObjectAABB(boxRoot, box);\n\n  if (!box.isEmpty()) {\n    entity.object3D.worldToLocal(box.min);\n    entity.object3D.worldToLocal(box.max);\n    entity.object3D.rotation.copy(rotation);\n    entity.object3D.matrixNeedsUpdate = true;\n  }\n\n  boxRoot.matrixWorldNeedsUpdate = true;\n  boxRoot.updateMatrices();\n\n  return box;\n}\n\nexport function getScaleCoefficient(length, box) {\n  if (box.isEmpty()) return 1.0;\n\n  const { max, min } = box;\n  const dX = Math.abs(max.x - min.x);\n  const dY = Math.abs(max.y - min.y);\n  const dZ = Math.abs(max.z - min.z);\n  const lengthOfLongestComponent = Math.max(dX, dY, dZ);\n  return length / lengthOfLongestComponent;\n}\n","const THREE = AFRAME.THREE;\n\nfunction checkFloatTextureSupport() {\n  const renderer = new THREE.WebGLRenderer();\n\n  const scene = new THREE.Scene();\n  const size = 2;\n  const data = new Float32Array(size * size * 4);\n  const dataTexture = new THREE.DataTexture(data, size, size, THREE.RGBAFormat, THREE.FloatType);\n  const box = new THREE.Mesh(new THREE.PlaneBufferGeometry(1, 1), new THREE.MeshBasicMaterial({ map: dataTexture }));\n  box.material.map.needsUpdate = true;\n  scene.add(box);\n\n  renderer.render(scene, new THREE.Camera());\n  const result = renderer.context.getError() === 0;\n  renderer.dispose();\n  return result;\n}\n\nexport function patchWebGLRenderingContext() {\n  if (/Android.+Firefox/.test(navigator.userAgent)) {\n    // It appears that Galaxy S6 devices falsely report that they support\n    // OES_texture_float in Firefox. This workaround disables float textures\n    // for those devices.\n    // See https://github.com/mozilla/hubs/issues/32 and\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1338656\n    const originalGetExtension = WebGLRenderingContext.prototype.getExtension;\n    const supportsFloatTextures = checkFloatTextureSupport();\n    WebGLRenderingContext.prototype.getExtension = function patchedGetExtension(name) {\n      if (name === \"OES_texture_float\" && !supportsFloatTextures) {\n        return null;\n      }\n      return originalGetExtension.call(this, name);\n    };\n  }\n}\n","import { detectOS } from \"detect-browser\";\n\nexport function disableiOSZoom() {\n  if (detectOS(navigator.userAgent) !== \"iOS\") return;\n\n  let lastTouchAtMs = 0;\n\n  document.addEventListener(\"touchmove\", ev => {\n    if (ev.scale === 1) return;\n\n    ev.preventDefault();\n  });\n\n  document.addEventListener(\"touchend\", ev => {\n    const now = new Date().getTime();\n    const isDoubleTouch = now - lastTouchAtMs <= 300;\n    lastTouchAtMs = now;\n\n    if (isDoubleTouch) {\n      ev.preventDefault();\n    }\n  });\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nexport default class DialogContainer extends Component {\n  static propTypes = {\n    title: PropTypes.node,\n    children: PropTypes.node.isRequired,\n    onClose: PropTypes.func,\n    closable: PropTypes.bool,\n    wide: PropTypes.bool,\n    className: PropTypes.string\n  };\n\n  static defaultProps = {\n    closable: true\n  };\n\n  constructor(props) {\n    super(props);\n    this.onKeyDown = this.onKeyDown.bind(this);\n    this.onContainerClicked = this.onContainerClicked.bind(this);\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"keydown\", this.onKeyDown);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"keydown\", this.onKeyDown);\n  }\n\n  onKeyDown(e) {\n    if (this.props.closable && e.key === \"Escape\") {\n      this.props.onClose();\n    }\n  }\n\n  onContainerClicked = e => {\n    if (this.props.closable && e.currentTarget === e.target) {\n      this.props.onClose();\n    }\n  };\n\n  render() {\n    return (\n      <div className={classNames(\"dialog-overlay\", this.props.className)}>\n        <div className=\"dialog\" onClick={this.onContainerClicked}>\n          <div className={`dialog__box ${this.props.wide ? \"dialog__wide\" : \"\"} `}>\n            <div className=\"dialog__box__contents\">\n              {this.props.closable &&\n                this.props.onClose && (\n                  <WithHoverSound>\n                    <button className=\"dialog__box__contents__close\" onClick={() => this.props.onClose()}>\n                      <i>\n                        <FontAwesomeIcon icon={faTimes} />\n                      </i>\n                    </button>\n                  </WithHoverSound>\n                )}\n              <div className=\"dialog__box__contents__title\">{this.props.title}</div>\n              <div className=\"dialog__box__contents__body\">{this.props.children}</div>\n              <div className=\"dialog__box__contents__button-container\" />\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","export function addAnimationComponents(modelEl) {\n  if (!modelEl.components[\"animation-mixer\"]) {\n    return;\n  }\n\n  if (!modelEl.querySelector(\"[loop-animation]\")) {\n    modelEl.setAttribute(\"loop-animation\", \"\");\n  }\n}\n","// A-Frame blows away any npm debug log filters so this allow the user to set the log filter\n// via the query string.\nimport debug from \"debug\";\nimport qsTruthy from \"./qs_truthy\";\n\nconst qs = new URLSearchParams(location.search);\nconst isDebug = qsTruthy(\"debug\");\nconst logFilter = qs.get(\"log_filter\") || (isDebug && \"naf-janus-adapter:*\");\n\nif (logFilter) {\n  debug.enable(logFilter);\n}\n","/* eslint-disable */\n\n// Modified version of A-Frame's animation component to set matrixNeedsUpdate = true in the\n// scenario where the transform changes on an object during an animation.\n//\n// Changes are identified w comment // hubs\n//\n// Bugfix added 3/1/19 - If an animation component is removed before its delay setting, then\n// it erroneously restarts.\n\nvar anime = require(\"animejs\");\nvar components = AFRAME.components; // hubs\nvar registerComponent = AFRAME.registerComponent; // hubs\n//var THREE = require('../lib/three'); // hubs\nvar utils = AFRAME.utils; // hubs\n\ndelete AFRAME.components.animation; // hubs\n\nvar colorHelperFrom = new THREE.Color();\nvar colorHelperTo = new THREE.Color();\n\nvar getComponentProperty = utils.entity.getComponentProperty;\nvar setComponentProperty = utils.entity.setComponentProperty;\nvar splitCache = {};\n\nvar TYPE_COLOR = \"color\";\nvar PROP_POSITION = \"position\";\nvar PROP_ROTATION = \"rotation\";\nvar PROP_SCALE = \"scale\";\nvar STRING_COMPONENTS = \"components\";\nvar STRING_OBJECT3D = \"object3D\";\n\n/**\n * Animation component for A-Frame using anime.js.\n *\n * The component manually controls the tick by setting `autoplay: false` on anime.js and\n * manually * calling `animation.tick()` in the tick handler. To pause or resume, we toggle a\n * boolean * flag * `isAnimationPlaying`.\n *\n * anime.js animation config for tweenining Javascript objects and values works as:\n *\n *  config = {\n *    targets: {foo: 0.0, bar: '#000'},\n *    foo: 1.0,\n *    bar: '#FFF'\n *  }\n *\n * The above will tween each property in `targets`. The `to` values are set in the root of\n * the config.\n *\n * @member {object} animation - anime.js instance.\n * @member {boolean} animationIsPlaying - Control if animation is playing.\n */\nmodule.exports.Component = registerComponent(\"animation\", {\n  schema: {\n    autoplay: { default: true },\n    delay: { default: 0 },\n    dir: { default: \"\" },\n    dur: { default: 1000 },\n    easing: { default: \"easeInQuad\" },\n    elasticity: { default: 400 },\n    enabled: { default: true },\n    from: { default: \"\" },\n    loop: {\n      default: 0,\n      parse: function(value) {\n        // Boolean or integer.\n        if (value === true || value === \"true\") {\n          return true;\n        }\n        if (value === false || value === \"false\") {\n          return false;\n        }\n        return parseInt(value, 10);\n      }\n    },\n    property: { default: \"\" },\n    startEvents: { type: \"array\" },\n    pauseEvents: { type: \"array\" },\n    resumeEvents: { type: \"array\" },\n    round: { default: false },\n    to: { default: \"\" },\n    type: { default: \"\" },\n    isRawProperty: { default: false }\n  },\n\n  multiple: true,\n\n  init: function() {\n    var self = this;\n\n    this.eventDetail = { name: this.attrName };\n    this.time = 0;\n\n    this.animation = null;\n    this.animationIsPlaying = false;\n    this.onStartEvent = this.onStartEvent.bind(this);\n    this.beginAnimation = this.beginAnimation.bind(this);\n    this.pauseAnimation = this.pauseAnimation.bind(this);\n    this.resumeAnimation = this.resumeAnimation.bind(this);\n\n    this.fromColor = {};\n    this.toColor = {};\n    this.targets = {};\n    this.targetsArray = [];\n\n    this.updateConfigForDefault = this.updateConfigForDefault.bind(this);\n    this.updateConfigForRawColor = this.updateConfigForRawColor.bind(this);\n\n    this.config = {\n      complete: function() {\n        self.animationIsPlaying = false;\n        self.el.emit(\"animationcomplete\", self.eventDetail, false);\n        if (self.id) {\n          self.el.emit(\"animationcomplete__\" + self.id, self.eventDetail, false);\n        }\n      }\n    };\n  },\n\n  update: function(oldData) {\n    var config = this.config;\n    var data = this.data;\n\n    this.animationIsPlaying = false;\n\n    if (!this.data.enabled) {\n      return;\n    }\n\n    if (!data.property) {\n      return;\n    }\n\n    // Base config.\n    config.autoplay = false;\n    config.direction = data.dir;\n    config.duration = data.dur;\n    config.easing = data.easing;\n    config.elasticity = data.elasticity;\n    config.loop = data.loop;\n    config.round = data.round;\n\n    // Start new animation.\n    this.createAndStartAnimation();\n  },\n\n  tick: function(t, dt) {\n    if (!this.animationIsPlaying) {\n      return;\n    }\n    this.time += dt;\n    this.animation.tick(this.time);\n  },\n\n  remove: function() {\n    this.pauseAnimation();\n    this.removeEventListeners();\n    this.cancelDelayedStart(); // hubs\n  },\n\n  pause: function() {\n    this.paused = true;\n    this.pausedWasPlaying = this.animationIsPlaying;\n    this.pauseAnimation();\n    this.removeEventListeners();\n    this.cancelDelayedStart(); // hubs\n  },\n\n  /**\n   * `play` handler only for resuming scene.\n   */\n  play: function() {\n    if (!this.paused) {\n      return;\n    }\n    this.paused = false;\n    this.addEventListeners();\n    if (this.pausedWasPlaying) {\n      this.resumeAnimation();\n      this.pausedWasPlaying = false;\n    }\n  },\n\n  /**\n   * Start animation from scratch.\n   */\n  createAndStartAnimation: function() {\n    var data = this.data;\n\n    this.updateConfig();\n    this.animationIsPlaying = false;\n    this.animation = anime(this.config);\n\n    this.removeEventListeners();\n    this.cancelDelayedStart(); // hubs\n    this.addEventListeners();\n\n    // Wait for start events for animation.\n    if (!data.autoplay || (data.startEvents && data.startEvents.length)) {\n      return;\n    }\n\n    // Delay animation.\n    if (data.delay) {\n      // hubs\n      this.delayTimeout = setTimeout(this.beginAnimation, data.delay);\n      return;\n    }\n\n    // Play animation.\n    this.beginAnimation();\n  },\n\n  /**\n   * This is before animation start (including from startEvents).\n   * Set to initial state (config.from, time = 0, seekTime = 0).\n   */\n  beginAnimation: function() {\n    this.updateConfig();\n    this.time = 0;\n    this.animationIsPlaying = true;\n    this.stopRelatedAnimations();\n    this.el.emit(\"animationbegin\", this.eventDetail, false);\n  },\n\n  pauseAnimation: function() {\n    this.animationIsPlaying = false;\n  },\n\n  resumeAnimation: function() {\n    this.animationIsPlaying = true;\n  },\n\n  /**\n   * startEvents callback.\n   */\n  onStartEvent: function() {\n    if (!this.data.enabled) {\n      return;\n    }\n\n    this.updateConfig();\n    if (this.animation) {\n      this.animation.pause();\n    }\n    this.animation = anime(this.config);\n\n    // Include the delay before each start event.\n    if (this.data.delay) {\n      setTimeout(this.beginAnimation, this.data.delay);\n      return;\n    }\n    this.beginAnimation();\n  },\n\n  /**\n   * rawProperty: true and type: color;\n   */\n  updateConfigForRawColor: function() {\n    var config = this.config;\n    var data = this.data;\n    var el = this.el;\n    var from;\n    var key;\n    var to;\n\n    if (this.waitComponentInitRawProperty(this.updateConfigForRawColor)) {\n      return;\n    }\n\n    from = data.from === \"\" ? getRawProperty(el, data.property) : data.from;\n    to = data.to;\n\n    // Use r/g/b vector for color type.\n    this.setColorConfig(from, to);\n    from = this.fromColor;\n    to = this.toColor;\n\n    this.targetsArray.length = 0;\n    this.targetsArray.push(from);\n    config.targets = this.targetsArray;\n    for (key in to) {\n      config[key] = to[key];\n    }\n\n    config.update = (function() {\n      var lastValue = {};\n      return function(anim) {\n        var value;\n        value = anim.animatables[0].target;\n        // For animation timeline.\n        if (value.r === lastValue.r && value.g === lastValue.g && value.b === lastValue.b) {\n          return;\n        }\n\n        setRawProperty(el, data.property, value, data.type);\n      };\n    })();\n  },\n\n  /**\n   * Stuff property into generic `property` key.\n   */\n  updateConfigForDefault: function() {\n    var config = this.config;\n    var data = this.data;\n    var el = this.el;\n    var from;\n    var isBoolean;\n    var isNumber;\n    var to;\n\n    if (this.waitComponentInitRawProperty(this.updateConfigForDefault)) {\n      return;\n    }\n\n    if (data.from === \"\") {\n      // Infer from.\n      from = isRawProperty(data) ? getRawProperty(el, data.property) : getComponentProperty(el, data.property);\n    } else {\n      // Explicit from.\n      from = data.from;\n    }\n\n    to = data.to;\n\n    isNumber = !isNaN(from || to);\n    if (isNumber) {\n      from = parseFloat(from);\n      to = parseFloat(to);\n    } else {\n      from = from ? from.toString() : from;\n      to = to ? to.toString() : to;\n    }\n\n    // Convert booleans to integer to allow boolean flipping.\n    isBoolean = data.to === \"true\" || data.to === \"false\" || data.to === true || data.to === false;\n    if (isBoolean) {\n      from = data.from === \"true\" || data.from === true ? 1 : 0;\n      to = data.to === \"true\" || data.to === true ? 1 : 0;\n    }\n\n    this.targets.aframeProperty = from;\n    config.targets = this.targets;\n    config.aframeProperty = to;\n    config.update = (function() {\n      var lastValue;\n\n      return function(anim) {\n        var value;\n        value = anim.animatables[0].target.aframeProperty;\n\n        // Need to do a last value check for animation timeline since all the tweening\n        // begins simultaenously even if the value has not changed. Also better for perf\n        // anyways.\n        if (value === lastValue) {\n          return;\n        }\n        lastValue = value;\n\n        if (isBoolean) {\n          value = value >= 1;\n        }\n\n        if (isRawProperty(data)) {\n          setRawProperty(el, data.property, value, data.type);\n        } else {\n          setComponentProperty(el, data.property, value);\n        }\n      };\n    })();\n  },\n\n  /**\n   * Extend x/y/z/w onto the config.\n   * Update vector by modifying object3D.\n   */\n  updateConfigForVector: function() {\n    var config = this.config;\n    var data = this.data;\n    var el = this.el;\n    var key;\n    var from;\n    var to;\n\n    // Parse coordinates.\n    from =\n      data.from !== \"\"\n        ? utils.coordinates.parse(data.from) // If data.from defined, use that.\n        : getComponentProperty(el, data.property); // If data.from not defined, get on the fly.\n    to = utils.coordinates.parse(data.to);\n\n    if (data.property === PROP_ROTATION) {\n      toRadians(from);\n      toRadians(to);\n    }\n\n    // Set to and from.\n    this.targetsArray.length = 0;\n    this.targetsArray.push(from);\n    config.targets = this.targetsArray;\n    for (key in to) {\n      config[key] = to[key];\n    }\n\n    // If animating object3D transformation, run more optimized updater.\n    if (data.property === PROP_POSITION || data.property === PROP_ROTATION || data.property === PROP_SCALE) {\n      config.update = (function() {\n        var lastValue = {};\n        return function(anim) {\n          var value = anim.animatables[0].target;\n\n          if (data.property === PROP_SCALE) {\n            value.x = Math.max(0.0001, value.x);\n            value.y = Math.max(0.0001, value.y);\n            value.z = Math.max(0.0001, value.z);\n          }\n\n          // For animation timeline.\n          if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\n            return;\n          }\n\n          lastValue.x = value.x;\n          lastValue.y = value.y;\n          lastValue.z = value.z;\n\n          el.object3D[data.property].set(value.x, value.y, value.z);\n          el.object3D.matrixNeedsUpdate = true; // hubs\n        };\n      })();\n      return;\n    }\n\n    // Animating some vector.\n    config.update = (function() {\n      var lastValue = {};\n      return function(anim) {\n        var value = anim.animations[0].target;\n\n        // Animate rotation through radians.\n        // For animation timeline.\n        if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\n          return;\n        }\n        lastValue.x = value.x;\n        lastValue.y = value.y;\n        lastValue.z = value.z;\n        setComponentProperty(el, data.property, value);\n      };\n    })();\n  },\n\n  /**\n   * Update the config before each run.\n   */\n  updateConfig: function() {\n    var propType;\n\n    // Route config type.\n    propType = getPropertyType(this.el, this.data.property);\n    if (isRawProperty(this.data) && this.data.type === TYPE_COLOR) {\n      this.updateConfigForRawColor();\n    } else if (propType === \"vec2\" || propType === \"vec3\" || propType === \"vec4\") {\n      this.updateConfigForVector();\n    } else {\n      this.updateConfigForDefault();\n    }\n  },\n\n  /**\n   * Wait for component to initialize.\n   */\n  waitComponentInitRawProperty: function(cb) {\n    var componentName;\n    var data = this.data;\n    var el = this.el;\n    var self = this;\n\n    if (data.from !== \"\") {\n      return false;\n    }\n\n    if (!data.property.startsWith(STRING_COMPONENTS)) {\n      return false;\n    }\n\n    componentName = splitDot(data.property)[1];\n    if (el.components[componentName]) {\n      return false;\n    }\n\n    el.addEventListener(\"componentinitialized\", function wait(evt) {\n      if (evt.detail.name !== componentName) {\n        return;\n      }\n      cb();\n      // Since the config was created async, create the animation now since we missed it\n      // earlier.\n      self.animation = anime(self.config);\n      el.removeEventListener(\"componentinitialized\", wait);\n    });\n    return true;\n  },\n\n  /**\n   * Make sure two animations on the same property don't fight each other.\n   * e.g., animation__mouseenter=\"property: material.opacity\"\n   *       animation__mouseleave=\"property: material.opacity\"\n   */\n  stopRelatedAnimations: function() {\n    var component;\n    var componentName;\n    for (componentName in this.el.components) {\n      component = this.el.components[componentName];\n      if (componentName === this.attrName) {\n        continue;\n      }\n      if (component.name !== \"animation\") {\n        continue;\n      }\n      if (!component.animationIsPlaying) {\n        continue;\n      }\n      if (component.data.property !== this.data.property) {\n        continue;\n      }\n      component.animationIsPlaying = false;\n    }\n  },\n\n  addEventListeners: function() {\n    var data = this.data;\n    var el = this.el;\n    addEventListeners(el, data.startEvents, this.onStartEvent);\n    addEventListeners(el, data.pauseEvents, this.pauseAnimation);\n    addEventListeners(el, data.resumeEvents, this.resumeAnimation);\n  },\n\n  removeEventListeners: function() {\n    var data = this.data;\n    var el = this.el;\n    removeEventListeners(el, data.startEvents, this.onStartEvent);\n    removeEventListeners(el, data.pauseEvents, this.pauseAnimation);\n    removeEventListeners(el, data.resumeEvents, this.resumeAnimation);\n  },\n\n  // hubs\n  cancelDelayedStart: function() {\n    if (this.delayTimeout) {\n      clearTimeout(this.delayTimeout);\n      this.delayTimeout = null;\n    }\n  },\n\n  setColorConfig: function(from, to) {\n    colorHelperFrom.set(from);\n    colorHelperTo.set(to);\n    from = this.fromColor;\n    to = this.toColor;\n    from.r = colorHelperFrom.r;\n    from.g = colorHelperFrom.g;\n    from.b = colorHelperFrom.b;\n    to.r = colorHelperTo.r;\n    to.g = colorHelperTo.g;\n    to.b = colorHelperTo.b;\n  }\n});\n\n/**\n * Given property name, check schema to see what type we are animating.\n * We just care whether the property is a vector.\n */\nfunction getPropertyType(el, property) {\n  var component;\n  var componentName;\n  var split;\n  var propertyName;\n\n  split = property.split(\".\");\n  componentName = split[0];\n  propertyName = split[1];\n  component = el.components[componentName] || components[componentName];\n\n  // Primitives.\n  if (!component) {\n    return null;\n  }\n\n  // Dynamic schema. We only care about vectors anyways.\n  if (propertyName && !component.schema[propertyName]) {\n    return null;\n  }\n\n  // Multi-prop.\n  if (propertyName) {\n    return component.schema[propertyName].type;\n  }\n\n  // Single-prop.\n  return component.schema.type;\n}\n\n/**\n * Convert object to radians.\n */\nfunction toRadians(obj) {\n  obj.x = THREE.Math.degToRad(obj.x);\n  obj.y = THREE.Math.degToRad(obj.y);\n  obj.z = THREE.Math.degToRad(obj.z);\n}\n\nfunction addEventListeners(el, eventNames, handler) {\n  var i;\n  for (i = 0; i < eventNames.length; i++) {\n    el.addEventListener(eventNames[i], handler);\n  }\n}\n\nfunction removeEventListeners(el, eventNames, handler) {\n  var i;\n  for (i = 0; i < eventNames.length; i++) {\n    el.removeEventListener(eventNames[i], handler);\n  }\n}\n\nfunction getRawProperty(el, path) {\n  var i;\n  var split;\n  var value;\n  split = splitDot(path);\n  value = el;\n  for (i = 0; i < split.length; i++) {\n    value = value[split[i]];\n  }\n  return value;\n}\n\nfunction setRawProperty(el, path, value, type) {\n  var i;\n  var split;\n  var propertyName;\n  var targetValue;\n\n  if (path.startsWith(\"object3D.rotation\")) {\n    value = THREE.Math.degToRad(value);\n  }\n\n  // Walk.\n  split = splitDot(path);\n  targetValue = el;\n  for (i = 0; i < split.length - 1; i++) {\n    targetValue = targetValue[split[i]];\n  }\n  propertyName = split[split.length - 1];\n\n  // Raw color.\n  if (type === TYPE_COLOR) {\n    if (\"r\" in targetValue[propertyName]) {\n      targetValue[propertyName].r = value.r;\n      targetValue[propertyName].g = value.g;\n      targetValue[propertyName].b = value.b;\n    } else {\n      targetValue[propertyName].x = value.r;\n      targetValue[propertyName].y = value.g;\n      targetValue[propertyName].z = value.b;\n    }\n    return;\n  }\n\n  targetValue[propertyName] = value;\n}\n\nfunction splitDot(path) {\n  if (path in splitCache) {\n    return splitCache[path];\n  }\n  splitCache[path] = path.split(\".\");\n  return splitCache[path];\n}\n\nfunction isRawProperty(data) {\n  return data.isRawProperty || data.property.startsWith(STRING_COMPONENTS) || data.property.startsWith(STRING_OBJECT3D);\n}\n","/**\n * Instantiates and updates a THREE.AnimationMixer on an entity.\n * @component animation-mixer\n */\nAFRAME.registerComponent(\"animation-mixer\", {\n  initMixer(animations) {\n    this.mixer = new THREE.AnimationMixer(this.el.object3D);\n    this.el.object3D.animations = animations;\n    this.animations = animations;\n  },\n\n  tick: function(t, dt) {\n    if (this.mixer) {\n      this.mixer.update(dt / 1000);\n    }\n  }\n});\n","/**\n * Emits audioFrequencyChange events based on a networked audio source\n * @namespace avatar\n * @component networked-audio-analyser\n */\nAFRAME.registerComponent(\"networked-audio-analyser\", {\n  async init() {\n    this.volume = 0;\n    this.prevVolume = 0;\n    this.smoothing = 0.3;\n    this.threshold = 0.01;\n    this.el.addEventListener(\"sound-source-set\", event => {\n      const ctx = THREE.AudioContext.getContext();\n      this.analyser = ctx.createAnalyser();\n      this.analyser.fftSize = 32;\n      this.levels = new Uint8Array(this.analyser.frequencyBinCount);\n      event.detail.soundSource.connect(this.analyser);\n    });\n  },\n\n  tick: function() {\n    if (!this.analyser) return;\n\n    // take care with compatibility, e.g. safari doesn't support getFloatTimeDomainData\n    this.analyser.getByteTimeDomainData(this.levels);\n\n    let sum = 0;\n    for (let i = 0; i < this.levels.length; i++) {\n      const amplitude = (this.levels[i] - 128) / 128;\n      sum += amplitude * amplitude;\n    }\n    let currVolume = Math.sqrt(sum / this.levels.length);\n    if (currVolume < this.threshold) {\n      currVolume = 0;\n    }\n    this.volume = this.smoothing * currVolume + (1 - this.smoothing) * this.prevVolume;\n    this.prevVolume = this.volume;\n  }\n});\n\n/**\n * Sets an entity's scale base on audioFrequencyChange events.\n * @namespace avatar\n * @component scale-audio-feedback\n */\nAFRAME.registerComponent(\"scale-audio-feedback\", {\n  schema: {\n    minScale: { default: 1 },\n    maxScale: { default: 2 }\n  },\n\n  init() {\n    this._playerCamera = document.getElementById(\"player-camera\").object3D;\n    this._playerCameraWorldPosition = new THREE.Vector3();\n    this._worldPosition = new THREE.Vector3();\n  },\n\n  tick() {\n    // TODO: come up with a cleaner way to handle this.\n    // bone's are \"hidden\" by scaling them with bone-visibility, without this we would overwrite that.\n    if (!this.el.object3D.visible) return;\n\n    const { minScale, maxScale } = this.data;\n\n    const audioAnalyser = this.el.components[\"networked-audio-analyser\"];\n\n    if (!audioAnalyser) return;\n\n    const { object3D } = this.el;\n\n    this._playerCameraWorldPosition.setFromMatrixPosition(this._playerCamera.matrixWorld);\n    this._worldPosition.setFromMatrixPosition(object3D.matrixWorld);\n    const distance = this._worldPosition.distanceTo(this._playerCameraWorldPosition) / 10;\n\n    const scale = Math.min(maxScale, minScale + (maxScale - minScale) * audioAnalyser.volume * 8 * distance);\n\n    object3D.scale.setScalar(scale);\n    object3D.matrixNeedsUpdate = true;\n  }\n});\n","import { findAncestorWithComponent } from \"../utils/scene-graph\";\n\n/**\n * Loops the given clip using this entity's animation mixer\n * @component loop-animation\n */\nAFRAME.registerComponent(\"loop-animation\", {\n  schema: {\n    paused: { type: \"boolean\", default: false },\n    clip: { type: \"string\" }\n  },\n\n  init() {\n    this.mixerEl = findAncestorWithComponent(this.el, \"animation-mixer\");\n\n    if (!this.mixerEl) {\n      console.warn(\"loop-animation component could not find an animation-mixer in its ancestors.\");\n      return;\n    }\n\n    this.updateClip();\n  },\n\n  update(oldData) {\n    if ((oldData.clip !== this.data.clip || oldData.paused !== this.data.paused) && this.mixerEl) {\n      if (oldData.clip !== this.data.clip) {\n        this.updateClip();\n      }\n\n      if (this.currentAction) {\n        this.currentAction.paused = this.data.paused;\n      }\n    }\n  },\n\n  updateClip() {\n    const { mixer, animations } = this.mixerEl.components[\"animation-mixer\"];\n    const clipName = this.data.clip;\n\n    if (animations.length === 0) {\n      return;\n    }\n\n    let clip;\n\n    if (!clipName) {\n      clip = animations[0];\n    } else {\n      clip = animations.find(({ name }) => name === clipName);\n    }\n\n    if (!clip) {\n      return;\n    }\n\n    const action = mixer.clipAction(clip, this.el.object3D);\n    action.enabled = true;\n    action.setLoop(THREE.LoopRepeat, Infinity).play();\n    this.currentAction = action;\n  },\n\n  destroy() {\n    if (this.currentAction) {\n      this.currentAction.enabled = false;\n      this.currentAction.stop();\n    }\n  }\n});\n","import \"three/examples/js/pmrem/PMREMGenerator\";\nimport \"three/examples/js/pmrem/PMREMCubeUVPacker\";\nimport qsTruthy from \"../utils/qs_truthy\";\nconst isBotMode = qsTruthy(\"bot\");\n\n/**\n * @author zz85 / https://github.com/zz85\n *\n * Based on \"A Practical Analytic Model for Daylight\"\n * aka The Preetham Model, the de facto standard analytic skydome model\n * http://www.cs.utah.edu/~shirley/papers/sunsky/sunsky.pdf\n *\n * First implemented by Simon Wallner\n * http://www.simonwallner.at/projects/atmospheric-scattering\n *\n * Improved by Martin Upitis\n * http://blenderartists.org/forum/showthread.php?245954-preethams-sky-impementation-HDR\n *\n * Three.js integration by zz85 http://twitter.com/blurspline\n */\n\nTHREE.Sky = function() {\n  const shader = THREE.Sky.SkyShader;\n\n  const material = new THREE.ShaderMaterial({\n    fragmentShader: shader.fragmentShader,\n    vertexShader: shader.vertexShader,\n    uniforms: THREE.UniformsUtils.clone(shader.uniforms),\n    side: THREE.BackSide\n  });\n\n  THREE.Mesh.call(this, new THREE.BoxBufferGeometry(1, 1, 1), material);\n};\n\nTHREE.Sky.prototype = Object.create(THREE.Mesh.prototype);\nTHREE.Sky.prototype.constructor = THREE.Sky;\n\nTHREE.Sky.SkyShader = {\n  uniforms: {\n    luminance: { value: 1 },\n    turbidity: { value: 2 },\n    rayleigh: { value: 1 },\n    mieCoefficient: { value: 0.005 },\n    mieDirectionalG: { value: 0.8 },\n    sunPosition: { value: new THREE.Vector3() }\n  },\n\n  vertexShader: [\n    \"uniform vec3 sunPosition;\",\n    \"uniform float rayleigh;\",\n    \"uniform float turbidity;\",\n    \"uniform float mieCoefficient;\",\n\n    \"varying vec3 vWorldPosition;\",\n    \"varying vec3 vSunDirection;\",\n    \"varying float vSunfade;\",\n    \"varying vec3 vBetaR;\",\n    \"varying vec3 vBetaM;\",\n    \"varying float vSunE;\",\n\n    \"const vec3 up = vec3( 0.0, 1.0, 0.0 );\",\n\n    // constants for atmospheric scattering\n    \"const float e = 2.71828182845904523536028747135266249775724709369995957;\",\n    \"const float pi = 3.141592653589793238462643383279502884197169;\",\n\n    // wavelength of used primaries, according to preetham\n    \"const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );\",\n    // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:\n    // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))\n    \"const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );\",\n\n    // mie stuff\n    // K coefficient for the primaries\n    \"const float v = 4.0;\",\n    \"const vec3 K = vec3( 0.686, 0.678, 0.666 );\",\n    // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K\n    \"const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );\",\n\n    // earth shadow hack\n    // cutoffAngle = pi / 1.95;\n    \"const float cutoffAngle = 1.6110731556870734;\",\n    \"const float steepness = 1.5;\",\n    \"const float EE = 1000.0;\",\n\n    \"float sunIntensity( float zenithAngleCos ) {\",\n    \"\tzenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );\",\n    \"\treturn EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );\",\n    \"}\",\n\n    \"vec3 totalMie( float T ) {\",\n    \"\tfloat c = ( 0.2 * T ) * 10E-18;\",\n    \"\treturn 0.434 * c * MieConst;\",\n    \"}\",\n\n    \"void main() {\",\n\n    \"\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\",\n    \"\tvWorldPosition = worldPosition.xyz;\",\n\n    \"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n    \"\tvSunDirection = normalize( sunPosition );\",\n\n    \"\tvSunE = sunIntensity( dot( vSunDirection, up ) );\",\n\n    \"\tvSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );\",\n\n    \"\tfloat rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );\",\n\n    // extinction (absorbtion + out scattering)\n    // rayleigh coefficients\n    \"\tvBetaR = totalRayleigh * rayleighCoefficient;\",\n\n    // mie coefficients\n    \"\tvBetaM = totalMie( turbidity ) * mieCoefficient;\",\n\n    \"}\"\n  ].join(\"\\n\"),\n\n  fragmentShader: [\n    \"varying vec3 vWorldPosition;\",\n    \"varying vec3 vSunDirection;\",\n    \"varying float vSunfade;\",\n    \"varying vec3 vBetaR;\",\n    \"varying vec3 vBetaM;\",\n    \"varying float vSunE;\",\n\n    \"uniform float luminance;\",\n    \"uniform float mieDirectionalG;\",\n\n    \"const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );\",\n\n    // constants for atmospheric scattering\n    \"const float pi = 3.141592653589793238462643383279502884197169;\",\n\n    \"const float n = 1.0003;\", // refractive index of air\n    \"const float N = 2.545E25;\", // number of molecules per unit volume for air at\n    // 288.15K and 1013mb (sea level -45 celsius)\n\n    // optical length at zenith for molecules\n    \"const float rayleighZenithLength = 8.4E3;\",\n    \"const float mieZenithLength = 1.25E3;\",\n    \"const vec3 up = vec3( 0.0, 1.0, 0.0 );\",\n    // 66 arc seconds -> degrees, and the cosine of that\n    \"const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;\",\n\n    // 3.0 / ( 16.0 * pi )\n    \"const float THREE_OVER_SIXTEENPI = 0.05968310365946075;\",\n    // 1.0 / ( 4.0 * pi )\n    \"const float ONE_OVER_FOURPI = 0.07957747154594767;\",\n\n    \"float rayleighPhase( float cosTheta ) {\",\n    \"\treturn THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );\",\n    \"}\",\n\n    \"float hgPhase( float cosTheta, float g ) {\",\n    \"\tfloat g2 = pow( g, 2.0 );\",\n    \"\tfloat inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );\",\n    \"\treturn ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );\",\n    \"}\",\n\n    // Filmic ToneMapping http://filmicgames.com/archives/75\n    \"const float A = 0.15;\",\n    \"const float B = 0.50;\",\n    \"const float C = 0.10;\",\n    \"const float D = 0.20;\",\n    \"const float E = 0.02;\",\n    \"const float F = 0.30;\",\n\n    \"const float whiteScale = 1.0748724675633854;\", // 1.0 / Uncharted2Tonemap(1000.0)\n\n    \"vec3 Uncharted2Tonemap( vec3 x ) {\",\n    \"\treturn ( ( x * ( A * x + C * B ) + D * E ) / ( x * ( A * x + B ) + D * F ) ) - E / F;\",\n    \"}\",\n\n    \"void main() {\",\n    // optical length\n    // cutoff angle at 90 to avoid singularity in next formula.\n    \"\tfloat zenithAngle = acos( max( 0.0, dot( up, normalize( vWorldPosition - cameraPos ) ) ) );\",\n    \"\tfloat inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );\",\n    \"\tfloat sR = rayleighZenithLength * inverse;\",\n    \"\tfloat sM = mieZenithLength * inverse;\",\n\n    // combined extinction factor\n    \"\tvec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );\",\n\n    // in scattering\n    \"\tfloat cosTheta = dot( normalize( vWorldPosition - cameraPos ), vSunDirection );\",\n\n    \"\tfloat rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );\",\n    \"\tvec3 betaRTheta = vBetaR * rPhase;\",\n\n    \"\tfloat mPhase = hgPhase( cosTheta, mieDirectionalG );\",\n    \"\tvec3 betaMTheta = vBetaM * mPhase;\",\n\n    \"\tvec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );\",\n    \"\tLin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );\",\n\n    // nightsky\n    \"\tvec3 direction = normalize( vWorldPosition - cameraPos );\",\n    \"\tfloat theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]\",\n    \"\tfloat phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]\",\n    \"\tvec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );\",\n    \"\tvec3 L0 = vec3( 0.1 ) * Fex;\",\n\n    // composition + solar disc\n    \"\tfloat sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );\",\n    \"\tL0 += ( vSunE * 19000.0 * Fex ) * sundisk;\",\n\n    \"\tvec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );\",\n\n    \"\tvec3 curr = Uncharted2Tonemap( ( log2( 2.0 / pow( luminance, 4.0 ) ) ) * texColor );\",\n    \"\tvec3 color = curr * whiteScale;\",\n\n    \"\tvec3 retColor = pow( color, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );\",\n\n    \"\tgl_FragColor = vec4( retColor, 1.0 );\",\n\n    \"}\"\n  ].join(\"\\n\")\n};\n\nAFRAME.registerComponent(\"skybox\", {\n  schema: {\n    turbidity: { type: \"number\", default: 10 },\n    rayleigh: { type: \"number\", default: 2 },\n    luminance: { type: \"number\", default: 1 },\n    mieCoefficient: { type: \"number\", default: 0.005 },\n    mieDirectionalG: { type: \"number\", default: 0.8 },\n    inclination: { type: \"number\", default: 0 },\n    azimuth: { type: \"number\", default: 0.15 },\n    distance: { type: \"number\", default: 8000 }\n  },\n\n  init() {\n    this.sky = new THREE.Sky();\n    this.el.setObject3D(\"mesh\", this.sky);\n    this.skyScene = new THREE.Scene();\n    this.cubeCamera = new THREE.CubeCamera(1, 100000, 512);\n    this.skyScene.add(this.cubeCamera);\n\n    this.updateEnvironmentMap = this.updateEnvironmentMap.bind(this);\n    // HACK: Render environment map on next frame to avoid bug where the render target texture is black.\n    // EXTRA HACK: Added timeout due to additional case where texture is black in avatar-selector in Firefox.\n    // This is likely due to the custom elements attached callback being synchronous on Chrome but not Firefox.\n    requestAnimationFrame(() => setTimeout(this.updateEnvironmentMap));\n  },\n\n  update(oldData) {\n    const uniforms = this.sky.material.uniforms;\n\n    if (this.data.turbidity !== oldData.turbidity) {\n      uniforms.turbidity.value = this.data.turbidity;\n    }\n\n    if (this.data.rayleigh !== oldData.rayleigh) {\n      uniforms.rayleigh.value = this.data.rayleigh;\n    }\n\n    if (this.data.luminance !== oldData.luminance) {\n      uniforms.luminance.value = this.data.luminance;\n    }\n\n    if (this.data.mieCoefficient !== oldData.mieCoefficient) {\n      uniforms.mieCoefficient.value = this.data.mieCoefficient;\n    }\n\n    if (this.data.mieDirectionalG !== oldData.mieDirectionalG) {\n      uniforms.mieDirectionalG.value = this.data.mieDirectionalG;\n    }\n\n    if (\n      this.data.inclination !== oldData.inclination ||\n      this.data.azimuth !== oldData.azimuth ||\n      this.data.distance !== oldData.distance\n    ) {\n      const theta = Math.PI * (this.data.inclination - 0.5);\n      const phi = 2 * Math.PI * (this.data.azimuth - 0.5);\n\n      const distance = this.data.distance;\n\n      const x = distance * Math.cos(phi);\n      const y = distance * Math.sin(phi) * Math.sin(theta);\n      const z = distance * Math.sin(phi) * Math.cos(theta);\n\n      uniforms.sunPosition.value.set(x, y, z).normalize();\n\n      // HACK Remove this if condition and always set the scale based on distance when the existing environments\n      // have their sky scales set to 1.\n      if (this.el.object3D.scale.x === 1) {\n        this.sky.scale.set(distance, distance, distance);\n      }\n\n      this.el.object3D.matrixNeedsUpdate = true;\n    }\n\n    this.updateEnvironmentMap();\n  },\n\n  updateEnvironmentMap() {\n    const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\n\n    if (environmentMapComponent && !isBotMode) {\n      const renderer = this.el.sceneEl.renderer;\n      this.skyScene.add(this.sky);\n      this.cubeCamera.update(renderer, this.skyScene);\n      this.el.setObject3D(\"mesh\", this.sky);\n      const vrEnabled = renderer.vr.enabled;\n      renderer.vr.enabled = false;\n      const pmremGenerator = new THREE.PMREMGenerator(this.cubeCamera.renderTarget.texture);\n      pmremGenerator.update(renderer);\n      const pmremCubeUVPacker = new THREE.PMREMCubeUVPacker(pmremGenerator.cubeLods);\n      pmremCubeUVPacker.update(renderer);\n      renderer.vr.enabled = vrEnabled;\n      environmentMapComponent.updateEnvironmentMap(pmremCubeUVPacker.CubeUVRenderTarget.texture);\n      pmremGenerator.dispose();\n      pmremCubeUVPacker.dispose();\n    }\n  },\n\n  remove() {\n    this.el.removeObject3D(\"mesh\");\n  }\n});\n","const qs = new URLSearchParams(location.search);\n\nexport default function qsTruthy(param) {\n  const val = qs.get(param);\n  // if the param exists but is not set (e.g. \"?foo&bar\"), its value is the empty string.\n  return val === \"\" || /1|on|true|yes/i.test(val);\n}\n","import localeData from \"../assets/translations.data.json\";\nconst navigatorLang = ((navigator.languages && navigator.languages[0]) || navigator.language || navigator.userLanguage)\n  .toLowerCase()\n  .split(/[_-]+/)[0];\nexport const lang = (localeData[navigatorLang] && navigatorLang) || \"en\";\nexport const messages = localeData[lang] || localeData.en;\n","export function getSanitizedComponentMapping(inputComponent, inputProperty, publicComponents) {\n  const publicComponent = publicComponents[inputComponent];\n\n  if (!publicComponent) {\n    throw new Error(`Component \"${inputComponent}\" is not public.`);\n  }\n\n  const publicProperty = publicComponent.publicProperties[inputProperty];\n\n  if (!publicProperty) {\n    throw new Error(`Component \"${inputComponent}\"'s property \"${inputProperty}\" is not public.`);\n  }\n\n  return {\n    mappedComponent: publicComponent.mappedComponent,\n    mappedProperty: publicProperty.mappedProperty,\n    getMappedValue: publicProperty.getMappedValue\n  };\n}\n","import \"./components/gltf-model-plus\";\nimport { getSanitizedComponentMapping } from \"./utils/component-mappings\";\nimport { isHubsDestinationUrl } from \"./utils/media-utils\";\nconst PHYSICS_CONSTANTS = require(\"aframe-physics-system/src/constants\"),\n  TYPE = PHYSICS_CONSTANTS.TYPE,\n  SHAPE = PHYSICS_CONSTANTS.SHAPE,\n  FIT = PHYSICS_CONSTANTS.FIT;\nconst COLLISION_LAYERS = require(\"./constants\").COLLISION_LAYERS;\n\nAFRAME.GLTFModelPlus.registerComponent(\"duck\", \"duck\");\nAFRAME.GLTFModelPlus.registerComponent(\"quack\", \"quack\");\nAFRAME.GLTFModelPlus.registerComponent(\"sound\", \"sound\");\nAFRAME.GLTFModelPlus.registerComponent(\"css-class\", \"css-class\");\nAFRAME.GLTFModelPlus.registerComponent(\"interactable\", \"css-class\", (el, componentName) => {\n  el.setAttribute(componentName, \"interactable\");\n});\nAFRAME.GLTFModelPlus.registerComponent(\"super-spawner\", \"super-spawner\", (el, componentName, componentData) => {\n  //TODO: Do not automatically add these components\n  el.setAttribute(\"is-remote-hover-target\", \"\");\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\n  el.setAttribute(\"hoverable-visuals\", {\n    cursorController: \"#cursor-controller\"\n  });\n  el.setAttribute(componentName, componentData);\n});\nAFRAME.GLTFModelPlus.registerComponent(\"gltf-model-plus\", \"gltf-model-plus\");\nAFRAME.GLTFModelPlus.registerComponent(\"media-loader\", \"media-loader\");\nAFRAME.GLTFModelPlus.registerComponent(\"body\", \"ammo-body\", el => {\n  //This is only required for migration of old environments with super-spawners\n  //will no longer be needed when spawners are added via Spoke instead.\n  el.setAttribute(\"ammo-body\", {\n    mass: 0,\n    type: TYPE.STATIC,\n    collisionFilterGroup: COLLISION_LAYERS.INTERACTABLES,\n    collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER\n  });\n});\nAFRAME.GLTFModelPlus.registerComponent(\"ammo-shape\", \"ammo-shape\");\nAFRAME.GLTFModelPlus.registerComponent(\"hide-when-quality\", \"hide-when-quality\");\nAFRAME.GLTFModelPlus.registerComponent(\"light\", \"light\", (el, componentName, componentData) => {\n  if (componentData.distance === 0) {\n    componentData.decay = 0;\n  }\n  el.setAttribute(componentName, componentData);\n  if (componentData.castShadow) {\n    // HACK: component.light isn't set until one frame after setArrtibute\n    setTimeout(() => {\n      el.components.light.light.shadow.camera.matrixNeedsUpdate = true;\n    }, 0);\n  }\n});\nAFRAME.GLTFModelPlus.registerComponent(\"ambient-light\", \"ambient-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"directional-light\", \"directional-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"hemisphere-light\", \"hemisphere-light\");\nfunction decayMigration(el, componentName, componentData) {\n  if (componentData.range === 0) {\n    componentData.decay = 0;\n  }\n  el.setAttribute(componentName, componentData);\n}\nAFRAME.GLTFModelPlus.registerComponent(\"point-light\", \"point-light\", decayMigration);\nAFRAME.GLTFModelPlus.registerComponent(\"spot-light\", \"spot-light\", decayMigration);\n\nAFRAME.GLTFModelPlus.registerComponent(\"skybox\", \"skybox\");\nAFRAME.GLTFModelPlus.registerComponent(\"layers\", \"layers\");\nAFRAME.GLTFModelPlus.registerComponent(\"shadow\", \"shadow\");\nAFRAME.GLTFModelPlus.registerComponent(\"water\", \"water\");\nAFRAME.GLTFModelPlus.registerComponent(\"scale-audio-feedback\", \"scale-audio-feedback\");\nAFRAME.GLTFModelPlus.registerComponent(\"animation-mixer\", \"animation-mixer\");\nAFRAME.GLTFModelPlus.registerComponent(\"loop-animation\", \"loop-animation\");\nAFRAME.GLTFModelPlus.registerComponent(\n  \"box-collider\",\n  \"ammo-shape\",\n  (() => {\n    const euler = new THREE.Euler();\n    return (el, componentName, componentData) => {\n      const { scale, rotation } = componentData;\n      euler.set(rotation.x, rotation.y, rotation.z);\n      const orientation = new THREE.Quaternion().setFromEuler(euler);\n      el.setAttribute(componentName, {\n        type: SHAPE.BOX,\n        fit: FIT.MANUAL,\n        offset: componentData.position,\n        halfExtents: { x: scale.x / 2, y: scale.y / 2, z: scale.z / 2 },\n        orientation\n      });\n    };\n  })()\n);\nAFRAME.GLTFModelPlus.registerComponent(\"visible\", \"visible\", (el, componentName, componentData) => {\n  if (typeof componentData === \"object\") {\n    el.setAttribute(componentName, componentData.visible);\n  } else {\n    el.setAttribute(componentName, componentData);\n  }\n});\nAFRAME.GLTFModelPlus.registerComponent(\"spawn-point\", \"spawn-point\");\nAFRAME.GLTFModelPlus.registerComponent(\"sticky-zone\", \"sticky-zone\");\nAFRAME.GLTFModelPlus.registerComponent(\"nav-mesh\", \"nav-mesh\", (el, _componentName, componentData) => {\n  const nav = AFRAME.scenes[0].systems.nav;\n  const zone = componentData.zone || \"character\";\n  let found = false;\n  el.object3D.traverse(node => {\n    if (node.isMesh && !found) {\n      found = true;\n      nav.loadMesh(node, zone);\n    }\n  });\n  // There isn't actually an a-frame nav-mesh component, but we want to tag this el as a nav-mesh since\n  // nav-mesh-helper will query for it later.\n  el.setAttribute(\"nav-mesh\");\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"pinnable\", \"pinnable\");\n\nAFRAME.GLTFModelPlus.registerComponent(\"media\", \"media\", (el, componentName, componentData) => {\n  if (componentData.id) {\n    el.setAttribute(\"networked\", {\n      template: \"#interactable-media\",\n      owner: \"scene\",\n      persistent: true,\n      networkId: componentData.id\n    });\n  }\n\n  el.setAttribute(\"media-loader\", {\n    src: componentData.src,\n    resize: true,\n    resolve: true,\n    fileIsOwned: true,\n    animate: false\n  });\n\n  if (componentData.pageIndex) {\n    el.setAttribute(\"media-pager\", { index: componentData.pageIndex });\n  }\n\n  if (componentData.paused !== undefined) {\n    el.setAttribute(\"media-video\", { videoPaused: componentData.paused });\n  }\n\n  if (componentData.time) {\n    el.setAttribute(\"media-video\", { time: componentData.time });\n  }\n});\n\nfunction mediaInflator(el, componentName, componentData, components) {\n  let isControlled = true;\n\n  if (components.networked) {\n    // TODO: When non-hubs links can be traversed, make all link components controlled so you can open them.\n    isControlled =\n      componentData.controls || isHubsDestinationUrl(componentData.src) || isHubsDestinationUrl(componentData.href);\n\n    const hasVolume = componentName === \"video\";\n    const templateName = isControlled || hasVolume ? \"#static-controlled-media\" : \"#static-media\";\n\n    el.setAttribute(\"networked\", {\n      template: templateName,\n      owner: \"scene\",\n      persistent: true,\n      networkId: components.networked.id\n    });\n  }\n\n  const mediaOptions = {};\n\n  if (componentName === \"video\" || componentName === \"image\") {\n    mediaOptions.projection = componentData.projection;\n  }\n\n  if (componentName === \"video\") {\n    mediaOptions.videoPaused = !componentData.autoPlay;\n    mediaOptions.volume = componentData.volume;\n    mediaOptions.loop = componentData.loop;\n    mediaOptions.audioType = componentData.audioType;\n    mediaOptions.hidePlaybackControls = !isControlled;\n\n    if (componentData.audioType === \"pannernode\") {\n      mediaOptions.distanceModel = componentData.distanceModel;\n      mediaOptions.rolloffFactor = componentData.rolloffFactor;\n      mediaOptions.refDistance = componentData.refDistance;\n      mediaOptions.maxDistance = componentData.maxDistance;\n      mediaOptions.coneInnerAngle = componentData.coneInnerAngle;\n      mediaOptions.coneOuterAngle = componentData.coneOuterAngle;\n      mediaOptions.coneOuterGain = componentData.coneOuterGain;\n    }\n\n    el.setAttribute(\"video-pause-state\", { paused: mediaOptions.videoPaused });\n  }\n\n  const src = componentName === \"link\" ? componentData.href : componentData.src;\n\n  el.setAttribute(\"media-loader\", {\n    src,\n    resize: true,\n    resolve: true,\n    fileIsOwned: true,\n    animate: false,\n    mediaOptions\n  });\n}\n\nAFRAME.GLTFModelPlus.registerComponent(\"image\", \"image\", mediaInflator);\nAFRAME.GLTFModelPlus.registerComponent(\"video\", \"video\", mediaInflator, (name, property, value) => {\n  if (property === \"paused\") {\n    return { name: \"video-pause-state\", property, value };\n  } else {\n    return null;\n  }\n});\nAFRAME.GLTFModelPlus.registerComponent(\"link\", \"link\", mediaInflator);\n\nAFRAME.GLTFModelPlus.registerComponent(\"hoverable\", \"is-remote-hover-target\", el => {\n  el.setAttribute(\"is-remote-hover-target\", \"\");\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"spawner\", \"spawner\", (el, componentName, componentData) => {\n  el.setAttribute(\"media-loader\", {\n    src: componentData.src,\n    resolve: true,\n    fileIsOwned: true,\n    animate: false\n  });\n  el.setAttribute(\"css-class\", \"interactable\");\n  el.setAttribute(\"super-spawner\", {\n    src: componentData.src,\n    resolve: true,\n    template: \"#interactable-media\"\n  });\n  el.setAttribute(\"hoverable-visuals\", {\n    cursorController: \"#cursor-controller\"\n  });\n  el.setAttribute(\"ammo-body\", {\n    mass: 0,\n    type: TYPE.STATIC,\n    collisionFilterGroup: COLLISION_LAYERS.INTERACTABLES,\n    collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER\n  });\n  el.setAttribute(\"is-remote-hover-target\", \"\");\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\n});\n\nconst publicComponents = {\n  video: {\n    mappedComponent: \"video-pause-state\",\n    publicProperties: {\n      paused: {\n        mappedProperty: \"paused\",\n        getMappedValue(value) {\n          return !!value;\n        }\n      }\n    }\n  },\n  \"loop-animation\": {\n    mappedComponent: \"loop-animation\",\n    publicProperties: {\n      paused: {\n        mappedProperty: \"paused\",\n        getMappedValue(value) {\n          return !!value;\n        }\n      }\n    }\n  }\n};\n\nAFRAME.GLTFModelPlus.registerComponent(\n  \"trigger-volume\",\n  \"trigger-volume\",\n  (el, componentName, componentData, components, indexToEntityMap) => {\n    const {\n      size,\n      target,\n      enterComponent,\n      enterProperty,\n      enterValue,\n      leaveComponent,\n      leaveProperty,\n      leaveValue\n    } = componentData;\n\n    let enterComponentMapping, leaveComponentMapping, targetEntity;\n\n    try {\n      enterComponentMapping = getSanitizedComponentMapping(enterComponent, enterProperty, publicComponents);\n      leaveComponentMapping = getSanitizedComponentMapping(leaveComponent, leaveProperty, publicComponents);\n\n      targetEntity = indexToEntityMap[target];\n\n      if (!targetEntity) {\n        throw new Error(`Couldn't find target entity with index: ${target}.`);\n      }\n    } catch (e) {\n      console.warn(`Error inflating gltf component \"trigger-volume\": ${e.message}`);\n      return;\n    }\n\n    // Filter out scope and colliders properties.\n    el.setAttribute(\"trigger-volume\", {\n      colliders: \"#player-camera\",\n      size,\n      target: targetEntity,\n      enterComponent: enterComponentMapping.mappedComponent,\n      enterProperty: enterComponentMapping.mappedProperty,\n      enterValue: enterComponentMapping.getMappedValue(enterValue),\n      leaveComponent: leaveComponentMapping.mappedComponent,\n      leaveProperty: leaveComponentMapping.mappedProperty,\n      leaveValue: leaveComponentMapping.getMappedValue(leaveValue)\n    });\n  }\n);\n","module.exports = __webpack_public_path__ + \"assets/LoadingObject_Atom-7dcc3b81897e68b740c1cf12b6cf4c3f.glb\";","module.exports = __webpack_public_path__ + \"assets/sfx/teleport-loop-84e2caa4f62e5c6d6ce339b0c715c06d.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/quickTurn-cda89edb1a7a32e4442cac70cd2694be.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/tap_mellow-673398d6e97818ec4b675708d460bd0f.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/PenSpawn-aac1f534773040f0fafa41e9db76017b.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/PenDraw1-ddbdc17a6beefecbca2685c8c9d0d2d5.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/PicSnapHey-0228ddd197e5a6d88f7bcd2ceb340f8e.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/welcome-0083300978d5dd05eaa376f65761da47.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/quack-1f18502834f8f1db43990b769c2ab193.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/specialquack-6d1a192a6092e8dfed5d3de063755ee2.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/pop-5784f3bcfaf98637147737448d6df8df.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/Eb_blip-8d7302990e83d6798400a6027dce3936.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/tack-0d55b064794faaa1733fcf6bc89cad0c.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/A_bendUp-de32e556413bb2a527fb514984738c70.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/suspense-f27c64840e5ede36ec694c22a030615c.mp3\";","module.exports = __webpack_public_path__ + \"assets/waternormals-4418dde3f6abc21dc32506acf5f5b093.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/hub-preview-white-ccefba3b70ae589a0ca5ae3230c39299.png\";","import { avatars } from \"../assets/avatars/avatars.js\";\n\nconst names = [\n  \"Baers-Pochard\",\n  \"Baikal-Teal\",\n  \"Barrows-Goldeneye\",\n  \"Blue-Billed\",\n  \"Blue-Duck\",\n  \"Blue-Winged\",\n  \"Brown-Teal\",\n  \"Bufflehead\",\n  \"Canvasback\",\n  \"Cape-Shoveler\",\n  \"Chestnut-Teal\",\n  \"Chiloe-Wigeon\",\n  \"Cinnamon-Teal\",\n  \"Comb-Duck\",\n  \"Common-Eider\",\n  \"Common-Goldeneye\",\n  \"Common-Merganser\",\n  \"Common-Pochard\",\n  \"Common-Scoter\",\n  \"Common-Shelduck\",\n  \"Cotton-Pygmy\",\n  \"Crested-Duck\",\n  \"Crested-Shelduck\",\n  \"Eatons-Pintail\",\n  \"Falcated\",\n  \"Ferruginous\",\n  \"Freckled-Duck\",\n  \"Gadwall\",\n  \"Garganey\",\n  \"Greater-Scaup\",\n  \"Green-Pygmy\",\n  \"Grey-Teal\",\n  \"Hardhead\",\n  \"Harlequin\",\n  \"Hartlaubs\",\n  \"Hooded-Merganser\",\n  \"Hottentot-Teal\",\n  \"Kelp-Goose\",\n  \"King-Eider\",\n  \"Lake-Duck\",\n  \"Laysan-Duck\",\n  \"Lesser-Scaup\",\n  \"Long-Tailed\",\n  \"Maccoa-Duck\",\n  \"Mallard\",\n  \"Mandarin\",\n  \"Marbled-Teal\",\n  \"Mellers-Duck\",\n  \"Merganser\",\n  \"Northern-Pintail\",\n  \"Orinoco-Goose\",\n  \"Paradise-Shelduck\",\n  \"Plumed-Whistler\",\n  \"Puna-Teal\",\n  \"Pygmy-Goose\",\n  \"Radjah-Shelduck\",\n  \"Red-Billed\",\n  \"Red-Crested\",\n  \"Red-Shoveler\",\n  \"Ring-Necked\",\n  \"Ringed-Teal\",\n  \"Rosy-Billed\",\n  \"Ruddy-Shelduck\",\n  \"Salvadoris-Teal\",\n  \"Scaly-Sided\",\n  \"Shelduck\",\n  \"Shoveler\",\n  \"Silver-Teal\",\n  \"Smew\",\n  \"Spectacled-Eider\",\n  \"Spot-Billed\",\n  \"Spotted-Whistler\",\n  \"Steamerduck\",\n  \"Stellers-Eider\",\n  \"Sunda-Teal\",\n  \"Surf-Scoter\",\n  \"Tufted-Duck\",\n  \"Velvet-Scoter\",\n  \"Wandering-Whistler\",\n  \"Whistling-duck\",\n  \"White-Backed\",\n  \"White-Cheeked\",\n  \"White-Winged\",\n  \"Wigeon\",\n  \"Wood-Duck\",\n  \"Yellow-Billed\"\n];\n\nfunction selectRandom(arr) {\n  return arr[Math.floor(Math.random() * arr.length)];\n}\n\nexport function generateRandomName() {\n  return `${selectRandom(names)}-${Math.floor(10000 + Math.random() * 10000)}`;\n}\n\nexport const avatarIds = avatars.map(av => av.id);\n\nexport function generateDefaultProfile() {\n  return {\n    avatarId: selectRandom(avatarIds)\n  };\n}\n","import { Validator } from \"jsonschema\";\nimport merge from \"deepmerge\";\nimport Cookies from \"js-cookie\";\nimport jwtDecode from \"jwt-decode\";\n\nconst LOCAL_STORE_KEY = \"___hubs_store\";\nconst STORE_STATE_CACHE_KEY = Symbol();\nconst OAUTH_FLOW_CREDENTIALS_KEY = \"ret-oauth-flow-account-credentials\";\nconst validator = new Validator();\nimport { EventTarget } from \"event-target-shim\";\nimport { generateDefaultProfile, generateRandomName } from \"../utils/identity.js\";\n\n// Durable (via local-storage) schema-enforced state that is meant to be consumed via forward data flow.\n// (Think flux but with way less incidental complexity, at least for now :))\nexport const SCHEMA = {\n  id: \"/HubsStore\",\n\n  definitions: {\n    profile: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        displayName: { type: \"string\", pattern: \"^[A-Za-z0-9-]{3,32}$\" },\n        avatarId: { type: \"string\" },\n        personalAvatarId: { type: \"string\" }\n      }\n    },\n\n    credentials: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        token: { type: [\"null\", \"string\"] },\n        email: { type: [\"null\", \"string\"] }\n      }\n    },\n\n    activity: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        hasFoundFreeze: { type: \"boolean\" },\n        hasChangedName: { type: \"boolean\" },\n        hasAcceptedProfile: { type: \"boolean\" },\n        lastEnteredAt: { type: \"string\" },\n        hasPinned: { type: \"boolean\" },\n        hasRotated: { type: \"boolean\" },\n        hasRecentered: { type: \"boolean\" },\n        hasScaled: { type: \"boolean\" },\n        hasHoveredInWorldHud: { type: \"boolean\" }\n      }\n    },\n\n    settings: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        lastUsedMicDeviceId: { type: \"string\" }\n      }\n    },\n\n    confirmedDiscordRooms: {\n      type: \"array\",\n      items: { type: \"string\" }\n    },\n\n    uploadPromotionTokens: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          fileId: { type: \"string\" },\n          promotionToken: { type: \"string\" }\n        }\n      }\n    },\n\n    creatorAssignmentTokens: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          hubId: { type: \"string\" },\n          creatorAssignmentToken: { type: \"string\" }\n        }\n      }\n    }\n  },\n\n  type: \"object\",\n\n  properties: {\n    profile: { $ref: \"#/definitions/profile\" },\n    credentials: { $ref: \"#/definitions/credentials\" },\n    activity: { $ref: \"#/definitions/activity\" },\n    settings: { $ref: \"#/definitions/settings\" },\n    confirmedDiscordRooms: { $ref: \"#/definitions/confirmedDiscordRooms\" },\n    uploadPromotionTokens: { $ref: \"#/definitions/uploadPromotionTokens\" },\n    creatorAssignmentTokens: { $ref: \"#/definitions/creatorAssignmentTokens\" }\n  },\n\n  additionalProperties: false\n};\n\nexport default class Store extends EventTarget {\n  constructor() {\n    super();\n\n    if (localStorage.getItem(LOCAL_STORE_KEY) === null) {\n      localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify({}));\n    }\n    this.update({\n      activity: {},\n      settings: {},\n      credentials: {},\n      profile: {},\n      confirmedDiscordRooms: [],\n      uploadPromotionTokens: [],\n      creatorAssignmentTokens: []\n    });\n\n    const oauthFlowCredentials = Cookies.getJSON(OAUTH_FLOW_CREDENTIALS_KEY);\n    if (oauthFlowCredentials) {\n      this.update({ credentials: oauthFlowCredentials });\n      this.resetToRandomLegacyAvatar();\n      Cookies.remove(OAUTH_FLOW_CREDENTIALS_KEY);\n    }\n  }\n\n  // Initializes store with any default bits\n  init = () => {\n    this.update({\n      profile: { ...generateDefaultProfile(), ...(this.state.profile || {}) }\n    });\n\n    // Regenerate name to encourage users to change it.\n    if (!this.state.activity.hasChangedName) {\n      this.update({ profile: { displayName: generateRandomName() } });\n    }\n  };\n\n  resetToRandomLegacyAvatar = () => {\n    this.update({\n      profile: { ...(this.state.profile || {}), ...generateDefaultProfile() }\n    });\n  };\n\n  get state() {\n    if (!this.hasOwnProperty(STORE_STATE_CACHE_KEY)) {\n      this[STORE_STATE_CACHE_KEY] = JSON.parse(localStorage.getItem(LOCAL_STORE_KEY));\n    }\n\n    return this[STORE_STATE_CACHE_KEY];\n  }\n\n  get credentialsAccountId() {\n    if (this.state.credentials.token) {\n      return jwtDecode(this.state.credentials.token).sub;\n    } else {\n      return null;\n    }\n  }\n\n  resetConfirmedDiscordRooms() {\n    // merge causing us some annoyance here :(\n    const overwriteMerge = (destinationArray, sourceArray) => sourceArray;\n    this.update({ confirmedDiscordRooms: [] }, { arrayMerge: overwriteMerge });\n  }\n\n  resetTipActivityFlags() {\n    this.update({ activity: { hasRotated: false, hasPinned: false, hasRecentered: false, hasScaled: false } });\n  }\n\n  update(newState, mergeOpts) {\n    const finalState = merge(this.state, newState, mergeOpts);\n    const { valid } = validator.validate(finalState, SCHEMA);\n\n    if (!valid) {\n      // Intentionally not including details about the state or validation result here, since we don't want to leak\n      // sensitive data in the error message.\n      throw new Error(`Write to store failed schema validation.`);\n    }\n\n    localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify(finalState));\n    delete this[STORE_STATE_CACHE_KEY];\n\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n\n    return finalState;\n  }\n}\n","export const avatars = [\n  {\n    id: \"botdefault\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotDefault_Avatar-9f71f8ff22.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botdefault-thumb-42C4C7D3C01D085EAFDAC8BACE591CE6.png\"\n  },\n  {\n    id: \"botbobo\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotBobo_Avatar-f9740a010b.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botbobo-thumb-261278FD5831E9CD89610D15948F23E4.png\"\n  },\n  {\n    id: \"botdom\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotDom_Avatar-0c48bf15a5.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botdom-thumb-1160EB5E81D24F12CE643C520CE1E99E.png\"\n  },\n  {\n    id: \"botgreg\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotGreg_Avatar-98d39797bb.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botgreg-thumb-F2A37F14F9C342EE44DDE9B24DD9B9FC.png\"\n  },\n  {\n    id: \"botguest\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotGuest_Avatar-78cd857332.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botguest-thumb-F7A471250E2C10C2709325C3B02A8BBB.png\"\n  },\n  {\n    id: \"botjim\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotJim_Avatar-d28005a687.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botjim-thumb-A2D195C1A51A082BCED58BD172481B39.png\"\n  },\n  {\n    id: \"botkev\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotKev_Avatar-a95787bb51.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botkev-thumb-90746A7349E3F964C913EA612EE9A53F.png\"\n  },\n  {\n    id: \"botpinky\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotPinky_Avatar-b0b93f8675.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botpinky-thumb-C2E69D4479077766B988DC3EE4F30BE5.png\"\n  },\n  {\n    id: \"botrobert\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotRobert_Avatar-e9554880f3.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botrobert-thumb-9C33F2C752326E2CF4321EAA7BDB4E47.png\"\n  },\n  {\n    id: \"botwoody\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotWoody_Avatar-0140485a23.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botwoody-thumb-F1F1FA7E21301B5AC1D8872B4ED0CC56.png\"\n  }\n];\n","export function forEachMaterial(object3D, fn) {\n  if (!object3D.material) return;\n\n  if (Array.isArray(object3D.material)) {\n    object3D.material.forEach(fn);\n  } else {\n    fn(object3D.material);\n  }\n}\n\nexport function mapMaterials(object3D, fn) {\n  if (!object3D.material) return;\n\n  if (Array.isArray(object3D.material)) {\n    return object3D.material.map(fn);\n  } else {\n    return fn(object3D.material);\n  }\n}\n","const zeroPos = new THREE.Vector3(0, 0, 0);\nconst zeroQuat = new THREE.Quaternion();\nconst oneScale = new THREE.Vector3(1, 1, 1);\nconst identity = new THREE.Matrix4();\nidentity.identity();\n\n// Patch animation system\nconst bindingSetters = THREE.PropertyBinding.prototype.SetterByBindingTypeAndVersioning;\nconst Versioning = THREE.PropertyBinding.prototype.Versioning;\n\n// For all binding types, monkey patch the setters that require world matrix\n// updates to also flip matrixNeedsUpdate\nfor (let i = 0; i < bindingSetters.length; i++) {\n  const setter = bindingSetters[i][Versioning.MatrixWorldNeedsUpdate];\n  if (!setter) continue;\n\n  bindingSetters[i][Versioning.MatrixWorldNeedsUpdate] = function() {\n    const v = setter.apply(this, arguments);\n    this.targetObject.matrixNeedsUpdate = true;\n    return v;\n  };\n}\n\nTHREE.Object3D.prototype.getWorldPosition = function(target) {\n  if (target === undefined) {\n    console.warn(\"THREE.Object3D: .getWorldPosition() target is now required\");\n    target = new THREE.Vector3();\n  }\n\n  // New function, defined below (used instead of updateMatrixWorld)\n  this.updateMatrices();\n\n  return target.setFromMatrixPosition(this.matrixWorld);\n};\n\nTHREE.Object3D.prototype.getWorldQuaternion = (function() {\n  const position = new THREE.Vector3();\n  const scale = new THREE.Vector3();\n\n  return function getWorldQuaternion(target) {\n    if (target === undefined) {\n      console.warn(\"THREE.Object3D: .getWorldQuaternion() target is now required\");\n      target = new THREE.Quaternion();\n    }\n\n    // New function, defined below (used instead of updateMatrixWorld)\n    this.updateMatrices();\n    this.matrixWorld.decompose(position, target, scale);\n\n    return target;\n  };\n})();\n\nTHREE.Object3D.getWorldScale = (function() {\n  const position = new THREE.Vector3();\n  const quaternion = new THREE.Quaternion();\n\n  return function getWorldScale(target) {\n    if (target === undefined) {\n      console.warn(\"THREE.Object3D: .getWorldScale() target is now required\");\n      target = new THREE.Vector3();\n    }\n\n    // New function, defined below (used instead of updateMatrixWorld)\n    this.updateMatrices();\n    this.matrixWorld.decompose(position, quaternion, target);\n\n    return target;\n  };\n})();\n\nconst handleMatrixModification = o => {\n  if (!o.matrixIsModified) {\n    o.matrixIsModified = true;\n\n    if (o.cachedMatrixWorld) {\n      o.cachedMatrixWorld.copy(o.matrixWorld);\n      o.matrixWorld = o.cachedMatrixWorld;\n    }\n  }\n};\n\nconst updateMatrix = THREE.Object3D.prototype.updateMatrix;\nTHREE.Object3D.prototype.updateMatrix = function() {\n  updateMatrix.apply(this, arguments);\n  handleMatrixModification(this);\n};\n\nconst applyMatrix = THREE.Object3D.prototype.applyMatrix;\nTHREE.Object3D.prototype.applyMatrix = function() {\n  applyMatrix.apply(this, arguments);\n  handleMatrixModification(this);\n};\n\n// By the end of this function this.matrix reflects the updated local matrix\n// and this.matrixWorld reflects the updated world matrix, taking into account\n// parent matrices.\n//\n// forceLocalUpdate - Forces the local matrix to be updated regardless of if it has not\n// been marked dirty.\n//\n// forceWorldUpdate - Forces the world matrix to be updated regardless of if the local matrix\n// has been updated since the last update.\n//\n// skipParents - unless true, all parent matricies are updated before updating this object's\n// local and world matrix.\n//\nTHREE.Object3D.prototype.updateMatrices = function(forceLocalUpdate, forceWorldUpdate, skipParents) {\n  if (!this.hasHadFirstMatrixUpdate) {\n    if (\n      !this.position.equals(zeroPos) ||\n      !this.quaternion.equals(zeroQuat) ||\n      !this.scale.equals(oneScale) ||\n      !this.matrix.equals(identity)\n    ) {\n      // Only update the matrix the first time if its non-identity, this way\n      // this.matrixIsModified will remain false until the default\n      // identity matrix is updated.\n      this.updateMatrix();\n    }\n\n    this.hasHadFirstMatrixUpdate = true;\n    this.matrixWorldNeedsUpdate = true;\n    this.cachedMatrixWorld = this.matrixWorld;\n  } else if (this.matrixNeedsUpdate || this.matrixAutoUpdate || forceLocalUpdate) {\n    this.updateMatrix();\n    if (this.matrixNeedsUpdate) this.matrixNeedsUpdate = false;\n  }\n\n  if (!skipParents && this.parent) {\n    this.parent.updateMatrices(false, forceWorldUpdate, false);\n    this.matrixWorldNeedsUpdate = this.matrixWorldNeedsUpdate || this.parent.childrenNeedMatrixWorldUpdate;\n  }\n\n  if (this.matrixWorldNeedsUpdate || forceWorldUpdate) {\n    if (this.parent === null) {\n      this.matrixWorld.copy(this.matrix);\n    } else {\n      // If the matrix is unmodified, it is the identity matrix,\n      // and hence we can use the parent's world matrix directly.\n      //\n      // Note this assumes all callers will either not pass skipParents=true\n      // *or* will update the parent themselves beforehand as is done in\n      // updateMatrixWorld.\n      if (!this.matrixIsModified) {\n        this.matrixWorld = this.parent.matrixWorld;\n      } else {\n        // Once matrixIsModified === true, this.matrixWorld has been updated to be a local\n        // copy, not a reference to this.parent.matrixWorld (see updateMatrix/applyMatrix)\n        this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix);\n      }\n    }\n\n    this.childrenNeedMatrixWorldUpdate = true;\n    this.matrixWorldNeedsUpdate = false;\n  }\n};\n\n// Computes this object's matrices and then the recursively computes the matrices of all the children.\n//\n// forceWorldUpdate - If true and the object is visible, will force the world matrix to be updated for\n// this node and all of its children.\n//\n// includeInvisible - If true, does not ignore non-visible objects.\nTHREE.Object3D.prototype.updateMatrixWorld = function(forceWorldUpdate, includeInvisible) {\n  if (!this.visible && !includeInvisible) return;\n\n  // Do not recurse upwards, since this is recursing downwards\n  this.updateMatrices(false, forceWorldUpdate, true);\n\n  const children = this.children;\n  const forceChildrenWorldUpdate = this.childrenNeedMatrixWorldUpdate || forceWorldUpdate;\n\n  for (let i = 0, l = children.length; i < l; i++) {\n    children[i].updateMatrixWorld(forceChildrenWorldUpdate, includeInvisible);\n  }\n\n  if (this.childrenNeedMatrixWorldUpdate) this.childrenNeedMatrixWorldUpdate = false;\n};\n\n// Updates this function to use updateMatrices() to avoid extra matrix computations\nTHREE.Object3D.prototype.lookAt = (function() {\n  // This method does not support objects having non-uniformly-scaled parent(s)\n\n  const q1 = new THREE.Quaternion();\n  const m1 = new THREE.Matrix4();\n  const target = new THREE.Vector3();\n  const position = new THREE.Vector3();\n\n  return function lookAt(x, y, z) {\n    if (x.isVector3) {\n      target.copy(x);\n    } else {\n      target.set(x, y, z);\n    }\n\n    const parent = this.parent;\n\n    this.updateMatrices(); // hubs change\n\n    position.setFromMatrixPosition(this.matrixWorld);\n\n    if (this.isCamera || this.isLight) {\n      m1.lookAt(position, target, this.up);\n    } else {\n      m1.lookAt(target, position, this.up);\n    }\n\n    this.quaternion.setFromRotationMatrix(m1);\n\n    if (parent) {\n      m1.extractRotation(parent.matrixWorld);\n      q1.setFromRotationMatrix(m1);\n      this.quaternion.premultiply(q1.inverse());\n    }\n  };\n})();\n","AFRAME.registerComponent(\"ambient-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 }\n  },\n\n  init() {\n    const el = this.el;\n    this.light = new THREE.AmbientLight();\n    this.el.setObject3D(\"ambient-light\", this.light);\n    this.el.sceneEl.systems.light.registerLight(el);\n    this.rendererSystem = this.el.sceneEl.systems.renderer;\n  },\n\n  update(prevData) {\n    if (this.data.color !== prevData.color) {\n      this.light.color.set(this.data.color);\n      this.rendererSystem.applyColorCorrection(this.light.color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      this.light.intensity = this.data.intensity;\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"ambient-light\");\n  }\n});\n","/**\n * Sets the CSS class on an entity.\n * @component css-class\n */\nAFRAME.registerComponent(\"css-class\", {\n  schema: {\n    type: \"string\"\n  },\n  multiple: true,\n  init() {\n    this.el.classList.add(this.data);\n  },\n  update(oldData) {\n    if (this.data !== oldData) {\n      this.el.classList.remove(oldData);\n      this.el.classList.add(this.data);\n    }\n  },\n  remove() {\n    this.el.classList.remove(this.data);\n  }\n});\n","/* global CANNON */\n/**\n * Floats a duck based on its scale.\n * @component duck\n */\nAFRAME.registerComponent(\"duck\", {\n  schema: {\n    initialForce: { default: 0 },\n    maxForce: { default: 6.5 },\n    maxScale: { default: 5 }\n  },\n\n  init: function() {\n    this.physicsSystem = this.el.sceneEl.systems.physics;\n    this.hasBody = false;\n    this.position = new CANNON.Vec3();\n    this.force = new CANNON.Vec3(0, this.data.initialForce, 0);\n    this.initialScale = this.el.object3D.scale.x;\n    this.maxScale = this.data.maxScale * this.initialScale;\n  },\n\n  play: function() {\n    this.physicsSystem.addComponent(this);\n  },\n\n  pause: function() {\n    this.physicsSystem.removeComponent(this);\n  },\n\n  beforeStep: function() {\n    if (this.el.body && NAF.utils.isMine(this.el)) {\n      const currentScale = this.el.object3D.scale.x;\n      const ratio = Math.min(1, (currentScale - this.initialScale) / (this.maxScale - this.initialScale));\n      const force = ratio * this.data.maxForce;\n      if (force > 0) {\n        const angle = Math.random() * Math.PI * 2;\n        const x = Math.cos(angle);\n        const z = Math.sin(angle);\n        this.force.set(x, force, z);\n        this.position.set(x * 0.01, 0, z * 0.01);\n        this.el.object3D.matrixNeedsUpdate = true;\n        this.el.body.applyForce(this.force, this.position);\n      }\n    }\n  }\n});\n","/* global CANNON */\nAFRAME.registerComponent(\"heightfield\", {\n  init() {\n    this.el.addEventListener(\"componentinitialized\", e => {\n      if (e.detail.name === \"static-body\") {\n        this.generateAndAddHeightfield(this.el.components[\"static-body\"]);\n      }\n    });\n    this.el.setAttribute(\"static-body\", { shape: \"none\", mass: 0 });\n  },\n  generateAndAddHeightfield(body) {\n    const { offset, distance, data } = this.data;\n\n    const orientation = new CANNON.Quaternion();\n    orientation.setFromAxisAngle(new CANNON.Vec3(1, 0, 0), -Math.PI / 2);\n\n    const rotation = new CANNON.Quaternion();\n    rotation.setFromAxisAngle(new CANNON.Vec3(0, 1, 0), -Math.PI / 2);\n    rotation.mult(orientation, orientation);\n\n    const cannonOffset = new CANNON.Vec3(offset.x, offset.y, offset.z);\n\n    const shape = new CANNON.Heightfield(data, { elementSize: distance });\n\n    body.addShape(shape, cannonOffset, orientation);\n  }\n});\n","AFRAME.registerComponent(\"hemisphere-light\", {\n  schema: {\n    skyColor: { type: \"color\" },\n    groundColor: { type: \"color\" },\n    intensity: { default: 1.0 }\n  },\n\n  init() {\n    const el = this.el;\n    this.light = new THREE.HemisphereLight();\n    this.light.position.set(0, 0, 0);\n    this.light.matrixNeedsUpdate = true;\n    this.el.setObject3D(\"hemisphere-light\", this.light);\n    this.el.sceneEl.systems.light.registerLight(el);\n  },\n\n  update(prevData) {\n    if (this.data.skyColor !== prevData.skyColor) {\n      this.light.color.set(this.data.skyColor);\n    }\n\n    if (this.data.groundColor !== prevData.groundColor) {\n      this.light.groundColor.set(this.data.groundColor);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      this.light.intensity = this.data.intensity;\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"hemisphere-light\");\n  }\n});\n","/**\n * Hides entities based on the scene's quality mode\n * @namespace environment\n * @component hide-when-quality\n */\nAFRAME.registerComponent(\"hide-when-quality\", {\n  schema: { type: \"string\", default: \"low\" },\n\n  init() {\n    this.onQualityChanged = this.onQualityChanged.bind(this);\n    this.el.sceneEl.addEventListener(\"quality-changed\", this.onQualityChanged);\n  },\n\n  onQualityChanged(event) {\n    this.updateComponentState(event.detail);\n  },\n\n  update(oldData) {\n    if (this.data !== oldData) {\n      this.updateComponentState(window.APP.quality);\n    }\n  },\n\n  updateComponentState(quality) {\n    this.el.setAttribute(\"visible\", quality !== this.data);\n  }\n});\n","AFRAME.registerComponent(\"point-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 },\n    range: { default: 0 },\n    decay: { default: 2 },\n    castShadow: { default: true },\n    shadowMapResolution: { default: [512, 512] },\n    shadowBias: { default: 0 },\n    shadowRadius: { default: 1 }\n  },\n\n  init() {\n    const el = this.el;\n    this.light = new THREE.PointLight();\n    this.light.shadow.camera.matrixAutoUpdate = true;\n    this.el.setObject3D(\"point-light\", this.light);\n    this.el.sceneEl.systems.light.registerLight(el);\n    this.rendererSystem = this.el.sceneEl.systems.renderer;\n  },\n\n  update(prevData) {\n    const light = this.light;\n\n    if (this.data.color !== prevData.color) {\n      const color = new THREE.Color(this.data.color);\n      this.rendererSystem.applyColorCorrection(color);\n      light.color.copy(color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      light.intensity = this.data.intensity;\n    }\n\n    if (this.data.range !== prevData.range) {\n      light.distance = this.data.range;\n    }\n\n    if (this.data.decay !== prevData.decay) {\n      light.decay = this.data.decay;\n    }\n\n    if (this.data.castShadow !== prevData.castShadow) {\n      light.castShadow = this.data.castShadow;\n    }\n\n    if (this.data.shadowBias !== prevData.shadowBias) {\n      light.shadow.bias = this.data.shadowBias;\n    }\n\n    if (this.data.shadowRadius !== prevData.shadowRadius) {\n      light.shadow.radius = this.data.shadowRadius;\n    }\n\n    const [width, height] = this.data.shadowMapResolution;\n    const [prevWidth, prevHeight] = prevData.shadowMapResolution ? prevData.shadowMapResolution : [512, 512];\n\n    if (width !== prevWidth || height !== prevHeight) {\n      light.shadow.mapSize.set(width, height);\n\n      if (light.shadow.map) {\n        light.shadow.map.dispose();\n        light.shadow.map = null;\n      }\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"point-light\");\n  }\n});\n","/**\n * Nicely pans the camera for previewing a scene. There's some weirdness with this right now\n * since it ends up panning in a direction dependent upon the start camera orientation,\n * but it's good enough for now.\n */\nfunction lerp(start, end, t) {\n  return (1 - t) * start + t * end;\n}\n\nconst newRot = new THREE.Quaternion();\n\nAFRAME.registerComponent(\"scene-preview-camera\", {\n  schema: {\n    duration: { default: 90, type: \"number\" },\n    positionOnly: { default: false, type: \"boolean\" }\n  },\n\n  init: function() {\n    this.startPoint = this.el.object3D.position.clone();\n    this.startRotation = new THREE.Quaternion();\n    this.startRotation.setFromEuler(this.el.object3D.rotation);\n\n    this.targetPoint = new THREE.Vector3(1, 0.5, -0.5);\n    this.targetPoint.applyMatrix4(this.el.object3D.matrix);\n    this.targetPoint.add(new THREE.Vector3(0, 0, -2));\n\n    const targetRotDelta = new THREE.Euler(-0.15, 0.0, 0.15);\n    this.targetRotation = new THREE.Quaternion();\n    this.targetRotation.setFromEuler(targetRotDelta);\n    this.targetRotation.premultiply(this.startRotation);\n\n    this.startTime = performance.now();\n    this.backwards = false;\n    this.ranOnePass = false;\n  },\n\n  tick: function() {\n    let t = (performance.now() - this.startTime) / (1000.0 * this.data.duration);\n    t = Math.min(1.0, Math.max(0.0, t));\n\n    if (!this.ranOnePass) {\n      t = t * (2 - t);\n    } else {\n      t = t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n    }\n\n    const from = this.backwards ? this.targetPoint : this.startPoint;\n    const to = this.backwards ? this.startPoint : this.targetPoint;\n    const fromRot = this.backwards ? this.targetRotation : this.startRotation;\n    const toRot = this.backwards ? this.startRotation : this.targetRotation;\n\n    THREE.Quaternion.slerp(fromRot, toRot, newRot, t);\n\n    this.el.object3D.position.set(lerp(from.x, to.x, t), lerp(from.y, to.y, t), lerp(from.z, to.z, t));\n\n    if (!this.data.positionOnly) {\n      this.el.object3D.rotation.setFromQuaternion(newRot);\n    }\n\n    this.el.object3D.matrixNeedsUpdate = true;\n\n    if (t >= 0.9999) {\n      this.ranOnePass = true;\n      this.backwards = !this.backwards;\n      this.startTime = performance.now();\n    }\n  }\n});\n","// Enumeration of spawned object content origins. URL means the content is\n// fetched from a URL, FILE means it was an uploaded/dropped file, and\n// CLIPBOARD means it was raw data pasted in from the clipboard, SPAWNER means\n// it was copied over from a spawner.\nexport const ObjectContentOrigins = {\n  URL: 1,\n  FILE: 2,\n  CLIPBOARD: 3,\n  SPAWNER: 4\n};\n\n// Enumeration of spawnable object types, used for telemetry, which encapsulates\n// both the origin of the content for the object and also the type of content\n// contained in the object.\nexport const ObjectTypes = {\n  URL_IMAGE: 0,\n  URL_VIDEO: 1,\n  URL_MODEL: 2,\n  URL_PDF: 3,\n  URL_AUDIO: 4,\n  //URL_TEXT: 5,\n  //URL_TELEPORTER: 6,\n  FILE_IMAGE: 8,\n  FILE_VIDEO: 9,\n  FILE_MODEL: 10,\n  FILE_PDF: 11,\n  FILE_AUDIO: 12,\n  //FILE_TEXT: 13,\n  CLIPBOARD_IMAGE: 16,\n  CLIPBOARD_VIDEO: 17,\n  CLIPBOARD_MODEL: 18,\n  CLIPBOARD_PDF: 19,\n  CLIPBOARD_AUDIO: 20,\n  //CLIPBOARD_TEXT: 21,\n  SPAWNER_IMAGE: 24,\n  SPAWNER_VIDEO: 25,\n  SPAWNER_MODEL: 26,\n  SPAWNER_PDF: 27,\n  SPAWNER_AUDIO: 28,\n  //SPAWNER_TEXT: 29,\n  CAMERA: 30,\n  UNKNOWN: 31\n};\n\n// Given an origin and three object type values for URL, FILE, and CLIPBOARD\n// origins respectively, return the appropriate one\nfunction objectTypeForOrigin(contentOrigin, urlType, fileType, clipboardType, spawnerType) {\n  if (contentOrigin === ObjectContentOrigins.URL) {\n    return urlType;\n  } else if (contentOrigin === ObjectContentOrigins.FILE) {\n    return fileType;\n  } else if (contentOrigin === ObjectContentOrigins.CLIPBOARD) {\n    return clipboardType;\n  } else {\n    return spawnerType;\n  }\n}\n\n// Lookup table of mime-type prefixes to the set of object types that we should use\n// for objects spawned matching their underlying Content-Type.\nconst objectTypeMimePrefixLookupMap = {\n  \"image/\": [ObjectTypes.URL_IMAGE, ObjectTypes.FILE_IMAGE, ObjectTypes.CLIPBOARD_IMAGE, ObjectTypes.SPAWNER_IMAGE],\n  \"model/\": [ObjectTypes.URL_MODEL, ObjectTypes.FILE_MODEL, ObjectTypes.CLIPBOARD_MODEL, ObjectTypes.SPAWNER_MODEL],\n  \"application/x-zip-compressed\": [\n    ObjectTypes.URL_MODEL,\n    ObjectTypes.FILE_MODEL,\n    ObjectTypes.CLIPBOARD_MODEL,\n    ObjectTypes.SPAWNER_MODEL\n  ],\n  \"video/\": [ObjectTypes.URL_VIDEO, ObjectTypes.FILE_VIDEO, ObjectTypes.CLIPBOARD_VIDEO, ObjectTypes.SPAWNER_VIDEO],\n  \"application/vnd.apple.mpegurl\": [\n    ObjectTypes.URL_VIDEO,\n    ObjectTypes.FILE_VIDEO,\n    ObjectTypes.CLIPBOARD_VIDEO,\n    ObjectTypes.SPAWNER_VIDEO\n  ],\n  \"application/x-mpegurl\": [\n    ObjectTypes.URL_VIDEO,\n    ObjectTypes.FILE_VIDEO,\n    ObjectTypes.CLIPBOARD_VIDEO,\n    ObjectTypes.SPAWNER_VIDEO\n  ],\n  \"audio/\": [ObjectTypes.URL_AUDIO, ObjectTypes.FILE_AUDIO, ObjectTypes.CLIPBOARD_AUDIO, ObjectTypes.SPAWNER_AUDIO],\n  \"application/pdf\": [ObjectTypes.URL_PDF, ObjectTypes.FILE_PDF, ObjectTypes.CLIPBOARD_PDF, ObjectTypes.SPAWNER_PDF]\n};\n\nconst srcSuffixLookupMap = {\n  \".m3u8\": [ObjectTypes.URL_VIDEO, ObjectTypes.FILE_VIDEO, ObjectTypes.CLIPBOARD_VIDEO, ObjectTypes.SPAWNER_VIDEO]\n};\n\n// Given an content origin and the resolved mime type of a piece of content, return\n// the ObjectType, if any, for that content.\nexport function objectTypeForOriginAndContentType(contentOrigin, contentType, src) {\n  for (const prefix in objectTypeMimePrefixLookupMap) {\n    if (contentType.toLowerCase().startsWith(prefix)) {\n      const types = objectTypeMimePrefixLookupMap[prefix];\n      return objectTypeForOrigin(contentOrigin, ...types);\n    }\n  }\n\n  if (src) {\n    for (const suffix in srcSuffixLookupMap) {\n      if (src.toLowerCase().endsWith(suffix)) {\n        const types = srcSuffixLookupMap[suffix];\n        return objectTypeForOrigin(contentOrigin, ...types);\n      }\n    }\n  }\n\n  return ObjectTypes.UNKNOWN;\n}\n","AFRAME.registerComponent(\"spot-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 },\n    range: { default: 0 },\n    decay: { default: 2 },\n    innerConeAngle: { default: 0 },\n    outerConeAngle: { default: Math.PI / 4.0 },\n    castShadow: { default: true },\n    shadowMapResolution: { default: [512, 512] },\n    shadowBias: { default: 0 },\n    shadowRadius: { default: 1 }\n  },\n\n  init() {\n    const el = this.el;\n    this.light = new THREE.SpotLight();\n    this.light.position.set(0, 0, 0);\n    this.light.target.position.set(0, 0, 1);\n    this.light.add(this.light.target);\n    this.light.matrixNeedsUpdate = true;\n    this.light.target.matrixNeedsUpdate = true;\n    this.el.setObject3D(\"spot-light\", this.light);\n    this.el.sceneEl.systems.light.registerLight(el);\n  },\n\n  update(prevData) {\n    const light = this.light;\n\n    if (this.data.color !== prevData.color) {\n      light.color.set(this.data.color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      light.intensity = this.data.intensity;\n    }\n\n    if (this.data.range !== prevData.range) {\n      light.distance = this.data.range;\n    }\n\n    if (this.data.decay !== prevData.decay) {\n      light.decay = this.data.decay;\n    }\n\n    if (this.data.innerConeAngle !== prevData.innerConeAngle || this.data.outerConeAngle !== prevData.outerConeAngle) {\n      light.angle = this.data.outerConeAngle;\n      light.penumbra = 1.0 - this.data.innerConeAngle / this.data.outerConeAngle;\n    }\n\n    if (this.data.castShadow !== prevData.castShadow) {\n      light.castShadow = this.data.castShadow;\n    }\n\n    if (this.data.shadowBias !== prevData.shadowBias) {\n      light.shadow.bias = this.data.shadowBias;\n    }\n\n    if (this.data.shadowRadius !== prevData.shadowRadius) {\n      light.shadow.radius = this.data.shadowRadius;\n    }\n\n    const [width, height] = this.data.shadowMapResolution;\n    const [prevWidth, prevHeight] = prevData.shadowMapResolution ? prevData.shadowMapResolution : [512, 512];\n\n    if (width !== prevWidth || height !== prevHeight) {\n      light.shadow.mapSize.set(width, height);\n\n      if (light.shadow.map) {\n        light.shadow.map.dispose();\n        light.shadow.map = null;\n      }\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"spot-light\");\n  }\n});\n","/* global AFRAME */\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\n\nAFRAME.registerComponent(\"floaty-object\", {\n  schema: {\n    // Make the object locked/kinematic upon load\n    autoLockOnLoad: { default: false },\n\n    // Make the object kinematic immediately upon release\n    autoLockOnRelease: { default: false },\n\n    // On release, modify the gravity based upon gravitySpeedLimit. If less than this, let the object float\n    // otherwise apply releaseGravity.\n    modifyGravityOnRelease: { default: false },\n\n    // Gravity to apply if object is thrown at a speed greated than speed limit.\n    releaseGravity: { default: -2 },\n\n    // If true, the degree to which angular rotation is allowed when floating is reduced (useful for 2d media)\n    reduceAngularFloat: { default: false },\n\n    // Velocity speed limit under which gravity will not be added if modifyGravityOnRelease is true\n    gravitySpeedLimit: { default: 1.85 } // Set to 0 to never apply gravity\n  },\n\n  init() {\n    this.onGrab = this.onGrab.bind(this);\n    this.onRelease = this.onRelease.bind(this);\n  },\n\n  tick() {\n    if (!this.ammoBody) {\n      this.ammoBody = this.el.components[\"ammo-body\"];\n    }\n\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const isHeld = interaction.isHeld(this.el);\n    if (isHeld && !this.wasHeld) {\n      this.onGrab();\n    }\n    if (this.wasHeld && !isHeld) {\n      this.onRelease();\n    }\n\n    if (this._makeStaticWhenAtRest) {\n      const isMine = this.el.components.networked && NAF.utils.isMine(this.el);\n      const linearThreshold = this.ammoBody.data.linearSleepingThreshold;\n      const angularThreshold = this.ammoBody.data.angularSleepingThreshold;\n      const isAtRest =\n        this.ammoBody.body.getLinearVelocity().length2() < linearThreshold * linearThreshold &&\n        this.ammoBody.body.getAngularVelocity().length2() < angularThreshold * angularThreshold;\n\n      if (isAtRest && isMine) {\n        this.el.setAttribute(\"ammo-body\", { type: \"static\" });\n      }\n\n      if (isAtRest || !isMine) {\n        this._makeStaticWhenAtRest = false;\n      }\n    }\n\n    this.wasHeld = isHeld;\n  },\n\n  play() {\n    // We do this in play instead of in init because otherwise NAF.utils.isMine fails\n    if (this.hasBeenHereBefore) return;\n    this.hasBeenHereBefore = true;\n    if (this.el.body) {\n      this._onBodyLoaded();\n    } else {\n      this._onBodyLoaded = this._onBodyLoaded.bind(this);\n      this.el.addEventListener(\"body-loaded\", this._onBodyLoaded, { once: true });\n    }\n  },\n\n  setLocked(locked) {\n    if (this.el.components.networked && !NAF.utils.isMine(this.el)) return;\n\n    this.locked = locked;\n    this.el.setAttribute(\"ammo-body\", { type: locked ? \"kinematic\" : \"dynamic\" });\n  },\n\n  _onBodyLoaded() {\n    if (this.data.autoLockOnLoad) {\n      this.setLocked(true);\n    }\n  },\n\n  onRelease() {\n    if (this.data.modifyGravityOnRelease) {\n      if (\n        this.data.gravitySpeedLimit === 0 ||\n        this.ammoBody.getVelocity().length2() < this.data.gravitySpeedLimit * this.data.gravitySpeedLimit\n      ) {\n        this.el.setAttribute(\"ammo-body\", {\n          gravity: { x: 0, y: 0, z: 0 },\n          angularDamping: this.data.reduceAngularFloat ? 0.98 : 0.5,\n          linearDamping: 0.95,\n          linearSleepingThreshold: 0.1,\n          angularSleepingThreshold: 0.1\n        });\n\n        this._makeStaticWhenAtRest = true;\n      } else {\n        this.el.setAttribute(\"ammo-body\", {\n          gravity: { x: 0, y: this.data.releaseGravity, z: 0 },\n          angularDamping: 0.01,\n          linearDamping: 0.01,\n          linearSleepingThreshold: 1.6,\n          angularSleepingThreshold: 2.5\n        });\n      }\n    }\n\n    if (this.data.autoLockOnRelease) {\n      this.setLocked(true);\n    }\n\n    this.el.setAttribute(\"ammo-body\", { collisionFilterMask: COLLISION_LAYERS.DEFAULT_INTERACTABLE });\n  },\n\n  onGrab() {\n    this.el.setAttribute(\"ammo-body\", {\n      collisionFilterMask: this.locked ? COLLISION_LAYERS.HANDS : COLLISION_LAYERS.DEFAULT_INTERACTABLE\n    });\n    this.setLocked(false);\n  },\n\n  remove() {\n    this.el.removeEventListener(\"body-loaded\", this._onBodyLoaded);\n    if (this.stuckTo) {\n      const stuckTo = this.stuckTo;\n      delete this.stuckTo;\n      stuckTo._unstickObject();\n    }\n  }\n});\n","const sizeVec = new THREE.Vector3();\nconst boundingBoxWorldPositionVec = new THREE.Vector3();\nconst colliderWorldPositionVec = new THREE.Vector3();\n\nAFRAME.registerComponent(\"trigger-volume\", {\n  schema: {\n    colliders: { type: \"selectorAll\" },\n    size: { type: \"vec3\", default: { x: 1, y: 1, z: 1 } },\n    target: { type: \"selector\" },\n    enterComponent: { type: \"string\" },\n    enterProperty: { type: \"string\" },\n    enterValue: {\n      default: \"\",\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\n      stringify: JSON.stringify\n    },\n    leaveComponent: { type: \"string\" },\n    leaveProperty: { type: \"string\" },\n    leaveValue: {\n      default: \"\",\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\n      stringify: JSON.stringify\n    }\n  },\n  init() {\n    this.boundingBox = new THREE.Box3();\n    this.collidingLastFrame = {};\n  },\n  update() {\n    this.el.object3D.getWorldPosition(boundingBoxWorldPositionVec);\n    sizeVec.copy(this.data.size);\n    this.boundingBox.setFromCenterAndSize(boundingBoxWorldPositionVec, sizeVec);\n  },\n  tick() {\n    const colliders = this.data.colliders;\n\n    for (let i = 0; i < colliders.length; i++) {\n      const collider = colliders[i];\n      const object3D = collider.object3D;\n\n      object3D.getWorldPosition(colliderWorldPositionVec);\n      const isColliding = this.boundingBox.containsPoint(colliderWorldPositionVec);\n      const collidingLastFrame = this.collidingLastFrame[object3D.id];\n\n      if (isColliding && !collidingLastFrame) {\n        this.data.target.setAttribute(this.data.enterComponent, this.data.enterProperty, this.data.enterValue);\n      } else if (!isColliding && collidingLastFrame) {\n        this.data.target.setAttribute(this.data.leaveComponent, this.data.leaveProperty, this.data.leaveValue);\n      }\n\n      this.collidingLastFrame[object3D.id] = isColliding;\n    }\n  }\n});\n","// HACK: Setting videoPaused on media-video doesn't work if you are the owner.\n// This component gets around that by calling .togglePlaying() to play/pause the video based on a property change.\nAFRAME.registerComponent(\"video-pause-state\", {\n  schema: {\n    paused: { default: false }\n  },\n\n  init() {\n    this.onPauseStateChange = this.onPauseStateChange.bind(this);\n    this.videoComponent = this.el.components[\"media-video\"];\n\n    if (this.videoComponent) {\n      this.onVideoLoaded();\n    } else {\n      this.onVideoLoaded = this.onVideoLoaded.bind(this);\n      this.el.addEventListener(\"video-loaded\", this.onVideoLoaded);\n    }\n  },\n\n  onVideoLoaded() {\n    this.videoComponent = this.el.components[\"media-video\"];\n    this.video = this.videoComponent.video;\n    this.video.addEventListener(\"pause\", this.onPauseStateChange);\n  },\n\n  onPauseStateChange() {\n    this.el.setAttribute(\"paused\", this.video.paused);\n  },\n\n  update() {\n    if (this.video && this.data.paused !== this.video.paused) {\n      this.videoComponent.togglePlaying();\n    }\n  },\n\n  remove() {\n    this.video.removeEventListener(\"pause\", this.onPauseStateChange);\n    this.el.removeEventListener(\"video-loaded\", this.onVideoLoaded);\n  }\n});\n","/**\n * Logs all events dispatched on an entity\n * @namespace debug\n * @component log-events\n */\nAFRAME.registerComponent(\"log-events\", {\n  init: function() {\n    const el = this.el;\n    const log = this.log.bind(this);\n    const origDispatch = this.el.dispatchEvent;\n    this.el.dispatchEvent = function() {\n      log(Array.from(arguments));\n      return origDispatch.apply(el, arguments);\n    };\n  },\n  log: function([e]) {\n    if ([\"componentchanged\"].includes(e.type)) return;\n    let firstObject = true;\n    const replacer = (k, x) => {\n      if (!x) return x;\n      if (typeof x === \"object\" && x.length === undefined) {\n        if (firstObject) {\n          firstObject = false;\n          return x;\n        }\n        return \"[object]\";\n      }\n      return x;\n    };\n    console.info(`log-events: ${this.el.id} ${e.type} ${JSON.stringify(e.detail, replacer)}`);\n  }\n});\n\n/**\n * Logs all life cycle phases on an entity.\n * @namespace debug\n * @component lifecycle-checker\n */\nAFRAME.registerComponent(\"lifecycle-checker\", {\n  schema: {\n    name: { type: \"string\" },\n    tick: { default: false }\n  },\n  init: function() {\n    this.log(\"init\");\n  },\n  update: function() {\n    this.log(\"update\");\n  },\n  tick: function() {\n    if (this.data.tick) {\n      this.log(\"tick\");\n    }\n  },\n  remove: function() {\n    this.log(\"remove\");\n  },\n  pause: function() {\n    this.log(\"pause\");\n  },\n  play: function() {\n    this.log(\"play\");\n  },\n\n  log: function(method) {\n    console.info(`lifecycle-checker:${this.data.name} ${method}`);\n  }\n});\n","const { Pathfinding } = require(\"three-pathfinding\");\n\nAFRAME.registerSystem(\"nav\", {\n  init: function() {\n    this.pathfinder = new Pathfinding();\n  },\n\n  loadMesh: function(mesh, zone) {\n    this.el.object3D.updateMatrixWorld();\n\n    if (this.mesh && this.mesh.geometry && this.mesh.geometry.dispose) {\n      this.mesh.geometry.dispose();\n    }\n\n    this.mesh = mesh;\n    const geometry = new THREE.Geometry().fromBufferGeometry(mesh.geometry);\n    geometry.applyMatrix(mesh.matrixWorld);\n    this.pathfinder.setZoneData(zone, Pathfinding.createZone(geometry));\n    this.el.sceneEl.emit(\"nav-mesh-loaded\");\n  }\n});\n","/**\n * Listens to events from an event source and re-emits them on this entity\n * @component event-repeater\n */\nAFRAME.registerComponent(\"event-repeater\", {\n  schema: {\n    eventSource: { type: \"selector\" },\n    events: { type: \"array\" }\n  },\n\n  play: function() {\n    this.data.eventListeners = [];\n    const events = this.data.events;\n    for (let i = 0; i < events.length; i++) {\n      const event = events[i];\n      this.data.eventListeners[event] = this._handleEvent.bind(this, event);\n      this.data.eventSource.addEventListener(event, this.data.eventListeners[event]);\n    }\n  },\n\n  pause: function() {\n    const events = this.data.events;\n    for (let i = 0; i < events.length; i++) {\n      const event = events[i];\n      this.data.eventSource.removeEventListener(event, this.data.eventListeners[event]);\n    }\n    this.data.eventListeners = [];\n  },\n\n  _handleEvent: function(event, e) {\n    this.el.emit(event, e.detail);\n  }\n});\n","import Raven from \"raven-js\";\n\nconst ga = window.ga;\n\nexport default function registerTelemetry(trackedPage, trackedTitle) {\n  const sentryDsn = process.env.SENTRY_DSN;\n  const gaTrackingId = process.env.GA_TRACKING_ID;\n\n  if (sentryDsn) {\n    console.log(\"Tracking: Sentry DSN: \" + sentryDsn);\n    Raven.config(sentryDsn).install();\n  }\n\n  if (ga && gaTrackingId) {\n    console.log(\"Tracking: Google Analytics ID: \" + gaTrackingId);\n\n    ga(\"create\", gaTrackingId, \"auto\");\n\n    if (trackedPage) {\n      ga(\"set\", \"page\", trackedPage);\n    }\n\n    if (trackedTitle) {\n      ga(\"set\", \"title\", trackedTitle);\n    }\n\n    ga(\"send\", \"pageview\");\n  }\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nexport const ReactAudioContext = React.createContext({});\n\nexport const hudHoverSound = \"play_sound-hud_hover_start\";\n\nexport const WithHoverSound = ({ sound, children }) => {\n  return (\n    <ReactAudioContext.Consumer>\n      {context => {\n        return React.cloneElement(children, {\n          onMouseEnter: e => {\n            if (context && context.playSound) {\n              context.playSound(sound || hudHoverSound);\n            }\n            children.props.onMouseEnter && children.props.onMouseEnter(e);\n          }\n        });\n      }}\n    </ReactAudioContext.Consumer>\n  );\n};\n\nWithHoverSound.propTypes = {\n  children: PropTypes.object,\n  sound: PropTypes.string\n};\n","const boundingBox = new THREE.Box3();\nconst frustumBox = new THREE.Box3();\nconst inverseLightMatrixWorld = new THREE.Matrix4();\nconst tempBox = new THREE.Box3();\nconst FRUSTUM_PADDING = 1;\nconst NEAR_CLIPPING_PLANE = -500;\nconst FAR_CLIPPING_PLANE = 500;\nconst verts = [\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3()\n];\n\nexport default function resizeShadowCameraFrustum(light, scene) {\n  // Reset bounding box\n  frustumBox.makeEmpty();\n  boundingBox.makeEmpty();\n\n  // Grow the extents of boundingBox for every geometry in the scene that has castShadow set to true.\n  scene.traverse(node => {\n    const geometry = node.geometry;\n\n    if (geometry && node.castShadow) {\n      if (!geometry.boundingBox) {\n        geometry.computeBoundingBox();\n      }\n\n      tempBox.copy(geometry.boundingBox);\n\n      // Apply matrix transforming bounding box from model space to world space\n      tempBox.applyMatrix4(node.matrixWorld);\n\n      boundingBox.union(tempBox);\n    }\n  });\n\n  // Transform the resulting bounding box from world space to light space.\n  // Construct a new bounding box in light space that contains the corners of the bounding box in world space.\n  const min = boundingBox.min;\n  const max = boundingBox.max;\n\n  verts[0].set(min.x, min.y, min.z);\n  verts[1].set(min.x, min.y, max.z);\n  verts[2].set(min.x, max.y, min.z);\n  verts[3].set(min.x, max.y, max.z);\n  verts[4].set(max.x, min.y, min.z);\n  verts[5].set(max.x, min.y, max.z);\n  verts[6].set(max.x, max.y, min.z);\n  verts[7].set(max.x, max.y, max.z);\n\n  inverseLightMatrixWorld.getInverse(light.shadow.camera.matrixWorld);\n\n  for (let i = 0; i < verts.length; i++) {\n    verts[i].applyMatrix4(inverseLightMatrixWorld);\n    frustumBox.expandByPoint(verts[i]);\n  }\n\n  // Update the camera frustum to fit the resulting bounding box.\n  // Everything in the frustum that has castShadow set to true will cast a shadow.\n  // Everything in the frustum that has receiveShadow set to true will receive a shadow.\n  // FRUSTUM_PADDING is added to avoid clipping the edges of shadows.\n  // TODO: Determine why shadows flicker when light is moved fast. The light's matrixWorld is probably being updated a frame behind.\n  const camera = light.shadow.camera;\n  camera.left = frustumBox.min.x - FRUSTUM_PADDING;\n  camera.right = frustumBox.max.x + FRUSTUM_PADDING;\n  camera.bottom = frustumBox.min.y - FRUSTUM_PADDING;\n  camera.top = frustumBox.max.y + FRUSTUM_PADDING;\n  camera.near = frustumBox.min.z + NEAR_CLIPPING_PLANE;\n  camera.far = frustumBox.max.z + FAR_CLIPPING_PLANE;\n  camera.updateProjectionMatrix();\n}\n","import resizeShadowCameraFrustum from \"../utils/resizeShadowCameraFrustum\";\n\nAFRAME.registerComponent(\"directional-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 },\n    castShadow: { default: true },\n    shadowMapResolution: { default: [512, 512] },\n    shadowBias: { default: 0 },\n    shadowRadius: { default: 1 }\n  },\n\n  init() {\n    const el = this.el;\n    this.light = new THREE.DirectionalLight();\n    this.light.position.set(0, 0, 0);\n    this.light.target.position.set(0, 0, 1);\n    this.light.add(this.light.target);\n    this.el.setObject3D(\"directional-light\", this.light);\n    this.el.sceneEl.systems.light.registerLight(el);\n    this.rendererSystem = this.el.sceneEl.systems.renderer;\n  },\n\n  update(prevData) {\n    const light = this.light;\n\n    if (this.data.color !== prevData.color) {\n      const color = new THREE.Color(this.data.color);\n      this.rendererSystem.applyColorCorrection(color);\n      light.color.copy(color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      light.intensity = this.data.intensity;\n    }\n\n    if (this.data.castShadow !== prevData.castShadow) {\n      light.castShadow = this.data.castShadow;\n    }\n\n    if (this.data.shadowBias !== prevData.shadowBias) {\n      light.shadow.bias = this.data.shadowBias;\n    }\n\n    if (this.data.shadowRadius !== prevData.shadowRadius) {\n      light.shadow.radius = this.data.shadowRadius;\n    }\n\n    const [width, height] = this.data.shadowMapResolution;\n    const [prevWidth, prevHeight] = prevData.shadowMapResolution ? prevData.shadowMapResolution : [512, 512];\n\n    if (width !== prevWidth || height !== prevHeight) {\n      light.shadow.mapSize.set(width, height);\n\n      if (light.shadow.map) {\n        light.shadow.map.dispose();\n        light.shadow.map = null;\n      }\n    }\n\n    this.light.shadow.camera.matrixNeedsUpdate = true;\n  },\n\n  tick() {\n    if (window.APP && window.APP.quality === \"low\") {\n      return;\n    }\n\n    resizeShadowCameraFrustum(this.light, this.el.sceneEl.object3D);\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"directional-light\");\n  }\n});\n","export const Layers = {\n  // Layers 0 - 2 reserverd by ThreeJS and AFrame.\n  reflection: 3\n};\n\n/**\n * Sets layer flags on the underlying Object3D\n * @namespace environment\n * @component layers\n */\nAFRAME.registerComponent(\"layers\", {\n  schema: {\n    reflection: { type: \"boolean\", default: false },\n    inWorldHud: { type: \"boolean\", default: false },\n    exclusive: { type: \"boolean\", default: false } // if true, only these layers will be set\n  },\n  init() {\n    this.update = this.update.bind(this);\n    this.el.addEventListener(\"model-loaded\", this.update);\n  },\n  update(oldData) {\n    const obj = this.el.object3D;\n\n    if (this.data.exclusive) {\n      obj.traverse(o => (o.layers.mask = 0));\n    }\n\n    for (const [name, layer] of Object.entries(Layers)) {\n      const oldValue = oldData[name];\n      const newValue = this.data[name];\n\n      if (oldValue !== newValue) {\n        if (newValue) {\n          obj.traverse(o => o.layers.enable(layer));\n        } else {\n          obj.traverse(o => o.layers.disable(layer));\n        }\n      }\n    }\n  },\n  remove() {\n    this.el.removeEventListener(\"model-loaded\", this.update);\n  }\n});\n","import { getBox, getScaleCoefficient } from \"../utils/auto-box-collider\";\nimport {\n  guessContentType,\n  proxiedUrlFor,\n  resolveUrl,\n  injectCustomShaderChunks,\n  isHubsRoomUrl,\n  isHubsSceneUrl\n} from \"../utils/media-utils\";\nimport { addAnimationComponents } from \"../utils/animation\";\nimport \"three/examples/js/loaders/GLTFLoader\";\nimport loadingObjectSrc from \"../assets/LoadingObject_Atom.glb\";\nimport { SOUND_MEDIA_LOADING, SOUND_MEDIA_LOADED } from \"../systems/sound-effects-system\";\n\nconst anime = require(\"animejs\");\n\nconst SHAPE = require(\"aframe-physics-system/src/constants\").SHAPE;\n\nconst gltfLoader = new THREE.GLTFLoader();\nlet loadingObject;\ngltfLoader.load(loadingObjectSrc, gltf => {\n  loadingObject = gltf;\n});\n\nconst fetchContentType = url => {\n  return fetch(url, { method: \"HEAD\" }).then(r => r.headers.get(\"content-type\"));\n};\n\nconst fetchMaxContentIndex = url => {\n  return fetch(url).then(r => parseInt(r.headers.get(\"x-max-content-index\")));\n};\n\nconst boundingBox = new THREE.Box3();\n\nAFRAME.registerComponent(\"media-loader\", {\n  schema: {\n    fileId: { type: \"string\" },\n    fileIsOwned: { type: \"boolean\" },\n    src: { type: \"string\" },\n    resize: { default: false },\n    resolve: { default: false },\n    contentType: { default: null },\n    animate: { default: true },\n    mediaOptions: {\n      default: {},\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\n      stringify: JSON.stringify\n    }\n  },\n\n  init() {\n    this.onError = this.onError.bind(this);\n    this.showLoader = this.showLoader.bind(this);\n    this.clearLoadingTimeout = this.clearLoadingTimeout.bind(this);\n    this.onMediaLoaded = this.onMediaLoaded.bind(this);\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.networkedEl = networkedEl;\n    });\n  },\n\n  updateScale: (function() {\n    const center = new THREE.Vector3();\n    return function(resize) {\n      const mesh = this.el.getObject3D(\"mesh\");\n      const box = getBox(this.el, mesh);\n      const scaleCoefficient = resize ? getScaleCoefficient(0.5, box) : 1;\n      mesh.scale.multiplyScalar(scaleCoefficient);\n      const { min, max } = box;\n      center.addVectors(min, max).multiplyScalar(0.5 * scaleCoefficient);\n      mesh.position.sub(center);\n      mesh.matrixNeedsUpdate = true;\n    };\n  })(),\n\n  removeShape(id) {\n    if (this.el.getAttribute(\"ammo-shape__\" + id)) {\n      this.el.removeAttribute(\"ammo-shape__\" + id);\n    }\n  },\n\n  tick(t, dt) {\n    if (this.loaderMixer) {\n      this.loaderMixer.update(dt / 1000);\n    }\n  },\n\n  remove() {\n    if (this.loadingSoundNode) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.stopSoundNode(this.loadingSoundNode);\n      this.loadingSoundNode = null;\n    }\n  },\n\n  onError() {\n    this.el.removeAttribute(\"gltf-model-plus\");\n    this.el.removeAttribute(\"media-pager\");\n    this.el.removeAttribute(\"media-video\");\n    this.el.setAttribute(\"media-image\", { src: \"error\" });\n    this.clearLoadingTimeout();\n  },\n\n  showLoader() {\n    if (this.el.object3DMap.mesh) {\n      this.clearLoadingTimeout();\n      return;\n    }\n    const useFancyLoader = !!loadingObject;\n    const mesh = useFancyLoader\n      ? loadingObject.scene.clone()\n      : new THREE.Mesh(new THREE.BoxGeometry(), new THREE.MeshBasicMaterial());\n    this.el.setObject3D(\"mesh\", mesh);\n    this.updateScale(true);\n    if (useFancyLoader) {\n      this.loaderMixer = new THREE.AnimationMixer(mesh);\n\n      this.loadingClip = this.loaderMixer.clipAction(loadingObject.animations[0]);\n      this.loadingScaleClip = this.loaderMixer.clipAction(\n        new THREE.AnimationClip(null, 1000, [\n          new THREE.VectorKeyframeTrack(\".scale\", [0, 0.2], [0, 0, 0, mesh.scale.x, mesh.scale.y, mesh.scale.z])\n        ])\n      );\n      setTimeout(() => {\n        if (!this.loaderMixer) return; // Animation/loader was stopped early\n        this.el.setAttribute(\"ammo-shape__loader\", { type: SHAPE.BOX });\n      }, 200);\n\n      this.loadingClip.play();\n      this.loadingScaleClip.play();\n    }\n    if (this.el.sceneEl.is(\"entered\") && (!this.networkedEl || NAF.utils.isMine(this.networkedEl))) {\n      this.loadingSoundNode = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundLooped(\n        SOUND_MEDIA_LOADING\n      );\n    }\n    delete this.showLoaderTimeout;\n  },\n\n  clearLoadingTimeout() {\n    clearTimeout(this.showLoaderTimeout);\n    if (this.loadingSoundNode) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.stopSoundNode(this.loadingSoundNode);\n      this.loadingSoundNode = null;\n    }\n    if (this.loaderMixer) {\n      this.loadingClip.stop();\n      this.loadingScaleClip.stop();\n      delete this.loaderMixer;\n      delete this.loadingScaleClip;\n      delete this.loadingClip;\n    }\n    delete this.showLoaderTimeout;\n    this.removeShape(\"loader\");\n  },\n\n  updateHoverableVisuals() {\n    const hoverableVisuals = this.el.components[\"hoverable-visuals\"];\n\n    if (hoverableVisuals) {\n      if (!this.injectedCustomShaderChunks) {\n        this.injectedCustomShaderChunks = true;\n        hoverableVisuals.uniforms = injectCustomShaderChunks(this.el.object3D);\n      }\n\n      boundingBox.setFromObject(this.el.object3DMap.mesh);\n      boundingBox.getBoundingSphere(hoverableVisuals.boundingSphere);\n    }\n  },\n\n  onMediaLoaded(physicsShape = null) {\n    const el = this.el;\n    this.clearLoadingTimeout();\n\n    if (this.el.sceneEl.is(\"entered\")) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_MEDIA_LOADED);\n    }\n\n    const finish = () => {\n      if (physicsShape) {\n        el.setAttribute(\"ammo-shape\", {\n          type: physicsShape,\n          minHalfExtent: 0.04\n        });\n      }\n\n      this.updateHoverableVisuals();\n\n      const pager = el.components[\"media-pager\"];\n\n      if (pager) {\n        pager.repositionToolbar();\n      }\n    };\n\n    if (this.data.animate) {\n      this.addMeshScaleAnimation(this.el.getObject3D(\"mesh\"), { x: 0.001, y: 0.001, z: 0.001 }, finish);\n    } else {\n      finish();\n    }\n  },\n\n  addMeshScaleAnimation(mesh, initialScale, onComplete) {\n    const config = {\n      duration: 400,\n      easing: \"easeOutElastic\",\n      elasticity: 400,\n      loop: 0,\n      round: false,\n      x: mesh.scale.x,\n      y: mesh.scale.y,\n      z: mesh.scale.z,\n      targets: [initialScale],\n      update: (function() {\n        const lastValue = {};\n        return function(anim) {\n          const value = anim.animatables[0].target;\n\n          value.x = Math.max(0.0001, value.x);\n          value.y = Math.max(0.0001, value.y);\n          value.z = Math.max(0.0001, value.z);\n\n          // For animation timeline.\n          if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\n            return;\n          }\n\n          lastValue.x = value.x;\n          lastValue.y = value.y;\n          lastValue.z = value.z;\n\n          mesh.scale.set(value.x, value.y, value.z);\n          mesh.matrixNeedsUpdate = true;\n        };\n      })(),\n      complete: onComplete\n    };\n\n    mesh.scale.copy(initialScale);\n    mesh.matrixNeedsUpdate = true;\n\n    return anime(config);\n  },\n\n  async update(oldData) {\n    try {\n      const { src } = this.data;\n\n      if (src !== oldData.src && !this.showLoaderTimeout) {\n        this.showLoaderTimeout = setTimeout(this.showLoader, 100);\n      }\n\n      if (!src) return;\n\n      let canonicalUrl = src;\n      let accessibleUrl = src;\n      let contentType = this.data.contentType;\n      let thumbnail;\n\n      if (this.data.resolve) {\n        const result = await resolveUrl(src);\n        canonicalUrl = result.origin;\n        // handle protocol relative urls\n        if (canonicalUrl.startsWith(\"//\")) {\n          canonicalUrl = location.protocol + canonicalUrl;\n        }\n        contentType = (result.meta && result.meta.expected_content_type) || contentType;\n        thumbnail = result.meta && result.meta.thumbnail && proxiedUrlFor(result.meta.thumbnail);\n      }\n\n      // todo: we don't need to proxy for many things if the canonical URL has permissive CORS headers\n      accessibleUrl = proxiedUrlFor(canonicalUrl, null);\n\n      // if the component creator didn't know the content type, we didn't get it from reticulum, and\n      // we don't think we can infer it from the extension, we need to make a HEAD request to find it out\n      contentType = contentType || guessContentType(canonicalUrl) || (await fetchContentType(accessibleUrl));\n\n      // We don't want to emit media_resolved for index updates.\n      if (src !== oldData.src) {\n        this.el.emit(\"media_resolved\", { src, raw: accessibleUrl, contentType });\n      }\n\n      if (\n        contentType.startsWith(\"video/\") ||\n        contentType.startsWith(\"audio/\") ||\n        AFRAME.utils.material.isHLS(canonicalUrl, contentType)\n      ) {\n        const parsedUrl = new URL(src);\n        const qsTime = parseInt(parsedUrl.searchParams.get(\"t\"));\n        const hashTime = parseInt(new URLSearchParams(parsedUrl.hash.substring(1)).get(\"t\"));\n        const startTime = hashTime || qsTime || 0;\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-image\");\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\n        this.el.addEventListener(\n          \"video-loaded\",\n          e => {\n            this.onMediaLoaded(e.detail.projection === \"flat\" ? SHAPE.BOX : null);\n          },\n          { once: true }\n        );\n        this.el.setAttribute(\n          \"media-video\",\n          Object.assign({}, this.data.mediaOptions, { src: accessibleUrl, time: startTime, contentType })\n        );\n        if (this.el.components[\"position-at-box-shape-border__freeze\"]) {\n          this.el.setAttribute(\"position-at-box-shape-border__freeze\", { dirs: [\"forward\", \"back\"] });\n        }\n      } else if (contentType.startsWith(\"image/\")) {\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-video\");\n        this.el.removeAttribute(\"media-pager\");\n        this.el.addEventListener(\n          \"image-loaded\",\n          e => {\n            this.onMediaLoaded(e.detail.projection === \"flat\" ? SHAPE.BOX : null);\n          },\n          { once: true }\n        );\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\n        this.el.setAttribute(\n          \"media-image\",\n          Object.assign({}, this.data.mediaOptions, { src: accessibleUrl, contentType })\n        );\n\n        if (this.el.components[\"position-at-box-shape-border__freeze\"]) {\n          this.el.setAttribute(\"position-at-box-shape-border__freeze\", { dirs: [\"forward\", \"back\"] });\n        }\n      } else if (contentType.startsWith(\"application/pdf\")) {\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-video\");\n        // two small differences:\n        // 1. we pass the canonical URL to the pager so it can easily make subresource URLs\n        // 2. we don't remove the media-image component -- media-pager uses that internally\n        this.el.setAttribute(\"media-pager\", Object.assign({}, this.data.mediaOptions, { src: canonicalUrl }));\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\n        this.el.addEventListener(\"image-loaded\", this.clearLoadingTimeout, { once: true });\n        this.el.addEventListener(\"preview-loaded\", () => this.onMediaLoaded(SHAPE.BOX), { once: true });\n\n        if (this.el.components[\"position-at-box-shape-border__freeze\"]) {\n          this.el.setAttribute(\"position-at-box-shape-border__freeze\", { dirs: [\"forward\", \"back\"] });\n        }\n      } else if (\n        contentType.includes(\"application/octet-stream\") ||\n        contentType.includes(\"x-zip-compressed\") ||\n        contentType.startsWith(\"model/gltf\")\n      ) {\n        this.el.removeAttribute(\"media-image\");\n        this.el.removeAttribute(\"media-video\");\n        this.el.removeAttribute(\"media-pager\");\n        this.el.addEventListener(\n          \"model-loaded\",\n          () => {\n            this.updateScale(this.data.resize);\n            this.onMediaLoaded(SHAPE.HULL);\n            addAnimationComponents(this.el);\n          },\n          { once: true }\n        );\n        this.el.addEventListener(\"model-error\", this.onError, { once: true });\n        this.el.setAttribute(\n          \"gltf-model-plus\",\n          Object.assign({}, this.data.mediaOptions, {\n            src: accessibleUrl,\n            contentType: contentType,\n            inflate: true,\n            modelToWorldScale: this.data.resize ? 0.0001 : 1.0\n          })\n        );\n      } else if (contentType.startsWith(\"text/html\")) {\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-video\");\n        this.el.removeAttribute(\"media-pager\");\n        this.el.addEventListener(\n          \"image-loaded\",\n          () => {\n            const mayChangeScene = this.el.sceneEl.systems.permissions.can(\"update_hub\");\n\n            if (isHubsRoomUrl(src) || (isHubsSceneUrl(src) && mayChangeScene)) {\n              this.el.setAttribute(\"hover-menu__hubs-item\", {\n                template: \"#hubs-destination-hover-menu\",\n                dirs: [\"forward\", \"back\"]\n              });\n            } else {\n              this.el.setAttribute(\"hover-menu__link\", { template: \"#link-hover-menu\", dirs: [\"forward\", \"back\"] });\n            }\n            this.onMediaLoaded(SHAPE.BOX);\n          },\n          { once: true }\n        );\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\n        this.el.setAttribute(\n          \"media-image\",\n          Object.assign({}, this.data.mediaOptions, { src: thumbnail, contentType: \"image/png\" })\n        );\n        if (this.el.components[\"position-at-box-shape-border__freeze\"]) {\n          this.el.setAttribute(\"position-at-box-shape-border__freeze\", { dirs: [\"forward\", \"back\"] });\n        }\n      } else {\n        throw new Error(`Unsupported content type: ${contentType}`);\n      }\n    } catch (e) {\n      console.error(\"Error adding media\", e);\n      this.onError();\n    }\n  }\n});\n\nAFRAME.registerComponent(\"media-pager\", {\n  schema: {\n    src: { type: \"string\" },\n    index: { default: 0 }\n  },\n\n  init() {\n    this.toolbar = null;\n    this.imageSrc = null;\n    this.onNext = this.onNext.bind(this);\n    this.onPrev = this.onPrev.bind(this);\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.networkedEl = networkedEl;\n    });\n\n    this.el.addEventListener(\"image-loaded\", async e => {\n      this.imageSrc = e.detail.src;\n      await this._ensureUI();\n      this.update();\n    });\n  },\n\n  async _ensureUI() {\n    if (this.hasSetupUI || !this.imageSrc) return;\n    this.hasSetupUI = true;\n\n    // unfortunately, since we loaded the page image in an img tag inside media-image, we have to make a second\n    // request for the same page to read out the max-content-index header\n    this.maxIndex = await fetchMaxContentIndex(this.imageSrc);\n    const template = document.getElementById(\"paging-toolbar\");\n    this.el.querySelector(\".interactable-ui\").appendChild(document.importNode(template.content, true));\n    this.toolbar = this.el.querySelector(\".paging-toolbar\");\n    // we have to wait a tick for the attach callbacks to get fired for the elements in a template\n    setTimeout(() => {\n      this.nextButton = this.el.querySelector(\".next-button [text-button]\");\n      this.prevButton = this.el.querySelector(\".prev-button [text-button]\");\n      this.pageLabel = this.el.querySelector(\".page-label\");\n\n      this.nextButton.object3D.addEventListener(\"interact\", this.onNext);\n      this.prevButton.object3D.addEventListener(\"interact\", this.onPrev);\n\n      this.update();\n      this.el.emit(\"preview-loaded\");\n    }, 0);\n  },\n\n  async update() {\n    if (!this.data.src) return;\n\n    const pageSrc = proxiedUrlFor(this.data.src, this.data.index);\n    this.el.setAttribute(\"media-image\", { src: pageSrc, contentType: \"image/png\" });\n\n    await this._ensureUI();\n\n    if (this.pageLabel) {\n      this.pageLabel.setAttribute(\"text\", \"value\", `${this.data.index + 1}/${this.maxIndex + 1}`);\n      this.repositionToolbar();\n    }\n  },\n\n  remove() {\n    if (this.toolbar) {\n      this.toolbar.parentNode.removeChild(this.toolbar);\n    }\n  },\n\n  onNext() {\n    if (!NAF.utils.isMine(this.networkedEl) && !NAF.utils.takeOwnership(this.networkedEl)) return;\n    this.el.setAttribute(\"media-pager\", \"index\", Math.min(this.data.index + 1, this.maxIndex));\n    this.el.emit(\"pager-page-changed\");\n  },\n\n  onPrev() {\n    if (!NAF.utils.isMine(this.networkedEl) && !NAF.utils.takeOwnership(this.networkedEl)) return;\n    this.el.setAttribute(\"media-pager\", \"index\", Math.max(this.data.index - 1, 0));\n    this.el.emit(\"pager-page-changed\");\n  },\n\n  repositionToolbar() {\n    const ammoShape = this.el.getAttribute(\"ammo-shape\");\n    if (!ammoShape) return;\n\n    this.toolbar.object3D.position.y = -0.7;\n    this.toolbar.object3D.matrixNeedsUpdate = true;\n  }\n});\n","import { SOUND_QUACK, SOUND_SPECIAL_QUACK } from \"../systems/sound-effects-system\";\n\nAFRAME.registerComponent(\"quack\", {\n  schema: {\n    quackPercentage: { default: 1 },\n    specialQuackPercentage: { default: 0.01 }\n  },\n\n  init: function() {\n    this._handleGrabStart = this._handleGrabStart.bind(this);\n  },\n\n  play: function() {\n    this.el.object3D.addEventListener(\"interact\", this._handleGrabStart);\n  },\n\n  pause: function() {\n    this.el.object3D.removeEventListener(\"interact\", this._handleGrabStart);\n  },\n\n  _handleGrabStart: function() {\n    const rand = Math.random();\n    if (rand < this.data.specialQuackPercentage) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SPECIAL_QUACK);\n    } else if (rand < this.data.quackPercentage) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_QUACK);\n    }\n  }\n});\n","import { getLastWorldPosition } from \"../utils/three-utils\";\n\n/**\n * Used on a player-rig to move the player to a random spawn point on entry.\n * @namespace avatar\n * @component spawn-controller\n */\nAFRAME.registerComponent(\"spawn-controller\", {\n  schema: {\n    target: { type: \"selector\" },\n    camera: { type: \"selector\", default: \"#player-camera\" },\n    playerHeight: { default: 1.6 },\n    loadedEvent: { type: \"string\" }\n  },\n  init() {\n    this.moveToSpawnPoint = this.moveToSpawnPoint.bind(this);\n    this.data.target.addEventListener(this.data.loadedEvent, this.moveToSpawnPoint);\n  },\n  moveToSpawnPoint() {\n    const spawnPoints = document.querySelectorAll(\"[spawn-point]\");\n\n    if (spawnPoints.length === 0) {\n      // Keep default position\n      return;\n    }\n\n    const camera = this.data.camera;\n    const spawnPointIndex = Math.round((spawnPoints.length - 1) * Math.random());\n    const spawnPoint = spawnPoints[spawnPointIndex];\n\n    getLastWorldPosition(spawnPoint.object3D, this.el.object3D.position);\n    this.el.object3D.rotation.copy(spawnPoint.object3D.rotation);\n\n    if (this.el.sceneEl.is(\"vr-mode\")) {\n      // Rotate the player rig such that the vr-camera faces forward.\n      this.el.object3D.rotation.y -= this.data.camera.object3D.rotation.y;\n    } else {\n      // Reset the camera transform in 2D mode.\n      camera.object3D.position.set(0, this.data.playerHeight, 0);\n      camera.object3D.rotation.set(0, 0, 0);\n      camera.object3D.matrixNeedsUpdate = true;\n    }\n\n    // Camera faces -Z direction. Flip rotation on Y axis to face the correct direction.\n    this.el.object3D.rotation.y += Math.PI;\n    this.el.object3D.matrixNeedsUpdate = true;\n\n    // Reset pitch-yaw-rotator after any scene-preview-camera rotation.\n    if (camera.components[\"pitch-yaw-rotator\"]) {\n      camera.components[\"pitch-yaw-rotator\"].set(camera.object3D.rotation.x, camera.object3D.rotation.y);\n    }\n  }\n});\n\n/**\n * Marks an entity as a potential spawn point.\n * @namespace environment\n * @component spawn-point\n */\nAFRAME.registerComponent(\"spawn-point\", {\n  init() {\n    this.el.object3D.visible = false;\n  }\n});\n","/* global require AFRAME THREE setTimeout clearTimeout */\nimport { addMedia } from \"../utils/media-utils\";\nimport { waitForEvent } from \"../utils/async-utils\";\nimport { ObjectContentOrigins } from \"../object-types\";\nimport { paths } from \"../systems/userinput/paths\";\n\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\n\n/**\n * Spawns networked objects when grabbed or when a specified event is fired.\n * @namespace network\n * @component super-spawner\n */\nAFRAME.registerComponent(\"super-spawner\", {\n  schema: {\n    /**\n     * Source of the media asset the spawner will spawn when grabbed. This can be a gltf, video, or image, or a url that the reticiulm media API can resolve to a gltf, video, or image.\n     */\n    src: { default: \"\" },\n\n    /**\n     * Whether to use the Reticulum media resolution API to interpret the src URL (e.g. find a video URL for Youtube videos.)\n     */\n    resolve: { default: false },\n\n    /**\n     * Whether to resize the media on load.\n     */\n    resize: { default: false },\n\n    /**\n     * The template to use for this object\n     */\n    template: { default: \"\" },\n\n    /**\n     * Spawn the object at a custom position, rather than at the center of the spanwer.\n     */\n    useCustomSpawnPosition: { default: false },\n    spawnPosition: { type: \"vec3\" },\n\n    /**\n     * Spawn the object with a custom orientation, rather than copying that of the spawner.\n     */\n    useCustomSpawnRotation: { default: false },\n    spawnRotation: { type: \"vec4\" },\n\n    /**\n     * Spawn the object with a custom scale, rather than copying that of the spawner.\n     */\n    useCustomSpawnScale: { default: false },\n    spawnScale: { type: \"vec3\" },\n\n    /**\n     * The spawner will become invisible and ungrabbable for this ammount of time after being grabbed. This can prevent rapidly spawning objects.\n     */\n    spawnCooldown: { default: 1 },\n\n    /**\n     * Center the spawned object on the hand that grabbed it after it finishes loading. By default the object will be grabbed relative to where the spawner was grabbed\n     */\n    centerSpawnedObject: { default: false },\n\n    /**\n     * Optional event to listen for to spawn an object on the preferred superHand\n     */\n    spawnEvent: { type: \"string\" },\n\n    /**\n     * If true, will spawn the object at the cursor and animate it into the hand.\n     */\n    animateFromCursor: { type: \"boolean\" }\n  },\n\n  init() {\n    this.cooldownTimeout = null;\n    this.handPosition = new THREE.Vector3();\n\n    this.onSpawnEvent = this.onSpawnEvent.bind(this);\n\n    this.sceneEl = document.querySelector(\"a-scene\");\n\n    this.tempSpawnHandPosition = new THREE.Vector3();\n  },\n\n  play() {\n    if (this.data.spawnEvent) {\n      this.el.sceneEl.addEventListener(this.data.spawnEvent, this.onSpawnEvent);\n    }\n  },\n\n  pause() {\n    if (this.data.spawnEvent) {\n      this.el.sceneEl.removeEventListener(this.data.spawnEvent, this.onSpawnEvent);\n    }\n    if (this.cooldownTimeout) {\n      clearTimeout(this.cooldownTimeout);\n      this.cooldownTimeout = null;\n      this.el.setAttribute(\"visible\", true);\n      this.el.classList.add(\"interactable\");\n    }\n  },\n\n  async onSpawnEvent() {\n    if (this.cooldownTimeout || !this.el.sceneEl.is(\"entered\")) {\n      return;\n    }\n\n    const entity = addMedia(this.data.src, this.data.template, ObjectContentOrigins.SPAWNER, this.data.resolve, false)\n      .entity;\n\n    const cursor = document.querySelector(\"#cursor\");\n    cursor.object3D.getWorldPosition(entity.object3D.position);\n    cursor.object3D.getWorldQuaternion(entity.object3D.quaternion);\n    entity.object3D.matrixNeedsUpdate = true;\n\n    if (this.data.useCustomSpawnScale) {\n      entity.object3D.scale.copy(this.data.spawnScale);\n    }\n\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const willAnimateFromCursor =\n      this.data.animateFromCursor && userinput.get(paths.actions.rightHand.matrix) && !AFRAME.utils.device.isMobileVR();\n    if (!willAnimateFromCursor) {\n      interaction.state.rightRemote.held = entity;\n      interaction.state.rightRemote.spawning = true;\n    }\n    this.activateCooldown();\n    await waitForEvent(\"body-loaded\", entity);\n\n    cursor.object3D.getWorldPosition(entity.object3D.position);\n    cursor.object3D.getWorldQuaternion(entity.object3D.quaternion);\n    entity.object3D.matrixNeedsUpdate = true;\n\n    if (willAnimateFromCursor) {\n      document.querySelector(\"#player-right-controller\").object3D.getWorldPosition(this.handPosition);\n      entity.setAttribute(\"animation__spawn-at-cursor\", {\n        property: \"position\",\n        delay: 500,\n        dur: 1500,\n        from: { x: entity.object3D.position.x, y: entity.object3D.position.y, z: entity.object3D.position.z },\n        to: { x: this.handPosition.x, y: this.handPosition.y, z: this.handPosition.z },\n        easing: \"easeInOutBack\"\n      });\n    } else {\n      interaction.state.rightRemote.spawning = false;\n    }\n    entity.components[\"ammo-body\"].syncToPhysics();\n  },\n\n  activateCooldown() {\n    if (this.data.spawnCooldown > 0) {\n      const [sx, sy, sz] = [this.el.object3D.scale.x, this.el.object3D.scale.y, this.el.object3D.scale.z];\n\n      this.el.setAttribute(\"visible\", false);\n      this.el.object3D.scale.set(0.001, 0.001, 0.001);\n      this.el.object3D.matrixNeedsUpdate = true;\n      this.el.classList.remove(\"interactable\");\n      this.el.setAttribute(\"ammo-body\", { collisionFilterMask: COLLISION_LAYERS.NONE });\n      this.cooldownTimeout = setTimeout(() => {\n        this.el.setAttribute(\"visible\", true);\n        this.el.classList.add(\"interactable\");\n        this.el.setAttribute(\"ammo-body\", { collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER });\n        this.el.removeAttribute(\"animation__spawner-cooldown\");\n        this.el.setAttribute(\"animation__spawner-cooldown\", {\n          property: \"scale\",\n          delay: 50,\n          dur: 350,\n          from: { x: 0.001, y: 0.001, z: 0.001 },\n          to: { x: sx, y: sy, z: sz },\n          easing: \"easeOutElastic\"\n        });\n\n        this.cooldownTimeout = null;\n      }, this.data.spawnCooldown * 1000);\n    }\n  }\n});\n","export const waitForEvent = function(eventName, eventObj) {\n  return new Promise(resolve => {\n    eventObj.addEventListener(eventName, resolve, { once: true });\n  });\n};\n","import { Layers } from \"./layers\";\nimport \"../vendor/Water\";\nimport waterNormalMap from \"../assets/waternormals.jpg\";\n\n/**\n * @author jbouny / https://github.com/jbouny\n *\n * Work based on :\n * @author Slayvin / http://slayvin.net : Flat mirror for three.js\n * @author Stemkoski / http://www.adelphi.edu/~stemkoski : An implementation of water shader based on the flat mirror\n * @author Jonas Wagner / http://29a.ch/ && http://29a.ch/slides/2012/webglwater/ : Water shader explanations in WebGL\n */\n\nfunction MobileWater(geometry, options) {\n  THREE.Mesh.call(this, geometry);\n\n  const scope = this;\n\n  options = options || {};\n\n  const time = options.time !== undefined ? options.time : 0.0;\n  const normalSampler = options.waterNormals !== undefined ? options.waterNormals : null;\n  const sunDirection =\n    options.sunDirection !== undefined ? options.sunDirection : new THREE.Vector3(0.70707, 0.70707, 0.0);\n  const sunColor = new THREE.Color(options.sunColor !== undefined ? options.sunColor : 0xffffff);\n  const waterColor = new THREE.Color(options.waterColor !== undefined ? options.waterColor : 0x7f7f7f);\n  const eye = options.eye !== undefined ? options.eye : new THREE.Vector3(0, 0, 0);\n  const distortionScale = options.distortionScale !== undefined ? options.distortionScale : 20.0;\n  const side = options.side !== undefined ? options.side : THREE.FrontSide;\n  const fog = options.fog !== undefined ? options.fog : false;\n\n  const mirrorShader = {\n    uniforms: THREE.UniformsUtils.merge([\n      THREE.UniformsLib[\"lights\"],\n      {\n        normalSampler: { value: null },\n        time: { value: 0.0 },\n        size: { value: 1.0 },\n        distortionScale: { value: 20.0 },\n        sunColor: { value: new THREE.Color(0x7f7f7f) },\n        sunDirection: { value: new THREE.Vector3(0.70707, 0.70707, 0) },\n        eye: { value: new THREE.Vector3() },\n        waterColor: { value: new THREE.Color(0x555555) }\n      }\n    ]),\n\n    vertexShader: `\n      uniform float time;\n      varying vec4 worldPosition;\n\n      void main() {\n      \tworldPosition = modelMatrix * vec4( position, 1.0 );\n      \tvec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );\n      \tgl_Position = projectionMatrix * mvPosition;\n\n      }\n    `,\n\n    fragmentShader: `\n      uniform float time;\n      uniform float size;\n      uniform float distortionScale;\n      uniform sampler2D normalSampler;\n      uniform vec3 sunColor;\n      uniform vec3 sunDirection;\n      uniform vec3 eye;\n      uniform vec3 waterColor;\n\n      varying vec4 worldPosition;\n\n      vec4 getNoise( vec2 uv ) {\n      \tvec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);\n      \tvec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );\n      \tvec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );\n      \tvec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );\n      \tvec4 noise = texture2D( normalSampler, uv0 ) +\n      \t\ttexture2D( normalSampler, uv1 ) +\n      \t\ttexture2D( normalSampler, uv2 ) +\n      \t\ttexture2D( normalSampler, uv3 );\n      \treturn noise * 0.5 - 1.0;\n      }\n\n      void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {\n      \tvec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );\n      \tfloat direction = max( 0.0, dot( eyeDirection, reflection ) );\n      \tspecularColor += pow( direction, shiny ) * sunColor * spec;\n      \tdiffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;\n      }\n\n      ${THREE.ShaderChunk[\"common\"]}\n      ${THREE.ShaderChunk[\"packing\"]}\n      ${THREE.ShaderChunk[\"bsdfs\"]}\n      ${THREE.ShaderChunk[\"lights_pars_begin\"]}\n\n      void main() {\n      \tvec4 noise = getNoise( worldPosition.xz * size );\n      \tvec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );\n\n      \tvec3 diffuseLight = vec3(0.0);\n      \tvec3 specularLight = vec3(0.0);\n\n      \tvec3 worldToEye = eye-worldPosition.xyz;\n      \tvec3 eyeDirection = normalize( worldToEye );\n      \tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );\n\n      \tfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );\n      \tfloat rf0 = 0.3;\n      \tfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );\n      \tvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;\n      \tvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ), ( 0.5 + specularLight ), reflectance);\n      \tvec3 outgoingLight = albedo;\n      \tgl_FragColor = vec4( outgoingLight, 1 );\n      }\n    `\n  };\n\n  const material = new THREE.ShaderMaterial({\n    fragmentShader: mirrorShader.fragmentShader,\n    vertexShader: mirrorShader.vertexShader,\n    uniforms: THREE.UniformsUtils.clone(mirrorShader.uniforms),\n    transparent: false,\n    lights: true,\n    side: side,\n    fog: fog\n  });\n\n  material.uniforms.time.value = time;\n  material.uniforms.normalSampler.value = normalSampler;\n  material.uniforms.sunColor.value = sunColor;\n  material.uniforms.waterColor.value = waterColor;\n  material.uniforms.sunDirection.value = sunDirection;\n  material.uniforms.distortionScale.value = distortionScale;\n\n  material.uniforms.eye.value = eye;\n\n  scope.material = material;\n}\n\nMobileWater.prototype = Object.create(THREE.Mesh.prototype);\nMobileWater.prototype.constructor = THREE.Water;\n\nasync function loadWaterNormals(url) {\n  const texture = await new Promise((resolve, reject) =>\n    new THREE.TextureLoader().load(url, resolve, undefined, reject)\n  );\n  texture.wrapS = texture.wrapT = THREE.RepeatWrapping;\n  texture.needsUpdate = true;\n  return texture;\n}\n\nAFRAME.registerComponent(\"water\", {\n  schema: {\n    waterColor: { type: \"color\", default: \"#001e0f\" },\n    distortionScale: { type: \"number\", default: 3.7 },\n    sunColor: { type: \"color\", default: \"#ffffff\" },\n    inclination: { type: \"number\", default: 0 },\n    azimuth: { type: \"number\", default: 0 },\n    distance: { type: \"number\", default: 1 },\n    speed: { type: \"number\", default: 0.1 },\n    forceMobile: { type: \"boolean\", default: false }\n  },\n  init() {\n    const waterMesh = this.el.getObject3D(\"mesh\");\n    const waterGeometry = waterMesh.geometry;\n\n    // Render THREE.Water shader instead of THREE.Mesh\n    waterMesh.visible = false;\n\n    loadWaterNormals(waterNormalMap).then(waterNormals => {\n      const waterConfig = {\n        textureWidth: 512,\n        textureHeight: 512,\n        waterNormals: waterNormals,\n        sunDirection: this.data.sunDirection,\n        sunColor: new THREE.Color(this.data.sunColor),\n        waterColor: new THREE.Color(this.data.waterColor),\n        distortionScale: this.data.distortionScale,\n        fog: false\n      };\n\n      if (AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR() || this.data.forceMobile) {\n        this.water = new MobileWater(waterGeometry, waterConfig);\n      } else {\n        this.water = new THREE.Water(waterGeometry, waterConfig);\n        this.water.mirrorCamera.layers.set(Layers.reflection);\n      }\n\n      this.el.setObject3D(\"water\", this.water);\n    });\n  },\n\n  update(oldData) {\n    if (this.data.forceMobile !== oldData.forceMobile) {\n      this.el.removeObject3D(\"water\");\n      this.init();\n      return;\n    }\n\n    if (!this.water) {\n      return;\n    }\n\n    const uniforms = this.water.material.uniforms;\n\n    if (this.data.waterColor !== oldData.waterColor) {\n      uniforms.waterColor.value.setStyle(this.data.waterColor);\n    }\n\n    if (this.data.distortionScale !== oldData.distortionScale) {\n      uniforms.distortionScale.value = this.data.distortionScale;\n    }\n\n    if (this.data.sunColor !== oldData.sunColor) {\n      uniforms.sunColor.value.setStyle(this.data.sunColor);\n    }\n\n    if (\n      this.data.inclination !== oldData.inclination ||\n      this.data.azimuth !== oldData.azimuth ||\n      this.data.distance !== oldData.distance\n    ) {\n      const theta = Math.PI * (this.data.inclination - 0.5);\n      const phi = 2 * Math.PI * (this.data.azimuth - 0.5);\n\n      const distance = this.data.distance;\n\n      const x = distance * Math.cos(phi);\n      const y = distance * Math.sin(phi) * Math.sin(theta);\n      const z = distance * Math.sin(phi) * Math.cos(theta);\n\n      uniforms.sunDirection.value.set(x, y, z);\n    }\n  },\n\n  tick(time) {\n    if (this.water) {\n      this.water.material.uniforms.time.value = (time / 1000) * this.data.speed;\n    }\n  },\n\n  remove() {\n    this.el.removeObject3D(\"water\");\n    const waterMesh = this.el.getObject3D(\"mesh\");\n    waterMesh.visible = true;\n  }\n});\n","export default function nextTick() {\n  return new Promise(resolve => {\n    setTimeout(resolve, 0);\n  });\n}\n","const tempVector3 = new THREE.Vector3();\nconst tempQuaternion = new THREE.Quaternion();\n\nexport function getLastWorldPosition(src, target) {\n  target.setFromMatrixPosition(src.matrixWorld);\n  return target;\n}\n\nexport function getLastWorldQuaternion(src, target) {\n  src.matrixWorld.decompose(tempVector3, target, tempVector3);\n  return target;\n}\n\nexport function getLastWorldScale(src, target) {\n  src.matrixWorld.decompose(tempVector3, tempQuaternion, target);\n  return target;\n}\n\nexport function disposeMaterial(mtrl) {\n  if (mtrl.map) mtrl.map.dispose();\n  if (mtrl.lightMap) mtrl.lightMap.dispose();\n  if (mtrl.bumpMap) mtrl.bumpMap.dispose();\n  if (mtrl.normalMap) mtrl.normalMap.dispose();\n  if (mtrl.specularMap) mtrl.specularMap.dispose();\n  if (mtrl.envMap) mtrl.envMap.dispose();\n  mtrl.dispose();\n}\n\nexport function disposeNode(node) {\n  if (!(node instanceof THREE.Mesh)) return;\n\n  if (node.geometry) {\n    node.geometry.dispose();\n  }\n\n  if (node.material) {\n    let materialArray;\n    if (node.material instanceof THREE.MeshFaceMaterial || node.material instanceof THREE.MultiMaterial) {\n      materialArray = node.material.materials;\n    } else if (node.material instanceof Array) {\n      materialArray = node.material;\n    }\n    if (materialArray) {\n      materialArray.forEach(disposeMaterial);\n    } else {\n      disposeMaterial(node.material);\n    }\n  }\n}\n","import { objectTypeForOriginAndContentType } from \"../object-types\";\nimport { getReticulumFetchUrl } from \"./phoenix-utils\";\nimport mediaHighlightFrag from \"./media-highlight-frag.glsl\";\nimport { mapMaterials } from \"./material-utils\";\n\nconst nonCorsProxyDomains = (process.env.NON_CORS_PROXY_DOMAINS || \"\").split(\",\");\nif (process.env.CORS_PROXY_SERVER) {\n  nonCorsProxyDomains.push(process.env.CORS_PROXY_SERVER);\n}\nconst mediaAPIEndpoint = getReticulumFetchUrl(\"/api/v1/media\");\n\nconst commonKnownContentTypes = {\n  gltf: \"model/gltf\",\n  glb: \"model/gltf-binary\",\n  png: \"image/png\",\n  jpg: \"image/jpeg\",\n  jpeg: \"image/jpeg\",\n  pdf: \"application/pdf\",\n  mp4: \"video/mp4\",\n  mp3: \"audio/mpeg\"\n};\n\nconst PHYSICS_CONSTANTS = require(\"aframe-physics-system/src/constants\"),\n  SHAPE = PHYSICS_CONSTANTS.SHAPE,\n  FIT = PHYSICS_CONSTANTS.FIT;\n\n// thanks to https://developer.mozilla.org/en-US/docs/Web/API/WindowBase64/Base64_encoding_and_decoding\nfunction b64EncodeUnicode(str) {\n  // first we use encodeURIComponent to get percent-encoded UTF-8, then we convert the percent-encodings\n  // into raw bytes which can be fed into btoa.\n  const CHAR_RE = /%([0-9A-F]{2})/g;\n  return btoa(encodeURIComponent(str).replace(CHAR_RE, (_, p1) => String.fromCharCode(\"0x\" + p1)));\n}\n\nconst farsparkEncodeUrl = url => {\n  // farspark doesn't know how to read '=' base64 padding characters\n  // translate base64 + to - and / to _ for URL safety\n  return b64EncodeUnicode(url)\n    .replace(/=+$/g, \"\")\n    .replace(/\\+/g, \"-\")\n    .replace(/\\//g, \"_\");\n};\n\nexport const scaledThumbnailUrlFor = (url, width, height) => {\n  if (\n    process.env.RETICULUM_SERVER &&\n    process.env.RETICULUM_SERVER.includes(\"hubs.local\") &&\n    url.includes(\"hubs.local\")\n  ) {\n    return url;\n  }\n\n  return `https://${process.env.FARSPARK_SERVER}/thumbnail/${farsparkEncodeUrl(url)}?w=${width}&h=${height}`;\n};\n\nexport const proxiedUrlFor = (url, index = null) => {\n  if (!(url.startsWith(\"http:\") || url.startsWith(\"https:\"))) return url;\n\n  const hasIndex = index !== null;\n\n  if (!hasIndex) {\n    // Skip known domains that do not require CORS proxying.\n    try {\n      const parsedUrl = new URL(url);\n      if (nonCorsProxyDomains.find(domain => parsedUrl.hostname.endsWith(domain))) return url;\n    } catch (e) {\n      // Ignore\n    }\n  }\n\n  if (hasIndex || !process.env.CORS_PROXY_SERVER) {\n    const method = hasIndex ? \"extract\" : \"raw\";\n    return `https://${process.env.FARSPARK_SERVER}/0/${method}/0/0/0/${index || 0}/${farsparkEncodeUrl(url)}`;\n  } else {\n    return `https://${process.env.CORS_PROXY_SERVER}/${url}`;\n  }\n};\n\nconst resolveUrlCache = new Map();\nexport const resolveUrl = async (url, index) => {\n  const cacheKey = `${url}|${index}`;\n  if (resolveUrlCache.has(cacheKey)) return resolveUrlCache.get(cacheKey);\n  const resolved = await fetch(mediaAPIEndpoint, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({ media: { url, index } })\n  }).then(r => r.json());\n  resolveUrlCache.set(cacheKey, resolved);\n  return resolved;\n};\n\nexport const getCustomGLTFParserURLResolver = gltfUrl => url => {\n  if (typeof url !== \"string\" || url === \"\") return \"\";\n  if (/^(https?:)?\\/\\//i.test(url)) return url;\n  if (/^data:.*,.*$/i.test(url)) return url;\n  if (/^blob:.*$/i.test(url)) return url;\n\n  if (process.env.CORS_PROXY_SERVER) {\n    // For absolute paths with a CORS proxied gltf URL, re-write the url properly to be proxied\n    const corsProxyPrefix = `https://${process.env.CORS_PROXY_SERVER}/`;\n\n    if (gltfUrl.startsWith(corsProxyPrefix)) {\n      const originalUrl = decodeURIComponent(gltfUrl.substring(corsProxyPrefix.length));\n      const originalUrlParts = originalUrl.split(\"/\");\n\n      // Drop the .gltf filename\n      const path = new URL(url).pathname;\n      const assetUrl = originalUrlParts.slice(0, originalUrlParts.length - 1).join(\"/\") + \"/\" + path;\n      return corsProxyPrefix + assetUrl;\n    }\n  }\n\n  return url;\n};\n\nexport const guessContentType = url => {\n  if (url.startsWith(\"hubs://\") && url.endsWith(\"/video\")) return \"video/vnd.hubs-webrtc\";\n  const extension = new URL(url).pathname.split(\".\").pop();\n  return commonKnownContentTypes[extension];\n};\n\nexport const upload = file => {\n  const formData = new FormData();\n  formData.append(\"media\", file);\n  formData.append(\"promotion_mode\", \"with_token\");\n  return fetch(mediaAPIEndpoint, {\n    method: \"POST\",\n    body: formData\n  }).then(r => r.json());\n};\n\n// https://stackoverflow.com/questions/7584794/accessing-jpeg-exif-rotation-data-in-javascript-on-the-client-side/32490603#32490603\nfunction getOrientation(file, callback) {\n  const reader = new FileReader();\n  reader.onload = function(e) {\n    const view = new DataView(e.target.result);\n    if (view.getUint16(0, false) != 0xffd8) {\n      return callback(-2);\n    }\n    const length = view.byteLength;\n    let offset = 2;\n    while (offset < length) {\n      if (view.getUint16(offset + 2, false) <= 8) return callback(-1);\n      const marker = view.getUint16(offset, false);\n      offset += 2;\n      if (marker == 0xffe1) {\n        if (view.getUint32((offset += 2), false) != 0x45786966) {\n          return callback(-1);\n        }\n\n        const little = view.getUint16((offset += 6), false) == 0x4949;\n        offset += view.getUint32(offset + 4, little);\n        const tags = view.getUint16(offset, little);\n        offset += 2;\n        for (let i = 0; i < tags; i++) {\n          if (view.getUint16(offset + i * 12, little) == 0x0112) {\n            return callback(view.getUint16(offset + i * 12 + 8, little));\n          }\n        }\n      } else if ((marker & 0xff00) != 0xff00) {\n        break;\n      } else {\n        offset += view.getUint16(offset, false);\n      }\n    }\n    return callback(-1);\n  };\n  reader.readAsArrayBuffer(file);\n}\n\nlet interactableId = 0;\nexport const addMedia = (src, template, contentOrigin, resolve = false, resize = false, animate = true) => {\n  const scene = AFRAME.scenes[0];\n\n  const entity = document.createElement(\"a-entity\");\n  entity.id = \"interactable-media-\" + interactableId++;\n  entity.setAttribute(\"networked\", { template: template });\n  const needsToBeUploaded = src instanceof File;\n  entity.setAttribute(\"media-loader\", {\n    resize,\n    resolve,\n    animate,\n    src: typeof src === \"string\" ? src : \"\",\n    fileIsOwned: !needsToBeUploaded\n  });\n\n  entity.object3D.matrixNeedsUpdate = true;\n\n  scene.appendChild(entity);\n\n  const fireLoadingTimeout = setTimeout(() => {\n    scene.emit(\"media-loading\", { src: src });\n  }, 100);\n\n  [\"model-loaded\", \"video-loaded\", \"image-loaded\"].forEach(eventName => {\n    entity.addEventListener(\n      eventName,\n      async () => {\n        clearTimeout(fireLoadingTimeout);\n        scene.emit(\"media-loaded\", { src: src });\n      },\n      { once: true }\n    );\n  });\n\n  const orientation = new Promise(function(resolve) {\n    if (needsToBeUploaded) {\n      getOrientation(src, x => {\n        resolve(x);\n      });\n    } else {\n      resolve(1);\n    }\n  });\n  if (needsToBeUploaded) {\n    upload(src)\n      .then(response => {\n        const srcUrl = new URL(response.raw);\n        srcUrl.searchParams.set(\"token\", response.meta.access_token);\n        entity.setAttribute(\"media-loader\", { resolve: false, src: srcUrl.href, fileId: response.file_id });\n        window.APP.store.update({\n          uploadPromotionTokens: [{ fileId: response.file_id, promotionToken: response.meta.promotion_token }]\n        });\n      })\n      .catch(e => {\n        console.error(\"Media upload failed\", e);\n        entity.setAttribute(\"media-loader\", { src: \"error\" });\n      });\n  } else if (src instanceof MediaStream) {\n    entity.setAttribute(\"media-loader\", { src: `hubs://clients/${NAF.clientId}/video` });\n  }\n\n  if (contentOrigin) {\n    entity.addEventListener(\"media_resolved\", ({ detail }) => {\n      const objectType = objectTypeForOriginAndContentType(contentOrigin, detail.contentType, detail.src);\n      scene.emit(\"object_spawned\", { objectType });\n    });\n  }\n\n  return { entity, orientation };\n};\n\nexport function injectCustomShaderChunks(obj) {\n  const vertexRegex = /\\bskinning_vertex\\b/;\n  const fragRegex = /\\bgl_FragColor\\b/;\n  const validMaterials = [\"MeshStandardMaterial\", \"MeshBasicMaterial\", \"MobileStandardMaterial\"];\n\n  const shaderUniforms = [];\n\n  obj.traverse(object => {\n    if (!object.material) return;\n\n    object.material = mapMaterials(object, material => {\n      if (!validMaterials.includes(material.type)) {\n        return material;\n      }\n\n      // HACK, this routine inadvertently leaves the A-Frame shaders wired to the old, dark\n      // material, so maps cannot be updated at runtime. This breaks UI elements who have\n      // hover/toggle state, so for now just skip these while we figure out a more correct\n      // solution.\n      if (object.el.classList.contains(\"ui\")) return material;\n      if (object.el.classList.contains(\"hud\")) return material;\n      if (object.el.getAttribute(\"text-button\")) return material;\n\n      const newMaterial = material.clone();\n      newMaterial.onBeforeCompile = shader => {\n        if (!vertexRegex.test(shader.vertexShader)) return;\n\n        shader.uniforms.hubs_IsFrozen = { value: false };\n        shader.uniforms.hubs_EnableSweepingEffect = { value: false };\n        shader.uniforms.hubs_SweepParams = { value: [0, 0] };\n        shader.uniforms.hubs_InteractorOnePos = { value: [0, 0, 0] };\n        shader.uniforms.hubs_InteractorTwoPos = { value: [0, 0, 0] };\n        shader.uniforms.hubs_HighlightInteractorOne = { value: false };\n        shader.uniforms.hubs_HighlightInteractorTwo = { value: false };\n        shader.uniforms.hubs_Time = { value: 0 };\n\n        const vchunk = `\n        if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\n          vec4 wt = modelMatrix * vec4(transformed, 1);\n\n          // Used in the fragment shader below.\n          hubs_WorldPosition = wt.xyz;\n        }\n      `;\n\n        const vlines = shader.vertexShader.split(\"\\n\");\n        const vindex = vlines.findIndex(line => vertexRegex.test(line));\n        vlines.splice(vindex + 1, 0, vchunk);\n        vlines.unshift(\"varying vec3 hubs_WorldPosition;\");\n        vlines.unshift(\"uniform bool hubs_IsFrozen;\");\n        vlines.unshift(\"uniform bool hubs_HighlightInteractorOne;\");\n        vlines.unshift(\"uniform bool hubs_HighlightInteractorTwo;\");\n        shader.vertexShader = vlines.join(\"\\n\");\n\n        const flines = shader.fragmentShader.split(\"\\n\");\n        const findex = flines.findIndex(line => fragRegex.test(line));\n        flines.splice(findex + 1, 0, mediaHighlightFrag);\n        flines.unshift(\"varying vec3 hubs_WorldPosition;\");\n        flines.unshift(\"uniform bool hubs_IsFrozen;\");\n        flines.unshift(\"uniform bool hubs_EnableSweepingEffect;\");\n        flines.unshift(\"uniform vec2 hubs_SweepParams;\");\n        flines.unshift(\"uniform bool hubs_HighlightInteractorOne;\");\n        flines.unshift(\"uniform vec3 hubs_InteractorOnePos;\");\n        flines.unshift(\"uniform bool hubs_HighlightInteractorTwo;\");\n        flines.unshift(\"uniform vec3 hubs_InteractorTwoPos;\");\n        flines.unshift(\"uniform float hubs_Time;\");\n        shader.fragmentShader = flines.join(\"\\n\");\n\n        shaderUniforms.push(shader.uniforms);\n      };\n      newMaterial.needsUpdate = true;\n      return newMaterial;\n    });\n  });\n\n  return shaderUniforms;\n}\n\nexport function getPromotionTokenForFile(fileId) {\n  return window.APP.store.state.uploadPromotionTokens.find(upload => upload.fileId === fileId);\n}\n\nexport const traverseMeshesAndAddShapes = (function() {\n  const vertexLimit = 200000;\n  const shapePrefix = \"ammo-shape__\";\n  const shapes = [];\n  return function(el) {\n    const meshRoot = el.object3DMap.mesh;\n    while (shapes.length > 0) {\n      const { id, entity } = shapes.pop();\n      entity.removeAttribute(id);\n    }\n\n    let vertexCount = 0;\n    meshRoot.traverse(o => {\n      if (\n        o.isMesh &&\n        (!THREE.Sky || o.__proto__ != THREE.Sky.prototype) &&\n        o.name !== \"Floor_Plan\" &&\n        o.name !== \"Ground_Plane\"\n      ) {\n        vertexCount += o.geometry.attributes.position.count;\n      }\n    });\n\n    console.group(\"traverseMeshesAndAddShapes\");\n\n    console.log(`scene has ${vertexCount} vertices from meshes`);\n\n    const floorPlan = meshRoot.children.find(obj => {\n      return obj.name === \"Floor_Plan\";\n    });\n    if ((vertexCount > vertexLimit || vertexCount === 0) && floorPlan) {\n      console.log(`vertex limit of ${vertexLimit} exceeded, using floor plan with mesh shape`);\n      floorPlan.el.setAttribute(shapePrefix + floorPlan.name, {\n        type: SHAPE.MESH,\n        margin: 0.01,\n        fit: FIT.ALL\n      });\n      shapes.push({ id: shapePrefix + floorPlan.name, entity: floorPlan.el });\n    } else if (vertexCount < vertexLimit && vertexCount > 0) {\n      el.setAttribute(shapePrefix + \"environment\", {\n        type: SHAPE.MESH,\n        margin: 0.01,\n        fit: FIT.ALL\n      });\n      shapes.push({ id: shapePrefix + \"environment\", entity: el });\n      console.log(\"adding compound mesh shape\");\n    } else {\n      el.setAttribute(shapePrefix + \"defaultFloor\", {\n        type: SHAPE.BOX,\n        margin: 0.01,\n        halfExtents: { x: 4000, y: 0.5, z: 4000 },\n        offset: { x: 0, y: -0.5, z: 0 },\n        fit: FIT.MANUAL\n      });\n      shapes.push({ id: shapePrefix + \"defaultFloor\", entity: el });\n      console.log(\"adding default floor collision\");\n    }\n    console.groupEnd();\n  };\n})();\n\nconst mediaPos = new THREE.Vector3();\n\nexport function spawnMediaAround(el, media, snapCount, mirrorOrientation = false) {\n  const { entity, orientation } = addMedia(media, \"#interactable-media\", undefined, false);\n\n  const pos = el.object3D.position;\n\n  entity.object3D.position.set(pos.x, pos.y, pos.z);\n  entity.object3D.rotation.copy(el.object3D.rotation);\n\n  if (mirrorOrientation) {\n    entity.object3D.rotateY(Math.PI);\n  }\n\n  // Generate photos in a circle around camera, starting from the bottom.\n  // Prevent z-fighting but place behind viewfinder\n  const idx = (snapCount % 6) + 3;\n\n  mediaPos.set(\n    Math.cos(Math.PI * 2 * (idx / 6.0)) * 0.75,\n    Math.sin(Math.PI * 2 * (idx / 6.0)) * 0.75,\n    -0.05 + idx * 0.001\n  );\n\n  el.object3D.localToWorld(mediaPos);\n  entity.object3D.visible = false;\n\n  entity.addEventListener(\n    \"image-loaded\",\n    () => {\n      entity.object3D.visible = true;\n      entity.setAttribute(\"animation__photo_pos\", {\n        property: \"position\",\n        dur: 800,\n        from: { x: pos.x, y: pos.y, z: pos.z },\n        to: { x: mediaPos.x, y: mediaPos.y, z: mediaPos.z },\n        easing: \"easeOutElastic\"\n      });\n    },\n    { once: true }\n  );\n\n  entity.object3D.matrixNeedsUpdate = true;\n\n  entity.addEventListener(\n    \"media_resolved\",\n    () => {\n      el.emit(\"photo_taken\", entity.components[\"media-loader\"].data.src);\n    },\n    { once: true }\n  );\n\n  return { entity, orientation };\n}\n\nconst hubsSceneRegex = /https?:\\/\\/(hubs.local(:\\d+)?|(smoke-)?hubs.mozilla.com)\\/scenes\\/(\\w+)\\/?\\S*/;\nconst hubsRoomRegex = /https?:\\/\\/(hubs.local(:\\d+)?|(smoke-)?hubs.mozilla.com)\\/(\\w+)\\/?\\S*/;\nexport const isHubsSceneUrl = hubsSceneRegex.test.bind(hubsSceneRegex);\nexport const isHubsRoomUrl = url => !isHubsSceneUrl(url) && hubsRoomRegex.test(url);\nexport const isHubsDestinationUrl = url => isHubsSceneUrl(url) || isHubsRoomUrl(url);\n","module.exports = __webpack_public_path__ + \"assets/images/twitter-b2e343d39bc8d3294292e506c7173f71.svg\";","module.exports = __webpack_public_path__ + \"assets/images/spoke_logo_black-31d4b5f1f5ef27bb389bc31a4c97b57f.png\";"],"sourceRoot":""}