{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/utils/history.js","webpack:///./src/storage/media-search-store.js","webpack:///./src/utils/promisify-worker.js","webpack:///./src/react-components/avatar-selector.js","webpack:///./src/avatar-selector.js","webpack:///./src/constants.js","webpack:///./src/materials/MobileStandardMaterial.js","webpack:///./src/components/gltf-model-plus.js","webpack:///./src/utils/phoenix-utils.js","webpack:///./src/utils/scene-graph.js","webpack:///./src/utils/media-highlight-frag.glsl","webpack:///./src/assets/images/cubemap/posx.jpg","webpack:///./src/assets/images/cubemap/negx.jpg","webpack:///./src/assets/images/cubemap/posy.jpg","webpack:///./src/assets/images/cubemap/negy.jpg","webpack:///./src/assets/images/cubemap/posz.jpg","webpack:///./src/assets/images/cubemap/negz.jpg","webpack:///./src/App.js","webpack:///./src/components/environment-map.js","webpack:///./src/utils/webgl.js","webpack:///./src/components/animation.js","webpack:///./src/components/animation-mixer.js","webpack:///./src/components/audio-feedback.js","webpack:///./src/components/loop-animation.js","webpack:///./src/components/skybox.js","webpack:///./src/utils/qs_truthy.js","webpack:///./src/utils/i18n.js","webpack:///./src/utils/component-mappings.js","webpack:///./src/gltf-component-mappings.js","webpack:///./src/utils/identity.js","webpack:///./src/storage/store.js","webpack:///./src/assets/avatars/avatars.js","webpack:///./src/utils/material-utils.js","webpack:///./src/object-types.js","webpack:///./src/telemetry.js","webpack:///./src/react-components/wrap-with-audio.js","webpack:///./src/utils/next-tick.js","webpack:///./src/utils/media-utils.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","4","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","pushOrUpdateHistory","history","replace","k","v","detail","newPathname","newSearch","state","newLength","location","__historyLength","_objectSpread","__duplicate","pathname","undefined","search","isDuplicate","method","pushHistoryState","replaceHistoryState","pushHistoryPath","path","clearHistoryState","popToBeginningOfHubHistory","navigateToPriorPage","len","Promise","resolve","unsubscribe","listen","go","sluglessPath","split","join","withSlug","SOURCES","URL_SOURCE_TO_TO_API_SOURCE","scenes","images","videos","youtube","gifs","sketchfab","poly","twitch","MEDIA_SOURCE_DEFAULT_FILTERS","SEARCH_CONTEXT_PARAMS","MediaSearchStore","EventTarget","constructor","super","_defineProperty","this","async","dispatchEvent","CustomEvent","urlSource","getUrlMediaSource","previousSource","urlParams","URLSearchParams","requestIndex","currentRequestIndex","searchParams","param","set","source","navigator","languages","singular","startsWith","APP","store","credentialsAccountId","url","getReticulumFetchUrl","toString","lastSavedUrl","_fetchMedia","nextCursor","meta","next_cursor","lastFetchedUrl","qsTruthy","entries","avatars","map","_legacyAvatarToSearchEntry","headers","Content-Type","credentialsToken","credentials","token","authorization","res","fetch","body","text","JSON","parse","e","legacyAvatar","id","type","preview","thumbnail","width","height","gltfs","avatar","model","delta","goBack","filter","query","delete","keepSource","keepNav","_stashedParams","_stashedSource","q","_sourceNavigate","hideNav","useLastStashedParams","currentQuery","getSearchClearedSearchParams","useValue","hasAccountWithAvatars","_hasAccountWithAvatars","process","document","host","substring","stashLastSearchParams","_stashLastSearchParams","hasMediaPath","setHistory","_update","promisifyWorker","worker","nextItemId","outstanding","onmessage","msg","err","handlers","console","error","reject","Error","transfer","promise","postMessage","payload","__webpack_exports__","AvatarSelector","Component","props","initialAvatarIndex","avatarIndices","offset","getAvatarIndex","nextAvatarId","nextAvatarIndex","onChange","previousAvatarId","previousAvatarIndex","UNSAFE_componentWillReceiveProps","nextProps","setState","numAvatars","lastIndex","currAvatarIndex","Array","from","increasing","direction","indexOf","addIndex","includes","unshift","componentDidMount","scene","addEventListener","setAttribute","defaultLightsEnabled","enabled","quality","componentDidUpdate","prevProps","avatarId","currRot","animation","getAttribute","currY","y","toY","to","Number","step","fromY","Math","abs","x","z","render","avatarAssets","react_default","a","createElement","response-type","src","avatarEntities","rotation","position","gltf-model-plus","rotationFromIndex","index","initialRotation","toRotation","className","ref","sce","background","environment-map","loading-screen","renderer","skybox","anm","camera","hide-when-quality","light","wrap_with_audio","onClick","emitChangeToPrevious","react_fontawesome_index_es","icon","faAngleLeft","emitChangeToNext","faAngleRight","PropTypes","array","string","func","findIndex","injectIntl","arg","postAvatarIdToParent","newAvatarId","parent","origin","mountUI","ReactDOM","index_es","locale","lang","messages","react_components_avatar_selector","getElementById","patchWebGLRenderingContext","addLocaleData","en","registerTelemetry","App","hash","AFRAME","utils","device","isMobile","isMobileVR","readyState","COLLISION_LAYERS","ALL","NONE","INTERACTABLES","ENVIRONMENT","AVATAR","HANDS","DEFAULT_INTERACTABLE","UNOWNED_INTERACTABLE","DEFAULT_SPAWNER","VERTEX_SHADER","FRAGMENT_SHADER","MobileStandardMaterial","THREE","ShaderMaterial","[object Object]","args","material","parameters","vertexShader","fragmentShader","uniforms","uvTransform","Matrix3","diffuse","color","opacity","aoMapIntensity","aoMap","emissive","emissiveMap","fog","lights","transparent","skinning","morphTargets","vertexColors","mobileMaterial","clone","fromStandardMaterial","loadGLTF","Mesh","raycast","acceleratedRaycast","GLTFCache","extractZipFile","SketchfabZipWorker","defaultInflator","el","componentName","componentData","components","multiple","isArray","cloneSkinnedMesh","cloneLookup","Map","parallelTraverse","b","callback","children","sourceNode","clonedNode","isMesh","geometry","boundsTree","traverse","sourceMesh","isSkinnedMesh","sourceBones","skeleton","bones","clonedMesh","sourceBone","has","bindMatrix","getHubsComponents","node","hubsComponents","userData","gltfExtensions","MOZ_hubs_components","HUBS_components","legacyComponents","GLTFModelPlus","registerComponent","componentKey","inflator","inflateEntities","indexToEntityMap","templates","isRoot","modelToWorldScale","childEntities","child","entityComponents","append","uuid","classList","add","order","setFromQuaternion","quaternion","object3D","copy","scale","multiplyScalar","matrixNeedsUpdate","matrixAutoUpdate","matrix","identity","decompose","setObject3D","toLowerCase","animations","gltfIndex","attachTemplate","root","templateRoot","targetEls","querySelectorAll","cloneNode","_ref","attributes","appendChild","contentType","preferredTechnique","onProgress","fileMap","gltfUrl","loadingManager","LoadingManager","setURLModifier","getCustomGLTFParserURLResolver","gltfLoader","GLTFLoader","parser","createParser","materials","json","extensions","MOZ_alt_materials","altMaterialIndex","nodes","extras","gltf","Object3D","DefaultMatrixAutoUpdate","mapMaterials","isMeshStandardMaterial","keys","forEach","URL","revokeObjectURL","schema","useCache","default","inflate","init","loadTemplates","update","applySrc","templateEl","importNode","firstElementChild","content","technique","charAt","assetEl","lastSrc","inflatedEl","warn","disposeLastInflatedEl","emit","loadModel","initMixer","obj","hasBufferGeometry","isBufferGeometry","hasBoundsTree","geo","triCount","count","MeshBVH","strategy","maxDepth","object3DToSet","nextTick","inflatedEntity","prop","inflateComponents","rewires","environmentMapComponent","sceneEl","applyEnvironmentMap","f","format","parentNode","removeChild","dispose","removeAttribute","invalidateReticulumMeta","getReticulumMeta","connectToReticulum","getLandingPageForPhoto","fetchReticulumAuthenticated","createAndRedirectToNewHub","getPresenceProfileForSession","migrateChannelToSocket","absolute","reticulumMeta","invalidatedReticulumMetaThisSession","querySelector","version","pool","phx_host","then","phxHostOverride","debug","params","qs","getNewSocketUrl","socketProtocol","protocol","socketHost","socketPort","socketUrl","log","socketSettings","logger","kind","socket","Socket","connect","onError","endPointPath","endPoint","newEndPoint","photoUrl","parsedUrl","retUrl","content-type","stringify","sceneId","sceneUrl","createUrl","hub","scene_id","default_environment_gltf_bundle_url","Store","email","creatorAssignmentToken","creator_assignment_token","creatorAssignmentTokens","hubId","hub_id","presences","sessionId","presence","find","metas","profile","oldChannel","channel","topic","bindings","item","on","event","pushBuffer","timeout","oldJoinPush","joinPush","recHooks","receive","status","findAncestorWithComponent","entity","_storage_store__WEBPACK_IMPORTED_MODULE_0__","_storage_media_search_store__WEBPACK_IMPORTED_MODULE_1__","mediaSearchStore","setQuality","createDefaultEnvironmentMap","_utils_material_utils__WEBPACK_IMPORTED_MODULE_0__","_assets_images_cubemap_posx_jpg__WEBPACK_IMPORTED_MODULE_1__","_assets_images_cubemap_posx_jpg__WEBPACK_IMPORTED_MODULE_1___default","_assets_images_cubemap_negx_jpg__WEBPACK_IMPORTED_MODULE_2__","_assets_images_cubemap_negx_jpg__WEBPACK_IMPORTED_MODULE_2___default","_assets_images_cubemap_posy_jpg__WEBPACK_IMPORTED_MODULE_3__","_assets_images_cubemap_posy_jpg__WEBPACK_IMPORTED_MODULE_3___default","_assets_images_cubemap_negy_jpg__WEBPACK_IMPORTED_MODULE_4__","_assets_images_cubemap_negy_jpg__WEBPACK_IMPORTED_MODULE_4___default","_assets_images_cubemap_posz_jpg__WEBPACK_IMPORTED_MODULE_5__","_assets_images_cubemap_posz_jpg__WEBPACK_IMPORTED_MODULE_5___default","_assets_images_cubemap_negz_jpg__WEBPACK_IMPORTED_MODULE_6__","_assets_images_cubemap_negz_jpg__WEBPACK_IMPORTED_MODULE_6___default","urls","cubeMapPosX","cubeMapNegX","cubeMapPosY","cubeMapNegY","cubeMapPosZ","cubeMapNegZ","texture","CubeTextureLoader","load","RGBFormat","loadDefault","environmentMap","updateEnvironmentMap","forEachMaterial","envMap","needsUpdate","test","userAgent","originalGetExtension","WebGLRenderingContext","getExtension","supportsFloatTextures","WebGLRenderer","Scene","Float32Array","size","dataTexture","DataTexture","RGBAFormat","FloatType","box","PlaneBufferGeometry","MeshBasicMaterial","Camera","context","getError","checkFloatTextureSupport","anime","require","colorHelperFrom","Color","colorHelperTo","getComponentProperty","setComponentProperty","splitCache","TYPE_COLOR","STRING_COMPONENTS","STRING_OBJECT3D","toRadians","degToRad","addEventListeners","eventNames","handler","removeEventListeners","removeEventListener","getRawProperty","splitDot","setRawProperty","propertyName","targetValue","g","isRawProperty","autoplay","delay","dir","dur","easing","elasticity","loop","parseInt","startEvents","pauseEvents","resumeEvents","round","self","eventDetail","attrName","time","animationIsPlaying","onStartEvent","beginAnimation","pauseAnimation","resumeAnimation","fromColor","toColor","targets","targetsArray","updateConfigForDefault","updateConfigForRawColor","config","complete","oldData","duration","createAndStartAnimation","tick","dt","remove","cancelDelayedStart","pause","paused","pausedWasPlaying","play","updateConfig","delayTimeout","setTimeout","stopRelatedAnimations","waitComponentInitRawProperty","setColorConfig","lastValue","anim","animatables","target","isBoolean","isNaN","parseFloat","aframeProperty","updateConfigForVector","coordinates","max","propType","component","getPropertyType","cb","wait","evt","clearTimeout","mixer","AnimationMixer","volume","prevVolume","smoothing","threshold","ctx","AudioContext","getContext","analyser","createAnalyser","fftSize","levels","Uint8Array","frequencyBinCount","soundSource","getByteTimeDomainData","sum","amplitude","currVolume","sqrt","minScale","maxScale","_playerCamera","_playerCameraWorldPosition","Vector3","_worldPosition","visible","audioAnalyser","setFromMatrixPosition","matrixWorld","distance","distanceTo","min","setScalar","_utils_scene_graph__WEBPACK_IMPORTED_MODULE_0__","clip","mixerEl","updateClip","currentAction","clipName","action","clipAction","setLoop","LoopRepeat","Infinity","destroy","stop","_utils_qs_truthy__WEBPACK_IMPORTED_MODULE_2__","isBotMode","Sky","shader","SkyShader","UniformsUtils","side","BackSide","BoxBufferGeometry","luminance","turbidity","rayleigh","mieCoefficient","mieDirectionalG","sunPosition","inclination","azimuth","sky","skyScene","cubeCamera","CubeCamera","requestAnimationFrame","theta","PI","phi","cos","sin","normalize","vrEnabled","vr","pmremGenerator","PMREMGenerator","renderTarget","pmremCubeUVPacker","PMREMCubeUVPacker","cubeLods","CubeUVRenderTarget","removeObject3D","val","_assets_translations_data_json__WEBPACK_IMPORTED_MODULE_0__","navigatorLang","language","userLanguage","localeData","getSanitizedComponentMapping","inputComponent","inputProperty","publicComponents","publicComponent","publicProperty","publicProperties","mappedComponent","mappedProperty","getMappedValue","PHYSICS_CONSTANTS","TYPE","SHAPE","FIT","decayMigration","range","decay","mediaInflator","isControlled","networked","hasVolume","templateName","controls","isHubsDestinationUrl","href","template","owner","persistent","networkId","mediaOptions","projection","videoPaused","autoPlay","audioType","hidePlaybackControls","distanceModel","rolloffFactor","refDistance","maxDistance","coneInnerAngle","coneOuterAngle","coneOuterGain","resize","fileIsOwned","animate","isHandCollisionTarget","cursorController","mass","STATIC","collisionFilterGroup","collisionFilterMask","castShadow","shadow","euler","Euler","orientation","Quaternion","setFromEuler","BOX","fit","MANUAL","halfExtents","_componentName","nav","systems","zone","found","loadMesh","pageIndex","video","loop-animation","enterComponent","enterProperty","enterValue","leaveComponent","leaveProperty","leaveValue","enterComponentMapping","leaveComponentMapping","targetEntity","message","colliders","names","selectRandom","arr","floor","random","avatarIds","av","generateDefaultProfile","LOCAL_STORE_KEY","STORE_STATE_CACHE_KEY","OAUTH_FLOW_CREDENTIALS_KEY","validator","Validator","SCHEMA","definitions","additionalProperties","properties","displayName","pattern","personalAvatarId","activity","hasFoundFreeze","hasChangedName","hasAcceptedProfile","lastEnteredAt","hasPinned","hasRotated","hasRecentered","hasScaled","hasHoveredInWorldHud","settings","lastUsedMicDeviceId","confirmedDiscordRooms","items","uploadPromotionTokens","fileId","promotionToken","$ref","localStorage","getItem","setItem","oauthFlowCredentials","Cookies","getJSON","resetToRandomLegacyAvatar","jwtDecode","sub","resetConfirmedDiscordRooms","arrayMerge","destinationArray","sourceArray","resetTipActivityFlags","newState","mergeOpts","finalState","merge","valid","validate","fn","ObjectContentOrigins","ObjectTypes","objectTypeForOriginAndContentType","FILE","CLIPBOARD","SPAWNER","URL_IMAGE","URL_VIDEO","URL_MODEL","URL_PDF","URL_AUDIO","FILE_IMAGE","FILE_VIDEO","FILE_MODEL","FILE_PDF","FILE_AUDIO","CLIPBOARD_IMAGE","CLIPBOARD_VIDEO","CLIPBOARD_MODEL","CLIPBOARD_PDF","CLIPBOARD_AUDIO","SPAWNER_IMAGE","SPAWNER_VIDEO","SPAWNER_MODEL","SPAWNER_PDF","SPAWNER_AUDIO","CAMERA","UNKNOWN","objectTypeForOrigin","contentOrigin","urlType","fileType","clipboardType","spawnerType","objectTypeMimePrefixLookupMap","image/","model/","application/x-zip-compressed","video/","application/vnd.apple.mpegurl","application/x-mpegurl","audio/","application/pdf","srcSuffixLookupMap",".m3u8","prefix","suffix","endsWith","raven_js__WEBPACK_IMPORTED_MODULE_0__","raven_js__WEBPACK_IMPORTED_MODULE_0___default","ga","trackedPage","trackedTitle","sentryDsn","SENTRY_DSN","gaTrackingId","GA_TRACKING_ID","Raven","install","ReactAudioContext","WithHoverSound","react__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_0___default","prop_types__WEBPACK_IMPORTED_MODULE_1__","prop_types__WEBPACK_IMPORTED_MODULE_1___default","React","createContext","sound","Consumer","cloneElement","onMouseEnter","playSound","propTypes","scaledThumbnailUrlFor","proxiedUrlFor","resolveUrl","guessContentType","upload","addMedia","injectCustomShaderChunks","getPromotionTokenForFile","traverseMeshesAndAddShapes","spawnMediaAround","isHubsSceneUrl","isHubsRoomUrl","_object_types__WEBPACK_IMPORTED_MODULE_0__","_phoenix_utils__WEBPACK_IMPORTED_MODULE_1__","_media_highlight_frag_glsl__WEBPACK_IMPORTED_MODULE_2__","_media_highlight_frag_glsl__WEBPACK_IMPORTED_MODULE_2___default","_material_utils__WEBPACK_IMPORTED_MODULE_3__","nonCorsProxyDomains","CORS_PROXY_SERVER","mediaAPIEndpoint","commonKnownContentTypes","glb","png","jpg","jpeg","pdf","mp4","mp3","farsparkEncodeUrl","str","btoa","encodeURIComponent","_","p1","String","fromCharCode","b64EncodeUnicode","hasIndex","domain","hostname","resolveUrlCache","cacheKey","resolved","media","corsProxyPrefix","originalUrlParts","decodeURIComponent","extension","pop","file","formData","FormData","interactableId","needsToBeUploaded","File","fireLoadingTimeout","eventName","once","reader","FileReader","onload","view","DataView","getUint16","byteLength","marker","getUint32","little","tags","readAsArrayBuffer","getOrientation","response","srcUrl","raw","access_token","file_id","promotion_token","catch","MediaStream","NAF","clientId","objectType","vertexRegex","fragRegex","validMaterials","shaderUniforms","contains","newMaterial","onBeforeCompile","hubs_IsFrozen","hubs_EnableSweepingEffect","hubs_SweepParams","hubs_InteractorOnePos","hubs_InteractorTwoPos","hubs_HighlightInteractorOne","hubs_HighlightInteractorTwo","hubs_Time","vlines","vindex","line","flines","findex","mediaHighlightFrag","shapes","meshRoot","object3DMap","mesh","vertexCount","__proto__","group","floorPlan","MESH","margin","shapePrefix","groupEnd","mediaPos","snapCount","mirrorOrientation","pos","rotateY","idx","localToWorld","hubsSceneRegex","hubsRoomRegex"],"mappings":"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BC,EAElD,IAME,GALAF,EAAwB7E,EAA6BuE,EAAgBC,EAAerE,GACpF2E,EAAwB9E,EAA6B0E,EAAgBC,EAAexE,KAEpF4E,EAAezf,EAAiB+T,IAG9B,MAAM,IAAIlhB,iDAAiDkhB,MAE7D,MAAOnkB,GAEP,YADA8C,QAAQwS,yDAAyDtV,EAAE8vB,WAKrEniB,EAAGvI,aAAa,iBAAkB,CAChC2qB,UAAW,iBACXlR,OACAsF,OAAQ0L,EACRR,eAAgBM,EAAsBtE,gBACtCiE,cAAeK,EAAsBrE,eACrCiE,WAAYI,EAAsBpE,eAAegE,GACjDC,eAAgBI,EAAsBvE,gBACtCoE,cAAeG,EAAsBtE,eACrCoE,WAAYE,EAAsBrE,eAAemE,gxdCpTvD,MAAMM,EAAQ,CACZ,gBACA,cACA,oBACA,cACA,YACA,cACA,aACA,aACA,aACA,gBACA,gBACA,gBACA,gBACA,YACA,eACA,mBACA,mBACA,iBACA,gBACA,kBACA,eACA,eACA,mBACA,iBACA,WACA,cACA,gBACA,UACA,WACA,gBACA,cACA,YACA,WACA,YACA,YACA,mBACA,iBACA,aACA,aACA,YACA,cACA,eACA,cACA,cACA,UACA,WACA,eACA,eACA,YACA,mBACA,gBACA,oBACA,kBACA,YACA,cACA,kBACA,aACA,cACA,eACA,cACA,cACA,cACA,iBACA,kBACA,cACA,WACA,WACA,cACA,OACA,mBACA,cACA,mBACA,cACA,iBACA,aACA,cACA,cACA,gBACA,qBACA,iBACA,eACA,gBACA,eACA,SACA,YACA,iBAGF,SAASC,EAAaC,GACpB,OAAOA,EAAI7pB,KAAK8pB,MAAM9pB,KAAK+pB,SAAWF,EAAI75B,SAOrC,MAAMg6B,EAAYpxB,IAAQC,IAAIoxB,GAAMA,EAAGpwB,IAEvC,SAASqwB,IACd,MAAO,CACL7qB,SAAUuqB,EAAaI,ggBClG3B,MAAMG,EAAkB,gBAClBC,EAAwBh4B,SACxBi4B,EAA6B,qCAC7BC,EAAY,IAAIC,YAMTC,EAAS,CACpB3wB,GAAI,aAEJ4wB,YAAa,CACX9V,QAAS,CACP7a,KAAM,SACN4wB,sBAA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","file":"assets/js/avatar-selector-e54d7e5efaafb9805d00.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t4: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([1463,1,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","// Utilities for manipulating state history. This provides a number of functions which\n// need to be used to manipulate history state so we can deal with edge cases around\n// entry back button and refreshes once entered.\n//\n// These functions also transparently deal with the room slug, so incoming calls can ignore\n// dealing with it, and provides APIs for getting the non-slug part of the path.\n//\n// The slug cannot be part of the basename for history, because the slug changes intra-session\n// if the room is renamed.\n\n// This pushes/replaces a new k, v pair into the history, while maintaining all the other\n// keys, or clears state if k if null.\n//\n// Also maintains a length key that can be used to find the length of the history chain\n// (across refreshes) for the current room.\nfunction pushOrUpdateHistory(history, replace, k, v, detail, newPathname, newSearch) {\n  let state = {};\n  const newLength = ((history.location.state && history.location.state.__historyLength) || 0) + (replace ? 0 : 1);\n\n  if (k || newPathname || newSearch) {\n    state = history.location.state ? { ...history.location.state } : {};\n    delete state.__duplicate;\n\n    if (k) {\n      state[k] = v;\n      state.key = k;\n      state.value = v;\n      state.detail = detail;\n    }\n  }\n\n  const pathname =\n    newPathname !== undefined ? newPathname : history.location.pathname === \"/\" ? \"\" : history.location.pathname;\n\n  const search = newSearch !== undefined ? newSearch : history.location.search;\n\n  // If popToBeginningOfHubHistory was previously used, there is a duplicate entry\n  // at the top of the history stack (which was needed to wipe out forward history)\n  // so we use this opportunity to replace it.\n  const isDuplicate = history.location.state && history.location.state.__duplicate;\n  const method = replace || isDuplicate ? history.replace : history.push;\n  state.__historyLength = newLength;\n\n  method({ pathname, search, state });\n}\n\nexport function pushHistoryState(history, k, v, detail) {\n  pushOrUpdateHistory(history, false, k, v, detail);\n}\n\nexport function replaceHistoryState(history, k, v, detail) {\n  pushOrUpdateHistory(history, true, k, v, detail);\n}\n\nexport function pushHistoryPath(history, path, search) {\n  pushOrUpdateHistory(history, false, null, null, null, path, search);\n}\n\nexport function clearHistoryState(history) {\n  pushOrUpdateHistory(history, false);\n}\n\n// This will pop the browser history to the first entry that was for this hubs room,\n// and then push a duplicate entry onto the history stack in order to wipe out forward\n// history.\nexport function popToBeginningOfHubHistory(history, navigateToPriorPage) {\n  if (!history.location.state || history.location.state.__historyLength === undefined) return;\n\n  const len = history.location.state.__historyLength;\n  if (len === 0) return;\n\n  return new Promise(resolve => {\n    // After the go() completes, we push a duplicate history entry onto the stack\n    // in order to wipe out forward history. We also optionally go back -2 if we wanted\n    // to go back to the prior page.\n    const unsubscribe = history.listen(() => {\n      unsubscribe();\n      history.push({\n        pathname: history.location.pathname,\n        search: history.location.search,\n        state: { __historyLength: 0, __duplicate: true }\n      });\n      if (navigateToPriorPage) history.go(-2); // Go back to history entry before beginning.\n      resolve();\n    });\n\n    history.go(-len);\n  });\n}\n\n// This will pop the browser history to the entry before the first entry for this hubs room.\nexport function navigateToPriorPage(history) {\n  popToBeginningOfHubHistory(history, true);\n}\n\n// Returns the part of the pathname that does not include the slug\nexport function sluglessPath(location) {\n  const parts = location.pathname.split(\"/\");\n  return `/${parts.slice(2).join(\"/\")}`;\n}\n\n// Returns a new path that includes the current slug as a prefix to the\n// provided path.\nexport function withSlug(location, path) {\n  const parts = location.pathname.split(\"/\");\n  return `/${parts[1]}${path}`;\n}\n","import { EventTarget } from \"event-target-shim\";\nimport { getReticulumFetchUrl } from \"../utils/phoenix-utils\";\nimport { pushHistoryPath, sluglessPath, withSlug } from \"../utils/history\";\nimport { avatars } from \"../assets/avatars/avatars\";\nimport qsTruthy from \"../utils/qs_truthy\";\n\nexport const SOURCES = [\"videos\", \"sketchfab\", \"poly\", \"scenes\", \"gifs\", \"images\", \"twitch\"];\n\nconst URL_SOURCE_TO_TO_API_SOURCE = {\n  scenes: \"scene_listings\",\n  images: \"bing_images\",\n  videos: \"bing_videos\",\n  youtube: \"youtube_videos\",\n  gifs: \"tenor\",\n  sketchfab: \"sketchfab\",\n  poly: \"poly\",\n  twitch: \"twitch\"\n};\n\nexport const MEDIA_SOURCE_DEFAULT_FILTERS = {\n  gifs: \"trending\",\n  sketchfab: \"featured\",\n  scenes: \"featured\"\n};\n\nconst SEARCH_CONTEXT_PARAMS = [\"q\", \"filter\", \"cursor\"];\n\n// This class is responsible for fetching and storing media search results and provides a\n// convenience API for performing history updates relevant to search navigation.\nexport default class MediaSearchStore extends EventTarget {\n  constructor() {\n    super();\n\n    this.requestIndex = 0;\n  }\n\n  setHistory(history) {\n    this.history = history;\n\n    this._update(this.history.location);\n\n    this.history.listen(location => {\n      this._update(location);\n    });\n  }\n\n  _update = async location => {\n    this.result = null;\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n\n    const urlSource = this.getUrlMediaSource(location);\n    if (!urlSource) return;\n\n    if (!this.previousSource || this.previousSource !== urlSource) {\n      this.dispatchEvent(new CustomEvent(\"sourcechanged\"));\n      this.previousSource = urlSource;\n    }\n\n    const urlParams = new URLSearchParams(location.search);\n\n    this.requestIndex++;\n    const currentRequestIndex = this.requestIndex;\n    const searchParams = new URLSearchParams();\n\n    for (const param of SEARCH_CONTEXT_PARAMS) {\n      if (!urlParams.get(param)) continue;\n      searchParams.set(param, urlParams.get(param));\n    }\n\n    searchParams.get(\"locale\", navigator.languages[0]);\n\n    let source;\n    if (urlSource === \"avatars\" || urlSource === \"scenes\") {\n      // Avatars + scenes are special since we request them from a different source based on the facet.\n      const singular = urlSource === \"avatars\" ? \"avatar\" : \"scene\";\n      const filter = new URLSearchParams(location.search);\n      source = filter.get(\"filter\").startsWith(\"my-\") ? `${singular}s` : `${singular}_listings`;\n    } else {\n      source = URL_SOURCE_TO_TO_API_SOURCE[urlSource];\n    }\n    searchParams.set(\"source\", source);\n\n    if (source === \"avatars\" || source === \"scenes\") {\n      searchParams.set(\"user\", window.APP.store.credentialsAccountId);\n    }\n\n    const url = getReticulumFetchUrl(`/api/v1/media/search?${searchParams.toString()}`);\n    if (this.lastSavedUrl === url) return;\n\n    const result = await this._fetchMedia(url, source);\n\n    if (this.requestIndex != currentRequestIndex) return;\n\n    this.result = result;\n    this.nextCursor = this.result.meta && this.result.meta.next_cursor;\n    this.lastFetchedUrl = url;\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n  };\n\n  _fetchMedia = async (url, source) => {\n    if (source === \"avatar_listings\" && !qsTruthy(\"use_avatar_listings\")) {\n      // Use our legacy avatars until we are ready with real featured avatars.\n      return { entries: avatars.map(this._legacyAvatarToSearchEntry) };\n    }\n\n    const headers = { \"Content-Type\": \"application/json\" };\n    const credentialsToken = window.APP.store.state.credentials.token;\n    if (credentialsToken) headers.authorization = `bearer ${credentialsToken}`;\n\n    const res = await fetch(url, { method: \"GET\", headers });\n    const body = await res.text();\n\n    let result;\n    try {\n      result = JSON.parse(body);\n    } catch (e) {\n      result = body;\n    }\n\n    return result;\n  };\n\n  _legacyAvatarToSearchEntry = legacyAvatar => {\n    return {\n      id: legacyAvatar.id,\n      type: \"avatar_listing\",\n      url: legacyAvatar.url,\n      images: { preview: { url: legacyAvatar.thumbnail, width: 720, height: 1280 } },\n      gltfs: { avatar: legacyAvatar.model }\n    };\n  };\n\n  pageNavigate = delta => {\n    if (delta === -1) {\n      this.history.goBack();\n    } else {\n      const location = this.history.location;\n      const searchParams = new URLSearchParams(location.search);\n      searchParams.set(\"cursor\", this.nextCursor);\n      pushHistoryPath(this.history, location.pathname, searchParams.toString());\n    }\n  };\n\n  filterQueryNavigate = (filter, query) => {\n    const location = this.history.location;\n    const searchParams = new URLSearchParams(location.search);\n\n    if (query) {\n      searchParams.set(\"q\", query);\n    } else {\n      searchParams.delete(\"q\");\n    }\n\n    if (filter) {\n      searchParams.set(\"filter\", filter);\n    } else {\n      searchParams.delete(\"filter\");\n    }\n\n    if (filter) {\n      searchParams.set(\"cursor\", filter);\n    } else {\n      searchParams.delete(\"cursor\");\n    }\n\n    pushHistoryPath(this.history, location.pathname, searchParams.toString());\n  };\n\n  getSearchClearedSearchParams = (location, keepSource, keepNav) => {\n    const searchParams = new URLSearchParams(location.search);\n\n    // Strip browsing query params\n    searchParams.delete(\"q\");\n    searchParams.delete(\"filter\");\n    searchParams.delete(\"cursor\");\n\n    if (!keepNav) {\n      searchParams.delete(\"media_nav\");\n    }\n\n    if (!keepSource) {\n      searchParams.delete(\"media_source\");\n    }\n\n    return searchParams;\n  };\n\n  _stashLastSearchParams = location => {\n    const searchParams = new URLSearchParams(location.search);\n    this._stashedParams = {};\n    this._stashedSource = this.getUrlMediaSource(location);\n\n    for (const param of SEARCH_CONTEXT_PARAMS) {\n      const value = searchParams.get(param);\n\n      if (value) {\n        this._stashedParams[param] = value;\n      }\n    }\n  };\n\n  clearStashedQuery = () => {\n    if (!this._stashedParams) return;\n    delete this._stashedParams.q;\n  };\n\n  sourceNavigate = source => {\n    this._sourceNavigate(source, false, true);\n  };\n\n  sourceNavigateToDefaultSource = () => {\n    this._sourceNavigate(this._stashedSource ? this._stashedSource : SOURCES[0], false, true);\n  };\n\n  sourceNavigateWithNoNav = source => {\n    this._sourceNavigate(source, true, false);\n  };\n\n  _sourceNavigate = async (source, hideNav, useLastStashedParams) => {\n    const currentQuery = new URLSearchParams(this.history.location.search).get(\"q\");\n    const searchParams = this.getSearchClearedSearchParams(this.history.location);\n\n    if (currentQuery) {\n      searchParams.set(\"q\", currentQuery);\n    } else {\n      if (useLastStashedParams && this._stashedParams) {\n        for (const param of SEARCH_CONTEXT_PARAMS) {\n          const value = this._stashedParams[param];\n\n          // Only q param is compatible across sources, so keep it if is stashed.\n          const useValue = param === \"q\" || this._stashedSource === source;\n\n          if (value && useValue) {\n            searchParams.set(param, value);\n          }\n        }\n      } else {\n        if (source === \"avatars\") {\n          const hasAccountWithAvatars = await this._hasAccountWithAvatars();\n          searchParams.set(\"filter\", hasAccountWithAvatars ? \"my-avatars\" : \"featured\");\n        } else if (MEDIA_SOURCE_DEFAULT_FILTERS[source]) {\n          searchParams.set(\"filter\", MEDIA_SOURCE_DEFAULT_FILTERS[source]);\n        }\n      }\n    }\n\n    this._stashedParams = null;\n    this._stashedSource = null;\n\n    if (hideNav) {\n      searchParams.set(\"media_nav\", \"false\");\n    }\n\n    if (process.env.RETICULUM_SERVER && document.location.host !== process.env.RETICULUM_SERVER) {\n      searchParams.set(\"media_source\", source);\n      pushHistoryPath(this.history, this.history.location.pathname, searchParams.toString());\n    } else {\n      pushHistoryPath(this.history, withSlug(this.history.location, `/media/${source}`), searchParams.toString());\n    }\n  };\n\n  _hasAccountWithAvatars = async () => {\n    const { credentialsAccountId } = window.APP.store;\n    if (!credentialsAccountId) return false;\n\n    const searchParams = new URLSearchParams();\n    const source = \"avatars\";\n    searchParams.set(\"source\", source);\n    searchParams.set(\"user\", credentialsAccountId);\n    const url = getReticulumFetchUrl(`/api/v1/media/search?${searchParams.toString()}`);\n    const result = await this._fetchMedia(url, source);\n    return !!(result && result.entries) && result.entries.length > 0;\n  };\n\n  getUrlMediaSource = location => {\n    const { search } = location;\n    const urlParams = new URLSearchParams(search);\n    const pathname = sluglessPath(location);\n\n    if (!pathname.startsWith(\"/media\") && !urlParams.get(\"media_source\")) return null;\n    return urlParams.get(\"media_source\") || pathname.substring(7);\n  };\n\n  pushExitMediaBrowserHistory = (history, stashLastSearchParams = true) => {\n    if (!history) history = this.history;\n\n    if (stashLastSearchParams) this._stashLastSearchParams(history.location);\n\n    const { pathname } = history.location;\n    const hasMediaPath = sluglessPath(history.location).startsWith(\"/media\");\n    pushHistoryPath(\n      history,\n      hasMediaPath ? withSlug(history.location, \"/\") : pathname,\n      this.getSearchClearedSearchParams(history.location).toString()\n    );\n    this.dispatchEvent(new CustomEvent(\"media-exit\"));\n  };\n}\n","// Wrapper for a worker which accepts work items and responds with results.\n//\n// The worker must receive messages with data of the shape { id, payload }, and then respond\n// with messages containing matching IDs of the shape { id, result, err }.\n//\n// Returns a function that accepts a work item, sends it to the worker, and returns a promise that\n// will resolve with the result or reject with the error.\n//\nexport function promisifyWorker(worker) {\n  let nextItemId = 0;\n  const outstanding = {}; // item ID: { resolve, reject }\n\n  worker.onmessage = msg => {\n    const { id, result, err } = msg.data;\n    const handlers = outstanding[id];\n    if (handlers == null) {\n      console.error(`Unknown message with ID ${id} received from ${worker}.`);\n    } else {\n      delete outstanding[id];\n      if (err != null) {\n        handlers.reject(new Error(err));\n      } else {\n        handlers.resolve(result);\n      }\n    }\n  };\n\n  return function(data, transfer) {\n    const id = nextItemId++;\n    const promise = new Promise((resolve, reject) => {\n      outstanding[id] = { resolve, reject };\n    });\n    worker.postMessage({ id, payload: data }, transfer);\n    return promise;\n  };\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { injectIntl } from \"react-intl\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faAngleLeft } from \"@fortawesome/free-solid-svg-icons/faAngleLeft\";\nimport { faAngleRight } from \"@fortawesome/free-solid-svg-icons/faAngleRight\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nclass AvatarSelector extends Component {\n  static propTypes = {\n    avatars: PropTypes.array,\n    avatarId: PropTypes.string,\n    onChange: PropTypes.func\n  };\n\n  static getAvatarIndex = (props, offset = 0) => {\n    const currAvatarIndex = props.avatars.findIndex(avatar => avatar.id === props.avatarId);\n    const numAvatars = props.avatars.length;\n    return (((currAvatarIndex + offset) % numAvatars) + numAvatars) % numAvatars;\n  };\n  static nextAvatarIndex = props => AvatarSelector.getAvatarIndex(props, -1);\n  static previousAvatarIndex = props => AvatarSelector.getAvatarIndex(props, 1);\n\n  state = {\n    initialAvatarIndex: 0,\n    avatarIndices: []\n  };\n\n  getAvatarIndex = (offset = 0) => AvatarSelector.getAvatarIndex(this.props, offset);\n  nextAvatarIndex = () => this.getAvatarIndex(-1);\n  previousAvatarIndex = () => this.getAvatarIndex(1);\n\n  emitChangeToNext = () => {\n    const nextAvatarId = this.props.avatars[this.nextAvatarIndex()].id;\n    this.props.onChange(nextAvatarId);\n  };\n\n  emitChangeToPrevious = () => {\n    const previousAvatarId = this.props.avatars[this.previousAvatarIndex()].id;\n    this.props.onChange(previousAvatarId);\n  };\n\n  constructor(props) {\n    super(props);\n    this.state.initialAvatarIndex = AvatarSelector.getAvatarIndex(props);\n    this.state.avatarIndices = [\n      AvatarSelector.nextAvatarIndex(props),\n      this.state.initialAvatarIndex,\n      AvatarSelector.previousAvatarIndex(props)\n    ];\n  }\n\n  UNSAFE_componentWillReceiveProps(nextProps) {\n    // Push new avatar indices onto the array if necessary.\n    this.setState(state => {\n      const numAvatars = nextProps.avatars.length;\n      if (state.avatarIndices.length === numAvatars) return;\n\n      const lastIndex = numAvatars - 1;\n      const currAvatarIndex = this.getAvatarIndex();\n      const nextAvatarIndex = AvatarSelector.getAvatarIndex(nextProps);\n      const avatarIndices = Array.from(state.avatarIndices);\n      const increasing = currAvatarIndex - nextAvatarIndex < 0;\n\n      let direction = -1;\n      let push = false;\n\n      if (nextAvatarIndex === 0) {\n        if (currAvatarIndex === lastIndex) {\n          direction = 1;\n          push = avatarIndices.indexOf(lastIndex) !== 0;\n        } else {\n          direction = -1;\n          push = avatarIndices.indexOf(1) !== 0;\n        }\n      } else if (nextAvatarIndex === lastIndex) {\n        if (currAvatarIndex === 0) {\n          direction = -1;\n          push = avatarIndices.indexOf(0) === 0;\n        } else {\n          direction = 1;\n          push = avatarIndices.indexOf(lastIndex - 1) !== 0;\n        }\n      } else {\n        direction = increasing ? 1 : -1;\n        push = increasing;\n      }\n\n      const addIndex = AvatarSelector.getAvatarIndex(nextProps, direction);\n      if (avatarIndices.includes(addIndex)) return;\n\n      if (push) {\n        avatarIndices.push(addIndex);\n      } else {\n        avatarIndices.unshift(addIndex);\n      }\n      return { avatarIndices };\n    });\n  }\n\n  componentDidMount() {\n    // <a-scene> component not initialized until scene element mounted and loaded.\n    this.scene.addEventListener(\"loaded\", () => {\n      this.scene.setAttribute(\"light\", {\n        defaultLightsEnabled: false\n      });\n      this.scene.setAttribute(\"shadow\", { type: \"pcfsoft\", enabled: window.APP.quality !== \"low\" });\n    });\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.avatarId !== prevProps.avatarId) {\n      // HACK - animation ought to restart the animation when the `to` attribute changes, but it doesn't\n      // so we need to force it here.\n      const currRot = this.animation.getAttribute(\"rotation\");\n      const currY = currRot.y;\n      const toRot = this.animation\n        .getAttribute(\"animation\")\n        .to.split(\" \")\n        .map(Number);\n      const toY = toRot[1];\n      const step = 360.0 / this.props.avatars.length;\n      const brokenlyBigRotation = Math.abs(toY - currY) > 3 * step;\n      let fromY = currY;\n      if (brokenlyBigRotation) {\n        // Rotation in Y wrapped around 360. Adjust the \"from\" to prevent a dramatic rotation\n        fromY = currY < toY ? currY + 360 : currY - 360;\n      }\n      this.animation.setAttribute(\"animation\", \"from\", `${currRot.x} ${fromY} ${currRot.z}`);\n    }\n  }\n\n  render() {\n    const avatarAssets = this.props.avatars.map(avatar => (\n      <a-asset-item id={avatar.id} key={avatar.id} response-type=\"arraybuffer\" src={`${avatar.model}`} />\n    ));\n    const avatarData = this.state.avatarIndices.map(i => [this.props.avatars[i], i]);\n    const avatarEntities = avatarData.map(([avatar, i]) => (\n      <a-entity key={avatar.id} rotation={`0 ${(360 * -i) / this.props.avatars.length} 0`}>\n        <a-entity\n          position=\"0 0 5\"\n          gltf-model-plus={`src: #${avatar.id}`}\n          animation={`property: rotation; dur: 12000; from: 0.5 0.5 0.5; to: 0 ${\n            this.getAvatarIndex() === i ? 360 : 0\n          } 0; loop: true;`}\n        />\n      </a-entity>\n    ));\n\n    const rotationFromIndex = index => ((360 * index) / this.props.avatars.length + 180) % 360;\n    const initialRotation = rotationFromIndex(this.state.initialAvatarIndex);\n    const toRotation = rotationFromIndex(this.getAvatarIndex());\n\n    return (\n      <div className=\"avatar-selector\">\n        <a-scene\n          ref={sce => (this.scene = sce)}\n          background=\"color: #aaa\"\n          environment-map=\"\"\n          loading-screen=\"enabled: false\"\n          renderer=\"antialias: true; colorManagement: true; sortObjects: true; physicallyCorrectLights: true; alpha: false; gammaOutput: true;\"\n        >\n          <a-assets>{avatarAssets}</a-assets>\n\n          <a-entity skybox=\"turbidity: 20; rayleigh: 0.03; luminance: 0.175; mieCoefficient: 0.004; mieDirectionalG: 0.098; azimuth: 0.37; inclination: 0.14;\" />\n\n          <a-entity\n            ref={anm => (this.animation = anm)}\n            rotation={`0 ${initialRotation} 0`}\n            animation={`property: rotation; dur: 2000; easing: easeOutQuad; to: 0 ${toRotation} 0;`}\n          >\n            {avatarEntities}\n          </a-entity>\n\n          <a-entity position=\"0 1.5 -5.6\" rotation=\"-10 180 0\">\n            <a-entity camera=\"far: 1.5;\" />\n          </a-entity>\n\n          <a-entity\n            hide-when-quality=\"low\"\n            light=\"type: directional; color: #fdf5c2; intensity: 12\"\n            position=\"0 10 -15\"\n          />\n\n          <a-entity\n            hide-when-quality=\"low\"\n            light=\"type: hemisphere; color: #b1e3ff; groundColor: #b1e3ff; intensity: 1.5;\"\n          />\n        </a-scene>\n        <WithHoverSound>\n          <button className=\"avatar-selector__previous-button\" onClick={this.emitChangeToPrevious}>\n            <FontAwesomeIcon icon={faAngleLeft} />\n          </button>\n        </WithHoverSound>\n        <WithHoverSound>\n          <button className=\"avatar-selector__next-button\" onClick={this.emitChangeToNext}>\n            <FontAwesomeIcon icon={faAngleRight} />\n          </button>\n        </WithHoverSound>\n      </div>\n    );\n  }\n}\n\nexport default injectIntl(AvatarSelector);\n","import \"aframe\";\nimport ReactDOM from \"react-dom\";\nimport React from \"react\";\nimport { IntlProvider, addLocaleData } from \"react-intl\";\nimport en from \"react-intl/locale-data/en\";\n\nimport { lang, messages } from \"./utils/i18n\";\n\nimport { patchWebGLRenderingContext } from \"./utils/webgl\";\npatchWebGLRenderingContext();\n\nimport \"./assets/stylesheets/avatar-selector.scss\";\nimport \"three/examples/js/loaders/GLTFLoader\";\n\nimport \"./components/skybox\";\nimport \"./components/animation\";\nimport \"./components/animation-mixer\";\nimport \"./components/audio-feedback\";\nimport \"./components/loop-animation\";\nimport \"./components/environment-map\";\nimport \"./gltf-component-mappings\";\nimport { avatars } from \"./assets/avatars/avatars\";\n\nimport registerTelemetry from \"./telemetry\";\nimport { App } from \"./App\";\nimport AvatarSelector from \"./react-components/avatar-selector\";\n\naddLocaleData([...en]);\n\nregisterTelemetry(\"/avatars\", \"Hubs Avatar Picker\");\n\nfunction getHashArg(arg) {\n  return new URLSearchParams(location.hash.replace(/^#/, \"?\")).get(arg);\n}\n\nwindow.APP = new App();\nwindow.APP.quality =\n  getHashArg(\"quality\") || (AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR()) ? \"low\" : \"high\";\n\nfunction postAvatarIdToParent(newAvatarId) {\n  window.parent.postMessage({ avatarId: newAvatarId }, location.origin);\n}\n\nfunction mountUI(avatarId) {\n  ReactDOM.render(\n    <IntlProvider locale={lang} messages={messages}>\n      <AvatarSelector {...{ avatars, avatarId, onChange: postAvatarIdToParent }} />\n    </IntlProvider>,\n    document.getElementById(\"selector-root\")\n  );\n}\n\nwindow.addEventListener(\"message\", e => {\n  if (e.source !== window.parent) {\n    return;\n  }\n\n  const avatarId = e.data.avatarId;\n\n  if (document.readyState === \"complete\") {\n    mountUI(avatarId);\n  } else {\n    document.addEventListener(\"DOMContentLoaded\", () => {\n      mountUI(avatarId);\n    });\n  }\n});\n","module.exports = {\n  COLLISION_LAYERS: {\n    ALL: -1,\n    NONE: 0,\n    INTERACTABLES: 1,\n    ENVIRONMENT: 2,\n    AVATAR: 4,\n    HANDS: 8,\n    DEFAULT_INTERACTABLE: 1 | 2 | 4 | 8,\n    UNOWNED_INTERACTABLE: 1 | 8,\n    DEFAULT_SPAWNER: 1 | 8\n  }\n};\n","const VERTEX_SHADER = `\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n  #include <uv_vertex>\n  #include <uv2_vertex>\n  #include <color_vertex>\n  #include <skinbase_vertex>\n\n  #include <begin_vertex>\n  #include <morphtarget_vertex>\n  #include <skinning_vertex>\n  #include <project_vertex>\n  #include <logdepthbuf_vertex>\n\n  #include <worldpos_vertex>\n  #include <clipping_planes_vertex>\n  #include <fog_vertex>\n}\n`;\n\nconst FRAGMENT_SHADER = `\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <aomap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n  #include <clipping_planes_fragment>\n\n  vec4 diffuseColor = vec4(diffuse, opacity);\n  ReflectedLight reflectedLight = ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0), vec3(0.0));\n  vec3 totalEmissiveRadiance = emissive;\n\n  #include <logdepthbuf_fragment>\n  #include <map_fragment>\n  #include <color_fragment>\n  #include <alphatest_fragment>\n  #include <emissivemap_fragment>\n\n  reflectedLight.indirectDiffuse += vec3(1.0);\n\n  #include <aomap_fragment>\n\n  reflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\n  vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n  gl_FragColor = vec4(outgoingLight, diffuseColor.a);\n\n  #include <premultiplied_alpha_fragment>\n  #include <tonemapping_fragment>\n  #include <encodings_fragment>\n  #include <fog_fragment>\n}\n`;\n\nexport default class MobileStandardMaterial extends THREE.ShaderMaterial {\n  type = \"MobileStandardMaterial\";\n  isMobileStandardMaterial = true;\n  static fromStandardMaterial(material) {\n    const parameters = {\n      vertexShader: VERTEX_SHADER,\n      fragmentShader: FRAGMENT_SHADER,\n      uniforms: {\n        uvTransform: { value: new THREE.Matrix3() },\n        diffuse: { value: material.color },\n        opacity: { value: material.opacity },\n        map: { value: material.map },\n        aoMapIntensity: { value: material.aoMapIntensity },\n        aoMap: { value: material.aoMap },\n        emissive: { value: material.emissive },\n        emissiveMap: { value: material.emissiveMap }\n      },\n      fog: true,\n      lights: false,\n      opacity: material.opacity,\n      transparent: material.transparent,\n      skinning: material.skinning,\n      morphTargets: material.morphTargets,\n      vertexColors: material.vertexColors\n    };\n\n    const mobileMaterial = new MobileStandardMaterial(parameters);\n\n    mobileMaterial.color = material.color;\n    mobileMaterial.map = material.map;\n    mobileMaterial.aoMap = material.aoMap;\n    mobileMaterial.aoMapIntensity = material.aoMapIntensity;\n    mobileMaterial.emissive = material.emissive;\n    mobileMaterial.emissiveMap = material.emissiveMap;\n\n    return mobileMaterial;\n  }\n  clone() {\n    return MobileStandardMaterial.fromStandardMaterial(this);\n  }\n}\n","import nextTick from \"../utils/next-tick\";\nimport { mapMaterials } from \"../utils/material-utils\";\nimport SketchfabZipWorker from \"../workers/sketchfab-zip.worker.js\";\nimport MobileStandardMaterial from \"../materials/MobileStandardMaterial\";\nimport { getCustomGLTFParserURLResolver } from \"../utils/media-utils\";\nimport { promisifyWorker } from \"../utils/promisify-worker.js\";\nimport { MeshBVH, acceleratedRaycast } from \"three-mesh-bvh\";\nTHREE.Mesh.prototype.raycast = acceleratedRaycast;\n\nconst GLTFCache = {};\nconst extractZipFile = promisifyWorker(new SketchfabZipWorker());\n\nfunction defaultInflator(el, componentName, componentData) {\n  if (!AFRAME.components[componentName]) {\n    throw new Error(`Inflator failed. \"${componentName}\" component does not exist.`);\n  }\n  if (AFRAME.components[componentName].multiple && Array.isArray(componentData)) {\n    for (let i = 0; i < componentData.length; i++) {\n      el.setAttribute(componentName + \"__\" + i, componentData[i]);\n    }\n  } else {\n    el.setAttribute(componentName, componentData);\n  }\n}\n\nAFRAME.GLTFModelPlus = {\n  // eslint-disable-next-line no-unused-vars\n  components: {},\n  registerComponent(componentKey, componentName, inflator) {\n    inflator = inflator || defaultInflator;\n    AFRAME.GLTFModelPlus.components[componentKey] = { inflator, componentName };\n  }\n};\n\nfunction parallelTraverse(a, b, callback) {\n  callback(a, b);\n\n  for (let i = 0; i < a.children.length; i++) {\n    parallelTraverse(a.children[i], b.children[i], callback);\n  }\n}\n\nfunction generateMeshBVH(object3D) {\n  object3D.traverse(obj => {\n    // note that we might already have a bounds tree if this was a clone of an object with one\n    const hasBufferGeometry = obj.isMesh && obj.geometry.isBufferGeometry;\n    const hasBoundsTree = hasBufferGeometry && obj.geometry.boundsTree;\n    if (hasBufferGeometry && !hasBoundsTree && obj.geometry.attributes.position) {\n      const geo = obj.geometry;\n      const triCount = geo.index ? geo.index.count / 3 : geo.attributes.position.count / 3;\n      // only bother using memory and time making a BVH if there are a reasonable number of tris,\n      // and if there are too many it's too painful and large to tolerate doing it (at least until\n      // we put this in a web worker)\n      if (triCount > 1000 && triCount < 1000000) {\n        // note that bounds tree construction creates an index as a side effect if one doesn't already exist\n        geo.boundsTree = new MeshBVH(obj.geometry, { strategy: 0, maxDepth: 30 });\n      }\n    }\n  });\n}\n\n// Modified version of Don McCurdy's AnimationUtils.clone\n// https://github.com/mrdoob/three.js/pull/14494\nfunction cloneSkinnedMesh(source) {\n  const cloneLookup = new Map();\n\n  const clone = source.clone();\n\n  parallelTraverse(source, clone, function(sourceNode, clonedNode) {\n    cloneLookup.set(sourceNode, clonedNode);\n    if (sourceNode.isMesh && sourceNode.geometry.boundsTree) {\n      clonedNode.geometry.boundsTree = sourceNode.geometry.boundsTree;\n    }\n  });\n\n  source.traverse(function(sourceMesh) {\n    if (!sourceMesh.isSkinnedMesh) return;\n\n    const sourceBones = sourceMesh.skeleton.bones;\n    const clonedMesh = cloneLookup.get(sourceMesh);\n\n    clonedMesh.skeleton = sourceMesh.skeleton.clone();\n\n    clonedMesh.skeleton.bones = sourceBones.map(function(sourceBone) {\n      if (!cloneLookup.has(sourceBone)) {\n        throw new Error(\"Required bones are not descendants of the given object.\");\n      }\n\n      return cloneLookup.get(sourceBone);\n    });\n\n    clonedMesh.bind(clonedMesh.skeleton, sourceMesh.bindMatrix);\n  });\n\n  return clone;\n}\n\nfunction cloneGltf(gltf) {\n  return {\n    animations: gltf.animations,\n    scene: cloneSkinnedMesh(gltf.scene)\n  };\n}\n\nfunction getHubsComponents(node) {\n  const hubsComponents =\n    node.userData.gltfExtensions &&\n    (node.userData.gltfExtensions.MOZ_hubs_components || node.userData.gltfExtensions.HUBS_components);\n\n  // We can remove support for legacy components when our environment, avatar and interactable models are\n  // updated to match Spoke output.\n  const legacyComponents = node.userData.components;\n\n  return hubsComponents || legacyComponents;\n}\n\n/// Walks the tree of three.js objects starting at the given node, using the GLTF data\n/// and template data to construct A-Frame entities and components when necessary.\n/// (It's unnecessary to construct entities for subtrees that have no component data\n/// or templates associated with any of their nodes.)\n///\n/// Returns the A-Frame entity associated with the given node, if one was constructed.\nconst inflateEntities = function(indexToEntityMap, node, templates, isRoot, modelToWorldScale = 1) {\n  // TODO: Remove this once we update the legacy avatars to the new node names\n  if (node.name === \"Chest\") {\n    node.name = \"Spine\";\n  } else if (node.name === \"Root Scene\") {\n    node.name = \"AvatarRoot\";\n  } else if (node.name === \"Bot_Skinned\") {\n    node.name = \"AvatarMesh\";\n  }\n\n  // inflate subtrees first so that we can determine whether or not this node needs to be inflated\n  const childEntities = [];\n  const children = node.children.slice(0); // setObject3D mutates the node's parent, so we have to copy\n  for (const child of children) {\n    const el = inflateEntities(indexToEntityMap, child, templates);\n    if (el) {\n      childEntities.push(el);\n    }\n  }\n\n  const entityComponents = getHubsComponents(node);\n\n  const nodeHasBehavior = !!entityComponents || node.name in templates;\n  if (!nodeHasBehavior && !childEntities.length && !isRoot) {\n    return null; // we don't need an entity for this node\n  }\n\n  const el = document.createElement(\"a-entity\");\n  el.append.apply(el, childEntities);\n\n  // Remove invalid CSS class name characters.\n  const className = (node.name || node.uuid).replace(/[^\\w-]/g, \"\");\n  el.classList.add(className);\n\n  // AFRAME rotation component expects rotations in YXZ, convert it\n  if (node.rotation.order !== \"YXZ\") {\n    node.rotation.setFromQuaternion(node.quaternion, \"YXZ\");\n  }\n\n  // Copy over the object's transform to the THREE.Group and reset the actual transform of the Object3D\n  // all updates to the object should be done through the THREE.Group wrapper\n  el.object3D.position.copy(node.position);\n  el.object3D.rotation.copy(node.rotation);\n  el.object3D.scale.copy(node.scale).multiplyScalar(modelToWorldScale);\n  el.object3D.matrixNeedsUpdate = true;\n\n  node.matrixAutoUpdate = false;\n  node.matrix.identity();\n  node.matrix.decompose(node.position, node.rotation, node.scale);\n\n  el.setObject3D(node.type.toLowerCase(), node);\n  if (entityComponents && \"nav-mesh\" in entityComponents) {\n    el.setObject3D(\"mesh\", node);\n  }\n\n  // Set the name of the `THREE.Group` to match the name of the node,\n  // so that `THREE.PropertyBinding` will find (and later animate)\n  // the group. See `PropertyBinding.findNode`:\n  // https://github.com/mrdoob/three.js/blob/dev/src/animation/PropertyBinding.js#L211\n  el.object3D.name = node.name;\n  if (node.animations) {\n    // Pass animations up to the group object so that when we can pass the group as\n    // the optional root in `THREE.AnimationMixer.clipAction` and use the hierarchy\n    // preserved under the group (but not the node). Otherwise `clipArray` will be\n    // `null` in `THREE.AnimationClip.findByName`.\n    node.parent.animations = node.animations;\n  }\n\n  const gltfIndex = node.userData.gltfIndex;\n  if (gltfIndex !== undefined) {\n    indexToEntityMap[gltfIndex] = el;\n  }\n\n  return el;\n};\n\nfunction inflateComponents(inflatedEntity, indexToEntityMap) {\n  inflatedEntity.object3D.traverse(object3D => {\n    const entityComponents = getHubsComponents(object3D);\n    const el = object3D.el;\n\n    if (entityComponents && el) {\n      for (const prop in entityComponents) {\n        if (entityComponents.hasOwnProperty(prop) && AFRAME.GLTFModelPlus.components.hasOwnProperty(prop)) {\n          const { componentName, inflator } = AFRAME.GLTFModelPlus.components[prop];\n          inflator(el, componentName, entityComponents[prop], entityComponents, indexToEntityMap);\n        }\n      }\n    }\n  });\n}\n\nfunction attachTemplate(root, name, templateRoot) {\n  const targetEls = root.querySelectorAll(\".\" + name);\n  for (const el of targetEls) {\n    const root = templateRoot.cloneNode(true);\n    // Merge root element attributes with the target element\n    for (const { name, value } of root.attributes) {\n      el.setAttribute(name, value);\n    }\n\n    // Append all child elements\n    while (root.children.length > 0) {\n      el.appendChild(root.children[0]);\n    }\n  }\n}\n\nexport async function loadGLTF(src, contentType, preferredTechnique, onProgress) {\n  let gltfUrl = src;\n  let fileMap;\n\n  if (contentType.includes(\"model/gltf+zip\") || contentType.includes(\"application/x-zip-compressed\")) {\n    fileMap = await extractZipFile(gltfUrl);\n    gltfUrl = fileMap[\"scene.gtlf\"];\n  }\n\n  const loadingManager = new THREE.LoadingManager();\n  loadingManager.setURLModifier(getCustomGLTFParserURLResolver(gltfUrl));\n  const gltfLoader = new THREE.GLTFLoader(loadingManager);\n\n  const parser = await new Promise((resolve, reject) => gltfLoader.createParser(gltfUrl, resolve, onProgress, reject));\n\n  const materials = parser.json.materials;\n  if (materials) {\n    for (let i = 0; i < materials.length; i++) {\n      const material = materials[i];\n\n      if (\n        material.extensions &&\n        material.extensions.MOZ_alt_materials &&\n        material.extensions.MOZ_alt_materials[preferredTechnique] !== undefined\n      ) {\n        const altMaterialIndex = material.extensions.MOZ_alt_materials[preferredTechnique];\n        materials[i] = materials[altMaterialIndex];\n      }\n    }\n  }\n\n  const nodes = parser.json.nodes;\n\n  if (nodes) {\n    for (let i = 0; i < nodes.length; i++) {\n      const node = nodes[i];\n\n      if (!node.extras) {\n        node.extras = {};\n      }\n\n      node.extras.gltfIndex = i;\n    }\n  }\n\n  const gltf = await new Promise(parser.parse.bind(parser));\n\n  gltf.scene.traverse(object => {\n    // GLTFLoader sets matrixAutoUpdate on animated objects, we want to keep the defaults\n    object.matrixAutoUpdate = THREE.Object3D.DefaultMatrixAutoUpdate;\n\n    object.material = mapMaterials(object, material => {\n      if (material.isMeshStandardMaterial && preferredTechnique === \"KHR_materials_unlit\") {\n        return MobileStandardMaterial.fromStandardMaterial(material);\n      }\n\n      return material;\n    });\n  });\n\n  if (fileMap) {\n    // The GLTF is now cached as a THREE object, we can get rid of the original blobs\n    Object.keys(fileMap).forEach(URL.revokeObjectURL);\n  }\n\n  return gltf;\n}\n\n/**\n * Loads a GLTF model, optionally recursively \"inflates\" the child nodes of a model into a-entities and sets\n * whitelisted components on them if defined in the node's extras.\n * @namespace gltf\n * @component gltf-model-plus\n */\nAFRAME.registerComponent(\"gltf-model-plus\", {\n  schema: {\n    src: { type: \"string\" },\n    contentType: { type: \"string\" },\n    useCache: { default: true },\n    inflate: { default: false },\n    modelToWorldScale: { type: \"number\", default: 1 }\n  },\n\n  init() {\n    this.preferredTechnique =\n      window.APP && window.APP.quality === \"low\" ? \"KHR_materials_unlit\" : \"pbrMetallicRoughness\";\n    this.loadTemplates();\n  },\n\n  update() {\n    this.applySrc(this.data.src, this.data.contentType);\n  },\n\n  loadTemplates() {\n    this.templates = {};\n    this.el.querySelectorAll(\":scope > template\").forEach(templateEl => {\n      const root = document.importNode(templateEl.firstElementChild || templateEl.content.firstElementChild, true);\n      this.templates[templateEl.getAttribute(\"data-name\")] = root;\n    });\n  },\n\n  async loadModel(src, contentType, technique, useCache) {\n    if (useCache) {\n      if (!GLTFCache[src]) {\n        GLTFCache[src] = await loadGLTF(src, contentType, technique);\n      }\n\n      return cloneGltf(GLTFCache[src]);\n    } else {\n      return await loadGLTF(src, contentType, technique);\n    }\n  },\n\n  async applySrc(src, contentType) {\n    try {\n      // If the src attribute is a selector, get the url from the asset item.\n      if (src && src.charAt(0) === \"#\") {\n        const assetEl = document.getElementById(src.substring(1));\n        src = assetEl.getAttribute(\"src\");\n      }\n\n      if (src === this.lastSrc) return;\n      this.lastSrc = src;\n\n      if (!src) {\n        if (this.inflatedEl) {\n          console.warn(\"gltf-model-plus set to an empty source, unloading inflated model.\");\n          this.disposeLastInflatedEl();\n        }\n        return;\n      }\n\n      this.el.emit(\"model-loading\");\n      const gltf = await this.loadModel(src, contentType, this.preferredTechnique, this.data.useCache);\n\n      // If we started loading something else already\n      // TODO: there should be a way to cancel loading instead\n      if (src != this.lastSrc) return;\n\n      // If we had inflated something already before, clean that up\n      this.disposeLastInflatedEl();\n\n      this.model = gltf.scene || gltf.scenes[0];\n      this.model.animations = gltf.animations;\n\n      if (gltf.animations.length > 0) {\n        this.el.setAttribute(\"animation-mixer\", {});\n        this.el.components[\"animation-mixer\"].initMixer(gltf.animations);\n      } else {\n        generateMeshBVH(this.model);\n      }\n\n      const indexToEntityMap = {};\n\n      let object3DToSet = this.model;\n      if (\n        this.data.inflate &&\n        (this.inflatedEl = inflateEntities(\n          indexToEntityMap,\n          this.model,\n          this.templates,\n          true,\n          this.data.modelToWorldScale\n        ))\n      ) {\n        this.el.appendChild(this.inflatedEl);\n\n        object3DToSet = this.inflatedEl.object3D;\n        // TODO: Still don't fully understand the lifecycle here and how it differs between browsers, we should dig in more\n        // Wait one tick for the appended custom elements to be connected before attaching templates\n        await nextTick();\n        if (src != this.lastSrc) return; // TODO: there must be a nicer pattern for this\n\n        inflateComponents(this.inflatedEl, indexToEntityMap);\n\n        for (const name in this.templates) {\n          attachTemplate(this.el, name, this.templates[name]);\n        }\n      }\n\n      // The call to setObject3D below recursively clobbers any `el` backreferences to entities\n      // in the entire inflated entity graph to point to `object3DToSet`.\n      //\n      // We don't want those overwritten, since lots of code assumes `object3d.el` points to the relevant\n      // A-Frame entity for that three.js object, so we back them up and re-wire them here. If we didn't do\n      // this, all the `el` properties on these object3ds would point to the `object3DToSet` which is either\n      // the model or the root GLTF inflated entity.\n      const rewires = [];\n\n      object3DToSet.traverse(o => {\n        const el = o.el;\n        if (el) rewires.push(() => (o.el = el));\n      });\n\n      const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\n\n      if (environmentMapComponent) {\n        environmentMapComponent.applyEnvironmentMap(object3DToSet);\n      }\n\n      this.el.setObject3D(\"mesh\", object3DToSet);\n\n      rewires.forEach(f => f());\n\n      this.el.emit(\"model-loaded\", { format: \"gltf\", model: this.model });\n    } catch (e) {\n      delete GLTFCache[src];\n      console.error(\"Failed to load glTF model\", e, this);\n      this.el.emit(\"model-error\", { format: \"gltf\", src });\n    }\n  },\n\n  disposeLastInflatedEl() {\n    if (this.inflatedEl) {\n      this.inflatedEl.parentNode.removeChild(this.inflatedEl);\n\n      this.inflatedEl.object3D.traverse(x => {\n        if (x.material && x.material.dispose) {\n          x.material.dispose();\n        }\n\n        if (x.geometry) {\n          if (x.geometry.dispose) {\n            x.geometry.dispose();\n          }\n\n          x.geometry.boundsTree = null;\n        }\n      });\n\n      delete this.inflatedEl;\n\n      this.el.removeAttribute(\"animation-mixer\");\n    }\n  }\n});\n","import { Socket } from \"phoenix\";\nimport { generateHubName } from \"../utils/name-generation\";\n\nimport Store from \"../storage/store\";\n\nconst resolverLink = document.createElement(\"a\");\nexport function getReticulumFetchUrl(path, absolute = false) {\n  if (process.env.RETICULUM_SERVER) {\n    return `https://${process.env.RETICULUM_SERVER}${path}`;\n  } else if (absolute) {\n    resolverLink.href = path;\n    return resolverLink.href;\n  } else {\n    return path;\n  }\n}\n\nlet reticulumMeta = null;\nlet invalidatedReticulumMetaThisSession = false;\n\nexport async function invalidateReticulumMeta() {\n  invalidatedReticulumMetaThisSession = true;\n  reticulumMeta = null;\n}\n\nexport async function getReticulumMeta() {\n  if (!reticulumMeta) {\n    // Initially look up version based upon page, avoiding round-trip, otherwise fetch.\n    if (!invalidatedReticulumMetaThisSession && document.querySelector(\"meta[name='ret:version']\")) {\n      reticulumMeta = {\n        version: document.querySelector(\"meta[name='ret:version']\").getAttribute(\"value\"),\n        pool: document.querySelector(\"meta[name='ret:pool']\").getAttribute(\"value\"),\n        phx_host: document.querySelector(\"meta[name='ret:phx_host']\").getAttribute(\"value\")\n      };\n    } else {\n      await fetch(getReticulumFetchUrl(\"/api/v1/meta\")).then(async res => {\n        reticulumMeta = await res.json();\n      });\n    }\n  }\n\n  const qs = new URLSearchParams(location.search);\n  const phxHostOverride = qs.get(\"phx_host\");\n\n  if (phxHostOverride) {\n    reticulumMeta.phx_host = phxHostOverride;\n  }\n\n  return reticulumMeta;\n}\n\nexport async function connectToReticulum(debug = false, params = null) {\n  const qs = new URLSearchParams(location.search);\n\n  const getNewSocketUrl = async () => {\n    const socketProtocol = qs.get(\"phx_protocol\") || (document.location.protocol === \"https:\" ? \"wss:\" : \"ws:\");\n    let socketHost = qs.get(\"phx_host\");\n    let socketPort = qs.get(\"phx_port\");\n\n    const reticulumMeta = await getReticulumMeta();\n    socketHost = socketHost || reticulumMeta.phx_host;\n    socketPort = socketPort || (process.env.RETICULUM_SERVER.includes(\"hubs.local\") ? \"4000\" : \"443\"); // TODO phx_port\n    return `${socketProtocol}//${socketHost}${socketPort ? `:${socketPort}` : \"\"}`;\n  };\n\n  const socketUrl = await getNewSocketUrl();\n  console.log(`Phoenix Socket URL: ${socketUrl}`);\n\n  const socketSettings = {};\n\n  if (debug) {\n    socketSettings.logger = (kind, msg, data) => {\n      console.log(`${kind}: ${msg}`, data);\n    };\n  }\n\n  if (params) {\n    socketSettings.params = params;\n  }\n\n  const socket = new Socket(`${socketUrl}/socket`, socketSettings);\n  socket.connect();\n  socket.onError(async () => {\n    // On error, underlying reticulum node may have died, so rebalance by\n    // fetching a new healthy node to connect to.\n    invalidateReticulumMeta();\n\n    const endPointPath = new URL(socket.endPoint).pathname;\n    const newSocketUrl = await getNewSocketUrl();\n    const newEndPoint = `${newSocketUrl}${endPointPath}`;\n    console.log(`Socket error, changed endpoint to ${newEndPoint}`);\n    socket.endPoint = newEndPoint;\n  });\n\n  return socket;\n}\n\nexport function getLandingPageForPhoto(photoUrl) {\n  const parsedUrl = new URL(photoUrl);\n  return getReticulumFetchUrl(parsedUrl.pathname.replace(\".png\", \".html\") + parsedUrl.search, true);\n}\n\nexport function fetchReticulumAuthenticated(url, method = \"GET\", payload) {\n  const { token } = window.APP.store.state.credentials;\n  const retUrl = getReticulumFetchUrl(url);\n  const params = {\n    headers: {\n      \"content-type\": \"application/json\",\n      authorization: `bearer ${token}`\n    },\n    method\n  };\n  if (payload) {\n    params.body = JSON.stringify(payload);\n  }\n  return fetch(retUrl, params).then(async r => {\n    const result = await r.text();\n    try {\n      return JSON.parse(result);\n    } catch (e) {\n      // Some reticulum responses, particularly DELETE requests, don't return json.\n      return result;\n    }\n  });\n}\n\nexport async function createAndRedirectToNewHub(name, sceneId, sceneUrl, replace) {\n  const createUrl = getReticulumFetchUrl(\"/api/v1/hubs\");\n  // const payload = { hub: { name: name || generateHubName() } };\n  const payload = { hub: { name: 'Axon Park' } };\n\n  if (sceneId) {\n    payload.hub.scene_id = sceneId;\n  } else {\n    payload.hub.default_environment_gltf_bundle_url = sceneUrl;\n  }\n\n  const headers = { \"content-type\": \"application/json\" };\n  const store = new Store();\n  if (store.state && store.state.credentials.token) {\n    headers.authorization = `bearer ${store.state.credentials.token}`;\n  }\n\n  let res = await fetch(createUrl, {\n    body: JSON.stringify(payload),\n    headers,\n    method: \"POST\"\n  }).then(r => r.json());\n\n  if (res.error === \"invalid_token\") {\n    // Clear the invalid token from store.\n    store.update({ credentials: { token: null, email: null } });\n\n    // Create hub anonymously\n    delete headers.authorization;\n    res = await fetch(createUrl, {\n      body: JSON.stringify(payload),\n      headers,\n      method: \"POST\"\n    }).then(r => r.json());\n  }\n\n  const hub = res;\n  let url = hub.url;\n\n  const creatorAssignmentToken = hub.creator_assignment_token;\n  if (creatorAssignmentToken) {\n    store.update({ creatorAssignmentTokens: [{ hubId: hub.hub_id, creatorAssignmentToken: creatorAssignmentToken }] });\n  }\n\n  if (process.env.RETICULUM_SERVER && document.location.host !== process.env.RETICULUM_SERVER) {\n    url = `/hub.html?hub_id=${hub.hub_id}`;\n  }\n\n  if (replace) {\n    document.location.replace(url);\n  } else {\n    document.location = url;\n  }\n}\n\nexport function getPresenceProfileForSession(presences, sessionId) {\n  const entry = Object.entries(presences || {}).find(([k]) => k === sessionId) || [];\n  const presence = entry[1];\n  return (presence && presence.metas && presence.metas[0].profile) || {};\n}\n\n// Takes the given channel, and creates a new channel with the same bindings\n// with the given socket, joins it, and leaves the old channel after joining.\n//\n// NOTE: This function relies upon phoenix channel object internals, so this\n// function will need to be reviewed if/when we ever update phoenix.js\nexport function migrateChannelToSocket(oldChannel, socket, params) {\n  const channel = socket.channel(oldChannel.topic, params || oldChannel.params);\n\n  for (let i = 0, l = oldChannel.bindings.length; i < l; i++) {\n    const item = oldChannel.bindings[i];\n    channel.on(item.event, item.callback);\n  }\n\n  for (let i = 0, l = oldChannel.pushBuffer.length; i < l; i++) {\n    const item = oldChannel.pushBuffer[i];\n    channel.push(item.event, item.payload, item.timeout);\n  }\n\n  const oldJoinPush = oldChannel.joinPush;\n  const joinPush = channel.join();\n\n  for (let i = 0, l = oldJoinPush.recHooks.length; i < l; i++) {\n    const item = oldJoinPush.recHooks[i];\n    joinPush.receive(item.status, item.callback);\n  }\n\n  return new Promise(resolve => {\n    joinPush.receive(\"ok\", () => {\n      // Clear all event handlers first so no duplicate messages come in.\n      oldChannel.bindings = [];\n      resolve(channel);\n    });\n  });\n}\n","export function findAncestorWithComponent(entity, componentName) {\n  while (entity && !(entity.components && entity.components[componentName])) {\n    entity = entity.parentNode;\n  }\n  return entity;\n}\n","module.exports = \"if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\\n  float ratio = 0.0;\\n\\n  if (hubs_EnableSweepingEffect) {\\n    float size = hubs_SweepParams.t - hubs_SweepParams.s;\\n    float line = mod(hubs_Time / 500.0 * size, size * 3.0) + hubs_SweepParams.s - size / 3.0;\\n\\n    if (hubs_WorldPosition.y < line) {\\n      // Highlight with a sweeping gradient.\\n      ratio = max(0.0, 1.0 - (line - hubs_WorldPosition.y) / (size * 1.5));\\n    }\\n  }\\n\\n  // Highlight with a gradient falling off with distance.\\n  float pulse = 9.0 + 3.0 * (sin(hubs_Time / 1000.0) + 1.0);\\n\\n  if (hubs_HighlightInteractorOne) {\\n    float dist1 = distance(hubs_WorldPosition, hubs_InteractorOnePos);\\n    ratio += -min(1.0, pow(dist1 * pulse, 3.0)) + 1.0;\\n  } \\n\\n  if (hubs_HighlightInteractorTwo) {\\n    float dist2 = distance(hubs_WorldPosition, hubs_InteractorTwoPos);\\n    ratio += -min(1.0, pow(dist2 * pulse, 3.0)) + 1.0;\\n  }\\n\\n  ratio = min(1.0, ratio);\\n\\n  // Gamma corrected highlight color\\n  vec3 highlightColor = vec3(0.184, 0.499, 0.933);\\n\\n  gl_FragColor.rgb = (gl_FragColor.rgb * (1.0 - ratio)) + (highlightColor * ratio);\\n}\\n\"","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posx-d235fb97df77b607be04b84125f40e7c.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negx-35034574e114423babdea92b6a2eb97a.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posy-d0c4e1e7979d75923d4d8b49c191bc6e.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negy-35808d21d1d17ac1b84d3184e365093b.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posz-de29aa8396196e4b040cd5305e351dbe.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negz-d73d18a8b7994524dc39a6ea3fcf43fc.jpg\";","import Store from \"./storage/store\";\nimport MediaSearchStore from \"./storage/media-search-store\";\n\nexport class App {\n  constructor() {\n    this.scene = null;\n    this.quality = \"low\";\n    this.store = new Store();\n    this.mediaSearchStore = new MediaSearchStore();\n  }\n\n  setQuality(quality) {\n    if (this.quality === quality) {\n      return false;\n    }\n\n    this.quality = quality;\n\n    if (this.scene) {\n      this.scene.dispatchEvent(new CustomEvent(\"quality-changed\", { detail: quality }));\n    }\n\n    return true;\n  }\n}\n","import { forEachMaterial } from \"../utils/material-utils\";\nimport cubeMapPosX from \"../assets/images/cubemap/posx.jpg\";\nimport cubeMapNegX from \"../assets/images/cubemap/negx.jpg\";\nimport cubeMapPosY from \"../assets/images/cubemap/posy.jpg\";\nimport cubeMapNegY from \"../assets/images/cubemap/negy.jpg\";\nimport cubeMapPosZ from \"../assets/images/cubemap/posz.jpg\";\nimport cubeMapNegZ from \"../assets/images/cubemap/negz.jpg\";\n\nexport async function createDefaultEnvironmentMap() {\n  const urls = [cubeMapPosX, cubeMapNegX, cubeMapPosY, cubeMapNegY, cubeMapPosZ, cubeMapNegZ];\n  const texture = await new Promise((resolve, reject) =>\n    new THREE.CubeTextureLoader().load(urls, resolve, undefined, reject)\n  );\n  texture.format = THREE.RGBFormat;\n  return texture;\n}\n\nAFRAME.registerComponent(\"environment-map\", {\n  schema: {\n    loadDefault: { type: \"boolean\", default: true }\n  },\n\n  init() {\n    this.environmentMap = null;\n\n    this.updateEnvironmentMap = this.updateEnvironmentMap.bind(this);\n\n    if (this.data.loadDefault) {\n      // Used in the avatar selector scene because there is no skybox.\n      createDefaultEnvironmentMap().then(this.updateEnvironmentMap);\n    }\n  },\n\n  updateEnvironmentMap(environmentMap) {\n    this.environmentMap = environmentMap;\n    this.applyEnvironmentMap(this.el.object3D);\n  },\n\n  applyEnvironmentMap(object3D) {\n    object3D.traverse(object => {\n      forEachMaterial(object, material => {\n        if (material.isMeshStandardMaterial) {\n          material.envMap = this.environmentMap;\n          material.needsUpdate = true;\n        }\n      });\n    });\n  }\n});\n","const THREE = AFRAME.THREE;\n\nfunction checkFloatTextureSupport() {\n  const renderer = new THREE.WebGLRenderer();\n\n  const scene = new THREE.Scene();\n  const size = 2;\n  const data = new Float32Array(size * size * 4);\n  const dataTexture = new THREE.DataTexture(data, size, size, THREE.RGBAFormat, THREE.FloatType);\n  const box = new THREE.Mesh(new THREE.PlaneBufferGeometry(1, 1), new THREE.MeshBasicMaterial({ map: dataTexture }));\n  box.material.map.needsUpdate = true;\n  scene.add(box);\n\n  renderer.render(scene, new THREE.Camera());\n  const result = renderer.context.getError() === 0;\n  renderer.dispose();\n  return result;\n}\n\nexport function patchWebGLRenderingContext() {\n  if (/Android.+Firefox/.test(navigator.userAgent)) {\n    // It appears that Galaxy S6 devices falsely report that they support\n    // OES_texture_float in Firefox. This workaround disables float textures\n    // for those devices.\n    // See https://github.com/mozilla/hubs/issues/32 and\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1338656\n    const originalGetExtension = WebGLRenderingContext.prototype.getExtension;\n    const supportsFloatTextures = checkFloatTextureSupport();\n    WebGLRenderingContext.prototype.getExtension = function patchedGetExtension(name) {\n      if (name === \"OES_texture_float\" && !supportsFloatTextures) {\n        return null;\n      }\n      return originalGetExtension.call(this, name);\n    };\n  }\n}\n","/* eslint-disable */\n\n// Modified version of A-Frame's animation component to set matrixNeedsUpdate = true in the\n// scenario where the transform changes on an object during an animation.\n//\n// Changes are identified w comment // hubs\n//\n// Bugfix added 3/1/19 - If an animation component is removed before its delay setting, then\n// it erroneously restarts.\n\nvar anime = require(\"animejs\");\nvar components = AFRAME.components; // hubs\nvar registerComponent = AFRAME.registerComponent; // hubs\n//var THREE = require('../lib/three'); // hubs\nvar utils = AFRAME.utils; // hubs\n\ndelete AFRAME.components.animation; // hubs\n\nvar colorHelperFrom = new THREE.Color();\nvar colorHelperTo = new THREE.Color();\n\nvar getComponentProperty = utils.entity.getComponentProperty;\nvar setComponentProperty = utils.entity.setComponentProperty;\nvar splitCache = {};\n\nvar TYPE_COLOR = \"color\";\nvar PROP_POSITION = \"position\";\nvar PROP_ROTATION = \"rotation\";\nvar PROP_SCALE = \"scale\";\nvar STRING_COMPONENTS = \"components\";\nvar STRING_OBJECT3D = \"object3D\";\n\n/**\n * Animation component for A-Frame using anime.js.\n *\n * The component manually controls the tick by setting `autoplay: false` on anime.js and\n * manually * calling `animation.tick()` in the tick handler. To pause or resume, we toggle a\n * boolean * flag * `isAnimationPlaying`.\n *\n * anime.js animation config for tweenining Javascript objects and values works as:\n *\n *  config = {\n *    targets: {foo: 0.0, bar: '#000'},\n *    foo: 1.0,\n *    bar: '#FFF'\n *  }\n *\n * The above will tween each property in `targets`. The `to` values are set in the root of\n * the config.\n *\n * @member {object} animation - anime.js instance.\n * @member {boolean} animationIsPlaying - Control if animation is playing.\n */\nmodule.exports.Component = registerComponent(\"animation\", {\n  schema: {\n    autoplay: { default: true },\n    delay: { default: 0 },\n    dir: { default: \"\" },\n    dur: { default: 1000 },\n    easing: { default: \"easeInQuad\" },\n    elasticity: { default: 400 },\n    enabled: { default: true },\n    from: { default: \"\" },\n    loop: {\n      default: 0,\n      parse: function(value) {\n        // Boolean or integer.\n        if (value === true || value === \"true\") {\n          return true;\n        }\n        if (value === false || value === \"false\") {\n          return false;\n        }\n        return parseInt(value, 10);\n      }\n    },\n    property: { default: \"\" },\n    startEvents: { type: \"array\" },\n    pauseEvents: { type: \"array\" },\n    resumeEvents: { type: \"array\" },\n    round: { default: false },\n    to: { default: \"\" },\n    type: { default: \"\" },\n    isRawProperty: { default: false }\n  },\n\n  multiple: true,\n\n  init: function() {\n    var self = this;\n\n    this.eventDetail = { name: this.attrName };\n    this.time = 0;\n\n    this.animation = null;\n    this.animationIsPlaying = false;\n    this.onStartEvent = this.onStartEvent.bind(this);\n    this.beginAnimation = this.beginAnimation.bind(this);\n    this.pauseAnimation = this.pauseAnimation.bind(this);\n    this.resumeAnimation = this.resumeAnimation.bind(this);\n\n    this.fromColor = {};\n    this.toColor = {};\n    this.targets = {};\n    this.targetsArray = [];\n\n    this.updateConfigForDefault = this.updateConfigForDefault.bind(this);\n    this.updateConfigForRawColor = this.updateConfigForRawColor.bind(this);\n\n    this.config = {\n      complete: function() {\n        self.animationIsPlaying = false;\n        self.el.emit(\"animationcomplete\", self.eventDetail, false);\n        if (self.id) {\n          self.el.emit(\"animationcomplete__\" + self.id, self.eventDetail, false);\n        }\n      }\n    };\n  },\n\n  update: function(oldData) {\n    var config = this.config;\n    var data = this.data;\n\n    this.animationIsPlaying = false;\n\n    if (!this.data.enabled) {\n      return;\n    }\n\n    if (!data.property) {\n      return;\n    }\n\n    // Base config.\n    config.autoplay = false;\n    config.direction = data.dir;\n    config.duration = data.dur;\n    config.easing = data.easing;\n    config.elasticity = data.elasticity;\n    config.loop = data.loop;\n    config.round = data.round;\n\n    // Start new animation.\n    this.createAndStartAnimation();\n  },\n\n  tick: function(t, dt) {\n    if (!this.animationIsPlaying) {\n      return;\n    }\n    this.time += dt;\n    this.animation.tick(this.time);\n  },\n\n  remove: function() {\n    this.pauseAnimation();\n    this.removeEventListeners();\n    this.cancelDelayedStart(); // hubs\n  },\n\n  pause: function() {\n    this.paused = true;\n    this.pausedWasPlaying = this.animationIsPlaying;\n    this.pauseAnimation();\n    this.removeEventListeners();\n    this.cancelDelayedStart(); // hubs\n  },\n\n  /**\n   * `play` handler only for resuming scene.\n   */\n  play: function() {\n    if (!this.paused) {\n      return;\n    }\n    this.paused = false;\n    this.addEventListeners();\n    if (this.pausedWasPlaying) {\n      this.resumeAnimation();\n      this.pausedWasPlaying = false;\n    }\n  },\n\n  /**\n   * Start animation from scratch.\n   */\n  createAndStartAnimation: function() {\n    var data = this.data;\n\n    this.updateConfig();\n    this.animationIsPlaying = false;\n    this.animation = anime(this.config);\n\n    this.removeEventListeners();\n    this.cancelDelayedStart(); // hubs\n    this.addEventListeners();\n\n    // Wait for start events for animation.\n    if (!data.autoplay || (data.startEvents && data.startEvents.length)) {\n      return;\n    }\n\n    // Delay animation.\n    if (data.delay) {\n      // hubs\n      this.delayTimeout = setTimeout(this.beginAnimation, data.delay);\n      return;\n    }\n\n    // Play animation.\n    this.beginAnimation();\n  },\n\n  /**\n   * This is before animation start (including from startEvents).\n   * Set to initial state (config.from, time = 0, seekTime = 0).\n   */\n  beginAnimation: function() {\n    this.updateConfig();\n    this.time = 0;\n    this.animationIsPlaying = true;\n    this.stopRelatedAnimations();\n    this.el.emit(\"animationbegin\", this.eventDetail, false);\n  },\n\n  pauseAnimation: function() {\n    this.animationIsPlaying = false;\n  },\n\n  resumeAnimation: function() {\n    this.animationIsPlaying = true;\n  },\n\n  /**\n   * startEvents callback.\n   */\n  onStartEvent: function() {\n    if (!this.data.enabled) {\n      return;\n    }\n\n    this.updateConfig();\n    if (this.animation) {\n      this.animation.pause();\n    }\n    this.animation = anime(this.config);\n\n    // Include the delay before each start event.\n    if (this.data.delay) {\n      setTimeout(this.beginAnimation, this.data.delay);\n      return;\n    }\n    this.beginAnimation();\n  },\n\n  /**\n   * rawProperty: true and type: color;\n   */\n  updateConfigForRawColor: function() {\n    var config = this.config;\n    var data = this.data;\n    var el = this.el;\n    var from;\n    var key;\n    var to;\n\n    if (this.waitComponentInitRawProperty(this.updateConfigForRawColor)) {\n      return;\n    }\n\n    from = data.from === \"\" ? getRawProperty(el, data.property) : data.from;\n    to = data.to;\n\n    // Use r/g/b vector for color type.\n    this.setColorConfig(from, to);\n    from = this.fromColor;\n    to = this.toColor;\n\n    this.targetsArray.length = 0;\n    this.targetsArray.push(from);\n    config.targets = this.targetsArray;\n    for (key in to) {\n      config[key] = to[key];\n    }\n\n    config.update = (function() {\n      var lastValue = {};\n      return function(anim) {\n        var value;\n        value = anim.animatables[0].target;\n        // For animation timeline.\n        if (value.r === lastValue.r && value.g === lastValue.g && value.b === lastValue.b) {\n          return;\n        }\n\n        setRawProperty(el, data.property, value, data.type);\n      };\n    })();\n  },\n\n  /**\n   * Stuff property into generic `property` key.\n   */\n  updateConfigForDefault: function() {\n    var config = this.config;\n    var data = this.data;\n    var el = this.el;\n    var from;\n    var isBoolean;\n    var isNumber;\n    var to;\n\n    if (this.waitComponentInitRawProperty(this.updateConfigForDefault)) {\n      return;\n    }\n\n    if (data.from === \"\") {\n      // Infer from.\n      from = isRawProperty(data) ? getRawProperty(el, data.property) : getComponentProperty(el, data.property);\n    } else {\n      // Explicit from.\n      from = data.from;\n    }\n\n    to = data.to;\n\n    isNumber = !isNaN(from || to);\n    if (isNumber) {\n      from = parseFloat(from);\n      to = parseFloat(to);\n    } else {\n      from = from ? from.toString() : from;\n      to = to ? to.toString() : to;\n    }\n\n    // Convert booleans to integer to allow boolean flipping.\n    isBoolean = data.to === \"true\" || data.to === \"false\" || data.to === true || data.to === false;\n    if (isBoolean) {\n      from = data.from === \"true\" || data.from === true ? 1 : 0;\n      to = data.to === \"true\" || data.to === true ? 1 : 0;\n    }\n\n    this.targets.aframeProperty = from;\n    config.targets = this.targets;\n    config.aframeProperty = to;\n    config.update = (function() {\n      var lastValue;\n\n      return function(anim) {\n        var value;\n        value = anim.animatables[0].target.aframeProperty;\n\n        // Need to do a last value check for animation timeline since all the tweening\n        // begins simultaenously even if the value has not changed. Also better for perf\n        // anyways.\n        if (value === lastValue) {\n          return;\n        }\n        lastValue = value;\n\n        if (isBoolean) {\n          value = value >= 1;\n        }\n\n        if (isRawProperty(data)) {\n          setRawProperty(el, data.property, value, data.type);\n        } else {\n          setComponentProperty(el, data.property, value);\n        }\n      };\n    })();\n  },\n\n  /**\n   * Extend x/y/z/w onto the config.\n   * Update vector by modifying object3D.\n   */\n  updateConfigForVector: function() {\n    var config = this.config;\n    var data = this.data;\n    var el = this.el;\n    var key;\n    var from;\n    var to;\n\n    // Parse coordinates.\n    from =\n      data.from !== \"\"\n        ? utils.coordinates.parse(data.from) // If data.from defined, use that.\n        : getComponentProperty(el, data.property); // If data.from not defined, get on the fly.\n    to = utils.coordinates.parse(data.to);\n\n    if (data.property === PROP_ROTATION) {\n      toRadians(from);\n      toRadians(to);\n    }\n\n    // Set to and from.\n    this.targetsArray.length = 0;\n    this.targetsArray.push(from);\n    config.targets = this.targetsArray;\n    for (key in to) {\n      config[key] = to[key];\n    }\n\n    // If animating object3D transformation, run more optimized updater.\n    if (data.property === PROP_POSITION || data.property === PROP_ROTATION || data.property === PROP_SCALE) {\n      config.update = (function() {\n        var lastValue = {};\n        return function(anim) {\n          var value = anim.animatables[0].target;\n\n          if (data.property === PROP_SCALE) {\n            value.x = Math.max(0.0001, value.x);\n            value.y = Math.max(0.0001, value.y);\n            value.z = Math.max(0.0001, value.z);\n          }\n\n          // For animation timeline.\n          if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\n            return;\n          }\n\n          lastValue.x = value.x;\n          lastValue.y = value.y;\n          lastValue.z = value.z;\n\n          el.object3D[data.property].set(value.x, value.y, value.z);\n          el.object3D.matrixNeedsUpdate = true; // hubs\n        };\n      })();\n      return;\n    }\n\n    // Animating some vector.\n    config.update = (function() {\n      var lastValue = {};\n      return function(anim) {\n        var value = anim.animations[0].target;\n\n        // Animate rotation through radians.\n        // For animation timeline.\n        if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\n          return;\n        }\n        lastValue.x = value.x;\n        lastValue.y = value.y;\n        lastValue.z = value.z;\n        setComponentProperty(el, data.property, value);\n      };\n    })();\n  },\n\n  /**\n   * Update the config before each run.\n   */\n  updateConfig: function() {\n    var propType;\n\n    // Route config type.\n    propType = getPropertyType(this.el, this.data.property);\n    if (isRawProperty(this.data) && this.data.type === TYPE_COLOR) {\n      this.updateConfigForRawColor();\n    } else if (propType === \"vec2\" || propType === \"vec3\" || propType === \"vec4\") {\n      this.updateConfigForVector();\n    } else {\n      this.updateConfigForDefault();\n    }\n  },\n\n  /**\n   * Wait for component to initialize.\n   */\n  waitComponentInitRawProperty: function(cb) {\n    var componentName;\n    var data = this.data;\n    var el = this.el;\n    var self = this;\n\n    if (data.from !== \"\") {\n      return false;\n    }\n\n    if (!data.property.startsWith(STRING_COMPONENTS)) {\n      return false;\n    }\n\n    componentName = splitDot(data.property)[1];\n    if (el.components[componentName]) {\n      return false;\n    }\n\n    el.addEventListener(\"componentinitialized\", function wait(evt) {\n      if (evt.detail.name !== componentName) {\n        return;\n      }\n      cb();\n      // Since the config was created async, create the animation now since we missed it\n      // earlier.\n      self.animation = anime(self.config);\n      el.removeEventListener(\"componentinitialized\", wait);\n    });\n    return true;\n  },\n\n  /**\n   * Make sure two animations on the same property don't fight each other.\n   * e.g., animation__mouseenter=\"property: material.opacity\"\n   *       animation__mouseleave=\"property: material.opacity\"\n   */\n  stopRelatedAnimations: function() {\n    var component;\n    var componentName;\n    for (componentName in this.el.components) {\n      component = this.el.components[componentName];\n      if (componentName === this.attrName) {\n        continue;\n      }\n      if (component.name !== \"animation\") {\n        continue;\n      }\n      if (!component.animationIsPlaying) {\n        continue;\n      }\n      if (component.data.property !== this.data.property) {\n        continue;\n      }\n      component.animationIsPlaying = false;\n    }\n  },\n\n  addEventListeners: function() {\n    var data = this.data;\n    var el = this.el;\n    addEventListeners(el, data.startEvents, this.onStartEvent);\n    addEventListeners(el, data.pauseEvents, this.pauseAnimation);\n    addEventListeners(el, data.resumeEvents, this.resumeAnimation);\n  },\n\n  removeEventListeners: function() {\n    var data = this.data;\n    var el = this.el;\n    removeEventListeners(el, data.startEvents, this.onStartEvent);\n    removeEventListeners(el, data.pauseEvents, this.pauseAnimation);\n    removeEventListeners(el, data.resumeEvents, this.resumeAnimation);\n  },\n\n  // hubs\n  cancelDelayedStart: function() {\n    if (this.delayTimeout) {\n      clearTimeout(this.delayTimeout);\n      this.delayTimeout = null;\n    }\n  },\n\n  setColorConfig: function(from, to) {\n    colorHelperFrom.set(from);\n    colorHelperTo.set(to);\n    from = this.fromColor;\n    to = this.toColor;\n    from.r = colorHelperFrom.r;\n    from.g = colorHelperFrom.g;\n    from.b = colorHelperFrom.b;\n    to.r = colorHelperTo.r;\n    to.g = colorHelperTo.g;\n    to.b = colorHelperTo.b;\n  }\n});\n\n/**\n * Given property name, check schema to see what type we are animating.\n * We just care whether the property is a vector.\n */\nfunction getPropertyType(el, property) {\n  var component;\n  var componentName;\n  var split;\n  var propertyName;\n\n  split = property.split(\".\");\n  componentName = split[0];\n  propertyName = split[1];\n  component = el.components[componentName] || components[componentName];\n\n  // Primitives.\n  if (!component) {\n    return null;\n  }\n\n  // Dynamic schema. We only care about vectors anyways.\n  if (propertyName && !component.schema[propertyName]) {\n    return null;\n  }\n\n  // Multi-prop.\n  if (propertyName) {\n    return component.schema[propertyName].type;\n  }\n\n  // Single-prop.\n  return component.schema.type;\n}\n\n/**\n * Convert object to radians.\n */\nfunction toRadians(obj) {\n  obj.x = THREE.Math.degToRad(obj.x);\n  obj.y = THREE.Math.degToRad(obj.y);\n  obj.z = THREE.Math.degToRad(obj.z);\n}\n\nfunction addEventListeners(el, eventNames, handler) {\n  var i;\n  for (i = 0; i < eventNames.length; i++) {\n    el.addEventListener(eventNames[i], handler);\n  }\n}\n\nfunction removeEventListeners(el, eventNames, handler) {\n  var i;\n  for (i = 0; i < eventNames.length; i++) {\n    el.removeEventListener(eventNames[i], handler);\n  }\n}\n\nfunction getRawProperty(el, path) {\n  var i;\n  var split;\n  var value;\n  split = splitDot(path);\n  value = el;\n  for (i = 0; i < split.length; i++) {\n    value = value[split[i]];\n  }\n  return value;\n}\n\nfunction setRawProperty(el, path, value, type) {\n  var i;\n  var split;\n  var propertyName;\n  var targetValue;\n\n  if (path.startsWith(\"object3D.rotation\")) {\n    value = THREE.Math.degToRad(value);\n  }\n\n  // Walk.\n  split = splitDot(path);\n  targetValue = el;\n  for (i = 0; i < split.length - 1; i++) {\n    targetValue = targetValue[split[i]];\n  }\n  propertyName = split[split.length - 1];\n\n  // Raw color.\n  if (type === TYPE_COLOR) {\n    if (\"r\" in targetValue[propertyName]) {\n      targetValue[propertyName].r = value.r;\n      targetValue[propertyName].g = value.g;\n      targetValue[propertyName].b = value.b;\n    } else {\n      targetValue[propertyName].x = value.r;\n      targetValue[propertyName].y = value.g;\n      targetValue[propertyName].z = value.b;\n    }\n    return;\n  }\n\n  targetValue[propertyName] = value;\n}\n\nfunction splitDot(path) {\n  if (path in splitCache) {\n    return splitCache[path];\n  }\n  splitCache[path] = path.split(\".\");\n  return splitCache[path];\n}\n\nfunction isRawProperty(data) {\n  return data.isRawProperty || data.property.startsWith(STRING_COMPONENTS) || data.property.startsWith(STRING_OBJECT3D);\n}\n","/**\n * Instantiates and updates a THREE.AnimationMixer on an entity.\n * @component animation-mixer\n */\nAFRAME.registerComponent(\"animation-mixer\", {\n  initMixer(animations) {\n    this.mixer = new THREE.AnimationMixer(this.el.object3D);\n    this.el.object3D.animations = animations;\n    this.animations = animations;\n  },\n\n  tick: function(t, dt) {\n    if (this.mixer) {\n      this.mixer.update(dt / 1000);\n    }\n  }\n});\n","/**\n * Emits audioFrequencyChange events based on a networked audio source\n * @namespace avatar\n * @component networked-audio-analyser\n */\nAFRAME.registerComponent(\"networked-audio-analyser\", {\n  async init() {\n    this.volume = 0;\n    this.prevVolume = 0;\n    this.smoothing = 0.3;\n    this.threshold = 0.01;\n    this.el.addEventListener(\"sound-source-set\", event => {\n      const ctx = THREE.AudioContext.getContext();\n      this.analyser = ctx.createAnalyser();\n      this.analyser.fftSize = 32;\n      this.levels = new Uint8Array(this.analyser.frequencyBinCount);\n      event.detail.soundSource.connect(this.analyser);\n    });\n  },\n\n  tick: function() {\n    if (!this.analyser) return;\n\n    // take care with compatibility, e.g. safari doesn't support getFloatTimeDomainData\n    this.analyser.getByteTimeDomainData(this.levels);\n\n    let sum = 0;\n    for (let i = 0; i < this.levels.length; i++) {\n      const amplitude = (this.levels[i] - 128) / 128;\n      sum += amplitude * amplitude;\n    }\n    let currVolume = Math.sqrt(sum / this.levels.length);\n    if (currVolume < this.threshold) {\n      currVolume = 0;\n    }\n    this.volume = this.smoothing * currVolume + (1 - this.smoothing) * this.prevVolume;\n    this.prevVolume = this.volume;\n  }\n});\n\n/**\n * Sets an entity's scale base on audioFrequencyChange events.\n * @namespace avatar\n * @component scale-audio-feedback\n */\nAFRAME.registerComponent(\"scale-audio-feedback\", {\n  schema: {\n    minScale: { default: 1 },\n    maxScale: { default: 2 }\n  },\n\n  init() {\n    this._playerCamera = document.getElementById(\"player-camera\").object3D;\n    this._playerCameraWorldPosition = new THREE.Vector3();\n    this._worldPosition = new THREE.Vector3();\n  },\n\n  tick() {\n    // TODO: come up with a cleaner way to handle this.\n    // bone's are \"hidden\" by scaling them with bone-visibility, without this we would overwrite that.\n    if (!this.el.object3D.visible) return;\n\n    const { minScale, maxScale } = this.data;\n\n    const audioAnalyser = this.el.components[\"networked-audio-analyser\"];\n\n    if (!audioAnalyser) return;\n\n    const { object3D } = this.el;\n\n    this._playerCameraWorldPosition.setFromMatrixPosition(this._playerCamera.matrixWorld);\n    this._worldPosition.setFromMatrixPosition(object3D.matrixWorld);\n    const distance = this._worldPosition.distanceTo(this._playerCameraWorldPosition) / 10;\n\n    const scale = Math.min(maxScale, minScale + (maxScale - minScale) * audioAnalyser.volume * 8 * distance);\n\n    object3D.scale.setScalar(scale);\n    object3D.matrixNeedsUpdate = true;\n  }\n});\n","import { findAncestorWithComponent } from \"../utils/scene-graph\";\n\n/**\n * Loops the given clip using this entity's animation mixer\n * @component loop-animation\n */\nAFRAME.registerComponent(\"loop-animation\", {\n  schema: {\n    paused: { type: \"boolean\", default: false },\n    clip: { type: \"string\" }\n  },\n\n  init() {\n    this.mixerEl = findAncestorWithComponent(this.el, \"animation-mixer\");\n\n    if (!this.mixerEl) {\n      console.warn(\"loop-animation component could not find an animation-mixer in its ancestors.\");\n      return;\n    }\n\n    this.updateClip();\n  },\n\n  update(oldData) {\n    if ((oldData.clip !== this.data.clip || oldData.paused !== this.data.paused) && this.mixerEl) {\n      if (oldData.clip !== this.data.clip) {\n        this.updateClip();\n      }\n\n      if (this.currentAction) {\n        this.currentAction.paused = this.data.paused;\n      }\n    }\n  },\n\n  updateClip() {\n    const { mixer, animations } = this.mixerEl.components[\"animation-mixer\"];\n    const clipName = this.data.clip;\n\n    if (animations.length === 0) {\n      return;\n    }\n\n    let clip;\n\n    if (!clipName) {\n      clip = animations[0];\n    } else {\n      clip = animations.find(({ name }) => name === clipName);\n    }\n\n    if (!clip) {\n      return;\n    }\n\n    const action = mixer.clipAction(clip, this.el.object3D);\n    action.enabled = true;\n    action.setLoop(THREE.LoopRepeat, Infinity).play();\n    this.currentAction = action;\n  },\n\n  destroy() {\n    if (this.currentAction) {\n      this.currentAction.enabled = false;\n      this.currentAction.stop();\n    }\n  }\n});\n","import \"three/examples/js/pmrem/PMREMGenerator\";\nimport \"three/examples/js/pmrem/PMREMCubeUVPacker\";\nimport qsTruthy from \"../utils/qs_truthy\";\nconst isBotMode = qsTruthy(\"bot\");\n\n/**\n * @author zz85 / https://github.com/zz85\n *\n * Based on \"A Practical Analytic Model for Daylight\"\n * aka The Preetham Model, the de facto standard analytic skydome model\n * http://www.cs.utah.edu/~shirley/papers/sunsky/sunsky.pdf\n *\n * First implemented by Simon Wallner\n * http://www.simonwallner.at/projects/atmospheric-scattering\n *\n * Improved by Martin Upitis\n * http://blenderartists.org/forum/showthread.php?245954-preethams-sky-impementation-HDR\n *\n * Three.js integration by zz85 http://twitter.com/blurspline\n */\n\nTHREE.Sky = function() {\n  const shader = THREE.Sky.SkyShader;\n\n  const material = new THREE.ShaderMaterial({\n    fragmentShader: shader.fragmentShader,\n    vertexShader: shader.vertexShader,\n    uniforms: THREE.UniformsUtils.clone(shader.uniforms),\n    side: THREE.BackSide\n  });\n\n  THREE.Mesh.call(this, new THREE.BoxBufferGeometry(1, 1, 1), material);\n};\n\nTHREE.Sky.prototype = Object.create(THREE.Mesh.prototype);\nTHREE.Sky.prototype.constructor = THREE.Sky;\n\nTHREE.Sky.SkyShader = {\n  uniforms: {\n    luminance: { value: 1 },\n    turbidity: { value: 2 },\n    rayleigh: { value: 1 },\n    mieCoefficient: { value: 0.005 },\n    mieDirectionalG: { value: 0.8 },\n    sunPosition: { value: new THREE.Vector3() }\n  },\n\n  vertexShader: [\n    \"uniform vec3 sunPosition;\",\n    \"uniform float rayleigh;\",\n    \"uniform float turbidity;\",\n    \"uniform float mieCoefficient;\",\n\n    \"varying vec3 vWorldPosition;\",\n    \"varying vec3 vSunDirection;\",\n    \"varying float vSunfade;\",\n    \"varying vec3 vBetaR;\",\n    \"varying vec3 vBetaM;\",\n    \"varying float vSunE;\",\n\n    \"const vec3 up = vec3( 0.0, 1.0, 0.0 );\",\n\n    // constants for atmospheric scattering\n    \"const float e = 2.71828182845904523536028747135266249775724709369995957;\",\n    \"const float pi = 3.141592653589793238462643383279502884197169;\",\n\n    // wavelength of used primaries, according to preetham\n    \"const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );\",\n    // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:\n    // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))\n    \"const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );\",\n\n    // mie stuff\n    // K coefficient for the primaries\n    \"const float v = 4.0;\",\n    \"const vec3 K = vec3( 0.686, 0.678, 0.666 );\",\n    // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K\n    \"const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );\",\n\n    // earth shadow hack\n    // cutoffAngle = pi / 1.95;\n    \"const float cutoffAngle = 1.6110731556870734;\",\n    \"const float steepness = 1.5;\",\n    \"const float EE = 1000.0;\",\n\n    \"float sunIntensity( float zenithAngleCos ) {\",\n    \"\tzenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );\",\n    \"\treturn EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );\",\n    \"}\",\n\n    \"vec3 totalMie( float T ) {\",\n    \"\tfloat c = ( 0.2 * T ) * 10E-18;\",\n    \"\treturn 0.434 * c * MieConst;\",\n    \"}\",\n\n    \"void main() {\",\n\n    \"\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\",\n    \"\tvWorldPosition = worldPosition.xyz;\",\n\n    \"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n    \"\tvSunDirection = normalize( sunPosition );\",\n\n    \"\tvSunE = sunIntensity( dot( vSunDirection, up ) );\",\n\n    \"\tvSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );\",\n\n    \"\tfloat rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );\",\n\n    // extinction (absorbtion + out scattering)\n    // rayleigh coefficients\n    \"\tvBetaR = totalRayleigh * rayleighCoefficient;\",\n\n    // mie coefficients\n    \"\tvBetaM = totalMie( turbidity ) * mieCoefficient;\",\n\n    \"}\"\n  ].join(\"\\n\"),\n\n  fragmentShader: [\n    \"varying vec3 vWorldPosition;\",\n    \"varying vec3 vSunDirection;\",\n    \"varying float vSunfade;\",\n    \"varying vec3 vBetaR;\",\n    \"varying vec3 vBetaM;\",\n    \"varying float vSunE;\",\n\n    \"uniform float luminance;\",\n    \"uniform float mieDirectionalG;\",\n\n    \"const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );\",\n\n    // constants for atmospheric scattering\n    \"const float pi = 3.141592653589793238462643383279502884197169;\",\n\n    \"const float n = 1.0003;\", // refractive index of air\n    \"const float N = 2.545E25;\", // number of molecules per unit volume for air at\n    // 288.15K and 1013mb (sea level -45 celsius)\n\n    // optical length at zenith for molecules\n    \"const float rayleighZenithLength = 8.4E3;\",\n    \"const float mieZenithLength = 1.25E3;\",\n    \"const vec3 up = vec3( 0.0, 1.0, 0.0 );\",\n    // 66 arc seconds -> degrees, and the cosine of that\n    \"const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;\",\n\n    // 3.0 / ( 16.0 * pi )\n    \"const float THREE_OVER_SIXTEENPI = 0.05968310365946075;\",\n    // 1.0 / ( 4.0 * pi )\n    \"const float ONE_OVER_FOURPI = 0.07957747154594767;\",\n\n    \"float rayleighPhase( float cosTheta ) {\",\n    \"\treturn THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );\",\n    \"}\",\n\n    \"float hgPhase( float cosTheta, float g ) {\",\n    \"\tfloat g2 = pow( g, 2.0 );\",\n    \"\tfloat inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );\",\n    \"\treturn ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );\",\n    \"}\",\n\n    // Filmic ToneMapping http://filmicgames.com/archives/75\n    \"const float A = 0.15;\",\n    \"const float B = 0.50;\",\n    \"const float C = 0.10;\",\n    \"const float D = 0.20;\",\n    \"const float E = 0.02;\",\n    \"const float F = 0.30;\",\n\n    \"const float whiteScale = 1.0748724675633854;\", // 1.0 / Uncharted2Tonemap(1000.0)\n\n    \"vec3 Uncharted2Tonemap( vec3 x ) {\",\n    \"\treturn ( ( x * ( A * x + C * B ) + D * E ) / ( x * ( A * x + B ) + D * F ) ) - E / F;\",\n    \"}\",\n\n    \"void main() {\",\n    // optical length\n    // cutoff angle at 90 to avoid singularity in next formula.\n    \"\tfloat zenithAngle = acos( max( 0.0, dot( up, normalize( vWorldPosition - cameraPos ) ) ) );\",\n    \"\tfloat inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );\",\n    \"\tfloat sR = rayleighZenithLength * inverse;\",\n    \"\tfloat sM = mieZenithLength * inverse;\",\n\n    // combined extinction factor\n    \"\tvec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );\",\n\n    // in scattering\n    \"\tfloat cosTheta = dot( normalize( vWorldPosition - cameraPos ), vSunDirection );\",\n\n    \"\tfloat rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );\",\n    \"\tvec3 betaRTheta = vBetaR * rPhase;\",\n\n    \"\tfloat mPhase = hgPhase( cosTheta, mieDirectionalG );\",\n    \"\tvec3 betaMTheta = vBetaM * mPhase;\",\n\n    \"\tvec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );\",\n    \"\tLin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );\",\n\n    // nightsky\n    \"\tvec3 direction = normalize( vWorldPosition - cameraPos );\",\n    \"\tfloat theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]\",\n    \"\tfloat phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]\",\n    \"\tvec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );\",\n    \"\tvec3 L0 = vec3( 0.1 ) * Fex;\",\n\n    // composition + solar disc\n    \"\tfloat sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );\",\n    \"\tL0 += ( vSunE * 19000.0 * Fex ) * sundisk;\",\n\n    \"\tvec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );\",\n\n    \"\tvec3 curr = Uncharted2Tonemap( ( log2( 2.0 / pow( luminance, 4.0 ) ) ) * texColor );\",\n    \"\tvec3 color = curr * whiteScale;\",\n\n    \"\tvec3 retColor = pow( color, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );\",\n\n    \"\tgl_FragColor = vec4( retColor, 1.0 );\",\n\n    \"}\"\n  ].join(\"\\n\")\n};\n\nAFRAME.registerComponent(\"skybox\", {\n  schema: {\n    turbidity: { type: \"number\", default: 10 },\n    rayleigh: { type: \"number\", default: 2 },\n    luminance: { type: \"number\", default: 1 },\n    mieCoefficient: { type: \"number\", default: 0.005 },\n    mieDirectionalG: { type: \"number\", default: 0.8 },\n    inclination: { type: \"number\", default: 0 },\n    azimuth: { type: \"number\", default: 0.15 },\n    distance: { type: \"number\", default: 8000 }\n  },\n\n  init() {\n    this.sky = new THREE.Sky();\n    this.el.setObject3D(\"mesh\", this.sky);\n    this.skyScene = new THREE.Scene();\n    this.cubeCamera = new THREE.CubeCamera(1, 100000, 512);\n    this.skyScene.add(this.cubeCamera);\n\n    this.updateEnvironmentMap = this.updateEnvironmentMap.bind(this);\n    // HACK: Render environment map on next frame to avoid bug where the render target texture is black.\n    // EXTRA HACK: Added timeout due to additional case where texture is black in avatar-selector in Firefox.\n    // This is likely due to the custom elements attached callback being synchronous on Chrome but not Firefox.\n    requestAnimationFrame(() => setTimeout(this.updateEnvironmentMap));\n  },\n\n  update(oldData) {\n    const uniforms = this.sky.material.uniforms;\n\n    if (this.data.turbidity !== oldData.turbidity) {\n      uniforms.turbidity.value = this.data.turbidity;\n    }\n\n    if (this.data.rayleigh !== oldData.rayleigh) {\n      uniforms.rayleigh.value = this.data.rayleigh;\n    }\n\n    if (this.data.luminance !== oldData.luminance) {\n      uniforms.luminance.value = this.data.luminance;\n    }\n\n    if (this.data.mieCoefficient !== oldData.mieCoefficient) {\n      uniforms.mieCoefficient.value = this.data.mieCoefficient;\n    }\n\n    if (this.data.mieDirectionalG !== oldData.mieDirectionalG) {\n      uniforms.mieDirectionalG.value = this.data.mieDirectionalG;\n    }\n\n    if (\n      this.data.inclination !== oldData.inclination ||\n      this.data.azimuth !== oldData.azimuth ||\n      this.data.distance !== oldData.distance\n    ) {\n      const theta = Math.PI * (this.data.inclination - 0.5);\n      const phi = 2 * Math.PI * (this.data.azimuth - 0.5);\n\n      const distance = this.data.distance;\n\n      const x = distance * Math.cos(phi);\n      const y = distance * Math.sin(phi) * Math.sin(theta);\n      const z = distance * Math.sin(phi) * Math.cos(theta);\n\n      uniforms.sunPosition.value.set(x, y, z).normalize();\n\n      // HACK Remove this if condition and always set the scale based on distance when the existing environments\n      // have their sky scales set to 1.\n      if (this.el.object3D.scale.x === 1) {\n        this.sky.scale.set(distance, distance, distance);\n      }\n\n      this.el.object3D.matrixNeedsUpdate = true;\n    }\n\n    this.updateEnvironmentMap();\n  },\n\n  updateEnvironmentMap() {\n    const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\n\n    if (environmentMapComponent && !isBotMode) {\n      const renderer = this.el.sceneEl.renderer;\n      this.skyScene.add(this.sky);\n      this.cubeCamera.update(renderer, this.skyScene);\n      this.el.setObject3D(\"mesh\", this.sky);\n      const vrEnabled = renderer.vr.enabled;\n      renderer.vr.enabled = false;\n      const pmremGenerator = new THREE.PMREMGenerator(this.cubeCamera.renderTarget.texture);\n      pmremGenerator.update(renderer);\n      const pmremCubeUVPacker = new THREE.PMREMCubeUVPacker(pmremGenerator.cubeLods);\n      pmremCubeUVPacker.update(renderer);\n      renderer.vr.enabled = vrEnabled;\n      environmentMapComponent.updateEnvironmentMap(pmremCubeUVPacker.CubeUVRenderTarget.texture);\n      pmremGenerator.dispose();\n      pmremCubeUVPacker.dispose();\n    }\n  },\n\n  remove() {\n    this.el.removeObject3D(\"mesh\");\n  }\n});\n","const qs = new URLSearchParams(location.search);\n\nexport default function qsTruthy(param) {\n  const val = qs.get(param);\n  // if the param exists but is not set (e.g. \"?foo&bar\"), its value is the empty string.\n  return val === \"\" || /1|on|true|yes/i.test(val);\n}\n","import localeData from \"../assets/translations.data.json\";\nconst navigatorLang = ((navigator.languages && navigator.languages[0]) || navigator.language || navigator.userLanguage)\n  .toLowerCase()\n  .split(/[_-]+/)[0];\nexport const lang = (localeData[navigatorLang] && navigatorLang) || \"en\";\nexport const messages = localeData[lang] || localeData.en;\n","export function getSanitizedComponentMapping(inputComponent, inputProperty, publicComponents) {\n  const publicComponent = publicComponents[inputComponent];\n\n  if (!publicComponent) {\n    throw new Error(`Component \"${inputComponent}\" is not public.`);\n  }\n\n  const publicProperty = publicComponent.publicProperties[inputProperty];\n\n  if (!publicProperty) {\n    throw new Error(`Component \"${inputComponent}\"'s property \"${inputProperty}\" is not public.`);\n  }\n\n  return {\n    mappedComponent: publicComponent.mappedComponent,\n    mappedProperty: publicProperty.mappedProperty,\n    getMappedValue: publicProperty.getMappedValue\n  };\n}\n","import \"./components/gltf-model-plus\";\nimport { getSanitizedComponentMapping } from \"./utils/component-mappings\";\nimport { isHubsDestinationUrl } from \"./utils/media-utils\";\nconst PHYSICS_CONSTANTS = require(\"aframe-physics-system/src/constants\"),\n  TYPE = PHYSICS_CONSTANTS.TYPE,\n  SHAPE = PHYSICS_CONSTANTS.SHAPE,\n  FIT = PHYSICS_CONSTANTS.FIT;\nconst COLLISION_LAYERS = require(\"./constants\").COLLISION_LAYERS;\n\nAFRAME.GLTFModelPlus.registerComponent(\"duck\", \"duck\");\nAFRAME.GLTFModelPlus.registerComponent(\"quack\", \"quack\");\nAFRAME.GLTFModelPlus.registerComponent(\"sound\", \"sound\");\nAFRAME.GLTFModelPlus.registerComponent(\"css-class\", \"css-class\");\nAFRAME.GLTFModelPlus.registerComponent(\"interactable\", \"css-class\", (el, componentName) => {\n  el.setAttribute(componentName, \"interactable\");\n});\nAFRAME.GLTFModelPlus.registerComponent(\"super-spawner\", \"super-spawner\", (el, componentName, componentData) => {\n  //TODO: Do not automatically add these components\n  el.setAttribute(\"is-remote-hover-target\", \"\");\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\n  el.setAttribute(\"hoverable-visuals\", {\n    cursorController: \"#cursor-controller\"\n  });\n  el.setAttribute(componentName, componentData);\n});\nAFRAME.GLTFModelPlus.registerComponent(\"gltf-model-plus\", \"gltf-model-plus\");\nAFRAME.GLTFModelPlus.registerComponent(\"media-loader\", \"media-loader\");\nAFRAME.GLTFModelPlus.registerComponent(\"body\", \"ammo-body\", el => {\n  //This is only required for migration of old environments with super-spawners\n  //will no longer be needed when spawners are added via Spoke instead.\n  el.setAttribute(\"ammo-body\", {\n    mass: 0,\n    type: TYPE.STATIC,\n    collisionFilterGroup: COLLISION_LAYERS.INTERACTABLES,\n    collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER\n  });\n});\nAFRAME.GLTFModelPlus.registerComponent(\"ammo-shape\", \"ammo-shape\");\nAFRAME.GLTFModelPlus.registerComponent(\"hide-when-quality\", \"hide-when-quality\");\nAFRAME.GLTFModelPlus.registerComponent(\"light\", \"light\", (el, componentName, componentData) => {\n  if (componentData.distance === 0) {\n    componentData.decay = 0;\n  }\n  el.setAttribute(componentName, componentData);\n  if (componentData.castShadow) {\n    // HACK: component.light isn't set until one frame after setArrtibute\n    setTimeout(() => {\n      el.components.light.light.shadow.camera.matrixNeedsUpdate = true;\n    }, 0);\n  }\n});\nAFRAME.GLTFModelPlus.registerComponent(\"ambient-light\", \"ambient-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"directional-light\", \"directional-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"hemisphere-light\", \"hemisphere-light\");\nfunction decayMigration(el, componentName, componentData) {\n  if (componentData.range === 0) {\n    componentData.decay = 0;\n  }\n  el.setAttribute(componentName, componentData);\n}\nAFRAME.GLTFModelPlus.registerComponent(\"point-light\", \"point-light\", decayMigration);\nAFRAME.GLTFModelPlus.registerComponent(\"spot-light\", \"spot-light\", decayMigration);\n\nAFRAME.GLTFModelPlus.registerComponent(\"skybox\", \"skybox\");\nAFRAME.GLTFModelPlus.registerComponent(\"layers\", \"layers\");\nAFRAME.GLTFModelPlus.registerComponent(\"shadow\", \"shadow\");\nAFRAME.GLTFModelPlus.registerComponent(\"water\", \"water\");\nAFRAME.GLTFModelPlus.registerComponent(\"scale-audio-feedback\", \"scale-audio-feedback\");\nAFRAME.GLTFModelPlus.registerComponent(\"animation-mixer\", \"animation-mixer\");\nAFRAME.GLTFModelPlus.registerComponent(\"loop-animation\", \"loop-animation\");\nAFRAME.GLTFModelPlus.registerComponent(\n  \"box-collider\",\n  \"ammo-shape\",\n  (() => {\n    const euler = new THREE.Euler();\n    return (el, componentName, componentData) => {\n      const { scale, rotation } = componentData;\n      euler.set(rotation.x, rotation.y, rotation.z);\n      const orientation = new THREE.Quaternion().setFromEuler(euler);\n      el.setAttribute(componentName, {\n        type: SHAPE.BOX,\n        fit: FIT.MANUAL,\n        offset: componentData.position,\n        halfExtents: { x: scale.x / 2, y: scale.y / 2, z: scale.z / 2 },\n        orientation\n      });\n    };\n  })()\n);\nAFRAME.GLTFModelPlus.registerComponent(\"visible\", \"visible\", (el, componentName, componentData) => {\n  if (typeof componentData === \"object\") {\n    el.setAttribute(componentName, componentData.visible);\n  } else {\n    el.setAttribute(componentName, componentData);\n  }\n});\nAFRAME.GLTFModelPlus.registerComponent(\"spawn-point\", \"spawn-point\");\nAFRAME.GLTFModelPlus.registerComponent(\"sticky-zone\", \"sticky-zone\");\nAFRAME.GLTFModelPlus.registerComponent(\"nav-mesh\", \"nav-mesh\", (el, _componentName, componentData) => {\n  const nav = AFRAME.scenes[0].systems.nav;\n  const zone = componentData.zone || \"character\";\n  let found = false;\n  el.object3D.traverse(node => {\n    if (node.isMesh && !found) {\n      found = true;\n      nav.loadMesh(node, zone);\n    }\n  });\n  // There isn't actually an a-frame nav-mesh component, but we want to tag this el as a nav-mesh since\n  // nav-mesh-helper will query for it later.\n  el.setAttribute(\"nav-mesh\");\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"pinnable\", \"pinnable\");\n\nAFRAME.GLTFModelPlus.registerComponent(\"media\", \"media\", (el, componentName, componentData) => {\n  if (componentData.id) {\n    el.setAttribute(\"networked\", {\n      template: \"#interactable-media\",\n      owner: \"scene\",\n      persistent: true,\n      networkId: componentData.id\n    });\n  }\n\n  el.setAttribute(\"media-loader\", {\n    src: componentData.src,\n    resize: true,\n    resolve: true,\n    fileIsOwned: true,\n    animate: false\n  });\n\n  if (componentData.pageIndex) {\n    el.setAttribute(\"media-pager\", { index: componentData.pageIndex });\n  }\n\n  if (componentData.paused !== undefined) {\n    el.setAttribute(\"media-video\", { videoPaused: componentData.paused });\n  }\n\n  if (componentData.time) {\n    el.setAttribute(\"media-video\", { time: componentData.time });\n  }\n});\n\nfunction mediaInflator(el, componentName, componentData, components) {\n  let isControlled = true;\n\n  if (components.networked) {\n    // TODO: When non-hubs links can be traversed, make all link components controlled so you can open them.\n    isControlled =\n      componentData.controls || isHubsDestinationUrl(componentData.src) || isHubsDestinationUrl(componentData.href);\n\n    const hasVolume = componentName === \"video\";\n    const templateName = isControlled || hasVolume ? \"#static-controlled-media\" : \"#static-media\";\n\n    el.setAttribute(\"networked\", {\n      template: templateName,\n      owner: \"scene\",\n      persistent: true,\n      networkId: components.networked.id\n    });\n  }\n\n  const mediaOptions = {};\n\n  if (componentName === \"video\" || componentName === \"image\") {\n    mediaOptions.projection = componentData.projection;\n  }\n\n  if (componentName === \"video\") {\n    mediaOptions.videoPaused = !componentData.autoPlay;\n    mediaOptions.volume = componentData.volume;\n    mediaOptions.loop = componentData.loop;\n    mediaOptions.audioType = componentData.audioType;\n    mediaOptions.hidePlaybackControls = !isControlled;\n\n    if (componentData.audioType === \"pannernode\") {\n      mediaOptions.distanceModel = componentData.distanceModel;\n      mediaOptions.rolloffFactor = componentData.rolloffFactor;\n      mediaOptions.refDistance = componentData.refDistance;\n      mediaOptions.maxDistance = componentData.maxDistance;\n      mediaOptions.coneInnerAngle = componentData.coneInnerAngle;\n      mediaOptions.coneOuterAngle = componentData.coneOuterAngle;\n      mediaOptions.coneOuterGain = componentData.coneOuterGain;\n    }\n\n    el.setAttribute(\"video-pause-state\", { paused: mediaOptions.videoPaused });\n  }\n\n  const src = componentName === \"link\" ? componentData.href : componentData.src;\n\n  el.setAttribute(\"media-loader\", {\n    src,\n    resize: true,\n    resolve: true,\n    fileIsOwned: true,\n    animate: false,\n    mediaOptions\n  });\n}\n\nAFRAME.GLTFModelPlus.registerComponent(\"image\", \"image\", mediaInflator);\nAFRAME.GLTFModelPlus.registerComponent(\"video\", \"video\", mediaInflator, (name, property, value) => {\n  if (property === \"paused\") {\n    return { name: \"video-pause-state\", property, value };\n  } else {\n    return null;\n  }\n});\nAFRAME.GLTFModelPlus.registerComponent(\"link\", \"link\", mediaInflator);\n\nAFRAME.GLTFModelPlus.registerComponent(\"hoverable\", \"is-remote-hover-target\", el => {\n  el.setAttribute(\"is-remote-hover-target\", \"\");\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"spawner\", \"spawner\", (el, componentName, componentData) => {\n  el.setAttribute(\"media-loader\", {\n    src: componentData.src,\n    resolve: true,\n    fileIsOwned: true,\n    animate: false\n  });\n  el.setAttribute(\"css-class\", \"interactable\");\n  el.setAttribute(\"super-spawner\", {\n    src: componentData.src,\n    resolve: true,\n    template: \"#interactable-media\"\n  });\n  el.setAttribute(\"hoverable-visuals\", {\n    cursorController: \"#cursor-controller\"\n  });\n  el.setAttribute(\"ammo-body\", {\n    mass: 0,\n    type: TYPE.STATIC,\n    collisionFilterGroup: COLLISION_LAYERS.INTERACTABLES,\n    collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER\n  });\n  el.setAttribute(\"is-remote-hover-target\", \"\");\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\n});\n\nconst publicComponents = {\n  video: {\n    mappedComponent: \"video-pause-state\",\n    publicProperties: {\n      paused: {\n        mappedProperty: \"paused\",\n        getMappedValue(value) {\n          return !!value;\n        }\n      }\n    }\n  },\n  \"loop-animation\": {\n    mappedComponent: \"loop-animation\",\n    publicProperties: {\n      paused: {\n        mappedProperty: \"paused\",\n        getMappedValue(value) {\n          return !!value;\n        }\n      }\n    }\n  }\n};\n\nAFRAME.GLTFModelPlus.registerComponent(\n  \"trigger-volume\",\n  \"trigger-volume\",\n  (el, componentName, componentData, components, indexToEntityMap) => {\n    const {\n      size,\n      target,\n      enterComponent,\n      enterProperty,\n      enterValue,\n      leaveComponent,\n      leaveProperty,\n      leaveValue\n    } = componentData;\n\n    let enterComponentMapping, leaveComponentMapping, targetEntity;\n\n    try {\n      enterComponentMapping = getSanitizedComponentMapping(enterComponent, enterProperty, publicComponents);\n      leaveComponentMapping = getSanitizedComponentMapping(leaveComponent, leaveProperty, publicComponents);\n\n      targetEntity = indexToEntityMap[target];\n\n      if (!targetEntity) {\n        throw new Error(`Couldn't find target entity with index: ${target}.`);\n      }\n    } catch (e) {\n      console.warn(`Error inflating gltf component \"trigger-volume\": ${e.message}`);\n      return;\n    }\n\n    // Filter out scope and colliders properties.\n    el.setAttribute(\"trigger-volume\", {\n      colliders: \"#player-camera\",\n      size,\n      target: targetEntity,\n      enterComponent: enterComponentMapping.mappedComponent,\n      enterProperty: enterComponentMapping.mappedProperty,\n      enterValue: enterComponentMapping.getMappedValue(enterValue),\n      leaveComponent: leaveComponentMapping.mappedComponent,\n      leaveProperty: leaveComponentMapping.mappedProperty,\n      leaveValue: leaveComponentMapping.getMappedValue(leaveValue)\n    });\n  }\n);\n","import { avatars } from \"../assets/avatars/avatars.js\";\n\nconst names = [\n  \"Baers-Pochard\",\n  \"Baikal-Teal\",\n  \"Barrows-Goldeneye\",\n  \"Blue-Billed\",\n  \"Blue-Duck\",\n  \"Blue-Winged\",\n  \"Brown-Teal\",\n  \"Bufflehead\",\n  \"Canvasback\",\n  \"Cape-Shoveler\",\n  \"Chestnut-Teal\",\n  \"Chiloe-Wigeon\",\n  \"Cinnamon-Teal\",\n  \"Comb-Duck\",\n  \"Common-Eider\",\n  \"Common-Goldeneye\",\n  \"Common-Merganser\",\n  \"Common-Pochard\",\n  \"Common-Scoter\",\n  \"Common-Shelduck\",\n  \"Cotton-Pygmy\",\n  \"Crested-Duck\",\n  \"Crested-Shelduck\",\n  \"Eatons-Pintail\",\n  \"Falcated\",\n  \"Ferruginous\",\n  \"Freckled-Duck\",\n  \"Gadwall\",\n  \"Garganey\",\n  \"Greater-Scaup\",\n  \"Green-Pygmy\",\n  \"Grey-Teal\",\n  \"Hardhead\",\n  \"Harlequin\",\n  \"Hartlaubs\",\n  \"Hooded-Merganser\",\n  \"Hottentot-Teal\",\n  \"Kelp-Goose\",\n  \"King-Eider\",\n  \"Lake-Duck\",\n  \"Laysan-Duck\",\n  \"Lesser-Scaup\",\n  \"Long-Tailed\",\n  \"Maccoa-Duck\",\n  \"Mallard\",\n  \"Mandarin\",\n  \"Marbled-Teal\",\n  \"Mellers-Duck\",\n  \"Merganser\",\n  \"Northern-Pintail\",\n  \"Orinoco-Goose\",\n  \"Paradise-Shelduck\",\n  \"Plumed-Whistler\",\n  \"Puna-Teal\",\n  \"Pygmy-Goose\",\n  \"Radjah-Shelduck\",\n  \"Red-Billed\",\n  \"Red-Crested\",\n  \"Red-Shoveler\",\n  \"Ring-Necked\",\n  \"Ringed-Teal\",\n  \"Rosy-Billed\",\n  \"Ruddy-Shelduck\",\n  \"Salvadoris-Teal\",\n  \"Scaly-Sided\",\n  \"Shelduck\",\n  \"Shoveler\",\n  \"Silver-Teal\",\n  \"Smew\",\n  \"Spectacled-Eider\",\n  \"Spot-Billed\",\n  \"Spotted-Whistler\",\n  \"Steamerduck\",\n  \"Stellers-Eider\",\n  \"Sunda-Teal\",\n  \"Surf-Scoter\",\n  \"Tufted-Duck\",\n  \"Velvet-Scoter\",\n  \"Wandering-Whistler\",\n  \"Whistling-duck\",\n  \"White-Backed\",\n  \"White-Cheeked\",\n  \"White-Winged\",\n  \"Wigeon\",\n  \"Wood-Duck\",\n  \"Yellow-Billed\"\n];\n\nfunction selectRandom(arr) {\n  return arr[Math.floor(Math.random() * arr.length)];\n}\n\nexport function generateRandomName() {\n  return `${selectRandom(names)}-${Math.floor(10000 + Math.random() * 10000)}`;\n}\n\nexport const avatarIds = avatars.map(av => av.id);\n\nexport function generateDefaultProfile() {\n  return {\n    avatarId: selectRandom(avatarIds)\n  };\n}\n","import { Validator } from \"jsonschema\";\nimport merge from \"deepmerge\";\nimport Cookies from \"js-cookie\";\nimport jwtDecode from \"jwt-decode\";\n\nconst LOCAL_STORE_KEY = \"___hubs_store\";\nconst STORE_STATE_CACHE_KEY = Symbol();\nconst OAUTH_FLOW_CREDENTIALS_KEY = \"ret-oauth-flow-account-credentials\";\nconst validator = new Validator();\nimport { EventTarget } from \"event-target-shim\";\nimport { generateDefaultProfile, generateRandomName } from \"../utils/identity.js\";\n\n// Durable (via local-storage) schema-enforced state that is meant to be consumed via forward data flow.\n// (Think flux but with way less incidental complexity, at least for now :))\nexport const SCHEMA = {\n  id: \"/HubsStore\",\n\n  definitions: {\n    profile: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        displayName: { type: \"string\", pattern: \"^[A-Za-z0-9-]{3,32}$\" },\n        avatarId: { type: \"string\" },\n        personalAvatarId: { type: \"string\" }\n      }\n    },\n\n    credentials: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        token: { type: [\"null\", \"string\"] },\n        email: { type: [\"null\", \"string\"] }\n      }\n    },\n\n    activity: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        hasFoundFreeze: { type: \"boolean\" },\n        hasChangedName: { type: \"boolean\" },\n        hasAcceptedProfile: { type: \"boolean\" },\n        lastEnteredAt: { type: \"string\" },\n        hasPinned: { type: \"boolean\" },\n        hasRotated: { type: \"boolean\" },\n        hasRecentered: { type: \"boolean\" },\n        hasScaled: { type: \"boolean\" },\n        hasHoveredInWorldHud: { type: \"boolean\" }\n      }\n    },\n\n    settings: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        lastUsedMicDeviceId: { type: \"string\" }\n      }\n    },\n\n    confirmedDiscordRooms: {\n      type: \"array\",\n      items: { type: \"string\" }\n    },\n\n    uploadPromotionTokens: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          fileId: { type: \"string\" },\n          promotionToken: { type: \"string\" }\n        }\n      }\n    },\n\n    creatorAssignmentTokens: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          hubId: { type: \"string\" },\n          creatorAssignmentToken: { type: \"string\" }\n        }\n      }\n    }\n  },\n\n  type: \"object\",\n\n  properties: {\n    profile: { $ref: \"#/definitions/profile\" },\n    credentials: { $ref: \"#/definitions/credentials\" },\n    activity: { $ref: \"#/definitions/activity\" },\n    settings: { $ref: \"#/definitions/settings\" },\n    confirmedDiscordRooms: { $ref: \"#/definitions/confirmedDiscordRooms\" },\n    uploadPromotionTokens: { $ref: \"#/definitions/uploadPromotionTokens\" },\n    creatorAssignmentTokens: { $ref: \"#/definitions/creatorAssignmentTokens\" }\n  },\n\n  additionalProperties: false\n};\n\nexport default class Store extends EventTarget {\n  constructor() {\n    super();\n\n    if (localStorage.getItem(LOCAL_STORE_KEY) === null) {\n      localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify({}));\n    }\n    this.update({\n      activity: {},\n      settings: {},\n      credentials: {},\n      profile: {},\n      confirmedDiscordRooms: [],\n      uploadPromotionTokens: [],\n      creatorAssignmentTokens: []\n    });\n\n    const oauthFlowCredentials = Cookies.getJSON(OAUTH_FLOW_CREDENTIALS_KEY);\n    if (oauthFlowCredentials) {\n      this.update({ credentials: oauthFlowCredentials });\n      this.resetToRandomLegacyAvatar();\n      Cookies.remove(OAUTH_FLOW_CREDENTIALS_KEY);\n    }\n  }\n\n  // Initializes store with any default bits\n  init = () => {\n    this.update({\n      profile: { ...generateDefaultProfile(), ...(this.state.profile || {}) }\n    });\n\n    // Regenerate name to encourage users to change it.\n    if (!this.state.activity.hasChangedName) {\n      this.update({ profile: { displayName: generateRandomName() } });\n    }\n  };\n\n  resetToRandomLegacyAvatar = () => {\n    this.update({\n      profile: { ...(this.state.profile || {}), ...generateDefaultProfile() }\n    });\n  };\n\n  get state() {\n    if (!this.hasOwnProperty(STORE_STATE_CACHE_KEY)) {\n      this[STORE_STATE_CACHE_KEY] = JSON.parse(localStorage.getItem(LOCAL_STORE_KEY));\n    }\n\n    return this[STORE_STATE_CACHE_KEY];\n  }\n\n  get credentialsAccountId() {\n    if (this.state.credentials.token) {\n      return jwtDecode(this.state.credentials.token).sub;\n    } else {\n      return null;\n    }\n  }\n\n  resetConfirmedDiscordRooms() {\n    // merge causing us some annoyance here :(\n    const overwriteMerge = (destinationArray, sourceArray) => sourceArray;\n    this.update({ confirmedDiscordRooms: [] }, { arrayMerge: overwriteMerge });\n  }\n\n  resetTipActivityFlags() {\n    this.update({ activity: { hasRotated: false, hasPinned: false, hasRecentered: false, hasScaled: false } });\n  }\n\n  update(newState, mergeOpts) {\n    const finalState = merge(this.state, newState, mergeOpts);\n    const { valid } = validator.validate(finalState, SCHEMA);\n\n    if (!valid) {\n      // Intentionally not including details about the state or validation result here, since we don't want to leak\n      // sensitive data in the error message.\n      throw new Error(`Write to store failed schema validation.`);\n    }\n\n    localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify(finalState));\n    delete this[STORE_STATE_CACHE_KEY];\n\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n\n    return finalState;\n  }\n}\n","export const avatars = [\n  {\n    id: \"botdefault\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotDefault_Avatar-9f71f8ff22.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botdefault-thumb-42C4C7D3C01D085EAFDAC8BACE591CE6.png\"\n  },\n  {\n    id: \"botbobo\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotBobo_Avatar-f9740a010b.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botbobo-thumb-261278FD5831E9CD89610D15948F23E4.png\"\n  },\n  {\n    id: \"botdom\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotDom_Avatar-0c48bf15a5.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botdom-thumb-1160EB5E81D24F12CE643C520CE1E99E.png\"\n  },\n  {\n    id: \"botgreg\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotGreg_Avatar-98d39797bb.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botgreg-thumb-F2A37F14F9C342EE44DDE9B24DD9B9FC.png\"\n  },\n  {\n    id: \"botguest\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotGuest_Avatar-78cd857332.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botguest-thumb-F7A471250E2C10C2709325C3B02A8BBB.png\"\n  },\n  {\n    id: \"botjim\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotJim_Avatar-d28005a687.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botjim-thumb-A2D195C1A51A082BCED58BD172481B39.png\"\n  },\n  {\n    id: \"botkev\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotKev_Avatar-a95787bb51.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botkev-thumb-90746A7349E3F964C913EA612EE9A53F.png\"\n  },\n  {\n    id: \"botpinky\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotPinky_Avatar-b0b93f8675.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botpinky-thumb-C2E69D4479077766B988DC3EE4F30BE5.png\"\n  },\n  {\n    id: \"botrobert\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotRobert_Avatar-e9554880f3.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botrobert-thumb-9C33F2C752326E2CF4321EAA7BDB4E47.png\"\n  },\n  {\n    id: \"botwoody\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotWoody_Avatar-0140485a23.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botwoody-thumb-F1F1FA7E21301B5AC1D8872B4ED0CC56.png\"\n  }\n];\n","export function forEachMaterial(object3D, fn) {\n  if (!object3D.material) return;\n\n  if (Array.isArray(object3D.material)) {\n    object3D.material.forEach(fn);\n  } else {\n    fn(object3D.material);\n  }\n}\n\nexport function mapMaterials(object3D, fn) {\n  if (!object3D.material) return;\n\n  if (Array.isArray(object3D.material)) {\n    return object3D.material.map(fn);\n  } else {\n    return fn(object3D.material);\n  }\n}\n","// Enumeration of spawned object content origins. URL means the content is\n// fetched from a URL, FILE means it was an uploaded/dropped file, and\n// CLIPBOARD means it was raw data pasted in from the clipboard, SPAWNER means\n// it was copied over from a spawner.\nexport const ObjectContentOrigins = {\n  URL: 1,\n  FILE: 2,\n  CLIPBOARD: 3,\n  SPAWNER: 4\n};\n\n// Enumeration of spawnable object types, used for telemetry, which encapsulates\n// both the origin of the content for the object and also the type of content\n// contained in the object.\nexport const ObjectTypes = {\n  URL_IMAGE: 0,\n  URL_VIDEO: 1,\n  URL_MODEL: 2,\n  URL_PDF: 3,\n  URL_AUDIO: 4,\n  //URL_TEXT: 5,\n  //URL_TELEPORTER: 6,\n  FILE_IMAGE: 8,\n  FILE_VIDEO: 9,\n  FILE_MODEL: 10,\n  FILE_PDF: 11,\n  FILE_AUDIO: 12,\n  //FILE_TEXT: 13,\n  CLIPBOARD_IMAGE: 16,\n  CLIPBOARD_VIDEO: 17,\n  CLIPBOARD_MODEL: 18,\n  CLIPBOARD_PDF: 19,\n  CLIPBOARD_AUDIO: 20,\n  //CLIPBOARD_TEXT: 21,\n  SPAWNER_IMAGE: 24,\n  SPAWNER_VIDEO: 25,\n  SPAWNER_MODEL: 26,\n  SPAWNER_PDF: 27,\n  SPAWNER_AUDIO: 28,\n  //SPAWNER_TEXT: 29,\n  CAMERA: 30,\n  UNKNOWN: 31\n};\n\n// Given an origin and three object type values for URL, FILE, and CLIPBOARD\n// origins respectively, return the appropriate one\nfunction objectTypeForOrigin(contentOrigin, urlType, fileType, clipboardType, spawnerType) {\n  if (contentOrigin === ObjectContentOrigins.URL) {\n    return urlType;\n  } else if (contentOrigin === ObjectContentOrigins.FILE) {\n    return fileType;\n  } else if (contentOrigin === ObjectContentOrigins.CLIPBOARD) {\n    return clipboardType;\n  } else {\n    return spawnerType;\n  }\n}\n\n// Lookup table of mime-type prefixes to the set of object types that we should use\n// for objects spawned matching their underlying Content-Type.\nconst objectTypeMimePrefixLookupMap = {\n  \"image/\": [ObjectTypes.URL_IMAGE, ObjectTypes.FILE_IMAGE, ObjectTypes.CLIPBOARD_IMAGE, ObjectTypes.SPAWNER_IMAGE],\n  \"model/\": [ObjectTypes.URL_MODEL, ObjectTypes.FILE_MODEL, ObjectTypes.CLIPBOARD_MODEL, ObjectTypes.SPAWNER_MODEL],\n  \"application/x-zip-compressed\": [\n    ObjectTypes.URL_MODEL,\n    ObjectTypes.FILE_MODEL,\n    ObjectTypes.CLIPBOARD_MODEL,\n    ObjectTypes.SPAWNER_MODEL\n  ],\n  \"video/\": [ObjectTypes.URL_VIDEO, ObjectTypes.FILE_VIDEO, ObjectTypes.CLIPBOARD_VIDEO, ObjectTypes.SPAWNER_VIDEO],\n  \"application/vnd.apple.mpegurl\": [\n    ObjectTypes.URL_VIDEO,\n    ObjectTypes.FILE_VIDEO,\n    ObjectTypes.CLIPBOARD_VIDEO,\n    ObjectTypes.SPAWNER_VIDEO\n  ],\n  \"application/x-mpegurl\": [\n    ObjectTypes.URL_VIDEO,\n    ObjectTypes.FILE_VIDEO,\n    ObjectTypes.CLIPBOARD_VIDEO,\n    ObjectTypes.SPAWNER_VIDEO\n  ],\n  \"audio/\": [ObjectTypes.URL_AUDIO, ObjectTypes.FILE_AUDIO, ObjectTypes.CLIPBOARD_AUDIO, ObjectTypes.SPAWNER_AUDIO],\n  \"application/pdf\": [ObjectTypes.URL_PDF, ObjectTypes.FILE_PDF, ObjectTypes.CLIPBOARD_PDF, ObjectTypes.SPAWNER_PDF]\n};\n\nconst srcSuffixLookupMap = {\n  \".m3u8\": [ObjectTypes.URL_VIDEO, ObjectTypes.FILE_VIDEO, ObjectTypes.CLIPBOARD_VIDEO, ObjectTypes.SPAWNER_VIDEO]\n};\n\n// Given an content origin and the resolved mime type of a piece of content, return\n// the ObjectType, if any, for that content.\nexport function objectTypeForOriginAndContentType(contentOrigin, contentType, src) {\n  for (const prefix in objectTypeMimePrefixLookupMap) {\n    if (contentType.toLowerCase().startsWith(prefix)) {\n      const types = objectTypeMimePrefixLookupMap[prefix];\n      return objectTypeForOrigin(contentOrigin, ...types);\n    }\n  }\n\n  if (src) {\n    for (const suffix in srcSuffixLookupMap) {\n      if (src.toLowerCase().endsWith(suffix)) {\n        const types = srcSuffixLookupMap[suffix];\n        return objectTypeForOrigin(contentOrigin, ...types);\n      }\n    }\n  }\n\n  return ObjectTypes.UNKNOWN;\n}\n","import Raven from \"raven-js\";\n\nconst ga = window.ga;\n\nexport default function registerTelemetry(trackedPage, trackedTitle) {\n  const sentryDsn = process.env.SENTRY_DSN;\n  const gaTrackingId = process.env.GA_TRACKING_ID;\n\n  if (sentryDsn) {\n    console.log(\"Tracking: Sentry DSN: \" + sentryDsn);\n    Raven.config(sentryDsn).install();\n  }\n\n  if (ga && gaTrackingId) {\n    console.log(\"Tracking: Google Analytics ID: \" + gaTrackingId);\n\n    ga(\"create\", gaTrackingId, \"auto\");\n\n    if (trackedPage) {\n      ga(\"set\", \"page\", trackedPage);\n    }\n\n    if (trackedTitle) {\n      ga(\"set\", \"title\", trackedTitle);\n    }\n\n    ga(\"send\", \"pageview\");\n  }\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nexport const ReactAudioContext = React.createContext({});\n\nexport const hudHoverSound = \"play_sound-hud_hover_start\";\n\nexport const WithHoverSound = ({ sound, children }) => {\n  return (\n    <ReactAudioContext.Consumer>\n      {context => {\n        return React.cloneElement(children, {\n          onMouseEnter: e => {\n            if (context && context.playSound) {\n              context.playSound(sound || hudHoverSound);\n            }\n            children.props.onMouseEnter && children.props.onMouseEnter(e);\n          }\n        });\n      }}\n    </ReactAudioContext.Consumer>\n  );\n};\n\nWithHoverSound.propTypes = {\n  children: PropTypes.object,\n  sound: PropTypes.string\n};\n","export default function nextTick() {\n  return new Promise(resolve => {\n    setTimeout(resolve, 0);\n  });\n}\n","import { objectTypeForOriginAndContentType } from \"../object-types\";\nimport { getReticulumFetchUrl } from \"./phoenix-utils\";\nimport mediaHighlightFrag from \"./media-highlight-frag.glsl\";\nimport { mapMaterials } from \"./material-utils\";\n\nconst nonCorsProxyDomains = (process.env.NON_CORS_PROXY_DOMAINS || \"\").split(\",\");\nif (process.env.CORS_PROXY_SERVER) {\n  nonCorsProxyDomains.push(process.env.CORS_PROXY_SERVER);\n}\nconst mediaAPIEndpoint = getReticulumFetchUrl(\"/api/v1/media\");\n\nconst commonKnownContentTypes = {\n  gltf: \"model/gltf\",\n  glb: \"model/gltf-binary\",\n  png: \"image/png\",\n  jpg: \"image/jpeg\",\n  jpeg: \"image/jpeg\",\n  pdf: \"application/pdf\",\n  mp4: \"video/mp4\",\n  mp3: \"audio/mpeg\"\n};\n\nconst PHYSICS_CONSTANTS = require(\"aframe-physics-system/src/constants\"),\n  SHAPE = PHYSICS_CONSTANTS.SHAPE,\n  FIT = PHYSICS_CONSTANTS.FIT;\n\n// thanks to https://developer.mozilla.org/en-US/docs/Web/API/WindowBase64/Base64_encoding_and_decoding\nfunction b64EncodeUnicode(str) {\n  // first we use encodeURIComponent to get percent-encoded UTF-8, then we convert the percent-encodings\n  // into raw bytes which can be fed into btoa.\n  const CHAR_RE = /%([0-9A-F]{2})/g;\n  return btoa(encodeURIComponent(str).replace(CHAR_RE, (_, p1) => String.fromCharCode(\"0x\" + p1)));\n}\n\nconst farsparkEncodeUrl = url => {\n  // farspark doesn't know how to read '=' base64 padding characters\n  // translate base64 + to - and / to _ for URL safety\n  return b64EncodeUnicode(url)\n    .replace(/=+$/g, \"\")\n    .replace(/\\+/g, \"-\")\n    .replace(/\\//g, \"_\");\n};\n\nexport const scaledThumbnailUrlFor = (url, width, height) => {\n  if (\n    process.env.RETICULUM_SERVER &&\n    process.env.RETICULUM_SERVER.includes(\"hubs.local\") &&\n    url.includes(\"hubs.local\")\n  ) {\n    return url;\n  }\n\n  return `https://${process.env.FARSPARK_SERVER}/thumbnail/${farsparkEncodeUrl(url)}?w=${width}&h=${height}`;\n};\n\nexport const proxiedUrlFor = (url, index = null) => {\n  if (!(url.startsWith(\"http:\") || url.startsWith(\"https:\"))) return url;\n\n  const hasIndex = index !== null;\n\n  if (!hasIndex) {\n    // Skip known domains that do not require CORS proxying.\n    try {\n      const parsedUrl = new URL(url);\n      if (nonCorsProxyDomains.find(domain => parsedUrl.hostname.endsWith(domain))) return url;\n    } catch (e) {\n      // Ignore\n    }\n  }\n\n  if (hasIndex || !process.env.CORS_PROXY_SERVER) {\n    const method = hasIndex ? \"extract\" : \"raw\";\n    return `https://${process.env.FARSPARK_SERVER}/0/${method}/0/0/0/${index || 0}/${farsparkEncodeUrl(url)}`;\n  } else {\n    return `https://${process.env.CORS_PROXY_SERVER}/${url}`;\n  }\n};\n\nconst resolveUrlCache = new Map();\nexport const resolveUrl = async (url, index) => {\n  const cacheKey = `${url}|${index}`;\n  if (resolveUrlCache.has(cacheKey)) return resolveUrlCache.get(cacheKey);\n  const resolved = await fetch(mediaAPIEndpoint, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({ media: { url, index } })\n  }).then(r => r.json());\n  resolveUrlCache.set(cacheKey, resolved);\n  return resolved;\n};\n\nexport const getCustomGLTFParserURLResolver = gltfUrl => url => {\n  if (typeof url !== \"string\" || url === \"\") return \"\";\n  if (/^(https?:)?\\/\\//i.test(url)) return url;\n  if (/^data:.*,.*$/i.test(url)) return url;\n  if (/^blob:.*$/i.test(url)) return url;\n\n  if (process.env.CORS_PROXY_SERVER) {\n    // For absolute paths with a CORS proxied gltf URL, re-write the url properly to be proxied\n    const corsProxyPrefix = `https://${process.env.CORS_PROXY_SERVER}/`;\n\n    if (gltfUrl.startsWith(corsProxyPrefix)) {\n      const originalUrl = decodeURIComponent(gltfUrl.substring(corsProxyPrefix.length));\n      const originalUrlParts = originalUrl.split(\"/\");\n\n      // Drop the .gltf filename\n      const path = new URL(url).pathname;\n      const assetUrl = originalUrlParts.slice(0, originalUrlParts.length - 1).join(\"/\") + \"/\" + path;\n      return corsProxyPrefix + assetUrl;\n    }\n  }\n\n  return url;\n};\n\nexport const guessContentType = url => {\n  if (url.startsWith(\"hubs://\") && url.endsWith(\"/video\")) return \"video/vnd.hubs-webrtc\";\n  const extension = new URL(url).pathname.split(\".\").pop();\n  return commonKnownContentTypes[extension];\n};\n\nexport const upload = file => {\n  const formData = new FormData();\n  formData.append(\"media\", file);\n  formData.append(\"promotion_mode\", \"with_token\");\n  return fetch(mediaAPIEndpoint, {\n    method: \"POST\",\n    body: formData\n  }).then(r => r.json());\n};\n\n// https://stackoverflow.com/questions/7584794/accessing-jpeg-exif-rotation-data-in-javascript-on-the-client-side/32490603#32490603\nfunction getOrientation(file, callback) {\n  const reader = new FileReader();\n  reader.onload = function(e) {\n    const view = new DataView(e.target.result);\n    if (view.getUint16(0, false) != 0xffd8) {\n      return callback(-2);\n    }\n    const length = view.byteLength;\n    let offset = 2;\n    while (offset < length) {\n      if (view.getUint16(offset + 2, false) <= 8) return callback(-1);\n      const marker = view.getUint16(offset, false);\n      offset += 2;\n      if (marker == 0xffe1) {\n        if (view.getUint32((offset += 2), false) != 0x45786966) {\n          return callback(-1);\n        }\n\n        const little = view.getUint16((offset += 6), false) == 0x4949;\n        offset += view.getUint32(offset + 4, little);\n        const tags = view.getUint16(offset, little);\n        offset += 2;\n        for (let i = 0; i < tags; i++) {\n          if (view.getUint16(offset + i * 12, little) == 0x0112) {\n            return callback(view.getUint16(offset + i * 12 + 8, little));\n          }\n        }\n      } else if ((marker & 0xff00) != 0xff00) {\n        break;\n      } else {\n        offset += view.getUint16(offset, false);\n      }\n    }\n    return callback(-1);\n  };\n  reader.readAsArrayBuffer(file);\n}\n\nlet interactableId = 0;\nexport const addMedia = (src, template, contentOrigin, resolve = false, resize = false, animate = true) => {\n  const scene = AFRAME.scenes[0];\n\n  const entity = document.createElement(\"a-entity\");\n  entity.id = \"interactable-media-\" + interactableId++;\n  entity.setAttribute(\"networked\", { template: template });\n  const needsToBeUploaded = src instanceof File;\n  entity.setAttribute(\"media-loader\", {\n    resize,\n    resolve,\n    animate,\n    src: typeof src === \"string\" ? src : \"\",\n    fileIsOwned: !needsToBeUploaded\n  });\n\n  entity.object3D.matrixNeedsUpdate = true;\n\n  scene.appendChild(entity);\n\n  const fireLoadingTimeout = setTimeout(() => {\n    scene.emit(\"media-loading\", { src: src });\n  }, 100);\n\n  [\"model-loaded\", \"video-loaded\", \"image-loaded\"].forEach(eventName => {\n    entity.addEventListener(\n      eventName,\n      async () => {\n        clearTimeout(fireLoadingTimeout);\n        scene.emit(\"media-loaded\", { src: src });\n      },\n      { once: true }\n    );\n  });\n\n  const orientation = new Promise(function(resolve) {\n    if (needsToBeUploaded) {\n      getOrientation(src, x => {\n        resolve(x);\n      });\n    } else {\n      resolve(1);\n    }\n  });\n  if (needsToBeUploaded) {\n    upload(src)\n      .then(response => {\n        const srcUrl = new URL(response.raw);\n        srcUrl.searchParams.set(\"token\", response.meta.access_token);\n        entity.setAttribute(\"media-loader\", { resolve: false, src: srcUrl.href, fileId: response.file_id });\n        window.APP.store.update({\n          uploadPromotionTokens: [{ fileId: response.file_id, promotionToken: response.meta.promotion_token }]\n        });\n      })\n      .catch(e => {\n        console.error(\"Media upload failed\", e);\n        entity.setAttribute(\"media-loader\", { src: \"error\" });\n      });\n  } else if (src instanceof MediaStream) {\n    entity.setAttribute(\"media-loader\", { src: `hubs://clients/${NAF.clientId}/video` });\n  }\n\n  if (contentOrigin) {\n    entity.addEventListener(\"media_resolved\", ({ detail }) => {\n      const objectType = objectTypeForOriginAndContentType(contentOrigin, detail.contentType, detail.src);\n      scene.emit(\"object_spawned\", { objectType });\n    });\n  }\n\n  return { entity, orientation };\n};\n\nexport function injectCustomShaderChunks(obj) {\n  const vertexRegex = /\\bskinning_vertex\\b/;\n  const fragRegex = /\\bgl_FragColor\\b/;\n  const validMaterials = [\"MeshStandardMaterial\", \"MeshBasicMaterial\", \"MobileStandardMaterial\"];\n\n  const shaderUniforms = [];\n\n  obj.traverse(object => {\n    if (!object.material) return;\n\n    object.material = mapMaterials(object, material => {\n      if (!validMaterials.includes(material.type)) {\n        return material;\n      }\n\n      // HACK, this routine inadvertently leaves the A-Frame shaders wired to the old, dark\n      // material, so maps cannot be updated at runtime. This breaks UI elements who have\n      // hover/toggle state, so for now just skip these while we figure out a more correct\n      // solution.\n      if (object.el.classList.contains(\"ui\")) return material;\n      if (object.el.classList.contains(\"hud\")) return material;\n      if (object.el.getAttribute(\"text-button\")) return material;\n\n      const newMaterial = material.clone();\n      newMaterial.onBeforeCompile = shader => {\n        if (!vertexRegex.test(shader.vertexShader)) return;\n\n        shader.uniforms.hubs_IsFrozen = { value: false };\n        shader.uniforms.hubs_EnableSweepingEffect = { value: false };\n        shader.uniforms.hubs_SweepParams = { value: [0, 0] };\n        shader.uniforms.hubs_InteractorOnePos = { value: [0, 0, 0] };\n        shader.uniforms.hubs_InteractorTwoPos = { value: [0, 0, 0] };\n        shader.uniforms.hubs_HighlightInteractorOne = { value: false };\n        shader.uniforms.hubs_HighlightInteractorTwo = { value: false };\n        shader.uniforms.hubs_Time = { value: 0 };\n\n        const vchunk = `\n        if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\n          vec4 wt = modelMatrix * vec4(transformed, 1);\n\n          // Used in the fragment shader below.\n          hubs_WorldPosition = wt.xyz;\n        }\n      `;\n\n        const vlines = shader.vertexShader.split(\"\\n\");\n        const vindex = vlines.findIndex(line => vertexRegex.test(line));\n        vlines.splice(vindex + 1, 0, vchunk);\n        vlines.unshift(\"varying vec3 hubs_WorldPosition;\");\n        vlines.unshift(\"uniform bool hubs_IsFrozen;\");\n        vlines.unshift(\"uniform bool hubs_HighlightInteractorOne;\");\n        vlines.unshift(\"uniform bool hubs_HighlightInteractorTwo;\");\n        shader.vertexShader = vlines.join(\"\\n\");\n\n        const flines = shader.fragmentShader.split(\"\\n\");\n        const findex = flines.findIndex(line => fragRegex.test(line));\n        flines.splice(findex + 1, 0, mediaHighlightFrag);\n        flines.unshift(\"varying vec3 hubs_WorldPosition;\");\n        flines.unshift(\"uniform bool hubs_IsFrozen;\");\n        flines.unshift(\"uniform bool hubs_EnableSweepingEffect;\");\n        flines.unshift(\"uniform vec2 hubs_SweepParams;\");\n        flines.unshift(\"uniform bool hubs_HighlightInteractorOne;\");\n        flines.unshift(\"uniform vec3 hubs_InteractorOnePos;\");\n        flines.unshift(\"uniform bool hubs_HighlightInteractorTwo;\");\n        flines.unshift(\"uniform vec3 hubs_InteractorTwoPos;\");\n        flines.unshift(\"uniform float hubs_Time;\");\n        shader.fragmentShader = flines.join(\"\\n\");\n\n        shaderUniforms.push(shader.uniforms);\n      };\n      newMaterial.needsUpdate = true;\n      return newMaterial;\n    });\n  });\n\n  return shaderUniforms;\n}\n\nexport function getPromotionTokenForFile(fileId) {\n  return window.APP.store.state.uploadPromotionTokens.find(upload => upload.fileId === fileId);\n}\n\nexport const traverseMeshesAndAddShapes = (function() {\n  const vertexLimit = 200000;\n  const shapePrefix = \"ammo-shape__\";\n  const shapes = [];\n  return function(el) {\n    const meshRoot = el.object3DMap.mesh;\n    while (shapes.length > 0) {\n      const { id, entity } = shapes.pop();\n      entity.removeAttribute(id);\n    }\n\n    let vertexCount = 0;\n    meshRoot.traverse(o => {\n      if (\n        o.isMesh &&\n        (!THREE.Sky || o.__proto__ != THREE.Sky.prototype) &&\n        o.name !== \"Floor_Plan\" &&\n        o.name !== \"Ground_Plane\"\n      ) {\n        vertexCount += o.geometry.attributes.position.count;\n      }\n    });\n\n    console.group(\"traverseMeshesAndAddShapes\");\n\n    console.log(`scene has ${vertexCount} vertices from meshes`);\n\n    const floorPlan = meshRoot.children.find(obj => {\n      return obj.name === \"Floor_Plan\";\n    });\n    if ((vertexCount > vertexLimit || vertexCount === 0) && floorPlan) {\n      console.log(`vertex limit of ${vertexLimit} exceeded, using floor plan with mesh shape`);\n      floorPlan.el.setAttribute(shapePrefix + floorPlan.name, {\n        type: SHAPE.MESH,\n        margin: 0.01,\n        fit: FIT.ALL\n      });\n      shapes.push({ id: shapePrefix + floorPlan.name, entity: floorPlan.el });\n    } else if (vertexCount < vertexLimit && vertexCount > 0) {\n      el.setAttribute(shapePrefix + \"environment\", {\n        type: SHAPE.MESH,\n        margin: 0.01,\n        fit: FIT.ALL\n      });\n      shapes.push({ id: shapePrefix + \"environment\", entity: el });\n      console.log(\"adding compound mesh shape\");\n    } else {\n      el.setAttribute(shapePrefix + \"defaultFloor\", {\n        type: SHAPE.BOX,\n        margin: 0.01,\n        halfExtents: { x: 4000, y: 0.5, z: 4000 },\n        offset: { x: 0, y: -0.5, z: 0 },\n        fit: FIT.MANUAL\n      });\n      shapes.push({ id: shapePrefix + \"defaultFloor\", entity: el });\n      console.log(\"adding default floor collision\");\n    }\n    console.groupEnd();\n  };\n})();\n\nconst mediaPos = new THREE.Vector3();\n\nexport function spawnMediaAround(el, media, snapCount, mirrorOrientation = false) {\n  const { entity, orientation } = addMedia(media, \"#interactable-media\", undefined, false);\n\n  const pos = el.object3D.position;\n\n  entity.object3D.position.set(pos.x, pos.y, pos.z);\n  entity.object3D.rotation.copy(el.object3D.rotation);\n\n  if (mirrorOrientation) {\n    entity.object3D.rotateY(Math.PI);\n  }\n\n  // Generate photos in a circle around camera, starting from the bottom.\n  // Prevent z-fighting but place behind viewfinder\n  const idx = (snapCount % 6) + 3;\n\n  mediaPos.set(\n    Math.cos(Math.PI * 2 * (idx / 6.0)) * 0.75,\n    Math.sin(Math.PI * 2 * (idx / 6.0)) * 0.75,\n    -0.05 + idx * 0.001\n  );\n\n  el.object3D.localToWorld(mediaPos);\n  entity.object3D.visible = false;\n\n  entity.addEventListener(\n    \"image-loaded\",\n    () => {\n      entity.object3D.visible = true;\n      entity.setAttribute(\"animation__photo_pos\", {\n        property: \"position\",\n        dur: 800,\n        from: { x: pos.x, y: pos.y, z: pos.z },\n        to: { x: mediaPos.x, y: mediaPos.y, z: mediaPos.z },\n        easing: \"easeOutElastic\"\n      });\n    },\n    { once: true }\n  );\n\n  entity.object3D.matrixNeedsUpdate = true;\n\n  entity.addEventListener(\n    \"media_resolved\",\n    () => {\n      el.emit(\"photo_taken\", entity.components[\"media-loader\"].data.src);\n    },\n    { once: true }\n  );\n\n  return { entity, orientation };\n}\n\nconst hubsSceneRegex = /https?:\\/\\/(hubs.local(:\\d+)?|(smoke-)?hubs.mozilla.com)\\/scenes\\/(\\w+)\\/?\\S*/;\nconst hubsRoomRegex = /https?:\\/\\/(hubs.local(:\\d+)?|(smoke-)?hubs.mozilla.com)\\/(\\w+)\\/?\\S*/;\nexport const isHubsSceneUrl = hubsSceneRegex.test.bind(hubsSceneRegex);\nexport const isHubsRoomUrl = url => !isHubsSceneUrl(url) && hubsRoomRegex.test(url);\nexport const isHubsDestinationUrl = url => isHubsSceneUrl(url) || isHubsRoomUrl(url);\n"],"sourceRoot":""}