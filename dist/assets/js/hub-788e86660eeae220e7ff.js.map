{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/assets/stylesheets/media-browser.scss?0be5","webpack:///./src/utils/next-tick.js","webpack:///./src/utils/resizeShadowCameraFrustum.js","webpack:///./src/components/directional-light.js","webpack:///./src/components/layers.js","webpack:///./src/components/loop-animation.js","webpack:///./src/components/media-loader.js","webpack:///./src/components/quack.js","webpack:///./src/components/scene-preview-camera.js","webpack:///./src/components/skybox.js","webpack:///./src/components/spawn-controller.js","webpack:///./src/components/super-spawner.js","webpack:///./src/components/water.js","webpack:///./src/components/particle-emitter.js","webpack:///./src/utils/component-mappings.js","webpack:///./src/gltf-component-mappings.js","webpack:///./src/utils/phoenix-utils.js","webpack:///./src/assets/images/logo.svg","webpack:///./src/assets/stylesheets/loader.scss?288f","webpack:///./src/assets/images/giphy_logo.png","webpack:///./src/assets/stylesheets/message-entry.scss?0102","webpack:///./src/utils/media-url-utils.js","webpack:///./src/assets/images/media-error.gif","webpack:///./src/assets/camera_tool.glb","webpack:///./src/assets/images/mic_granted.png","webpack:///./src/assets/images/mic_granted@2x.png","webpack:///./src/assets/images/mic_small.png","webpack:///./src/assets/images/mic_small@2x.png","webpack:///./src/assets/images/dropdown_arrow.png","webpack:///./src/assets/images/dropdown_arrow@2x.png","webpack:///./src/assets/images/add-owner.png","webpack:///./src/assets/images/remove-owner.png","webpack:///./src/assets/images/mobile_screen_entry.svg","webpack:///./src/assets/images/desktop_screen_entry.svg","webpack:///./src/assets/images/generic_vr_entry.svg","webpack:///./src/assets/images/gearvr_entry.svg","webpack:///./src/assets/images/daydream_entry.svg","webpack:///./src/assets/stylesheets/avatar-url-dialog.scss?3a38","webpack:///./src/assets/images/link_dialog_header.svg","webpack:///./src/assets/stylesheets/feedback-dialog.scss?48e3","webpack:///./src/assets/stylesheets/leave-room-dialog.scss?9cfa","webpack:///./src/utils/history.js","webpack:///./src/assets/images/presence_phone.png","webpack:///./src/assets/images/presence_desktop.png","webpack:///./src/assets/images/presence_discord.png","webpack:///./src/assets/images/presence_camera.png","webpack:///./src/assets/images/presence_vr.png","webpack:///./src/assets/stylesheets/avatar-editor.scss?b806","webpack:///./src/assets/images/level_background.png","webpack:///./src/assets/images/level_background@2x.png","webpack:///./src/assets/images/level_fill.png","webpack:///./src/assets/images/level_fill@2x.png","webpack:///./src/assets/images/mic_level.png","webpack:///./src/assets/images/mic_level@2x.png","webpack:///./src/assets/images/level_action_background.png","webpack:///./src/assets/images/level_action_background@2x.png","webpack:///./src/assets/images/level_action_fill.png","webpack:///./src/assets/images/level_action_fill@2x.png","webpack:///./src/assets/images/speaker_level.png","webpack:///./src/assets/images/speaker_level@2x.png","webpack:///./src/assets/sfx/tone.webm","webpack:///./src/assets/sfx/tone.mp3","webpack:///./src/assets/sfx/tone.ogg","webpack:///./src/assets/sfx/tone.wav","webpack:///./src/assets/images/change_avatar.svg","webpack:///./src/assets/stylesheets/spectating-label.scss?4b63","webpack:///./src/systems/render-manager/unlit-batch.vert","webpack:///./src/systems/render-manager/unlit-batch.frag","webpack:///./src/assets/images/spritesheets/sprite-system-spritesheet.png","webpack:///./src/systems/sprites/sprite.vert","webpack:///./src/systems/sprites/sprite.frag","webpack:///./src/assets/sfx/tick.mp3","webpack:///./src/assets/stylesheets/profile.scss?02af","webpack:///./src/assets/images/spritesheets/css-spritesheet.css?399b","webpack:///./src/utils/avatar-utils.js","webpack:///./src/utils/fullscreen.js","webpack:///./src/assets/stylesheets/room-info-dialog.scss?711f","webpack:///./src/assets/stylesheets/tweet-dialog.scss?1649","webpack:///./src/materials/MobileStandardMaterial.js","webpack:///./src/storage/media-search-store.js","webpack:///./src/assets/stylesheets/hub.scss?ad84","webpack:///./src/utils/async-utils.js","webpack:///./src/assets/stylesheets/sign-in-dialog.scss?f596","webpack:///./src/react-components/state-link.js","webpack:///./src/utils/audio-context-fix.js","webpack:///./src/utils/threejs-positional-audio-updatematrixworld.js","webpack:///./src/components/bone-mute-state-indicator.js","webpack:///./src/components/bone-visibility.js","webpack:///./src/components/offset-relative-to.js","webpack:///./src/components/hud-controller.js","webpack:///./src/components/icon-button.js","webpack:///./src/components/text-button.js","webpack:///./src/components/block-button.js","webpack:///./src/components/mute-button.js","webpack:///./src/components/kick-button.js","webpack:///./src/components/close-vr-notice-button.js","webpack:///./src/components/leave-room-button.js","webpack:///./src/components/visible-if-permitted.js","webpack:///./src/components/visibility-on-content-type.js","webpack:///./src/components/hide-when-pinned-and-forbidden.js","webpack:///./src/components/networked-avatar.js","webpack:///./src/components/pinnable.js","webpack:///./src/components/drop-object-button.js","webpack:///./src/components/remove-networked-object-button.js","webpack:///./src/components/camera-focus-button.js","webpack:///./src/components/visible-to-owner.js","webpack:///./src/components/emit-state-change.js","webpack:///./src/components/action-to-event.js","webpack:///./src/components/action-to-remove.js","webpack:///./src/components/emit-scene-event-on-remove.js","webpack:///./src/components/follow-in-fov.js","webpack:///./src/components/matrix-auto-update.js","webpack:///./src/components/tweet-media-button.js","webpack:///./src/components/hover-menu.js","webpack:///./src/components/disable-frustum-culling.js","webpack:///./src/components/set-active-camera.js","webpack:///./src/components/track-pose.js","webpack:///./src/components/replay.js","webpack:///./src/components/visibility-by-path.js","webpack:///./src/components/tags.js","webpack:///./src/components/billboard.js","webpack:///./src/components/periodic-full-syncs.js","webpack:///./src/components/gltf-model-plus.js","webpack:///./src/utils/promisify-worker.js","webpack:///./src/systems/frame-scheduler.js","webpack:///./src/systems/app-mode.js","webpack:///./src/systems/permissions.js","webpack:///./src/systems/exit-on-blur.js","webpack:///./src/systems/userinput/paths.js","webpack:///./src/assets/stylesheets/presence-list.scss?0256","webpack:///./src/components/owned-object-limiter.js","webpack:///./src/components/set-unowned-body-kinematic.js","webpack:///./src/components/networked-counter.js","webpack:///./src/components/set-yxz-order.js","webpack:///./src/components/nav-mesh-helper.js","webpack:///./src/components/tools/drawing-manager.js","webpack:///./src/components/hoverable-visuals.js","webpack:///./src/components/virtual-gamepad-controls.css?9949","webpack:///./src/assets/stylesheets/create-object-dialog.scss?63e4","webpack:///./src/assets/stylesheets/link-dialog.scss?7296","webpack:///./src/react-components/dialog-container.js","webpack:///./src/constants.js","webpack:///./src/components/mute-mic.js","webpack:///./src/components/toggle-megaphone.js","webpack:///./src/components/toggle-flying.js","webpack:///./src/components/in-world-hud.js","webpack:///./src/components/virtual-gamepad-controls.js","webpack:///./src/components/ik-controller.js","webpack:///./src/components/hand-controls2.js","webpack:///./src/components/character-controller.js","webpack:///./src/components/hover-visuals.js","webpack:///./src/components/player-info.js","webpack:///./src/everyspace/defaults.js","webpack:///./src/components/hand-poses.js","webpack:///./src/components/freeze-controller.js","webpack:///./src/components/visibility-while-frozen.js","webpack:///./src/components/stats-plus.js","webpack:///./src/components/media-views.js","webpack:///./src/components/avatar-volume-controls.js","webpack:///./src/components/pinch-to-move.js","webpack:///./src/components/pitch-yaw-rotator.js","webpack:///./src/components/position-at-box-shape-border.js","webpack:///./src/components/pin-networked-object-button.js","webpack:///./src/components/unmute-video-button.js","webpack:///./src/components/destroy-at-extreme-distances.js","webpack:///./src/components/camera-tool.js","webpack:///./src/components/clone-media-button.js","webpack:///./src/components/open-media-button.js","webpack:///./src/components/transform-object-button.js","webpack:///./src/components/teleporter.js","webpack:///./src/components/hubs-text.js","webpack:///./src/systems/userinput/sets.js","webpack:///./src/utils/vr-caps-detect.js","webpack:///./src/utils/share.js","webpack:///./src/react-components/state-route.js","webpack:///./src/react-components/promote-client-dialog.js","webpack:///./src/react-components/client-info-dialog.js","webpack:///./src/react-components/loader.js","webpack:///./src/react-components/auto-exit-warning.js","webpack:///./src/react-components/entry-buttons.js","webpack:///./src/react-components/profile-entry-panel.js","webpack:///./src/react-components/media-browser.js","webpack:///./src/react-components/create-object-dialog.js","webpack:///./src/react-components/change-scene-dialog.js","webpack:///./src/react-components/avatar-url-dialog.js","webpack:///./src/react-components/help-dialog.js","webpack:///./src/react-components/invite-dialog.js","webpack:///./src/react-components/invite-team-dialog.js","webpack:///./src/react-components/link-dialog.js","webpack:///./src/react-components/safari-dialog.js","webpack:///./src/react-components/safari-mic-dialog.js","webpack:///./src/react-components/room-settings-dialog.js","webpack:///./src/react-components/close-room-dialog.js","webpack:///./src/systems/tips.js","webpack:///./src/react-components/tip.js","webpack:///./src/react-components/webrtc-screenshare-unsupported-dialog.js","webpack:///./src/react-components/webassembly-unsupported-dialog.js","webpack:///./src/react-components/webvr-recommend-dialog.js","webpack:///./src/react-components/feedback-dialog.js","webpack:///./src/react-components/leave-room-dialog.js","webpack:///./src/react-components/room-info-dialog.js","webpack:///./src/react-components/oauth-dialog.js","webpack:///./src/react-components/tweet-dialog.js","webpack:///./src/react-components/lobby-chat-box.js","webpack:///./src/react-components/chat-command-help.js","webpack:///./src/utils/serialize-element.js","webpack:///./src/react-components/presence-list.js","webpack:///./src/react-components/chat-message.js","webpack:///./src/react-components/in-world-chat-box.js","webpack:///./src/react-components/avatar-editor.js","webpack:///./src/react-components/mic-level-widget.js","webpack:///./src/react-components/output-level-widget.js","webpack:///./src/react-components/photo-message.js","webpack:///./src/react-components/video-message.js","webpack:///./src/react-components/image-message.js","webpack:///./src/react-components/presence-log.js","webpack:///./src/react-components/settings-menu.js","webpack:///./src/react-components/preload-overlay.js","webpack:///./src/react-components/2d-hud.js","webpack:///./src/react-components/spectating-label.js","webpack:///./src/utils/vr-interstitial.js","webpack:///./src/react-components/ui-root.js","webpack:///./src/utils/hub-channel.js","webpack:///./src/utils/physics-utils.js","webpack:///./src/message-dispatch.js","webpack:///./src/scene-entry-manager.js","webpack:///./src/utils/pinned-entity-to-gltf.js","webpack:///./src/subscriptions.js","webpack:///./src/systems/personal-space-bubble.js","webpack:///./src/systems/camera-tools.js","webpack:///./src/systems/userinput/devices/mouse.js","webpack:///./src/systems/userinput/array-backed-set.js","webpack:///./src/systems/userinput/devices/keyboard.js","webpack:///./src/systems/userinput/devices/hud.js","webpack:///./src/systems/userinput/devices/xbox-controller.js","webpack:///./src/systems/userinput/pose.js","webpack:///./src/systems/userinput/arm-model.js","webpack:///./src/systems/userinput/devices/copy-sitting-to-standing-transform.js","webpack:///./src/systems/userinput/devices/oculus-go-controller.js","webpack:///./src/systems/userinput/devices/gear-vr-controller.js","webpack:///./src/systems/userinput/devices/oculus-touch-controller.js","webpack:///./src/systems/userinput/devices/daydream-controller.js","webpack:///./src/systems/userinput/devices/vive-controller.js","webpack:///./src/systems/userinput/devices/windows-mixed-reality-controller.js","webpack:///./src/systems/userinput/devices/gyro.js","webpack:///./src/systems/interactions.js","webpack:///./src/systems/userinput/devices/app-aware-mouse.js","webpack:///./src/systems/userinput/devices/touchscreen/assignments.js","webpack:///./src/systems/userinput/devices/app-aware-touchscreen.js","webpack:///./src/systems/userinput/bindings/xforms.js","webpack:///./src/utils/dpad.js","webpack:///./src/systems/userinput/bindings/utils.js","webpack:///./src/systems/userinput/bindings/keyboard-mouse-user.js","webpack:///./src/systems/userinput/bindings/touchscreen-user.js","webpack:///./src/systems/userinput/bindings/keyboard-debugging.js","webpack:///./src/systems/userinput/bindings/oculus-touch-user.js","webpack:///./src/systems/userinput/bindings/vive-user.js","webpack:///./src/systems/userinput/bindings/windows-mixed-reality-user.js","webpack:///./src/systems/userinput/bindings/xbox-controller-user.js","webpack:///./src/systems/userinput/bindings/daydream-user.js","webpack:///./src/systems/userinput/bindings/cardboard-user.js","webpack:///./src/systems/userinput/bindings/oculus-go-user.js","webpack:///./src/systems/userinput/resolve-action-sets.js","webpack:///./src/systems/userinput/devices/gamepad.js","webpack:///./src/systems/userinput/bindings/generic-gamepad.js","webpack:///./src/systems/userinput/userinput.js","webpack:///./src/systems/userinput/userinput-debug.js","webpack:///./src/systems/ui-hotkeys.js","webpack:///./src/systems/cursor-targetting-system.js","webpack:///./src/systems/constraints-system.js","webpack:///./src/systems/two-point-stretching-system.js","webpack:///./src/systems/button-systems.js","webpack:///./src/systems/hover-menu-system.js","webpack:///./src/systems/super-spawner-system.js","webpack:///./src/systems/haptic-feedback-system.js","webpack:///./src/systems/render-manager/hubs-batch-raw-uniform-group.js","webpack:///./src/systems/render-manager-system.js","webpack:///./src/systems/lobby-camera-system.js","webpack:///./src/systems/hubs-systems.js","webpack:///./src/systems/capture-system.js","webpack:///./src/systems/sprites.js","webpack:///./src/systems/post-physics.js","webpack:///./src/components/scalable-when-grabbed.js","webpack:///./src/components/cursor-controller.js","webpack:///./src/components/tools/pen.js","webpack:///./src/utils/sharedbuffergeometry.js","webpack:///./src/utils/sharedbuffergeometrymanager.js","webpack:///./src/components/tools/networked-drawing.js","webpack:///./src/network-schemas.js","webpack:///./src/hub.js","webpack:///./src/utils/concurrent-load-detector.js","webpack:///./src/utils/threejs-allocation-patches.js","webpack:///./src/components/environment-map.js","webpack:///./src/utils/media-highlight-frag.glsl","webpack:///./src/assets/images/cubemap/posx.jpg","webpack:///./src/assets/images/cubemap/negx.jpg","webpack:///./src/systems/sound-effects-system.js","webpack:///./src/assets/images/cubemap/posy.jpg","webpack:///./src/assets/images/cubemap/negy.jpg","webpack:///./src/assets/images/cubemap/posz.jpg","webpack:///./src/assets/images/cubemap/negz.jpg","webpack:///./src/utils/disable-ios-zoom.js","webpack:///./src/App.js","webpack:///./src/utils/component-utils.js","webpack:///./src/assets/stylesheets/tip.scss?ea93","webpack:///./src/loaders/HubsTextureLoader.js","webpack:///./src/utils/media-utils.js","webpack:///./src/assets/images/warning_icon.png","webpack:///./src/assets/images/warning_icon@2x.png","webpack:///./src/react-components/avatar-preview.js","webpack:///./src/react-components/sign-in-dialog.js","webpack:///./src/assets/stylesheets/client-info-dialog.scss?2a21","webpack:///./src/assets/stylesheets/room-settings-dialog.scss?5fe3","webpack:///./src/utils/qs_truthy.js","webpack:///./src/utils/scene-graph.js","webpack:///./src/utils/auto-box-collider.js","webpack:///./src/assets/stylesheets/preload-overlay.scss?4ec6","webpack:///./src/everyspace/helmet.js","webpack:///./src/assets/stylesheets/avatar-preview.scss?c714","webpack:///./src/assets/stylesheets/change-scene-dialog.scss?0c1a","webpack:///./src/everyspace/airtable.js","webpack:///./src/assets/stylesheets/oauth-dialog.scss?c704","webpack:///./src/everyspace/messages.js","webpack:///./src/everyspace/customization.js","webpack:///./src/utils/i18n.js","webpack:///./src/utils/logging.js","webpack:///./src/components/audio-feedback.js","webpack:///./src/utils/auth-channel.js","webpack:///./src/utils/animation.js","webpack:///./src/utils/three-utils.js","webpack:///./src/assets/stylesheets/presence-log.scss?bad0","webpack:///./src/assets/stylesheets/2d-hud.scss?803e","webpack:///./src/utils/material-utils.js","webpack:///./src/utils/mask-email.js","webpack:///./src/react-components/media-tiles.js","webpack:///./src/utils/webgl.js","webpack:///./src/assets/LoadingObject_Atom.glb","webpack:///./src/assets/sfx/teleport-loop.mp3","webpack:///./src/assets/sfx/quickTurn.mp3","webpack:///./src/assets/sfx/tap_mellow.mp3","webpack:///./src/assets/sfx/PenSpawn.mp3","webpack:///./src/assets/sfx/PenDraw1.mp3","webpack:///./src/assets/sfx/PicSnapHey.mp3","webpack:///./src/assets/sfx/welcome.mp3","webpack:///./src/assets/sfx/quack.mp3","webpack:///./src/assets/sfx/specialquack.mp3","webpack:///./src/assets/stylesheets/ui-root.scss?bfe5","webpack:///./src/assets/sfx/pop.mp3","webpack:///./src/assets/sfx/Eb_blip.mp3","webpack:///./src/assets/sfx/tack.mp3","webpack:///./src/assets/sfx/A_bendUp.mp3","webpack:///./src/assets/sfx/suspense.mp3","webpack:///./src/assets/waternormals.jpg","webpack:///./src/utils/crypto.js","webpack:///./src/utils/link-channel.js","webpack:///./src/assets/stylesheets/chat-command-help.scss?592c","webpack:///./src/utils/identity.js","webpack:///./src/storage/store.js","webpack:///./src/utils/focus-utils.js","webpack:///./src/assets/images/mic_denied.png","webpack:///./src/assets/stylesheets/entry.scss?b35b","webpack:///./src/assets/images/mic_denied@2x.png","webpack:///./src/assets/stylesheets/promote-client-dialog.scss?a2eb","webpack:///./src/assets/stylesheets/close-room-dialog.scss?83fa","webpack:///./src/object-types.js","webpack:///./src/assets/stylesheets/invite-dialog.scss?d073","webpack:///./src/assets/stylesheets/settings-menu.scss?dfca","webpack:///./src/assets/avatars/avatars.js","webpack:///./src/utils/debug-log.js","webpack:///./src/utils/threejs-world-update.js","webpack:///./src/components/animation.js","webpack:///./src/components/ambient-light.js","webpack:///./src/components/animation-mixer.js","webpack:///./src/components/css-class.js","webpack:///./src/telemetry.js","webpack:///./src/components/duck.js","webpack:///./src/components/heightfield.js","webpack:///./src/components/hemisphere-light.js","webpack:///./src/components/hide-when-quality.js","webpack:///./src/components/point-light.js","webpack:///./src/components/spot-light.js","webpack:///./src/components/floaty-object.js","webpack:///./src/components/trigger-volume.js","webpack:///./src/components/video-pause-state.js","webpack:///./src/components/debug.js","webpack:///./src/react-components/wrap-with-audio.js","webpack:///./src/systems/nav.js","webpack:///./src/components/event-repeater.js","webpack:///./src/utils/permissions-utils.js","webpack:///./src/utils/image-bitmap-utils.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","6","exports","module","l","e","Promise","resolve","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","oe","err","console","error","jsonpArray","window","oldJsonpFunction","slice","media-browser","mediaBrowser","facets","facet","body","pager","header-center","headerCenter","search","engine-attribution","engineAttribution","engine-attribution-contents","engineAttributionContents","favorites-header","favoritesHeader","search-clear","searchClear","search-icon","searchIcon","box","header","no-search","noSearch","nav","nav-right-pad","navRightPad","nav-source","navSource","nav-source-selected","navSourceSelected","nav-scroll-arrow","navScrollArrow","tiles","tile","info","attribution","creator","publisher","last-joined","lastJoined","tile-link","tileLink","tile-content","tileContent","avatar-tile","avatarTile","edit-avatar","editAvatar","create-tile","createTile","tiles-variable","tilesVariable","page-number","pageNumber","pager-button-disabled","pagerButtonDisabled","header-left","headerLeft","header-right","headerRight","create-button","createButton","create-link","createLink","empty-string","emptyString","media-browser-inline","mediaBrowserInline","nextTick","setTimeout","__webpack_exports__","boundingBox","THREE","Box3","frustumBox","inverseLightMatrixWorld","Matrix4","tempBox","FRUSTUM_PADDING","NEAR_CLIPPING_PLANE","FAR_CLIPPING_PLANE","verts","Vector3","AFRAME","registerComponent","schema","color","type","intensity","default","castShadow","shadowMapResolution","shadowBias","shadowRadius","init","el","this","light","DirectionalLight","position","set","target","add","setObject3D","sceneEl","systems","registerLight","rendererSystem","renderer","update","prevData","Color","applyColorCorrection","copy","shadow","bias","radius","width","height","prevWidth","prevHeight","mapSize","map","dispose","camera","matrixNeedsUpdate","tick","APP","quality","scene","makeEmpty","traverse","node","geometry","computeBoundingBox","applyMatrix4","matrixWorld","union","min","max","x","y","z","getInverse","expandByPoint","left","right","bottom","top","near","far","updateProjectionMatrix","resizeShadowCameraFrustum","object3D","remove","removeObject3D","Layers","reflection","inWorldHud","exclusive","addEventListener","oldData","obj","layers","mask","layer","entries","oldValue","newValue","enable","disable","removeEventListener","paused","clip","mixerEl","findAncestorWithComponent","updateClip","warn","currentAction","mixer","animations","components","clipName","find","action","clipAction","enabled","setLoop","LoopRepeat","Infinity","play","destroy","stop","SHAPE","require","loadingObjectEnvMap","loadingObject","GLTFLoader","load","loadingObjectSrc","gltf","batchMeshes","qsTruthy","disableBatching","fileId","fileIsOwned","src","resize","contentType","contentSubtype","animate","mediaOptions","parse","v","JSON","stringify","onError","showLoader","clearLoadingTimeout","onMediaLoaded","animating","NAF","utils","getNetworkedEntity","then","networkedEl","updateScale","center","mesh","getObject3D","getBox","scaleCoefficient","getScaleCoefficient","scale","multiplyScalar","addVectors","sub","removeShape","id","getAttribute","removeAttribute","dt","loaderMixer","loadingSoundNode","soundEffectsSystem","stopSoundNode","setAttribute","object3DMap","useFancyLoader","clone","Mesh","BoxGeometry","MeshBasicMaterial","environmentMapComponent","currentEnivronmentMap","environmentMap","applyEnvironmentMap","AnimationMixer","loadingClip","loadingScaleClip","AnimationClip","VectorKeyframeTrack","BOX","is","isMine","playSoundLooped","SOUND_MEDIA_LOADING","showLoaderTimeout","clearTimeout","updateHoverableVisuals","hoverableVisuals","injectedCustomShaderChunks","uniforms","injectCustomShaderChunks","setFromObject","getBoundingSphere","boundingSphere","physicsShape","shouldUpdateScale","playSoundOneShot","SOUND_MEDIA_LOADED","finish","minHalfExtent","repositionToolbar","addMeshScaleAnimation","initialScale","onComplete","step","lastValue","anim","animatables","Math","Number","MIN_VALUE","config","duration","easing","elasticity","loop","round","targets","complete","anime","_this","_asyncToGenerator","thumbnail","canonicalUrl","accessibleUrl","resolveUrl","origin","startsWith","location","protocol","meta","expected_content_type","proxiedUrlFor","guessContentType","url","fetch","method","headers","fetchContentType","emit","raw","material","isHLS","parsedUrl","URL","qsTime","parseInt","searchParams","startTime","URLSearchParams","hash","substring","reduceAngularFloat","releaseGravity","detail","projection","once","assign","time","dirs","template","batch","includes","HULL","addAnimationComponents","inflate","modelToWorldScale","Error","mayChangeScene","permissions","can","isHubsAvatarUrl","isHubsRoomUrl","isHubsSceneUrl","index","maxIndex","_this2","toolbar","onNext","onPrev","_ensureUI","_this3","hasSetupUI","document","getElementById","querySelector","appendChild","importNode","content","nextButton","prevButton","pageLabel","_this4","parentNode","removeChild","takeOwnership","newIndex","quackPercentage","specialQuackPercentage","_handleGrabStart","pause","rand","random","SOUND_SPECIAL_QUACK","SOUND_QUACK","lerp","start","end","newRot","Quaternion","positionOnly","startPoint","startRotation","quaternion","targetPoint","targetRotDelta","Euler","targetRotation","setFromEuler","premultiply","performance","now","backwards","ranOnePass","tick2","streamerCamera","streamer","getCurrentStreamer","getStreamerCamera","setMatrixWorld","translateZ","from","to","fromRot","toRot","slerp","rotation","setFromQuaternion","isBotMode","Sky","shader","SkyShader","ShaderMaterial","fragmentShader","vertexShader","UniformsUtils","side","BackSide","BoxBufferGeometry","constructor","luminance","turbidity","rayleigh","mieCoefficient","mieDirectionalG","sunPosition","join","inclination","azimuth","distance","sky","skyScene","Scene","cubeCamera","CubeCamera","updateEnvironmentMap","requestAnimationFrame","theta","PI","phi","cos","sin","normalize","vrEnabled","vr","pmremGenerator","PMREMGenerator","renderTarget","texture","pmremCubeUVPacker","PMREMCubeUVPacker","cubeLods","CubeUVRenderTarget","playerHeight","loadedEvent","moveToSpawnPoint","spawnPoints","querySelectorAll","spawnPoint","getLastWorldPosition","visible","COLLISION_LAYERS","useCustomSpawnPosition","spawnPosition","useCustomSpawnRotation","spawnRotation","useCustomSpawnScale","spawnScale","spawnCooldown","centerSpawnedObject","spawnEvent","animateFromCursor","cooldownTimeout","handPosition","onSpawnEvent","tempSpawnHandPosition","classList","entity","addMedia","ObjectContentOrigins","SPAWNER","cursor","getWorldPosition","getWorldQuaternion","userinput","scenes","interaction","willAnimateFromCursor","paths","actions","rightHand","matrix","state","rightRemote","held","spawning","activateCooldown","waitForEvent","delay","dur","syncToPhysics","sx","sy","sz","collisionFilterMask","NONE","DEFAULT_SPAWNER","MobileWater","options","undefined","normalSampler","waterNormals","sunDirection","sunColor","waterColor","eye","distortionScale","FrontSide","fog","mirrorShader","merge","UniformsLib","size","ShaderChunk","transparent","lights","reject","TextureLoader","wrapS","wrapT","RepeatWrapping","needsUpdate","Water","speed","forceMobile","waterMesh","waterGeometry","loadWaterNormals","waterNormalMap","waterConfig","textureWidth","textureHeight","device","isMobile","isMobileVR","water","mirrorCamera","setStyle","startColor","middleColor","endColor","startOpacity","middleOpacity","endOpacity","colorCurve","sizeCurve","startSize","endSize","sizeRandomness","ageRandomness","lifetime","lifetimeRandomness","particleCount","startVelocity","endVelocity","velocityCurve","angularVelocity","particleEmitter","ParticleEmitter","updateParticles","setTexture","Texture","textureLoader","loadTextureAsync","catch","getSanitizedComponentMapping","inputComponent","inputProperty","publicComponents","publicComponent","publicProperty","publicProperties","mappedComponent","mappedProperty","getMappedValue","PHYSICS_CONSTANTS","TYPE","FIT","decayMigration","componentName","componentData","range","decay","mediaInflator","isControlled","networked","hasVolume","templateName","controls","isHubsDestinationUrl","href","owner","persistent","networkId","videoPaused","autoPlay","volume","audioType","hidePlaybackControls","distanceModel","rolloffFactor","refDistance","maxDistance","coneInnerAngle","coneOuterAngle","coneOuterGain","GLTFModelPlus","isHandCollisionTarget","cursorController","mass","STATIC","collisionFilterGroup","INTERACTABLES","euler","orientation","fit","MANUAL","offset","halfExtents","_componentName","zone","found","isMesh","loadMesh","pageIndex","video","loop-animation","indexToEntityMap","enterComponent","enterProperty","enterValue","leaveComponent","leaveProperty","leaveValue","enterComponentMapping","leaveComponentMapping","targetEntity","message","colliders","HEIGHTFIELD","margin","heightfieldDistance","heightfieldData","MESH","ALL","includeInvisible","createElement","getReticulumFetchUrl","path","absolute","reticulumMeta","invalidatedReticulumMetaThisSession","invalidateReticulumMeta","_invalidateReticulumMeta","arguments","getReticulumMeta","_getReticulumMeta","version","pool","phx_host","_ref2","res","json","_x6","phxHostOverride","connectToReticulum","_connectToReticulum","debug","params","qs","getNewSocketUrl","_ref3","socketProtocol","socketHost","socketPort","process","RETICULUM_SOCKET_SERVER","port","socketUrl","log","socketSettings","logger","kind","msg","socket","Socket","connect","endPointPath","endPoint","pathname","newEndPoint","getLandingPageForPhoto","photoUrl","replace","fetchReticulumAuthenticated","payload","token","store","credentials","retUrl","content-type","authorization","_ref","text","_x","createAndRedirectToNewHub","_x2","_x3","_x4","_x5","_createAndRedirectToNewHub","sceneId","sceneUrl","createUrl","assets","Name","SceneUrl","hub","getAirtableAssets","default_environment_gltf_bundle_url","Store","email","creatorAssignmentToken","creator_assignment_token","creatorAssignmentTokens","hubId","hub_id","embedToken","embed_token","embedTokens","host","getPresenceEntryForSession","presences","sessionId","presence","k","metas","getPresenceContextForSession","context","getPresenceProfileForSession","profile","migrateChannelToSocket","oldChannel","channel","topic","bindings","item","on","event","callback","pushBuffer","timeout","oldJoinPush","joinPush","recHooks","receive","status","discordBridgesForPresences","channels","values","discordBridges","Array","b","loading-text","loadingText","message-entry-in-room","messageEntryInRoom","message-entry-spawn","messageEntrySpawn","message-entry-input","messageEntryInput","message-entry","messageEntry","message-entry-disabled","messageEntryDisabled","message-entry-button","messageEntryButton","message-entry-button-in-room","messageEntryButtonInRoom","message-entry-upload","messageEntryUpload","message-entry-input-in-room","messageEntryInputInRoom","message-entry-input-no-spawn","messageEntryInputNoSpawn","message-entry-on-mobile","messageEntryOnMobile","scaledThumbnailUrlFor","getCustomGLTFParserURLResolver","nonCorsProxyDomains","split","CORS_PROXY_SERVER","commonKnownContentTypes","glb","png","jpg","jpeg","pdf","mp4","mp3","farsparkEncodeUrl","str","btoa","encodeURIComponent","_","p1","String","fromCharCode","b64EncodeUnicode","farsparkUrl","urlHostname","hostname","domain","endsWith","gltfUrl","test","corsProxyPrefix","originalUrlParts","decodeURIComponent","dataUrlRegex","matches","match","extension","pop","hubsSceneRegex","hubsAvatarRegex","hubsRoomRegex","avatar-url-dialog","avatarUrlDialog","form-frame","formFrame","leave-room","leaveRoom","pushOrUpdateHistory","history","newPathname","newSearch","newLength","__historyLength","_objectSpread","__duplicate","isDuplicate","pushHistoryState","replaceHistoryState","pushHistoryPath","clearHistoryState","popToBeginningOfHubHistory","navigateToPriorPage","len","unsubscribe","listen","go","sluglessPath","withSlug","avatar-editor","avatarEditor","label","profile-entry","profileEntry","form-submit","formSubmit","choose-avatar","chooseAvatar","form-field-text","formFieldText","title","logo","form","links","darkened","display-name","displayName","preview","close","mic-off-0","micOff0","mic-1","mic1","mic-2","mic2","mic-3","mic3","mic-4","mic4","mic-5","mic5","mic-6","mic6","mic-7","mic7","mic-0","mic0","mic-off-1","micOff1","mic-off-2","micOff2","mic-off-3","micOff3","mic-off-4","micOff4","mic-off-5","micOff5","mic-off-6","micOff6","mic-off-7","micOff7","AVATAR_TYPES","LEGACY","SKINNABLE","legacyAvatarIds","avatars","a","getAvatarType","avatarId","indexOf","resp","fetchAvatar","_fetchAvatar","avatar_id","gltf_url","avatar","model","fetchSkinnableAvatar","getAvatarSrc","fetchAvatarGltfUrl","getAvatarThumbnailUrl","_getAvatarThumbnailUrl","files","willRequireUserGesture","showFullScreenIfAvailable","showFullScreenIfWasFullScreen","screenfull__WEBPACK_IMPORTED_MODULE_0__","screenfull__WEBPACK_IMPORTED_MODULE_0___default","hasEnteredFullScreenThisSession","shouldShowFullScreen","isIOS","screenfull","isFullscreen","request","room-info","roomInfo","scene-screenshot","sceneScreenshot","scene-details","sceneDetails","scene-main","sceneMain","scene-name","sceneName","scene-creator","sceneCreator","scene-attributions","sceneAttributions","attribution-name","attributionName","attribution-author","attributionAuthor","buttons","tweet-button","tweetButton","tweet","editor","editor-inner","editorInner","emoji-button","emojiButton","counter","highlight","media","posted","tweet-loader","tweetLoader","dialog-background","dialogBackground","VERTEX_SHADER","FRAGMENT_SHADER","MobileStandardMaterial","[object Object]","args","super","_defineProperty","parameters","uvTransform","Matrix3","diffuse","opacity","aoMapIntensity","aoMap","emissive","emissiveMap","alphaTest","skinning","morphTargets","vertexColors","mobileMaterial","fromStandardMaterial","SOURCES","EMPTY_RESULT","URL_SOURCE_TO_TO_API_SOURCE","images","videos","youtube","gifs","sketchfab","poly","twitch","favorites","MEDIA_SOURCE_DEFAULT_FILTERS","SEARCH_CONTEXT_PARAMS","MediaSearchStore","EventTarget","dispatchEvent","CustomEvent","urlSource","getUrlMediaSource","previousSource","urlParams","requestIndex","currentRequestIndex","locationSearchParams","isMy","param","source","navigator","languages","singular","credentialsAccountId","toString","lastSavedUrl","isFetching","nextCursor","next_cursor","lastFetchedUrl","legacyAvatar","gltfs","delta","goBack","filter","query","delete","keepSource","keepNav","_stashedParams","_stashedSource","q","_sourceNavigate","hideNav","useLastStashedParams","currentQuery","getSearchClearedSearchParams","useValue","hasAccountWithAvatars","_hasAccountWithAvatars","stashLastSearchParams","_stashLastSearchParams","hasMediaPath","setHistory","_update","ui","ui-dialog","uiDialog","ui-interactive","uiInteractive","presence-info","presenceInfo","corner-button","cornerButton","nag-corner-button","nagCornerButton","choose-scene-button","chooseSceneButton","entry-button-secondary","entryButtonSecondary","entry-panel","entryPanel","button-container","buttonContainer","secondary-action-button","secondaryActionButton","leave-button","leaveButton","interstitial","entry-button","entryButton","action-button","actionButton","collapse-button","collapseButton","favorite-button","favoriteButton","back","lobby-label","lobbyLabel","rename-button","renameButton","wide-button","wideButton","screen-sharing","screenSharing","checkbox","invite-tip","inviteTip","streaming-tip","streamingTip","streaming-tip-attach-point","streamingTipAttachPoint","streaming-tip-close","streamingTipClose","streaming-tip-message","streamingTipMessage","ui-dialog-box-contents","uiDialogBoxContents","backgrounded","in-room-favorite-button","inRoomFavoriteButton","occupant-count","occupantCount","presence-info-selected","presenceInfoSelected","camera-mode-exit-button","cameraModeExitButton","corner-button-selected","cornerButtonSelected","invite-tip-attach-point","inviteTipAttachPoint","entry-dialog","entryDialog","favorited","icon","bolded","subtitle","room-subtitle","roomSubtitle","lobby","profile-icon","profileIcon","button-subtitle","buttonSubtitle","audio-loader","audioLoader","webvr-link-container","webvrLinkContainer","webvr-link","webvrLink","secondary","waitForDOMContentLoaded","eventName","eventObj","readyState","email-field","emailField","next-button","continue-button","continueButton","sign-in-form","signInForm","sign-in-complete","signInComplete","terms","StateLink","React","Component","handleClick","props","onClick","defaultPrevented","button","metaKey","altKey","ctrlKey","shiftKey","isModifiedEvent","preventDefault","stateKey","stateValue","stateDetail","render","innerRef","className","children","react__WEBPACK_IMPORTED_MODULE_0___default","ref","PropTypes","bool","string","func","ctx","AudioContext","getContext","resume","PositionalAudio","updateMatrixWorld","force","Object3D","setInitial","_lastPosition","_lastOrientation","_lastListenerPosition","panner","listener","decompose","applyQuaternion","abs","EPSILON","positionX","positionY","positionZ","setPosition","setOrientation","unmutedBoneName","mutedBoneName","onPos","offPos","onStateToggled","unmutedBone","getObjectByName","mutedBone","modelLoaded","updateMuteState","muted","lastVisible","updateMatrices","selfDestruct","updateOffset","QUARTER_CIRCLE","offsetVector","localToWorld","parent","worldToLocal","rotateOnAxis","TWOPI","head","lookCutoff","animRange","yawCutoff","onChildHovered","removeHoverEvents","isYLocked","lockedHeadPositionY","lookDir","lookEuler","hoverableChildren","hud","pitch","RAD2DEG","yawDif","deltaAngle","forceHudVisible","activity","hasHoveredInWorldHud","clamp","hudLocked","hudOutOfView","DEG2RAD","image","hoverImage","activeImage","activeHoverImage","disabledImage","active","disabled","tooltip","tooltipText","activeTooltipText","onHover","hovering","updateButtonState","onHoverOut","sprite","textHoverColor","textColor","backgroundHoverColor","backgroundColor","textEl","noop","dependencies","raycast","block","clientId","hubChannel","hide","mute","kick","updateVisibility","canOrWillIfCreator","mediaLoader","mediaImage","mediaVideo","mediaPdf","currentContentType","matchesType","toLowerCase","matchesSubtype","whenPinned","_updateUI","_updateUIOnStateChange","targetEl","isPinned","pinnable","pinned","pinnedAndForbidden","left_hand_pose","right_hand_pose","_fireEventsAndAnimate","pinStateChanged","currentScale","isHeld","leftHand","wasHeld","modifyGravityOnRelease","gravity","angularDamping","linearDamping","linearSleepingThreshold","angularSleepingThreshold","DEFAULT_INTERACTABLE","activate","track","selector","cameraSystem","myCamera","getMyCamera","focus","isVisible","shouldBeVisible","onStateChange","newOwner","multiple","transform","oneof","stateadded","stateremoved","withPermission","needsPermission","updatePermissions","hasPermission","onPermissionsUpdated","requireOwnership","angle","targetPos","snappedRot","snappedQ","snappedXForm","snappedXFormWorld","tempVector","_applyMaskedTargetRotation","started","order","compose","multiplyMatrices","_updateMatrixAutoUpdate","matrixAutoUpdate","dim","onFrozenStateChange","getHoverMenu","applyHoverState","menuPromise","menu","allowed","setScalar","frustumCulled","currentActiveCamera","activeCameraEl","setActiveCamera","canvas","matrixIsModified","playhead","poseIndex","overflow","poses","timestamp","isHoldable","offersHandConstraint","offersRemoteConstraint","singleActionButton","holdableButton","isPen","isHoverMenuChild","didUpdateOnce","_updateBillboard","_updateIsInView","schedule","unschedule","isInView","frustum","Frustum","frustumMatrix","boxTemp","expandBox","playerCamera","screenCamera","projectionMatrix","matrixWorldInverse","setFromMatrix","intersectsBox","isInViewOfCamera","setFromMatrixPosition","lookAt","lastSync","syncAll","acceleratedRaycast","gltfCache","Map","cache","count","retain","has","cacheItem","release","disposeNode","inflightGltfs","extractZipFile","promisifyWorker","SketchfabZipWorker","defaultInflator","isArray","cloneSkinnedMesh","cloneLookup","parallelTraverse","sourceNode","clonedNode","boundsTree","sourceMesh","isSkinnedMesh","sourceBones","skeleton","bones","clonedMesh","sourceBone","bindMatrix","cloneGltf","getHubsComponents","hubsComponents","userData","gltfExtensions","MOZ_hubs_components","HUBS_components","legacyComponents","componentKey","inflator","inflateEntities","templates","isRoot","childEntities","child","entityComponents","append","uuid","identity","gltfIndex","attachTemplate","root","templateRoot","targetEls","cloneNode","attributes","loadGLTF","_loadGLTF","preferredTechnique","onProgress","jsonPreprocessor","fileMap","loadingManager","LoadingManager","setURLModifier","gltfLoader","parser","createParser","extensions","oldHeightfieldNode","nodes","heightfield","runMigration","materials","MOZ_alt_materials","altMaterialIndex","extras","DefaultMatrixAutoUpdate","mapMaterials","isMeshStandardMaterial","keys","forEach","revokeObjectURL","useCache","loadTemplates","applySrc","batchManagerSystem","removeObject","templateEl","firstElementChild","loadModel","technique","promise","charAt","assetEl","lastSrc","inflatedEl","disposeLastInflatedEl","addObject","initMixer","hasBufferGeometry","isBufferGeometry","hasBoundsTree","geo","triCount","MeshBVH","strategy","maxDepth","object3DToSet","inflatedEntity","prop","inflateComponents","rewires","f","format","worker","nextItemId","outstanding","onmessage","handlers","transfer","postMessage","registerSystem","registry","queues","frameIndex","queue","idx","invert","updateComponentState","inVRMode","class","handler","permissionName","fetchPermissions","onBlur","onFocus","onTimeout","onEnterVR","isOculusBrowser","userAgent","enteredVR","lastTimeoutCheck","exitTimeout","toggleScreenShare","snapRotateLeft","snapRotateRight","logDebugFrame","logInteractionState","cameraDelta","lobbyCameraDelta","characterAcceleration","boost","startGazeTeleport","stopGazeTeleport","spawnPen","ensureFrozen","toggleFreeze","thaw","muteMic","toggleFlying","enableMegaphone","focusChat","focusChatCommand","toggleCamera","takeSnapshot","mediaExit","mediaSearch1","mediaSearch2","mediaSearch3","mediaSearch4","mediaSearch5","mediaSearch6","mediaSearch7","mediaSearch8","transformModifier","rayObjectRotation","pose","hideLine","grab","drop","modDelta","startDrawing","stopDrawing","undoDrawing","penNextColor","penPrevColor","scalePenTip","scaleGrabbedGrabbable","mediaVolumeMod","pen","switchDrawMode","startTeleport","stopTeleport","thumb","middleRingPinky","exitMirror","haptics","actuators","mouse","coords","movementXY","buttonLeft","buttonRight","wheel","smartMouse","cursorPose","touchscreen","touchCameraDelta","gyroCameraDelta","pinch","initialDistance","currentDistance","isTouching","isTouchingGrabbable","tap1","tap2","tap3","tap4","tap5","gyro","averageDeltaX","averageDeltaY","penButton","keyboard","gamepad","gamepadIndex","buttonIndex","pressed","touched","axis","axisIndex","xbox","buttonName","axisName","axesSum","oculusgo","trigger","touchpad","axisX","axisY","gearVRController","daydream","rightOculusTouch","leftOculusTouch","axes","wmrController","wmr","grip","joystick","vive","client-link","clientLink","presence-list","presenceList","attach-point","attachPoint","contents","rows","row","row-header","rowHeader","list-item","listItem","list-item-link","listItemLink","sign-in","signIn","self","moderator-badge","moderatorBadge","_syncCounterRegistration","timestamps","deregister","register","setBodyKinematic","didThisOnce","UNOWNED_INTERACTABLE","locked","clear","_destroyOldest","oldestEl","minTs","MAX_VALUE","ts","_destroy","teleporters","queryCollisionEntities","_onComponentInitialized","drawingToPen","drawingEl","drawing","createDrawing","getDrawing","returnDrawing","validMaterials","_utils_material_utils__WEBPACK_IMPORTED_MODULE_0__","_utils_permissions_utils__WEBPACK_IMPORTED_MODULE_1__","interactorOneTransform","interactorTwoTransform","enableSweepingEffect","Sphere","sweepParams","forEachMaterial","contains","meshToEl","isFrozen","showEffect","showHoverEffect","interactorOne","interactorTwo","hovered","toArray","worldY","elements","scaledRadius","uniform","hubs_EnableSweepingEffect","hubs_IsFrozen","hubs_SweepParams","hubs_HighlightInteractorOne","hubs_InteractorOnePos","hubs_HighlightInteractorTwo","hubs_InteractorTwoPos","hubs_Time","touchZone","mockJoystickContainer","mockJoystick","inner","small-button","smallButton","input-border","inputBorder","left-side-of-input","leftSideOfInput","add-media-form","addMediaForm","cancel-icon","cancelIcon","upload-icon","uploadIcon","hide-file-input","hideFileInput","close-button","closeButton","dialog","code","imageHeader","keep-open","keepOpen","digit","code-loading-panel","codeLoadingPanel","DialogContainer","closable","currentTarget","onClose","onKeyDown","onContainerClicked","componentDidMount","componentWillUnmount","classNames","wide","allowOverflow","additionalClass","_wrap_with_audio__WEBPACK_IMPORTED_MODULE_3__","_fortawesome_react_fontawesome__WEBPACK_IMPORTED_MODULE_5__","faTimes","isRequired","ENVIRONMENT","AVATAR","HANDS","bindAllEvents","events","unbindAllEvents","eventSrc","toggleEvents","muteEvents","unmuteEvents","onToggle","onMute","onUnmute","connection","adapter","SOUND_TOGGLE_MIC","enableMicrophone","removeState","addState","enableEvents","disableEvents","onEnable","onDisable","mic","spawn","cameraBtn","inviteBtn","background","flyBtn","megaphoneBtn","updateButtonStates","evt","onMegaphoneClick","playerRig","megaphoneEnabled","onMicClick","onSpawnClick","onPenClick","SOUND_SPAWN_PEN","onCameraClick","onFlyClick","fly","onInviteClick","onEnterVr","onExitVr","onFirstInteraction","onMoveJoystickChanged","onMoveJoystickEnd","onLookJoystickChanged","onLookJoystickEnd","styles","leftMock","leftMockSmall","rightMock","rightMockSmall","leftTouchZone","leftStick","nipplejs","fadeTime","rightTouchZone","rightStick","inVr","moving","rotating","moveEvent","rotateYEvent","rotateXEvent","off","radian","style","display","leftController","rightController","LEGACY_HAND_ROTATIONS","makeRotationFromEuler","HAND_ROTATIONS","leftEye","rightEye","neck","chest","hips","rotationSpeed","alwaysUpdate","_runScheduledWork","flipY","makeRotationY","cameraForward","headTransform","hipsPosition","invHipsToHeadVector","middleEyeMatrix","middleEyePosition","invMiddleEyeToHead","cameraYRotation","cameraYQuaternion","invHipsQuaternion","headQuaternion","rootToChest","invRootToChest","ikRoot","findIKRoot","hasConvergedHips","lastCameraTransform","divideScalar","makeTranslation","negate","updateMatrix","hasNewCameraTransform","equals","forceIkUpdate","setFromRotationMatrix","epsilon","u","w","inverse","handRotations","avatarType","updateHand","handRotation","handObject3D","controllerObject3D","isLeft","handMatrix","spaceInvader","handHiddenByPersonalSpace","invading","multiply","cameraWorld","pos","containsPoint","POSES","poseForFingers","hand","subpath","previous","current","groundAcc","pivot","snapRotationDegrees","navGroup","navNode","velocity","accelerationInput","pendingSnapRotationMatrix","_withinWarningLimit","_warningCount","setAccelerationInput","setAngularVelocity","leftRotationMatrix","rightRotationMatrix","reset","SOUND_SNAP_ROTATE","teleportTo","rig","deltaFromHeadToTargetForHead","targetForHead","targetForRig","targetWorldPosition","pathfinder","getGroup","_setNavNode","clampStep","move","trans","transInv","pivotPos","rotationAxis","yawMatrix","rotationMatrix","rotationInvMatrix","pivotRotationMatrix","pivotRotationInvMatrix","startPos","startScale","deltaSeconds","userinputAngularVelocity","rotationDelta","acc","makeRotationAxis","updateVelocity","lengthSq","setPositionOnNavMesh","_warnWithWarningLimit","getClosestNode","zones","dvx","dvz","handleLeftVisuals","handleRightVisuals","hadLeftVisualLastFrame","hadRightVisualLastFrame","interactingElement","hideVisual","ensureAvatarNodes","some","originalRoot","scale-audio-feedback","avatarSrc","communityIdentifier","isOwner","isRecording","applyProperties","updateDisplayName","applyDisplayName","handleModelError","isLocalPlayerInfo","playerSessionId","networkedEntity","getCreator","playerPresence","updateDisplayNameFromPresenceMeta","registerComponentInstance","deregisterComponentInstance","presenceMeta","streaming","recording","roles","nametagEl","communityIdentifierEl","recordingBadgeEl","modBadgeEl","headEl","modelEl","resetToRandomLegacyAvatar","open","thumbDown","indexDown","mrpDown","thumbUp","point","fist","NETWORK_POSES","animatePose","suffix","networkField","getNetworkedAvatar","networkedAvatar","parentEl","prev","curr","fadeOut","fadeIn","setHandPose","toggleEvent","hasFoundFreeze","frozen","SOUND_FREEZE","SOUND_THAW","withinDistance","requireHoverOnNonMobile","camWorldPos","objWorldPos","cam","hoverableSearch","hoverable","shouldNotBeVisible","isWithinDistance","distanceToSquared","isTransforming","transforming","toggle","onExpand","onCollapse","stats","threeStats","aframeStats","plugins","rStats","css","fps","caption","below","batchdraws","batchinstances","batchatlassize","groups","createStats","statsEl","statsHeaderEl","statsTitleEl","innerHTML","collapseEl","insertBefore","firstChild","fpsEl","lastFpsUpdate","lastFps","frameCount","inVR","vrStatsEnabled","initVRStats","lastUpdate","vrPanel","whiteSpace","baseline","depthTest","toggleVRStats","physics","addComponent","removeComponent","beforeStep","afterStep","frame","batchingEnabled","batchManager","batches","instanceCount","atlas","arrayDepth","toFixed","calls","triangles","show","pdfjs","GlobalWorkerOptions","workerSrc","ONCE_TRUE","TYPE_IMG_PNG","parseGIF","GIFWorker","VOLUME_LABELS","GIFTexture","frames","delays","disposals","_ctx","generateMipmaps","isVideoTexture","minFilter","NearestFilter","frameStartTime","Date","clearRect","drawImage","arrayBuffer","rawImageData","delayTimes","loadCnt","img","Image","onload","encoding","sRGBEncoding","LinearFilter","videoEl","autoplay","preload","crossOrigin","createVideoTexture","createVideoEl","VideoTexture","streamClientId","stream","getMediaStream","srcObject","MediaStream","getVideoTracks","HLS","isSupported","baseUrl","hls","xhrSetup","xhr","buildAbsoluteURL","loadSource","attachMedia","Events","ERROR","fatal","ErrorTypes","NETWORK_ERROR","startLoad","MEDIA_ERROR","recoverMediaError","canPlayType","onerror","hasResolved","resolveOnce","poll","videoHeight","videoWidth","scaleToAspectRatio","ratio","disposeTexture","HTMLVideoElement","textureCache","inflightTextures","errorImage","errorImageSrc","errorTexture","magFilter","errorCacheItem","timeFmt","floor","h","tickRate","syncTolerance","onPauseStateChange","tryUpdateVideoPlaybackState","updateSrc","seekForward","seekBack","volumeUp","volumeDown","snap","changeVolumeBy","togglePlaying","videoMutedAt","localSnapCount","isSnapping","onSnapImageLoaded","hoverMenu","playbackControls","playPauseButton","volumeUpButton","volumeDownButton","seekForwardButton","seekBackButton","snapButton","timeLabel","volumeLabel","updateVolumeLabel","updateHoverMenuBasedOnLiveState","updatePlaybackState","applyPersistentFirstSync","getNetworkOwner","audioListener","AudioListener","cameraEl","videoIsLive","currentTime","SOUND_CAMERA_TOOL_TOOK_SNAPSHOT","blob","toBlob","file","File","addAndArrangeMedia","_ignorePauseStateChanges","audio","gain","_playbackStateChangeTimeout","cleanUp","audioSource","createMediaElementSource","setDistanceModel","setRolloffFactor","setRefDistance","setMaxDistance","Audio","setNodeSource","updateLiveState","levels","currentLevel","details","live","LEVEL_SWITCHED","SphereBufferGeometry","PlaneBufferGeometry","DoubleSide","volumeMod","disconnect","currentSrcIsRetained","createGIFTexture","createImageTexture","canvasContext","CanvasTexture","currentTextureCacheKey","_this5","renderTask","loadingSrc","getDocument","numPages","page","getPage","viewport","getViewport","pw","ph","currentPageTextureIsRetained","sound","pinchDelta","degToRad","radToDeg","minPitch","maxPitch","yaw","onRotateX","pendingXRotation","look","deltaPitch","deltaYaw","lookX","lookY","HALF_PI","THREE_HALF_PI","forward","zero","dir","halfExtent","_updateBox","_setupTarget","opening","wasVisible","scaleChanged","previousScaleX","previousScaleY","previousScaleZ","isAnimating","targetPosition","pointOnBoxFace","pointOnBoxFaceToCamera","boxCenter","tempParentWorldScale","boxFaceNormal","forceNewExtents","targetSquareDistance","targetDir","targetHalfExtentStr","targetHalfExtent","targetCameraDot","halfExtentStr","subVectors","cameraAngleDotBoxNormal","dot","squareDistance","setFromMatrixScale","sqrt","targetScale","finalScale","tipSelector","labelSelector","tipEl","labelEl","onHovered","onUnhovered","wasPinned","SOUND_PIN","_discordBridges","canPin","getPromotionTokenForFile","xMin","xMax","yMin","yMax","zMin","zMax","_checkForDestroy","cameraModelPromise","cameraModelSrc","pathsMap","player-right-controller","player-left-controller","videoCodec","codec","MediaRecorder","isTypeSupported","videoMimeType","hasWebGL2","allowVideo","CAPTURE_WIDTH","CAPTURE_HEIGHT","CAPTURE_DURATIONS","DEFAULT_CAPTURE_DURATION","snapCanvas","pixels","imageData","createImageData","bitmap","createImageBitmap","captureDuration","captureAudio","showCameraViewfinder","WebGLRenderTarget","RGBAFormat","depth","stencil","PerspectiveCamera","viewfinderInViewThisFrame","updateUI","aspect","screen","selfieScreen","labelActionBackground","labelBackground","durationLabel","snapIcon","recordIcon","recordAlphaIcon","snapMenu","cancelButton","nextDurationButton","prevDurationButton","snapClicked","cancelSnapping","changeDuration","stopButton","stopRecording","captureAudioButton","captureAudioIcon","updateRenderTargetNextTick","updateViewfinder","findIndex","newIdx","trackTarget","SOUND_CAMERA_TOOL_COUNTDOWN","snapCountdown","countdownInterval","setInterval","camera_tool_asyncToGenerator","clearInterval","takeSnapshotNextTick","beginRecording","hasDuration","isPhoto","isRecordingUnbound","videoRecorder","showActionLabelBackground","videoContext","videoCanvas","videoImageData","videoPixels","Uint8Array","captureStream","selfAudio","getAudioTracks","destination","createMediaStreamDestination","getInput","createMediaStreamSource","addTrack","mimeType","chunks","recordingStartTime","ondataavailable","videoCountdown","videoCountdownInterval","_free","onstop","recordingDuration","Blob","playerIsBehindCamera","MAX_DURATION_TO_LIMIT_LOOPS","objectType","ObjectTypes","CAMERA","cancel","heldLeftHand","heldRightHand","heldRightRemote","heldThisFrame","grabPath","isHolding","updateSnapMenuOrientation","isHoldingTrigger","isHoldingSnapshotTrigger","snapTriggerTimeout","releaseInterval","tock","tempHeadScale","playerHead","playerHud","hudEl","analyser","getAudioFeedbackScale","playerHudWasVisible","spriteSystem","tmpVRFlag","tmpOnAfterRender","onAfterRender","videoRenderTarget","setRenderTarget","srcX0","srcY0","srcX1","srcY1","dest","dstX0","dstY0","dstX1","dstY1","gl","srcFramebuffer","properties","__webglFramebuffer","destFramebuffer","bindFramebuffer","READ_FRAMEBUFFER","DRAW_FRAMEBUFFER","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","blitFramebuffer","COLOR_BUFFER_BIT","LINEAR","readRenderTargetPixels","putImageData","snapPixels","RENDER_WIDTH","pixelsToPNG","grabberId","grabberPaths","playerWorld","playerToCamera","cameraForwardPoint","cameraForwardWorld","AMMO_BODY_ATTRIBUTES","TRANSFORM_MODE","AXIS","PUPPET","CURSOR","ALIGN","SCALE","STEP_LENGTH","CAMERA_WORLD_QUATERNION","CAMERA_WORLD_POSITION","TARGET_WORLD_QUATERNION","v2","q2","onGrabStart","transformSystem","startTransform","onGrabEnd","stopTransform","dxStore","dxApplied","dyAll","dyStore","dyApplied","puppet","initialControllerOrientation","initialControllerOrientation_inverse","initialObjectOrientation","currentControllerOrientation","controllerOrientationDelta","planarInfo","plane","wireframe","normal","intersections","previousPointOnPlane","currentPointOnPlane","deltaOnPlane","finalProjectedVec","startPlaneCasting","raycaster","sign","sign2","dxAll","hasScaled","hasRotated","hasRecentered","puppetingTick","cursorAxisOrScaleTick","cameraToPlaneDistance","intersection","projectOnPlane","modify","setFromAxisAngle","scaleFactor","newScale","FORWARD","TWO_PI","RayCurve","numPoints","BufferGeometry","vertices","Float32Array","uvs","addAttribute","BufferAttribute","setDynamic","drawMode","TriangleStripDrawMode","direction","parabolicCurve","p0","v0","out","setDirection","UP","cross","setWidth","setPoint","posA","posB","checkLineIntersection","meshes","referenceNormal","landingMaxAngle","hitPoint","intersects","intersectObjects","collisionNormal","angleNormals","angleTo","isValidNormalsAngle","face","LANDING_NORMAL","vecHelper","confirm","collisionEntities","hitCylinderColor","hitCylinderRadius","outerRadius","hitCylinderHeight","isTeleporting","rayCurve","teleportEntity","parabola","hit","Raycaster","rigWorldPosition","newRigWorldPosition","teleportOriginWorldPosition","teleportEventDetail","oldPosition","newPosition","prevHitHeight","hitEntity","createHitEntity","stopPlayingTeleportSound","teleportingSound","sfx","timeTeleporting","playSoundLoopedWithGain","SOUND_TELEPORT_START","characterController","SOUND_TELEPORT_END","collidedIndex","timeSegment","percentToDraw","segmentT","hitEntityOpacity","easeOutIn","dRadii","outerScale","easeIn","outerTorus","torus","cylinder","primitive","radiusTubular","segmentsRadial","segmentsTubular","segmentsHeight","openEnded","MAX_ANISOTROPY","computeWidth","wrapPixels","wrapCount","widthFactor","FONTS","roboto","font","ch","chars","yoffset","sum","digitsum","digits","xadvance","computeFontWidthFactor","ImageLoader","anisotropy","loadTexture","align","oneOf","anchor","letterSpacing","lineHeight","tabSize","xOffset","zOffset","shaderData","getShaderData","shaderObject","shaders","Shader","createTextGeometry","attrName","updateFont","currentFont","updateGeometry","updateLayout","parseSide","all","pages","layout","geometryComponent","textScale","descender","TypeError","ascender","geometryUpdateBase","geometryUpdateData","newLineRegex","tabRegex","isFinite","common","sets","detect","browser","VR_DEVICE_AVAILABILITY","yes","no","maybe","GENERIC_ENTRY_TYPE_DEVICE_BLACKLIST","getAvailableVREntryTypes","_getAvailableVREntryTypes","ua","isSamsungBrowser","isWebVRCapableBrowser","hasNativeWebVRImplementation","isDaydreamCapableBrowser","isIDevice","isFirefoxBrowser","isUIWebView","mediaDevices","safari","isCardboardCapableBrowser","displays","getVRDisplays","generic","cardboard","gearvr","isMaybeGearVRCompatibleDevice","isMaybeDaydreamCompatibleDevice","capabilities","canPresent","canShare","share","opts","tweetLink","StateRoute","_this$props","routeProps","_objectWithoutProperties","react_default","es_Route","_extends","PromoteClientDialog","dialog_container","promote_client_dialog_extends","index_es","confirmButton","onConfirm","ClientInfoDialog","client_info_dialog_defineProperty","avatarThumbnailUrl","performConditionalSignIn","client_info_dialog_asyncToGenerator","addOwner","getPresenceEntry","showNonHistoriedDialog","removeOwner","unhide","setState","mayKick","mayMute","targetIsOwner","targetIsCreator","targetIsSignedIn","signed_in","mayAddOwner","mayRemoveOwner","isHidden","client_info_dialog_extends","clientInfoDialog","clientProfileImage","clientActionButtons","buttonIcon","add_owner_default","remove_owner_default","Loader","loader_defineProperty","loadingNum","loadedNum","doneWithInitialLoad","loadingTimeout","tryFinishLoading","environmentSceneLoaded","onLoaded","onObjectLoading","onObjectLoaded","nomore","loaderStyles","progress","usual","locale","lang","messages","loadingIcon","finished","AutoExitWarning","secondsRemaining","wrap_with_audio","onCancel","propTypes","number","EntryButton","cx","iconSrc","prefixMessageId","mediumMessageId","isInHMD","TwoDEntryButton","entryButtonProps","MobileScreenEntryImg","DesktopScreenEntryImg","GenericEntryButton","GenericVREntryImg","DaydreamEntryButton","DaydreamEntryImg","ProfileEntryPanel","profile_entry_panel_defineProperty","getStateFromProfile","hasChangedName","hasChangedNowOrPreviously","hasAcceptedProfile","stopPropagation","entry","profile_entry_panel_asyncToGenerator","storeUpdated","nameInput","setAvatarFromMediaResult","refetchAvatar","componentDidUpdate","_prevProps","prevState","formatMessage","intl","react_fontawesome_index_es","onSubmit","saveStateAndFinish","htmlFor","displayNameOverride","handleTextFieldFocus","handleTextFieldBlur","onChange","required","spellCheck","pattern","SCHEMA","definitions","inp","avatar_preview","avatarGltfUrl","account_id","state_link","hideDelete","returnToProfile","faPencilAlt","mediaSearchStore","sourceNavigateWithNoNav","rel","termsLink","privacyLink","injectIntl","PRIVACY_POLICY_LINKS","DEFAULT_FACETS","MediaBrowser","media_browser_defineProperty","showNav","selectNextResult","clearStashedQueryOnClose","newState","getStoreAndHistoryState","selectEntry","inputRef","getUrlSource","suggestions","forceNow","_sendQueryTimeout","filterQueryNavigate","lucky_query","handleQueryUpdated","onMediaSearchResultEntrySelected","sourceNavigate","pushExitMediaBrowserHistory","isSceneApiType","isAvatarApiType","clearStashedQuery","pageNavigate","browserDiv","scrollTop","sourceChanged","showCustomOption","hideSearch","showEmptyStringOnNoResult","handleCustomClicked","showCustomMediaDialog","faStar","faSearch","autoFocus","placeholder","handleEntryClicked","trim","blur","faLink","faCloudUploadAlt","handleSourceClicked","faAngleRight","handleFacetClicked","media_tiles","handlePager","attributionHostnames","giphy.com","giphyLogo","media.giphy.com","DEFAULT_OBJECT_URL","instructions","references","mobileInstructions","desktopInstructions","lastUrl","fileInputId","CreateObjectDialog","create_object_dialog_defineProperty","fileName","attributionImage","validity","valid","fileInput","onCreate","other","create_object_dialog_objectWithoutProperties","uploadButton","faPaperclip","filenameLabel","urlInput","onUrlChange","create_object_dialog_extends","onCreateClicked","onFileChange","ChangeSceneDialog","change_scene_dialog_defineProperty","onChangeClicked","changeSceneForm","spokeCreate","spokeLaunch","AvatarUrlDialog","avatar_url_dialog_defineProperty","HelpDialog","help_dialog_extends","textAlign","InviteDialog","invite_dialog_defineProperty","copyButtonActive","shareButtonActive","link","entryCode","embedUrl","entryCodeString","num","pad","shortLinkText","shortLink","embedText","modal","isModal","hubLinkLink","readOnly","select","linkButton","copyClicked","allowShare","shareClicked","embed","showEmbedTip","embedTipWrap","embedTip","embedTipAttachPoint","hasPush","subscribe","onSubscribeChanged","checked","isSubscribed","enterVrButton","InviteTeamDialog","invite_team_dialog_defineProperty","inviteButtonText","requestSupport","invite_team_dialog_extends","inviteClicked","LinkDialog","linkCode","LinkDialogHeader","SafariDialog","safari_dialog_defineProperty","copyLinkButtonText","onCopyClicked","copyLinkClicked","safari_dialog_extends","SafariMicDialog","safari_mic_dialog_extends","reload","RoomSettingsDialog","room_settings_dialog_defineProperty","initialSettings","renderCheckbox","member_permission","permission","permissionDisabled","member_permissions","room_settings_dialog_objectSpread","room_settings_dialog_extends","roomSettingsForm","autoComplete","nameField","newMemberPermissions","spawn_and_move_media","spawn_camera","pin_objects","permissionsGroup","CloseRoomDialog","close_room_dialog_extends","LOCAL_CLOSE_TIPS","KEEP_ACTIVE_AFTER_GLOBAL_CLOSE","localStorageCache","finishedScopes","tipPlatform","platformTips","desktop","mobile","standalone","isTipFinished","tip","localStorage","getItem","markTipFinished","storeData","setItem","handleTipClose","fullTip","scope","tips","VALIDATORS","activeSets","cursorHoldingPen","locomotion","accel","turning","spawn_menu","mediaCounter","freeze_gesture","cursorHoldingInteractable","cursorHoveringOnInteractable","menu_hover","invite","cursorHoldingCamera","object_grab","object_rotate_button","object_scale_button","object_recenter_button","object_pin","hasPinned","object_zoom","object_scale","pen_color","pen_size","pen_mode","freeze_mode","video_share_mode","mute_mode","feedback","entryCount","activeTips","_finishedScopes","_performStep","_userinput","_mediaCounter","prevTop","prevBottom","chosenTip","finishCount","Tip","tipRegion","broadcastTarget","tipBody","splitTip","splitTipIcon","tipLink","tipRoot","tipCancel","WebRTCScreenshareUnsupportedDialog","webrtc_screenshare_unsupported_dialog_extends","flexDirection","alignItems","fontSize","WebAssemblyUnsupportedDialog","webassembly_unsupported_dialog_extends","WebVRRecommendDialog","webvr_recommend_dialog_extends","FeedbackDialog","feedback_dialog_extends","frameBorder","marginHeight","marginWidth","LeaveRoomDialog","leave_room_dialog_extends","messageType","destinationUrl","RoomInfoDialog","toAttributionDiv","author","attributions","hubName","room_info_dialog_extends","screenshot_url","sceneButtons","OAuthDialog","renderSignInDisclaimer","oauthTypeName","privacyNotice","renderTweetDisclaimer","twitterMessage","oauthInfo","oauth_dialog_extends","oauthButtons","oauthButton","oauthTwitterButton","oauthDiscordButton","array","emojiPlugin","createEmojiPlugin","hashtagPlugin","createHashtagPlugin","linkifyPlugin","createLinkifyPlugin","counterPlugin","createCounterPlugin","addEmoji","emoji","editorState","contentState","getCurrentContent","entityKey","createEntity","emojiUnicode","getLastCreatedEntityKey","currentSelectionState","getSelection","emojiAddedContent","emojiEndPos","blockSize","afterRemovalContentState","Modifier","removeRange","targetSelection","getSelectionAfter","insertText","getAnchorOffset","blockKey","getAnchorKey","getBlockForKey","getLength","newEditorState","EditorState","forceSelection","TweetDialog","createEditorStateWithText","editorRef","sendTweet","media_stored_file_url","getPlainText","posting","renderPostedDialog","tweet_dialog_extends","renderTweetDialog","EmojiSuggestions","EmojiSelect","CharCounter","draft_js_plugins_editor_lib_default","emojiSuggestions","limit","LobbyChatBox","lobby_chat_box_defineProperty","pendingMessage","onSendMessage","textRows","pendingMessageTextareaHeight","pendingMessageFieldHeight","discordSnippet","occupantSnippet","messageEntryPlaceholder","sendMessage","messageEntrySubmit","faPaperPlane","ChatCommandHelp","commands","commandHelp","commandHelpOnTop","onTop","matchingPrefix","command","defaultStylesByTagName","noStyleTags","BASE","HEAD","HTML","META","NOFRAME","NOSCRIPT","PARAM","SCRIPT","STYLE","TITLE","tagNames","computeDefaultStyleByTagName","tagName","defaultStyle","element","computedStyle","getComputedStyle","warmSerializeElement","navigateToClientInfo","currentParams","PresenceList","presence_list_defineProperty","expanded","CameraImage","PhoneImage","hmd","HMDImage","discord","DiscordImage","DesktopImage","getPresenceImage","isBot","badge","renderExpandedList","domForPresence","signedIn","maskEmail","onSignOut","onSignIn","rootStyles","faUsers","messageCanvas","emojiRegex","urlRegex","messageBodyDom","fromSessionId","includeFromLink","multiLine","wrapStyle","messageWrapMulti","messageWrap","mono","messageBodyClasses","messageBody","messageBodyMulti","messageBodyMono","includeClientLink","onFromClick","words","outWords","word","wordWrap","cleanedBody","messageSource","messageSourceLink","Linkify_default","toEmojis","renderChatMessage","allowEmojiRender","lowResolution","isOneLine","isEmoji","presenceLog","presenceLogSpawn","entryDom","presenceLogEntry","presenceLogEntryOneLine","presenceLogEmoji","ReactDOM","objectScale","offsetWidth","offsetHeight","xhtml","nodeType","Node","ELEMENT_NODE","cssTexts","toUpperCase","cssText","ii","cssPropName","outerHTML","serializeElement","chat_message_asyncToGenerator","unmountComponentAtNode","meshEntity","blobUrl","createObjectURL","isRawProperty","meshMaterial","spawnChatMessage","_spawnChatMessage","ChatMessage","maySpawn","iconButton","spawnMessage","InWorldChatBox","in_world_chat_box_defineProperty","chat_command_help_ChatCommandHelp","accept","onObjectCreated","enableSpawning","faCamera","faPlus","AVATARS_API","AvatarEditor","avatar_editor_defineProperty","parent_avatar_listing_id","previewGltfUrl","avatar_editor_asyncToGenerator","creatorAttribution","inputFiles","base_gltf_url","KHR_binary_glTF","bin","getWrappedInstance","snapshot","filesToUpload","uploading","fileUploads","upload","avatar_editor_objectSpread","file_id","access_token","promotion_token","reduce","createOrUpdateAvatar","onSave","uploadAvatar","textField","textarea","fileField","mapField","avatar_editor_extends","confirmDelete","deleteAvatar","MicLevelWidget","mic_level_widget_defineProperty","startAnalyser","stopAnalyser","micUpdateInterval","micLevelMovingAverage","MovingAverage","average","movingAverage","micClip","level_background_default","srcSet","level_background_2x_default","muteOnEntry","level_fill_default","level_fill_2x_default","hasAudioTrack","mic_level_default","mic_level_2x_default","mic_denied_default","mic_denied_2x_default","OutputLevelWidget","output_level_widget_defineProperty","tonePlaying","playTestTone","toneClip","webmTone","mp3Tone","oggTone","wavTone","testToneTimeout","speakerClip","level_action_background_default","level_action_background_2x_default","level_action_fill_default","level_action_fill_2x_default","speaker_level_default","speaker_level_2x_default","PhotoMessage","landingPageUrl","onShareClicked","mediaBody","VideoMessage","ImageMessage","spawnImage","PresenceLog","presence_log_defineProperty","entryClasses","presenceLogEntryWithButton","presenceLogChat","expired","oldName","newName","inRoom","presenceClasses","presenceLogInRoom","domForEntry","SettingsMenu","settings_menu_defineProperty","renderExpandedMenu","rowClasses","settingsRow","showRoomSettings","showRoomInfo","hubScene","showStreamerMode","flyEnabled","settingsMenu","change_avatar_default","toggleFlyMode","faInfoCircle","faDoorClosed","faVideo","toggleStreamerMode","faBars","isStreaming","PreloadOverlay","treatment","screenshot","mainPanel","onLoadClicked","loadButton","SPRITESHEET_ICONS","MIC","spritesheet","MIC_OFF","TopHUD","_2d_hud_defineProperty","showVideoShareOptions","lastActiveMediaSource","micLevel","cameraDisabled","penDisabled","mediaDisabled","micLevelForVolume","videoShareMediaSource","onEndShareVideo","onShareVideo","onShareVideoNotCapable","videoShareExtraOptionTypes","primaryVideoShareType","showExtrasOnHover","hideVideoSharingButtonTimeout","capitalize","videoShare","handleVideoShareClicked","onMouseOver","videoShareExtraOptions","onMouseOut","megaphoneDisabled","videoSharingButtons","buildVideoSharingButtons","tipDivForType","cancelFunc","topTip","watching","topTipNoHud","onWatchEnded","tipCancelText","showVideoShareFailed","hideVideoShareFailedTip","activeTip","micIconClass","container","unselectable","uiStyles","panel","onToggleMute","sourceNavigateToDefaultSource","hasActiveCamera","onSpawnCamera","flyingEnabled","onToggleFlying","megaphone","onToggleMegaphone","isCursorHoldingPen","onToggleFreeze","onSpawnPen","showStreamingTip","hideStreamingTip","react_components_2d_hud","SpectatingLabel","_isIn2DInterstitial","_exitAction","afterUserGesturePrompt","handleExitTo2DInterstitial","isLower","exitAction","exitVR","vrNotice","exit2DInterstitialAndEnterVR","exit","enterVR","isIn2DInterstitial","avatarEditorDebug","addLocaleData","en","HMD_MIC_REGEXES","IN_ROOM_MODAL_ROUTER_PATHS","IN_ROOM_MODAL_QUERY_VARS","LOBBY_MODAL_ROUTER_PATHS","LOBBY_MODAL_QUERY_VARS","LOBBY_MODAL_QUERY_VALUES","enumerateDevices","isMobilePhoneOrVR","AUTO_EXIT_TIMER_SECONDS","UIRoot","ui_root_defineProperty","enterInVR","entered","showShareDialog","broadcastTipDismissed","linkCodeCancel","miniInviteActivated","didConnectToNetworkedScene","noMoreLoadingUpdates","hideLoader","waitingOnAudio","mediaStream","audioTrack","micDevices","autoExitTimerStartedAt","autoExitTimerInterval","secondsRemainingBeforeAutoExit","exited","ui_root_asyncToGenerator","airtableAssets","signInMessageId","authChannel","signInCompleteMessageId","signInContinueTextId","onContinueAfterSignIn","SignInDialog","authComplete","startAuthentication","authStarted","continueText","onContinue","subscriptions","isFavorited","initialIsFavorited","sceneLoaded","mediaSource","updateSubscribedState","forcedVREntryType","enterDaydream","enter2D","disableAutoExitOnConcurrentLoad","secondsSinceStart","checkForAutoExit","endAutoExitTimer","reason","exitScene","_ref4","grantedMicLabels","setMediaStreamToDefault","beginOrSkipAudioSetup","performDirectEntryFlow","availableVREntryTypes","_ref8","ev","constraints","deviceId","exact","fetchAudioTrack","setupNewMediaStream","hasAudio","lastUsedMicDeviceId","settings","ideal","_ref10","getUserMedia","recreateAudioStream","_ref11","setLocalMediaStream","fetchMicDevices","micDeviceId","micDeviceIdForMicLabel","micLabelForMediaStream","mediaStreamForMicAnalysis","entry_step","onAudioReadyButton","hasHmdMicrophone","selectedMicLabel","enterScene","onFinished","linkChannel","generateCode","hasOpenedShare","updateScene","ui_root_objectSpread","DialogClass","closeDialog","beginStreaming","endStreaming","_ref16","signOut","broadcastedRoomConfirmed","confirmedBroadcastedRooms","onInterstitialPromptClicked","roomUnavailableReason","platformUnsupportedReason","exitSubtitleId","logo_default","promptForNameAndAvatarBeforeEntry","hubIsBound","entryStyles","lobby_chat_box","attemptLink","handleForceEntry","faArrowLeft","granted","onMicGrantButton","mic_granted_default","mic_granted_2x_default","subtitleId","mic_level_widget_MicLevelWidget","output_level_widget_OutputLevelWidget","selectedMicDeviceId","micDeviceChanged","mic_small_default","mic_small_2x_default","dropdown_arrow_default","dropdown_arrow_2x_default","shouldShowHmdMicWarning","warning_icon_default","warning_icon_2x_default","overlay","showSafariMicDialog","safari_mic_dialog_SafariMicDialog","showSafariDialog","safari_dialog_SafariDialog","showWebAssemblyDialog","webassembly_unsupported_dialog_WebAssemblyUnsupportedDialog","exitEventHandler","airtableAssetsInitialState","prevProps","showSignInDialog","showContextualSignInDialog","willCompileAndUploadMaterials","compileAndUploadMaterials","onConcurrentLoad","onSceneLoaded","onAframeStateChanged","onShareVideoEnabled","onShareVideoDisabled","onShareVideoFailed","onStoreChanged","audioContext","playSound","onMouseLeave","fetchAirtableAssets","isExited","showPreload","isLoading","ui-root","in-modal-or-overlay","isInModalOrOverlay","serviceWorker","showOAuthDialog","showInterstitialPrompt","oauth_dialog_OAuthDialog","onCloseOAuthDialog","Privacy_Link","Terms_Link","renderExitedPane","react_components_loader","Icon","onLoadingFinished","renderInterstitialPrompt","renderBotMode","enteredOrWatching","enteredOrWatchingOrPreload","inEntryFlow","isWaitingForAutoExit","auto_exit_warning","state_route","renderDevicePanel","renderMicPanel","renderAudioSetupPanel","renderEntryStartPanel","dialogBoxContentsClassNames","showVREntryButton","presenceLogEntries","showMediaBrowser","hasTopTip","clientInfoClientId","getClientInfoClientId","showClientInfo","hasEmbedPresence","hasDiscordBridges","showBroadcastTip","showInviteTip","streamerName","Provider","helmet","preload_overlay_PreloadOverlay","onPreloadLoadClicked","DarkLogo","profile_entry_panel","ui_root_extends","avatar_editor_AvatarEditor","onAvatarSaved","react_components_media_browser","renderDialog","hubMemberPermissions","updateHub","closeHub","help_dialog_HelpDialog","createObject","changeScene","setAvatarUrl","client_info_dialog_ClientInfoDialog","presence_log_PresenceLog","tip_Tip","confirmBroadcastedRoom","in_world_chat_box","inviteStyles","inviteContainer","inviteContainerBelowHud","inviteContainerInverted","onMiniInviteClicked","inviteMiniButton","enterButton","invite_dialog_InviteDialog","hubEntryCode","initialIsSubscribed","link_dialog_LinkDialog","presence_list_PresenceList","settings_menu_SettingsMenu","spectating_label_SpectatingLabel","topHud","toggleMute","toggleMegaphone","shareVideo","endShareVideo","showWebRTCScreenshareUnsupportedDialog","isSupportAvailable","MS_PER_DAY","MS_PER_MONTH","isSameMonth","da","db","getFullYear","getMonth","HUB_CREATOR_PERMISSIONS","VALID_PERMISSIONS","HubChannel","hub_channel_defineProperty","Presence","_permissions","jwtDecode","nextRefresh","exp","hub_channel_asyncToGenerator","entryDisplayType","vrDisplay","isPresenting","initialOccupantCount","initialOccupants","entryEvent","hub_channel_objectSpread","getEntryTimingFlags","entryTimingFlags","isNewDaily","isNewMonthly","isNewDayWindow","isNewMonthWindow","storedLastEnteredAt","lastEnteredAt","lastEntered","msSinceLastEntered","getDate","isSameDay","object_type","update_hub","close_hub","subscription","allow","creatorAssignmentTokenEntry","_getCreatorAssignmentToken","perms_token","setPermissionsFromToken","_signedIn","oauth_url","gltfNode","fileAccessToken","promotionToken","gltf_node","file_access_token","permsToken","session_id","_blockedSessionIds","unblock","entities","completeSync","Set","migrateToSocket","presenceBindings","onJoin","caller","onLeave","onSync","endRecording","exceedsDensityThreshold","subtree","bounds","boundingData","isHighDensity","leftResult","rightResult","isGeometryHighDensity","roots","_roots","traverseMeshesAndAddShapes","shapes","meshRoot","group","__proto__","navMesh","shapePrefix","groupEnd","DUCK_URL","MessageDispatch","entryManager","addToPresenceLog","remountUI","message_dispatch_defineProperty","commandParts","dispatchCommand","activeElement","scales","curScale","physicsSystem","captureSystem","setDebug","rename","available","isDebug","SceneEntryManager","scene_entry_manager_defineProperty","whenSceneLoaded","_entered","scene_entry_manager_asyncToGenerator","session","verbose","_setupPlayerRig","_setupBlocking","_setupKicking","_setupMedia","_setupCamera","_spawnAvatar","SOUND_ENTER_SCENE","_runBot","sendEntryEvent","toISOString","bumpEntryCount","hasLoaded","localMediaStream","getTracks","setAnimationLoop","_setPlayerInfoFromProfile","avatarScale","kickedClientId","_unpinElement","removeEntity","removeEntitiesOfClient","storedPromotionToken","gltfComponents","equalArray","every","translation","mediaSrc","mediaContentSubtype","pinnedEntityToGltf","pin","_signInAndPinOrUnpinElement","_pinElement","_disableSignInOnPinAction","unpin","spawnMediaInfrontOfPlayer","contentOrigin","or","currentVideoShareEntity","FILE","sendObjectSpawnedEvent","contentEditable","uiRoot","clipboardData","getData","CLIPBOARD","dataTransfer","isHandlingVideoShare","shareVideoMediaStream","_ref7","newStream","frameRate","removeTrack","spawnDelay","audioEl","audioInput","dataInput","getAudio","crossorigin","onchange","getRecording","mozCaptureStream","INIT_TIMEOUT_MS","urlBase64ToUint8Array","base64String","base64","repeat","rawData","atob","outputArray","charCodeAt","Subscriptions","subscriptions_defineProperty","registration","vapidPublicKey","_isSubscribed","subscriptions_asyncToGenerator","startedAt","pushManager","convertedVapidKey","permissionState","userVisibleOnly","applicationServerKey","getSubscription","endpoint","pushSubscription","has_remaining_subscriptions","invaderPos","bubblePos","createSphereGizmo","WireframeGeometry","line","LineSegments","invaders","bubbles","tickCount","_updateInvaders","registerBubble","bubble","unregisterBubble","registerInvader","invader","unregisterInvader","updateDebug","setInvading","tempInvasionFlags","setInvaderFlag","distanceSquared","radiusSum","flushInvadingFlagsForIndex","meshName","targetMesh","useMaterial","invadingOpacity","findInvaderMesh","radiusSquared","system","cameraEls","cameraUpdateCount","ticks","playerModelEl","updatePlayerHead","_onOwnershipChange","modeMod","WheelEvent","DOM_DELTA_PIXEL","DOM_DELTA_LINE","DOM_DELTA_PAGE","isInModal","MouseDevice","queueEvent","deltaX","deltaY","deltaMode","clientX","innerWidth","clientY","innerHeight","movementX","movementY","mouseDownLeftThisFrame","mouseDownRightThisFrame","write","didStopProcessingEarly","setVector2","setValueType","ArrayBackedSet","initialItems","items","oncontextmenu","KeyboardDevice","seenKeys","nodeName","HudDevice","XboxControllerDevice","buttonMap","buttonId","axisMap","axisId","getGamepads","connected","xboxPaths","hapticActuators","Pose","fromOriginAndDirection","setFromUnitVectors","fromCameraProjection","normalizedX","normalizedY","unproject","EYES_TO_ELBOW","FOREARM","applyArmModel","controllerEuler","deltaControllerPosition","controllerQuaternion","controllerPosition","gamepadPose","headObject3D","userHeight","applyAxisAngle","up","fromArray","applyEuler","copySittingToStandingTransform","stageParameters","sittingToStandingTransform","ONES","TOUCHPAD","TRIGGER","OculusGoControllerDevice","sittingToStandingMatrix","rayObject","rayMatrixWorld","setPose","setMatrix4","TOUCHPAD_X","TOUCHPAD_Y","GearVRControllerDevice","leftOculusTouchButtonMap","rightOculusTouchButtonMap","LEFT_HAND_OFFSET","RIGHT_HAND_OFFSET","OculusTouchControllerDevice","buttonMaps","devicePaths","handOffset","HAND_OFFSET","POSE","MATRIX","DaydreamControllerDevice","RAY_ROTATION","ViveControllerDevice","isViveWand","gamepads","WindowsMixedRealityControllerDevice","CircularBuffer","fill","writePtr","difference","GyroDevice","hmdEuler","hmdQuaternion","prevX","prevY","dXBuffer","dYBuffer","hasPolyfill","webvrpolyfill","getPolyfillDisplays","frameData","VRFrameData","getFrameData","dX","dY","findHandCollisionTargetForHand","driver","numManifolds","dispatcher","getNumManifolds","handPtr","Ammo","getPointer","persistentManifold","getManifoldByIndexInternal","body0ptr","getBody0","body1ptr","getBody1","numContacts","getNumContacts","getContactPoint","getDistance","els","tags","remoteHoverTargets","findRemoteHoverTarget","updateCursorIntersection","rightRemoteHoverTarget","dropPath","hoverFn","getRightRemoteHoverTarget","previousState","tickInteractor","lostOwnership","canMove","rightHandTeleporter","gazeTeleporter","rightHandInteracting","rightHandTeleporting","rightRemotePenIntersectingInVR","enableRightRemote","SOUND_HOVER_OR_GRAB","calculateCursorPose","AppAwareMouseDevice","prevButtonLeft","clickedOnAnything","prevCursorPose","prevOrigin","prevDirection","rawIntersections","cursorTargettingSystem","remoteHoverTarget","isInteractable","touchIsAssigned","touch","assignments","assignment","identifier","jobIsAssigned","job","unassign","findByJob","findByTouch","MOVE_CURSOR_JOB","MOVE_CAMERA_JOB","FIRST_PINCHER_JOB","SECOND_PINCHER_JOB","TAP_PATHS","x1","y1","x2","y2","dx","dy","getPlayerCamera","AppAwareTouchscreenDevice","pendingTap","maxTouchCount","tapIndexToWriteNextFrame","framesUntilGrab","framesUntilUnassign","second","first","cameraMover","isFirstTouch","isSecondTouch","isThirdTouch","hasSecondPinch","setFromCamera","shouldMoveCursor","cursorJob","previousAssignment","changedTouches","touches","hasCursorJob","hasCameraJob","xforms","scalar","scaleExp","pow","deadzone","deadzoneSize","split_vec2","compose_vec2","copyIfFalse","copyIfTrue","zeroIfDefined","true","rising","risingWithFrameDelay","falling","vec2Zero","poseFromCameraProjection","vec2dpad","deadzoneRadius","invertX","invertY","deadzoneRadiusSquared","atan2","always","constValue","wasd_to_vec2","vec2","add_vec2","max_vec2","normalize_vec2","any","touch_axis_scroll","snap_to","touching","addSetsToBindings","mapping","setName","binding","togglePenWithP","togglePenWithHud","keyboardMouseUserBindings","global","xform","priority","cursorHoldingUI","cursorHoveringOnVideo","inputFocused","cursorHoveringOnUI","touchCamDelta","touchscreenUserBindings","cursorHoveringOnPen","keyboardDebuggingBindings","leftButton","leftAxis","leftPose","rightButton","rightAxis","rightPose","rightGripRisingGrab","lowerButtons","leftGripPressed1","leftGripPressed2","rightGripPressed1","rightGripPressed2","leftTriggerPressed1","leftTriggerPressed2","rightTriggerPressed1","rightTriggerPressed2","oculusTouchUserBindings","north","south","east","west","override","leftHandHoveringOnNothing","cursorHoveringOnNothing","leftHandHoveringOnInteractable","leftHandHoldingInteractable","leftHandHoveringOnPen","leftHandHoldingPen","rightHandHoveringOnInteractable","rightHandHoldingInteractable","rightHandHoveringOnPen","rightHandHoldingPen","cursorHoveringOnCamera","rightHandHoveringOnCamera","leftHandHoveringOnCamera","rightHandHoldingCamera","leftHandHoldingCamera","rightHandHoveringOnNothing","lButton","lAxis","lPose","lJoyScaled","lJoyXScaled","lJoyYScaled","lTouch","lTouchScaled","lTouchXScaled","lTouchYScaled","lDpadNorth","lDpadSouth","lDpadEast","lDpadWest","lDpadCenter","lTriggerFallingStopDrawing","lGripFallingStopDrawing","lTriggerRisingGrab","lGripRisingGrab","lTouchpadRising2","lTouchpadRising1","touchCharacterAcceleration","lCharacterAcceleration","leftBoost","rButton","rAxis","rPose","rTouch","rJoy","rDpadNorth1","rDpadSouth1","rDpadEast1","rDpadWest1","rDpadCenter1","rDpadNorth2","rDpadSouth2","rDpadEast2","rDpadWest2","rDpadCenter2","rDpadCenterStrip","rTouchpadRising","rTouchpadFalling","rightBoost","rTriggerRisingGrab","rGripRisingGrab","cursorDrop1","cursorDrop2","rTriggerStopTeleport","rTouchpadStopTeleport","ensureFrozenViaDpad","ensureFrozenViaKeyboard","thawViaDpad","thawViaKeyboard","rSnapRight1","rSnapLeft1","rSnapRight2","rSnapLeft2","keyboardSnapRight","keyboardSnapLeft","keyboardCharacterAcceleration","wasd_vec2","arrows_vec2","keyboardBoost","leftTouchpadPressed1","leftTouchpadPressed2","leftTouchpadFallingStopTeleport","leftTriggerFallingStopTeleport","leftGripFallingWhileHoldingPen","viveUserBindings","leftHandTeleporting","viveWandUserBindings","lGripPressed","rGripPressed","rTriggerPressed","rJoyNorth","rGripRising","rTriggerRising","rGripFalling","rTriggerFalling","dpadVariables","padWest","padEast","padNorth","padSouth","padCenter","padCenterStrip","dpadBindings","neverFrozenBinding","penBindings","forCursor","padY","triggerPressed","padPressed","padTouched","padRising","padCenterStripTouched","handPoseBindings","gripPressed","holdingCameraBindings","wmrUserBindings","leftPadPressed","rightPadPressed","leftPadFalling","rightPadFalling","keyboardSaceFalling","freezeBindings","rJoyWest","rJoyEast","rJoyWestRising","rJoyEastRising","keyboardQRising","keyboardERising","teleportationAndRotationBindings","lJoyXDeadzoned","lJoyYDeadzoned","characterAccelerationBindings","cursorMediaVolumeModBindings","rPadNorthOrSouth","rPadNorthOrSouthPressed","rPadNorthOrSouthPressedY","cursorModDeltaBindings","scaledRightJoystickVertical","scaledLeftJoystickCursorDelta","deadzonedRightJoystickHorizontal","deadzonedRightJoystickVertical","deadzonedLeftJoystickHorizontal","deadzonedLeftJoystickVertical","disableForwardOnTrigger","scaledLeftJoystickHorizontal","scaledLeftJoystickVertical","scaledLeftJoystickForwardAcceleration","xboxControllerUserBindings","cursorHoldingNothing","touchpadRising","touchpadFalling","touchpadPressed","dpadNorth","dpadSouth","dpadEast","dpadWest","dpadCenter","brushSizeDelta","cursorModDelta","dpadSouthDrop","dpadCenterDrop","grabBinding","dropOnCenterOrSouth","daydreamUserBindings","cardboardUserBindings","generate3DOFTriggerBindings","touchpadButton","triggerButton","touchpadX","touchpadXForPen","touchpadY","touchpadYForPen","triggerRising","triggerFalling","dpadCenterStrip","dpadBottomCenterStrip","togglePen","dropBinding","leftTeleporter","rightTeleporter","GamepadDevice","buttonPath","gamepadBindings","oculusGoUserBindings","gearVRControllerUserBindings","satisfiesPath","satisfyPath","satisfiedBy","canMask","masker","masked","maskerKey","maskerPath","maskedKey","isActive","toggleSet","pendingSetChanges","generation","generations","mat4","prevActiveSets","xformStates","activeDevices","registeredMappings","registeredMappingsChanged","vrGamepadMappings","nonVRGamepadMappings","updateBindingsForVRMode","activeDevice","gamepadConnected","gamepadDevice","maybeToggleXboxMapping","vrAxesSum","mouseMovement","nonXboxActivity","hasXboxMapping","prevSortedBindings","sortedBindings","mappings","unsorted","sorted","dependencySort","masks","masksRow","bindingsRow","col","computeMasks","teleporter","leftHandHoveringOnVideo","rightHandHoveringOnVideo","resolveActionSets","activeSetsChanged","il","elem","jl","arrayContentsDiffer","actives","prevActives","prevMasked","maskedRow","computeExecutionStrategy","bindingExistedLastFrame","PATHS_TO_SHOW","userinputFrameStatus","replacer","pathsOutput","val","textContent","sb","logBindings","MEDIA_SEARCH_PATHS","prefix","CursorTargettingSystem","setDirty","dirty","observer","MutationObserver","observe","childList","populateEntities","ACTIVATION_STATE","ConstraintsSystem","prevLeftHand","prevRightHand","prevRightRemote","constraintTag","entityId","hasAnotherConstraint","activationState","ACTIVE_TAG","DISABLE_DEACTIVATION","COLLISION_FILTER_MASK_HANDS","distanceBetweenStretchers","obj1","obj2","distanceTo","TwoPointStretchingSystem","leftStretcher","rightStretcher","previousLeftStretcher","previousRightStretcher","stretched","initialStretchDistance","SingleActionButtonSystem","didInteractThisFrame","HoldableButtonSystem","prevHeld","hasButtonComponent","BUTTON_COMPONENT_NAMES","dispatch","HOVERED","UNHOVERED","HoverButtonSystem","getHoverableButton","getSpecificHoverMenu","HoverMenuSystem","findHoverMenu","prevHoverMenu","SuperSpawnerSystem","maybeSpawn","superSpawner","performSpawn","spawnedEntity","copyState","STRENGTH","DROP","PICKUP","BUTTON_PRESSED","HOVER","STRETCH_BASE","STRETCH_DISTANCE","TELEPORTING","TELEPORTED","determineStrength","HapticFeedbackSystem","twoPointStretchingSystem","didClickButton","leftActuator","rightActuator","leftHandStrength","rightHandStrength","rightRemoteStrength","buttonPressedStrength","stretchingStrength","stretchSystem","stretcherLeft","stretcherRight","leftStrength","rightStrength","pulse","tempVec3","tempVec4","INSTANCE_DATA_BYTE_LENGTH","DEFAULT_COLOR","HIDE_MATRIX","makeScale","sizeofInstances","HubsBatchRawUniformGroup","BatchRawUniformGroup","maxInstances","ArrayBuffer","hubs_sweepParams","byteLength","hubs_interactorOnePos","hubs_isFrozen","Uint32Array","hubs_interactorTwoPos","hubs_time","instanceId","setInstanceTransform","setInstanceColor","isSpawner","hideDueToPinning","highlightInteractorOne","highlightInteractorTwo","MAX_INSTANCES","UBO_BYTE_LENGTH","BatchManagerSystem","WeakMap","WebGL2RenderingContext","getParameter","MAX_UNIFORM_BLOCK_SIZE","ubo","BatchManager","unlit","unlitBatchVert","unlitBatchFrag","rootObject","batchedCount","addMesh","removeMesh","LobbyCameraSystem","constraintsSystem","singleActionButtonSystem","holdableButtonSystem","hoverButtonSystem","hoverMenuSystem","superSpawnerSystem","hapticFeedbackSystem","SoundEffectsSystem","lobbyCameraSystem","_gotAudioTrack","_recorderTimeout","_initRecorder","_stream","_recorder","_tryAddingAudioTrack","multiviewVertPrefix","nonmultiviewVertPrefix","multiviewFragPrefix","nonmultiviewFragPrefix","didRegisterWithSystem","didFailToRegister","registered","updateUVs","normalizedFrame","memo","missingSprites","ret","raycastOnSprite","vA","vB","vC","vD","intersectionInfo","intersect","ray","intersectTriangle","getHoverableVisuals","comp","ZEROS","SpriteSystem","slots","indexWithSprite","maxSprites","spriteWithIndex","stack","concat","multiview","vert","frag","spritesheetPng","spritesheetTexture","RawShaderMaterial","u_spritesheet","mvCols","InterleavedBuffer","InterleavedBufferAttribute","indices","setIndex","createGeometry","renderOrder","RENDER_ORDER","HUD_ICONS","uniformsNeedUpdate","aEnableSweepingEffect","aSweepParams","enableSweepingEffectValue","setXY","aUvs","aVertices","setXYZ","hubsSystems","deltaScale","addScalar","clampScalar","HIGHLIGHT","NO_HIGHLIGHT","TRANSFORM_COLOR_1","TRANSFORM_COLOR_2","defaultDistance","minDistance","firstHitOnly","lineGeometry","Line","LineBasicMaterial","cameraPos","isGrabbing","addScaledVector","lerpHSL","posePosition","cursorPosition","positionArray","computeBoundingSphere","DRAW_MODE","drawFrequency","minDistanceBetweenPoints","drawingManager","availableColors","minRadius","maxRadius","timeSinceLastDraw","lastPosition","currentDrawing","worldPosition","colorIndex","grabbed","originalPosition","lastIntersectionDistance","MeshStandardMaterial","penTip","lineStartPosition","lineEndPosition","worldQuaternion","_startDraw","SOUND_PEN_START_DRAW","_endDraw","SOUND_PEN_STOP_DRAW","penScaleMod","_changeRadius","_changeColor","SOUND_PEN_CHANGE_COLOR","_undoDraw","SOUND_PEN_UNDO_DRAW","getLastWorldQuaternion","_setPenVisible","_setLineVisible","lastIntersectedObject","getLastPoint","_getNormal","draw","directionToCamera","crossVectors","startDraw","endDraw","undoDraw","mod","SharedBufferGeometry","primitiveMode","maxBufferSize","geometries","addBuffer","restartPrimitive","addVertex","prevIdx","componentSize","diff","undo","normals","colors","setDrawRange","addColor","g","addNormal","buffer","SharedBufferGeometryManager","sharedBuffers","addSharedBuffer","getSharedBuffer","copyData","fromIndex","toIndex","segments","defaultRadius","maxDrawTimeout","maxLines","maxPointsPerLine","_receiveData","networkBuffer","sendNetworkBufferQueue","drawStarted","lineStarted","remoteLineStarted","receivedBufferParts","bufferIndex","connectedToOwner","networkBufferInitialized","VertexColors","sharedBufferGeometryManager","lastPoint","lastSegments","currentSegments","sharedBuffer","vertexCount","networkBufferCount","currentPointCount","invalidPointRead","lastReadPointCount","networkBufferHistory","onConnect","getNetworkId","drawingId","subscribeToDataChannel","unsubscribeToDataChannel","isConnected","hasActiveDataChannel","sendDataGuaranteed","_broadcastDrawing","_drawFromNetwork","_sendNetworkBuffer","_deleteExpiredLines","copyArray","broadcastDataGuaranteed","didWork","pointCount","setHex","_draw","_updateBuffer","drawTime","datum","idxLength","uv","parts","ceil","dataType","_addToNetworkBuffer","getHexString","capNormal","radiusMultiplier","_generateSegments","_drawCylinder","_drawEndCap","_endLine","_addDegenerateTriangle","_restartPrimitive","_drawCap","_pushToNetworkBuffer","_drawPoint","projectedDirection","projectedPoint","clock","elapsedTime","copyDirection","copyNormal","setLength","getHex","_addVertex","down","segmentIndex","segment","segmentsList","angleIncrement","_rotatePointAroundAxis","calculatedDirection","registerNetworkSchemas","vectorRequiresUpdate","almostEqualVec3","schemas","component","requiresNetworkUpdate","nonAuthorizedComponents","BUILD_VERSION","patchWebGLRenderingContext","App","HUD_BACKGROUND","isEmbed","AmmoWasm","locateFile","firstSyncSource","syncSource","isTelemetryDisabled","loadingEnvironmentURL","registerTelemetry","disableiOSZoom","instanceKey","started_at","onStorageEvent","detectConcurrentLoad","uiProps","routerBaseName","createBrowserHistory","basename","qsVREntryType","userinputSets","Router","Route","react_components_ui_root","hub_objectSpread","hub_isBotMode","hub_store","hub_mediaSearchStore","mountUI","updateUIForHub","entry_code","updateEnvironmentForHub","isLegacyBundle","environmentScene","model_url","defaultSpaceTopic","topics","glbAsset","asset_type","bundleAsset","hasExtension","baseURL","LoaderUtils","extractUrlBase","environmentEl","childNodes","Cache","enterSceneWhenLoaded","hub_asyncToGenerator","WebAssembly","detectedOS","detectOS","ready","setRegistration","setRegistrationFailed","initialized","texImage2D","compressedTexImage2D","patchThreeAllocations","AuthChannel","_ref5","predicate","messageId","onFailure","_ref6","actionError","_x7","_x8","_x9","sceneInfo","isInOAuth","exitOAuth","clearOnLoadActions","serializableDetail","getTwitterOAuthURL","enqueueOnLoadAction","LinkChannel","handleEarlyVRMode","getVRDisplay","videoComponent","chatFocusTarget","RTCDataChannelEvent","buildNumber","hasVREntryDevice","onFirstEnvironmentLoad","previewCamera","reorder","setupLobbyCamera","runBotMode","retDeployReconnectInterval","retPhxChannel","setVapidPublicKey","vapid_public_key","_x10","pushSubscriptionEndpoint","getCurrentEndpoint","oauthFlowPermsToken","Cookies","createHubChannelParams","push_subscription_endpoint","auth_token","migrateToNewReticulumServer","_ref9","deployNotification","ret_version","ret_pool","tryReconnect","oldSocket","setSocket","teardown","_x11","_x12","hubPhxChannel","SOUND_CHAT_MESSAGE","messageDispatch","isInitialJoin","presenceSync","setPhoenixChannel","_ref12","session_token","vrHudPresenceCount","sendProfileUpdate","__hadInitialSync","isSelf","currentMeta","setClientId","setJoinToken","setHubChannel","setSubscribed","web_push","hub_requires_oauth","allowNAFTraffic","hubs","embedTokenEntry","executeOnLoadActions","onMediaSearchCancelled","objectsScene","objectsUrl","objectsEl","connectToScene","room","serverURL","newHostPollInterval","setReconnectionListeners","currentServerURL","serverUrl","newServerURL","getHost","sendViaPhoenix","reliable","isOpen","connectionState","reliableTransport","unreliableTransport","loadEnvironmentAndConnect","connectError","isFull","handleHubChannelJoined","_x13","oauth_info","onData","authorizeOrSanitizeMessage","incomingMessage","userInfo","getAuthor","_createInWorldLogMessage","createInWorldLogMessage","stale_fields","titleParts","oldSlug","slug","entry_mode","createDefaultEnvironmentMap","_createDefaultEnvironmentMap","urls","cubeMapPosX","cubeMapNegX","cubeMapPosY","cubeMapNegY","cubeMapPosZ","cubeMapNegZ","CubeTextureLoader","RGBFormat","envMap","_assets_sfx_tick_mp3__WEBPACK_IMPORTED_MODULE_0__","_assets_sfx_tick_mp3__WEBPACK_IMPORTED_MODULE_0___default","_assets_sfx_teleport_loop_mp3__WEBPACK_IMPORTED_MODULE_1__","_assets_sfx_teleport_loop_mp3__WEBPACK_IMPORTED_MODULE_1___default","_assets_sfx_quickTurn_mp3__WEBPACK_IMPORTED_MODULE_2__","_assets_sfx_quickTurn_mp3__WEBPACK_IMPORTED_MODULE_2___default","_assets_sfx_tap_mellow_mp3__WEBPACK_IMPORTED_MODULE_3__","_assets_sfx_tap_mellow_mp3__WEBPACK_IMPORTED_MODULE_3___default","_assets_sfx_PenSpawn_mp3__WEBPACK_IMPORTED_MODULE_4__","_assets_sfx_PenSpawn_mp3__WEBPACK_IMPORTED_MODULE_4___default","_assets_sfx_PenDraw1_mp3__WEBPACK_IMPORTED_MODULE_5__","_assets_sfx_PenDraw1_mp3__WEBPACK_IMPORTED_MODULE_5___default","_assets_sfx_PicSnapHey_mp3__WEBPACK_IMPORTED_MODULE_6__","_assets_sfx_PicSnapHey_mp3__WEBPACK_IMPORTED_MODULE_6___default","_assets_sfx_welcome_mp3__WEBPACK_IMPORTED_MODULE_7__","_assets_sfx_welcome_mp3__WEBPACK_IMPORTED_MODULE_7___default","_assets_sfx_quack_mp3__WEBPACK_IMPORTED_MODULE_8__","_assets_sfx_quack_mp3__WEBPACK_IMPORTED_MODULE_8___default","_assets_sfx_specialquack_mp3__WEBPACK_IMPORTED_MODULE_9__","_assets_sfx_specialquack_mp3__WEBPACK_IMPORTED_MODULE_9___default","_assets_sfx_pop_mp3__WEBPACK_IMPORTED_MODULE_10__","_assets_sfx_pop_mp3__WEBPACK_IMPORTED_MODULE_10___default","_assets_sfx_Eb_blip_mp3__WEBPACK_IMPORTED_MODULE_11__","_assets_sfx_Eb_blip_mp3__WEBPACK_IMPORTED_MODULE_11___default","_assets_sfx_tack_mp3__WEBPACK_IMPORTED_MODULE_12__","_assets_sfx_tack_mp3__WEBPACK_IMPORTED_MODULE_12___default","_assets_sfx_A_bendUp_mp3__WEBPACK_IMPORTED_MODULE_13__","_assets_sfx_A_bendUp_mp3__WEBPACK_IMPORTED_MODULE_13___default","_assets_sfx_suspense_mp3__WEBPACK_IMPORTED_MODULE_14__","_assets_sfx_suspense_mp3__WEBPACK_IMPORTED_MODULE_14___default","soundEnum","pendingEffects","soundsAndUrls","URL_TICK","URL_TELEPORT_LOOP","URL_QUICK_TURN","URL_TAP_MELLOW","URL_PEN_SPAWN","URL_PEN_DRAW","URL_CAMERA_SNAPSHOT","URL_WELCOME","URL_QUACK","URL_SPECIAL_QUACK","URL_POP","URL_FREEZE","URL_TACK","URL_MEDIA_LOADING","URL_MEDIA_LOADED","loading","audioBufferPromise","decodeAudioData","sounds","audioBuffer","enqueueSound","createBufferSource","createGain","detect_browser__WEBPACK_IMPORTED_MODULE_0__","lastTouchAtMs","getTime","isDoubleTouch","_storage_store__WEBPACK_IMPORTED_MODULE_0__","_storage_media_search_store__WEBPACK_IMPORTED_MODULE_1__","setQuality","componentRegistry","playerInfos","playerInfo","tip-root","tip-link","tip-cancel","split-tip","split-tip-icon","spawn_menu-icon","spawnMenuIcon","object_rotate_button-icon","objectRotateButtonIcon","object_scale_button-icon","objectScaleButtonIcon","object_recenter_button-icon","objectRecenterButtonIcon","HubsTextureLoader","manager","DefaultLoadingManager","onLoad","imageLoader","ImageBitmapLoader","setCrossOrigin","setPath","cacheKey","resolveURL","loader","loadAsync","onUpdate","mediaAPIEndpoint","resolveUrlCache","media_utils_asyncToGenerator","resultPromise","Content-Type","response","ok","statusText","desiredContentType","formData","FormData","interactableId","needsToBeUploaded","fireLoadingTimeout","reader","FileReader","view","DataView","getUint16","marker","getUint32","little","readAsArrayBuffer","getOrientation","srcUrl","uploadPromotionTokens","objectTypeForOriginAndContentType","vertexRegex","fragRegex","shaderUniforms","newMaterial","onBeforeCompile","vlines","vindex","unshift","flines","findex","mediaHighlightFrag","mediaPos","snapCount","mirrorOrientation","rotateY","eventType","_createImageTexture","TEXTURE_PROPS","base_map","emissive_map","normal_map","orm_map","ALL_MAPS","createRenderer","alpha","useDevicePixelRatio","antialias","premultipliedAlpha","preserveDrawingBuffer","powerPreference","WebGLRenderer","gammaOutput","gammaFactor","physicallyCorrectLights","setPixelRatio","devicePixelRatio","createImageBitmapFromURL","ORBIT_ANGLE","DEFAULT_MARGIN","fitBoxInFrustum","halfYExtents","halfVertFOV","fov","tan","AvatarPreview","clientWidth","clientHeight","OrbitControls","enablePan","HemisphereLight","loadPreviewAvatar","setAvatar","Clock","snapshotCanvas","snapshotCamera","snapshotRenderer","setClearAlpha","previewRenderer","setClearColor","getDelta","parentElement","setSize","resetCamera","getCenter","domElement","imageBitmaps","disposeImageBitmap","oldProps","applyMaps","previewMesh","idleAnimation","idleAnimationAction","getImage","originalMaps","bm","newProps","mapName","applyMap","applyMapToPreview","revertMap","react__WEBPACK_IMPORTED_MODULE_2___default","_assets_images_warning_icon_png__WEBPACK_IMPORTED_MODULE_0___default","_assets_images_warning_icon_2x_png__WEBPACK_IMPORTED_MODULE_1___default","react_intl__WEBPACK_IMPORTED_MODULE_4__","withRef","componentWillMount","react_intl__WEBPACK_IMPORTED_MODULE_2__","Sign_In_Message","_dialog_container__WEBPACK_IMPORTED_MODULE_5__","client-action-buttons","client-info-dialog","community-identifier","client-info","clientInfo","client-profile-image","client-details","clientDetails","client-main","clientMain","button-icon","name-field","room-settings-form","permissions-group","permission-disabled","computeObjectAABB","boxRoot","isEmpty","matrixWorldNeedsUpdate","dZ","load-button","hub-name","main-panel","HelmetComponent","react_helmet__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_1__","react__WEBPACK_IMPORTED_MODULE_1___default","pageTitle","titleRoot","Page_Title_Root","sizes","Favicon","Social_Description","Social_Image","Twitter_Handle","spoke-launch","change-scene-button","changeSceneButton","spoke-create","Airtable","configure","endpointUrl","apiKey","base","firstPage","fields","records","oauth-discord-button","oauth-twitter-button","oauth-button","oauth-type-name","oauth-icon","oauthIcon","privacy-notice","oauth-buttons","twitter-message","modifiedTranslations","i18n_messages","navigatorLang","language","userLanguage","localeData","debug__WEBPACK_IMPORTED_MODULE_0__","debug__WEBPACK_IMPORTED_MODULE_0___default","_qs_truthy__WEBPACK_IMPORTED_MODULE_1__","logFilter","calculateVolume","getByteTimeDomainData","amplitude","currVolume","tempScaleFromPosition","tempScaleToPosition","fromObject","toObject","minScale","maxScale","prevVolume","_updateAnalysis","createAnalyser","fftSize","frequencyBinCount","soundSource","avatarIsQuiet","currentVolume","lastSeenVolume","connectAnalyser","_playerCamera","audioAnalyser","SPRITE_NAMES","MIC_HOVER","MIC_OFF_HOVER","loudest","prevSpriteName","decayingVolume","spriteName","verifyAuthentication","authTopic","authToken","authPayload","handleAuthCredentials","tempVector3","disposeMaterial","mtrl","lightMap","bumpMap","normalMap","specularMap","materialArray","MeshFaceMaterial","MultiMaterial","presence-log","presence-log-entry","message-body","message-body-multi","message-body-mono","message-wrap","message-wrap-multi","message-source","message-source-link","icon-button","spawn-message","presence-log-entry-with-button","presence-log-in-room","presence-log-spawn","presence-log-entry-one-line","presence-log-emoji","tip-cancel-text","top-tip","column","attach_video_share_mode","attachVideoShareMode","attach_video_share_failed","attachVideoShareFailed","attach_pen_mode","attachPenMode","attach_mute_mode","attachMuteMode","attach_freeze_mode","attachFreezeMode","top-tip-no-hud","video-share-extra-options","small","large","video-share","freeze","mobile-media-picker","mobileMediaPicker","share_camera","shareCamera","share_screen","shareScreen","share_window","shareWindow","fn","emailParts","emailIdentity","emailDomain","dayjs","extend","relativeTime","PUBLISHER_FOR_ENTRY_TYPE","sketchfab_model","poly_model","twitch_stream","MediaTiles","isImage","isAvatar","imageAspect","imageWidth","imageHeight","imageSrc","isHub","getTileDimensions","publisherName","_state_link__WEBPACK_IMPORTED_MODULE_14__","_fortawesome_react_fontawesome__WEBPACK_IMPORTED_MODULE_6__","faExternalLinkAlt","react_intl__WEBPACK_IMPORTED_MODULE_5__","last_activated_at","fromNow","createTileWidth","createTileHeight","hasMeta","apiSource","isVariableWidth","hasNext","hasPrevious","entryToTile","previousPage","faAngleLeft","nextPage","originalGetExtension","WebGLRenderingContext","getExtension","supportsFloatTextures","dataTexture","DataTexture","FloatType","Camera","getError","checkFloatTextureSupport","deriveKey","privateKey","publicKey","crypto","subtle","public","publicKeyToString","exportKey","stringToPublicKey","importKey","namedCurve","stringToArrayBuffer","buf","arrayBufferToString","keyPair","generateKey","publicKeyString","incomingPublicKeyString","iv","incomingPublicKey","secret","encryptedData","encrypt","base64value","ciphertext","decrypt","LINK_ACTION_TIMEOUT","getLetter","readyToSend","leftChannel","leave","incoming","_generatePublicKeyAndEncryptedObject","generatePublicKeyAndEncryptedObject","public_key","target_session_id","reply_to_session_id","_generateKeys","generateKeys","numOccupants","_decryptObject","decryptObject","command-help","names","selectRandom","arr","avatarIds","av","generateDefaultProfile","LOCAL_STORE_KEY","STORE_STATE_CACHE_KEY","OAUTH_FLOW_CREDENTIALS_KEY","validator","Validator","additionalProperties","personalAvatarId","confirmedDiscordRooms","onLoadActions","$ref","oauthFlowCredentials","getJSON","resetConfirmedBroadcastedRooms","clearStoredArray","resetTipActivityFlags","currentEntryCount","arrayMerge","destinationArray","sourceArray","mergeOpts","finalState","validate","_fullscreen__WEBPACK_IMPORTED_MODULE_1__","isExitingFullscreenDueToFocus","cancel-button","confirm-button","URL_IMAGE","URL_VIDEO","URL_MODEL","URL_PDF","URL_AUDIO","FILE_IMAGE","FILE_VIDEO","FILE_MODEL","FILE_PDF","FILE_AUDIO","CLIPBOARD_IMAGE","CLIPBOARD_VIDEO","CLIPBOARD_MODEL","CLIPBOARD_PDF","CLIPBOARD_AUDIO","SPAWNER_IMAGE","SPAWNER_VIDEO","SPAWNER_MODEL","SPAWNER_PDF","SPAWNER_AUDIO","UNKNOWN","objectTypeForOrigin","urlType","fileType","clipboardType","spawnerType","objectTypeMimePrefixLookupMap","image/","model/","application/x-zip-compressed","video/","application/vnd.apple.mpegurl","application/x-mpegurl","audio/","application/pdf","srcSuffixLookupMap",".m3u8","invite-container","link-button","enter-vr-button","invite-button","inviteButton","enter-button","invite-mini-button","embed-text","invite-container-inverted","embed-tip-wrap","embed-tip","hide-small-screens","hideSmallScreens","invite-container-below-hud","digit_2","digit2","digit_3","digit3","hub-link-link","embed-tip-attach-point","bottom-links-main","bottomLinksMain","bottom-links","bottomLinks","settings-menu","settings-row","_qs_truthy__WEBPACK_IMPORTED_MODULE_0__","showLog","debugLog","debugLogInput","debugLogEval","onsubmit","eval","minimized","debugLogMinimize","onclick","scrollHeight","origConsoleLog","origConsoleError","origConsoleWarn","objs","firstObj","shouldScroll","onunhandledrejection","zeroPos","zeroQuat","oneScale","bindingSetters","PropertyBinding","SetterByBindingTypeAndVersioning","Versioning","setter","MatrixWorldNeedsUpdate","targetObject","getWorldScale","handleMatrixModification","cachedMatrixWorld","applyMatrix","forceLocalUpdate","forceWorldUpdate","skipParents","hasHadFirstMatrixUpdate","childrenNeedMatrixWorldUpdate","forceChildrenWorldUpdate","q1","m1","isVector3","isCamera","isLight","extractRotation","animation","colorHelperFrom","colorHelperTo","getComponentProperty","setComponentProperty","splitCache","TYPE_COLOR","STRING_COMPONENTS","STRING_OBJECT3D","toRadians","addEventListeners","eventNames","removeEventListeners","getRawProperty","splitDot","setRawProperty","propertyName","targetValue","startEvents","pauseEvents","resumeEvents","eventDetail","animationIsPlaying","onStartEvent","beginAnimation","pauseAnimation","resumeAnimation","fromColor","toColor","targetsArray","updateConfigForDefault","updateConfigForRawColor","createAndStartAnimation","cancelDelayedStart","pausedWasPlaying","updateConfig","delayTimeout","stopRelatedAnimations","waitComponentInitRawProperty","setColorConfig","isBoolean","isNaN","parseFloat","aframeProperty","updateConfigForVector","coordinates","propType","getPropertyType","cb","wait","AmbientLight","raven_js__WEBPACK_IMPORTED_MODULE_0__","raven_js__WEBPACK_IMPORTED_MODULE_0___default","ga","trackedPage","trackedTitle","sentryDsn","SENTRY_DSN","gaTrackingId","GA_TRACKING_ID","Raven","install","initialForce","maxForce","hasBody","CANNON","Vec3","applyForce","generateAndAddHeightfield","shape","mult","cannonOffset","Heightfield","elementSize","addShape","skyColor","groundColor","onQualityChanged","PointLight","innerConeAngle","outerConeAngle","SpotLight","penumbra","autoLockOnLoad","autoLockOnRelease","gravitySpeedLimit","onGrab","onRelease","ammoBody","_makeStaticWhenAtRest","linearThreshold","angularThreshold","isAtRest","getLinearVelocity","length2","getAngularVelocity","hasBeenHereBefore","_onBodyLoaded","setLocked","getVelocity","stuckTo","_unstickObject","sizeVec","boundingBoxWorldPositionVec","colliderWorldPositionVec","collidingLastFrame","setFromCenterAndSize","isColliding","onVideoLoaded","origDispatch","firstObject","ReactAudioContext","WithHoverSound","react__WEBPACK_IMPORTED_MODULE_0__","prop_types__WEBPACK_IMPORTED_MODULE_1__","prop_types__WEBPACK_IMPORTED_MODULE_1___default","createContext","Consumer","cloneElement","onMouseEnter","Pathfinding","Geometry","fromBufferGeometry","setZoneData","createZone","eventSource","eventListeners","_handleEvent","networkedTemplate","indexForNonAuthorizedComponent","nonAuthorizedComponent","fullComponent","schemaComponent","nonAuthorizedSchemas","sanitizeMessageData","schemaDict","initializeNonAuthorizedSchemas","nonAuthorizedIndices","authorizeEntityManipulation","sender","senderPermissions","isCreator","spawn_pen","authorizeOrSanitizeMessageData","getEntity","emptyObject","from_session_id","isFirstSync","toDataURL","imageBitmap","HTMLImageElement"],"mappings":"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AClCusF,GAAAlwD,EAAAzQ,cAAA,WACE2gE,GAAAlwD,EAAAzQ,cAACihE,GAAA,EAAD,CAAkBh8E,eAAgB7Q,EAAE40B,MAAM,KAAK,2HAhC5C8zE,eACA,CACjBK,eAAgB37D,KAAUE,OAC1Bw7D,MAAO17D,KAAUC,qFCPrB,MAAM47D,GAAyB,GAGzBC,GAAc,CAClBC,MAAM,EACNC,MAAM,EACNC,MAAM,EACNC,MAAM,EACNC,SAAS,EACTC,UAAU,EACVC,OAAO,EACPC,QAAQ,EACRC,OAAO,EACPC,OAAO,GAKHC,GAAW,CACf,IACA,OACA,UACA,OACA,UACA,QACA,QACA,IACA,OACA,MACA,MACA,aACA,OACA,KACA,SACA,SACA,UACA,SACA,OACA,OACA,MACA,WACA,UACA,WACA,KACA,MACA,UACA,MACA,MACA,KACA,KACA,KACA,QACA,WACA,aACA,SACA,OACA,SACA,OACA,KACA,KACA,KACA,KACA,KACA,KACA,OACA,SACA,SACA,KACA,OACA,IACA,SACA,MACA,QACA,MACA,MACA,SACA,QACA,SACA,KACA,OACA,MACA,OACA,OACA,OACA,OACA,QACA,MACA,OACA,WACA,SACA,KACA,SACA,WACA,SACA,IACA,QACA,MACA,WACA,IACA,KACA,KACA,OACA,IACA,OACA,SACA,UACA,SACA,QACA,SACA,OACA,SACA,QACA,MACA,UACA,MACA,MACA,QACA,QACA,KACA,WACA,QACA,KACA,QACA,OACA,QACA,KACA,QACA,IACA,KACA,MACA,QACA,OAGF,SAASC,GAA6BC,GACpC,MAAMC,EAAe,GACfC,EAAUpxF,SAAS1W,KAAK6W,YAAYH,SAAS+S,cAAcm+E,IAC3DG,EAAgBC,iBAAiBF,GACvC,IAAK,IAAIjsG,EAAI,EAAGA,EAAIksG,EAAchsG,OAAQF,IACxCgsG,EAAaE,EAAclsG,IAAMksG,EAAcA,EAAclsG,IAG/D,OADA6a,SAAS1W,KAAKqX,YAAYywF,GACnBD,EAWF,SAASI,KACd,IAAK,IAAIpsG,EAAI,EAAGA,EAAI6rG,GAAS3rG,OAAQF,IAC9BkrG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GvU,OACAmV,QAAQ,KAAM/0B,GAASqK,KAAKmmB,OAAOhB,SAASshG,WAAa9wH,EAAK8wH,YAC9D/7F,QAAQ,QAASjyB,GAAKiB,QAAQC,MAAMlB,SAvI3CuH,KAAKgnB,MAAQA,yBCLjBrvB,EAAAD,QAAA,CAAkBg6K,eAAA,yCAAA7wE,YAAA,yCAAAlX,MAAA,kCAAAsX,QAAA,+ICClB,MAAM0wE,EAAQ,CACZ,gBACA,cACA,oBACA,cACA,YACA,cACA,aACA,aACA,aACA,gBACA,gBACA,gBACA,gBACA,YACA,eACA,mBACA,mBACA,iBACA,gBACA,kBACA,eACA,eACA,mBACA,iBACA,WACA,cACA,gBACA,UACA,WACA,gBACA,cACA,YACA,WACA,YACA,YACA,mBACA,iBACA,aACA,aACA,YACA,cACA,eACA,cACA,cACA,UACA,WACA,eACA,eACA,YACA,mBACA,gBACA,oBACA,kBACA,YACA,cACA,kBACA,aACA,cACA,eACA,cACA,cACA,cACA,iBACA,kBACA,cACA,WACA,WACA,cACA,OACA,mBACA,cACA,mBACA,cACA,iBACA,aACA,cACA,cACA,gBACA,qBACA,iBACA,eACA,gBACA,eACA,SACA,YACA,iBAGF,SAASC,EAAaC,GACpB,OAAOA,EAAI1lK,KAAKs2D,MAAMt2D,KAAK8F,SAAW4/J,EAAI17K,SAOrC,MAAM27K,EAAYz9I,IAAQ3yB,IAAIqwK,GAAMA,EAAGjpK,IAEvC,SAASkpK,IACd,MAAO,CACLx9I,SAAUo9I,EAAaE,ggBClG3B,MAAMG,EAAkB,gBAClBC,EAAwBx5K,SACxBy5K,EAA6B,qCAC7BC,EAAY,IAAIC,YAMTpnF,EAAS,CACpBniF,GAAI,aAEJoiF,YAAa,CACXvhE,QAAS,CACPpqB,KAAM,SACN+yK,sBAAsB,EACtB59F,WAAY,CACV5iD,YAAa,CAAEvyB,KAAM,SAAUyrF,QAAS,wBACxCx2D,SAAU,CAAEj1B,KAAM,UAClBgzK,iBAAkB,CAAEhzK,KAAM,YAI9B0nB,YAAa,CACX1nB,KAAM,SACN+yK,sBAAsB,EACtB59F,WAAY,CACV3tD,MAAO,CA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","file":"assets/js/hub-788e86660eeae220e7ff.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t6: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// script path function\n \tfunction jsonpScriptSrc(chunkId) {\n \t\treturn __webpack_require__.p + \"assets/js/\" + ({}[chunkId]||chunkId) + \"-\" + {}[chunkId] + \".js\"\n \t}\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n \t// The chunk loading function for additional chunks\n \t// Since all referenced chunks are already included\n \t// in this file, this function is empty here.\n \t__webpack_require__.e = function requireEnsure() {\n \t\treturn Promise.resolve();\n \t};\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// on error function for async loading\n \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([2214,1,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"media-browser\":\"media-browser__media-browser__y0Hsu\",\"mediaBrowser\":\"media-browser__media-browser__y0Hsu\",\"facets\":\"media-browser__facets__1Yz65\",\"facet\":\"media-browser__facet__2uP6U\",\"body\":\"media-browser__body__j6Tv2\",\"pager\":\"media-browser__pager__RKx5O\",\"header-center\":\"media-browser__header-center__2D9CW\",\"headerCenter\":\"media-browser__header-center__2D9CW\",\"search\":\"media-browser__search__3gQ84\",\"engine-attribution\":\"media-browser__engine-attribution__2P2aD\",\"engineAttribution\":\"media-browser__engine-attribution__2P2aD\",\"engine-attribution-contents\":\"media-browser__engine-attribution-contents__gCdfr\",\"engineAttributionContents\":\"media-browser__engine-attribution-contents__gCdfr\",\"favorites-header\":\"media-browser__favorites-header__1XzZx\",\"favoritesHeader\":\"media-browser__favorites-header__1XzZx\",\"search-clear\":\"media-browser__search-clear__2GkP3\",\"searchClear\":\"media-browser__search-clear__2GkP3\",\"search-icon\":\"media-browser__search-icon__g1Sj9\",\"searchIcon\":\"media-browser__search-icon__g1Sj9\",\"box\":\"media-browser__box__1KHYi\",\"header\":\"media-browser__header__zqZ09\",\"no-search\":\"media-browser__no-search__3N90H\",\"noSearch\":\"media-browser__no-search__3N90H\",\"nav\":\"media-browser__nav__9J5If\",\"nav-right-pad\":\"media-browser__nav-right-pad__1qH0B\",\"navRightPad\":\"media-browser__nav-right-pad__1qH0B\",\"nav-source\":\"media-browser__nav-source__o6NI6\",\"navSource\":\"media-browser__nav-source__o6NI6\",\"nav-source-selected\":\"media-browser__nav-source-selected__2osjH\",\"navSourceSelected\":\"media-browser__nav-source-selected__2osjH\",\"nav-scroll-arrow\":\"media-browser__nav-scroll-arrow__2Nikk\",\"navScrollArrow\":\"media-browser__nav-scroll-arrow__2Nikk\",\"tiles\":\"media-browser__tiles__1BYEY\",\"tile\":\"media-browser__tile__2lzHU\",\"info\":\"media-browser__info__2c8Zs\",\"name\":\"media-browser__name__RFiE4\",\"attribution\":\"media-browser__attribution__3glgj\",\"creator\":\"media-browser__creator__3LDPh\",\"publisher\":\"media-browser__publisher__mTzsX\",\"last-joined\":\"media-browser__last-joined__2DVWf\",\"lastJoined\":\"media-browser__last-joined__2DVWf\",\"tile-link\":\"media-browser__tile-link__IXyUO\",\"tileLink\":\"media-browser__tile-link__IXyUO\",\"tile-content\":\"media-browser__tile-content__1QYSP\",\"tileContent\":\"media-browser__tile-content__1QYSP\",\"avatar-tile\":\"media-browser__avatar-tile__qNo2r\",\"avatarTile\":\"media-browser__avatar-tile__qNo2r\",\"edit-avatar\":\"media-browser__edit-avatar__2HBfV\",\"editAvatar\":\"media-browser__edit-avatar__2HBfV\",\"create-tile\":\"media-browser__create-tile__RL9vr\",\"createTile\":\"media-browser__create-tile__RL9vr\",\"tiles-variable\":\"media-browser__tiles-variable__1ZNxg\",\"tilesVariable\":\"media-browser__tiles-variable__1ZNxg\",\"page-number\":\"media-browser__page-number__OTpSH\",\"pageNumber\":\"media-browser__page-number__OTpSH\",\"pager-button-disabled\":\"media-browser__pager-button-disabled__ytlSN\",\"pagerButtonDisabled\":\"media-browser__pager-button-disabled__ytlSN\",\"header-left\":\"media-browser__header-left__1ObQh\",\"headerLeft\":\"media-browser__header-left__1ObQh\",\"header-right\":\"media-browser__header-right__3k3JZ\",\"headerRight\":\"media-browser__header-right__3k3JZ\",\"create-button\":\"media-browser__create-button__30hMV\",\"createButton\":\"media-browser__create-button__30hMV\",\"create-link\":\"media-browser__create-link__28Bpj\",\"createLink\":\"media-browser__create-link__28Bpj\",\"empty-string\":\"media-browser__empty-string__3r0tc\",\"emptyString\":\"media-browser__empty-string__3r0tc\",\"media-browser-inline\":\"media-browser__media-browser-inline__3AgWD\",\"mediaBrowserInline\":\"media-browser__media-browser-inline__3AgWD\"};","export default function nextTick() {\n  return new Promise(resolve => {\n    setTimeout(resolve, 0);\n  });\n}\n","const boundingBox = new THREE.Box3();\nconst frustumBox = new THREE.Box3();\nconst inverseLightMatrixWorld = new THREE.Matrix4();\nconst tempBox = new THREE.Box3();\nconst FRUSTUM_PADDING = 1;\nconst NEAR_CLIPPING_PLANE = -500;\nconst FAR_CLIPPING_PLANE = 500;\nconst verts = [\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3()\n];\n\nexport default function resizeShadowCameraFrustum(light, scene) {\n  // Reset bounding box\n  frustumBox.makeEmpty();\n  boundingBox.makeEmpty();\n\n  // Grow the extents of boundingBox for every geometry in the scene that has castShadow set to true.\n  scene.traverse(node => {\n    const geometry = node.geometry;\n\n    if (geometry && node.castShadow) {\n      if (!geometry.boundingBox) {\n        geometry.computeBoundingBox();\n      }\n\n      tempBox.copy(geometry.boundingBox);\n\n      // Apply matrix transforming bounding box from model space to world space\n      tempBox.applyMatrix4(node.matrixWorld);\n\n      boundingBox.union(tempBox);\n    }\n  });\n\n  // Transform the resulting bounding box from world space to light space.\n  // Construct a new bounding box in light space that contains the corners of the bounding box in world space.\n  const min = boundingBox.min;\n  const max = boundingBox.max;\n\n  verts[0].set(min.x, min.y, min.z);\n  verts[1].set(min.x, min.y, max.z);\n  verts[2].set(min.x, max.y, min.z);\n  verts[3].set(min.x, max.y, max.z);\n  verts[4].set(max.x, min.y, min.z);\n  verts[5].set(max.x, min.y, max.z);\n  verts[6].set(max.x, max.y, min.z);\n  verts[7].set(max.x, max.y, max.z);\n\n  inverseLightMatrixWorld.getInverse(light.shadow.camera.matrixWorld);\n\n  for (let i = 0; i < verts.length; i++) {\n    verts[i].applyMatrix4(inverseLightMatrixWorld);\n    frustumBox.expandByPoint(verts[i]);\n  }\n\n  // Update the camera frustum to fit the resulting bounding box.\n  // Everything in the frustum that has castShadow set to true will cast a shadow.\n  // Everything in the frustum that has receiveShadow set to true will receive a shadow.\n  // FRUSTUM_PADDING is added to avoid clipping the edges of shadows.\n  // TODO: Determine why shadows flicker when light is moved fast. The light's matrixWorld is probably being updated a frame behind.\n  const camera = light.shadow.camera;\n  camera.left = frustumBox.min.x - FRUSTUM_PADDING;\n  camera.right = frustumBox.max.x + FRUSTUM_PADDING;\n  camera.bottom = frustumBox.min.y - FRUSTUM_PADDING;\n  camera.top = frustumBox.max.y + FRUSTUM_PADDING;\n  camera.near = frustumBox.min.z + NEAR_CLIPPING_PLANE;\n  camera.far = frustumBox.max.z + FAR_CLIPPING_PLANE;\n  camera.updateProjectionMatrix();\n}\n","import resizeShadowCameraFrustum from \"../utils/resizeShadowCameraFrustum\";\n\nAFRAME.registerComponent(\"directional-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 },\n    castShadow: { default: true },\n    shadowMapResolution: { default: [512, 512] },\n    shadowBias: { default: 0 },\n    shadowRadius: { default: 1 }\n  },\n\n  init() {\n    const el = this.el;\n    this.light = new THREE.DirectionalLight();\n    this.light.position.set(0, 0, 0);\n    this.light.target.position.set(0, 0, 1);\n    this.light.add(this.light.target);\n    this.el.setObject3D(\"directional-light\", this.light);\n    this.el.sceneEl.systems.light.registerLight(el);\n    this.rendererSystem = this.el.sceneEl.systems.renderer;\n  },\n\n  update(prevData) {\n    const light = this.light;\n\n    if (this.data.color !== prevData.color) {\n      const color = new THREE.Color(this.data.color);\n      this.rendererSystem.applyColorCorrection(color);\n      light.color.copy(color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      light.intensity = this.data.intensity;\n    }\n\n    if (this.data.castShadow !== prevData.castShadow) {\n      light.castShadow = this.data.castShadow;\n    }\n\n    if (this.data.shadowBias !== prevData.shadowBias) {\n      light.shadow.bias = this.data.shadowBias;\n    }\n\n    if (this.data.shadowRadius !== prevData.shadowRadius) {\n      light.shadow.radius = this.data.shadowRadius;\n    }\n\n    const [width, height] = this.data.shadowMapResolution;\n    const [prevWidth, prevHeight] = prevData.shadowMapResolution ? prevData.shadowMapResolution : [512, 512];\n\n    if (width !== prevWidth || height !== prevHeight) {\n      light.shadow.mapSize.set(width, height);\n\n      if (light.shadow.map) {\n        light.shadow.map.dispose();\n        light.shadow.map = null;\n      }\n    }\n\n    this.light.shadow.camera.matrixNeedsUpdate = true;\n  },\n\n  tick() {\n    if (window.APP && window.APP.quality === \"low\") {\n      return;\n    }\n\n    resizeShadowCameraFrustum(this.light, this.el.sceneEl.object3D);\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"directional-light\");\n  }\n});\n","export const Layers = {\n  // Layers 0 - 2 reserverd by ThreeJS and AFrame.\n  reflection: 3\n};\n\n/**\n * Sets layer flags on the underlying Object3D\n * @namespace environment\n * @component layers\n */\nAFRAME.registerComponent(\"layers\", {\n  schema: {\n    reflection: { type: \"boolean\", default: false },\n    inWorldHud: { type: \"boolean\", default: false },\n    exclusive: { type: \"boolean\", default: false } // if true, only these layers will be set\n  },\n  init() {\n    this.update = this.update.bind(this);\n    this.el.addEventListener(\"model-loaded\", this.update);\n  },\n  update(oldData) {\n    const obj = this.el.object3D;\n\n    if (this.data.exclusive) {\n      obj.traverse(o => (o.layers.mask = 0));\n    }\n\n    for (const [name, layer] of Object.entries(Layers)) {\n      const oldValue = oldData[name];\n      const newValue = this.data[name];\n\n      if (oldValue !== newValue) {\n        if (newValue) {\n          obj.traverse(o => o.layers.enable(layer));\n        } else {\n          obj.traverse(o => o.layers.disable(layer));\n        }\n      }\n    }\n  },\n  remove() {\n    this.el.removeEventListener(\"model-loaded\", this.update);\n  }\n});\n","import { findAncestorWithComponent } from \"../utils/scene-graph\";\n\n/**\n * Loops the given clip using this entity's animation mixer\n * @component loop-animation\n */\nAFRAME.registerComponent(\"loop-animation\", {\n  schema: {\n    paused: { type: \"boolean\", default: false },\n    clip: { type: \"string\" }\n  },\n\n  init() {\n    this.mixerEl = findAncestorWithComponent(this.el, \"animation-mixer\");\n\n    if (!this.mixerEl) {\n      console.warn(\"loop-animation component could not find an animation-mixer in its ancestors.\");\n      return;\n    }\n\n    this.updateClip();\n  },\n\n  update(oldData) {\n    if ((oldData.clip !== this.data.clip || oldData.paused !== this.data.paused) && this.mixerEl) {\n      if (oldData.clip !== this.data.clip) {\n        this.updateClip();\n      }\n\n      if (this.currentAction) {\n        this.currentAction.paused = this.data.paused;\n      }\n    }\n  },\n\n  updateClip() {\n    const { mixer, animations } = this.mixerEl.components[\"animation-mixer\"];\n    const clipName = this.data.clip;\n\n    if (animations.length === 0) {\n      return;\n    }\n\n    let clip;\n\n    if (!clipName) {\n      clip = animations[0];\n    } else {\n      clip = animations.find(({ name }) => name === clipName);\n    }\n\n    if (!clip) {\n      return;\n    }\n\n    const action = mixer.clipAction(clip, this.el.object3D);\n    action.enabled = true;\n    action.setLoop(THREE.LoopRepeat, Infinity).play();\n    this.currentAction = action;\n  },\n\n  destroy() {\n    if (this.currentAction) {\n      this.currentAction.enabled = false;\n      this.currentAction.stop();\n    }\n  }\n});\n","import { getBox, getScaleCoefficient } from \"../utils/auto-box-collider\";\nimport { resolveUrl, injectCustomShaderChunks } from \"../utils/media-utils\";\nimport {\n  guessContentType,\n  proxiedUrlFor,\n  isHubsRoomUrl,\n  isHubsSceneUrl,\n  isHubsAvatarUrl\n} from \"../utils/media-url-utils\";\nimport { addAnimationComponents } from \"../utils/animation\";\nimport qsTruthy from \"../utils/qs_truthy\";\n\nimport \"three/examples/js/loaders/GLTFLoader\";\nimport loadingObjectSrc from \"../assets/LoadingObject_Atom.glb\";\nimport { SOUND_MEDIA_LOADING, SOUND_MEDIA_LOADED } from \"../systems/sound-effects-system\";\n\nimport anime from \"animejs\";\n\nconst SHAPE = require(\"aframe-physics-system/src/constants\").SHAPE;\n\nconst gltfLoader = new THREE.GLTFLoader();\nlet loadingObjectEnvMap;\nlet loadingObject;\ngltfLoader.load(loadingObjectSrc, gltf => {\n  loadingObject = gltf;\n});\n\nconst fetchContentType = url => {\n  return fetch(url, { method: \"HEAD\" }).then(r => r.headers.get(\"content-type\"));\n};\n\nconst boundingBox = new THREE.Box3();\n\nconst batchMeshes = qsTruthy(\"batchMeshes\");\nconst disableBatching = qsTruthy(\"disableBatching\");\n\nAFRAME.registerComponent(\"media-loader\", {\n  schema: {\n    fileId: { type: \"string\" },\n    fileIsOwned: { type: \"boolean\" },\n    src: { type: \"string\" },\n    resize: { default: false },\n    resolve: { default: false },\n    contentType: { default: null },\n    contentSubtype: { default: null },\n    animate: { default: true },\n    mediaOptions: {\n      default: {},\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\n      stringify: JSON.stringify\n    }\n  },\n\n  init() {\n    this.onError = this.onError.bind(this);\n    this.showLoader = this.showLoader.bind(this);\n    this.clearLoadingTimeout = this.clearLoadingTimeout.bind(this);\n    this.onMediaLoaded = this.onMediaLoaded.bind(this);\n    this.animating = false;\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.networkedEl = networkedEl;\n    });\n  },\n\n  updateScale: (function() {\n    const center = new THREE.Vector3();\n    return function(resize) {\n      const mesh = this.el.getObject3D(\"mesh\");\n      const box = getBox(this.el, mesh);\n      const scaleCoefficient = resize ? getScaleCoefficient(0.5, box) : 1;\n      mesh.scale.multiplyScalar(scaleCoefficient);\n      const { min, max } = box;\n      center.addVectors(min, max).multiplyScalar(0.5 * scaleCoefficient);\n      mesh.position.sub(center);\n      mesh.matrixNeedsUpdate = true;\n    };\n  })(),\n\n  removeShape(id) {\n    if (this.el.getAttribute(\"ammo-shape__\" + id)) {\n      this.el.removeAttribute(\"ammo-shape__\" + id);\n    }\n  },\n\n  tick(t, dt) {\n    if (this.loaderMixer) {\n      this.loaderMixer.update(dt / 1000);\n    }\n  },\n\n  remove() {\n    if (this.loadingSoundNode) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.stopSoundNode(this.loadingSoundNode);\n      this.loadingSoundNode = null;\n    }\n  },\n\n  onError() {\n    this.el.removeAttribute(\"gltf-model-plus\");\n    this.el.removeAttribute(\"media-pager\");\n    this.el.removeAttribute(\"media-video\");\n    this.el.removeAttribute(\"media-pdf\");\n    this.el.setAttribute(\"media-image\", { src: \"error\" });\n    this.clearLoadingTimeout();\n  },\n\n  showLoader() {\n    if (this.el.object3DMap.mesh) {\n      this.clearLoadingTimeout();\n      return;\n    }\n    const useFancyLoader = !!loadingObject;\n\n    const mesh = useFancyLoader\n      ? loadingObject.scene.clone()\n      : new THREE.Mesh(new THREE.BoxGeometry(), new THREE.MeshBasicMaterial());\n    this.el.setObject3D(\"mesh\", mesh);\n\n    this.updateScale(true);\n\n    if (useFancyLoader) {\n      const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\n      const currentEnivronmentMap = environmentMapComponent.environmentMap;\n      if (loadingObjectEnvMap !== currentEnivronmentMap) {\n        environmentMapComponent.applyEnvironmentMap(mesh);\n        loadingObjectEnvMap = currentEnivronmentMap;\n      }\n\n      this.loaderMixer = new THREE.AnimationMixer(mesh);\n\n      this.loadingClip = this.loaderMixer.clipAction(loadingObject.animations[0]);\n      this.loadingScaleClip = this.loaderMixer.clipAction(\n        new THREE.AnimationClip(null, 1000, [\n          new THREE.VectorKeyframeTrack(\".scale\", [0, 0.2], [0, 0, 0, mesh.scale.x, mesh.scale.y, mesh.scale.z])\n        ])\n      );\n      setTimeout(() => {\n        if (!this.loaderMixer) return; // Animation/loader was stopped early\n        this.el.setAttribute(\"ammo-shape__loader\", { type: SHAPE.BOX });\n      }, 200);\n\n      this.loadingClip.play();\n      this.loadingScaleClip.play();\n    }\n\n    if (this.el.sceneEl.is(\"entered\") && (!this.networkedEl || NAF.utils.isMine(this.networkedEl))) {\n      this.loadingSoundNode = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundLooped(\n        SOUND_MEDIA_LOADING\n      );\n    }\n\n    delete this.showLoaderTimeout;\n  },\n\n  clearLoadingTimeout() {\n    clearTimeout(this.showLoaderTimeout);\n    if (this.loadingSoundNode) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.stopSoundNode(this.loadingSoundNode);\n      this.loadingSoundNode = null;\n    }\n    if (this.loaderMixer) {\n      this.loadingClip.stop();\n      this.loadingScaleClip.stop();\n      delete this.loaderMixer;\n      delete this.loadingScaleClip;\n      delete this.loadingClip;\n    }\n    delete this.showLoaderTimeout;\n    this.removeShape(\"loader\");\n  },\n\n  updateHoverableVisuals() {\n    const hoverableVisuals = this.el.components[\"hoverable-visuals\"];\n\n    if (hoverableVisuals) {\n      if (!this.injectedCustomShaderChunks) {\n        this.injectedCustomShaderChunks = true;\n        hoverableVisuals.uniforms = injectCustomShaderChunks(this.el.object3D);\n      }\n\n      boundingBox.setFromObject(this.el.object3DMap.mesh);\n      boundingBox.getBoundingSphere(hoverableVisuals.boundingSphere);\n    }\n  },\n\n  onMediaLoaded(physicsShape = null, shouldUpdateScale) {\n    const el = this.el;\n    this.clearLoadingTimeout();\n\n    if (this.el.sceneEl.is(\"entered\")) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_MEDIA_LOADED);\n    }\n\n    const finish = () => {\n      this.animating = false;\n\n      if (physicsShape) {\n        el.setAttribute(\"ammo-shape\", {\n          type: physicsShape,\n          minHalfExtent: 0.04\n        });\n      }\n\n      this.updateHoverableVisuals();\n\n      const pager = el.components[\"media-pager\"];\n\n      if (pager) {\n        pager.repositionToolbar();\n      }\n    };\n\n    if (this.data.animate) {\n      if (!this.animating) {\n        this.animating = true;\n        if (shouldUpdateScale) this.updateScale(this.data.resize);\n        const mesh = this.el.getObject3D(\"mesh\");\n        const scale = { x: 0.001, y: 0.001, z: 0.001 };\n        scale.x = mesh.scale.x < scale.x ? mesh.scale.x * 0.001 : scale.x;\n        scale.y = mesh.scale.y < scale.y ? mesh.scale.x * 0.001 : scale.y;\n        scale.z = mesh.scale.z < scale.z ? mesh.scale.x * 0.001 : scale.z;\n        this.addMeshScaleAnimation(mesh, scale, finish);\n      }\n    } else {\n      if (shouldUpdateScale) this.updateScale(this.data.resize);\n      finish();\n    }\n  },\n\n  addMeshScaleAnimation(mesh, initialScale, onComplete) {\n    const step = (function() {\n      const lastValue = {};\n      return function(anim) {\n        const value = anim.animatables[0].target;\n\n        value.x = Math.max(Number.MIN_VALUE, value.x);\n        value.y = Math.max(Number.MIN_VALUE, value.y);\n        value.z = Math.max(Number.MIN_VALUE, value.z);\n\n        // For animation timeline.\n        if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\n          return;\n        }\n\n        lastValue.x = value.x;\n        lastValue.y = value.y;\n        lastValue.z = value.z;\n\n        mesh.scale.set(value.x, value.y, value.z);\n        mesh.matrixNeedsUpdate = true;\n      };\n    })();\n\n    const config = {\n      duration: 400,\n      easing: \"easeOutElastic\",\n      elasticity: 400,\n      loop: 0,\n      round: false,\n      x: mesh.scale.x,\n      y: mesh.scale.y,\n      z: mesh.scale.z,\n      targets: [initialScale],\n      update: anim => step(anim),\n      complete: anim => {\n        step(anim);\n        onComplete();\n      }\n    };\n\n    mesh.scale.copy(initialScale);\n    mesh.matrixNeedsUpdate = true;\n\n    return anime(config);\n  },\n\n  async update(oldData) {\n    try {\n      const { src, contentSubtype } = this.data;\n\n      if (src !== oldData.src && !this.showLoaderTimeout) {\n        this.showLoaderTimeout = setTimeout(this.showLoader, 100);\n      }\n\n      if (!src) return;\n\n      let canonicalUrl = src;\n      let accessibleUrl = src;\n      let contentType = this.data.contentType;\n      let thumbnail;\n\n      if (this.data.resolve) {\n        const result = await resolveUrl(src);\n        canonicalUrl = result.origin;\n        // handle protocol relative urls\n        if (canonicalUrl.startsWith(\"//\")) {\n          canonicalUrl = location.protocol + canonicalUrl;\n        }\n        contentType = (result.meta && result.meta.expected_content_type) || contentType;\n        thumbnail = result.meta && result.meta.thumbnail && proxiedUrlFor(result.meta.thumbnail);\n      }\n\n      // todo: we don't need to proxy for many things if the canonical URL has permissive CORS headers\n      accessibleUrl = proxiedUrlFor(canonicalUrl);\n\n      // if the component creator didn't know the content type, we didn't get it from reticulum, and\n      // we don't think we can infer it from the extension, we need to make a HEAD request to find it out\n      contentType = contentType || guessContentType(canonicalUrl) || (await fetchContentType(accessibleUrl));\n\n      // We don't want to emit media_resolved for index updates.\n      if (src !== oldData.src) {\n        this.el.emit(\"media_resolved\", { src, raw: accessibleUrl, contentType });\n      }\n\n      if (\n        contentType.startsWith(\"video/\") ||\n        contentType.startsWith(\"audio/\") ||\n        AFRAME.utils.material.isHLS(canonicalUrl, contentType)\n      ) {\n        const parsedUrl = new URL(src);\n        const qsTime = parseInt(parsedUrl.searchParams.get(\"t\"));\n        const hashTime = parseInt(new URLSearchParams(parsedUrl.hash.substring(1)).get(\"t\"));\n        const startTime = hashTime || qsTime || 0;\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-image\");\n        this.el.removeAttribute(\"media-pdf\");\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\n        this.el.addEventListener(\n          \"video-loaded\",\n          e => {\n            this.onMediaLoaded(e.detail.projection === \"flat\" ? SHAPE.BOX : null);\n          },\n          { once: true }\n        );\n        this.el.setAttribute(\n          \"media-video\",\n          Object.assign({}, this.data.mediaOptions, { src: accessibleUrl, time: startTime, contentType })\n        );\n        if (this.el.components[\"position-at-box-shape-border__freeze\"]) {\n          this.el.setAttribute(\"position-at-box-shape-border__freeze\", { dirs: [\"forward\", \"back\"] });\n        }\n      } else if (contentType.startsWith(\"image/\")) {\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-video\");\n        this.el.removeAttribute(\"media-pdf\");\n        this.el.removeAttribute(\"media-pager\");\n        this.el.addEventListener(\n          \"image-loaded\",\n          e => {\n            this.onMediaLoaded(e.detail.projection === \"flat\" ? SHAPE.BOX : null);\n\n            if (contentSubtype === \"photo-camera\") {\n              this.el.setAttribute(\"hover-menu__photo\", {\n                template: \"#photo-hover-menu\",\n                dirs: [\"forward\", \"back\"]\n              });\n            }\n          },\n          { once: true }\n        );\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\n        this.el.setAttribute(\n          \"media-image\",\n          // Object.assign({}, this.data.mediaOptions, { src: accessibleUrl, contentType, batch: !disableBatching })\n          Object.assign({}, this.data.mediaOptions, { src: accessibleUrl, contentType, batch: false })\n        );\n\n        if (this.el.components[\"position-at-box-shape-border__freeze\"]) {\n          this.el.setAttribute(\"position-at-box-shape-border__freeze\", { dirs: [\"forward\", \"back\"] });\n        }\n      } else if (contentType.startsWith(\"application/pdf\")) {\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-video\");\n        this.el.removeAttribute(\"media-image\");\n        this.el.setAttribute(\n          \"media-pdf\",\n          Object.assign({}, this.data.mediaOptions, {\n            src: accessibleUrl,\n            contentType,\n            batch: false // Batching disabled until atlas is updated properly\n          })\n        );\n        this.el.setAttribute(\"media-pager\", {});\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\n        this.el.addEventListener(\n          \"pdf-loaded\",\n          () => {\n            this.clearLoadingTimeout();\n            this.onMediaLoaded(SHAPE.BOX);\n          },\n          { once: true }\n        );\n\n        if (this.el.components[\"position-at-box-shape-border__freeze\"]) {\n          this.el.setAttribute(\"position-at-box-shape-border__freeze\", { dirs: [\"forward\", \"back\"] });\n        }\n      } else if (\n        contentType.includes(\"application/octet-stream\") ||\n        contentType.includes(\"x-zip-compressed\") ||\n        contentType.startsWith(\"model/gltf\")\n      ) {\n        this.el.removeAttribute(\"media-image\");\n        this.el.removeAttribute(\"media-video\");\n        this.el.removeAttribute(\"media-pdf\");\n        this.el.removeAttribute(\"media-pager\");\n        this.el.addEventListener(\n          \"model-loaded\",\n          () => {\n            this.onMediaLoaded(SHAPE.HULL, true);\n            addAnimationComponents(this.el);\n          },\n          { once: true }\n        );\n        this.el.addEventListener(\"model-error\", this.onError, { once: true });\n        this.el.setAttribute(\n          \"gltf-model-plus\",\n          Object.assign({}, this.data.mediaOptions, {\n            src: accessibleUrl,\n            contentType: contentType,\n            inflate: true,\n            batch: !disableBatching && batchMeshes,\n            modelToWorldScale: this.data.resize ? 0.0001 : 1.0\n          })\n        );\n      } else if (contentType.startsWith(\"text/html\")) {\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-video\");\n        this.el.removeAttribute(\"media-pdf\");\n        this.el.removeAttribute(\"media-pager\");\n        this.el.addEventListener(\n          \"image-loaded\",\n          () => {\n            const mayChangeScene = this.el.sceneEl.systems.permissions.can(\"update_hub\");\n\n            if (isHubsAvatarUrl(src)) {\n              this.el.setAttribute(\"hover-menu__hubs-item\", {\n                template: \"#avatar-link-hover-menu\",\n                dirs: [\"forward\", \"back\"]\n              });\n            } else if (isHubsRoomUrl(src) || (isHubsSceneUrl(src) && mayChangeScene)) {\n              this.el.setAttribute(\"hover-menu__hubs-item\", {\n                template: \"#hubs-destination-hover-menu\",\n                dirs: [\"forward\", \"back\"]\n              });\n            } else {\n              this.el.setAttribute(\"hover-menu__link\", { template: \"#link-hover-menu\", dirs: [\"forward\", \"back\"] });\n            }\n            this.onMediaLoaded(SHAPE.BOX);\n          },\n          { once: true }\n        );\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\n        this.el.setAttribute(\n          \"media-image\",\n          Object.assign({}, this.data.mediaOptions, {\n            src: thumbnail,\n            contentType: guessContentType(thumbnail) || \"image/png\",\n            batch: !disableBatching\n          })\n        );\n        if (this.el.components[\"position-at-box-shape-border__freeze\"]) {\n          this.el.setAttribute(\"position-at-box-shape-border__freeze\", { dirs: [\"forward\", \"back\"] });\n        }\n      } else {\n        throw new Error(`Unsupported content type: ${contentType}`);\n      }\n    } catch (e) {\n      console.error(\"Error adding media\", e);\n      this.onError();\n    }\n  }\n});\n\nAFRAME.registerComponent(\"media-pager\", {\n  schema: {\n    index: { default: 0 },\n    maxIndex: { default: 0 }\n  },\n\n  init() {\n    this.toolbar = null;\n    this.onNext = this.onNext.bind(this);\n    this.onPrev = this.onPrev.bind(this);\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.networkedEl = networkedEl;\n    });\n\n    this.el.addEventListener(\"pdf-loaded\", async () => {\n      await this._ensureUI();\n      this.update();\n    });\n  },\n\n  async _ensureUI() {\n    if (this.hasSetupUI) return;\n    if (!this.data.maxIndex) return;\n\n    this.hasSetupUI = true;\n\n    // unfortunately, since we loaded the page image in an img tag inside media-image, we have to make a second\n    // request for the same page to read out the max-content-index header\n    const template = document.getElementById(\"paging-toolbar\");\n    this.el.querySelector(\".interactable-ui\").appendChild(document.importNode(template.content, true));\n    this.toolbar = this.el.querySelector(\".paging-toolbar\");\n    // we have to wait a tick for the attach callbacks to get fired for the elements in a template\n    setTimeout(() => {\n      this.nextButton = this.el.querySelector(\".next-button [text-button]\");\n      this.prevButton = this.el.querySelector(\".prev-button [text-button]\");\n      this.pageLabel = this.el.querySelector(\".page-label\");\n\n      this.nextButton.object3D.addEventListener(\"interact\", this.onNext);\n      this.prevButton.object3D.addEventListener(\"interact\", this.onPrev);\n\n      this.update();\n      this.el.emit(\"pager-loaded\");\n    }, 0);\n  },\n\n  async update() {\n    await this._ensureUI();\n\n    if (this.pageLabel) {\n      this.pageLabel.setAttribute(\"text\", \"value\", `${this.data.index + 1}/${this.data.maxIndex + 1}`);\n      this.repositionToolbar();\n    }\n  },\n\n  remove() {\n    if (this.toolbar) {\n      this.toolbar.parentNode.removeChild(this.toolbar);\n    }\n  },\n\n  onNext() {\n    if (!NAF.utils.isMine(this.networkedEl) && !NAF.utils.takeOwnership(this.networkedEl)) return;\n    const newIndex = Math.min(this.data.index + 1, this.data.maxIndex);\n    this.el.setAttribute(\"media-pdf\", \"index\", newIndex);\n    this.el.setAttribute(\"media-pager\", \"index\", newIndex);\n    this.el.emit(\"pager-page-changed\");\n  },\n\n  onPrev() {\n    if (!NAF.utils.isMine(this.networkedEl) && !NAF.utils.takeOwnership(this.networkedEl)) return;\n    const newIndex = Math.max(this.data.index - 1, 0);\n    this.el.setAttribute(\"media-pdf\", \"index\", newIndex);\n    this.el.setAttribute(\"media-pager\", \"index\", newIndex);\n    this.el.emit(\"pager-page-changed\");\n  },\n\n  repositionToolbar() {\n    const ammoShape = this.el.getAttribute(\"ammo-shape\");\n    if (!ammoShape) return;\n    if (!this.toolbar) return;\n\n    this.toolbar.object3D.position.y = -0.7;\n    this.toolbar.object3D.matrixNeedsUpdate = true;\n  }\n});\n","import { SOUND_QUACK, SOUND_SPECIAL_QUACK } from \"../systems/sound-effects-system\";\n\nAFRAME.registerComponent(\"quack\", {\n  schema: {\n    quackPercentage: { default: 1 },\n    specialQuackPercentage: { default: 0.01 }\n  },\n\n  init: function() {\n    this._handleGrabStart = this._handleGrabStart.bind(this);\n  },\n\n  play: function() {\n    this.el.object3D.addEventListener(\"interact\", this._handleGrabStart);\n  },\n\n  pause: function() {\n    this.el.object3D.removeEventListener(\"interact\", this._handleGrabStart);\n  },\n\n  _handleGrabStart: function() {\n    const rand = Math.random();\n    if (rand < this.data.specialQuackPercentage) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SPECIAL_QUACK);\n    } else if (rand < this.data.quackPercentage) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_QUACK);\n    }\n  }\n});\n","import { setMatrixWorld } from \"../utils/three-utils\";\nimport { getCurrentStreamer } from \"../utils/component-utils\";\n\nfunction getStreamerCamera() {\n  const streamer = getCurrentStreamer();\n  if (streamer) {\n    return streamer.el.querySelector(\".camera\").object3D;\n  }\n  return null;\n}\n\nfunction lerp(start, end, t) {\n  return (1 - t) * start + t * end;\n}\n\nconst newRot = new THREE.Quaternion();\n\n/**\n * Nicely pans the camera for previewing a scene. There's some weirdness with this right now\n * since it ends up panning in a direction dependent upon the start camera orientation,\n * but it's good enough for now.\n */\nAFRAME.registerComponent(\"scene-preview-camera\", {\n  schema: {\n    duration: { default: 90, type: \"number\" },\n    positionOnly: { default: false, type: \"boolean\" }\n  },\n\n  init: function() {\n    this.startPoint = this.el.object3D.position.clone();\n    this.startRotation = this.el.object3D.quaternion.clone();\n\n    this.targetPoint = this.el.object3D.position.clone();\n    this.targetPoint.y = Math.max(this.targetPoint.y - 1.5, 1);\n    this.targetPoint.add(new THREE.Vector3(2, 0, -2));\n\n    const targetRotDelta = new THREE.Euler(-0.15, 0.0, 0.15);\n    this.targetRotation = new THREE.Quaternion();\n    this.targetRotation.setFromEuler(targetRotDelta);\n    this.targetRotation.premultiply(this.startRotation);\n\n    this.startTime = performance.now();\n    this.backwards = false;\n    this.ranOnePass = false;\n  },\n\n  tick2: function() {\n    const streamerCamera = getStreamerCamera();\n    if (streamerCamera) {\n      setMatrixWorld(this.el.object3D, streamerCamera.matrixWorld);\n      // Move camera forward just a bit so that we don't see the avatar's eye cylinders.\n      this.el.object3D.translateZ(-0.1);\n      this.el.object3D.matrixNeedsUpdate = true;\n    } else {\n      let t = (performance.now() - this.startTime) / (1000.0 * this.data.duration);\n      t = Math.min(1.0, Math.max(0.0, t));\n\n      if (!this.ranOnePass) {\n        t = t * (2 - t);\n      } else {\n        t = t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n      }\n\n      const from = this.backwards ? this.targetPoint : this.startPoint;\n      const to = this.backwards ? this.startPoint : this.targetPoint;\n      const fromRot = this.backwards ? this.targetRotation : this.startRotation;\n      const toRot = this.backwards ? this.startRotation : this.targetRotation;\n\n      THREE.Quaternion.slerp(fromRot, toRot, newRot, t);\n\n      this.el.object3D.position.set(lerp(from.x, to.x, t), lerp(from.y, to.y, t), lerp(from.z, to.z, t));\n\n      if (!this.data.positionOnly) {\n        this.el.object3D.rotation.setFromQuaternion(newRot);\n      }\n\n      this.el.object3D.matrixNeedsUpdate = true;\n\n      if (t >= 0.9999) {\n        this.ranOnePass = true;\n        this.backwards = !this.backwards;\n        this.startTime = performance.now();\n      }\n    }\n  }\n});\n","import \"three/examples/js/pmrem/PMREMGenerator\";\nimport \"three/examples/js/pmrem/PMREMCubeUVPacker\";\nimport qsTruthy from \"../utils/qs_truthy\";\nconst isBotMode = qsTruthy(\"bot\");\n\n/**\n * @author zz85 / https://github.com/zz85\n *\n * Based on \"A Practical Analytic Model for Daylight\"\n * aka The Preetham Model, the de facto standard analytic skydome model\n * http://www.cs.utah.edu/~shirley/papers/sunsky/sunsky.pdf\n *\n * First implemented by Simon Wallner\n * http://www.simonwallner.at/projects/atmospheric-scattering\n *\n * Improved by Martin Upitis\n * http://blenderartists.org/forum/showthread.php?245954-preethams-sky-impementation-HDR\n *\n * Three.js integration by zz85 http://twitter.com/blurspline\n */\n\nTHREE.Sky = function() {\n  const shader = THREE.Sky.SkyShader;\n\n  const material = new THREE.ShaderMaterial({\n    fragmentShader: shader.fragmentShader,\n    vertexShader: shader.vertexShader,\n    uniforms: THREE.UniformsUtils.clone(shader.uniforms),\n    side: THREE.BackSide\n  });\n\n  THREE.Mesh.call(this, new THREE.BoxBufferGeometry(1, 1, 1), material);\n};\n\nTHREE.Sky.prototype = Object.create(THREE.Mesh.prototype);\nTHREE.Sky.prototype.constructor = THREE.Sky;\n\nTHREE.Sky.SkyShader = {\n  uniforms: {\n    luminance: { value: 1 },\n    turbidity: { value: 2 },\n    rayleigh: { value: 1 },\n    mieCoefficient: { value: 0.005 },\n    mieDirectionalG: { value: 0.8 },\n    sunPosition: { value: new THREE.Vector3() }\n  },\n\n  vertexShader: [\n    \"uniform vec3 sunPosition;\",\n    \"uniform float rayleigh;\",\n    \"uniform float turbidity;\",\n    \"uniform float mieCoefficient;\",\n\n    \"varying vec3 vWorldPosition;\",\n    \"varying vec3 vSunDirection;\",\n    \"varying float vSunfade;\",\n    \"varying vec3 vBetaR;\",\n    \"varying vec3 vBetaM;\",\n    \"varying float vSunE;\",\n\n    \"const vec3 up = vec3( 0.0, 1.0, 0.0 );\",\n\n    // constants for atmospheric scattering\n    \"const float e = 2.71828182845904523536028747135266249775724709369995957;\",\n    \"const float pi = 3.141592653589793238462643383279502884197169;\",\n\n    // wavelength of used primaries, according to preetham\n    \"const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );\",\n    // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:\n    // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))\n    \"const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );\",\n\n    // mie stuff\n    // K coefficient for the primaries\n    \"const float v = 4.0;\",\n    \"const vec3 K = vec3( 0.686, 0.678, 0.666 );\",\n    // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K\n    \"const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );\",\n\n    // earth shadow hack\n    // cutoffAngle = pi / 1.95;\n    \"const float cutoffAngle = 1.6110731556870734;\",\n    \"const float steepness = 1.5;\",\n    \"const float EE = 1000.0;\",\n\n    \"float sunIntensity( float zenithAngleCos ) {\",\n    \"\tzenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );\",\n    \"\treturn EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );\",\n    \"}\",\n\n    \"vec3 totalMie( float T ) {\",\n    \"\tfloat c = ( 0.2 * T ) * 10E-18;\",\n    \"\treturn 0.434 * c * MieConst;\",\n    \"}\",\n\n    \"void main() {\",\n\n    \"\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\",\n    \"\tvWorldPosition = worldPosition.xyz;\",\n\n    \"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n    \"\tvSunDirection = normalize( sunPosition );\",\n\n    \"\tvSunE = sunIntensity( dot( vSunDirection, up ) );\",\n\n    \"\tvSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );\",\n\n    \"\tfloat rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );\",\n\n    // extinction (absorbtion + out scattering)\n    // rayleigh coefficients\n    \"\tvBetaR = totalRayleigh * rayleighCoefficient;\",\n\n    // mie coefficients\n    \"\tvBetaM = totalMie( turbidity ) * mieCoefficient;\",\n\n    \"}\"\n  ].join(\"\\n\"),\n\n  fragmentShader: [\n    \"varying vec3 vWorldPosition;\",\n    \"varying vec3 vSunDirection;\",\n    \"varying float vSunfade;\",\n    \"varying vec3 vBetaR;\",\n    \"varying vec3 vBetaM;\",\n    \"varying float vSunE;\",\n\n    \"uniform float luminance;\",\n    \"uniform float mieDirectionalG;\",\n\n    \"const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );\",\n\n    // constants for atmospheric scattering\n    \"const float pi = 3.141592653589793238462643383279502884197169;\",\n\n    \"const float n = 1.0003;\", // refractive index of air\n    \"const float N = 2.545E25;\", // number of molecules per unit volume for air at\n    // 288.15K and 1013mb (sea level -45 celsius)\n\n    // optical length at zenith for molecules\n    \"const float rayleighZenithLength = 8.4E3;\",\n    \"const float mieZenithLength = 1.25E3;\",\n    \"const vec3 up = vec3( 0.0, 1.0, 0.0 );\",\n    // 66 arc seconds -> degrees, and the cosine of that\n    \"const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;\",\n\n    // 3.0 / ( 16.0 * pi )\n    \"const float THREE_OVER_SIXTEENPI = 0.05968310365946075;\",\n    // 1.0 / ( 4.0 * pi )\n    \"const float ONE_OVER_FOURPI = 0.07957747154594767;\",\n\n    \"float rayleighPhase( float cosTheta ) {\",\n    \"\treturn THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );\",\n    \"}\",\n\n    \"float hgPhase( float cosTheta, float g ) {\",\n    \"\tfloat g2 = pow( g, 2.0 );\",\n    \"\tfloat inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );\",\n    \"\treturn ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );\",\n    \"}\",\n\n    // Filmic ToneMapping http://filmicgames.com/archives/75\n    \"const float A = 0.15;\",\n    \"const float B = 0.50;\",\n    \"const float C = 0.10;\",\n    \"const float D = 0.20;\",\n    \"const float E = 0.02;\",\n    \"const float F = 0.30;\",\n\n    \"const float whiteScale = 1.0748724675633854;\", // 1.0 / Uncharted2Tonemap(1000.0)\n\n    \"vec3 Uncharted2Tonemap( vec3 x ) {\",\n    \"\treturn ( ( x * ( A * x + C * B ) + D * E ) / ( x * ( A * x + B ) + D * F ) ) - E / F;\",\n    \"}\",\n\n    \"void main() {\",\n    // optical length\n    // cutoff angle at 90 to avoid singularity in next formula.\n    \"\tfloat zenithAngle = acos( max( 0.0, dot( up, normalize( vWorldPosition - cameraPos ) ) ) );\",\n    \"\tfloat inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );\",\n    \"\tfloat sR = rayleighZenithLength * inverse;\",\n    \"\tfloat sM = mieZenithLength * inverse;\",\n\n    // combined extinction factor\n    \"\tvec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );\",\n\n    // in scattering\n    \"\tfloat cosTheta = dot( normalize( vWorldPosition - cameraPos ), vSunDirection );\",\n\n    \"\tfloat rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );\",\n    \"\tvec3 betaRTheta = vBetaR * rPhase;\",\n\n    \"\tfloat mPhase = hgPhase( cosTheta, mieDirectionalG );\",\n    \"\tvec3 betaMTheta = vBetaM * mPhase;\",\n\n    \"\tvec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );\",\n    \"\tLin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );\",\n\n    // nightsky\n    \"\tvec3 direction = normalize( vWorldPosition - cameraPos );\",\n    \"\tfloat theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]\",\n    \"\tfloat phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]\",\n    \"\tvec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );\",\n    \"\tvec3 L0 = vec3( 0.1 ) * Fex;\",\n\n    // composition + solar disc\n    \"\tfloat sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );\",\n    \"\tL0 += ( vSunE * 19000.0 * Fex ) * sundisk;\",\n\n    \"\tvec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );\",\n\n    \"\tvec3 curr = Uncharted2Tonemap( ( log2( 2.0 / pow( luminance, 4.0 ) ) ) * texColor );\",\n    \"\tvec3 color = curr * whiteScale;\",\n\n    \"\tvec3 retColor = pow( color, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );\",\n\n    \"\tgl_FragColor = vec4( retColor, 1.0 );\",\n\n    \"}\"\n  ].join(\"\\n\")\n};\n\nAFRAME.registerComponent(\"skybox\", {\n  schema: {\n    turbidity: { type: \"number\", default: 10 },\n    rayleigh: { type: \"number\", default: 2 },\n    luminance: { type: \"number\", default: 1 },\n    mieCoefficient: { type: \"number\", default: 0.005 },\n    mieDirectionalG: { type: \"number\", default: 0.8 },\n    inclination: { type: \"number\", default: 0 },\n    azimuth: { type: \"number\", default: 0.15 },\n    distance: { type: \"number\", default: 8000 }\n  },\n\n  init() {\n    this.sky = new THREE.Sky();\n    this.el.setObject3D(\"mesh\", this.sky);\n    this.skyScene = new THREE.Scene();\n    this.cubeCamera = new THREE.CubeCamera(1, 100000, 512);\n    this.skyScene.add(this.cubeCamera);\n\n    this.updateEnvironmentMap = this.updateEnvironmentMap.bind(this);\n    // HACK: Render environment map on next frame to avoid bug where the render target texture is black.\n    // This is likely due to the custom elements attached callback being synchronous on Chrome but not Firefox.\n    // Added timeout due to additional case where texture is black in Firefox.\n    requestAnimationFrame(() => setTimeout(this.updateEnvironmentMap));\n  },\n\n  update(oldData) {\n    const uniforms = this.sky.material.uniforms;\n\n    if (this.data.turbidity !== oldData.turbidity) {\n      uniforms.turbidity.value = this.data.turbidity;\n    }\n\n    if (this.data.rayleigh !== oldData.rayleigh) {\n      uniforms.rayleigh.value = this.data.rayleigh;\n    }\n\n    if (this.data.luminance !== oldData.luminance) {\n      uniforms.luminance.value = this.data.luminance;\n    }\n\n    if (this.data.mieCoefficient !== oldData.mieCoefficient) {\n      uniforms.mieCoefficient.value = this.data.mieCoefficient;\n    }\n\n    if (this.data.mieDirectionalG !== oldData.mieDirectionalG) {\n      uniforms.mieDirectionalG.value = this.data.mieDirectionalG;\n    }\n\n    if (\n      this.data.inclination !== oldData.inclination ||\n      this.data.azimuth !== oldData.azimuth ||\n      this.data.distance !== oldData.distance\n    ) {\n      const theta = Math.PI * (this.data.inclination - 0.5);\n      const phi = 2 * Math.PI * (this.data.azimuth - 0.5);\n\n      const distance = this.data.distance;\n\n      const x = distance * Math.cos(phi);\n      const y = distance * Math.sin(phi) * Math.sin(theta);\n      const z = distance * Math.sin(phi) * Math.cos(theta);\n\n      uniforms.sunPosition.value.set(x, y, z).normalize();\n\n      // HACK Remove this if condition and always set the scale based on distance when the existing environments\n      // have their sky scales set to 1.\n      if (this.el.object3D.scale.x === 1) {\n        this.sky.scale.set(distance, distance, distance);\n      }\n\n      this.el.object3D.matrixNeedsUpdate = true;\n    }\n\n    this.updateEnvironmentMap();\n  },\n\n  updateEnvironmentMap() {\n    const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\n\n    if (environmentMapComponent && !isBotMode) {\n      const renderer = this.el.sceneEl.renderer;\n      this.skyScene.add(this.sky);\n      this.cubeCamera.update(renderer, this.skyScene);\n      this.el.setObject3D(\"mesh\", this.sky);\n      const vrEnabled = renderer.vr.enabled;\n      renderer.vr.enabled = false;\n      const pmremGenerator = new THREE.PMREMGenerator(this.cubeCamera.renderTarget.texture);\n      pmremGenerator.update(renderer);\n      const pmremCubeUVPacker = new THREE.PMREMCubeUVPacker(pmremGenerator.cubeLods);\n      pmremCubeUVPacker.update(renderer);\n      renderer.vr.enabled = vrEnabled;\n      environmentMapComponent.updateEnvironmentMap(pmremCubeUVPacker.CubeUVRenderTarget.texture);\n      pmremGenerator.dispose();\n      pmremCubeUVPacker.dispose();\n    }\n  },\n\n  remove() {\n    this.el.removeObject3D(\"mesh\");\n  }\n});\n","import { getLastWorldPosition } from \"../utils/three-utils\";\n\n/**\n * Used on a player-rig to move the player to a random spawn point on entry.\n * @namespace avatar\n * @component spawn-controller\n */\nAFRAME.registerComponent(\"spawn-controller\", {\n  schema: {\n    target: { type: \"selector\" },\n    camera: { type: \"selector\", default: \"#player-camera\" },\n    playerHeight: { default: 1.6 },\n    loadedEvent: { type: \"string\" }\n  },\n  init() {\n    this.moveToSpawnPoint = this.moveToSpawnPoint.bind(this);\n    this.data.target.addEventListener(this.data.loadedEvent, this.moveToSpawnPoint);\n  },\n  moveToSpawnPoint() {\n    const spawnPoints = document.querySelectorAll(\"[spawn-point]\");\n\n    if (spawnPoints.length === 0) {\n      // Keep default position\n      return;\n    }\n\n    const camera = this.data.camera;\n    const spawnPointIndex = Math.round((spawnPoints.length - 1) * Math.random());\n    const spawnPoint = spawnPoints[spawnPointIndex];\n\n    getLastWorldPosition(spawnPoint.object3D, this.el.object3D.position);\n    this.el.object3D.rotation.copy(spawnPoint.object3D.rotation);\n\n    if (this.el.sceneEl.is(\"vr-mode\")) {\n      // Rotate the player rig such that the vr-camera faces forward.\n      this.el.object3D.rotation.y -= this.data.camera.object3D.rotation.y;\n    } else {\n      // Reset the camera transform in 2D mode.\n      camera.object3D.position.set(0, this.data.playerHeight, 0);\n      camera.object3D.rotation.set(0, 0, 0);\n      camera.object3D.matrixNeedsUpdate = true;\n    }\n\n    // Camera faces -Z direction. Flip rotation on Y axis to face the correct direction.\n    this.el.object3D.rotation.y += Math.PI;\n    this.el.object3D.matrixNeedsUpdate = true;\n\n    // Reset pitch-yaw-rotator after any scene-preview-camera rotation.\n    if (camera.components[\"pitch-yaw-rotator\"]) {\n      camera.components[\"pitch-yaw-rotator\"].set(camera.object3D.rotation.x, camera.object3D.rotation.y);\n    }\n  }\n});\n\n/**\n * Marks an entity as a potential spawn point.\n * @namespace environment\n * @component spawn-point\n */\nAFRAME.registerComponent(\"spawn-point\", {\n  init() {\n    this.el.object3D.visible = false;\n  }\n});\n","/* global require AFRAME THREE setTimeout clearTimeout */\nimport { addMedia } from \"../utils/media-utils\";\nimport { waitForEvent } from \"../utils/async-utils\";\nimport { ObjectContentOrigins } from \"../object-types\";\nimport { paths } from \"../systems/userinput/paths\";\n\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\n\n/**\n * Spawns networked objects when grabbed or when a specified event is fired.\n * @namespace network\n * @component super-spawner\n */\nAFRAME.registerComponent(\"super-spawner\", {\n  schema: {\n    /**\n     * Source of the media asset the spawner will spawn when grabbed. This can be a gltf, video, or image, or a url that the reticiulm media API can resolve to a gltf, video, or image.\n     */\n    src: { default: \"\" },\n\n    /**\n     * Whether to use the Reticulum media resolution API to interpret the src URL (e.g. find a video URL for Youtube videos.)\n     */\n    resolve: { default: false },\n\n    /**\n     * Whether to resize the media on load.\n     */\n    resize: { default: false },\n\n    /**\n     * The template to use for this object\n     */\n    template: { default: \"\" },\n\n    /**\n     * Spawn the object at a custom position, rather than at the center of the spanwer.\n     */\n    useCustomSpawnPosition: { default: false },\n    spawnPosition: { type: \"vec3\" },\n\n    /**\n     * Spawn the object with a custom orientation, rather than copying that of the spawner.\n     */\n    useCustomSpawnRotation: { default: false },\n    spawnRotation: { type: \"vec4\" },\n\n    /**\n     * Spawn the object with a custom scale, rather than copying that of the spawner.\n     */\n    useCustomSpawnScale: { default: false },\n    spawnScale: { type: \"vec3\" },\n\n    /**\n     * The spawner will become invisible and ungrabbable for this ammount of time after being grabbed. This can prevent rapidly spawning objects.\n     */\n    spawnCooldown: { default: 1 },\n\n    /**\n     * Center the spawned object on the hand that grabbed it after it finishes loading. By default the object will be grabbed relative to where the spawner was grabbed\n     */\n    centerSpawnedObject: { default: false },\n\n    /**\n     * Optional event to listen for to spawn an object on the preferred superHand\n     */\n    spawnEvent: { type: \"string\" },\n\n    /**\n     * If true, will spawn the object at the cursor and animate it into the hand.\n     */\n    animateFromCursor: { type: \"boolean\" }\n  },\n\n  init() {\n    this.cooldownTimeout = null;\n    this.handPosition = new THREE.Vector3();\n\n    this.onSpawnEvent = this.onSpawnEvent.bind(this);\n\n    this.sceneEl = document.querySelector(\"a-scene\");\n\n    this.tempSpawnHandPosition = new THREE.Vector3();\n  },\n\n  play() {\n    if (this.data.spawnEvent) {\n      this.el.sceneEl.addEventListener(this.data.spawnEvent, this.onSpawnEvent);\n    }\n  },\n\n  pause() {\n    if (this.data.spawnEvent) {\n      this.el.sceneEl.removeEventListener(this.data.spawnEvent, this.onSpawnEvent);\n    }\n    if (this.cooldownTimeout) {\n      clearTimeout(this.cooldownTimeout);\n      this.cooldownTimeout = null;\n      this.el.setAttribute(\"visible\", true);\n      this.el.classList.add(\"interactable\");\n    }\n  },\n\n  async onSpawnEvent() {\n    if (this.cooldownTimeout || !this.el.sceneEl.is(\"entered\")) {\n      return;\n    }\n\n    const entity = addMedia(\n      this.data.src,\n      this.data.template,\n      ObjectContentOrigins.SPAWNER,\n      null,\n      this.data.resolve,\n      false\n    ).entity;\n\n    const cursor = document.querySelector(\"#cursor\");\n    cursor.object3D.getWorldPosition(entity.object3D.position);\n    cursor.object3D.getWorldQuaternion(entity.object3D.quaternion);\n    entity.object3D.matrixNeedsUpdate = true;\n\n    if (this.data.useCustomSpawnScale) {\n      entity.object3D.scale.copy(this.data.spawnScale);\n    }\n\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const willAnimateFromCursor = this.data.animateFromCursor && userinput.get(paths.actions.rightHand.matrix);\n    if (!willAnimateFromCursor) {\n      interaction.state.rightRemote.held = entity;\n      interaction.state.rightRemote.spawning = true;\n    }\n    this.activateCooldown();\n    await waitForEvent(\"body-loaded\", entity);\n\n    cursor.object3D.getWorldPosition(entity.object3D.position);\n    cursor.object3D.getWorldQuaternion(entity.object3D.quaternion);\n    entity.object3D.matrixNeedsUpdate = true;\n\n    if (willAnimateFromCursor) {\n      document.querySelector(\"#player-right-controller\").object3D.getWorldPosition(this.handPosition);\n      entity.setAttribute(\"animation__spawn-at-cursor\", {\n        property: \"position\",\n        delay: 500,\n        dur: 1500,\n        from: { x: entity.object3D.position.x, y: entity.object3D.position.y, z: entity.object3D.position.z },\n        to: { x: this.handPosition.x, y: this.handPosition.y, z: this.handPosition.z },\n        easing: \"easeInOutBack\"\n      });\n    } else {\n      interaction.state.rightRemote.spawning = false;\n    }\n    entity.components[\"ammo-body\"].syncToPhysics();\n  },\n\n  activateCooldown() {\n    if (this.data.spawnCooldown > 0) {\n      const [sx, sy, sz] = [this.el.object3D.scale.x, this.el.object3D.scale.y, this.el.object3D.scale.z];\n\n      this.el.setAttribute(\"visible\", false);\n      this.el.object3D.scale.set(0.001, 0.001, 0.001);\n      this.el.object3D.matrixNeedsUpdate = true;\n      this.el.classList.remove(\"interactable\");\n      this.el.setAttribute(\"ammo-body\", { collisionFilterMask: COLLISION_LAYERS.NONE });\n      this.cooldownTimeout = setTimeout(() => {\n        this.el.setAttribute(\"visible\", true);\n        this.el.classList.add(\"interactable\");\n        this.el.setAttribute(\"ammo-body\", { collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER });\n        this.el.removeAttribute(\"animation__spawner-cooldown\");\n        this.el.setAttribute(\"animation__spawner-cooldown\", {\n          property: \"scale\",\n          delay: 50,\n          dur: 350,\n          from: { x: 0.001, y: 0.001, z: 0.001 },\n          to: { x: sx, y: sy, z: sz },\n          easing: \"easeOutElastic\"\n        });\n\n        this.cooldownTimeout = null;\n      }, this.data.spawnCooldown * 1000);\n    }\n  }\n});\n","import { Layers } from \"./layers\";\nimport \"../vendor/Water\";\nimport waterNormalMap from \"../assets/waternormals.jpg\";\n\n/**\n * @author jbouny / https://github.com/jbouny\n *\n * Work based on :\n * @author Slayvin / http://slayvin.net : Flat mirror for three.js\n * @author Stemkoski / http://www.adelphi.edu/~stemkoski : An implementation of water shader based on the flat mirror\n * @author Jonas Wagner / http://29a.ch/ && http://29a.ch/slides/2012/webglwater/ : Water shader explanations in WebGL\n */\n\nfunction MobileWater(geometry, options) {\n  THREE.Mesh.call(this, geometry);\n\n  const scope = this;\n\n  options = options || {};\n\n  const time = options.time !== undefined ? options.time : 0.0;\n  const normalSampler = options.waterNormals !== undefined ? options.waterNormals : null;\n  const sunDirection =\n    options.sunDirection !== undefined ? options.sunDirection : new THREE.Vector3(0.70707, 0.70707, 0.0);\n  const sunColor = new THREE.Color(options.sunColor !== undefined ? options.sunColor : 0xffffff);\n  const waterColor = new THREE.Color(options.waterColor !== undefined ? options.waterColor : 0x7f7f7f);\n  const eye = options.eye !== undefined ? options.eye : new THREE.Vector3(0, 0, 0);\n  const distortionScale = options.distortionScale !== undefined ? options.distortionScale : 20.0;\n  const side = options.side !== undefined ? options.side : THREE.FrontSide;\n  const fog = options.fog !== undefined ? options.fog : false;\n\n  const mirrorShader = {\n    uniforms: THREE.UniformsUtils.merge([\n      THREE.UniformsLib[\"lights\"],\n      {\n        normalSampler: { value: null },\n        time: { value: 0.0 },\n        size: { value: 1.0 },\n        distortionScale: { value: 20.0 },\n        sunColor: { value: new THREE.Color(0x7f7f7f) },\n        sunDirection: { value: new THREE.Vector3(0.70707, 0.70707, 0) },\n        eye: { value: new THREE.Vector3() },\n        waterColor: { value: new THREE.Color(0x555555) }\n      }\n    ]),\n\n    vertexShader: `\n      uniform float time;\n      varying vec4 worldPosition;\n\n      void main() {\n      \tworldPosition = modelMatrix * vec4( position, 1.0 );\n      \tvec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );\n      \tgl_Position = projectionMatrix * mvPosition;\n\n      }\n    `,\n\n    fragmentShader: `\n      uniform float time;\n      uniform float size;\n      uniform float distortionScale;\n      uniform sampler2D normalSampler;\n      uniform vec3 sunColor;\n      uniform vec3 sunDirection;\n      uniform vec3 eye;\n      uniform vec3 waterColor;\n\n      varying vec4 worldPosition;\n\n      vec4 getNoise( vec2 uv ) {\n      \tvec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);\n      \tvec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );\n      \tvec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );\n      \tvec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );\n      \tvec4 noise = texture2D( normalSampler, uv0 ) +\n      \t\ttexture2D( normalSampler, uv1 ) +\n      \t\ttexture2D( normalSampler, uv2 ) +\n      \t\ttexture2D( normalSampler, uv3 );\n      \treturn noise * 0.5 - 1.0;\n      }\n\n      void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {\n      \tvec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );\n      \tfloat direction = max( 0.0, dot( eyeDirection, reflection ) );\n      \tspecularColor += pow( direction, shiny ) * sunColor * spec;\n      \tdiffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;\n      }\n\n      ${THREE.ShaderChunk[\"common\"]}\n      ${THREE.ShaderChunk[\"packing\"]}\n      ${THREE.ShaderChunk[\"bsdfs\"]}\n      ${THREE.ShaderChunk[\"lights_pars_begin\"]}\n\n      void main() {\n      \tvec4 noise = getNoise( worldPosition.xz * size );\n      \tvec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );\n\n      \tvec3 diffuseLight = vec3(0.0);\n      \tvec3 specularLight = vec3(0.0);\n\n      \tvec3 worldToEye = eye-worldPosition.xyz;\n      \tvec3 eyeDirection = normalize( worldToEye );\n      \tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );\n\n      \tfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );\n      \tfloat rf0 = 0.3;\n      \tfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );\n      \tvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;\n      \tvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ), ( 0.5 + specularLight ), reflectance);\n      \tvec3 outgoingLight = albedo;\n      \tgl_FragColor = vec4( outgoingLight, 1 );\n      }\n    `\n  };\n\n  const material = new THREE.ShaderMaterial({\n    fragmentShader: mirrorShader.fragmentShader,\n    vertexShader: mirrorShader.vertexShader,\n    uniforms: THREE.UniformsUtils.clone(mirrorShader.uniforms),\n    transparent: false,\n    lights: true,\n    side: side,\n    fog: fog\n  });\n\n  material.uniforms.time.value = time;\n  material.uniforms.normalSampler.value = normalSampler;\n  material.uniforms.sunColor.value = sunColor;\n  material.uniforms.waterColor.value = waterColor;\n  material.uniforms.sunDirection.value = sunDirection;\n  material.uniforms.distortionScale.value = distortionScale;\n\n  material.uniforms.eye.value = eye;\n\n  scope.material = material;\n}\n\nMobileWater.prototype = Object.create(THREE.Mesh.prototype);\nMobileWater.prototype.constructor = THREE.Water;\n\nasync function loadWaterNormals(url) {\n  const texture = await new Promise((resolve, reject) =>\n    new THREE.TextureLoader().load(url, resolve, undefined, reject)\n  );\n  texture.wrapS = texture.wrapT = THREE.RepeatWrapping;\n  texture.needsUpdate = true;\n  return texture;\n}\n\nAFRAME.registerComponent(\"water\", {\n  schema: {\n    waterColor: { type: \"color\", default: \"#001e0f\" },\n    distortionScale: { type: \"number\", default: 3.7 },\n    sunColor: { type: \"color\", default: \"#ffffff\" },\n    inclination: { type: \"number\", default: 0 },\n    azimuth: { type: \"number\", default: 0 },\n    distance: { type: \"number\", default: 1 },\n    speed: { type: \"number\", default: 0.1 },\n    forceMobile: { type: \"boolean\", default: false }\n  },\n  init() {\n    const waterMesh = this.el.getObject3D(\"mesh\");\n    const waterGeometry = waterMesh.geometry;\n\n    // Render THREE.Water shader instead of THREE.Mesh\n    waterMesh.visible = false;\n\n    loadWaterNormals(waterNormalMap).then(waterNormals => {\n      const waterConfig = {\n        textureWidth: 512,\n        textureHeight: 512,\n        waterNormals: waterNormals,\n        sunDirection: this.data.sunDirection,\n        sunColor: new THREE.Color(this.data.sunColor),\n        waterColor: new THREE.Color(this.data.waterColor),\n        distortionScale: this.data.distortionScale,\n        fog: false\n      };\n\n      if (AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR() || this.data.forceMobile) {\n        this.water = new MobileWater(waterGeometry, waterConfig);\n      } else {\n        this.water = new THREE.Water(waterGeometry, waterConfig);\n        this.water.mirrorCamera.layers.set(Layers.reflection);\n      }\n\n      this.el.setObject3D(\"water\", this.water);\n    });\n  },\n\n  update(oldData) {\n    if (this.data.forceMobile !== oldData.forceMobile) {\n      this.el.removeObject3D(\"water\");\n      this.init();\n      return;\n    }\n\n    if (!this.water) {\n      return;\n    }\n\n    const uniforms = this.water.material.uniforms;\n\n    if (this.data.waterColor !== oldData.waterColor) {\n      uniforms.waterColor.value.setStyle(this.data.waterColor);\n    }\n\n    if (this.data.distortionScale !== oldData.distortionScale) {\n      uniforms.distortionScale.value = this.data.distortionScale;\n    }\n\n    if (this.data.sunColor !== oldData.sunColor) {\n      uniforms.sunColor.value.setStyle(this.data.sunColor);\n    }\n\n    if (\n      this.data.inclination !== oldData.inclination ||\n      this.data.azimuth !== oldData.azimuth ||\n      this.data.distance !== oldData.distance\n    ) {\n      const theta = Math.PI * (this.data.inclination - 0.5);\n      const phi = 2 * Math.PI * (this.data.azimuth - 0.5);\n\n      const distance = this.data.distance;\n\n      const x = distance * Math.cos(phi);\n      const y = distance * Math.sin(phi) * Math.sin(theta);\n      const z = distance * Math.sin(phi) * Math.cos(theta);\n\n      uniforms.sunDirection.value.set(x, y, z);\n    }\n  },\n\n  tick(time) {\n    if (this.water) {\n      this.water.material.uniforms.time.value = (time / 1000) * this.data.speed;\n    }\n  },\n\n  remove() {\n    this.el.removeObject3D(\"water\");\n    const waterMesh = this.el.getObject3D(\"mesh\");\n    waterMesh.visible = true;\n  }\n});\n","import { ParticleEmitter } from \"@mozillareality/three-particle-emitter\";\nimport { textureLoader } from \"../utils/media-utils\";\nimport { resolveUrl } from \"../utils/media-utils\";\nimport { proxiedUrlFor } from \"../utils/media-url-utils\";\n\nAFRAME.registerComponent(\"particle-emitter\", {\n  schema: {\n    resolve: { type: \"boolean\", default: true },\n    src: { type: \"string\" },\n    startColor: { type: \"color\" },\n    middleColor: { type: \"color\" },\n    endColor: { type: \"color\" },\n    startOpacity: { type: \"number\" },\n    middleOpacity: { type: \"number\" },\n    endOpacity: { type: \"number\" },\n    colorCurve: { type: \"string\" },\n    sizeCurve: { type: \"string\" },\n    startSize: { type: \"number\" },\n    endSize: { type: \"number\" },\n    sizeRandomness: { type: \"number\" },\n    ageRandomness: { type: \"number\" },\n    lifetime: { type: \"number\" },\n    lifetimeRandomness: { type: \"number\" },\n    particleCount: { type: \"number\" },\n    startVelocity: { type: \"vec3\" },\n    endVelocity: { type: \"vec3\" },\n    velocityCurve: { type: \"string\" },\n    angularVelocity: { type: \"number\" }\n  },\n\n  init() {\n    this.particleEmitter = new ParticleEmitter(null);\n    this.particleEmitter.visible = false;\n    this.el.setObject3D(\"particle-emitter\", this.particleEmitter);\n    this.updateParticles = false;\n  },\n\n  async setTexture(src, resolve) {\n    let accessibleUrl = src;\n\n    if (resolve) {\n      const result = await resolveUrl(src);\n      let canonicalUrl = result.origin;\n\n      // handle protocol relative urls\n      if (canonicalUrl.startsWith(\"//\")) {\n        canonicalUrl = location.protocol + canonicalUrl;\n      }\n\n      // todo: we don't need to proxy for many things if the canonical URL has permissive CORS headers\n      accessibleUrl = proxiedUrlFor(canonicalUrl);\n    }\n\n    const texture = new THREE.Texture();\n\n    await textureLoader.loadTextureAsync(texture, accessibleUrl);\n\n    // Guard against src changing while request was in flight\n    if (this.data.src !== src) {\n      return;\n    }\n\n    this.particleEmitter.material.uniforms.map.value = texture;\n    this.particleEmitter.visible = true;\n    this.updateParticles = true;\n  },\n\n  update(prevData) {\n    const data = this.data;\n    const particleEmitter = this.particleEmitter;\n\n    if (prevData.src !== data.src) {\n      this.setTexture(data.src, data.resolve).catch(console.error);\n    }\n\n    if (\n      prevData.startColor !== data.startColor ||\n      prevData.startSize !== data.startSize ||\n      prevData.sizeRandomness !== data.sizeRandomness ||\n      prevData.ageRandomness !== data.ageRandomness ||\n      prevData.lifetime !== data.lifetime ||\n      prevData.lifetimeRandomness !== data.lifetimeRandomness ||\n      prevData.particleCount !== data.particleCount\n    ) {\n      this.updateParticles = true;\n    }\n\n    particleEmitter.startColor.set(data.startColor);\n    particleEmitter.middleColor.set(data.middleColor);\n    particleEmitter.endColor.set(data.endColor);\n    particleEmitter.startOpacity = data.startOpacity;\n    particleEmitter.middleOpacity = data.middleOpacity;\n    particleEmitter.endOpacity = data.endOpacity;\n    particleEmitter.colorCurve = data.colorCurve;\n    particleEmitter.sizeCurve = data.sizeCurve;\n    particleEmitter.startSize = data.startSize;\n    particleEmitter.endSize = data.endSize;\n    particleEmitter.sizeRandomness = data.sizeRandomness;\n    particleEmitter.ageRandomness = data.ageRandomness;\n    particleEmitter.lifetime = data.lifetime;\n    particleEmitter.lifetimeRandomness = data.lifetimeRandomness;\n    particleEmitter.particleCount = data.particleCount;\n    particleEmitter.startVelocity.copy(data.startVelocity);\n    particleEmitter.endVelocity.copy(data.endVelocity);\n    particleEmitter.velocityCurve = data.velocityCurve;\n    particleEmitter.angularVelocity = data.angularVelocity;\n  },\n\n  tick(time, dt) {\n    if (this.updateParticles) {\n      this.particleEmitter.updateParticles();\n      this.updateParticles = false;\n    }\n\n    if (this.particleEmitter.visible) {\n      this.particleEmitter.update(dt / 1000);\n    }\n  }\n});\n","export function getSanitizedComponentMapping(inputComponent, inputProperty, publicComponents) {\n  const publicComponent = publicComponents[inputComponent];\n\n  if (!publicComponent) {\n    throw new Error(`Component \"${inputComponent}\" is not public.`);\n  }\n\n  const publicProperty = publicComponent.publicProperties[inputProperty];\n\n  if (!publicProperty) {\n    throw new Error(`Component \"${inputComponent}\"'s property \"${inputProperty}\" is not public.`);\n  }\n\n  return {\n    mappedComponent: publicComponent.mappedComponent,\n    mappedProperty: publicProperty.mappedProperty,\n    getMappedValue: publicProperty.getMappedValue\n  };\n}\n","import \"./components/gltf-model-plus\";\nimport { getSanitizedComponentMapping } from \"./utils/component-mappings\";\nimport { isHubsDestinationUrl } from \"./utils/media-url-utils\";\nconst PHYSICS_CONSTANTS = require(\"aframe-physics-system/src/constants\"),\n  TYPE = PHYSICS_CONSTANTS.TYPE,\n  SHAPE = PHYSICS_CONSTANTS.SHAPE,\n  FIT = PHYSICS_CONSTANTS.FIT;\nconst COLLISION_LAYERS = require(\"./constants\").COLLISION_LAYERS;\n\nAFRAME.GLTFModelPlus.registerComponent(\"duck\", \"duck\");\nAFRAME.GLTFModelPlus.registerComponent(\"quack\", \"quack\");\nAFRAME.GLTFModelPlus.registerComponent(\"sound\", \"sound\");\nAFRAME.GLTFModelPlus.registerComponent(\"css-class\", \"css-class\");\nAFRAME.GLTFModelPlus.registerComponent(\"interactable\", \"css-class\", (el, componentName) => {\n  el.setAttribute(componentName, \"interactable\");\n});\nAFRAME.GLTFModelPlus.registerComponent(\"super-spawner\", \"super-spawner\", (el, componentName, componentData) => {\n  //TODO: Do not automatically add these components\n  el.setAttribute(\"is-remote-hover-target\", \"\");\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\n  el.setAttribute(\"hoverable-visuals\", {\n    cursorController: \"#cursor-controller\"\n  });\n  el.setAttribute(componentName, componentData);\n});\nAFRAME.GLTFModelPlus.registerComponent(\"gltf-model-plus\", \"gltf-model-plus\");\nAFRAME.GLTFModelPlus.registerComponent(\"media-loader\", \"media-loader\");\nAFRAME.GLTFModelPlus.registerComponent(\"body\", \"ammo-body\", el => {\n  //This is only required for migration of old environments with super-spawners\n  //will no longer be needed when spawners are added via Spoke instead.\n  el.setAttribute(\"ammo-body\", {\n    mass: 0,\n    type: TYPE.STATIC,\n    collisionFilterGroup: COLLISION_LAYERS.INTERACTABLES,\n    collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER\n  });\n});\nAFRAME.GLTFModelPlus.registerComponent(\"ammo-shape\", \"ammo-shape\");\nAFRAME.GLTFModelPlus.registerComponent(\"hide-when-quality\", \"hide-when-quality\");\nAFRAME.GLTFModelPlus.registerComponent(\"light\", \"light\", (el, componentName, componentData) => {\n  if (componentData.distance === 0) {\n    componentData.decay = 0;\n  }\n  el.setAttribute(componentName, componentData);\n  if (componentData.castShadow) {\n    // HACK: component.light isn't set until one frame after setArrtibute\n    setTimeout(() => {\n      el.components.light.light.shadow.camera.matrixNeedsUpdate = true;\n    }, 0);\n  }\n});\nAFRAME.GLTFModelPlus.registerComponent(\"ambient-light\", \"ambient-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"directional-light\", \"directional-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"hemisphere-light\", \"hemisphere-light\");\nfunction decayMigration(el, componentName, componentData) {\n  if (componentData.range === 0) {\n    componentData.decay = 0;\n  }\n  el.setAttribute(componentName, componentData);\n}\nAFRAME.GLTFModelPlus.registerComponent(\"point-light\", \"point-light\", decayMigration);\nAFRAME.GLTFModelPlus.registerComponent(\"spot-light\", \"spot-light\", decayMigration);\n\nAFRAME.GLTFModelPlus.registerComponent(\"skybox\", \"skybox\");\nAFRAME.GLTFModelPlus.registerComponent(\"layers\", \"layers\");\nAFRAME.GLTFModelPlus.registerComponent(\"shadow\", \"shadow\");\nAFRAME.GLTFModelPlus.registerComponent(\"water\", \"water\");\nAFRAME.GLTFModelPlus.registerComponent(\"scale-audio-feedback\", \"scale-audio-feedback\");\nAFRAME.GLTFModelPlus.registerComponent(\"animation-mixer\", \"animation-mixer\");\nAFRAME.GLTFModelPlus.registerComponent(\"loop-animation\", \"loop-animation\");\nAFRAME.GLTFModelPlus.registerComponent(\n  \"box-collider\",\n  \"ammo-shape\",\n  (() => {\n    const euler = new THREE.Euler();\n    return (el, componentName, componentData) => {\n      const { scale, rotation } = componentData;\n      euler.set(rotation.x, rotation.y, rotation.z);\n      const orientation = new THREE.Quaternion().setFromEuler(euler);\n      el.setAttribute(componentName, {\n        type: SHAPE.BOX,\n        fit: FIT.MANUAL,\n        offset: componentData.position,\n        halfExtents: { x: scale.x / 2, y: scale.y / 2, z: scale.z / 2 },\n        orientation\n      });\n    };\n  })()\n);\nAFRAME.GLTFModelPlus.registerComponent(\"visible\", \"visible\", (el, componentName, componentData) => {\n  if (typeof componentData === \"object\") {\n    el.setAttribute(componentName, componentData.visible);\n  } else {\n    el.setAttribute(componentName, componentData);\n  }\n});\nAFRAME.GLTFModelPlus.registerComponent(\"spawn-point\", \"spawn-point\");\nAFRAME.GLTFModelPlus.registerComponent(\"sticky-zone\", \"sticky-zone\");\nAFRAME.GLTFModelPlus.registerComponent(\"nav-mesh\", \"nav-mesh\", (el, _componentName, componentData) => {\n  const nav = AFRAME.scenes[0].systems.nav;\n  const zone = componentData.zone || \"character\";\n  let found = false;\n  el.object3D.traverse(node => {\n    if (node.isMesh && !found) {\n      found = true;\n      nav.loadMesh(node, zone);\n    }\n  });\n  // There isn't actually an a-frame nav-mesh component, but we want to tag this el as a nav-mesh since\n  // nav-mesh-helper will query for it later.\n  el.setAttribute(\"nav-mesh\");\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"pinnable\", \"pinnable\");\n\nAFRAME.GLTFModelPlus.registerComponent(\"media\", \"media\", (el, componentName, componentData) => {\n  if (componentData.id) {\n    el.setAttribute(\"networked\", {\n      template: \"#interactable-media\",\n      owner: \"scene\",\n      persistent: true,\n      networkId: componentData.id\n    });\n  }\n\n  el.setAttribute(\"media-loader\", {\n    src: componentData.src,\n    resize: true,\n    resolve: true,\n    fileIsOwned: true,\n    animate: false,\n    contentSubtype: componentData.contentSubtype\n  });\n\n  if (componentData.pageIndex) {\n    el.setAttribute(\"media-pdf\", { index: componentData.pageIndex });\n    el.setAttribute(\"media-pager\", { index: componentData.pageIndex });\n  }\n\n  if (componentData.paused !== undefined) {\n    el.setAttribute(\"media-video\", { videoPaused: componentData.paused });\n  }\n\n  if (componentData.time) {\n    el.setAttribute(\"media-video\", { time: componentData.time });\n  }\n});\n\nfunction mediaInflator(el, componentName, componentData, components) {\n  let isControlled = true;\n\n  if (components.networked) {\n    // TODO: When non-hubs links can be traversed, make all link components controlled so you can open them.\n    isControlled =\n      componentData.controls || isHubsDestinationUrl(componentData.src) || isHubsDestinationUrl(componentData.href);\n\n    const hasVolume = componentName === \"video\";\n    const templateName = isControlled || hasVolume ? \"#static-controlled-media\" : \"#static-media\";\n\n    el.setAttribute(\"networked\", {\n      template: templateName,\n      owner: \"scene\",\n      persistent: true,\n      networkId: components.networked.id\n    });\n  }\n\n  const mediaOptions = {};\n\n  if (componentName === \"video\" || componentName === \"image\") {\n    mediaOptions.projection = componentData.projection;\n  }\n\n  if (componentName === \"video\") {\n    mediaOptions.videoPaused = !componentData.autoPlay;\n    mediaOptions.volume = componentData.volume;\n    mediaOptions.loop = componentData.loop;\n    mediaOptions.audioType = componentData.audioType;\n    mediaOptions.hidePlaybackControls = !isControlled;\n\n    if (componentData.audioType === \"pannernode\") {\n      mediaOptions.distanceModel = componentData.distanceModel;\n      mediaOptions.rolloffFactor = componentData.rolloffFactor;\n      mediaOptions.refDistance = componentData.refDistance;\n      mediaOptions.maxDistance = componentData.maxDistance;\n      mediaOptions.coneInnerAngle = componentData.coneInnerAngle;\n      mediaOptions.coneOuterAngle = componentData.coneOuterAngle;\n      mediaOptions.coneOuterGain = componentData.coneOuterGain;\n    }\n\n    el.setAttribute(\"video-pause-state\", { paused: mediaOptions.videoPaused });\n  }\n\n  const src = componentName === \"link\" ? componentData.href : componentData.src;\n\n  el.setAttribute(\"media-loader\", {\n    src,\n    resize: true,\n    resolve: true,\n    fileIsOwned: true,\n    animate: false,\n    mediaOptions\n  });\n}\n\nAFRAME.GLTFModelPlus.registerComponent(\"image\", \"image\", mediaInflator);\nAFRAME.GLTFModelPlus.registerComponent(\"video\", \"video\", mediaInflator, (name, property, value) => {\n  if (property === \"paused\") {\n    return { name: \"video-pause-state\", property, value };\n  } else {\n    return null;\n  }\n});\nAFRAME.GLTFModelPlus.registerComponent(\"link\", \"link\", mediaInflator);\n\nAFRAME.GLTFModelPlus.registerComponent(\"hoverable\", \"is-remote-hover-target\", el => {\n  el.setAttribute(\"is-remote-hover-target\", \"\");\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"spawner\", \"spawner\", (el, componentName, componentData) => {\n  el.setAttribute(\"media-loader\", {\n    src: componentData.src,\n    resolve: true,\n    fileIsOwned: true,\n    animate: false\n  });\n  el.setAttribute(\"css-class\", \"interactable\");\n  el.setAttribute(\"super-spawner\", {\n    src: componentData.src,\n    resolve: true,\n    template: \"#interactable-media\"\n  });\n  el.setAttribute(\"hoverable-visuals\", {\n    cursorController: \"#cursor-controller\"\n  });\n  el.setAttribute(\"ammo-body\", {\n    mass: 0,\n    type: TYPE.STATIC,\n    collisionFilterGroup: COLLISION_LAYERS.INTERACTABLES,\n    collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER\n  });\n  el.setAttribute(\"is-remote-hover-target\", \"\");\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\n});\n\nconst publicComponents = {\n  video: {\n    mappedComponent: \"video-pause-state\",\n    publicProperties: {\n      paused: {\n        mappedProperty: \"paused\",\n        getMappedValue(value) {\n          return !!value;\n        }\n      }\n    }\n  },\n  \"loop-animation\": {\n    mappedComponent: \"loop-animation\",\n    publicProperties: {\n      paused: {\n        mappedProperty: \"paused\",\n        getMappedValue(value) {\n          return !!value;\n        }\n      }\n    }\n  }\n};\n\nAFRAME.GLTFModelPlus.registerComponent(\n  \"trigger-volume\",\n  \"trigger-volume\",\n  (el, componentName, componentData, components, indexToEntityMap) => {\n    const {\n      size,\n      target,\n      enterComponent,\n      enterProperty,\n      enterValue,\n      leaveComponent,\n      leaveProperty,\n      leaveValue\n    } = componentData;\n\n    let enterComponentMapping, leaveComponentMapping, targetEntity;\n\n    try {\n      enterComponentMapping = getSanitizedComponentMapping(enterComponent, enterProperty, publicComponents);\n      leaveComponentMapping = getSanitizedComponentMapping(leaveComponent, leaveProperty, publicComponents);\n\n      targetEntity = indexToEntityMap[target];\n\n      if (!targetEntity) {\n        throw new Error(`Couldn't find target entity with index: ${target}.`);\n      }\n    } catch (e) {\n      console.warn(`Error inflating gltf component \"trigger-volume\": ${e.message}`);\n      return;\n    }\n\n    // Filter out scope and colliders properties.\n    el.setAttribute(\"trigger-volume\", {\n      colliders: \"#player-camera\",\n      size,\n      target: targetEntity,\n      enterComponent: enterComponentMapping.mappedComponent,\n      enterProperty: enterComponentMapping.mappedProperty,\n      enterValue: enterComponentMapping.getMappedValue(enterValue),\n      leaveComponent: leaveComponentMapping.mappedComponent,\n      leaveProperty: leaveComponentMapping.mappedProperty,\n      leaveValue: leaveComponentMapping.getMappedValue(leaveValue)\n    });\n  }\n);\n\nAFRAME.GLTFModelPlus.registerComponent(\"heightfield\", \"heightfield\", (el, componentName, componentData) => {\n  el.setAttribute(\"ammo-shape__heightfield\", {\n    type: SHAPE.HEIGHTFIELD,\n    margin: 0.01,\n    fit: FIT.MANUAL,\n    heightfieldDistance: componentData.distance,\n    offset: componentData.offset,\n    heightfieldData: componentData.data\n  });\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"trimesh\", \"trimesh\", el => {\n  el.setAttribute(\"ammo-shape__trimesh\", {\n    type: SHAPE.MESH,\n    margin: 0.01,\n    fit: FIT.ALL,\n    includeInvisible: true\n  });\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"particle-emitter\", \"particle-emitter\");\n","import { Socket } from \"phoenix\";\nimport { generateHubName } from \"../utils/name-generation\";\nimport { getAirtableAssets, airtableAssetsInitialState } from '../everyspace/airtable'\n\nimport Store from \"../storage/store\";\n\nconst resolverLink = document.createElement(\"a\");\nexport function getReticulumFetchUrl(path, absolute = false) {\n  if (process.env.RETICULUM_SERVER) {\n    return `https://${process.env.RETICULUM_SERVER}${path}`;\n  } else if (absolute) {\n    resolverLink.href = path;\n    return resolverLink.href;\n  } else {\n    return path;\n  }\n}\n\nlet reticulumMeta = null;\nlet invalidatedReticulumMetaThisSession = false;\n\nexport async function invalidateReticulumMeta() {\n  invalidatedReticulumMetaThisSession = true;\n  reticulumMeta = null;\n}\n\nexport async function getReticulumMeta() {\n  if (!reticulumMeta) {\n    // Initially look up version based upon page, avoiding round-trip, otherwise fetch.\n    if (!invalidatedReticulumMetaThisSession && document.querySelector(\"meta[name='ret:version']\")) {\n      reticulumMeta = {\n        version: document.querySelector(\"meta[name='ret:version']\").getAttribute(\"value\"),\n        pool: document.querySelector(\"meta[name='ret:pool']\").getAttribute(\"value\"),\n        phx_host: document.querySelector(\"meta[name='ret:phx_host']\").getAttribute(\"value\")\n      };\n    } else {\n      await fetch(getReticulumFetchUrl(\"/api/v1/meta\")).then(async res => {\n        reticulumMeta = await res.json();\n      });\n    }\n  }\n\n  const qs = new URLSearchParams(location.search);\n  const phxHostOverride = qs.get(\"phx_host\");\n\n  if (phxHostOverride) {\n    reticulumMeta.phx_host = phxHostOverride;\n  }\n\n  return reticulumMeta;\n}\n\nexport async function connectToReticulum(debug = false, params = null) {\n  const qs = new URLSearchParams(location.search);\n\n  const getNewSocketUrl = async () => {\n    const socketProtocol = qs.get(\"phx_protocol\") || (document.location.protocol === \"https:\" ? \"wss:\" : \"ws:\");\n    let socketHost = qs.get(\"phx_host\");\n    let socketPort = qs.get(\"phx_port\");\n\n    const reticulumMeta = await getReticulumMeta();\n    socketHost = socketHost || process.env.RETICULUM_SOCKET_SERVER || reticulumMeta.phx_host;\n    socketPort =\n      socketPort ||\n      (process.env.RETICULUM_SERVER ? new URL(`${socketProtocol}//${process.env.RETICULUM_SERVER}`).port : \"443\");\n    return `${socketProtocol}//${socketHost}${socketPort ? `:${socketPort}` : \"\"}`;\n  };\n\n  const socketUrl = await getNewSocketUrl();\n  console.log(`Phoenix Socket URL: ${socketUrl}`);\n\n  const socketSettings = {};\n\n  if (debug) {\n    socketSettings.logger = (kind, msg, data) => {\n      console.log(`${kind}: ${msg}`, data);\n    };\n  }\n\n  if (params) {\n    socketSettings.params = params;\n  }\n\n  const socket = new Socket(`${socketUrl}/socket`, socketSettings);\n  socket.connect();\n  socket.onError(async () => {\n    // On error, underlying reticulum node may have died, so rebalance by\n    // fetching a new healthy node to connect to.\n    invalidateReticulumMeta();\n\n    const endPointPath = new URL(socket.endPoint).pathname;\n    const newSocketUrl = await getNewSocketUrl();\n    const newEndPoint = `${newSocketUrl}${endPointPath}`;\n    console.log(`Socket error, changed endpoint to ${newEndPoint}`);\n    socket.endPoint = newEndPoint;\n  });\n\n  return socket;\n}\n\nexport function getLandingPageForPhoto(photoUrl) {\n  const parsedUrl = new URL(photoUrl);\n  return getReticulumFetchUrl(parsedUrl.pathname.replace(\".png\", \".html\") + parsedUrl.search, true);\n}\n\nexport function fetchReticulumAuthenticated(url, method = \"GET\", payload) {\n  const { token } = window.APP.store.state.credentials;\n  const retUrl = getReticulumFetchUrl(url);\n  const params = {\n    headers: { \"content-type\": \"application/json\" },\n    method\n  };\n  if (token) {\n    params.headers.authorization = `bearer ${token}`;\n  }\n  if (payload) {\n    params.body = JSON.stringify(payload);\n  }\n  return fetch(retUrl, params).then(async r => {\n    const result = await r.text();\n    try {\n      return JSON.parse(result);\n    } catch (e) {\n      // Some reticulum responses, particularly DELETE requests, don't return json.\n      return result;\n    }\n  });\n}\n\nexport async function createAndRedirectToNewHub(name, sceneId, sceneUrl, replace) {\n  const createUrl = getReticulumFetchUrl(\"/api/v1/hubs\");\n\n  let assets = {Name: \"Test\", SceneUrl: null};\n    \n  assets = await getAirtableAssets();\n  \n  // const record = await airtableAssets.find('recHqITRS7cBMwn9i')\n\n  // if (record) assets = record.fields;\n  \n  // const payload = { hub: { name: name || generateHubName() } };\n  const payload = { hub: { name: assets.Name } };\n  \n\n  // if (sceneId) {\n    // payload.hub.scene_id = sceneId;\n  // } else {\n    // payload.hub.default_environment_gltf_bundle_url = sceneUrl;\n  // }\n    \n  payload.hub.default_environment_gltf_bundle_url = assets.SceneUrl;\n    \n\n  const headers = { \"content-type\": \"application/json\" };\n  const store = new Store();\n  if (store.state && store.state.credentials.token) {\n    headers.authorization = `bearer ${store.state.credentials.token}`;\n  }\n\n  let res = await fetch(createUrl, {\n    body: JSON.stringify(payload),\n    headers,\n    method: \"POST\"\n  }).then(r => r.json());\n\n  if (res.error === \"invalid_token\") {\n    // Clear the invalid token from store.\n    store.update({ credentials: { token: null, email: null } });\n\n    // Create hub anonymously\n    delete headers.authorization;\n    res = await fetch(createUrl, {\n      body: JSON.stringify(payload),\n      headers,\n      method: \"POST\"\n    }).then(r => r.json());\n  }\n\n  const hub = res;\n  let url = hub.url;\n\n  const creatorAssignmentToken = hub.creator_assignment_token;\n  if (creatorAssignmentToken) {\n    store.update({ creatorAssignmentTokens: [{ hubId: hub.hub_id, creatorAssignmentToken: creatorAssignmentToken }] });\n\n    // Don't need to store the embed token if there's no creator assignment token, since that means\n    // we are the owner and will get the embed token on page load.\n    const embedToken = hub.embed_token;\n\n    if (embedToken) {\n      store.update({ embedTokens: [{ hubId: hub.hub_id, embedToken: embedToken }] });\n    }\n  }\n\n  if (process.env.RETICULUM_SERVER && document.location.host !== process.env.RETICULUM_SERVER) {\n    url = `/hub.html?hub_id=${hub.hub_id}`;\n  }\n\n  if (replace) {\n    document.location.replace(url);\n  } else {\n    document.location = url;\n  }\n}\n\nexport function getPresenceEntryForSession(presences, sessionId) {\n  const entry = Object.entries(presences || {}).find(([k]) => k === sessionId) || [];\n  const presence = entry[1];\n  return (presence && presence.metas && presence.metas[0]) || {};\n}\n\nexport function getPresenceContextForSession(presences, sessionId) {\n  return (getPresenceEntryForSession(presences, sessionId) || {}).context || {};\n}\n\nexport function getPresenceProfileForSession(presences, sessionId) {\n  return (getPresenceEntryForSession(presences, sessionId) || {}).profile || {};\n}\n\n// Takes the given channel, and creates a new channel with the same bindings\n// with the given socket, joins it, and leaves the old channel after joining.\n//\n// NOTE: This function relies upon phoenix channel object internals, so this\n// function will need to be reviewed if/when we ever update phoenix.js\nexport function migrateChannelToSocket(oldChannel, socket, params) {\n  const channel = socket.channel(oldChannel.topic, params || oldChannel.params);\n\n  for (let i = 0, l = oldChannel.bindings.length; i < l; i++) {\n    const item = oldChannel.bindings[i];\n    channel.on(item.event, item.callback);\n  }\n\n  for (let i = 0, l = oldChannel.pushBuffer.length; i < l; i++) {\n    const item = oldChannel.pushBuffer[i];\n    channel.push(item.event, item.payload, item.timeout);\n  }\n\n  const oldJoinPush = oldChannel.joinPush;\n  const joinPush = channel.join();\n\n  for (let i = 0, l = oldJoinPush.recHooks.length; i < l; i++) {\n    const item = oldJoinPush.recHooks[i];\n    joinPush.receive(item.status, item.callback);\n  }\n\n  return new Promise(resolve => {\n    joinPush.receive(\"ok\", () => {\n      // Clear all event handlers first so no duplicate messages come in.\n      oldChannel.bindings = [];\n      resolve(channel);\n    });\n  });\n}\n\nexport function discordBridgesForPresences(presences) {\n  const channels = [];\n  for (const p of Object.values(presences)) {\n    for (const m of p.metas) {\n      if (m.profile && m.profile.discordBridges) {\n        Array.prototype.push.apply(channels, m.profile.discordBridges.map(b => b.channel.name));\n      }\n    }\n  }\n  return channels;\n}\n","module.exports = __webpack_public_path__ + \"assets/images/logo-8f1dfd234d060073524bc29912a24f75.svg\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"loading-text\":\"loader__loading-text__QVcF3\",\"loadingText\":\"loader__loading-text__QVcF3\"};","module.exports = __webpack_public_path__ + \"assets/images/giphy_logo-1dcbee43e18919c0bd0c999be8602628.png\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"message-entry-in-room\":\"message-entry__message-entry-in-room__1aN5s\",\"messageEntryInRoom\":\"message-entry__message-entry-in-room__1aN5s\",\"message-entry-spawn\":\"message-entry__message-entry-spawn__1_AF5\",\"messageEntrySpawn\":\"message-entry__message-entry-spawn__1_AF5\",\"message-entry-input\":\"message-entry__message-entry-input__2AtQE\",\"messageEntryInput\":\"message-entry__message-entry-input__2AtQE\",\"message-entry\":\"message-entry__message-entry__x7lQX\",\"messageEntry\":\"message-entry__message-entry__x7lQX\",\"message-entry-disabled\":\"message-entry__message-entry-disabled__25LSI\",\"messageEntryDisabled\":\"message-entry__message-entry-disabled__25LSI\",\"message-entry-button\":\"message-entry__message-entry-button__3xJhH\",\"messageEntryButton\":\"message-entry__message-entry-button__3xJhH\",\"message-entry-button-in-room\":\"message-entry__message-entry-button-in-room__2yMTR\",\"messageEntryButtonInRoom\":\"message-entry__message-entry-button-in-room__2yMTR\",\"message-entry-upload\":\"message-entry__message-entry-upload__3F0sX\",\"messageEntryUpload\":\"message-entry__message-entry-upload__3F0sX\",\"message-entry-input-in-room\":\"message-entry__message-entry-input-in-room__30ReF\",\"messageEntryInputInRoom\":\"message-entry__message-entry-input-in-room__30ReF\",\"message-entry-input-no-spawn\":\"message-entry__message-entry-input-no-spawn__1wF7R\",\"messageEntryInputNoSpawn\":\"message-entry__message-entry-input-no-spawn__1wF7R\",\"message-entry-on-mobile\":\"message-entry__message-entry-on-mobile__2pSYF\",\"messageEntryOnMobile\":\"message-entry__message-entry-on-mobile__2pSYF\"};","const nonCorsProxyDomains = (process.env.NON_CORS_PROXY_DOMAINS || \"\").split(\",\");\nif (process.env.CORS_PROXY_SERVER) {\n  nonCorsProxyDomains.push(process.env.CORS_PROXY_SERVER);\n}\n\nconst commonKnownContentTypes = {\n  gltf: \"model/gltf\",\n  glb: \"model/gltf-binary\",\n  png: \"image/png\",\n  jpg: \"image/jpeg\",\n  jpeg: \"image/jpeg\",\n  pdf: \"application/pdf\",\n  mp4: \"video/mp4\",\n  mp3: \"audio/mpeg\"\n};\n\n// thanks to https://developer.mozilla.org/en-US/docs/Web/API/WindowBase64/Base64_encoding_and_decoding\nfunction b64EncodeUnicode(str) {\n  // first we use encodeURIComponent to get percent-encoded UTF-8, then we convert the percent-encodings\n  // into raw bytes which can be fed into btoa.\n  const CHAR_RE = /%([0-9A-F]{2})/g;\n  return btoa(encodeURIComponent(str).replace(CHAR_RE, (_, p1) => String.fromCharCode(\"0x\" + p1)));\n}\n\nconst farsparkEncodeUrl = url => {\n  // farspark doesn't know how to read '=' base64 padding characters\n  // translate base64 + to - and / to _ for URL safety\n  return b64EncodeUnicode(url)\n    .replace(/=+$/g, \"\")\n    .replace(/\\+/g, \"-\")\n    .replace(/\\//g, \"_\");\n};\n\nexport const scaledThumbnailUrlFor = (url, width, height) => {\n  const farsparkUrl = `https://${process.env.FARSPARK_SERVER}/thumbnail/${farsparkEncodeUrl(\n    url\n  )}?w=${width}&h=${height}`;\n\n  try {\n    const urlHostname = new URL(url).hostname;\n\n    if (process.env.RETICULUM_SERVER) {\n      const retHostname = new URL(`https://${process.env.RETICULUM_SERVER}`).hostname;\n      if (retHostname === urlHostname) return url;\n    }\n  } catch (e) {\n    return farsparkUrl;\n  }\n\n  return farsparkUrl;\n};\n\nexport const proxiedUrlFor = url => {\n  if (!(url.startsWith(\"http:\") || url.startsWith(\"https:\"))) return url;\n\n  // Skip known domains that do not require CORS proxying.\n  try {\n    const parsedUrl = new URL(url);\n    if (nonCorsProxyDomains.find(domain => parsedUrl.hostname.endsWith(domain))) return url;\n  } catch (e) {\n    // Ignore\n  }\n\n  if (!process.env.CORS_PROXY_SERVER) {\n    return `https://${process.env.FARSPARK_SERVER}/0/raw/0/0/0/0/${farsparkEncodeUrl(url)}`;\n  } else {\n    return `https://${process.env.CORS_PROXY_SERVER}/${url}`;\n  }\n};\n\nexport const getCustomGLTFParserURLResolver = gltfUrl => url => {\n  if (typeof url !== \"string\" || url === \"\") return \"\";\n  if (/^(https?:)?\\/\\//i.test(url)) return url;\n  if (/^data:.*,.*$/i.test(url)) return url;\n  if (/^blob:.*$/i.test(url)) return url;\n\n  if (process.env.CORS_PROXY_SERVER) {\n    // For absolute paths with a CORS proxied gltf URL, re-write the url properly to be proxied\n    const corsProxyPrefix = `https://${process.env.CORS_PROXY_SERVER}/`;\n\n    if (gltfUrl.startsWith(corsProxyPrefix)) {\n      const originalUrl = decodeURIComponent(gltfUrl.substring(corsProxyPrefix.length));\n      const originalUrlParts = originalUrl.split(\"/\");\n\n      // Drop the .gltf filename\n      const path = new URL(url).pathname;\n      const assetUrl = originalUrlParts.slice(0, originalUrlParts.length - 1).join(\"/\") + \"/\" + path;\n      return corsProxyPrefix + assetUrl;\n    }\n  }\n\n  return url;\n};\n\nconst dataUrlRegex = /data:([a-zA-Z0-9]+\\/[a-zA-Z0-9-.+]+).*,.*/;\n\nexport const guessContentType = url => {\n  if (url.startsWith(\"hubs://\") && url.endsWith(\"/video\")) return \"video/vnd.hubs-webrtc\";\n  if (url.startsWith(\"data:\")) {\n    const matches = dataUrlRegex.match(url);\n    if (matches.length > 0) {\n      matches[1];\n    }\n  }\n  const extension = new URL(url, window.location).pathname.split(\".\").pop();\n  return commonKnownContentTypes[extension];\n};\nconst hubsSceneRegex = /https?:\\/\\/(hubs.local(:\\d+)?|(smoke-)?hubs.mozilla.com|(dev\\.)?reticulum.io)\\/scenes\\/(\\w+)\\/?\\S*/;\nconst hubsAvatarRegex = /https?:\\/\\/(hubs.local(:\\d+)?|(smoke-)?hubs.mozilla.com|(dev\\.)?reticulum.io)\\/avatars\\/(\\w+)\\/?\\S*/;\nconst hubsRoomRegex = /https?:\\/\\/(hubs.local(:\\d+)?|(smoke-)?hubs.mozilla.com|(dev\\.)?reticulum.io)\\/(\\w+)\\/?\\S*/;\nexport const isHubsSceneUrl = hubsSceneRegex.test.bind(hubsSceneRegex);\nexport const isHubsRoomUrl = url => !isHubsSceneUrl(url) && hubsRoomRegex.test(url);\nexport const isHubsDestinationUrl = url => isHubsSceneUrl(url) || isHubsRoomUrl(url);\nexport const isHubsAvatarUrl = hubsAvatarRegex.test.bind(hubsAvatarRegex);\n","module.exports = \"data:image/gif;base64,R0lGODlhEAAQAIQaAAAAAAEBAQABBQEBAgEBBQMDAwAykwBk+wFk+/85Af47AwCIHgCJHgGJHgCKHgOJIPc63vc64Pc64YeHhwDySLu7wru8wru8w7y8wwD6/v///////////////////////yH+EUNyZWF0ZWQgd2l0aCBHSU1QACH5BAEKAB8ALAAAAAAQABAAAAVl4AeMZDl9KAqkLDqd6YrN9HzC4jdbTUPDMBnGQWEAKphBYKTSYR6LRQE5y+VmlUAAc+lWrMIa4nBYxXQJcabMkkUUtLGhJZNA4BiC4HyVSCJpKRhgOktmgoRVLDSELY5mTHQlKyEAOw==\"","module.exports = __webpack_public_path__ + \"assets/camera_tool-a25d0894a6b635779bd4ed41f2de0411.glb\";","module.exports = __webpack_public_path__ + \"assets/images/mic_granted-5d41c8098b2c1a084f07dd3a2473983f.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_granted@2x-f84d9eb002832eeeb768529e6cb1e93e.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_small-b81b3397cc985eb8d3d67a4f007158cc.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_small@2x-d04ff548fa26495f69249f0c34f44b72.png\";","module.exports = __webpack_public_path__ + \"assets/images/dropdown_arrow-601450f494125f8caccec2271aebd4cb.png\";","module.exports = __webpack_public_path__ + \"assets/images/dropdown_arrow@2x-1023ab0bd743b3525d99986de89f0c3b.png\";","module.exports = __webpack_public_path__ + \"assets/images/add-owner-c3f352da151b4a5be71defd565720235.png\";","module.exports = __webpack_public_path__ + \"assets/images/remove-owner-02b96ad3a84badda798fde00ac4c2243.png\";","module.exports = __webpack_public_path__ + \"assets/images/mobile_screen_entry-b29fcd32c8f70bb828c1abceb62f93e2.svg\";","module.exports = __webpack_public_path__ + \"assets/images/desktop_screen_entry-e5ff9b5e64caa694e9b4183e532fcb17.svg\";","module.exports = __webpack_public_path__ + \"assets/images/generic_vr_entry-c648c26ce1388450df7edbd92ec00f5e.svg\";","module.exports = __webpack_public_path__ + \"assets/images/gearvr_entry-dcea59d35d7fae4c8b9c4985c1743851.svg\";","module.exports = __webpack_public_path__ + \"assets/images/daydream_entry-6e2716960046992dbd6b0e87bf8c2c3a.svg\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"avatar-url-dialog\":\"avatar-url-dialog__avatar-url-dialog__17OoD\",\"avatarUrlDialog\":\"avatar-url-dialog__avatar-url-dialog__17OoD\"};","module.exports = __webpack_public_path__ + \"assets/images/link_dialog_header-b15568ca2056d8be7a58c359e6a9ca51.svg\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"form-frame\":\"feedback-dialog__form-frame__1gfk_\",\"formFrame\":\"feedback-dialog__form-frame__1gfk_\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"leave-room\":\"leave-room-dialog__leave-room__31Jf7\",\"leaveRoom\":\"leave-room-dialog__leave-room__31Jf7\"};","// Utilities for manipulating state history. This provides a number of functions which\n// need to be used to manipulate history state so we can deal with edge cases around\n// entry back button and refreshes once entered.\n//\n// These functions also transparently deal with the room slug, so incoming calls can ignore\n// dealing with it, and provides APIs for getting the non-slug part of the path.\n//\n// The slug cannot be part of the basename for history, because the slug changes intra-session\n// if the room is renamed.\n\n// This pushes/replaces a new k, v pair into the history, while maintaining all the other\n// keys, or clears state if k if null.\n//\n// Also maintains a length key that can be used to find the length of the history chain\n// (across refreshes) for the current room.\nfunction pushOrUpdateHistory(history, replace, k, v, detail, newPathname, newSearch) {\n  let state = {};\n  const newLength = ((history.location.state && history.location.state.__historyLength) || 0) + (replace ? 0 : 1);\n\n  if (k || newPathname || newSearch) {\n    state = history.location.state ? { ...history.location.state } : {};\n    delete state.__duplicate;\n\n    if (k) {\n      state[k] = v;\n      state.key = k;\n      state.value = v;\n      state.detail = detail;\n    }\n  }\n\n  const pathname =\n    newPathname !== undefined ? newPathname : history.location.pathname === \"/\" ? \"\" : history.location.pathname;\n\n  const search = newSearch !== undefined ? newSearch : history.location.search;\n\n  // If popToBeginningOfHubHistory was previously used, there is a duplicate entry\n  // at the top of the history stack (which was needed to wipe out forward history)\n  // so we use this opportunity to replace it.\n  const isDuplicate = history.location.state && history.location.state.__duplicate;\n  const method = replace || isDuplicate ? history.replace : history.push;\n  state.__historyLength = newLength;\n\n  method({ pathname, search, state });\n}\n\nexport function pushHistoryState(history, k, v, detail) {\n  pushOrUpdateHistory(history, false, k, v, detail);\n}\n\nexport function replaceHistoryState(history, k, v, detail) {\n  pushOrUpdateHistory(history, true, k, v, detail);\n}\n\nexport function pushHistoryPath(history, path, search) {\n  pushOrUpdateHistory(history, false, null, null, null, path, search);\n}\n\nexport function clearHistoryState(history) {\n  pushOrUpdateHistory(history, false);\n}\n\n// This will pop the browser history to the first entry that was for this hubs room,\n// and then push a duplicate entry onto the history stack in order to wipe out forward\n// history.\nexport function popToBeginningOfHubHistory(history, navigateToPriorPage) {\n  if (!history.location.state || history.location.state.__historyLength === undefined) return;\n\n  const len = history.location.state.__historyLength;\n  if (len === 0) return;\n\n  return new Promise(resolve => {\n    // After the go() completes, we push a duplicate history entry onto the stack\n    // in order to wipe out forward history. We also optionally go back -2 if we wanted\n    // to go back to the prior page.\n    const unsubscribe = history.listen(() => {\n      unsubscribe();\n      history.push({\n        pathname: history.location.pathname,\n        search: history.location.search,\n        state: { __historyLength: 0, __duplicate: true }\n      });\n      if (navigateToPriorPage) history.go(-2); // Go back to history entry before beginning.\n      resolve();\n    });\n\n    history.go(-len);\n  });\n}\n\n// This will pop the browser history to the entry before the first entry for this hubs room.\nexport function navigateToPriorPage(history) {\n  popToBeginningOfHubHistory(history, true);\n}\n\n// Returns the part of the pathname that does not include the slug\nexport function sluglessPath(location) {\n  const parts = location.pathname.split(\"/\");\n  return `/${parts.slice(2).join(\"/\")}`;\n}\n\n// Returns a new path that includes the current slug as a prefix to the\n// provided path.\nexport function withSlug(location, path) {\n  const parts = location.pathname.split(\"/\");\n  return `/${parts[1]}${path}`;\n}\n","module.exports = __webpack_public_path__ + \"assets/images/presence_phone-fd7ea0e8be441172a758704055604e5f.png\";","module.exports = __webpack_public_path__ + \"assets/images/presence_desktop-be24a9f21df60cd831ad66b67282d6f2.png\";","module.exports = __webpack_public_path__ + \"assets/images/presence_discord-e05ead6e6ebc08df9291738d0aa6986d.png\";","module.exports = __webpack_public_path__ + \"assets/images/presence_camera-aaa719190a30677416c33e3dda33d7ef.png\";","module.exports = __webpack_public_path__ + \"assets/images/presence_vr-563f3bd1c0f37473a3303f4a6049288c.png\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"avatar-editor\":\"avatar-editor__avatar-editor__xtJ6P\",\"avatarEditor\":\"avatar-editor__avatar-editor__xtJ6P\"};","module.exports = __webpack_public_path__ + \"assets/images/level_background-9744d0690bba7838e4a75949d9645c09.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_background@2x-bf55b6a808963d89ff7ce04c516c232c.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_fill-35626a008836cbdc34ec624e16f5b723.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_fill@2x-b3e3675f8281c84660fb5b47eb66126e.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_level-d197b930a4350dc80adb2446babb05e1.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_level@2x-9d49309c2f0e55e5c54193237658768b.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_action_background-5aeb2dca8113545a2bc3e56dc702001b.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_action_background@2x-3a7ab65c95a1b4037d701c8fa16c3cd6.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_action_fill-4e639ed717b8a9a7da4426665ec2dcf4.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_action_fill@2x-eb547f6337c0ea74b35da9812ee3e04b.png\";","module.exports = __webpack_public_path__ + \"assets/images/speaker_level-9567a1a6f33d4d0e59e57903b08369c9.png\";","module.exports = __webpack_public_path__ + \"assets/images/speaker_level@2x-b5e6a12f613576cf5c1a1b96e8c9d8d0.png\";","module.exports = __webpack_public_path__ + \"assets/sfx/tone-624e72d19fe0cea1b85ca174cb6be256.webm\";","module.exports = __webpack_public_path__ + \"assets/sfx/tone-3fa0defb5172b2533fedcc1929605799.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/tone-78ae5a60f0e336f384919eee9f5a2e18.ogg\";","module.exports = __webpack_public_path__ + \"assets/sfx/tone-4604a4c98f36f3e0c6980295bc5c7ffe.wav\";","module.exports = __webpack_public_path__ + \"assets/images/change_avatar-a426739806600c28e20a614cbade29f2.svg\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"label\":\"spectating-label__label__3JS5A\"};","module.exports = \"#version 300 es\\nprecision highp float;\\nprecision highp int;\\n\\n// Keep these separate so three only sets them once\\nuniform mat4 viewMatrix;\\nuniform mat4 projectionMatrix;\\n\\nlayout(std140) uniform InstanceData {\\n  mat4 transforms[MAX_INSTANCES];\\n  vec4 colors[MAX_INSTANCES];\\n  vec4 uvTransforms[MAX_INSTANCES];\\n  vec4 mapSettings[MAX_INSTANCES];\\n\\n  vec4 hubs_SweepParams[MAX_INSTANCES];\\n\\n  vec3 hubs_InteractorOnePos;\\n  bool hubs_IsFrozen;\\n\\n  vec3 hubs_InteractorTwoPos;\\n  float hubs_Time;\\n\\n} instanceData;\\n\\nout vec3 hubs_WorldPosition;\\n\\nin vec3 position;\\nin vec2 uv;\\n\\n#ifdef PSEUDO_INSTANCING\\nin float instance;\\nflat out uint vInstance;\\n#endif\\n\\n#ifdef VERTEX_COLORS\\nin vec3 color;\\n#endif\\n\\nout vec2 vUv;\\nout vec4 vColor;\\n\\nflat out vec4 vUVTransform;\\nflat out vec4 vMapSettings;\\n\\nvoid main() {\\n  #ifdef PSEUDO_INSTANCING\\n  uint instanceIndex = uint(instance);\\n  #elif\\n  uint instanceIndex = gl_InstanceID;\\n  #endif\\n\\n  vColor = instanceData.colors[instanceIndex];\\n\\n  #ifdef VERTEX_COLORS\\n  vColor *= vec4(color, 1.0);\\n  #endif\\n\\n  vUv = uv;\\n  vUVTransform = instanceData.uvTransforms[instanceIndex];\\n  vMapSettings = instanceData.mapSettings[instanceIndex];\\n\\n  gl_Position = projectionMatrix * viewMatrix * instanceData.transforms[instanceIndex] * vec4(position, 1.0);\\n\\n  hubs_WorldPosition = (instanceData.transforms[instanceIndex] * vec4(position, 1.0)).xyz;\\n  vInstance = instanceIndex;\\n}\\n\"","module.exports = \"#version 300 es\\nprecision highp float;\\nprecision highp int;\\nprecision highp sampler2DArray;\\n\\n\\nlayout(std140) uniform InstanceData {\\n  mat4 transforms[MAX_INSTANCES];\\n  vec4 colors[MAX_INSTANCES];\\n  vec4 uvTransforms[MAX_INSTANCES];\\n  vec4 mapSettings[MAX_INSTANCES];\\n\\n  vec4 hubs_SweepParams[MAX_INSTANCES];\\n\\n  vec3 hubs_InteractorOnePos;\\n  bool hubs_IsFrozen;\\n\\n  vec3 hubs_InteractorTwoPos;\\n  float hubs_Time;\\n\\n} instanceData;\\nin vec3 hubs_WorldPosition;\\n#ifdef PSEUDO_INSTANCING\\nflat in uint vInstance;\\n#endif\\n\\n\\nuniform sampler2DArray map;\\n\\nin vec2 vUv;\\nin vec4 vColor;\\nflat in vec4 vUVTransform;\\nflat in vec4 vMapSettings;\\n\\nout vec4 outColor;\\n\\nfloat applyWrapping(float value, int mode) {\\n  if (mode == 0) {\\n    // CLAMP_TO_EDGE - default\\n    return clamp(value, 0.0, 1.0);\\n  } else if (mode == 1) {\\n    // REPEAT\\n    return fract(value);\\n  } else {\\n    // MIRRORED_REPEAT\\n    float n = mod(value, 2.0);\\n    return mix(n, 2.0 - n, step(1.0, n));\\n  }\\n}\\n\\nvoid main() {\\n  vec2 uv = vUv;\\n\\n  int wrapS = int(vMapSettings.y);\\n  int wrapT = int(vMapSettings.z);\\n  uv.s = applyWrapping(uv.s, wrapS);\\n  uv.t = applyWrapping(uv.t, wrapT);\\n\\n  vec2 uvMin = vUVTransform.xy;\\n  vec2 uvScale = vUVTransform.zw;\\n  uv = uvMin + uv * uvScale;\\n\\n  int mapIdx = int(vMapSettings.x);\\n  outColor = texture(map, vec3(uv, mapIdx)) * vColor;\\n  if(outColor.a == 0.0) {\\n      discard;\\n  }\\n\\n  bool hubs_HighlightInteractorOne = instanceData.hubs_SweepParams[vInstance].z > 0.0;\\n  bool hubs_HighlightInteractorTwo = instanceData.hubs_SweepParams[vInstance].w > 0.0;\\n  bool hubs_IsFrozen = instanceData.hubs_IsFrozen;\\n\\n  if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\\n\\n      bool hubs_EnableSweepingEffect = true;\\n      vec2 hubs_SweepParams = instanceData.hubs_SweepParams[vInstance].xy;\\n      float hubs_Time = instanceData.hubs_Time;\\n\\n      float ratio = 0.0;\\n\\n      if (hubs_EnableSweepingEffect) {\\n          float size = hubs_SweepParams.t - hubs_SweepParams.s;\\n          float line = mod(hubs_Time / 500.0 * size, size * 3.0) + hubs_SweepParams.s - size / 3.0;\\n\\n          if (hubs_WorldPosition.y < line) {\\n              // Highlight with a sweeping gradient.\\n              ratio = max(0.0, 1.0 - (line - hubs_WorldPosition.y) / (size * 1.5));\\n          }\\n      }\\n\\n      // Highlight with a gradient falling off with distance.\\n      float pulse = 9.0 + 3.0 * (sin(hubs_Time / 1000.0) + 1.0);\\n\\n      if (hubs_HighlightInteractorOne) {\\n          float dist1 = distance(hubs_WorldPosition, instanceData.hubs_InteractorOnePos);\\n          ratio += -min(1.0, pow(dist1 * pulse, 3.0)) + 1.0;\\n      }\\n\\n      if (hubs_HighlightInteractorTwo) {\\n          float dist2 = distance(hubs_WorldPosition, instanceData.hubs_InteractorTwoPos);\\n          ratio += -min(1.0, pow(dist2 * pulse, 3.0)) + 1.0;\\n      }\\n\\n      ratio = min(1.0, ratio);\\n\\n      // Gamma corrected highlight color\\n      vec3 highlightColor = vec3(0.184, 0.499, 0.933);\\n\\n      outColor = vec4((outColor.rgb * (1.0 - ratio)) + (highlightColor * ratio), outColor.a);\\n  }\\n\\n}\\n\"","module.exports = __webpack_public_path__ + \"assets/images/spritesheets/sprite-system-spritesheet-1af3105a194b8991cb4f0c36be2c92b8.png\";","module.exports = \"attribute vec4 mvCol0;\\nattribute vec4 mvCol1;\\nattribute vec4 mvCol2;\\nattribute vec4 mvCol3;\\nattribute vec3 a_vertices;\\nattribute vec2 a_uvs;\\nvarying vec2 v_uvs;\\nattribute float a_hubs_EnableSweepingEffect;\\nvarying float v_hubs_EnableSweepingEffect;\\nattribute vec2 a_hubs_SweepParams;\\nvarying vec2 v_hubs_SweepParams;\\nvarying vec3 hubs_WorldPosition;\\n\\nvoid main() {\\n  mat4 mv = mat4(mvCol0, mvCol1, mvCol2, mvCol3);\\n  gl_Position = projectionMatrix * modelViewMatrix * mv * vec4(a_vertices, 1.0);\\n  v_uvs = a_uvs;\\n  v_hubs_EnableSweepingEffect = a_hubs_EnableSweepingEffect;\\n  v_hubs_SweepParams = a_hubs_SweepParams;\\n\\n  vec4 wt = vec4(a_vertices, 1.0);\\n  hubs_WorldPosition = (mv * wt).xyz;\\n}\\n\"","module.exports = \"precision mediump float;\\n\\nuniform sampler2D u_spritesheet;\\n\\nvarying vec2 v_uvs;\\n\\nvarying float v_hubs_EnableSweepingEffect;\\nvarying vec2 v_hubs_SweepParams;\\nvarying vec3 hubs_WorldPosition;\\nuniform bool hubs_HighlightInteractorOne;\\nuniform vec3 hubs_InteractorOnePos;\\nuniform bool hubs_HighlightInteractorTwo;\\nuniform vec3 hubs_InteractorTwoPos;\\nuniform float hubs_Time;\\n\\n#define GAMMA_FACTOR 2.2\\n\\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\\n  return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\\n}\\n\\nvec4 linearToOutputTexel( vec4 value ) {\\n  return LinearToGamma( value, float( GAMMA_FACTOR ) );\\n}\\n\\nvoid main() {\\n    vec4 texColor = texture2D(u_spritesheet, v_uvs);\\n\\n    float ratio = 0.0;\\n    if (v_hubs_EnableSweepingEffect > 0.9 ) {\\n        float size = v_hubs_SweepParams.t - v_hubs_SweepParams.s * 1.0;\\n        float line = mod(hubs_Time / 500.0 * size, size * 3.0) + v_hubs_SweepParams.s - size / 3.0;\\n        if (hubs_WorldPosition.y < line) {\\n            ratio = max(0.0, 1.0 - (line - hubs_WorldPosition.y) / (size * 1.5));\\n        }\\n\\n    }\\n    ratio = min(1.0, ratio);\\n\\n    vec4 highlightColor = linearToOutputTexel(vec4(0.184, 0.499, 0.933, 1.0));\\n    gl_FragColor = vec4((texColor.rgb * (1.0 - ratio)) + (highlightColor.rgb * ratio), texColor.a);\\n}\\n\"","module.exports = __webpack_public_path__ + \"assets/sfx/tick-b0fcbf1d9b6f92a24bec12f9bae1e42a.mp3\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"profile-entry\":\"profile__profile-entry__1pJKZ\",\"profileEntry\":\"profile__profile-entry__1pJKZ\",\"form-submit\":\"profile__form-submit__2y7xb\",\"formSubmit\":\"profile__form-submit__2y7xb\",\"choose-avatar\":\"profile__choose-avatar__2EV0F\",\"chooseAvatar\":\"profile__choose-avatar__2EV0F\",\"form-field-text\":\"profile__form-field-text__1bzeV\",\"formFieldText\":\"profile__form-field-text__1bzeV\",\"title\":\"profile__title__Vcynv\",\"logo\":\"profile__logo__1JZAd\",\"form\":\"profile__form__1-hBO\",\"box\":\"profile__box__oJXQD\",\"links\":\"profile__links__2hukW\",\"darkened\":\"profile__darkened__1rVba\",\"display-name\":\"profile__display-name__auABh\",\"displayName\":\"profile__display-name__auABh\",\"preview\":\"profile__preview__3QjLq\",\"edit-avatar\":\"profile__edit-avatar__3386A\",\"editAvatar\":\"profile__edit-avatar__3386A\",\"close\":\"profile__close__2Uitz\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"mic-off-0\":\"css-spritesheet__mic-off-0__1ZJb1\",\"micOff0\":\"css-spritesheet__mic-off-0__1ZJb1\",\"mic-1\":\"css-spritesheet__mic-1__1tNtE\",\"mic1\":\"css-spritesheet__mic-1__1tNtE\",\"mic-2\":\"css-spritesheet__mic-2__2a7bH\",\"mic2\":\"css-spritesheet__mic-2__2a7bH\",\"mic-3\":\"css-spritesheet__mic-3__2A0Xs\",\"mic3\":\"css-spritesheet__mic-3__2A0Xs\",\"mic-4\":\"css-spritesheet__mic-4__ig2RD\",\"mic4\":\"css-spritesheet__mic-4__ig2RD\",\"mic-5\":\"css-spritesheet__mic-5__10MFm\",\"mic5\":\"css-spritesheet__mic-5__10MFm\",\"mic-6\":\"css-spritesheet__mic-6__3-bU1\",\"mic6\":\"css-spritesheet__mic-6__3-bU1\",\"mic-7\":\"css-spritesheet__mic-7__3j-4R\",\"mic7\":\"css-spritesheet__mic-7__3j-4R\",\"mic-0\":\"css-spritesheet__mic-0__2XVsh\",\"mic0\":\"css-spritesheet__mic-0__2XVsh\",\"mic-off-1\":\"css-spritesheet__mic-off-1__PLn60\",\"micOff1\":\"css-spritesheet__mic-off-1__PLn60\",\"mic-off-2\":\"css-spritesheet__mic-off-2__ArmUv\",\"micOff2\":\"css-spritesheet__mic-off-2__ArmUv\",\"mic-off-3\":\"css-spritesheet__mic-off-3__33n8o\",\"micOff3\":\"css-spritesheet__mic-off-3__33n8o\",\"mic-off-4\":\"css-spritesheet__mic-off-4__5L_ui\",\"micOff4\":\"css-spritesheet__mic-off-4__5L_ui\",\"mic-off-5\":\"css-spritesheet__mic-off-5__3DqkV\",\"micOff5\":\"css-spritesheet__mic-off-5__3DqkV\",\"mic-off-6\":\"css-spritesheet__mic-off-6__2a7HR\",\"micOff6\":\"css-spritesheet__mic-off-6__2a7HR\",\"mic-off-7\":\"css-spritesheet__mic-off-7__Y2kJU\",\"micOff7\":\"css-spritesheet__mic-off-7__Y2kJU\"};","import { fetchReticulumAuthenticated } from \"./phoenix-utils\";\nimport { proxiedUrlFor } from \"./media-url-utils\";\nimport { avatars } from \"../assets/avatars/avatars\";\n\nexport const AVATAR_TYPES = {\n  LEGACY: \"legacy\",\n  SKINNABLE: \"skinnable\",\n  URL: \"url\"\n};\n\nconst legacyAvatarIds = avatars.map(a => a.id);\nexport function getAvatarType(avatarId) {\n  if (!avatarId || legacyAvatarIds.indexOf(avatarId) !== -1) return AVATAR_TYPES.LEGACY;\n  if (avatarId.startsWith(\"http\")) return AVATAR_TYPES.URL;\n  return AVATAR_TYPES.SKINNABLE;\n}\n\nasync function fetchSkinnableAvatar(avatarId) {\n  const resp = await fetchReticulumAuthenticated(`/api/v1/avatars/${avatarId}`);\n  return resp && resp.avatars && resp.avatars[0];\n}\n\nexport async function fetchAvatar(avatarId) {\n  switch (getAvatarType(avatarId)) {\n    case AVATAR_TYPES.LEGACY:\n      return {\n        avatar_id: avatarId,\n        gltf_url: avatars.find(avatar => avatar.id === avatarId).model\n      };\n    case AVATAR_TYPES.SKINNABLE:\n      return fetchSkinnableAvatar(avatarId);\n    case AVATAR_TYPES.URL:\n      return {\n        avatar_id: avatarId,\n        gltf_url: proxiedUrlFor(avatarId)\n      };\n  }\n}\n\nasync function fetchAvatarGltfUrl(avatarId) {\n  return fetchAvatar(avatarId).then(avatar => avatar && avatar.gltf_url);\n}\n\nexport function getAvatarSrc(avatarId) {\n  switch (getAvatarType(avatarId)) {\n    case AVATAR_TYPES.LEGACY:\n      return `#${avatarId}`;\n    case AVATAR_TYPES.SKINNABLE:\n      return fetchAvatarGltfUrl(avatarId);\n    case AVATAR_TYPES.URL:\n      return proxiedUrlFor(avatarId);\n    default:\n      return avatarId;\n  }\n}\n\nexport async function getAvatarThumbnailUrl(avatarId) {\n  switch (getAvatarType(avatarId)) {\n    case AVATAR_TYPES.LEGACY:\n      return avatars.find(avatar => avatar.id === avatarId).thumbnail;\n    case AVATAR_TYPES.SKINNABLE:\n      return fetchAvatar(avatarId).then(avatar => avatar.files.thumbnail);\n    default:\n      return \"https://asset-bundles-prod.reticulum.io/bots/avatar_unavailable.png\";\n  }\n}\n","import screenfull from \"screenfull\";\n\nlet hasEnteredFullScreenThisSession = false;\n\nfunction shouldShowFullScreen() {\n  // Disable full screen on iOS, since Safari's fullscreen mode does not let you prevent native pinch-to-zoom gestures.\n  return (\n    (AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR()) &&\n    !AFRAME.utils.device.isIOS() &&\n    screenfull.enabled\n  );\n}\n\nexport function willRequireUserGesture() {\n  return !screenfull.isFullscreen && shouldShowFullScreen();\n}\n\nexport function showFullScreenIfAvailable() {\n  if (shouldShowFullScreen()) {\n    screenfull.request();\n    hasEnteredFullScreenThisSession = true;\n  }\n}\n\nexport function showFullScreenIfWasFullScreen() {\n  if (hasEnteredFullScreenThisSession && !screenfull.isFullscreen) {\n    screenfull.request();\n  }\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"title\":\"room-info-dialog__title__3-3CO\",\"room-info\":\"room-info-dialog__room-info__3XkbS\",\"roomInfo\":\"room-info-dialog__room-info__3XkbS\",\"scene-screenshot\":\"room-info-dialog__scene-screenshot__3PWz-\",\"sceneScreenshot\":\"room-info-dialog__scene-screenshot__3PWz-\",\"scene-details\":\"room-info-dialog__scene-details__2pYml\",\"sceneDetails\":\"room-info-dialog__scene-details__2pYml\",\"scene-main\":\"room-info-dialog__scene-main__2mhXj\",\"sceneMain\":\"room-info-dialog__scene-main__2mhXj\",\"scene-name\":\"room-info-dialog__scene-name__1bqGh\",\"sceneName\":\"room-info-dialog__scene-name__1bqGh\",\"scene-creator\":\"room-info-dialog__scene-creator__3_za4\",\"sceneCreator\":\"room-info-dialog__scene-creator__3_za4\",\"scene-attributions\":\"room-info-dialog__scene-attributions__QpYVd\",\"sceneAttributions\":\"room-info-dialog__scene-attributions__QpYVd\",\"attribution\":\"room-info-dialog__attribution__I9_V-\",\"attribution-name\":\"room-info-dialog__attribution-name__3JTpI\",\"attributionName\":\"room-info-dialog__attribution-name__3JTpI\",\"attribution-author\":\"room-info-dialog__attribution-author__BouZB\",\"attributionAuthor\":\"room-info-dialog__attribution-author__BouZB\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"buttons\":\"tweet-dialog__buttons__1gYv2\",\"tweet-button\":\"tweet-dialog__tweet-button__3XvNj\",\"tweetButton\":\"tweet-dialog__tweet-button__3XvNj\",\"tweet\":\"tweet-dialog__tweet__25N6e\",\"editor\":\"tweet-dialog__editor__3xJV-\",\"editor-inner\":\"tweet-dialog__editor-inner__1Zhzc\",\"editorInner\":\"tweet-dialog__editor-inner__1Zhzc\",\"emoji-button\":\"tweet-dialog__emoji-button__2L9tR\",\"emojiButton\":\"tweet-dialog__emoji-button__2L9tR\",\"counter\":\"tweet-dialog__counter__2OZyX\",\"highlight\":\"tweet-dialog__highlight__1EXxs\",\"media\":\"tweet-dialog__media__IeN9e\",\"posted\":\"tweet-dialog__posted__2t8RC\",\"tweet-loader\":\"tweet-dialog__tweet-loader__3Q8YL\",\"tweetLoader\":\"tweet-dialog__tweet-loader__3Q8YL\",\"dialog-background\":\"tweet-dialog__dialog-background__2vvyQ\",\"dialogBackground\":\"tweet-dialog__dialog-background__2vvyQ\"};","const VERTEX_SHADER = `\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n  #include <uv_vertex>\n  #include <uv2_vertex>\n  #include <color_vertex>\n  #include <skinbase_vertex>\n\n  #include <begin_vertex>\n  #include <morphtarget_vertex>\n  #include <skinning_vertex>\n  #include <project_vertex>\n  #include <logdepthbuf_vertex>\n\n  #include <worldpos_vertex>\n  #include <clipping_planes_vertex>\n  #include <fog_vertex>\n}\n`;\n\nconst FRAGMENT_SHADER = `\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <aomap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n  #include <clipping_planes_fragment>\n\n  vec4 diffuseColor = vec4(diffuse, opacity);\n  ReflectedLight reflectedLight = ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0), vec3(0.0));\n  vec3 totalEmissiveRadiance = emissive;\n\n  #include <logdepthbuf_fragment>\n  #include <map_fragment>\n  #include <color_fragment>\n  #include <alphatest_fragment>\n  #include <emissivemap_fragment>\n\n  reflectedLight.indirectDiffuse += vec3(1.0);\n\n  #include <aomap_fragment>\n\n  reflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\n  vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n  gl_FragColor = vec4(outgoingLight, diffuseColor.a);\n\n  #include <premultiplied_alpha_fragment>\n  #include <tonemapping_fragment>\n  #include <encodings_fragment>\n  #include <fog_fragment>\n}\n`;\n\nexport default class MobileStandardMaterial extends THREE.ShaderMaterial {\n  type = \"MobileStandardMaterial\";\n  isMobileStandardMaterial = true;\n  static fromStandardMaterial(material) {\n    const parameters = {\n      vertexShader: VERTEX_SHADER,\n      fragmentShader: FRAGMENT_SHADER,\n      uniforms: {\n        uvTransform: { value: new THREE.Matrix3() },\n        diffuse: { value: material.color },\n        opacity: { value: material.opacity },\n        map: { value: material.map },\n        aoMapIntensity: { value: material.aoMapIntensity },\n        aoMap: { value: material.aoMap },\n        emissive: { value: material.emissive },\n        emissiveMap: { value: material.emissiveMap }\n      },\n      fog: true,\n      lights: false,\n      opacity: material.opacity,\n      transparent: material.transparent,\n      alphaTest: material.alphaTest,\n      skinning: material.skinning,\n      morphTargets: material.morphTargets,\n      vertexColors: material.vertexColors\n    };\n\n    const mobileMaterial = new MobileStandardMaterial(parameters);\n\n    mobileMaterial.color = material.color;\n    mobileMaterial.map = material.map;\n    mobileMaterial.aoMap = material.aoMap;\n    mobileMaterial.aoMapIntensity = material.aoMapIntensity;\n    mobileMaterial.emissive = material.emissive;\n    mobileMaterial.emissiveMap = material.emissiveMap;\n\n    return mobileMaterial;\n  }\n  clone() {\n    return MobileStandardMaterial.fromStandardMaterial(this);\n  }\n}\n","import { EventTarget } from \"event-target-shim\";\nimport { getReticulumFetchUrl, fetchReticulumAuthenticated } from \"../utils/phoenix-utils\";\nimport { pushHistoryPath, sluglessPath, withSlug } from \"../utils/history\";\n\nexport const SOURCES = [\"poly\", \"sketchfab\", \"videos\", \"scenes\", \"gifs\", \"images\", \"twitch\"];\n\nconst EMPTY_RESULT = { entries: [], meta: {} };\n\nconst URL_SOURCE_TO_TO_API_SOURCE = {\n  scenes: \"scene_listings\",\n  images: \"bing_images\",\n  videos: \"bing_videos\",\n  youtube: \"youtube_videos\",\n  gifs: \"tenor\",\n  sketchfab: \"sketchfab\",\n  poly: \"poly\",\n  twitch: \"twitch\",\n  favorites: \"favorites\"\n};\n\nexport const MEDIA_SOURCE_DEFAULT_FILTERS = {\n  gifs: \"trending\",\n  sketchfab: \"featured\",\n  scenes: \"featured\",\n  favorites: \"my-favorites\"\n};\n\nconst SEARCH_CONTEXT_PARAMS = [\"q\", \"filter\", \"cursor\"];\n\n// This class is responsible for fetching and storing media search results and provides a\n// convenience API for performing history updates relevant to search navigation.\nexport default class MediaSearchStore extends EventTarget {\n  constructor() {\n    super();\n\n    this.requestIndex = 0;\n  }\n\n  setHistory(history) {\n    this.history = history;\n\n    this._update(this.history.location);\n\n    this.history.listen(location => {\n      this._update(location);\n    });\n  }\n\n  _update = async location => {\n    this.result = null;\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n\n    const urlSource = this.getUrlMediaSource(location);\n    if (!urlSource) return;\n\n    if (!this.previousSource || this.previousSource !== urlSource) {\n      this.dispatchEvent(new CustomEvent(\"sourcechanged\"));\n      this.previousSource = urlSource;\n    }\n\n    const urlParams = new URLSearchParams(location.search);\n\n    this.requestIndex++;\n    const currentRequestIndex = this.requestIndex;\n    const searchParams = new URLSearchParams();\n    const locationSearchParams = new URLSearchParams(location.search);\n    const isMy = locationSearchParams.get(\"filter\") && locationSearchParams.get(\"filter\").startsWith(\"my-\");\n\n    for (const param of SEARCH_CONTEXT_PARAMS) {\n      if (!urlParams.get(param)) continue;\n      searchParams.set(param, urlParams.get(param));\n    }\n\n    searchParams.get(\"locale\", navigator.languages[0]);\n\n    let source;\n    if (urlSource === \"avatars\" || urlSource === \"scenes\") {\n      // Avatars + scenes are special since we request them from a different source based on the facet.\n      const singular = urlSource === \"avatars\" ? \"avatar\" : \"scene\";\n      source = isMy ? `${singular}s` : `${singular}_listings`;\n    } else {\n      source = URL_SOURCE_TO_TO_API_SOURCE[urlSource];\n    }\n    searchParams.set(\"source\", source);\n\n    let fetch = true;\n\n    if (source === \"avatars\" || source === \"scenes\" || source === \"favorites\") {\n      if (isMy) {\n        if (window.APP.store.credentialsAccountId) {\n          searchParams.set(\"user\", window.APP.store.credentialsAccountId);\n        } else {\n          fetch = false; // Don't fetch my-* if not signed in\n        }\n      }\n    }\n\n    const path = `/api/v1/media/search?${searchParams.toString()}`;\n    const url = getReticulumFetchUrl(path);\n    if (this.lastSavedUrl === url) return;\n\n    this.isFetching = true;\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n    const result = fetch ? await fetchReticulumAuthenticated(path) : EMPTY_RESULT;\n\n    if (this.requestIndex != currentRequestIndex) return;\n\n    this.result = result;\n    this.nextCursor = this.result && this.result.meta && this.result.meta.next_cursor;\n    this.lastFetchedUrl = url;\n    this.isFetching = false;\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n  };\n\n  _legacyAvatarToSearchEntry = legacyAvatar => {\n    return {\n      id: legacyAvatar.id,\n      type: \"avatar_listing\",\n      url: legacyAvatar.url,\n      images: { preview: { url: legacyAvatar.thumbnail, width: 720, height: 1280 } },\n      gltfs: { avatar: legacyAvatar.model }\n    };\n  };\n\n  pageNavigate = delta => {\n    if (delta === -1) {\n      this.history.goBack();\n    } else {\n      const location = this.history.location;\n      const searchParams = new URLSearchParams(location.search);\n      searchParams.set(\"cursor\", this.nextCursor);\n      pushHistoryPath(this.history, location.pathname, searchParams.toString());\n    }\n  };\n\n  filterQueryNavigate = (filter, query) => {\n    const location = this.history.location;\n    const searchParams = new URLSearchParams(location.search);\n\n    if (query) {\n      searchParams.set(\"q\", query);\n    } else {\n      searchParams.delete(\"q\");\n    }\n\n    if (filter) {\n      searchParams.set(\"filter\", filter);\n    } else {\n      searchParams.delete(\"filter\");\n    }\n\n    if (filter) {\n      searchParams.set(\"cursor\", filter);\n    } else {\n      searchParams.delete(\"cursor\");\n    }\n\n    pushHistoryPath(this.history, location.pathname, searchParams.toString());\n  };\n\n  getSearchClearedSearchParams = (location, keepSource, keepNav) => {\n    const searchParams = new URLSearchParams(location.search);\n\n    // Strip browsing query params\n    searchParams.delete(\"q\");\n    searchParams.delete(\"filter\");\n    searchParams.delete(\"cursor\");\n\n    if (!keepNav) {\n      searchParams.delete(\"media_nav\");\n    }\n\n    if (!keepSource) {\n      searchParams.delete(\"media_source\");\n    }\n\n    return searchParams;\n  };\n\n  _stashLastSearchParams = location => {\n    const searchParams = new URLSearchParams(location.search);\n\n    this._stashedParams = {};\n    this._stashedSource = null;\n\n    const source = this.getUrlMediaSource(location);\n\n    // HACK for now do not stash favorite search, since that ends up being a source\n    // we do not reveal in the media browser UX. Revisit the rules here when we have a\n    // proper favorites browser. Then, we should have two separate stashes.\n    if (source === \"favorites\") return;\n    this._stashedSource = source;\n\n    for (const param of SEARCH_CONTEXT_PARAMS) {\n      const value = searchParams.get(param);\n\n      if (value) {\n        this._stashedParams[param] = value;\n      }\n    }\n  };\n\n  clearStashedQuery = () => {\n    if (!this._stashedParams) return;\n    delete this._stashedParams.q;\n  };\n\n  sourceNavigate = source => {\n    this._sourceNavigate(source, false, true);\n  };\n\n  sourceNavigateToDefaultSource = () => {\n    this._sourceNavigate(this._stashedSource ? this._stashedSource : SOURCES[0], false, true);\n  };\n\n  sourceNavigateWithNoNav = source => {\n    this._sourceNavigate(source, true, false);\n  };\n\n  _sourceNavigate = async (source, hideNav, useLastStashedParams) => {\n    const currentQuery = new URLSearchParams(this.history.location.search).get(\"q\");\n    const searchParams = this.getSearchClearedSearchParams(this.history.location);\n\n    if (currentQuery) {\n      searchParams.set(\"q\", currentQuery);\n    } else {\n      if (useLastStashedParams && this._stashedParams) {\n        for (const param of SEARCH_CONTEXT_PARAMS) {\n          const value = this._stashedParams[param];\n\n          // Only q param is compatible across sources, so keep it if is stashed.\n          const useValue = param === \"q\" || this._stashedSource === source;\n\n          if (value && useValue) {\n            searchParams.set(param, value);\n          }\n        }\n      } else {\n        if (source === \"avatars\") {\n          const hasAccountWithAvatars = await this._hasAccountWithAvatars();\n          searchParams.set(\"filter\", hasAccountWithAvatars ? \"my-avatars\" : \"featured\");\n        } else if (MEDIA_SOURCE_DEFAULT_FILTERS[source]) {\n          searchParams.set(\"filter\", MEDIA_SOURCE_DEFAULT_FILTERS[source]);\n        }\n      }\n    }\n\n    this._stashedParams = null;\n    this._stashedSource = null;\n\n    if (hideNav) {\n      searchParams.set(\"media_nav\", \"false\");\n    }\n\n    if (process.env.RETICULUM_SERVER && document.location.host !== process.env.RETICULUM_SERVER) {\n      searchParams.set(\"media_source\", source);\n      pushHistoryPath(this.history, this.history.location.pathname, searchParams.toString());\n    } else {\n      pushHistoryPath(this.history, withSlug(this.history.location, `/media/${source}`), searchParams.toString());\n    }\n  };\n\n  _hasAccountWithAvatars = async () => {\n    const { credentialsAccountId } = window.APP.store;\n    if (!credentialsAccountId) return false;\n\n    const searchParams = new URLSearchParams();\n    const source = \"avatars\";\n    searchParams.set(\"source\", source);\n    searchParams.set(\"user\", credentialsAccountId);\n    const result = await fetchReticulumAuthenticated(`/api/v1/media/search?${searchParams.toString()}`);\n    return !!(result && result.entries) && result.entries.length > 0;\n  };\n\n  getUrlMediaSource = location => {\n    const { search } = location;\n    const urlParams = new URLSearchParams(search);\n    const pathname = sluglessPath(location);\n\n    if (!pathname.startsWith(\"/media\") && !urlParams.get(\"media_source\")) return null;\n    return urlParams.get(\"media_source\") || pathname.substring(7);\n  };\n\n  pushExitMediaBrowserHistory = (history, stashLastSearchParams = true) => {\n    if (!history) history = this.history;\n\n    if (stashLastSearchParams) this._stashLastSearchParams(history.location);\n\n    const { pathname } = history.location;\n    const hasMediaPath = sluglessPath(history.location).startsWith(\"/media\");\n    pushHistoryPath(\n      history,\n      hasMediaPath ? withSlug(history.location, \"/\") : pathname,\n      this.getSearchClearedSearchParams(history.location).toString()\n    );\n    this.dispatchEvent(new CustomEvent(\"media-exit\"));\n  };\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ui\":\"hub__ui__3UYRO\",\"ui-dialog\":\"hub__ui-dialog__vlyfc\",\"uiDialog\":\"hub__ui-dialog__vlyfc\",\"ui-interactive\":\"hub__ui-interactive__3bdyc\",\"uiInteractive\":\"hub__ui-interactive__3bdyc\",\"presence-info\":\"hub__presence-info__dqWyo\",\"presenceInfo\":\"hub__presence-info__dqWyo\",\"corner-button\":\"hub__corner-button__2KphD\",\"cornerButton\":\"hub__corner-button__2KphD\",\"profile-entry\":\"hub__profile-entry__1RY0R\",\"profileEntry\":\"hub__profile-entry__1RY0R\",\"form-submit\":\"hub__form-submit__12yem\",\"formSubmit\":\"hub__form-submit__12yem\",\"nag-corner-button\":\"hub__nag-corner-button__lNoyE\",\"nagCornerButton\":\"hub__nag-corner-button__lNoyE\",\"choose-scene-button\":\"hub__choose-scene-button__5Y0Q_\",\"chooseSceneButton\":\"hub__choose-scene-button__5Y0Q_\",\"choose-avatar\":\"hub__choose-avatar__22JJm\",\"chooseAvatar\":\"hub__choose-avatar__22JJm\",\"entry-button-secondary\":\"hub__entry-button-secondary__2ui-g\",\"entryButtonSecondary\":\"hub__entry-button-secondary__2ui-g\",\"entry-panel\":\"hub__entry-panel__cCmIv\",\"entryPanel\":\"hub__entry-panel__cCmIv\",\"button-container\":\"hub__button-container__38FOc\",\"buttonContainer\":\"hub__button-container__38FOc\",\"secondary-action-button\":\"hub__secondary-action-button__2KoCD\",\"secondaryActionButton\":\"hub__secondary-action-button__2KoCD\",\"leave-button\":\"hub__leave-button__1YK4o\",\"leaveButton\":\"hub__leave-button__1YK4o\",\"interstitial\":\"hub__interstitial__3WXbJ\",\"entry-button\":\"hub__entry-button__1e9jM\",\"entryButton\":\"hub__entry-button__1e9jM\",\"action-button\":\"hub__action-button__3zqlu\",\"actionButton\":\"hub__action-button__3zqlu\",\"collapse-button\":\"hub__collapse-button__3N-6b\",\"collapseButton\":\"hub__collapse-button__3N-6b\",\"favorite-button\":\"hub__favorite-button__1Qgbp\",\"favoriteButton\":\"hub__favorite-button__1Qgbp\",\"back\":\"hub__back__3AZh2\",\"form-field-text\":\"hub__form-field-text__tR1Lt\",\"formFieldText\":\"hub__form-field-text__tR1Lt\",\"lobby-label\":\"hub__lobby-label__2ktmo\",\"lobbyLabel\":\"hub__lobby-label__2ktmo\",\"label\":\"hub__label__1kjp1\",\"title\":\"hub__title__ezGEu\",\"name\":\"hub__name__2umw1\",\"rename-button\":\"hub__rename-button__h-4K7\",\"renameButton\":\"hub__rename-button__h-4K7\",\"center\":\"hub__center__1Mvfu\",\"wide-button\":\"hub__wide-button__1yqDc\",\"wideButton\":\"hub__wide-button__1yqDc\",\"screen-sharing\":\"hub__screen-sharing__2VF91\",\"screenSharing\":\"hub__screen-sharing__2VF91\",\"checkbox\":\"hub__checkbox__32dyv\",\"invite-tip\":\"hub__invite-tip__9enoe\",\"inviteTip\":\"hub__invite-tip__9enoe\",\"loading-text\":\"hub__loading-text__1WDud\",\"loadingText\":\"hub__loading-text__1WDud\",\"streaming-tip\":\"hub__streaming-tip__1LnId\",\"streamingTip\":\"hub__streaming-tip__1LnId\",\"streaming-tip-attach-point\":\"hub__streaming-tip-attach-point__1oCgh\",\"streamingTipAttachPoint\":\"hub__streaming-tip-attach-point__1oCgh\",\"streaming-tip-close\":\"hub__streaming-tip-close__E6fwS\",\"streamingTipClose\":\"hub__streaming-tip-close__E6fwS\",\"streaming-tip-message\":\"hub__streaming-tip-message__XcScW\",\"streamingTipMessage\":\"hub__streaming-tip-message__XcScW\",\"ui-dialog-box-contents\":\"hub__ui-dialog-box-contents__PZ5qP\",\"uiDialogBoxContents\":\"hub__ui-dialog-box-contents__PZ5qP\",\"backgrounded\":\"hub__backgrounded__30IfD\",\"in-room-favorite-button\":\"hub__in-room-favorite-button__2T-zs\",\"inRoomFavoriteButton\":\"hub__in-room-favorite-button__2T-zs\",\"occupant-count\":\"hub__occupant-count__3eAEj\",\"occupantCount\":\"hub__occupant-count__3eAEj\",\"presence-info-selected\":\"hub__presence-info-selected__FRBSA\",\"presenceInfoSelected\":\"hub__presence-info-selected__FRBSA\",\"camera-mode-exit-button\":\"hub__camera-mode-exit-button__BqKKt\",\"cameraModeExitButton\":\"hub__camera-mode-exit-button__BqKKt\",\"corner-button-selected\":\"hub__corner-button-selected__Cqa93\",\"cornerButtonSelected\":\"hub__corner-button-selected__Cqa93\",\"invite-tip-attach-point\":\"hub__invite-tip-attach-point__2y_bz\",\"inviteTipAttachPoint\":\"hub__invite-tip-attach-point__2y_bz\",\"avatar-editor\":\"hub__avatar-editor__2b8-H\",\"avatarEditor\":\"hub__avatar-editor__2b8-H\",\"logo\":\"hub__logo__3kJSj\",\"form\":\"hub__form__3kQXh\",\"box\":\"hub__box__2SMbn\",\"links\":\"hub__links__1C6Ce\",\"darkened\":\"hub__darkened__1gqMQ\",\"display-name\":\"hub__display-name__36hFZ\",\"displayName\":\"hub__display-name__36hFZ\",\"preview\":\"hub__preview__2UUoU\",\"edit-avatar\":\"hub__edit-avatar__22A53\",\"editAvatar\":\"hub__edit-avatar__22A53\",\"close\":\"hub__close__gWtCN\",\"entry-dialog\":\"hub__entry-dialog__2Ljux\",\"entryDialog\":\"hub__entry-dialog__2Ljux\",\"favorited\":\"hub__favorited__3c3lB\",\"icon\":\"hub__icon__1pzf7\",\"bolded\":\"hub__bolded__2MYLZ\",\"subtitle\":\"hub__subtitle__3kYcd\",\"room-subtitle\":\"hub__room-subtitle__GhUCG\",\"roomSubtitle\":\"hub__room-subtitle__GhUCG\",\"lobby\":\"hub__lobby__2VW6G\",\"profile-icon\":\"hub__profile-icon__fwSfD\",\"profileIcon\":\"hub__profile-icon__fwSfD\",\"button-subtitle\":\"hub__button-subtitle__3kkpo\",\"buttonSubtitle\":\"hub__button-subtitle__3kkpo\",\"audio-loader\":\"hub__audio-loader__F5ovU\",\"audioLoader\":\"hub__audio-loader__F5ovU\",\"webvr-link-container\":\"hub__webvr-link-container__1Vq5m\",\"webvrLinkContainer\":\"hub__webvr-link-container__1Vq5m\",\"webvr-link\":\"hub__webvr-link__xW04U\",\"webvrLink\":\"hub__webvr-link__xW04U\",\"secondary\":\"hub__secondary__22yt_\"};","export const waitForEvent = function(eventName, eventObj) {\n  return new Promise(resolve => {\n    eventObj.addEventListener(eventName, resolve, { once: true });\n  });\n};\n\nexport const waitForDOMContentLoaded = function() {\n  if (document.readyState === \"complete\" || document.readyState === \"loaded\" || document.readyState === \"interactive\") {\n    return Promise.resolve(null);\n  } else {\n    return waitForEvent(\"DOMContentLoaded\", window);\n  }\n};\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"email-field\":\"sign-in-dialog__email-field__g3xRW\",\"emailField\":\"sign-in-dialog__email-field__g3xRW\",\"next-button\":\"sign-in-dialog__next-button__2pGtq\",\"nextButton\":\"sign-in-dialog__next-button__2pGtq\",\"continue-button\":\"sign-in-dialog__continue-button__kFN6Z\",\"continueButton\":\"sign-in-dialog__continue-button__kFN6Z\",\"sign-in-form\":\"sign-in-dialog__sign-in-form__3Muog\",\"signInForm\":\"sign-in-dialog__sign-in-form__3Muog\",\"sign-in-complete\":\"sign-in-dialog__sign-in-complete__3JMkv\",\"signInComplete\":\"sign-in-dialog__sign-in-complete__3JMkv\",\"terms\":\"sign-in-dialog__terms__3TT6i\"};","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { pushHistoryState, replaceHistoryState } from \"../utils/history\";\n\nfunction isModifiedEvent(event) {\n  return !!(event.metaKey || event.altKey || event.ctrlKey || event.shiftKey);\n}\n\n/**\n * A history-aware link that pushes/replaces the state, but not the path, in the browser history.\n */\nclass StateLink extends React.Component {\n  static propTypes = {\n    history: PropTypes.object,\n    innerRef: PropTypes.object,\n    replace: PropTypes.bool,\n    stateKey: PropTypes.string,\n    stateValue: PropTypes.string,\n    stateDetail: PropTypes.object,\n    target: PropTypes.string,\n    onClick: PropTypes.func,\n    children: PropTypes.node,\n    className: PropTypes.string\n  };\n\n  async handleClick(event, history) {\n    if (this.props.onClick) this.props.onClick(event);\n\n    if (\n      !event.defaultPrevented && // onClick prevented default\n      event.button === 0 && // ignore everything but left clicks\n      (!this.props.target || this.props.target === \"_self\") && // let browser handle \"target=_blank\" etc.\n      !isModifiedEvent(event) // ignore clicks with modifier keys\n    ) {\n      event.preventDefault();\n      const method = this.props.replace ? replaceHistoryState : pushHistoryState;\n      method(history, this.props.stateKey, this.props.stateValue, this.props.stateDetail);\n    }\n  }\n\n  render() {\n    const { innerRef, target, className, children } = this.props;\n    return (\n      <a\n        target={target}\n        className={className}\n        onClick={event => this.handleClick(event, this.props.history)}\n        href=\"#\"\n        ref={innerRef}\n      >\n        {children}\n      </a>\n    );\n  }\n}\n\nexport default StateLink;\n","/**\n * Chrome and Safari will start Audio contexts in a \"suspended\" state.\n * A user interaction (touch/mouse event) is needed in order to resume the AudioContext.\n */\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  const ctx = THREE.AudioContext.getContext();\n\n  function resume() {\n    ctx.resume();\n\n    setTimeout(function() {\n      if (ctx.state === \"running\") {\n        document.body.removeEventListener(\"touchend\", resume, false);\n        document.body.removeEventListener(\"mouseup\", resume, false);\n      }\n    }, 0);\n  }\n\n  document.body.addEventListener(\"touchend\", resume, false);\n  document.body.addEventListener(\"mouseup\", resume, false);\n});\n","// Monkeypatch to address performance issue with updating panner nodes\n// TODO this needs to be merged into 3.js\n\nTHREE.PositionalAudio.prototype.updateMatrixWorld = (function() {\n  const position = new THREE.Vector3();\n  const quaternion = new THREE.Quaternion();\n\n  const scale = new THREE.Vector3();\n  const orientation = new THREE.Vector3();\n\n  return function updateMatrixWorld(force) {\n    THREE.Object3D.prototype.updateMatrixWorld.call(this, force);\n\n    let setInitial = false;\n\n    if (!this._lastPosition) {\n      setInitial = true;\n      this._lastPosition = new THREE.Vector3();\n      this._lastOrientation = new THREE.Vector3();\n      this._lastListenerPosition = new THREE.Vector3();\n    }\n\n    const panner = this.panner;\n    const listener = panner.context.listener;\n    this.matrixWorld.decompose(position, quaternion, scale);\n    orientation.set(0, 0, 1).applyQuaternion(quaternion);\n\n    // Need to update the position on this node if either the listener moves or this node moves,\n    // because otherwise there are audio artifacts in Chrome.\n    if (\n      setInitial ||\n      Math.abs(position.x - this._lastPosition.x) > Number.EPSILON ||\n      Math.abs(position.y - this._lastPosition.y) > Number.EPSILON ||\n      Math.abs(position.z - this._lastPosition.z) > Number.EPSILON ||\n      Math.abs(orientation.x - this._lastOrientation.x) > Number.EPSILON ||\n      Math.abs(orientation.y - this._lastOrientation.y) > Number.EPSILON ||\n      Math.abs(orientation.z - this._lastOrientation.z) > Number.EPSILON ||\n      (listener.positionX && Math.abs(listener.positionX.value - this._lastListenerPosition.x) > Number.EPSILON) ||\n      (listener.positionY && Math.abs(listener.positionY.value - this._lastListenerPosition.y) > Number.EPSILON) ||\n      (listener.positionZ && Math.abs(listener.positionZ.value - this._lastListenerPosition.z) > Number.EPSILON)\n    ) {\n      panner.setPosition(position.x, position.y, position.z);\n      panner.setOrientation(orientation.x, orientation.y, orientation.z);\n\n      this._lastPosition.x = position.x;\n      this._lastPosition.y = position.y;\n      this._lastPosition.z = position.z;\n\n      this._lastOrientation.x = orientation.x;\n      this._lastOrientation.y = orientation.y;\n      this._lastOrientation.z = orientation.z;\n\n      if (listener.positionX && listener.positionY && listener.positionZ) {\n        this._lastListenerPosition.x = listener.positionX.value;\n        this._lastListenerPosition.y = listener.positionY.value;\n        this._lastListenerPosition.z = listener.positionZ.value;\n      }\n    }\n  };\n})();\n","/**\n * Toggles the position of 2 bones into \"on\" and \"off\" positions to indicate mute state.\n * @namespace avatar\n * @component bone-mute-state-indicator\n */\nAFRAME.registerComponent(\"bone-mute-state-indicator\", {\n  schema: {\n    unmutedBoneName: { default: \"Watch_Joint_MicON\" },\n    mutedBoneName: { default: \"Watch_Joint_Muted\" },\n    onPos: { default: 0.81 },\n    offPos: { default: 0.5 }\n  },\n\n  init() {\n    this.onStateToggled = this.onStateToggled.bind(this);\n    this.el.addEventListener(\"model-loaded\", () => {\n      this.unmutedBone = this.el.object3D.getObjectByName(this.data.unmutedBoneName);\n      this.mutedBone = this.el.object3D.getObjectByName(this.data.mutedBoneName);\n      this.modelLoaded = true;\n\n      this.updateMuteState();\n    });\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateToggled);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateToggled);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateToggled);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateToggled);\n  },\n\n  onStateToggled(e) {\n    if (!e.detail.state === \"muted\") return;\n    this.updateMuteState();\n  },\n\n  updateMuteState() {\n    if (!this.modelLoaded) return;\n    const muted = this.el.sceneEl.is(\"muted\");\n    this.mutedBone.position.y = muted ? this.data.onPos : this.data.offPos;\n    this.unmutedBone.position.y = !muted ? this.data.onPos : this.data.offPos;\n    this.mutedBone.matrixNeedsUpdate = true;\n    this.unmutedBone.matrixNeedsUpdate = true;\n  }\n});\n","/**\n * Scales an object to near-zero if the object is invisible. Useful for bones representing avatar body parts.\n * @namespace avatar\n * @component bone-visibility\n */\nAFRAME.registerComponent(\"bone-visibility\", {\n  tick() {\n    const { visible } = this.el.object3D;\n\n    if (this.lastVisible !== visible) {\n      if (visible) {\n        this.el.object3D.scale.set(1, 1, 1);\n      } else {\n        // Three.js doesn't like updating matrices with 0 scale, so we set it to a near zero number.\n        this.el.object3D.scale.set(0.00000001, 0.00000001, 0.00000001);\n      }\n\n      this.lastVisible = visible;\n      this.el.object3D.updateMatrices(true, true);\n      this.el.object3D.updateMatrixWorld(true, true);\n    }\n  }\n});\n","/**\n * Positions an entity relative to a given target when the given event is fired.\n * @component offset-relative-to\n */\nAFRAME.registerComponent(\"offset-relative-to\", {\n  schema: {\n    target: {\n      type: \"selector\"\n    },\n    offset: {\n      type: \"vec3\"\n    },\n    on: {\n      type: \"string\"\n    },\n    orientation: {\n      default: 1 // see doc/image_orientations.gif\n    },\n    selfDestruct: {\n      default: false\n    }\n  },\n  init() {\n    this.updateOffset = this.updateOffset.bind(this);\n    if (this.data.on) {\n      this.el.sceneEl.addEventListener(this.data.on, this.updateOffset);\n    } else {\n      this.updateOffset();\n    }\n  },\n\n  updateOffset: (function() {\n    const y = new THREE.Vector3(0, 1, 0);\n    const z = new THREE.Vector3(0, 0, -1);\n    const QUARTER_CIRCLE = Math.PI / 2;\n    const offsetVector = new THREE.Vector3();\n    return function() {\n      const obj = this.el.object3D;\n      const target = this.data.target.object3D;\n      offsetVector.copy(this.data.offset);\n      target.localToWorld(offsetVector);\n      if (obj.parent) {\n        obj.parent.worldToLocal(offsetVector);\n      }\n      obj.position.copy(offsetVector);\n      target.getWorldQuaternion(obj.quaternion);\n\n      // See doc/image_orientations.gif\n      switch (this.data.orientation) {\n        case 8:\n          obj.rotateOnAxis(z, 3 * QUARTER_CIRCLE);\n          break;\n        case 7:\n          obj.rotateOnAxis(z, 3 * QUARTER_CIRCLE);\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\n          break;\n        case 6:\n          obj.rotateOnAxis(z, QUARTER_CIRCLE);\n          break;\n        case 5:\n          obj.rotateOnAxis(z, QUARTER_CIRCLE);\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\n          break;\n        case 4:\n          obj.rotateOnAxis(z, 2 * QUARTER_CIRCLE);\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\n          break;\n        case 3:\n          obj.rotateOnAxis(z, 2 * QUARTER_CIRCLE);\n          break;\n        case 2:\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\n          break;\n        case 1:\n        default:\n          break;\n      }\n\n      obj.matrixNeedsUpdate = true;\n\n      if (this.data.selfDestruct) {\n        if (this.data.on) {\n          this.el.sceneEl.removeEventListener(this.data.on, this.updateOffset);\n        }\n        this.el.removeAttribute(\"offset-relative-to\");\n      }\n    };\n  })()\n});\n","const TWOPI = Math.PI * 2;\nfunction deltaAngle(a, b) {\n  const p = Math.abs(b - a) % TWOPI;\n  return p > Math.PI ? TWOPI - p : p;\n}\n\n/**\n * Positions the HUD and toggles app mode based on where the user is looking\n * @namespace ui\n * @component hud-controller\n */\nAFRAME.registerComponent(\"hud-controller\", {\n  schema: {\n    head: { type: \"selector\" },\n    offset: { default: 0.7 }, // distance from hud above head,\n    lookCutoff: { default: 20 }, // angle at which the hud should be \"on\",\n    animRange: { default: 30 }, // degrees over which to animate the hud into view\n    yawCutoff: { default: 50 } // yaw degrees at wich the hud should reoirent even if the user is looking up\n  },\n  init() {\n    this.onChildHovered = this.onChildHovered.bind(this);\n    this.removeHoverEvents = this.removeHoverEvents.bind(this);\n    this.isYLocked = false;\n    this.lockedHeadPositionY = 0;\n    this.lookDir = new THREE.Vector3();\n    this.lookEuler = new THREE.Euler();\n    this.store = window.APP.store;\n    this.hoverableChildren = this.el.querySelectorAll(\"[is-remote-hover-target]\");\n  },\n\n  tick() {\n    const hud = this.el.object3D;\n    const head = this.data.head.object3D;\n\n    const { offset, lookCutoff, animRange, yawCutoff } = this.data;\n\n    const pitch = head.rotation.x * THREE.Math.RAD2DEG;\n    const yawDif = deltaAngle(head.rotation.y, hud.rotation.y) * THREE.Math.RAD2DEG;\n\n    // HUD is always visible until first hover, to increase discoverability.\n    const forceHudVisible = !this.store.state.activity.hasHoveredInWorldHud;\n\n    // animate the hud into place over animRange degrees as the user aproaches the lookCutoff angle\n    let t = 1 - THREE.Math.clamp(lookCutoff - pitch, 0, animRange) / animRange;\n\n    // HUD is locked down while showing tooltip or if forced.\n    if (forceHudVisible) {\n      t = 1;\n    }\n\n    // Once the HUD is in place it should stay in place until you look sufficiently far down\n    if (t === 1) {\n      this.lockedHeadPositionY = head.position.y;\n      this.hudLocked = true;\n    } else if (this.hudLocked && pitch < lookCutoff - animRange / 2) {\n      this.hudLocked = false;\n    }\n\n    if (this.hudLocked) {\n      t = 1;\n    }\n\n    // Reorient the hud only if the user is looking away from the hud, for right now this arbitrarily means the hud is 1/2 way animated away\n    // TODO: come up with better huristics for this that maybe account for the user turning away from the hud \"too far\", also animate the position so that it doesnt just snap.\n    const hudOutOfView = yawDif >= yawCutoff || pitch < lookCutoff - animRange / 2;\n\n    if (hudOutOfView) {\n      this.lookDir.set(0, 0, -1);\n      this.lookDir.applyQuaternion(head.quaternion);\n      this.lookDir.add(head.position);\n      hud.position.x = this.lookDir.x;\n      hud.position.z = this.lookDir.z;\n      hud.rotation.copy(head.rotation);\n      hud.rotation.x = 0;\n      hud.rotation.z = 0;\n    }\n\n    hud.visible = !hudOutOfView || forceHudVisible;\n    hud.position.y = (this.isYLocked ? this.lockedHeadPositionY : head.position.y) + offset + (1 - t) * offset;\n    hud.rotation.x = (1 - t) * THREE.Math.DEG2RAD * 90;\n    hud.matrixNeedsUpdate = true;\n  },\n\n  play() {\n    for (let i = 0; i < this.hoverableChildren.length; i++) {\n      this.hoverableChildren[i].object3D.addEventListener(\"hovered\", this.onChildHovered);\n    }\n  },\n\n  pause() {\n    this.removeHoverEvents();\n  },\n\n  removeHoverEvents() {\n    for (let i = 0; i < this.hoverableChildren.length; i++) {\n      this.hoverableChildren[i].object3D.removeEventListener(\"hovered\", this.onChildHovered);\n    }\n  },\n\n  onChildHovered() {\n    if (!this.store.state.activity.hasHoveredInWorldHud) {\n      this.store.update({ activity: { hasHoveredInWorldHud: true } });\n      this.removeHoverEvents();\n    }\n  }\n});\n","/**\n * A button with an image, tooltip, hover states.\n * @namespace ui\n * @component icon-button\n */\nAFRAME.registerComponent(\"icon-button\", {\n  schema: {\n    image: { type: \"string\" },\n    hoverImage: { type: \"string\" },\n    activeImage: { type: \"string\" },\n    activeHoverImage: { type: \"string\" },\n    disabledImage: { type: \"string\" },\n    active: { type: \"boolean\" },\n    disabled: { type: \"boolean\" },\n    tooltip: { type: \"selector\" },\n    tooltipText: { type: \"string\" },\n    activeTooltipText: { type: \"string\" }\n  },\n\n  init() {\n    this.el.object3D.matrixNeedsUpdate = true;\n    this.onHover = () => {\n      this.hovering = true;\n      if (this.data.tooltip) {\n        this.data.tooltip.object3D.visible = true;\n      }\n      this.updateButtonState();\n    };\n    this.onHoverOut = () => {\n      this.hovering = false;\n      if (this.data.tooltip) {\n        this.data.tooltip.object3D.visible = false;\n      }\n      this.updateButtonState();\n    };\n  },\n\n  play() {\n    this.updateButtonState();\n    this.el.object3D.addEventListener(\"hovered\", this.onHover);\n    this.el.object3D.addEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"hovered\", this.onHover);\n    this.el.object3D.removeEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  update() {\n    this.updateButtonState();\n  },\n\n  updateButtonState() {\n    const hovering = this.hovering;\n    const active = this.data.active;\n    const disabled = this.data.disabled;\n\n    let image;\n    if (disabled) {\n      image = \"disabledImage\";\n    } else if (active) {\n      image = hovering ? \"activeHoverImage\" : \"activeImage\";\n    } else {\n      image = hovering ? \"hoverImage\" : \"image\";\n    }\n\n    if (this.el.components.sprite) {\n      if (this.data[image]) {\n        this.el.setAttribute(\"sprite\", \"name\", this.data[image]);\n      } else {\n        console.warn(`No ${image} image on me.`, this);\n      }\n    } else {\n      console.error(\"No sprite.\");\n    }\n\n    if (this.data.tooltip && hovering) {\n      const tooltipText =\n        (this.data.active ? this.data.activeTooltipText : this.data.tooltipText) + (disabled ? \" Disabled\" : \"\");\n      this.data.tooltip.querySelector(\"[text]\").setAttribute(\"text\", \"value\", tooltipText);\n    }\n  }\n});\n","/**\n * A button with text\n * @namespace ui\n * @component text-button\n */\nAFRAME.registerComponent(\"text-button\", {\n  schema: {\n    textHoverColor: { type: \"string\" },\n    textColor: { type: \"string\" },\n    backgroundHoverColor: { type: \"string\" },\n    backgroundColor: { type: \"string\" }\n  },\n\n  init() {\n    // TODO: This is a bit of a hack to deal with position \"component\" not setting matrixNeedsUpdate. Come up with a better solution.\n    this.el.object3D.matrixNeedsUpdate = true;\n    this.onHover = () => {\n      this.hovering = true;\n      this.updateButtonState();\n    };\n    this.onHoverOut = () => {\n      this.hovering = false;\n      this.updateButtonState();\n    };\n    this.textEl = this.el.querySelector(\"[text]\");\n  },\n\n  play() {\n    this.updateButtonState();\n    this.el.object3D.addEventListener(\"hovered\", this.onHover);\n    this.el.object3D.addEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"hovered\", this.onHover);\n    this.el.object3D.removeEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  update() {\n    this.updateButtonState();\n  },\n\n  updateButtonState() {\n    const hovering = this.hovering;\n    this.el.setAttribute(\"slice9\", \"color\", hovering ? this.data.backgroundHoverColor : this.data.backgroundColor);\n\n    if (this.textEl) {\n      this.textEl.setAttribute(\"text\", \"color\", hovering ? this.data.textHoverColor : this.data.textColor);\n    }\n  }\n});\n\nconst noop = function() {};\n// TODO: this should ideally be fixed upstream somehow but its pretty tricky since text is just a geometry not a different type of Object3D, and Object3D is what handles raycast checks.\nAFRAME.registerComponent(\"text-raycast-hack\", {\n  dependencies: [\"text\"],\n  init() {\n    this.el.getObject3D(\"text\").raycast = noop;\n  }\n});\n","/**\n * Registers a click handler and invokes the block method on the NAF adapter for the owner associated with its entity.\n * @namespace network\n * @component block-button\n */\nAFRAME.registerComponent(\"block-button\", {\n  init() {\n    this.onClick = () => {\n      this.block(this.owner);\n    };\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.owner = networkedEl.components.networked.data.owner;\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  },\n\n  block(clientId) {\n    window.APP.hubChannel.hide(clientId);\n  }\n});\n","AFRAME.registerComponent(\"mute-button\", {\n  init() {\n    this.onClick = () => {\n      this.mute(this.owner);\n    };\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.owner = networkedEl.components.networked.data.owner;\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  },\n\n  async mute(clientId) {\n    this.el.sceneEl.emit(\"action_mute_client\", { clientId });\n  }\n});\n","AFRAME.registerComponent(\"kick-button\", {\n  init() {\n    this.onClick = () => {\n      this.kick(this.owner);\n    };\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.owner = networkedEl.components.networked.data.owner;\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  },\n\n  async kick(clientId) {\n    this.el.sceneEl.emit(\"action_kick_client\", { clientId });\n  }\n});\n","AFRAME.registerComponent(\"close-vr-notice-button\", {\n  init() {\n    this.onClick = () => {\n      this.el.sceneEl.emit(\"action_vr_notice_closed\");\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","AFRAME.registerComponent(\"leave-room-button\", {\n  init() {\n    this.onClick = () => {\n      this.el.sceneEl.emit(\"leave_room_requested\");\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","AFRAME.registerComponent(\"visible-if-permitted\", {\n  schema: {\n    type: \"string\"\n  },\n  init() {\n    this.updateVisibility = this.updateVisibility.bind(this);\n    this.updateVisibility();\n    window.APP.hubChannel.addEventListener(\"permissions_updated\", this.updateVisibility);\n  },\n  updateVisibility() {\n    this.el.object3D.visible = this.el.sceneEl.systems.permissions.canOrWillIfCreator(this.data);\n  },\n  remove() {\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.updateVisibility);\n  }\n});\n","AFRAME.registerComponent(\"visibility-on-content-type\", {\n  schema: {\n    contentType: { type: \"string\" },\n    contentSubtype: { type: \"string\" },\n    visible: { type: \"boolean\", default: true }\n  },\n\n  init() {\n    this.updateVisibility = this.updateVisibility.bind(this);\n\n    NAF.utils.getNetworkedEntity(this.el).then(el => {\n      this.networkedEl = el;\n      el.addEventListener(\"media_resolved\", ({ detail: { contentType } }) => this.updateVisibility(contentType));\n      this.updateVisibility();\n    });\n  },\n\n  updateVisibility(contentType) {\n    const mediaLoader = this.networkedEl.components[\"media-loader\"];\n    const mediaImage = this.networkedEl.components[\"media-image\"];\n    const mediaVideo = this.networkedEl.components[\"media-video\"];\n    const mediaPdf = this.networkedEl.components[\"media-pdf\"];\n    const currentContentType =\n      contentType ||\n      (mediaVideo && mediaVideo.data.contentType) ||\n      (mediaImage && mediaImage.data.contentType) ||\n      (mediaPdf && mediaPdf.data.contentType);\n    const matchesType =\n      !this.data.contentType ||\n      (currentContentType && currentContentType.toLowerCase().split(\";\")[0] === this.data.contentType);\n    const matchesSubtype =\n      !this.data.contentSubtype ||\n      (mediaLoader.data.contentSubtype && mediaLoader.data.contentSubtype === this.data.contentSubtype);\n    const matches = !!(matchesType && matchesSubtype);\n    this.el.object3D.visible = this.data.visible ? matches : !matches;\n  }\n});\n","AFRAME.registerComponent(\"hide-when-pinned-and-forbidden\", {\n  schema: {\n    // Hide regardless of being forbidden.\n    whenPinned: { type: \"boolean\" }\n  },\n  init() {\n    this._updateUI = this._updateUI.bind(this);\n    this._updateUIOnStateChange = this._updateUIOnStateChange.bind(this);\n    this.el.sceneEl.addEventListener(\"stateadded\", this._updateUIOnStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this._updateUIOnStateChange);\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n\n      this._updateUI();\n      this.targetEl.addEventListener(\"pinned\", this._updateUI);\n      this.targetEl.addEventListener(\"unpinned\", this._updateUI);\n    });\n  },\n\n  remove() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this._updateUIOnStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this._updateUIOnStateChange);\n\n    if (this.targetEl) {\n      this.targetEl.removeEventListener(\"pinned\", this._updateUI);\n      this.targetEl.removeEventListener(\"unpinned\", this._updateUI);\n    }\n  },\n\n  _updateUIOnStateChange(e) {\n    if (e.detail !== \"frozen\") return;\n    this._updateUI();\n  },\n\n  _updateUI() {\n    if (!this.targetEl) return;\n    const isPinned = this.targetEl.components.pinnable && this.targetEl.components.pinnable.data.pinned;\n\n    if (this.data.whenPinned) {\n      this.el.object3D.visible = !isPinned;\n    } else {\n      const pinnedAndForbidden = isPinned && !window.APP.hubChannel.canOrWillIfCreator(\"pin_objects\");\n      this.el.object3D.visible = !pinnedAndForbidden;\n    }\n  }\n});\n","/**\n * Stores networked avatar state.\n * @namespace avatar\n * @component networked-avatar\n */\nAFRAME.registerComponent(\"networked-avatar\", {\n  schema: {\n    left_hand_pose: { default: 0 },\n    right_hand_pose: { default: 0 }\n  }\n});\n","AFRAME.registerComponent(\"pinnable\", {\n  schema: {\n    pinned: { default: false }\n  },\n\n  init() {\n    this._fireEventsAndAnimate = this._fireEventsAndAnimate.bind(this);\n\n    // Fire pinned events when page changes so we can persist the page.\n    this.el.addEventListener(\"pager-page-changed\", this._fireEventsAndAnimate);\n\n    // Fire pinned events when video state changes so we can persist the page.\n    this.el.addEventListener(\"owned-video-state-changed\", this._fireEventsAndAnimate);\n  },\n\n  update(oldData) {\n    this._fireEventsAndAnimate(oldData);\n  },\n\n  _fireEventsAndAnimate(oldData, force) {\n    // We need to guard against _fireEventsAndAnimate being called during entity initialization,\n    // when the networked component isn't initialized yet.\n    if (this.el.components.networked && this.el.components.networked.data && !NAF.utils.isMine(this.el)) return;\n\n    // Avoid firing events during initialization by checking if the pin state has changed before doing so.\n    const pinStateChanged = !!oldData.pinned !== this.data.pinned;\n\n    if (this.data.pinned) {\n      if (pinStateChanged || force) {\n        this.el.emit(\"pinned\", { el: this.el });\n      }\n\n      this.el.removeAttribute(\"animation__pin-start\");\n      this.el.removeAttribute(\"animation__pin-end\");\n      const currentScale = this.el.object3D.scale;\n\n      this.el.setAttribute(\"animation__pin-start\", {\n        property: \"scale\",\n        dur: 200,\n        from: { x: currentScale.x, y: currentScale.y, z: currentScale.z },\n        to: { x: currentScale.x * 1.1, y: currentScale.y * 1.1, z: currentScale.z * 1.1 },\n        easing: \"easeOutElastic\"\n      });\n\n      this.el.setAttribute(\"animation__pin-end\", {\n        property: \"scale\",\n        delay: 200,\n        dur: 200,\n        from: { x: currentScale.x * 1.1, y: currentScale.y * 1.1, z: currentScale.z * 1.1 },\n        to: { x: currentScale.x, y: currentScale.y, z: currentScale.z },\n        easing: \"easeOutElastic\"\n      });\n\n      if (this.el.components[\"ammo-body\"]) {\n        this.el.setAttribute(\"ammo-body\", { type: \"static\" });\n      }\n    } else {\n      if (pinStateChanged || force) {\n        this.el.emit(\"unpinned\", { el: this.el });\n      }\n    }\n  },\n\n  isHeld(el) {\n    const { leftHand, rightHand, rightRemote } = el.sceneEl.systems.interaction.state;\n    return leftHand.held === el || rightHand.held === el || rightRemote.held === el;\n  },\n\n  tick() {\n    const held = this.isHeld(this.el);\n\n    if (!held && this.wasHeld) {\n      this._fireEventsAndAnimate(this.data, true);\n    }\n\n    this.wasHeld = held;\n  }\n});\n","const COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\n\nAFRAME.registerComponent(\"drop-object-button\", {\n  init() {\n    this.onClick = () => {\n      if (!NAF.utils.isMine(this.targetEl) && !NAF.utils.takeOwnership(this.targetEl)) return;\n\n      this.targetEl.setAttribute(\"floaty-object\", { modifyGravityOnRelease: false });\n      this.targetEl.setAttribute(\"ammo-body\", {\n        type: \"dynamic\",\n        gravity: { x: 0, y: -9.8, z: 0 },\n        angularDamping: 0.01,\n        linearDamping: 0.01,\n        linearSleepingThreshold: 1.6,\n        angularSleepingThreshold: 2.5,\n        collisionFilterMask: COLLISION_LAYERS.DEFAULT_INTERACTABLE\n      });\n      this.targetEl.components[\"ammo-body\"].body.activate();\n\n      // Remove drop button after using it\n      this.el.parentNode.removeChild(this.el);\n    };\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","AFRAME.registerComponent(\"remove-networked-object-button\", {\n  init() {\n    this.onClick = () => {\n      if (!NAF.utils.isMine(this.targetEl) && !NAF.utils.takeOwnership(this.targetEl)) return;\n\n      this.targetEl.setAttribute(\"animation__remove\", {\n        property: \"scale\",\n        dur: 200,\n        to: { x: 0.01, y: 0.01, z: 0.01 },\n        easing: \"easeInQuad\"\n      });\n\n      this.el.parentNode.removeAttribute(\"visibility-while-frozen\");\n      this.el.parentNode.setAttribute(\"visible\", false);\n\n      this.targetEl.addEventListener(\"animationcomplete\", () => {\n        NAF.utils.takeOwnership(this.targetEl);\n        this.targetEl.parentNode.removeChild(this.targetEl);\n      });\n    };\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","AFRAME.registerComponent(\"camera-focus-button\", {\n  schema: {\n    track: { default: false },\n    selector: { default: null }\n  },\n\n  init() {\n    this.cameraSystem = this.el.sceneEl.systems[\"camera-tools\"];\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      if (this.data.selector) {\n        this.targetEl = networkedEl.querySelector(this.data.selector);\n      } else {\n        this.targetEl = networkedEl;\n      }\n    });\n\n    this.onClick = () => {\n      const myCamera = this.cameraSystem.getMyCamera();\n      if (!myCamera) return;\n\n      myCamera.components[\"camera-tool\"].focus(this.targetEl, this.data.track);\n    };\n  },\n\n  tick() {\n    const isVisible = this.el.object3D.visible;\n    const shouldBeVisible = !!(this.cameraSystem && this.cameraSystem.getMyCamera());\n\n    if (isVisible !== shouldBeVisible) {\n      this.el.setAttribute(\"visible\", shouldBeVisible);\n    }\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","/**\n * Toggles the visibility of this entity based on networked ownership\n * @namespace ui\n * @component visible-to-owner\n */\nAFRAME.registerComponent(\"visible-to-owner\", {\n  init() {\n    this.onStateChange = e => {\n      this.el.setAttribute(\"visible\", e.detail.newOwner === NAF.clientId);\n    };\n    NAF.utils.getNetworkedEntity(this.el).then(el => {\n      el.addEventListener(\"ownership-changed\", this.onStateChange);\n      this.el.setAttribute(\"visible\", NAF.utils.isMine(el));\n    });\n  }\n});\n","AFRAME.registerComponent(\"emit-state-change\", {\n  multiple: true,\n  schema: {\n    state: { type: \"string\" },\n    transform: { type: \"string\", oneof: [\"rising\", \"falling\"] },\n    event: { type: \"string\" }\n  },\n\n  init() {\n    this.stateadded = this.stateadded.bind(this);\n    this.stateremoved = this.stateremoved.bind(this);\n  },\n\n  stateadded(e) {\n    if (e.detail === this.data.state) {\n      this.el.emit(this.data.event);\n    }\n  },\n  stateremoved(e) {\n    if (e.detail === this.data.state) {\n      this.el.emit(this.data.event);\n    }\n  },\n\n  update() {\n    this.el.removeEventListener(\"stateadded\", this.stateadded);\n    this.el.removeEventListener(\"stateremoved\", this.stateremoved);\n\n    if (this.data.transform === \"rising\") {\n      this.el.addEventListener(\"stateadded\", this.stateadded);\n    }\n    if (this.data.transform === \"falling\") {\n      this.el.addEventListener(\"stateremoved\", this.stateremoved);\n    }\n  }\n});\n","AFRAME.registerComponent(\"action-to-event\", {\n  multiple: true,\n\n  schema: {\n    path: { type: \"string\" },\n    event: { type: \"string\" },\n    withPermission: { type: \"string\" }\n  },\n\n  init() {\n    this.needsPermission = !!this.data.withPermission;\n    this.updatePermissions = () => {\n      if (!this.needsPermission) return;\n      this.hasPermission = window.APP.hubChannel.canOrWillIfCreator(this.data.withPermission);\n    };\n  },\n\n  play() {\n    this.el.sceneEl.systems.permissions.onPermissionsUpdated(this.updatePermissions);\n  },\n\n  pause() {\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.updatePermissions);\n  },\n\n  tick() {\n    if (this.needsPermission && !this.hasPermission) return;\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    if (userinput.get(this.data.path)) {\n      this.el.emit(this.data.event);\n    }\n  }\n});\n","AFRAME.registerComponent(\"action-to-remove\", {\n  multiple: true,\n\n  schema: {\n    path: { type: \"string\" },\n    requireOwnership: { type: \"boolean\", default: true }\n  },\n\n  init() {\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.networkedEl = networkedEl;\n    });\n  },\n\n  tick() {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    if (!userinput.get(this.data.path)) return;\n    if (this.data.requireOwnership && this.networkedEl && !NAF.utils.isMine(this.networkedEl)) return;\n\n    this.el.parentNode.removeChild(this.el);\n  }\n});\n","AFRAME.registerComponent(\"emit-scene-event-on-remove\", {\n  schema: {\n    event: { default: null }\n  },\n\n  remove() {\n    if (this.data.event) {\n      this.el.sceneEl.emit(this.data.event, { el: this.el });\n    }\n  }\n});\n","AFRAME.registerComponent(\"follow-in-fov\", {\n  schema: {\n    target: { type: \"selector\" },\n    offset: { type: \"vec3\" },\n    speed: { type: \"number\", default: 0.003 },\n    angle: { type: \"number\", default: 45 }\n  },\n\n  init() {\n    this.targetPos = new THREE.Vector3();\n    this.offset = new THREE.Vector3();\n    this.offset.copy(this.data.offset);\n\n    this.snappedRot = new THREE.Euler();\n    this.snappedQ = new THREE.Quaternion();\n    this.snappedXForm = new THREE.Matrix4();\n    this.snappedXFormWorld = new THREE.Matrix4();\n    this.tempVector = new THREE.Vector3();\n  },\n\n  tick(t, dt) {\n    if (!this.el.object3D.visible) return;\n\n    const obj = this.el.object3D;\n    const target = this.data.target.object3D;\n\n    // Compute position + rotation by projecting offset along a downward ray in target space,\n    // and mask out Z rotation.\n    this._applyMaskedTargetRotation(\n      -this.data.angle * THREE.Math.DEG2RAD,\n      target.rotation.y,\n      0,\n      this.snappedXFormWorld\n    );\n\n    this.targetPos.copy(this.offset);\n    this.targetPos.applyMatrix4(this.snappedXFormWorld);\n\n    if (obj.parent) {\n      obj.parent.worldToLocal(this.targetPos);\n    }\n\n    if (!this.started) {\n      obj.position.copy(this.targetPos);\n      this.started = true;\n    } else {\n      const t = this.data.speed * dt;\n\n      obj.position.set(\n        obj.position.x + (this.targetPos.x - obj.position.x) * t,\n        obj.position.y + (this.targetPos.y - obj.position.y) * t,\n        obj.position.z + (this.targetPos.z - obj.position.z) * t\n      );\n    }\n\n    this.snappedXFormWorld.decompose(this.tempVector, obj.quaternion, this.tempVector);\n    obj.matrixNeedsUpdate = true;\n  },\n\n  _applyMaskedTargetRotation(x, y, z, to) {\n    const target = this.data.target.object3D;\n    this.snappedRot.set(x, y, z, target.rotation.order);\n    this.snappedQ.setFromEuler(this.snappedRot);\n\n    this.snappedXForm.compose(\n      target.position,\n      this.snappedQ,\n      target.scale\n    );\n\n    to.multiplyMatrices(target.parent.matrixWorld, this.snappedXForm);\n  }\n});\n","AFRAME.registerComponent(\"matrix-auto-update\", {\n  schema: {\n    target: { type: \"string\" }\n  },\n\n  init: function() {\n    this._updateMatrixAutoUpdate = this._updateMatrixAutoUpdate.bind(this);\n    this._updateMatrixAutoUpdate();\n  },\n\n  play: function() {\n    this.el.sceneEl.addEventListener(\"object3dset\", this._updateMatrixAutoUpdate);\n  },\n\n  pause: function() {\n    this.el.sceneEl.removeEventListener(\"object3dset\", this._updateMatrixAutoUpdate);\n  },\n\n  _updateMatrixAutoUpdate: function() {\n    if (this.data.target) {\n      this.el.getObject3D(this.data.target).matrixAutoUpdate = true;\n    } else {\n      this.el.object3D.matrixAutoUpdate = true;\n    }\n  }\n});\n","AFRAME.registerComponent(\"tweet-media-button\", {\n  init() {\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n    });\n\n    this.onClick = () => {\n      const hasDiscordBridges = window.APP.hubChannel && window.APP.hubChannel.discordBridges().length > 0;\n\n      const text = !hasDiscordBridges\n        ? `Taken in hubs.mozilla.com - join me now at hub.link/${window.APP.hubChannel.hubId}! `\n        : `Taken in hubs.mozilla.com `;\n\n      const { src, contentSubtype } = this.targetEl.components[\"media-loader\"].data;\n      this.el.sceneEl.emit(\"action_media_tweet\", { url: src, contentSubtype, text, el: this.targetEl });\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","AFRAME.registerComponent(\"hover-menu\", {\n  multiple: true,\n  schema: {\n    template: { type: \"selector\" },\n    dirs: { type: \"array\" },\n    dim: { default: true },\n    withPermission: { type: \"string\" }\n  },\n\n  async init() {\n    this.onFrozenStateChange = this.onFrozenStateChange.bind(this);\n    this.hovering = false;\n    await this.getHoverMenu();\n    this.applyHoverState();\n  },\n\n  getHoverMenu() {\n    if (this.menuPromise) return this.menuPromise;\n    return (this.menuPromise = new Promise(resolve => {\n      const menu = this.el.appendChild(document.importNode(this.data.template.content, true).children[0]);\n      // we have to wait a tick for the attach callbacks to get fired for the elements in a template\n      setTimeout(() => {\n        this.menu = menu;\n        this.el.setAttribute(\"position-at-box-shape-border\", {\n          target: \".hover-container\",\n          dirs: this.data.dirs,\n          animate: false,\n          scale: false\n        });\n        resolve(this.menu);\n      });\n    }));\n  },\n\n  onFrozenStateChange(e) {\n    if (!e.detail === \"frozen\") return;\n    this.applyHoverState();\n  },\n\n  applyHoverState() {\n    if (!this.menu) return;\n    const allowed = !this.data.withPermission || window.APP.hubChannel.canOrWillIfCreator(this.data.withPermission);\n    this.menu.object3D.visible = allowed && !this.el.sceneEl.is(\"frozen\") && this.hovering;\n    if (this.data.dim && this.el.object3DMap.mesh && this.el.object3DMap.mesh.material) {\n      this.el.object3DMap.mesh.material.color.setScalar(this.menu.object3D.visible ? 0.5 : 1);\n    }\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onFrozenStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onFrozenStateChange);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onFrozenStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onFrozenStateChange);\n  }\n});\n","AFRAME.registerComponent(\"disable-frustum-culling\", {\n  init() {\n    this.el.object3D.traverse(o => (o.frustumCulled = false));\n  }\n});\n","AFRAME.registerComponent(\"set-active-camera\", {\n  init() {\n    // This is a hack needed to set the active camera because sometimes A-Frame will create the default camera and set it to the active camera on startup because the query selector to find an existing camera in the scene fails.\n\n    const cameraSystem = this.el.sceneEl.systems.camera;\n    const currentActiveCamera = cameraSystem.activeCameraEl;\n\n    if (currentActiveCamera !== this.el) {\n      cameraSystem.setActiveCamera(this.el);\n\n      // Also A-Frame fails to delete the default camera :P\n      currentActiveCamera.parentNode.removeChild(currentActiveCamera);\n\n      // Look controls leaves behind this CSS class.\n      this.el.sceneEl.canvas.classList.remove(\"a-grab-cursor\");\n    }\n  }\n});\n","AFRAME.registerComponent(\"track-pose\", {\n  schema: {\n    path: { type: \"string\" }\n  },\n\n  tick() {\n    const matrix = AFRAME.scenes[0].systems.userinput.get(this.data.path);\n    if (matrix) {\n      const o = this.el.object3D;\n      o.matrix.copy(matrix);\n      o.matrix.decompose(o.position, o.quaternion, o.scale);\n      o.matrixIsModified = true;\n    }\n  }\n});\n","AFRAME.registerComponent(\"replay\", {\n  init: function() {\n    this.playhead = 0;\n    this.poseIndex = 0;\n  },\n\n  tick: function(t, dt) {\n    let overflow = false;\n    while (!overflow && this.playhead >= this.poses[this.poseIndex].timestamp) {\n      this.el.setAttribute(\"position\", this.poses[this.poseIndex].position);\n      this.el.setAttribute(\"rotation\", this.poses[this.poseIndex].rotation);\n      this.el.object3D.matrixNeedsUpdate = true;\n      this.poseIndex += 1;\n      overflow = this.poseIndex === this.poses.length;\n    }\n\n    this.playhead += dt;\n\n    if (overflow) {\n      this.playhead = 0;\n      this.poseIndex = 0;\n    }\n  }\n});\n","AFRAME.registerComponent(\"visibility-by-path\", {\n  schema: {\n    path: { type: \"string\" }\n  },\n  tick() {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const shouldBeVisible = !!userinput.get(this.data.path);\n    if (this.el.object3D.visible !== shouldBeVisible) {\n      this.el.setAttribute(\"visible\", shouldBeVisible);\n    }\n  }\n});\n","AFRAME.registerComponent(\"tags\", {\n  schema: {\n    isHandCollisionTarget: { default: false },\n    isHoldable: { default: false },\n    offersHandConstraint: { default: false },\n    offersRemoteConstraint: { default: false },\n    singleActionButton: { default: false },\n    holdableButton: { default: false },\n    isPen: { default: false },\n    isHoverMenuChild: { default: false }\n  },\n  update() {\n    if (this.didUpdateOnce) {\n      console.warn(\"Do not edit tags with .setAttribute\");\n    }\n    this.didUpdateOnce = true;\n  }\n});\n","const isMobileVR = AFRAME.utils.device.isMobileVR();\n\n// Billboard component that only updates visible objects and only those in the camera view on mobile VR.\nAFRAME.registerComponent(\"billboard\", {\n  init: function() {\n    this.target = new THREE.Vector3();\n    this._updateBillboard = this._updateBillboard.bind(this);\n    this._updateIsInView = this._updateIsInView.bind(this);\n\n    if (isMobileVR) {\n      this.el.sceneEl.systems[\"frame-scheduler\"].schedule(this._updateIsInView, \"billboards\");\n    }\n  },\n  remove() {\n    if (isMobileVR) {\n      this.el.sceneEl.systems[\"frame-scheduler\"].unschedule(this._updateIsInView, \"billboards\");\n    }\n  },\n\n  tick() {\n    if (this.isInView || !isMobileVR) {\n      this._updateBillboard();\n    }\n  },\n\n  _updateIsInView: (function() {\n    const frustum = new THREE.Frustum();\n    const frustumMatrix = new THREE.Matrix4();\n    const box = new THREE.Box3();\n    const boxTemp = new THREE.Box3();\n\n    const expandBox = o => {\n      if (o.geometry) {\n        o.updateMatrices();\n        o.geometry.computeBoundingBox();\n        boxTemp.copy(o.geometry.boundingBox).applyMatrix4(o.matrixWorld);\n        box.expandByPoint(boxTemp.min);\n        box.expandByPoint(boxTemp.max);\n      }\n    };\n\n    const isInViewOfCamera = (obj, screenCamera) => {\n      frustumMatrix.multiplyMatrices(screenCamera.projectionMatrix, screenCamera.matrixWorldInverse);\n      frustum.setFromMatrix(frustumMatrix);\n      box.makeEmpty();\n      obj.traverse(expandBox);\n\n      // NOTE: not using box.setFromObject here because text nodes do not have Z values in their geometry buffer,\n      // and that routine ultimately assumes they do.\n      return frustum.intersectsBox(box);\n    };\n\n    return function() {\n      if (!this.el.object3D.visible) {\n        this.isInView = false;\n        return;\n      }\n\n      if (!this.playerCamera) {\n        this.playerCamera = document.querySelector(\"#player-camera\").getObject3D(\"camera\");\n      }\n\n      if (!this.playerCamera) return;\n\n      this.isInView = isInViewOfCamera(this.el.object3D, this.playerCamera);\n    };\n  })(),\n\n  _updateBillboard: function() {\n    if (!this.el.object3D.visible) return;\n\n    const camera = this.el.sceneEl.camera;\n    const object3D = this.el.object3D;\n\n    if (camera) {\n      // Set the camera world position as the target.\n      this.target.setFromMatrixPosition(camera.matrixWorld);\n      object3D.lookAt(this.target);\n      object3D.matrixNeedsUpdate = true;\n    }\n  }\n});\n","const SYNC_DURATION_MS = 5000;\n\n// HACK this is a hacky component that is used to mitigate the situation where a first sync is missed on critical\n// networked elements. (At the time of this writing, specifically just the user's avatar.) The motivation\n// is that there have been a variety of issues resulting in missed avatar instantiation messages, and\n// this is meant to ensure we recover from those in the cases where they occur.\n//\n// This component, when added, will re-send a isFirstSync message for the networked object is it attached to\n// every SYNC_DURATION_MS milliseconds.\nAFRAME.registerComponent(\"periodic-full-syncs\", {\n  init() {\n    this.lastSync = 0;\n  },\n\n  tick() {\n    const now = performance.now();\n\n    if (now - this.lastSync >= SYNC_DURATION_MS && this.el.components && this.el.components.networked) {\n      this.lastSync = now;\n\n      // Sends an undirected first sync message.\n      this.el.components.networked.syncAll(null, true);\n    }\n  }\n});\n","import nextTick from \"../utils/next-tick\";\nimport { mapMaterials } from \"../utils/material-utils\";\nimport SketchfabZipWorker from \"../workers/sketchfab-zip.worker.js\";\nimport MobileStandardMaterial from \"../materials/MobileStandardMaterial\";\nimport { textureLoader } from \"../utils/media-utils\";\nimport { getCustomGLTFParserURLResolver } from \"../utils/media-url-utils\";\nimport { promisifyWorker } from \"../utils/promisify-worker.js\";\nimport { MeshBVH, acceleratedRaycast } from \"three-mesh-bvh\";\nimport { disposeNode } from \"../utils/three-utils\";\n\nTHREE.Mesh.prototype.raycast = acceleratedRaycast;\n\nclass GLTFCache {\n  cache = new Map();\n\n  set(src, gltf) {\n    this.cache.set(src, {\n      gltf,\n      count: 0\n    });\n    return this.retain(src);\n  }\n\n  has(src) {\n    return this.cache.has(src);\n  }\n\n  get(src) {\n    return this.cache.get(src);\n  }\n\n  retain(src) {\n    const cacheItem = this.cache.get(src);\n    cacheItem.count++;\n    return cacheItem;\n  }\n\n  release(src) {\n    const cacheItem = this.cache.get(src);\n\n    if (!cacheItem) {\n      console.error(`Releasing uncached gltf ${src}`);\n      return;\n    }\n\n    cacheItem.count--;\n    if (cacheItem.count <= 0) {\n      cacheItem.gltf.scene.traverse(disposeNode);\n      this.cache.delete(src);\n    }\n  }\n}\nconst gltfCache = new GLTFCache();\nconst inflightGltfs = new Map();\n\nconst extractZipFile = promisifyWorker(new SketchfabZipWorker());\n\nfunction defaultInflator(el, componentName, componentData) {\n  if (!AFRAME.components[componentName]) {\n    throw new Error(`Inflator failed. \"${componentName}\" component does not exist.`);\n  }\n  if (AFRAME.components[componentName].multiple && Array.isArray(componentData)) {\n    for (let i = 0; i < componentData.length; i++) {\n      el.setAttribute(componentName + \"__\" + i, componentData[i]);\n    }\n  } else {\n    el.setAttribute(componentName, componentData);\n  }\n}\n\nAFRAME.GLTFModelPlus = {\n  // eslint-disable-next-line no-unused-vars\n  components: {},\n  registerComponent(componentKey, componentName, inflator) {\n    inflator = inflator || defaultInflator;\n    AFRAME.GLTFModelPlus.components[componentKey] = { inflator, componentName };\n  }\n};\n\nfunction parallelTraverse(a, b, callback) {\n  callback(a, b);\n\n  for (let i = 0; i < a.children.length; i++) {\n    parallelTraverse(a.children[i], b.children[i], callback);\n  }\n}\n\nfunction generateMeshBVH(object3D) {\n  object3D.traverse(obj => {\n    // note that we might already have a bounds tree if this was a clone of an object with one\n    const hasBufferGeometry = obj.isMesh && obj.geometry.isBufferGeometry;\n    const hasBoundsTree = hasBufferGeometry && obj.geometry.boundsTree;\n    if (hasBufferGeometry && !hasBoundsTree && obj.geometry.attributes.position) {\n      const geo = obj.geometry;\n      const triCount = geo.index ? geo.index.count / 3 : geo.attributes.position.count / 3;\n      // only bother using memory and time making a BVH if there are a reasonable number of tris,\n      // and if there are too many it's too painful and large to tolerate doing it (at least until\n      // we put this in a web worker)\n      if (triCount > 1000 && triCount < 1000000) {\n        // note that bounds tree construction creates an index as a side effect if one doesn't already exist\n        geo.boundsTree = new MeshBVH(obj.geometry, { strategy: 0, maxDepth: 30 });\n      }\n    }\n  });\n}\n\n// Modified version of Don McCurdy's AnimationUtils.clone\n// https://github.com/mrdoob/three.js/pull/14494\nfunction cloneSkinnedMesh(source) {\n  const cloneLookup = new Map();\n\n  const clone = source.clone();\n\n  parallelTraverse(source, clone, function(sourceNode, clonedNode) {\n    cloneLookup.set(sourceNode, clonedNode);\n    if (sourceNode.isMesh && sourceNode.geometry.boundsTree) {\n      clonedNode.geometry.boundsTree = sourceNode.geometry.boundsTree;\n    }\n  });\n\n  source.traverse(function(sourceMesh) {\n    if (!sourceMesh.isSkinnedMesh) return;\n\n    const sourceBones = sourceMesh.skeleton.bones;\n    const clonedMesh = cloneLookup.get(sourceMesh);\n\n    clonedMesh.skeleton = sourceMesh.skeleton.clone();\n\n    clonedMesh.skeleton.bones = sourceBones.map(function(sourceBone) {\n      if (!cloneLookup.has(sourceBone)) {\n        throw new Error(\"Required bones are not descendants of the given object.\");\n      }\n\n      return cloneLookup.get(sourceBone);\n    });\n\n    clonedMesh.bind(clonedMesh.skeleton, sourceMesh.bindMatrix);\n  });\n\n  return clone;\n}\n\nfunction cloneGltf(gltf) {\n  return {\n    animations: gltf.animations,\n    scene: cloneSkinnedMesh(gltf.scene)\n  };\n}\n\nfunction getHubsComponents(node) {\n  const hubsComponents =\n    node.userData.gltfExtensions &&\n    (node.userData.gltfExtensions.MOZ_hubs_components || node.userData.gltfExtensions.HUBS_components);\n\n  // We can remove support for legacy components when our environment, avatar and interactable models are\n  // updated to match Spoke output.\n  const legacyComponents = node.userData.components;\n\n  return hubsComponents || legacyComponents;\n}\n\n/// Walks the tree of three.js objects starting at the given node, using the GLTF data\n/// and template data to construct A-Frame entities and components when necessary.\n/// (It's unnecessary to construct entities for subtrees that have no component data\n/// or templates associated with any of their nodes.)\n///\n/// Returns the A-Frame entity associated with the given node, if one was constructed.\nconst inflateEntities = function(indexToEntityMap, node, templates, isRoot, modelToWorldScale = 1) {\n  // TODO: Remove this once we update the legacy avatars to the new node names\n  if (node.name === \"Chest\") {\n    node.name = \"Spine\";\n  } else if (node.name === \"Root Scene\") {\n    node.name = \"AvatarRoot\";\n  } else if (node.name === \"Bot_Skinned\") {\n    node.name = \"AvatarMesh\";\n  }\n\n  // inflate subtrees first so that we can determine whether or not this node needs to be inflated\n  const childEntities = [];\n  const children = node.children.slice(0); // setObject3D mutates the node's parent, so we have to copy\n  for (const child of children) {\n    const el = inflateEntities(indexToEntityMap, child, templates);\n    if (el) {\n      childEntities.push(el);\n    }\n  }\n\n  const entityComponents = getHubsComponents(node);\n\n  const nodeHasBehavior = !!entityComponents || node.name in templates;\n  if (!nodeHasBehavior && !childEntities.length && !isRoot) {\n    return null; // we don't need an entity for this node\n  }\n\n  const el = document.createElement(\"a-entity\");\n  el.append.apply(el, childEntities);\n\n  // Remove invalid CSS class name characters.\n  const className = (node.name || node.uuid).replace(/[^\\w-]/g, \"\");\n  el.classList.add(className);\n\n  // AFRAME rotation component expects rotations in YXZ, convert it\n  if (node.rotation.order !== \"YXZ\") {\n    node.rotation.setFromQuaternion(node.quaternion, \"YXZ\");\n  }\n\n  // Copy over the object's transform to the THREE.Group and reset the actual transform of the Object3D\n  // all updates to the object should be done through the THREE.Group wrapper\n  el.object3D.position.copy(node.position);\n  el.object3D.rotation.copy(node.rotation);\n  el.object3D.scale.copy(node.scale).multiplyScalar(modelToWorldScale);\n  el.object3D.matrixNeedsUpdate = true;\n\n  node.matrixAutoUpdate = false;\n  node.matrix.identity();\n  node.matrix.decompose(node.position, node.rotation, node.scale);\n\n  el.setObject3D(node.type.toLowerCase(), node);\n  if (entityComponents && \"nav-mesh\" in entityComponents) {\n    el.setObject3D(\"mesh\", node);\n  }\n\n  // Set the name of the `THREE.Group` to match the name of the node,\n  // so that `THREE.PropertyBinding` will find (and later animate)\n  // the group. See `PropertyBinding.findNode`:\n  // https://github.com/mrdoob/three.js/blob/dev/src/animation/PropertyBinding.js#L211\n  el.object3D.name = node.name;\n  if (node.animations) {\n    // Pass animations up to the group object so that when we can pass the group as\n    // the optional root in `THREE.AnimationMixer.clipAction` and use the hierarchy\n    // preserved under the group (but not the node). Otherwise `clipArray` will be\n    // `null` in `THREE.AnimationClip.findByName`.\n    node.parent.animations = node.animations;\n  }\n\n  const gltfIndex = node.userData.gltfIndex;\n  if (gltfIndex !== undefined) {\n    indexToEntityMap[gltfIndex] = el;\n  }\n\n  return el;\n};\n\nfunction inflateComponents(inflatedEntity, indexToEntityMap) {\n  inflatedEntity.object3D.traverse(object3D => {\n    const entityComponents = getHubsComponents(object3D);\n    const el = object3D.el;\n\n    if (entityComponents && el) {\n      for (const prop in entityComponents) {\n        if (entityComponents.hasOwnProperty(prop) && AFRAME.GLTFModelPlus.components.hasOwnProperty(prop)) {\n          const { componentName, inflator } = AFRAME.GLTFModelPlus.components[prop];\n          inflator(el, componentName, entityComponents[prop], entityComponents, indexToEntityMap);\n        }\n      }\n    }\n  });\n}\n\nfunction attachTemplate(root, name, templateRoot) {\n  const targetEls = root.querySelectorAll(\".\" + name);\n  for (const el of targetEls) {\n    const root = templateRoot.cloneNode(true);\n    // Merge root element attributes with the target element\n    for (const { name, value } of root.attributes) {\n      el.setAttribute(name, value);\n    }\n\n    // Append all child elements\n    while (root.children.length > 0) {\n      el.appendChild(root.children[0]);\n    }\n  }\n}\n\nfunction runMigration(version, json) {\n  if (version < 2) {\n    //old heightfields will be on the same node as the nav-mesh, delete those\n    const oldHeightfieldNode = json.nodes.find(node => {\n      let components = null;\n      if (node.extensions && node.extensions.MOZ_hubs_components) {\n        components = node.extensions.MOZ_hubs_components;\n      } else if (node.extensions && node.extensions.HUBS_components) {\n        components = node.extensions.HUBS_components;\n      }\n      return components && components.heightfield && components[\"nav-mesh\"];\n    });\n    if (oldHeightfieldNode) {\n      if (oldHeightfieldNode.extensions.MOZ_hubs_components) {\n        delete oldHeightfieldNode.extensions.MOZ_hubs_components.heightfield;\n      } else if (oldHeightfieldNode.extensions.HUBS_components) {\n        delete oldHeightfieldNode.extensions.HUBS_components.heightfield;\n      }\n    }\n  }\n}\n\nexport async function loadGLTF(src, contentType, preferredTechnique, onProgress, jsonPreprocessor) {\n  let gltfUrl = src;\n  let fileMap;\n\n  if (contentType.includes(\"model/gltf+zip\") || contentType.includes(\"application/x-zip-compressed\")) {\n    fileMap = await extractZipFile(gltfUrl);\n    gltfUrl = fileMap[\"scene.gtlf\"];\n  }\n\n  const loadingManager = new THREE.LoadingManager();\n  loadingManager.setURLModifier(getCustomGLTFParserURLResolver(gltfUrl));\n  const gltfLoader = new THREE.GLTFLoader(loadingManager);\n\n  const parser = await new Promise((resolve, reject) => gltfLoader.createParser(gltfUrl, resolve, onProgress, reject));\n\n  parser.textureLoader = textureLoader;\n\n  if (jsonPreprocessor) {\n    parser.json = jsonPreprocessor(parser.json);\n  }\n\n  let version = 0;\n  if (\n    parser.json.extensions &&\n    parser.json.extensions.MOZ_hubs_components &&\n    parser.json.extensions.MOZ_hubs_components.hasOwnProperty(\"version\")\n  ) {\n    version = parser.json.extensions.MOZ_hubs_components.version;\n  }\n  runMigration(version, parser.json);\n\n  const materials = parser.json.materials;\n  if (materials) {\n    for (let i = 0; i < materials.length; i++) {\n      const material = materials[i];\n\n      if (\n        material.extensions &&\n        material.extensions.MOZ_alt_materials &&\n        material.extensions.MOZ_alt_materials[preferredTechnique] !== undefined\n      ) {\n        const altMaterialIndex = material.extensions.MOZ_alt_materials[preferredTechnique];\n        materials[i] = materials[altMaterialIndex];\n      }\n    }\n  }\n\n  const nodes = parser.json.nodes;\n\n  if (nodes) {\n    for (let i = 0; i < nodes.length; i++) {\n      const node = nodes[i];\n\n      if (!node.extras) {\n        node.extras = {};\n      }\n\n      node.extras.gltfIndex = i;\n    }\n  }\n\n  const gltf = await new Promise(parser.parse.bind(parser));\n\n  gltf.scene.traverse(object => {\n    // GLTFLoader sets matrixAutoUpdate on animated objects, we want to keep the defaults\n    object.matrixAutoUpdate = THREE.Object3D.DefaultMatrixAutoUpdate;\n\n    object.material = mapMaterials(object, material => {\n      if (material.isMeshStandardMaterial && preferredTechnique === \"KHR_materials_unlit\") {\n        return MobileStandardMaterial.fromStandardMaterial(material);\n      }\n\n      return material;\n    });\n  });\n\n  if (fileMap) {\n    // The GLTF is now cached as a THREE object, we can get rid of the original blobs\n    Object.keys(fileMap).forEach(URL.revokeObjectURL);\n  }\n\n  return gltf;\n}\n\n/**\n * Loads a GLTF model, optionally recursively \"inflates\" the child nodes of a model into a-entities and sets\n * whitelisted components on them if defined in the node's extras.\n * @namespace gltf\n * @component gltf-model-plus\n */\nAFRAME.registerComponent(\"gltf-model-plus\", {\n  schema: {\n    src: { type: \"string\" },\n    contentType: { type: \"string\" },\n    useCache: { default: true },\n    inflate: { default: false },\n    batch: { default: false },\n    modelToWorldScale: { type: \"number\", default: 1 }\n  },\n\n  init() {\n    this.preferredTechnique =\n      window.APP && window.APP.quality === \"low\" ? \"KHR_materials_unlit\" : \"pbrMetallicRoughness\";\n\n    // This can be set externally if a consumer wants to do some node preprocssing.\n    this.jsonPreprocessor = null;\n\n    this.loadTemplates();\n  },\n\n  update() {\n    this.applySrc(this.data.src, this.data.contentType);\n  },\n\n  remove() {\n    if (this.data.batch && this.model) {\n      this.el.sceneEl.systems[\"hubs-systems\"].batchManagerSystem.removeObject(this.el.object3DMap.mesh);\n    }\n    if (this.data.src) {\n      gltfCache.release(this.data.src);\n    }\n  },\n\n  loadTemplates() {\n    this.templates = {};\n    this.el.querySelectorAll(\":scope > template\").forEach(templateEl => {\n      const root = document.importNode(templateEl.firstElementChild || templateEl.content.firstElementChild, true);\n      this.templates[templateEl.getAttribute(\"data-name\")] = root;\n    });\n  },\n\n  async loadModel(src, contentType, technique, useCache) {\n    if (useCache) {\n      if (gltfCache.has(src)) {\n        gltfCache.retain(src);\n        return cloneGltf(gltfCache.get(src).gltf);\n      } else {\n        if (inflightGltfs.has(src)) {\n          const gltf = await inflightGltfs.get(src);\n          gltfCache.retain(src);\n          return cloneGltf(gltf);\n        } else {\n          const promise = loadGLTF(src, contentType, technique, null, this.jsonPreprocessor);\n          inflightGltfs.set(src, promise);\n          const gltf = await promise;\n          inflightGltfs.delete(src);\n          gltfCache.set(src, gltf);\n          return cloneGltf(gltf);\n        }\n      }\n    } else {\n      return loadGLTF(src, contentType, technique, null, this.jsonPreprocessor);\n    }\n  },\n\n  async applySrc(src, contentType) {\n    try {\n      // If the src attribute is a selector, get the url from the asset item.\n      if (src && src.charAt(0) === \"#\") {\n        const assetEl = document.getElementById(src.substring(1));\n        src = assetEl.getAttribute(\"src\");\n      }\n\n      if (src === this.lastSrc) return;\n\n      const lastSrc = this.lastSrc;\n      this.lastSrc = src;\n\n      if (!src) {\n        if (this.inflatedEl) {\n          console.warn(\"gltf-model-plus set to an empty source, unloading inflated model.\");\n          this.disposeLastInflatedEl();\n        }\n        return;\n      }\n\n      this.el.emit(\"model-loading\");\n      const gltf = await this.loadModel(src, contentType, this.preferredTechnique, this.data.useCache);\n\n      // If we started loading something else already\n      // TODO: there should be a way to cancel loading instead\n      if (src != this.lastSrc) return;\n\n      // If we had inflated something already before, clean that up\n      this.disposeLastInflatedEl();\n\n      this.model = gltf.scene || gltf.scenes[0];\n      this.model.animations = gltf.animations;\n\n      if (this.data.batch) {\n        this.el.sceneEl.systems[\"hubs-systems\"].batchManagerSystem.addObject(this.model);\n      }\n\n      if (gltf.animations.length > 0) {\n        this.el.setAttribute(\"animation-mixer\", {});\n        this.el.components[\"animation-mixer\"].initMixer(gltf.animations);\n      } else {\n        generateMeshBVH(this.model);\n      }\n\n      const indexToEntityMap = {};\n\n      let object3DToSet = this.model;\n      if (\n        this.data.inflate &&\n        (this.inflatedEl = inflateEntities(\n          indexToEntityMap,\n          this.model,\n          this.templates,\n          true,\n          this.data.modelToWorldScale\n        ))\n      ) {\n        this.el.appendChild(this.inflatedEl);\n\n        object3DToSet = this.inflatedEl.object3D;\n        // TODO: Still don't fully understand the lifecycle here and how it differs between browsers, we should dig in more\n        // Wait one tick for the appended custom elements to be connected before attaching templates\n        await nextTick();\n        if (src != this.lastSrc) return; // TODO: there must be a nicer pattern for this\n\n        inflateComponents(this.inflatedEl, indexToEntityMap);\n\n        for (const name in this.templates) {\n          attachTemplate(this.el, name, this.templates[name]);\n        }\n      }\n\n      // The call to setObject3D below recursively clobbers any `el` backreferences to entities\n      // in the entire inflated entity graph to point to `object3DToSet`.\n      //\n      // We don't want those overwritten, since lots of code assumes `object3d.el` points to the relevant\n      // A-Frame entity for that three.js object, so we back them up and re-wire them here. If we didn't do\n      // this, all the `el` properties on these object3ds would point to the `object3DToSet` which is either\n      // the model or the root GLTF inflated entity.\n      const rewires = [];\n\n      object3DToSet.traverse(o => {\n        const el = o.el;\n        if (el) rewires.push(() => (o.el = el));\n      });\n\n      const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\n\n      if (environmentMapComponent) {\n        environmentMapComponent.applyEnvironmentMap(object3DToSet);\n      }\n\n      if (lastSrc) {\n        gltfCache.release(lastSrc);\n      }\n      this.el.setObject3D(\"mesh\", object3DToSet);\n\n      rewires.forEach(f => f());\n\n      this.el.emit(\"model-loaded\", { format: \"gltf\", model: this.model });\n    } catch (e) {\n      gltfCache.release(src);\n      console.error(\"Failed to load glTF model\", e, this);\n      this.el.emit(\"model-error\", { format: \"gltf\", src });\n    }\n  },\n\n  disposeLastInflatedEl() {\n    if (this.inflatedEl) {\n      this.inflatedEl.parentNode.removeChild(this.inflatedEl);\n\n      this.inflatedEl.object3D.traverse(x => {\n        if (x.material && x.material.dispose) {\n          x.material.dispose();\n        }\n\n        if (x.geometry) {\n          if (x.geometry.dispose) {\n            x.geometry.dispose();\n          }\n\n          x.geometry.boundsTree = null;\n        }\n      });\n\n      delete this.inflatedEl;\n\n      this.el.removeAttribute(\"animation-mixer\");\n    }\n  }\n});\n","// Wrapper for a worker which accepts work items and responds with results.\n//\n// The worker must receive messages with data of the shape { id, payload }, and then respond\n// with messages containing matching IDs of the shape { id, result, err }.\n//\n// Returns a function that accepts a work item, sends it to the worker, and returns a promise that\n// will resolve with the result or reject with the error.\n//\nexport function promisifyWorker(worker) {\n  let nextItemId = 0;\n  const outstanding = {}; // item ID: { resolve, reject }\n\n  worker.onmessage = msg => {\n    const { id, result, err } = msg.data;\n    const handlers = outstanding[id];\n    if (handlers == null) {\n      console.error(`Unknown message with ID ${id} received from ${worker}.`);\n    } else {\n      delete outstanding[id];\n      if (err != null) {\n        handlers.reject(new Error(err));\n      } else {\n        handlers.resolve(result);\n      }\n    }\n  };\n\n  return function(data, transfer) {\n    const id = nextItemId++;\n    const promise = new Promise((resolve, reject) => {\n      outstanding[id] = { resolve, reject };\n    });\n    worker.postMessage({ id, payload: data }, transfer);\n    return promise;\n  };\n}\n","// Given a function and a queue name, schedules things so a single function\n// from a given queue will be called per frame.\nAFRAME.registerSystem(\"frame-scheduler\", {\n  init() {\n    // Registry a map from queue name to list of registered functions.\n    this.registry = new Map();\n    this.queues = [];\n    this.frameIndex = 0;\n  },\n\n  schedule(func, queue) {\n    if (!this.registry.has(queue)) {\n      this.queues.push(queue);\n      this.registry.set(queue, []);\n    }\n\n    this.registry.get(queue).push(func);\n  },\n\n  unschedule(func) {\n    for (let i = 0; i < this.queues.length; i++) {\n      const queue = this.queues[i];\n      const entries = this.registry.get(queue);\n      const idx = entries.indexOf(func);\n\n      if (idx >= 0) {\n        entries.splice(idx, 1);\n      }\n    }\n  },\n\n  tick: function() {\n    for (let i = 0; i < this.queues.length; i++) {\n      const queue = this.queues[i];\n      const entries = this.registry.get(queue);\n      if (entries.length === 0) continue;\n\n      entries[this.frameIndex % entries.length]();\n    }\n\n    this.frameIndex++;\n  }\n});\n","/* global AFRAME */\n\n/**\n * Toggle visibility of an entity based on if the user is in vr mode or not\n * @namespace vr-mode\n * @component vr-mode-toggle-visibility\n */\nAFRAME.registerComponent(\"vr-mode-toggle-visibility\", {\n  schema: {\n    invert: { type: \"boolean\", default: false }\n  },\n\n  init() {\n    this.updateComponentState = this.updateComponentState.bind(this);\n  },\n\n  play() {\n    this.updateComponentState();\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  updateComponentState() {\n    const inVRMode = this.el.sceneEl.is(\"vr-mode\");\n    this.el.setAttribute(\"visible\", inVRMode !== this.data.invert);\n  }\n});\n\n/**\n * Toggle the isPlaying state of a component based on app mode\n * @namespace vr-mode\n * @component vr-mode-toggle-playing\n */\nAFRAME.registerComponent(\"vr-mode-toggle-playing\", {\n  multiple: true,\n  schema: {\n    invert: { type: \"boolean\", default: false }\n  },\n\n  init() {\n    this.updateComponentState = this.updateComponentState.bind(this);\n  },\n\n  play() {\n    this.updateComponentState();\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  updateComponentState() {\n    const componentName = this.id;\n    const inVRMode = this.el.sceneEl.is(\"vr-mode\");\n    this.el.components[componentName][inVRMode !== this.data.invert ? \"play\" : \"pause\"]();\n  }\n});\n\n/**\n * Toggle a CSS class based upon app mode.\n * @namespace vr-mode\n * @component vr-mode-toggle-class\n */\nAFRAME.registerComponent(\"vr-mode-toggle-class\", {\n  multiple: true,\n  schema: {\n    invert: { type: \"boolean\", default: false },\n    class: { type: \"string\", default: \"\" }\n  },\n\n  init() {\n    this.updateComponentState = this.updateComponentState.bind(this);\n  },\n\n  play() {\n    this.updateComponentState();\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  updateComponentState() {\n    const inVRMode = this.el.sceneEl.is(\"vr-mode\");\n\n    if (inVRMode) {\n      this.el.classList.add(this.data.class);\n    } else {\n      this.el.classList.remove(this.data.class);\n    }\n  }\n});\n","AFRAME.registerSystem(\"permissions\", {\n  onPermissionsUpdated(handler) {\n    if (window.APP.hubChannel) {\n      window.APP.hubChannel.addEventListener(\"permissions_updated\", handler);\n    } else {\n      window.addEventListener(\n        \"hub_channel_ready\",\n        () => window.APP.hubChannel.addEventListener(\"permissions_updated\", handler),\n        { once: true }\n      );\n    }\n  },\n  can(permissionName) {\n    return !!window.APP.hubChannel.can(permissionName);\n  },\n  canOrWillIfCreator(permissionName) {\n    return !!window.APP.hubChannel.canOrWillIfCreator(permissionName);\n  },\n  fetchPermissions() {\n    return window.APP.hubChannel.fetchPermissions();\n  }\n});\n","/**\n * Emits an \"exit\" event when a user has stopped using the app for a certain period of time\n * @system exit-on-blur\n */\nAFRAME.registerSystem(\"exit-on-blur\", {\n  init() {\n    this.onBlur = this.onBlur.bind(this);\n    this.onFocus = this.onFocus.bind(this);\n    this.onTimeout = this.onTimeout.bind(this);\n    this.onEnterVR = this.onEnterVR.bind(this);\n\n    this.isOculusBrowser = navigator.userAgent.match(/Oculus/);\n    this.enteredVR = false;\n\n    window.addEventListener(\"blur\", this.onBlur);\n    window.addEventListener(\"focus\", this.onFocus);\n    this.el.addEventListener(\"enter-vr\", this.onEnterVR);\n\n    this.lastTimeoutCheck = 0;\n    this.exitTimeout = null;\n  },\n\n  tick(t) {\n    // This is a hack to detect when an Oculus Go user has taken off the headset and the headset has\n    // entered standby mode. Currently Oculus Browser is not emitting a blur, vrdisplaydeactivate,\n    // vrdisplayblur, visibilitychange, or vrdisplaypresentchange event, so we wait 15 seconds after\n    // the last requestAnimationFrame callback to determine if the headset has gone into standby mode.\n    // We also check that you have entered VR so that this timeout does not occur in the setup UI.\n    if (\n      this.isOculusBrowser &&\n      this.enteredVR &&\n      (this.lastTimeoutCheck === 0 || t - this.lastTimeoutCheck >= 1000.0) // Don't do this clear every frame, slow.\n    ) {\n      this.lastTimeoutCheck = t;\n      clearTimeout(this.exitTimeout);\n      this.exitTimeout = setTimeout(this.onTimeout, 15 * 1000);\n    }\n  },\n\n  onEnterVR() {\n    this.enteredVR = true;\n  },\n\n  onBlur() {\n    if (this.el.isMobile) {\n      clearTimeout(this.exitTimeout);\n      this.exitTimeout = setTimeout(this.onTimeout, 30 * 1000);\n    }\n  },\n\n  onFocus() {\n    if (this.el.isMobile) {\n      clearTimeout(this.exitTimeout);\n    }\n  },\n\n  onTimeout() {\n    this.el.dispatchEvent(new CustomEvent(\"exit\"));\n  },\n\n  remove() {\n    clearTimeout(this.exitTimeout);\n    window.removeEventListener(\"blur\", this.onBlur);\n  }\n});\n","export const paths = {};\npaths.noop = \"/noop\";\npaths.actions = {};\npaths.actions.log = \"/actions/log\";\npaths.actions.toggleScreenShare = \"/actions/toggleScreenShare\";\npaths.actions.snapRotateLeft = \"/actions/snapRotateLeft\";\npaths.actions.snapRotateRight = \"/actions/snapRotateRight\";\npaths.actions.angularVelocity = \"/actions/angularVelocity\";\npaths.actions.logDebugFrame = \"/actions/logDebugFrame\";\npaths.actions.logInteractionState = \"/actions/logInteractionState\";\npaths.actions.cameraDelta = \"/actions/cameraDelta\";\npaths.actions.lobbyCameraDelta = \"/actions/lobbyCameraDelta\";\npaths.actions.characterAcceleration = \"/actions/characterAcceleration\";\npaths.actions.boost = \"/actions/boost\";\npaths.actions.startGazeTeleport = \"/actions/startTeleport\";\npaths.actions.stopGazeTeleport = \"/actions/stopTeleport\";\npaths.actions.spawnPen = \"/actions/spawnPen\";\npaths.actions.ensureFrozen = \"/actions/ensureFrozen\";\npaths.actions.toggleFreeze = \"/actions/toggleFreeze\";\npaths.actions.thaw = \"/actions/thaw\";\npaths.actions.muteMic = \"/actions/muteMic\";\npaths.actions.toggleFlying = \"/actions/toggleFlying\";\npaths.actions.enableMegaphone = \"/actions/enableMegaphone\";\npaths.actions.focusChat = \"/actions/focusChat\";\npaths.actions.focusChatCommand = \"/actions/focusChatCommand\";\npaths.actions.toggleCamera = \"/actions/toggleCamera\";\npaths.actions.takeSnapshot = \"/actions/takeSnapshot\";\npaths.actions.mediaExit = \"/actions/mediaExit\";\npaths.actions.mediaSearch1 = \"/actions/mediaSearch1\";\npaths.actions.mediaSearch2 = \"/actions/mediaSearch2\";\npaths.actions.mediaSearch3 = \"/actions/mediaSearch3\";\npaths.actions.mediaSearch4 = \"/actions/mediaSearch4\";\npaths.actions.mediaSearch5 = \"/actions/mediaSearch5\";\npaths.actions.mediaSearch6 = \"/actions/mediaSearch6\";\npaths.actions.mediaSearch7 = \"/actions/mediaSearch7\";\npaths.actions.mediaSearch8 = \"/actions/mediaSearch8\";\npaths.actions.transformModifier = \"/actions/transformModifier\";\npaths.actions.rayObjectRotation = \"/actions/rayObjectRotation\";\npaths.actions.cursor = {};\npaths.actions.cursor.pose = \"/actions/cursorPose\";\npaths.actions.cursor.hideLine = \"/actions/cursorHideLine\";\npaths.actions.cursor.grab = \"/actions/cursorGrab\";\npaths.actions.cursor.drop = \"/actions/cursorDrop\";\npaths.actions.cursor.modDelta = \"/actions/cursorModDelta\";\npaths.actions.cursor.startDrawing = \"/actions/cursorStartDrawing\";\npaths.actions.cursor.stopDrawing = \"/actions/cursorStopDrawing\";\npaths.actions.cursor.undoDrawing = \"/actions/cursorUndoDrawing\";\npaths.actions.cursor.penNextColor = \"/actions/cursorPenNextColor\";\npaths.actions.cursor.penPrevColor = \"/actions/cursorPenPrevColor\";\npaths.actions.cursor.scalePenTip = \"/actions/cursorScalePenTip\";\npaths.actions.cursor.scaleGrabbedGrabbable = \"/actions/cursorScaleGrabbedGrabbable\";\npaths.actions.cursor.mediaVolumeMod = \"/actions/cursor/mediaVolumeMod\";\npaths.actions.cursor.takeSnapshot = \"/actions/cursorTakeSnapshot\";\npaths.actions.pen = {};\npaths.actions.pen.remove = \"/actions/pen/remove\";\npaths.actions.rightHand = {};\npaths.actions.rightHand.matrix = \"/actions/rightHand/matrix\";\npaths.actions.rightHand.pose = \"/actions/rightHandPose\";\npaths.actions.rightHand.grab = \"/actions/rightHandGrab\";\npaths.actions.rightHand.drop = \"/actions/rightHandDrop\";\npaths.actions.rightHand.modDelta = \"/actions/rightHandModDelta\";\npaths.actions.rightHand.startDrawing = \"/actions/rightHandStartDrawing\";\npaths.actions.rightHand.stopDrawing = \"/actions/rightHandStopDrawing\";\npaths.actions.rightHand.undoDrawing = \"/actions/rightHandUndoDrawing\";\npaths.actions.rightHand.switchDrawMode = \"/actions/rightHandSwitchDrawMode\";\npaths.actions.rightHand.penNextColor = \"/actions/rightHandPenNextColor\";\npaths.actions.rightHand.penPrevColor = \"/actions/rightHandPenPrevColor\";\npaths.actions.rightHand.scalePenTip = \"/actions/rightHandScalePenTip\";\npaths.actions.rightHand.startTeleport = \"/actions/rightHand/startTeleport\";\npaths.actions.rightHand.stopTeleport = \"/actions/rightHand/stopTeleport\";\npaths.actions.rightHand.takeSnapshot = \"/actions/rightHandTakeSnapshot\";\npaths.actions.rightHand.thumb = \"/actions/rightHand/thumbDown\";\npaths.actions.rightHand.index = \"/actions/rightHand/indexDown\";\npaths.actions.rightHand.middleRingPinky = \"/actions/rightHand/middleRingPinkyDown\";\npaths.actions.leftHand = {};\npaths.actions.leftHand.matrix = \"/actions/leftHand/matrix\";\npaths.actions.leftHand.pose = \"/actions/leftHandPose\";\npaths.actions.leftHand.grab = \"/actions/leftHandGrab\";\npaths.actions.leftHand.drop = \"/actions/leftHandDrop\";\npaths.actions.leftHand.modDelta = \"/actions/leftHandModDelta\";\npaths.actions.leftHand.startDrawing = \"/actions/leftHandStartDrawing\";\npaths.actions.leftHand.stopDrawing = \"/actions/leftHandStopDrawing\";\npaths.actions.leftHand.undoDrawing = \"/actions/leftHandUndoDrawing\";\npaths.actions.leftHand.switchDrawMode = \"/actions/leftHandSwitchDrawMode\";\npaths.actions.leftHand.penNextColor = \"/actions/leftHandPenNextColor\";\npaths.actions.leftHand.penPrevColor = \"/actions/leftHandPenPrevColor\";\npaths.actions.leftHand.scalePenTip = \"/actions/leftHandScalePenTip\";\npaths.actions.leftHand.startTeleport = \"/actions/leftHand/startTeleport\";\npaths.actions.leftHand.stopTeleport = \"/actions/leftHand/stopTeleport\";\npaths.actions.leftHand.takeSnapshot = \"/actions/leftHandTakeSnapshot\";\npaths.actions.leftHand.thumb = \"/actions/leftHand/thumbDown\";\npaths.actions.leftHand.index = \"/actions/leftHand/indexDown\";\npaths.actions.leftHand.middleRingPinky = \"/actions/leftHand/middleRingPinkyDown\";\npaths.actions.camera = {};\npaths.actions.camera.exitMirror = \"/actions/cameraExitMirror\";\npaths.haptics = {};\npaths.haptics.actuators = {};\npaths.haptics.actuators.left = \"/haptics/actuators/left\";\npaths.haptics.actuators.right = \"/haptics/actuators/right\";\n\npaths.device = {};\npaths.device.mouse = {};\npaths.device.mouse.coords = \"/device/mouse/coords\";\npaths.device.mouse.movementXY = \"/device/mouse/movementXY\";\npaths.device.mouse.buttonLeft = \"/device/mouse/buttonLeft\";\npaths.device.mouse.buttonRight = \"/device/mouse/buttonRight\";\npaths.device.mouse.wheel = \"/device/mouse/wheel\";\npaths.device.smartMouse = {};\npaths.device.smartMouse.cursorPose = \"/device/smartMouse/cursorPose\";\npaths.device.smartMouse.cameraDelta = \"/device/smartMouse/cameraDelta\";\npaths.device.touchscreen = {};\npaths.device.touchscreen.cursorPose = \"/device/touchscreen/cursorPose\";\npaths.device.touchscreen.touchCameraDelta = \"/device/touchscreen/touchCameraDelta\";\npaths.device.touchscreen.gyroCameraDelta = \"/device/touchscreen/gyroCameraDelta\";\npaths.device.touchscreen.cameraDelta = \"/device/touchscreen/cameraDelta\";\npaths.device.touchscreen.pinch = {};\npaths.device.touchscreen.pinch.delta = \"/device/touchscreen/pinch/delta\";\npaths.device.touchscreen.pinch.initialDistance = \"/device/touchscreen/pinch/initialDistance\";\npaths.device.touchscreen.pinch.currentDistance = \"/device/touchscreen/pinch/currentDistance\";\npaths.device.touchscreen.isTouching = \"/device/touchscreen/isTouching\";\npaths.device.touchscreen.isTouchingGrabbable = \"/device/touchscreen/isTouchingGrabbable\";\npaths.device.touchscreen.tap1 = \"/device/touchscreen/tap1\";\npaths.device.touchscreen.tap2 = \"/device/touchscreen/tap2\";\npaths.device.touchscreen.tap3 = \"/device/touchscreen/tap3\";\npaths.device.touchscreen.tap4 = \"/device/touchscreen/tap4\";\npaths.device.touchscreen.tap5 = \"/device/touchscreen/tap5\";\npaths.device.gyro = {};\npaths.device.gyro.averageDeltaX = \"/device/gyro/averageDeltaX\";\npaths.device.gyro.averageDeltaY = \"/device/gyro/averageDeltaY\";\npaths.device.hud = {};\npaths.device.hud.penButton = \"/device/hud/penButton\";\n\npaths.device.keyboard = {\n  map: new Map(),\n  key: function(k) {\n    let path = this.map.get(k);\n    if (path) {\n      return path;\n    }\n    path = `/device/keyboard/${k.toLowerCase()}`;\n    this.map.set(k, path);\n    return path;\n  }\n};\n\npaths.device.gamepad = gamepadIndex => ({\n  button: buttonIndex => ({\n    pressed: `/device/gamepad/${gamepadIndex}/button/${buttonIndex}/pressed`,\n    touched: `/device/gamepad/${gamepadIndex}/button/${buttonIndex}/touched`,\n    value: `/device/gamepad/${gamepadIndex}/button/${buttonIndex}/value`\n  }),\n  axis: axisIndex => `/device/gamepad/${gamepadIndex}/axis/${axisIndex}`\n});\n\nconst xbox = \"/device/xbox/\";\npaths.device.xbox = {\n  v: name => `/vars/xbox/${name}`,\n  button: buttonName => ({\n    pressed: `${xbox}button/${buttonName}/pressed`,\n    touched: `${xbox}button/${buttonName}/touched`,\n    value: `${xbox}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${xbox}axis/${axisName}`;\n  },\n  axesSum: `${xbox}axis/sum`\n};\n\npaths.device.oculusgo = {\n  // TODO remove these in favor of the direct accessors\n  button: buttonName => ({\n    pressed: `/device/oculusgo/button/${buttonName}/pressed`,\n    touched: `/device/oculusgo/button/${buttonName}/touched`,\n    value: `/device/oculusgo/button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `/device/oculusgo/axis/${axisName}`;\n  },\n  //\n  trigger: {\n    pressed: \"/device/oculusgo/button/trigger/pressed\",\n    touched: \"/device/oculusgo/button/trigger/touched\",\n    value: \"/device/oculusgo/button/trigger/value\"\n  },\n  touchpad: {\n    pressed: \"/device/oculusgo/button/touchpad/pressed\",\n    touched: \"/device/oculusgo/button/touchpad/touched\",\n    value: \"/device/oculusgo/button/touchpad/value\",\n    axisX: \"/device/oculusgo/axis/touchpadX\",\n    axisY: \"/device/oculusgo/axis/touchpadY\"\n  },\n  pose: \"/device/oculusgo/pose\",\n  matrix: \"/device/oculusgo/matrix\",\n  v: name => {\n    return `/vars/oculusgo/${name}`;\n  }\n};\n\nconst gearVRController = \"/device/gearVRController/\";\npaths.device.gearVRController = {\n  button: buttonName => ({\n    pressed: `${gearVRController}button/${buttonName}/pressed`,\n    touched: `${gearVRController}button/${buttonName}/touched`,\n    value: `${gearVRController}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${gearVRController}axis/${axisName}`;\n  },\n  pose: `${gearVRController}pose`,\n  matrix: `${gearVRController}matrix`,\n  v: name => {\n    return `/vars/gearVRController/${name}`;\n  }\n};\n\nconst daydream = \"/device/daydream/\";\npaths.device.daydream = {\n  button: buttonName => ({\n    pressed: `${daydream}button/${buttonName}/pressed`,\n    touched: `${daydream}button/${buttonName}/touched`,\n    value: `${daydream}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${daydream}axis/${axisName}`;\n  },\n  pose: `${daydream}pose`,\n  matrix: `${daydream}matrix`\n};\n\nconst rightOculusTouch = \"/device/rightOculusTouch/\";\npaths.device.rightOculusTouch = {\n  button: buttonName => ({\n    pressed: `${rightOculusTouch}button/${buttonName}/pressed`,\n    touched: `${rightOculusTouch}button/${buttonName}/touched`,\n    value: `${rightOculusTouch}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${rightOculusTouch}axis/${axisName}`;\n  },\n  axesSum: `${rightOculusTouch}axis/sum`,\n  pose: `${rightOculusTouch}pose`,\n  matrix: `${rightOculusTouch}matrix`\n};\n\nconst leftOculusTouch = \"/device/leftOculusTouch/\";\npaths.device.leftOculusTouch = {\n  button: buttonName => ({\n    pressed: `${leftOculusTouch}button/${buttonName}/pressed`,\n    touched: `${leftOculusTouch}button/${buttonName}/touched`,\n    value: `${leftOculusTouch}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${leftOculusTouch}axis/${axisName}`;\n  },\n  axesSum: `${leftOculusTouch}axis/sum`,\n  pose: `${leftOculusTouch}pose`,\n  matrix: `${leftOculusTouch}matrix`\n};\n\npaths.device.vive = {};\npaths.device.vive.left = {\n  button: buttonName => ({\n    pressed: `/device/vive/left/button/${buttonName}/pressed`,\n    touched: `/device/vive/left/button/${buttonName}/touched`,\n    value: `/device/vive/left/button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `/device/vive/left/axis/${axisName}`;\n  },\n  axesSum: \"/device/vive/left/axis/sum\",\n  pose: `/device/vive/left/pose`,\n  matrix: `/device/vive/left/matrix`\n};\npaths.device.vive.right = {\n  button: buttonName => ({\n    pressed: `/device/vive/right/button/${buttonName}/pressed`,\n    touched: `/device/vive/right/button/${buttonName}/touched`,\n    value: `/device/vive/right/button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `/device/vive/right/axis/${axisName}`;\n  },\n  axesSum: \"/device/vive/right/axis/sum\",\n  pose: `/device/vive/right/pose`,\n  matrix: `/device/vive/right/matrix`\n};\n\nfunction button(device, side, name) {\n  return {\n    pressed: `${device}${side}/button/${name}/pressed`,\n    touched: `${device}${side}/button/${name}/touched`,\n    value: `${device}${side}/button/${name}/value`\n  };\n}\n\nfunction axes(device, side, name) {\n  return {\n    axisX: `${device}${side}/axis/${name}X`,\n    axisY: `${device}${side}/axis/${name}Y`\n  };\n}\n\nfunction wmrController(side) {\n  const wmr = \"/device/wmr/\";\n  return {\n    touchpad: {\n      ...button(wmr, side, \"touchpad\"),\n      ...axes(wmr, side, \"touchpad\")\n    },\n    trigger: button(wmr, side, \"trigger\"),\n    grip: button(wmr, side, \"grip\"),\n    menu: button(wmr, side, \"menu\"),\n    joystick: axes(wmr, side, \"joystick\"),\n    pose: `${wmr}${side}/pose`,\n    matrix: `${wmr}${side}/matrix`\n  };\n}\npaths.device.wmr = {};\npaths.device.wmr.v = name => `/vars/wmr/${name}`;\npaths.device.wmr.k = name => `/vars/wmr/keyboard/${name}`;\npaths.device.wmr.left = wmrController(\"left\");\npaths.device.wmr.right = wmrController(\"right\");\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"client-link\":\"presence-list__client-link__3tkyz\",\"clientLink\":\"presence-list__client-link__3tkyz\",\"presence-list\":\"presence-list__presence-list__1KERe\",\"presenceList\":\"presence-list__presence-list__1KERe\",\"attach-point\":\"presence-list__attach-point__kIdfx\",\"attachPoint\":\"presence-list__attach-point__kIdfx\",\"contents\":\"presence-list__contents__1B7bz\",\"rows\":\"presence-list__rows__1B6KS\",\"row\":\"presence-list__row__1D2j2\",\"row-header\":\"presence-list__row-header__3kl1w\",\"rowHeader\":\"presence-list__row-header__3kl1w\",\"list-item\":\"presence-list__list-item__2YARP\",\"listItem\":\"presence-list__list-item__2YARP\",\"list-item-link\":\"presence-list__list-item-link__2DLC2\",\"listItemLink\":\"presence-list__list-item-link__2DLC2\",\"presence\":\"presence-list__presence__15DJe\",\"sign-in\":\"presence-list__sign-in__28eVu\",\"signIn\":\"presence-list__sign-in__28eVu\",\"icon\":\"presence-list__icon__1t8iB\",\"self\":\"presence-list__self__1g-bw\",\"moderator-badge\":\"presence-list__moderator-badge__2njku\",\"moderatorBadge\":\"presence-list__moderator-badge__2njku\"};","/* global AFRAME NAF performance */\nAFRAME.registerComponent(\"owned-object-limiter\", {\n  schema: {\n    counter: { type: \"selector\" }\n  },\n\n  init() {\n    this.counter = this.data.counter.components[\"networked-counter\"];\n  },\n\n  tick() {\n    this._syncCounterRegistration();\n    const isHeld = this.el.sceneEl.systems.interaction.isHeld(this.el);\n    if (!isHeld && this.wasHeld && this.counter.timestamps.has(this.el)) {\n      this.counter.timestamps.set(this.el, performance.now());\n    }\n    this.wasHeld = isHeld;\n  },\n\n  remove() {\n    this.counter.deregister(this.el);\n  },\n\n  _syncCounterRegistration() {\n    if (!this.el.components[\"networked\"]) return;\n\n    const isPinned = this.el.components[\"pinnable\"] && this.el.components[\"pinnable\"].data.pinned;\n\n    if (NAF.utils.isMine(this.el) && !isPinned) {\n      this.counter.register(this.el);\n    } else {\n      this.counter.deregister(this.el);\n    }\n  }\n});\n","/* global NAF */\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\n\nAFRAME.registerComponent(\"set-unowned-body-kinematic\", {\n  init() {\n    this.setBodyKinematic = this.setBodyKinematic.bind(this);\n  },\n  play() {\n    this.el.addEventListener(\"ownership-lost\", this.setBodyKinematic);\n\n    if (!this.didThisOnce) {\n      // Do this in play instead of init so that the ammo-body and networked components are done\n      this.didThisOnce = true;\n\n      if (!NAF.utils.isMine(this.el)) {\n        this.setBodyKinematic();\n      }\n    }\n  },\n  pause() {\n    this.el.removeEventListener(\"ownership-lost\", this.setBodyKinematic);\n  },\n  setBodyKinematic() {\n    this.el.setAttribute(\"ammo-body\", {\n      type: \"kinematic\",\n      collisionFilterMask: COLLISION_LAYERS.UNOWNED_INTERACTABLE\n    });\n    if (this.el.components[\"floaty-object\"]) {\n      this.el.components[\"floaty-object\"].locked = true;\n    }\n  }\n});\n","/* global AFRAME performance */\n/**\n * Limits networked interactables to a maximum number at any given time\n * @namespace network\n * @component networked-counter\n */\nAFRAME.registerComponent(\"networked-counter\", {\n  schema: {\n    max: { default: 3 }\n  },\n\n  init() {\n    this.timestamps = new Map();\n    this.el.object3D.visible = false;\n  },\n\n  remove() {\n    this.timestamps.clear();\n  },\n\n  count() {\n    return this.timestamps.size;\n  },\n\n  register(el) {\n    if (this.data.max <= 0 || this.timestamps.has(el)) return;\n\n    this.timestamps.set(el, performance.now());\n    if (this.timestamps.size > this.data.max) {\n      this._destroyOldest();\n    }\n  },\n\n  deregister(el) {\n    if (!this.timestamps.has(el)) return;\n    this.timestamps.delete(el);\n  },\n\n  _destroyOldest() {\n    const interaction = this.el.sceneEl.systems.interaction;\n    let oldestEl = null,\n      minTs = Number.MAX_VALUE;\n    this.timestamps.forEach((ts, el) => {\n      if (ts < minTs && !interaction.isHeld(el) && NAF.utils.isMine(el)) {\n        oldestEl = el;\n        minTs = ts;\n      }\n    });\n    this._destroy(oldestEl);\n  },\n\n  _destroy(el) {\n    // Pause the entity so that it won't just re-register itself immediately in owned-object-limiter.\n    el.pause();\n    // networked-interactable's remove will also call deregister, but it will happen async so we do it here as well.\n    this.deregister(el);\n    el.parentNode.removeChild(el);\n  }\n});\n","AFRAME.registerComponent(\"set-yxz-order\", {\n  init: function() {\n    this.el.object3D.rotation.order = \"YXZ\";\n  }\n});\n","/**\n * Initializes teleporters when the environment bundle has loaded.\n * @namespace environment\n * @component nav-mesh-helper\n */\nAFRAME.registerComponent(\"nav-mesh-helper\", {\n  init: function() {\n    this.el.addEventListener(\"model-loaded\", () => {\n      const teleporters = document.querySelectorAll(\"[teleporter]\");\n      for (let i = 0; i < teleporters.length; i++) {\n        teleporters[i].components[\"teleporter\"].queryCollisionEntities();\n      }\n    });\n  }\n});\n","/**\n * Drawing Manager\n * Manages what networked-drawings are available to pen components\n * @namespace drawing\n * @component drawing-manager\n */\nAFRAME.registerComponent(\"drawing-manager\", {\n  init() {\n    this._onComponentInitialized = this._onComponentInitialized.bind(this);\n\n    this.el.object3D.visible = false;\n    this.drawingToPen = new Map();\n  },\n\n  remove() {\n    if (this.drawingEl) {\n      this.drawingEl.removeEventListener(\"componentinitialized\", this._onComponentInitialized);\n    }\n  },\n\n  _onComponentInitialized(e) {\n    if (e.detail.name == \"networked-drawing\") {\n      this.drawing = this.drawingEl.components[\"networked-drawing\"];\n    }\n  },\n\n  createDrawing() {\n    if (!this.drawingEl) {\n      this.drawingEl = document.createElement(\"a-entity\");\n      this.drawingEl.setAttribute(\"networked\", \"template: #interactable-drawing\");\n      this.el.sceneEl.appendChild(this.drawingEl);\n\n      this.drawingEl.addEventListener(\"componentinitialized\", this._onComponentInitialized);\n    }\n  },\n\n  getDrawing(pen) {\n    //TODO: future handling of multiple drawings\n    if (this.drawing && (!this.drawingToPen.has(this.drawing) || this.drawingToPen.get(this.drawing) === pen)) {\n      this.drawingToPen.set(this.drawing, pen);\n      return this.drawing;\n    }\n\n    return null;\n  },\n\n  returnDrawing(pen) {\n    if (this.drawingToPen.has(this.drawing) && this.drawingToPen.get(this.drawing) === pen) {\n      this.drawingToPen.delete(this.drawing);\n    }\n  }\n});\n","import { forEachMaterial } from \"../utils/material-utils\";\nimport { showHoverEffect } from \"../utils/permissions-utils\";\n\nconst interactorOneTransform = [];\nconst interactorTwoTransform = [];\n\nexport const validMaterials = [\"MeshStandardMaterial\", \"MeshBasicMaterial\", \"MobileStandardMaterial\"];\n/**\n * Applies effects to a hoverable based on hover state.\n * @namespace interactables\n * @component hoverable-visuals\n */\nAFRAME.registerComponent(\"hoverable-visuals\", {\n  schema: {\n    enableSweepingEffect: { type: \"boolean\", default: true }\n  },\n  init() {\n    // uniforms and boundingSphere are set from the component responsible for loading the mesh.\n    this.uniforms = null;\n    this.boundingSphere = new THREE.Sphere();\n\n    this.sweepParams = [0, 0];\n  },\n  remove() {\n    this.uniforms = null;\n    this.boundingBox = null;\n\n    // Used when the object is batched\n    const batchManagerSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].batchManagerSystem;\n    this.el.object3D.traverse(object => {\n      if (!object.material) return;\n      forEachMaterial(object, material => {\n        if (\n          !validMaterials.includes(material.type) ||\n          object.el.classList.contains(\"ui\") ||\n          object.el.classList.contains(\"hud\") ||\n          object.el.getAttribute(\"text-button\")\n        )\n          return;\n\n        batchManagerSystem.meshToEl.delete(object);\n      });\n    });\n  },\n  tick(time) {\n    if (!this.uniforms || !this.uniforms.length) return;\n\n    const isFrozen = this.el.sceneEl.is(\"frozen\");\n    const showEffect = showHoverEffect(this.el);\n\n    let interactorOne, interactorTwo;\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    if (interaction.state.leftHand.hovered === this.el && !interaction.state.leftHand.held) {\n      interactorOne = interaction.options.leftHand.entity.object3D;\n    }\n    if (interaction.state.rightRemote.hovered === this.el && !interaction.state.rightRemote.held) {\n      interactorTwo = interaction.options.rightRemote.entity.object3D;\n    }\n    if (interaction.state.rightHand.hovered === this.el && !interaction.state.rightHand.held) {\n      interactorTwo = interaction.options.rightHand.entity.object3D;\n    }\n\n    if (interactorOne) {\n      interactorOne.matrixWorld.toArray(interactorOneTransform);\n    }\n    if (interactorTwo) {\n      interactorTwo.matrixWorld.toArray(interactorTwoTransform);\n    }\n\n    if (interactorOne || interactorTwo || isFrozen) {\n      const worldY = this.el.object3D.matrixWorld.elements[13];\n      const scaledRadius = this.el.object3D.scale.y * this.boundingSphere.radius;\n      this.sweepParams[0] = worldY - scaledRadius;\n      this.sweepParams[1] = worldY + scaledRadius;\n    }\n\n    for (let i = 0, l = this.uniforms.length; i < l; i++) {\n      const uniform = this.uniforms[i];\n      uniform.hubs_EnableSweepingEffect.value = this.data.enableSweepingEffect && showEffect;\n      uniform.hubs_IsFrozen.value = isFrozen;\n      uniform.hubs_SweepParams.value = this.sweepParams;\n\n      uniform.hubs_HighlightInteractorOne.value = !!interactorOne && showEffect;\n      uniform.hubs_InteractorOnePos.value[0] = interactorOneTransform[12];\n      uniform.hubs_InteractorOnePos.value[1] = interactorOneTransform[13];\n      uniform.hubs_InteractorOnePos.value[2] = interactorOneTransform[14];\n\n      uniform.hubs_HighlightInteractorTwo.value = !!interactorTwo && showEffect;\n      uniform.hubs_InteractorTwoPos.value[0] = interactorTwoTransform[12];\n      uniform.hubs_InteractorTwoPos.value[1] = interactorTwoTransform[13];\n      uniform.hubs_InteractorTwoPos.value[2] = interactorTwoTransform[14];\n\n      if (interactorOne || interactorTwo || isFrozen) {\n        uniform.hubs_Time.value = time;\n      }\n    }\n  }\n});\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"touchZone\":\"virtual-gamepad-controls__touchZone__1KF_C\",\"left\":\"virtual-gamepad-controls__left__1-URB\",\"right\":\"virtual-gamepad-controls__right__1cgnU\",\"mockJoystickContainer\":\"virtual-gamepad-controls__mockJoystickContainer__1aH3e\",\"mockJoystick\":\"virtual-gamepad-controls__mockJoystick__2CuCG\",\"inner\":\"virtual-gamepad-controls__inner__1Bn3C\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"action-button\":\"create-object-dialog__action-button__3OIJQ\",\"actionButton\":\"create-object-dialog__action-button__3OIJQ\",\"buttons\":\"create-object-dialog__buttons__1zA-b\",\"small-button\":\"create-object-dialog__small-button__7UxXQ\",\"smallButton\":\"create-object-dialog__small-button__7UxXQ\",\"input-border\":\"create-object-dialog__input-border__1N9AV\",\"inputBorder\":\"create-object-dialog__input-border__1N9AV\",\"left-side-of-input\":\"create-object-dialog__left-side-of-input__zyV06\",\"leftSideOfInput\":\"create-object-dialog__left-side-of-input__zyV06\",\"add-media-form\":\"create-object-dialog__add-media-form__10Wh-\",\"addMediaForm\":\"create-object-dialog__add-media-form__10Wh-\",\"cancel-icon\":\"create-object-dialog__cancel-icon__yD-8A\",\"cancelIcon\":\"create-object-dialog__cancel-icon__yD-8A\",\"upload-icon\":\"create-object-dialog__upload-icon__19g9k\",\"uploadIcon\":\"create-object-dialog__upload-icon__19g9k\",\"hide-file-input\":\"create-object-dialog__hide-file-input__2myDe\",\"hideFileInput\":\"create-object-dialog__hide-file-input__2myDe\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"close-button\":\"link-dialog__close-button__2THTw\",\"closeButton\":\"link-dialog__close-button__2THTw\",\"domain\":\"link-dialog__domain__1WbPJ\",\"dialog\":\"link-dialog__dialog__1zbyG\",\"header\":\"link-dialog__header__1A06x\",\"contents\":\"link-dialog__contents__3ODVz\",\"code\":\"link-dialog__code__259RI\",\"imageHeader\":\"link-dialog__imageHeader__eaJe6\",\"keep-open\":\"link-dialog__keep-open__DYcUI\",\"keepOpen\":\"link-dialog__keep-open__DYcUI\",\"digit\":\"link-dialog__digit___zoC4\",\"code-loading-panel\":\"link-dialog__code-loading-panel__WKkNk\",\"codeLoadingPanel\":\"link-dialog__code-loading-panel__WKkNk\",\"close\":\"link-dialog__close__2TTmg\"};","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nexport default class DialogContainer extends Component {\n  static propTypes = {\n    title: PropTypes.node,\n    children: PropTypes.node.isRequired,\n    onClose: PropTypes.func,\n    closable: PropTypes.bool,\n    wide: PropTypes.bool,\n    className: PropTypes.string,\n    allowOverflow: PropTypes.bool,\n    additionalClass: PropTypes.string\n  };\n\n  static defaultProps = {\n    closable: true\n  };\n\n  constructor(props) {\n    super(props);\n    this.onKeyDown = this.onKeyDown.bind(this);\n    this.onContainerClicked = this.onContainerClicked.bind(this);\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"keydown\", this.onKeyDown);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"keydown\", this.onKeyDown);\n  }\n\n  onKeyDown(e) {\n    if (this.props.closable && e.key === \"Escape\") {\n      this.props.onClose();\n    }\n  }\n\n  onContainerClicked = e => {\n    if (this.props.closable && e.currentTarget === e.target) {\n      this.props.onClose();\n    }\n  };\n\n  render() {\n    return (\n      <div className={classNames(\"dialog-overlay\", this.props.className)}>\n        <div className=\"dialog\" onClick={this.onContainerClicked}>\n          <div className={`dialog__box ${this.props.wide ? \"dialog__wide\" : \"\"} `}>\n            <div\n              className={classNames(\n                \"dialog__box__contents\",\n                this.props.allowOverflow ? \"dialog__box__contents-overflow\" : null,\n                this.props.additionalClass\n              )}\n            >\n              {this.props.closable &&\n                this.props.onClose && (\n                  <WithHoverSound>\n                    <button className=\"dialog__box__contents__close\" onClick={() => this.props.onClose()}>\n                      <i>\n                        <FontAwesomeIcon icon={faTimes} />\n                      </i>\n                    </button>\n                  </WithHoverSound>\n                )}\n              {this.props.title && <div className=\"dialog__box__contents__title\">{this.props.title}</div>}\n              <div className=\"dialog__box__contents__body\">{this.props.children}</div>\n              <div className=\"dialog__box__contents__button-container\" />\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","module.exports = {\n  COLLISION_LAYERS: {\n    ALL: -1,\n    NONE: 0,\n    INTERACTABLES: 1,\n    ENVIRONMENT: 2,\n    AVATAR: 4,\n    HANDS: 8,\n    DEFAULT_INTERACTABLE: 1 | 2 | 4 | 8,\n    UNOWNED_INTERACTABLE: 1 | 8,\n    DEFAULT_SPAWNER: 1 | 8\n  }\n};\n","import { SOUND_TOGGLE_MIC } from \"../systems/sound-effects-system\";\n\nconst bindAllEvents = function(elements, events, f) {\n  if (!elements || !elements.length) return;\n  for (const el of elements) {\n    events.length &&\n      events.forEach(e => {\n        el.addEventListener(e, f);\n      });\n  }\n};\nconst unbindAllEvents = function(elements, events, f) {\n  if (!elements || !elements.length) return;\n  for (const el of elements) {\n    events.length &&\n      events.forEach(e => {\n        el.removeEventListener(e, f);\n      });\n  }\n};\n\n/**\n * Toggles the microphone on the current network connection based on the given events.\n * @namespace network\n * @component mute-mic\n */\nAFRAME.registerComponent(\"mute-mic\", {\n  schema: {\n    eventSrc: { type: \"selectorAll\" },\n    toggleEvents: { type: \"array\" },\n    muteEvents: { type: \"array\" },\n    unmuteEvents: { type: \"array\" }\n  },\n  init: function() {\n    this.onToggle = this.onToggle.bind(this);\n    this.onMute = this.onMute.bind(this);\n    this.onUnmute = this.onUnmute.bind(this);\n  },\n\n  play: function() {\n    const { eventSrc, toggleEvents, muteEvents, unmuteEvents } = this.data;\n    bindAllEvents(eventSrc, toggleEvents, this.onToggle);\n    bindAllEvents(eventSrc, muteEvents, this.onMute);\n    bindAllEvents(eventSrc, unmuteEvents, this.onUnmute);\n  },\n\n  pause: function() {\n    const { eventSrc, toggleEvents, muteEvents, unmuteEvents } = this.data;\n    unbindAllEvents(eventSrc, toggleEvents, this.onToggle);\n    unbindAllEvents(eventSrc, muteEvents, this.onMute);\n    unbindAllEvents(eventSrc, unmuteEvents, this.onUnmute);\n  },\n\n  onToggle: function() {\n    if (!NAF.connection.adapter) return;\n    if (!this.el.sceneEl.is(\"entered\")) return;\n\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_TOGGLE_MIC);\n    if (this.el.is(\"muted\")) {\n      NAF.connection.adapter.enableMicrophone(true);\n      this.el.removeState(\"muted\");\n    } else {\n      NAF.connection.adapter.enableMicrophone(false);\n      this.el.addState(\"muted\");\n    }\n  },\n\n  onMute: function() {\n    if (!NAF.connection.adapter) return;\n    if (!this.el.is(\"muted\")) {\n      NAF.connection.adapter.enableMicrophone(false);\n      this.el.addState(\"muted\");\n    }\n  },\n\n  onUnmute: function() {\n    if (this.el.is(\"muted\")) {\n      NAF.connection.adapter.enableMicrophone(true);\n      this.el.removeState(\"muted\");\n    }\n  }\n});\n","import { SOUND_TOGGLE_MIC } from \"../systems/sound-effects-system\";\n\nconst bindAllEvents = function(elements, events, f) {\n  if (!elements || !elements.length) return;\n  for (const el of elements) {\n    events.length &&\n      events.forEach(e => {\n        el.addEventListener(e, f);\n      });\n  }\n};\nconst unbindAllEvents = function(elements, events, f) {\n  if (!elements || !elements.length) return;\n  for (const el of elements) {\n    events.length &&\n      events.forEach(e => {\n        el.removeEventListener(e, f);\n      });\n  }\n};\n\n/**\n * Toggles the microphone on the current network connection based on the given events.\n * @namespace network\n * @component toggle-megaphone\n */\nAFRAME.registerComponent(\"toggle-megaphone\", {\n  schema: {\n    eventSrc: { type: \"selectorAll\" },\n    toggleEvents: { type: \"array\" },\n    enableEvents: { type: \"array\" },\n    disableEvents: { type: \"array\" }\n  },\n  init: function() {\n    this.onToggle = this.onToggle.bind(this);\n    this.onEnable = this.onEnable.bind(this);\n    this.onDisable = this.onDisable.bind(this);\n  },\n\n  play: function() {\n    const { eventSrc, toggleEvents, enableEvents, disableEvents } = this.data;\n    bindAllEvents(eventSrc, toggleEvents, this.onToggle);\n    bindAllEvents(eventSrc, enableEvents, this.onEnable);\n    bindAllEvents(eventSrc, disableEvents, this.onDisable);\n  },\n\n  pause: function() {\nconst { eventSrc, toggleEvents, enableEvents, disableEvents } = this.data;\n    unbindAllEvents(eventSrc, toggleEvents, this.onToggle);\n    unbindAllEvents(eventSrc, enableEvents, this.onEnable);\n    unbindAllEvents(eventSrc, disableEvents, this.onDisable);\n  },\n\n  onToggle: function() {\n    if (!NAF.connection.adapter) return;\n    if (!this.el.sceneEl.is(\"entered\")) return;\n\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_TOGGLE_MIC);\n    if (this.el.is(\"megaphoneEnabled\")) {\n      // NAF.connection.adapter.enableMegaphone(true);\n      this.el.removeState(\"megaphoneEnabled\");\n    } else {\n      // NAF.connection.adapter.enableMegaphone(false);\n      this.el.addState(\"megaphoneEnabled\");\n    }\n  },\n\n  onEnable: function() {\n    if (!NAF.connection.adapter) return;\n    if (!this.el.is(\"megaphoneEnabled\")) {\n      // NAF.connection.adapter.enableMegaphone(false);\n      this.el.addState(\"megaphoneEnabled\");\n    }\n  },\n\n  onDisable: function() {\n    if (this.el.is(\"megaphoneEnabled\")) {\n      // NAF.connection.adapter.enableMegaphone(true);\n      this.el.removeState(\"megaphoneEnabled\");\n    }\n  }\n});\n","import { SOUND_TOGGLE_FLYING } from \"../systems/sound-effects-system\";\n\nconst bindAllEvents = function(elements, events, f) {\n  if (!elements || !elements.length) return;\n  for (const el of elements) {\n    events.length &&\n      events.forEach(e => {\n        el.addEventListener(e, f);\n      });\n  }\n};\nconst unbindAllEvents = function(elements, events, f) {\n  if (!elements || !elements.length) return;\n  for (const el of elements) {\n    events.length &&\n      events.forEach(e => {\n        el.removeEventListener(e, f);\n      });\n  }\n};\n\n/**\n * Toggles flying.\n * @namespace network\n * @component toggle-flying\n */\nAFRAME.registerComponent(\"toggle-flying\", {\n  schema: {\n    eventSrc: { type: \"selectorAll\" },\n    toggleEvents: { type: \"array\" },\n    // flyingEvents: { type: \"array\" },\n  },\n  init: function() {\n    this.onToggle = this.onToggle.bind(this);\n    // this.onFlying = this.onFlying.bind(this);\n  },\n\n  play: function() {\n    const { eventSrc, toggleEvents } = this.data;\n    bindAllEvents(eventSrc, toggleEvents, this.onToggle);\n   // bindAllEvents(eventSrc, flyingEvents, this.onFlying);\n    \n  },\n\n  pause: function() {\n    const { eventSrc, toggleEvents } = this.data;\n    unbindAllEvents(eventSrc, toggleEvents, this.onToggle);\n    // unbindAllEvents(eventSrc, flyingEvents, this.onFlying);\n  },\n\n  onToggle: function() {\n    if (!this.el.sceneEl.is(\"entered\")) return;\n\n    // this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_TOGGLE_MIC);\n    if (this.el.is(\"flying\")) {\n      this.el.removeState(\"flying\");\n    } else {\n      this.el.addState(\"flying\");\n    }\n  },\n\n  // onFlying: function() {\n  //   if (!this.el.is(\"flying\")) {  \n  //     this.el.addState(\"flying\");\n  //   } else {\n  //     this.el.removeState(\"flying\");\n  //   }\n  // },\n});\n","import { SOUND_SPAWN_PEN } from \"../systems/sound-effects-system\";\n/**\n * HUD panel for muting, freezing, and other controls that don't necessarily have hardware buttons.\n * @namespace ui\n * @component in-world-hud\n */\nAFRAME.registerComponent(\"in-world-hud\", {\n  init() {\n    this.mic = this.el.querySelector(\".mic\");\n    this.spawn = this.el.querySelector(\".spawn\");\n    // this.pen = this.el.querySelector(\".penhud\");\n    this.cameraBtn = this.el.querySelector(\".camera-btn\");\n    this.inviteBtn = this.el.querySelector(\".invite-btn\");\n    this.background = this.el.querySelector(\".bg\");\n    this.flyBtn = this.el.querySelector(\".fly-btn\");\n    this.megaphoneBtn = this.el.querySelector(\".megaphone-btn\");\n\n\n    this.updateButtonStates = () => {\n      this.mic.setAttribute(\"mic-button\", \"active\", this.el.sceneEl.is(\"muted\"));\n      // this.pen.setAttribute(\"icon-button\", \"active\", this.el.sceneEl.is(\"pen\"));\n      this.cameraBtn.setAttribute(\"icon-button\", \"active\", this.el.sceneEl.is(\"camera\"));\n      this.flyBtn.setAttribute(\"icon-button\", \"active\", this.el.sceneEl.is(\"flying\"));\n      this.megaphoneBtn.setAttribute(\"icon-button\", \"active\", this.el.sceneEl.is(\"megaphoneEnabled\"));\n\n      if (window.APP.hubChannel) {\n        const isAdmin = window.APP.hubChannel.canOrWillIfCreator(\"update_hub\")\n        if (!isAdmin) this.megaphoneBtn.setAttribute(\"visible\", false);\n        this.spawn.setAttribute(\"icon-button\", \"disabled\", !window.APP.hubChannel.can(\"spawn_and_move_media\"));\n        // this.pen.setAttribute(\"icon-button\", \"disabled\", !window.APP.hubChannel.can(\"spawn_drawing\"));\n        this.cameraBtn.setAttribute(\"icon-button\", \"disabled\", !window.APP.hubChannel.can(\"spawn_camera\"));\n      }\n\n    };\n    this.updateButtonStates();\n\n    this.onStateChange = evt => {\n      if (!(evt.detail === \"muted\" || evt.detail === \"frozen\" || evt.detail === \"pen\" || evt.detail === \"camera\" || evt.detail === \"flying\" || evt.detail === \"megaphoneEnabled\"))\n        return;\n      this.updateButtonStates();\n    };\n\n    this.onMegaphoneClick = () => {\n      this.el.emit(\"action_megaphone\");\n      const playerRig = document.querySelector(\"#player-rig\");\n      const enabled = playerRig.getAttribute(\"player-info\").megaphoneEnabled;\n      playerRig.setAttribute(\"player-info\", \"megaphoneEnabled\", !enabled);  \n    }\n\n    this.onMicClick = () => {\n      this.el.emit(\"action_mute\");\n    };\n\n    this.onSpawnClick = () => {\n      if (!window.APP.hubChannel.can(\"spawn_and_move_media\")) return;\n      this.el.emit(\"action_spawn\");\n    };\n\n    this.onPenClick = () => {\n      if (!window.APP.hubChannel.can(\"spawn_drawing\")) return;\n      this.el.emit(\"spawn_pen\");\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SPAWN_PEN);\n    };\n\n    this.onCameraClick = () => {\n      if (!window.APP.hubChannel.can(\"spawn_camera\")) return;\n      this.el.emit(\"action_toggle_camera\");\n    };\n\n    this.onFlyClick = () => {\n      this.el.emit(\"action_fly\");\n      const playerRig = document.querySelector(\"#player-rig\");\n      const enabled = playerRig.getAttribute(\"character-controller\", \"fly\").fly;\n      playerRig.setAttribute(\"character-controller\", \"fly\", !enabled);  \n    };\n\n    this.onInviteClick = () => {\n      this.el.emit(\"action_invite\");\n    };\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateChange);\n    this.el.sceneEl.systems.permissions.onPermissionsUpdated(this.updateButtonStates);\n\n    this.mic.object3D.addEventListener(\"interact\", this.onMicClick);\n    this.spawn.object3D.addEventListener(\"interact\", this.onSpawnClick);\n    // this.pen.object3D.addEventListener(\"interact\", this.onPenClick);\n    this.cameraBtn.object3D.addEventListener(\"interact\", this.onCameraClick);\n    this.flyBtn.object3D.addEventListener(\"interact\", this.onFlyClick);\n    this.megaphoneBtn.object3D.addEventListener(\"interact\", this.onMegaphoneClick);\n    this.inviteBtn.object3D.addEventListener(\"interact\", this.onInviteClick);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateChange);\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.updateButtonStates);\n\n    this.mic.object3D.removeEventListener(\"interact\", this.onMicClick);\n    this.spawn.object3D.removeEventListener(\"interact\", this.onSpawnClick);\n    // this.pen.object3D.removeEventListener(\"interact\", this.onPenClick);\n    this.cameraBtn.object3D.removeEventListener(\"interact\", this.onCameraClick);\n    this.flyBtn.object3D.removeEventListener(\"interact\", this.onFlyClick);\n    this.megaphoneBtn.object3D.removeEventListener(\"interact\", this.onMegaphoneClick);\n    this.inviteBtn.object3D.removeEventListener(\"interact\", this.onInviteClick);\n  }\n});\n","import nipplejs from \"nipplejs\";\nimport styles from \"./virtual-gamepad-controls.css\";\n\n/**\n * Instantiates 2D virtual gamepads and emits associated events.\n * @namespace user-input\n * @component virtual-gamepad-controls\n */\nAFRAME.registerComponent(\"virtual-gamepad-controls\", {\n  schema: {},\n\n  init() {\n    this.onEnterVr = this.onEnterVr.bind(this);\n    this.onExitVr = this.onExitVr.bind(this);\n    this.onFirstInteraction = this.onFirstInteraction.bind(this);\n    this.onMoveJoystickChanged = this.onMoveJoystickChanged.bind(this);\n    this.onMoveJoystickEnd = this.onMoveJoystickEnd.bind(this);\n    this.onLookJoystickChanged = this.onLookJoystickChanged.bind(this);\n    this.onLookJoystickEnd = this.onLookJoystickEnd.bind(this);\n\n    this.mockJoystickContainer = document.createElement(\"div\");\n    this.mockJoystickContainer.classList.add(styles.mockJoystickContainer);\n    const leftMock = document.createElement(\"div\");\n    leftMock.classList.add(styles.mockJoystick);\n    const leftMockSmall = document.createElement(\"div\");\n    leftMockSmall.classList.add(styles.mockJoystick, styles.inner);\n    leftMock.appendChild(leftMockSmall);\n    this.mockJoystickContainer.appendChild(leftMock);\n    const rightMock = document.createElement(\"div\");\n    rightMock.classList.add(styles.mockJoystick);\n    const rightMockSmall = document.createElement(\"div\");\n    rightMockSmall.classList.add(styles.mockJoystick, styles.inner);\n    rightMock.appendChild(rightMockSmall);\n    this.mockJoystickContainer.appendChild(rightMock);\n    document.body.appendChild(this.mockJoystickContainer);\n\n    // Setup gamepad elements\n    const leftTouchZone = document.createElement(\"div\");\n    leftTouchZone.classList.add(styles.touchZone, styles.left);\n    document.body.appendChild(leftTouchZone);\n\n    this.leftTouchZone = leftTouchZone;\n\n    this.leftStick = nipplejs.create({\n      zone: this.leftTouchZone,\n      color: \"white\",\n      fadeTime: 0\n    });\n\n    this.leftStick.on(\"start\", this.onFirstInteraction);\n    this.leftStick.on(\"move\", this.onMoveJoystickChanged);\n    this.leftStick.on(\"end\", this.onMoveJoystickEnd);\n\n    const rightTouchZone = document.createElement(\"div\");\n    rightTouchZone.classList.add(styles.touchZone, styles.right);\n    document.body.appendChild(rightTouchZone);\n\n    this.rightTouchZone = rightTouchZone;\n\n    this.rightStick = nipplejs.create({\n      zone: this.rightTouchZone,\n      color: \"white\",\n      fadeTime: 0\n    });\n\n    this.rightStick.on(\"start\", this.onFirstInteraction);\n    this.rightStick.on(\"move\", this.onLookJoystickChanged);\n    this.rightStick.on(\"end\", this.onLookJoystickEnd);\n\n    this.inVr = false;\n    this.moving = false;\n    this.rotating = false;\n\n    this.moveEvent = {\n      axis: [0, 0]\n    };\n    this.rotateYEvent = {\n      value: 0\n    };\n    this.rotateXEvent = {\n      value: 0\n    };\n\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.onEnterVr);\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.onExitVr);\n  },\n\n  onFirstInteraction() {\n    this.leftStick.off(\"start\", this.onFirstInteraction);\n    this.rightStick.off(\"start\", this.onFirstInteraction);\n    document.body.removeChild(this.mockJoystickContainer);\n  },\n\n  onMoveJoystickChanged(event, joystick) {\n    const angle = joystick.angle.radian;\n    const force = joystick.force < 1 ? joystick.force : 1;\n    const moveStrength = 1.85;\n    const x = Math.cos(angle) * force * moveStrength;\n    const z = Math.sin(angle) * force * moveStrength;\n    this.moving = true;\n    this.moveEvent.axis[0] = x;\n    this.moveEvent.axis[1] = z;\n  },\n\n  onMoveJoystickEnd() {\n    this.moving = false;\n    this.moveEvent.axis[0] = 0;\n    this.moveEvent.axis[1] = 0;\n    this.el.sceneEl.emit(\"move\", this.moveEvent);\n  },\n\n  onLookJoystickChanged(event, joystick) {\n    // Set pitch and yaw angles on right stick move\n    const angle = joystick.angle.radian;\n    const force = joystick.force < 1 ? joystick.force : 1;\n    const turnStrength = 0.5;\n    this.rotating = true;\n    this.rotateYEvent.value = Math.cos(angle) * force * turnStrength;\n    this.rotateXEvent.value = Math.sin(angle) * force * turnStrength;\n  },\n\n  onLookJoystickEnd() {\n    this.rotating = false;\n    this.rotateYEvent.value = 0;\n    this.rotateXEvent.value = 0;\n    this.el.sceneEl.emit(\"rotateY\", this.rotateYEvent);\n    this.el.sceneEl.emit(\"rotateX\", this.rotateXEvent);\n  },\n\n  tick() {\n    if (!this.inVr) {\n      if (this.moving) {\n        this.el.sceneEl.emit(\"move\", this.moveEvent);\n      }\n\n      if (this.rotating) {\n        this.el.sceneEl.emit(\"rotateY\", this.rotateYEvent);\n        this.el.sceneEl.emit(\"rotateX\", this.rotateXEvent);\n      }\n    }\n  },\n\n  onEnterVr() {\n    // Hide the joystick controls\n    this.inVr = true;\n    this.leftTouchZone.style.display = \"none\";\n    this.rightTouchZone.style.display = \"none\";\n  },\n\n  onExitVr() {\n    // Show the joystick controls\n    this.inVr = false;\n    this.leftTouchZone.style.display = \"block\";\n    this.rightTouchZone.style.display = \"block\";\n  },\n\n  remove() {\n    this.el.sceneEl.removeEventListener(\"entervr\", this.onEnterVr);\n    this.el.sceneEl.removeEventListener(\"exitvr\", this.onExitVr);\n    document.body.removeChild(this.mockJoystickContainer);\n    document.body.removeChild(this.leftTouchZone);\n    document.body.removeChild(this.rightTouchZone);\n  }\n});\n","const { Vector3, Quaternion, Matrix4, Euler } = THREE;\n\nimport { AVATAR_TYPES } from \"../utils/avatar-utils\";\n\nfunction quaternionAlmostEquals(epsilon, u, v) {\n  // Note: q and -q represent same rotation\n  return (\n    (Math.abs(u.x - v.x) < epsilon &&\n      Math.abs(u.y - v.y) < epsilon &&\n      Math.abs(u.z - v.z) < epsilon &&\n      Math.abs(u.w - v.w) < epsilon) ||\n    (Math.abs(-u.x - v.x) < epsilon &&\n      Math.abs(-u.y - v.y) < epsilon &&\n      Math.abs(-u.z - v.z) < epsilon &&\n      Math.abs(-u.w - v.w) < epsilon)\n  );\n}\n\n/**\n * Provides access to the end effectors for IK.\n * @namespace avatar\n * @component ik-root\n */\nAFRAME.registerComponent(\"ik-root\", {\n  schema: {\n    camera: { type: \"string\", default: \".camera\" },\n    leftController: { type: \"string\", default: \".left-controller\" },\n    rightController: { type: \"string\", default: \".right-controller\" }\n  },\n  update(oldData) {\n    if (this.data.camera !== oldData.camera) {\n      this.camera = this.el.querySelector(this.data.camera);\n    }\n\n    if (this.data.leftController !== oldData.leftController) {\n      this.leftController = this.el.querySelector(this.data.leftController);\n    }\n\n    if (this.data.rightController !== oldData.rightController) {\n      this.rightController = this.el.querySelector(this.data.rightController);\n    }\n  }\n});\n\nfunction findIKRoot(entity) {\n  while (entity && !(entity.components && entity.components[\"ik-root\"])) {\n    entity = entity.parentNode;\n  }\n  return entity && entity.components[\"ik-root\"];\n}\n\nconst LEGACY_HAND_ROTATIONS = {\n  left: new Matrix4().makeRotationFromEuler(new Euler(-Math.PI / 2, Math.PI / 2, 0)),\n  right: new Matrix4().makeRotationFromEuler(new Euler(Math.PI / 2, Math.PI / 2, 0))\n};\n\nconst HAND_ROTATIONS = {\n  left: new Matrix4().makeRotationFromEuler(new Euler(-Math.PI / 2, Math.PI / 2, 0)),\n  right: new Matrix4().makeRotationFromEuler(new Euler(-Math.PI / 2, -Math.PI / 2, 0))\n};\n\n/**\n * Performs IK on a hip-rooted skeleton to align the hip, head and hands with camera and controller inputs.\n * @namespace avatar\n * @component ik-controller\n */\nAFRAME.registerComponent(\"ik-controller\", {\n  schema: {\n    leftEye: { type: \"string\", default: \"LeftEye\" },\n    rightEye: { type: \"string\", default: \"RightEye\" },\n    head: { type: \"string\", default: \"Head\" },\n    neck: { type: \"string\", default: \"Neck\" },\n    leftHand: { type: \"string\", default: \"LeftHand\" },\n    rightHand: { type: \"string\", default: \"RightHand\" },\n    chest: { type: \"string\", default: \"Spine\" },\n    hips: { type: \"string\", default: \"Hips\" },\n    rotationSpeed: { default: 5 },\n    alwaysUpdate: { type: \"boolean\", default: false }\n  },\n\n  init() {\n    this._runScheduledWork = this._runScheduledWork.bind(this);\n    this._updateIsInView = this._updateIsInView.bind(this);\n\n    this.flipY = new Matrix4().makeRotationY(Math.PI);\n\n    this.cameraForward = new Matrix4();\n    this.headTransform = new Matrix4();\n    this.hipsPosition = new Vector3();\n\n    this.invHipsToHeadVector = new Vector3();\n\n    this.middleEyeMatrix = new Matrix4();\n    this.middleEyePosition = new Vector3();\n    this.invMiddleEyeToHead = new Matrix4();\n\n    this.cameraYRotation = new Euler();\n    this.cameraYQuaternion = new Quaternion();\n\n    this.invHipsQuaternion = new Quaternion();\n    this.headQuaternion = new Quaternion();\n\n    this.rootToChest = new Matrix4();\n    this.invRootToChest = new Matrix4();\n\n    this.ikRoot = findIKRoot(this.el);\n\n    this.isInView = true;\n    this.hasConvergedHips = false;\n    this.lastCameraTransform = new THREE.Matrix4();\n    this.playerCamera = document.querySelector(\"#player-camera\").getObject3D(\"camera\");\n\n    this.el.sceneEl.systems[\"frame-scheduler\"].schedule(this._runScheduledWork, \"ik\");\n  },\n\n  remove() {\n    this.el.sceneEl.systems[\"frame-scheduler\"].unschedule(this._runScheduledWork, \"ik\");\n  },\n\n  update(oldData) {\n    if (this.data.leftEye !== oldData.leftEye) {\n      this.leftEye = this.el.object3D.getObjectByName(this.data.leftEye);\n    }\n\n    if (this.data.rightEye !== oldData.rightEye) {\n      this.rightEye = this.el.object3D.getObjectByName(this.data.rightEye);\n    }\n\n    if (this.data.head !== oldData.head) {\n      this.head = this.el.object3D.getObjectByName(this.data.head);\n    }\n\n    if (this.data.neck !== oldData.neck) {\n      this.neck = this.el.object3D.getObjectByName(this.data.neck);\n    }\n\n    if (this.data.leftHand !== oldData.leftHand) {\n      this.leftHand = this.el.object3D.getObjectByName(this.data.leftHand);\n    }\n\n    if (this.data.rightHand !== oldData.rightHand) {\n      this.rightHand = this.el.object3D.getObjectByName(this.data.rightHand);\n    }\n\n    if (this.data.chest !== oldData.chest) {\n      this.chest = this.el.object3D.getObjectByName(this.data.chest);\n    }\n\n    if (this.data.hips !== oldData.hips) {\n      this.hips = this.el.object3D.getObjectByName(this.data.hips);\n    }\n\n    // Set middleEye's position to be right in the middle of the left and right eyes.\n    this.middleEyePosition.addVectors(this.leftEye.position, this.rightEye.position);\n    this.middleEyePosition.divideScalar(2);\n    this.middleEyeMatrix.makeTranslation(this.middleEyePosition.x, this.middleEyePosition.y, this.middleEyePosition.z);\n    this.invMiddleEyeToHead = this.middleEyeMatrix.getInverse(this.middleEyeMatrix);\n\n    this.invHipsToHeadVector\n      .addVectors(this.chest.position, this.neck.position)\n      .add(this.head.position)\n      .negate();\n  },\n\n  tick(time, dt) {\n    if (!this.ikRoot) {\n      return;\n    }\n\n    const root = this.ikRoot.el.object3D;\n    const { camera, leftController, rightController } = this.ikRoot;\n\n    camera.object3D.updateMatrix();\n\n    const hasNewCameraTransform = !this.lastCameraTransform.equals(camera.object3D.matrix);\n\n    // Optimization: if the camera hasn't moved and the hips converged to the target orientation on a previous frame,\n    // then the avatar does not need any IK this frame.\n    //\n    // Update in-view avatars every frame, and update out-of-view avatars via frame scheduler.\n    if (\n      this.data.alwaysUpdate ||\n      this.forceIkUpdate ||\n      (this.isInView && (hasNewCameraTransform || !this.hasConvergedHips))\n    ) {\n      if (hasNewCameraTransform) {\n        this.lastCameraTransform.copy(camera.object3D.matrix);\n      }\n\n      const {\n        hips,\n        head,\n        neck,\n        chest,\n        cameraForward,\n        headTransform,\n        invMiddleEyeToHead,\n        invHipsToHeadVector,\n        flipY,\n        cameraYRotation,\n        cameraYQuaternion,\n        invHipsQuaternion,\n        rootToChest,\n        invRootToChest\n      } = this;\n\n      // Camera faces the -Z direction. Flip it along the Y axis so that it is +Z.\n      cameraForward.multiplyMatrices(camera.object3D.matrix, flipY);\n\n      // Compute the head position such that the hmd position would be in line with the middleEye\n      headTransform.multiplyMatrices(cameraForward, invMiddleEyeToHead);\n\n      // Then position the hips such that the head is aligned with headTransform\n      // (which positions middleEye in line with the hmd)\n      hips.position.setFromMatrixPosition(headTransform).add(invHipsToHeadVector);\n\n      // Animate the hip rotation to follow the Y rotation of the camera with some damping.\n      cameraYRotation.setFromRotationMatrix(cameraForward, \"YXZ\");\n      cameraYRotation.x = 0;\n      cameraYRotation.z = 0;\n      cameraYQuaternion.setFromEuler(cameraYRotation);\n      Quaternion.slerp(hips.quaternion, cameraYQuaternion, hips.quaternion, (this.data.rotationSpeed * dt) / 1000);\n\n      this.hasConvergedHips = quaternionAlmostEquals(0.0001, cameraYQuaternion, hips.quaternion);\n\n      // Take the head orientation computed from the hmd, remove the Y rotation already applied to it by the hips,\n      // and apply it to the head\n      invHipsQuaternion.copy(hips.quaternion).inverse();\n      head.quaternion.setFromRotationMatrix(headTransform).premultiply(invHipsQuaternion);\n\n      hips.updateMatrix();\n      rootToChest.multiplyMatrices(hips.matrix, chest.matrix);\n      invRootToChest.getInverse(rootToChest);\n\n      root.matrixNeedsUpdate = true;\n      neck.matrixNeedsUpdate = true;\n      head.matrixNeedsUpdate = true;\n      chest.matrixNeedsUpdate = true;\n    }\n\n    const { leftHand, rightHand } = this;\n\n    const handRotations =\n      this.ikRoot.el.components[\"player-info\"].data.avatarType === AVATAR_TYPES.LEGACY\n        ? LEGACY_HAND_ROTATIONS\n        : HAND_ROTATIONS;\n    if (leftHand) this.updateHand(handRotations.left, leftHand, leftController.object3D, true, this.isInView);\n    if (rightHand) this.updateHand(handRotations.right, rightHand, rightController.object3D, false, this.isInView);\n    this.forceIkUpdate = false;\n  },\n\n  updateHand(handRotation, handObject3D, controllerObject3D, isLeft, isInView) {\n    const handMatrix = handObject3D.matrix;\n\n    // TODO: This coupling with personal-space-invader is not ideal.\n    // There should be some intermediate thing managing multiple opinions about object visibility\n    const spaceInvader = handObject3D.el.components[\"personal-space-invader\"];\n    const handHiddenByPersonalSpace = spaceInvader && spaceInvader.invading;\n\n    handObject3D.visible = !handHiddenByPersonalSpace && controllerObject3D.visible;\n\n    // Optimization: skip IK update if not in view and not forced by frame scheduler\n    if (controllerObject3D.visible && (isInView || this.forceIkUpdate || this.data.alwaysUpdate)) {\n      handMatrix.multiplyMatrices(this.invRootToChest, controllerObject3D.matrix);\n\n      handMatrix.multiply(handRotation);\n\n      handObject3D.position.setFromMatrixPosition(handMatrix);\n      handObject3D.rotation.setFromRotationMatrix(handMatrix);\n      handObject3D.matrixNeedsUpdate = true;\n    }\n  },\n\n  _runScheduledWork() {\n    // Every scheduled run, we force an IK update on the next frame (so at most one avatar with forced IK per frame)\n    // and also update the this.isInView bit on the avatar which is used to determine if an IK update should be run\n    // every frame.\n    this.forceIkUpdate = true;\n\n    this._updateIsInView();\n  },\n\n  _updateIsInView: (function() {\n    const frustum = new THREE.Frustum();\n    const frustumMatrix = new THREE.Matrix4();\n    const cameraWorld = new THREE.Vector3();\n    const isInViewOfCamera = (screenCamera, pos) => {\n      frustumMatrix.multiplyMatrices(screenCamera.projectionMatrix, screenCamera.matrixWorldInverse);\n      frustum.setFromMatrix(frustumMatrix);\n      return frustum.containsPoint(pos);\n    };\n\n    return function() {\n      const camera = this.ikRoot.camera.object3D;\n      camera.getWorldPosition(cameraWorld);\n\n      this.isInView = isInViewOfCamera(this.playerCamera, cameraWorld);\n    };\n  })()\n});\n","import { paths } from \"../systems/userinput/paths\";\n\nconst POSES = {\n  open: \"open\",\n  point: \"point\",\n  fist: \"fist\",\n  hold: \"hold\",\n  thumbUp: \"thumbUp\",\n  thumbDown: \"thumbDown\",\n  indexDown: \"indexDown\",\n  pinch: \"pinch\",\n  mrpDown: \"mrpDown\"\n};\n\n/**\n * Emits events indicating that avatar hands should be posed differently.\n * @namespace user-input\n * @component hand-controls2\n */\nAFRAME.registerComponent(\"hand-controls2\", {\n  schema: { default: \"left\" },\n\n  init() {\n    this.pose = POSES.open;\n  },\n\n  poseForFingers(thumb, index, middleRingPinky) {\n    if (!thumb && !index && !middleRingPinky) {\n      return POSES.open;\n    } else if (thumb && index && middleRingPinky) {\n      return POSES.fist;\n    } else if (!thumb && index && middleRingPinky) {\n      return POSES.thumbUp;\n    } else if (!thumb && !index && middleRingPinky) {\n      return POSES.mrpDown;\n    } else if (!thumb && index && !middleRingPinky) {\n      return POSES.indexDown;\n    } else if (thumb && !index && !middleRingPinky) {\n      return POSES.thumbDown;\n    } else if (thumb && index && !middleRingPinky) {\n      return POSES.pinch;\n    } else if (thumb && !index && middleRingPinky) {\n      return POSES.point;\n    }\n\n    console.warn(`Did not find matching pose for thumb ${thumb}, index ${index}, middleRingPinky ${middleRingPinky}`);\n    return POSES.open;\n  },\n\n  tick() {\n    const hand = this.data;\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const subpath = hand === \"left\" ? paths.actions.leftHand : paths.actions.rightHand;\n    const thumb = userinput.get(subpath.thumb);\n    const index = userinput.get(subpath.index);\n    const middleRingPinky = userinput.get(subpath.middleRingPinky);\n    const pose = this.poseForFingers(thumb, index, middleRingPinky);\n    if (pose !== this.pose) {\n      this.el.emit(\"hand-pose\", { previous: this.pose, current: pose });\n      this.pose = pose;\n    }\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\nimport { SOUND_SNAP_ROTATE } from \"../systems/sound-effects-system\";\nconst CLAMP_VELOCITY = 0.01;\nconst MAX_DELTA = 0.2;\nconst EPS = 10e-6;\nconst MAX_WARNINGS = 10;\n\nconst NAV_ZONE = \"character\";\n\n/**\n * Avatar movement controller that listens to move, rotate and teleportation events and moves the avatar accordingly.\n * The controller accounts for playspace offset and orientation and depends on the nav mesh system for translation.\n * @namespace avatar\n * @component character-controller\n */\nAFRAME.registerComponent(\"character-controller\", {\n  schema: {\n    groundAcc: { default: 5.5 },\n    easing: { default: 10 },\n    pivot: { type: \"selector\" },\n    snapRotationDegrees: { default: THREE.Math.DEG2RAD * 45 },\n    rotationSpeed: { default: -3 },\n    fly: { default: false }\n  },\n\n  init: function() {\n    this.navGroup = null;\n    this.navNode = null;\n    this.velocity = new THREE.Vector3(0, 0, 0);\n    this.accelerationInput = new THREE.Vector3(0, 0, 0);\n    this.pendingSnapRotationMatrix = new THREE.Matrix4();\n    this.angularVelocity = 0; // Scalar value because we only allow rotation around Y\n    this._withinWarningLimit = true;\n    this._warningCount = 0;\n    this.setAccelerationInput = this.setAccelerationInput.bind(this);\n    this.snapRotateLeft = this.snapRotateLeft.bind(this);\n    this.snapRotateRight = this.snapRotateRight.bind(this);\n    this.setAngularVelocity = this.setAngularVelocity.bind(this);\n    this.el.sceneEl.addEventListener(\"nav-mesh-loaded\", () => {\n      this.navGroup = null;\n      this.navNode = null;\n    });\n  },\n\n  update: function() {\n    this.leftRotationMatrix = new THREE.Matrix4().makeRotationY(this.data.snapRotationDegrees);\n    this.rightRotationMatrix = new THREE.Matrix4().makeRotationY(-this.data.snapRotationDegrees);\n  },\n\n  play: function() {\n    const eventSrc = this.el.sceneEl;\n    eventSrc.addEventListener(\"move\", this.setAccelerationInput);\n    eventSrc.addEventListener(\"rotateY\", this.setAngularVelocity);\n  },\n\n  pause: function() {\n    const eventSrc = this.el.sceneEl;\n    eventSrc.removeEventListener(\"move\", this.setAccelerationInput);\n    eventSrc.removeEventListener(\"rotateY\", this.setAngularVelocity);\n    this.reset();\n  },\n\n  reset() {\n    this.accelerationInput.set(0, 0, 0);\n    this.velocity.set(0, 0, 0);\n    this.angularVelocity = 0;\n    this.pendingSnapRotationMatrix.identity();\n  },\n\n  setAccelerationInput: function(event) {\n    const axes = event.detail.axis;\n    this.accelerationInput.set(axes[0], 0, axes[1]);\n  },\n\n  setAngularVelocity: function(event) {\n    this.angularVelocity = event.detail.value;\n  },\n\n  snapRotateLeft: function() {\n    this.pendingSnapRotationMatrix.copy(this.leftRotationMatrix);\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SNAP_ROTATE);\n  },\n\n  snapRotateRight: function() {\n    this.pendingSnapRotationMatrix.copy(this.rightRotationMatrix);\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SNAP_ROTATE);\n  },\n\n  // We assume the rig is at the root, and its local position === its world position.\n  teleportTo: (function() {\n    const rig = new THREE.Vector3();\n    const head = new THREE.Vector3();\n    const deltaFromHeadToTargetForHead = new THREE.Vector3();\n    const targetForHead = new THREE.Vector3();\n    const targetForRig = new THREE.Vector3();\n    return function teleportTo(targetWorldPosition) {\n      const o = this.el.object3D;\n      o.getWorldPosition(rig);\n      this.data.pivot.object3D.getWorldPosition(head);\n      targetForHead.copy(targetWorldPosition);\n      targetForHead.y += this.data.pivot.object3D.position.y;\n      deltaFromHeadToTargetForHead.copy(targetForHead).sub(head);\n      targetForRig.copy(rig).add(deltaFromHeadToTargetForHead);\n\n      const pathfinder = this.el.sceneEl.systems.nav.pathfinder;\n      this.navGroup = pathfinder.getGroup(NAV_ZONE, targetForRig, true, true);\n      this.navNode = null;\n      this._setNavNode(targetForRig);\n      pathfinder.clampStep(rig, targetForRig, this.navNode, NAV_ZONE, this.navGroup, o.position);\n      o.matrixNeedsUpdate = true;\n    };\n  })(),\n\n  tick: (function() {\n    const move = new THREE.Matrix4();\n    const trans = new THREE.Matrix4();\n    const transInv = new THREE.Matrix4();\n    const pivotPos = new THREE.Vector3();\n    const rotationAxis = new THREE.Vector3(0, 1, 0);\n    const yawMatrix = new THREE.Matrix4();\n    const rotationMatrix = new THREE.Matrix4();\n    const rotationInvMatrix = new THREE.Matrix4();\n    const pivotRotationMatrix = new THREE.Matrix4();\n    const pivotRotationInvMatrix = new THREE.Matrix4();\n    const startPos = new THREE.Vector3();\n    const startScale = new THREE.Vector3();\n\n    return function(t, dt) {\n      if (!this.el.sceneEl.is(\"entered\")) return;\n      const deltaSeconds = dt / 1000;\n      const root = this.el.object3D;\n      const pivot = this.data.pivot.object3D;\n      const distance = this.data.groundAcc * deltaSeconds;\n\n      const userinput = AFRAME.scenes[0].systems.userinput;\n      const userinputAngularVelocity = userinput.get(paths.actions.angularVelocity);\n      if (userinputAngularVelocity !== null && userinputAngularVelocity !== undefined) {\n        this.angularVelocity = userinputAngularVelocity;\n      }\n      const rotationDelta = this.data.rotationSpeed * this.angularVelocity * deltaSeconds;\n\n      pivot.updateMatrices();\n      root.updateMatrices();\n\n      startScale.copy(root.scale);\n      startPos.copy(root.position);\n\n      if (userinput.get(paths.actions.snapRotateLeft)) {\n        this.snapRotateLeft();\n      }\n      if (userinput.get(paths.actions.snapRotateRight)) {\n        this.snapRotateRight();\n      }\n      const acc = userinput.get(paths.actions.characterAcceleration);\n      if (acc) {\n        this.accelerationInput.set(\n          this.accelerationInput.x + acc[0],\n          this.accelerationInput.y + 0,\n          this.accelerationInput.z + acc[1]\n        );\n      }\n\n      pivotPos.copy(pivot.position);\n      pivotPos.applyMatrix4(root.matrix);\n      trans.setPosition(pivotPos);\n      transInv.makeTranslation(-pivotPos.x, -pivotPos.y, -pivotPos.z);\n      rotationMatrix.makeRotationAxis(rotationAxis, root.rotation.y);\n      rotationInvMatrix.makeRotationAxis(rotationAxis, -root.rotation.y);\n      pivotRotationMatrix.makeRotationAxis(rotationAxis, pivot.rotation.y);\n      pivotRotationInvMatrix.makeRotationAxis(rotationAxis, -pivot.rotation.y);\n      this.updateVelocity(deltaSeconds, pivot);\n      this.accelerationInput.set(0, 0, 0);\n\n      const boost = userinput.get(paths.actions.boost) ? 2 : 1;\n      move.makeTranslation(\n        this.velocity.x * distance * boost,\n        this.velocity.y * distance * boost,\n        this.velocity.z * distance * boost\n      );\n      yawMatrix.makeRotationAxis(rotationAxis, rotationDelta);\n\n      // Translate to middle of playspace (player rig)\n      root.matrix.premultiply(transInv);\n      // Zero playspace (player rig) rotation\n      root.matrix.premultiply(rotationInvMatrix);\n      // Zero pivot (camera/head) rotation\n      root.matrix.premultiply(pivotRotationInvMatrix);\n      // Apply joystick translation\n      root.matrix.premultiply(move);\n      // Apply joystick yaw rotation\n      root.matrix.premultiply(yawMatrix);\n      // Apply snap rotation if necessary\n      root.matrix.premultiply(this.pendingSnapRotationMatrix);\n      // Reapply pivot (camera/head) rotation\n      root.matrix.premultiply(pivotRotationMatrix);\n      // Reapply playspace (player rig) rotation\n      root.matrix.premultiply(rotationMatrix);\n      // Reapply playspace (player rig) translation\n      root.matrix.premultiply(trans);\n      // update pos/rot/scale\n      root.matrix.decompose(root.position, root.quaternion, root.scale);\n\n      // TODO: the above matrix trnsfomraitons introduce some floating point errors in scale, this reverts them to\n      // avoid spamming network with fake scale updates\n      root.scale.copy(startScale);\n\n      this.pendingSnapRotationMatrix.identity(); // Revert to identity\n\n      if (this.velocity.lengthSq() > EPS && !this.data.fly) {\n        this.setPositionOnNavMesh(startPos, root.position, root);\n      }\n\n      root.matrixNeedsUpdate = true;\n    };\n  })(),\n\n  _warnWithWarningLimit: function(msg) {\n    if (!this._withinWarningLimit) return;\n    this._warningCount++;\n    if (this._warningCount > MAX_WARNINGS) {\n      this._withinWarningLimit = false;\n      msg = \"Warning count exceeded. Will not log further warnings\";\n    }\n    console.warn(\"character-controller\", msg);\n  },\n\n  _setNavNode: function(pos) {\n    if (this.navNode !== null) return;\n    const { pathfinder } = this.el.sceneEl.systems.nav;\n    this.navNode =\n      pathfinder.getClosestNode(pos, NAV_ZONE, this.navGroup, true) ||\n      pathfinder.getClosestNode(pos, NAV_ZONE, this.navGroup);\n  },\n\n  setPositionOnNavMesh: function(start, end, object3D) {\n    const { pathfinder } = this.el.sceneEl.systems.nav;\n    if (!(NAV_ZONE in pathfinder.zones)) return;\n    if (this.navGroup === null) {\n      this.navGroup = pathfinder.getGroup(NAV_ZONE, end, true, true);\n    }\n    this._setNavNode(end);\n    this.navNode = pathfinder.clampStep(start, end, this.navNode, NAV_ZONE, this.navGroup, object3D.position);\n    object3D.matrixNeedsUpdate = true;\n  },\n\n  updateVelocity: function(dt, pivot) {\n    const data = this.data;\n    const velocity = this.velocity;\n\n    // If FPS too low, reset velocity.\n    if (dt > MAX_DELTA) {\n      velocity.x = 0;\n      velocity.y = 0;\n      velocity.z = 0;\n      return;\n    }\n\n    // Decay velocity.\n    if (velocity.x !== 0) {\n      velocity.x -= velocity.x * data.easing * dt;\n    }\n    if (velocity.y !== 0) {\n      velocity.y -= velocity.y * data.easing * dt;\n    }\n    if (velocity.z !== 0) {\n      velocity.z -= velocity.z * data.easing * dt;\n    }\n\n    const dvx = data.groundAcc * dt * this.accelerationInput.x;\n    const dvz = data.groundAcc * dt * -this.accelerationInput.z;\n    velocity.x += dvx;\n\n    if (this.data.fly) {\n      velocity.y += dvz * -Math.sin(pivot.rotation.x);\n      velocity.z += dvz * Math.cos(pivot.rotation.x);\n    } else {\n      velocity.z += dvz;\n    }\n\n    const decay = 0.7;\n    this.accelerationInput.x = this.accelerationInput.x * decay;\n    this.accelerationInput.z = this.accelerationInput.z * decay;\n\n    if (Math.abs(velocity.x) < CLAMP_VELOCITY) {\n      velocity.x = 0;\n    }\n    if (Math.abs(velocity.y) < CLAMP_VELOCITY) {\n      velocity.y = 0;\n    }\n    if (Math.abs(velocity.z) < CLAMP_VELOCITY) {\n      velocity.z = 0;\n    }\n  }\n});\n","import { showHoverEffect } from \"../utils/permissions-utils\";\n\n/**\n * Applies effects to a hoverer based on hover state.\n * @namespace interactables\n * @component hover-visuals\n */\nAFRAME.registerComponent(\"hover-visuals\", {\n  schema: {\n    hand: { type: \"string\" }\n  },\n  init() {\n    // uniforms are set from the component responsible for loading the mesh.\n    this.handleLeftVisuals = this.handleLeftVisuals.bind(this);\n    this.handleRightVisuals = this.handleRightVisuals.bind(this);\n    this.hadLeftVisualLastFrame = false;\n    this.hadRightVisualLastFrame = false;\n    this.uniforms = null;\n  },\n  remove() {\n    this.uniforms = null;\n  },\n  tick() {\n    if (!this.uniforms || !this.uniforms.length) return;\n\n    // Push down loops to assist JIT:\n    if (this.data.hand === \"left\") {\n      this.handleLeftVisuals();\n    } else {\n      this.handleRightVisuals();\n    }\n  },\n\n  handleLeftVisuals: function() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const interactingElement = interaction.state.leftHand.held || interaction.state.leftHand.hovered;\n    const hideVisual = !interactingElement || !showHoverEffect(interactingElement);\n\n    // Last frame, we didn't have a visual so no need to update uniforms.\n    if (hideVisual && !this.hadLeftVisualLastFrame) return;\n    this.hadLeftVisualLastFrame = !hideVisual;\n\n    const elements = this.el.object3D.matrixWorld.elements;\n\n    for (let i = 0, l = this.uniforms.length; i < l; i++) {\n      const uniform = this.uniforms[i];\n      uniform.hubs_HighlightInteractorOne.value = !hideVisual;\n      uniform.hubs_InteractorOnePos.value[0] = elements[12];\n      uniform.hubs_InteractorOnePos.value[1] = elements[13];\n      uniform.hubs_InteractorOnePos.value[2] = elements[14];\n    }\n  },\n\n  handleRightVisuals: function() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n\n    const interactingElement = interaction.state.rightHand.held || interaction.state.rightHand.hovered;\n    const hideVisual = !interactingElement || !showHoverEffect(interactingElement);\n\n    // Last frame, we didn't have a visual so no need to update uniforms.\n    if (hideVisual && !this.hadRightVisualLastFrame) return;\n    this.hadRightVisualLastFrame = !hideVisual;\n\n    const elements = this.el.object3D.matrixWorld.elements;\n\n    for (let i = 0, l = this.uniforms.length; i < l; i++) {\n      const uniform = this.uniforms[i];\n      uniform.hubs_HighlightInteractorTwo.value = !hideVisual;\n      uniform.hubs_InteractorTwoPos.value[0] = elements[12];\n      uniform.hubs_InteractorTwoPos.value[1] = elements[13];\n      uniform.hubs_InteractorTwoPos.value[2] = elements[14];\n    }\n  }\n});\n","import { injectCustomShaderChunks } from \"../utils/media-utils\";\nimport { AVATAR_TYPES } from \"../utils/avatar-utils\";\nimport { registerComponentInstance } from \"../utils/component-utils\";\nimport { deregisterComponentInstance } from \"../utils/component-utils\";\nimport {defaultRolloffFactor} from '../everyspace/defaults'\n\nfunction ensureAvatarNodes(json) {\n  const { nodes } = json;\n  if (!nodes.some(node => node.name === \"Head\")) {\n    // If the avatar model doesn't have a Head node. The user has probably chosen a custom GLB.\n    // So, we need to construct a suitable hierarchy for avatar functionality to work.\n    // We re-parent the original root node to the Head node and set the scene root to a new AvatarRoot.\n\n    // Note: We assume that the first node in the primary scene is the one we care about.\n    const originalRoot = json.scenes[json.scene].nodes[0];\n    nodes.push({ name: \"LeftEye\", extensions: { MOZ_hubs_components: {} } });\n    nodes.push({ name: \"RightEye\", extensions: { MOZ_hubs_components: {} } });\n    nodes.push({\n      name: \"Head\",\n      children: [originalRoot, nodes.length - 1, nodes.length - 2],\n      extensions: { MOZ_hubs_components: { \"scale-audio-feedback\": \"\" } }\n    });\n    nodes.push({ name: \"Neck\", children: [nodes.length - 1] });\n    nodes.push({ name: \"Spine\", children: [nodes.length - 1] });\n    nodes.push({ name: \"Hips\", children: [nodes.length - 1] });\n    nodes.push({ name: \"AvatarRoot\", children: [nodes.length - 1] });\n    json.scenes[json.scene].nodes[0] = nodes.length - 1;\n  }\n  return json;\n}\n\n/**\n * Sets player info state, including avatar choice and display name.\n * @namespace avatar\n * @component player-info\n */\nAFRAME.registerComponent(\"player-info\", {\n  schema: {\n    avatarSrc: { type: \"string\" },\n    avatarType: { type: \"string\", default: AVATAR_TYPES.LEGACY },\n    megaphoneEnabled: { default: false }\n  },\n  init() {\n    this.displayName = null;\n    this.communityIdentifier = null;\n    this.isOwner = false;\n    this.isRecording = false;\n    this.applyProperties = this.applyProperties.bind(this);\n    this.updateDisplayName = this.updateDisplayName.bind(this);\n    this.applyDisplayName = this.applyDisplayName.bind(this);\n    this.handleModelError = this.handleModelError.bind(this);\n\n    this.isLocalPlayerInfo = this.el.id === \"player-rig\";\n    this.playerSessionId = null;\n\n    if (!this.isLocalPlayerInfo) {\n      NAF.utils.getNetworkedEntity(this.el).then(networkedEntity => {\n        this.playerSessionId = NAF.utils.getCreator(networkedEntity);\n        const playerPresence = window.APP.hubChannel.presence.state[this.playerSessionId];\n        if (playerPresence) {\n          this.updateDisplayNameFromPresenceMeta(playerPresence.metas[0]);\n        }\n      });\n    }\n    registerComponentInstance(this, \"player-info\");\n  },\n  remove() {\n    deregisterComponentInstance(this, \"player-info\");\n  },\n  play() {\n    this.el.addEventListener(\"model-loaded\", this.applyProperties);\n    this.el.sceneEl.addEventListener(\"presence_updated\", this.updateDisplayName);\n    if (this.isLocalPlayerInfo) {\n      this.el.querySelector(\".model\").addEventListener(\"model-error\", this.handleModelError);\n    }\n  },\n  pause() {\n    this.el.removeEventListener(\"model-loaded\", this.applyProperties);\n    this.el.sceneEl.removeEventListener(\"presence_updated\", this.updateDisplayName);\n    if (this.isLocalPlayerInfo) {\n      this.el.querySelector(\".model\").removeEventListener(\"model-error\", this.handleModelError);\n    }\n  },\n  update() {\n    this.applyProperties();\n  },\n  updateDisplayName(e) {\n    if (!this.playerSessionId && this.isLocalPlayerInfo) {\n      this.playerSessionId = NAF.clientId;\n    }\n    if (!this.playerSessionId) return;\n    if (this.playerSessionId !== e.detail.sessionId) return;\n\n    this.updateDisplayNameFromPresenceMeta(e.detail);\n  },\n  updateDisplayNameFromPresenceMeta(presenceMeta) {\n    this.displayName = presenceMeta.profile.displayName;\n    this.communityIdentifier = presenceMeta.profile.communityIdentifier;\n    this.isRecording = !!(presenceMeta.streaming || presenceMeta.recording);\n    this.isOwner = !!(presenceMeta.roles && presenceMeta.roles.owner);\n    this.applyDisplayName();\n  },\n  applyDisplayName() {\n    const nametagEl = this.el.querySelector(\".nametag\");\n    if (this.displayName && nametagEl) {\n      nametagEl.setAttribute(\"text\", { value: this.displayName });\n    }\n    const communityIdentifierEl = this.el.querySelector(\".communityIdentifier\");\n    if (communityIdentifierEl) {\n      if (this.communityIdentifier) {\n        communityIdentifierEl.setAttribute(\"text\", { value: this.communityIdentifier });\n      }\n    }\n\n    const recordingBadgeEl = this.el.querySelector(\".recordingBadge\");\n    if (recordingBadgeEl) {\n      recordingBadgeEl.object3D.visible = this.isRecording;\n    }\n\n    const modBadgeEl = this.el.querySelector(\".modBadge\");\n    if (modBadgeEl) {\n      modBadgeEl.object3D.visible = !this.isRecording && this.isOwner;\n    }\n  },\n  applyProperties() {\n    this.applyDisplayName();\n\n    // Used to enable Megaphone mode, where rolloff is significantly less than the normal 2.0\n    const headEl = this.el.querySelector(\".head\");\n    if (headEl) {\n      if (this.data.megaphoneEnabled && this.isOwner) { // Make sure only admins can enable megaphone.  Clients ignore non-admins that try.\n        headEl.setAttribute(\"networked-audio-source\", { rolloffFactor: 0.15 }); // Normal rolloffFactor is 1.0\n        // Other options for networked-audio-source include \n        // distanceModel: \"inverse\"\n        // maxDistance: 10000\n        // positional: true\n        // refDistance: 1\n        // rolloffFactor: 0\n      } else {\n        headEl.setAttribute(\"networked-audio-source\", { rolloffFactor: defaultRolloffFactor }); // Normal rolloffFactor in networked-audio-source is 1.0.  Hubs has it at 2.0\n      }\n    }\n\n    const modelEl = this.el.querySelector(\".model\");\n    if (this.data.avatarSrc && modelEl) {\n      modelEl.components[\"gltf-model-plus\"].jsonPreprocessor = ensureAvatarNodes;\n      modelEl.setAttribute(\"gltf-model-plus\", \"src\", this.data.avatarSrc);\n    }\n\n    const uniforms = injectCustomShaderChunks(this.el.object3D);\n    this.el.querySelectorAll(\"[hover-visuals]\").forEach(el => {\n      el.components[\"hover-visuals\"].uniforms = uniforms;\n    });\n  },\n  handleModelError() {\n    window.APP.store.resetToRandomLegacyAvatar();\n  }\n});\n","export const defaultRolloffFactor = 2.0;","import { findAncestorWithComponent } from \"../utils/scene-graph\";\n\nconst POSES = {\n  open: \"allOpen\",\n  thumbDown: \"thumbDown\",\n  indexDown: \"indexDown\",\n  mrpDown: \"mrpDown\",\n  thumbUp: \"thumbsUp\",\n  point: \"point\",\n  fist: \"allGrip\",\n  pinch: \"pinch\"\n};\n\nconst NETWORK_POSES = [\"allOpen\", \"thumbDown\", \"indexDown\", \"mrpDown\", \"thumbsUp\", \"point\", \"allGrip\", \"pinch\"];\n\n/**\n * Animates between poses based on networked pose state using an animation mixer.\n * @namespace avatar\n * @component hand-pose\n */\nAFRAME.registerComponent(\"hand-pose\", {\n  multiple: true,\n\n  init() {\n    this.pose = 0;\n    this.animatePose = this.animatePose.bind(this);\n    const mixerEl = findAncestorWithComponent(this.el, \"animation-mixer\");\n    const suffix = this.id == \"left\" ? \"_L\" : \"_R\";\n    this.mixer = mixerEl && mixerEl.components[\"animation-mixer\"].mixer;\n    if (!this.mixer || !this.mixer.clipAction(POSES.open + suffix)) {\n      console.warn(\"Avatar does not an 'allOpen' animation, disabling hand animations\");\n      this.el.removeAttribute(\"hand-pose\");\n      return;\n    }\n    this.from = this.to = this.mixer.clipAction(POSES.open + suffix);\n    this.from.play();\n    this.networkField = `${this.id}_hand_pose`;\n\n    const getNetworkedAvatar = el => {\n      if (!el) {\n        window.setTimeout(() => {\n          getNetworkedAvatar(this.el);\n        }, 1000);\n        return;\n      }\n      const networkedAvatar = el.components && el.components[\"networked-avatar\"];\n      if (networkedAvatar) {\n        return networkedAvatar;\n      }\n      return getNetworkedAvatar(el.parentEl);\n    };\n    this.networkedAvatar = getNetworkedAvatar(this.el);\n  },\n\n  tick() {\n    if (\n      !this.networkedAvatar ||\n      !this.networkedAvatar.data ||\n      this.networkedAvatar.data[this.networkField] === this.pose\n    ) {\n      return;\n    }\n\n    this.animatePose(NETWORK_POSES[this.pose], NETWORK_POSES[this.networkedAvatar.data[this.networkField]]);\n    this.pose = this.networkedAvatar.data[this.networkField];\n  },\n\n  animatePose(prev, curr) {\n    this.from.stop();\n    this.to.stop();\n\n    const duration = 0.065;\n    const suffix = this.id == \"left\" ? \"_L\" : \"_R\";\n    this.from = this.mixer.clipAction(prev + suffix);\n    this.to = this.mixer.clipAction(curr + suffix);\n\n    this.from.fadeOut(duration);\n    this.to.fadeIn(duration);\n    this.to.play();\n    this.from.play();\n\n    this.mixer.update(0.001);\n  }\n});\n\n/**\n * Sets the networked hand pose state based on hand-pose events.\n * @namespace avatar\n * @component hand-pose-controller\n */\nAFRAME.registerComponent(\"hand-pose-controller\", {\n  multiple: true,\n  schema: {\n    eventSrc: { type: \"selector\" },\n    networkedAvatar: { type: \"selector\" }\n  },\n  init: function() {\n    this.setHandPose = this.setHandPose.bind(this);\n  },\n\n  play: function() {\n    this.data.eventSrc.addEventListener(\"hand-pose\", this.setHandPose);\n  },\n\n  pause: function() {\n    this.data.eventSrc.removeEventListener(\"hand-pose\", this.setHandPose);\n  },\n\n  setHandPose: function(evt) {\n    this.data.networkedAvatar.setAttribute(\n      \"networked-avatar\",\n      `${this.id}_hand_pose`,\n      NETWORK_POSES.indexOf(POSES[evt.detail.current])\n    );\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\nimport { SOUND_FREEZE, SOUND_THAW } from \"../systems/sound-effects-system\";\n\n/**\n * Toggles freezing of network traffic on the given event.\n * @namespace network\n * @component freeze-controller\n */\nAFRAME.registerComponent(\"freeze-controller\", {\n  schema: {\n    toggleEvent: { type: \"string\" }\n  },\n\n  init: function() {\n    this.onToggle = this.onToggle.bind(this);\n  },\n\n  play: function() {\n    this.el.addEventListener(this.data.toggleEvent, this.onToggle);\n  },\n\n  pause: function() {\n    this.el.removeEventListener(this.data.toggleEvent, this.onToggle);\n  },\n\n  tick: function() {\n    const scene = this.el.sceneEl;\n    if (!scene.is(\"entered\")) return;\n\n    const userinput = scene.systems.userinput;\n    const ensureFrozen = userinput.get(paths.actions.ensureFrozen);\n    const thaw = userinput.get(paths.actions.thaw);\n    const toggleFreeze = userinput.get(paths.actions.toggleFreeze);\n\n    const toggleFreezeDueToInput =\n      (this.el.is(\"frozen\") && thaw) || (!this.el.is(\"frozen\") && ensureFrozen) || toggleFreeze;\n\n    if (toggleFreezeDueToInput) {\n      this.onToggle();\n    }\n  },\n\n  onToggle: function() {\n    window.APP.store.update({ activity: { hasFoundFreeze: true } });\n    if (!NAF.connection.adapter) return;\n    NAF.connection.adapter.toggleFreeze();\n    if (NAF.connection.adapter.frozen) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_FREEZE);\n      this.el.addState(\"frozen\");\n    } else {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_THAW);\n      this.el.removeState(\"frozen\");\n    }\n  }\n});\n","import { getLastWorldPosition } from \"../utils/three-utils\";\n\nconst isMobile = AFRAME.utils.device.isMobile();\n\n/**\n * Toggles the visibility of this entity when the scene is frozen.\n * @namespace ui\n * @component visibility-while-frozen\n */\nAFRAME.registerComponent(\"visibility-while-frozen\", {\n  schema: {\n    withinDistance: { type: \"number\" },\n    visible: { type: \"boolean\", default: true },\n    requireHoverOnNonMobile: { type: \"boolean\", default: true },\n    withPermission: { type: \"string\" }\n  },\n\n  init() {\n    this.updateVisibility = this.updateVisibility.bind(this);\n    this.camWorldPos = new THREE.Vector3();\n    this.objWorldPos = new THREE.Vector3();\n    this.cam = this.el.sceneEl.camera.el.object3D;\n\n    let hoverableSearch = this.el;\n\n    while (hoverableSearch !== document) {\n      if (hoverableSearch.getAttribute(\"is-remote-hover-target\") !== null) {\n        this.hoverable = hoverableSearch;\n        break;\n      }\n\n      hoverableSearch = hoverableSearch.parentNode;\n    }\n    if (!this.hoverable && this.data.requireHoverOnNonMobile) {\n      console.error(\"Didn't find a remote hover target.\");\n    }\n\n    this.onStateChange = evt => {\n      if (!evt.detail === \"frozen\") return;\n      this.updateVisibility();\n    };\n    this.updateVisibility();\n  },\n\n  tick() {\n    const isFrozen = this.el.sceneEl.is(\"frozen\");\n    const isVisible = this.el.object3D.visible;\n    const shouldNotBeVisible = isFrozen === !this.data.visible;\n    if (!isVisible && shouldNotBeVisible) return;\n\n    this.updateVisibility();\n  },\n\n  updateVisibility() {\n    const isFrozen = this.el.sceneEl.is(\"frozen\");\n\n    let isWithinDistance = true;\n    const isVisible = this.el.object3D.visible;\n\n    if (this.data.withinDistance) {\n      if (!isVisible) {\n        // Edge case, if the object is not visible force a matrix update\n        // since the main matrix update loop will not do it.\n        this.el.object3D.updateMatrices(true, true);\n      }\n\n      getLastWorldPosition(this.cam, this.camWorldPos);\n      this.objWorldPos.copy(this.el.object3D.position);\n      this.el.object3D.localToWorld(this.objWorldPos);\n\n      isWithinDistance =\n        this.camWorldPos.distanceToSquared(this.objWorldPos) < this.data.withinDistance * this.data.withinDistance;\n    }\n\n    const isTransforming = AFRAME.scenes[0].systems[\"transform-selected-object\"].transforming;\n\n    const allowed = !this.data.withPermission || window.APP.hubChannel.canOrWillIfCreator(this.data.withPermission);\n\n    let shouldBeVisible =\n      allowed &&\n      ((isFrozen && this.data.visible) || (!isFrozen && !this.data.visible)) &&\n      isWithinDistance &&\n      !isTransforming;\n\n    if (this.data.requireHoverOnNonMobile && !isMobile) {\n      shouldBeVisible =\n        shouldBeVisible &&\n        ((this.hoverable && AFRAME.scenes[0].systems.interaction.state.rightRemote.hovered === this.hoverable) ||\n          isVisible);\n    }\n\n    if (isVisible !== shouldBeVisible) {\n      this.el.setAttribute(\"visible\", shouldBeVisible);\n    }\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateChange);\n\n    if (this.hoverable) {\n      this.hoverable.object3D.addEventListener(\"hovered\", this.updateVisibility);\n      this.hoverable.object3D.addEventListener(\"unhovered\", this.updateVisibility);\n    }\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateChange);\n\n    if (this.hoverable) {\n      this.hoverable.object3D.addEventListener(\"hovered\", this.updateVisibility);\n      this.hoverable.object3D.addEventListener(\"unhovered\", this.updateVisibility);\n    }\n  }\n});\n\n/**\n * Toggles the interactivity of a UI entity while the scene is frozen.\n * @namespace ui\n * @component ui-class-while-frozen\n */\nAFRAME.registerComponent(\"ui-class-while-frozen\", {\n  init() {\n    this.onStateChange = evt => {\n      if (!evt.detail === \"frozen\") return;\n      this.el.classList.toggle(\"ui\", this.el.sceneEl.is(\"frozen\"));\n    };\n    this.el.classList.toggle(\"ui\", this.el.sceneEl.is(\"frozen\"));\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateChange);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateChange);\n  }\n});\n","import \"./stats-plus.css\";\nimport qsTruthy from \"../utils/qs_truthy\";\n\n// Adapted from https://github.com/aframevr/aframe/blob/master/src/components/scene/stats.js\n\nfunction createStats(scene) {\n  const threeStats = new window.threeStats(scene.renderer);\n  const aframeStats = new window.aframeStats(scene);\n  const plugins = scene.isMobile ? [] : [threeStats, aframeStats];\n  return new window.rStats({\n    css: [], // Our stylesheet is injected from AFrame.\n    values: {\n      fps: { caption: \"fps\", below: 30 },\n      batchdraws: { caption: \"Draws\" },\n      batchinstances: { caption: \"Instances\" },\n      batchatlassize: { caption: \"Atlas Size\" }\n    },\n    groups: [\n      { caption: \"Framerate\", values: [\"fps\", \"raf\", \"physics\"] },\n      { caption: \"Batching\", values: [\"batchdraws\", \"batchinstances\", \"batchatlassize\"] }\n    ],\n    plugins: plugins\n  });\n}\n\nconst HIDDEN_CLASS = \"a-hidden\";\n\nAFRAME.registerComponent(\"stats-plus\", {\n  // Whether or not the stats panel is expanded.\n  // Shows FPS counter when collapsed.\n  schema: { default: false },\n  init() {\n    this.onExpand = this.onExpand.bind(this);\n    this.onCollapse = this.onCollapse.bind(this);\n    this.onEnterVr = this.onEnterVr.bind(this);\n    this.onExitVr = this.onExitVr.bind(this);\n\n    const scene = this.el.sceneEl;\n    this.stats = createStats(scene);\n    this.statsEl = document.querySelector(\".rs-base\");\n\n    // Add header to stats panel so we can collapse it\n    const statsHeaderEl = document.createElement(\"div\");\n    statsHeaderEl.classList.add(\"rs-header\");\n\n    const statsTitleEl = document.createElement(\"h1\");\n    statsTitleEl.innerHTML = \"Stats\";\n    statsHeaderEl.appendChild(statsTitleEl);\n\n    const collapseEl = document.createElement(\"div\");\n    collapseEl.classList.add(\"rs-collapse-btn\");\n    collapseEl.innerHTML = \"X\";\n    collapseEl.addEventListener(\"click\", this.onCollapse);\n    statsHeaderEl.appendChild(collapseEl);\n\n    this.statsEl.insertBefore(statsHeaderEl, this.statsEl.firstChild);\n\n    // Add fps counter to the page\n    this.fpsEl = document.createElement(\"div\");\n    this.fpsEl.addEventListener(\"click\", this.onExpand);\n    this.fpsEl.classList.add(\"rs-fps-counter\");\n    document.body.appendChild(this.fpsEl);\n    this.lastFpsUpdate = performance.now();\n    this.lastFps = 0;\n    this.frameCount = 0;\n    this.inVR = scene.is(\"vr-mode\");\n\n    if (scene.isMobile) {\n      this.statsEl.classList.add(\"rs-mobile\");\n      this.fpsEl.classList.add(\"rs-mobile\");\n    }\n\n    scene.addEventListener(\"enter-vr\", this.onEnterVr);\n    scene.addEventListener(\"exit-vr\", this.onExitVr);\n\n    this.vrStatsEnabled = qsTruthy(\"vrstats\");\n    if (this.vrStatsEnabled) {\n      this.initVRStats();\n    }\n    this.lastUpdate = 0;\n  },\n  initVRStats() {\n    this.vrPanel = document.createElement(\"a-entity\");\n    this.vrPanel.setAttribute(\"text\", { width: 0.5, whiteSpace: \"pre\", value: \"_\", baseline: \"bottom\" });\n    this.vrPanel.addEventListener(\n      \"loaded\",\n      () =>\n        this.vrPanel.object3D.traverse(x => {\n          if (x.material) x.material.depthTest = false;\n        }),\n      { once: true }\n    );\n    this.el.append(this.vrPanel);\n    const background = document.createElement(\"a-plane\");\n    background.setAttribute(\"color\", \"#333333\");\n    background.setAttribute(\"material\", \"shader\", \"flat\");\n    background.setAttribute(\"material\", \"depthTest\", false);\n    background.setAttribute(\"width\", 0.1);\n    background.setAttribute(\"height\", 0.12);\n    background.setAttribute(\"position\", \"-0.2 0.055 0\");\n    this.el.append(background);\n  },\n  toggleVRStats() {\n    if (this.vrStatsEnabled) {\n      this.el.object3D.visible = false;\n      this.vrStatsEnabled = false;\n    } else {\n      if (!this.vrPanel) {\n        this.initVRStats();\n      }\n      this.el.object3D.visible = true;\n      this.vrStatsEnabled = true;\n    }\n  },\n  play() {\n    this.el.sceneEl.systems.physics.addComponent(this);\n  },\n  pause() {\n    this.el.sceneEl.systems.physics.removeComponent(this);\n  },\n  beforeStep() {\n    this.stats(\"physics\").start();\n  },\n  afterStep() {\n    this.stats(\"physics\").end();\n  },\n  update(oldData) {\n    if (oldData !== this.data) {\n      if (this.data) {\n        this.statsEl.classList.remove(HIDDEN_CLASS);\n        this.fpsEl.classList.add(HIDDEN_CLASS);\n      } else {\n        this.statsEl.classList.add(HIDDEN_CLASS);\n        this.fpsEl.classList.remove(HIDDEN_CLASS);\n      }\n    }\n  },\n  tick(time) {\n    const stats = this.stats;\n    if (this.data || this.vrStatsEnabled) {\n      // Update rStats\n      stats(\"rAF\").tick();\n      stats(\"FPS\").frame();\n\n      const batchManagerSystem = this.el.sceneEl.systems[\"hubs-systems\"].batchManagerSystem;\n      if (batchManagerSystem.batchingEnabled) {\n        const batchManager = batchManagerSystem.batchManager;\n        stats(\"batchdraws\").set(batchManager.batches.length);\n        stats(\"batchinstances\").set(batchManager.instanceCount);\n        stats(\"batchatlassize\").set(batchManager.atlas.arrayDepth);\n      }\n\n      stats().update();\n    } else if (!this.inVR) {\n      // Update the fps counter\n      const now = performance.now();\n      this.frameCount++;\n\n      // Update the fps counter text once a second\n      if (now >= this.lastFpsUpdate + 1000) {\n        const fps = Math.round(this.frameCount / ((now - this.lastFpsUpdate) / 1000));\n        if (fps !== this.lastFps) {\n          this.fpsEl.innerHTML = Math.round(fps) + \" FPS\";\n          this.lastFps = fps;\n        }\n        this.lastFpsUpdate = now;\n        this.frameCount = 0;\n      }\n    }\n    if (this.vrStatsEnabled && time - this.lastUpdate > 100) {\n      this.vrPanel.setAttribute(\n        \"text\",\n        \"value\",\n        [\n          `f ${stats(\"fps\")\n            .value()\n            .toFixed(0)}`,\n          `r ${stats(\"raf\")\n            .value()\n            .toFixed(0)}`,\n          `p ${stats(\"physics\")\n            .value()\n            .toFixed(0)}`,\n          `c ${this.el.sceneEl.renderer.info.render.calls}`,\n          `t ${(this.el.sceneEl.renderer.info.render.triangles / 1000).toFixed(0)}k`\n        ].join(\"\\n\")\n      );\n      this.lastUpdate = time;\n    }\n  },\n  onEnterVr() {\n    this.inVR = true;\n    // Hide all stats elements when entering VR on mobile\n    if (this.el.sceneEl.isMobile) {\n      this.statsEl.classList.add(HIDDEN_CLASS);\n      this.fpsEl.classList.add(HIDDEN_CLASS);\n    }\n  },\n  onExitVr() {\n    this.inVR = false;\n    // Revert to previous state whe exiting VR on mobile\n    if (this.el.sceneEl.isMobile) {\n      if (this.data) {\n        this.statsEl.classList.remove(HIDDEN_CLASS);\n      } else {\n        this.fpsEl.classList.remove(HIDDEN_CLASS);\n      }\n    }\n  },\n  onExpand() {\n    this.el.setAttribute(this.name, true);\n  },\n  onCollapse() {\n    this.el.setAttribute(this.name, false);\n  },\n  remove() {\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.hide);\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.show);\n\n    if (this.statsEl) {\n      this.statsEl.parentNode.removeChild(this.statsEl);\n      this.fpsEl.parentNode.removeChild(this.fpsEl);\n    }\n  }\n});\n","/* global performance THREE AFRAME NAF MediaStream process setTimeout */\nimport GIFWorker from \"../workers/gifparsing.worker.js\";\nimport errorImageSrc from \"!!url-loader!../assets/images/media-error.gif\";\nimport { paths } from \"../systems/userinput/paths\";\nimport HLS from \"hls.js/dist/hls.light.js\";\nimport { addAndArrangeMedia, createImageTexture } from \"../utils/media-utils\";\nimport { proxiedUrlFor } from \"../utils/media-url-utils\";\nimport { buildAbsoluteURL } from \"url-toolkit\";\nimport { SOUND_CAMERA_TOOL_TOOK_SNAPSHOT } from \"../systems/sound-effects-system\";\nimport { promisifyWorker } from \"../utils/promisify-worker.js\";\nimport pdfjs from \"pdfjs-dist\";\n\n// Using external CDN to reduce build size\npdfjs.GlobalWorkerOptions.workerSrc =\n  \"https://assets-prod.reticulum.io/assets/js/pdfjs-dist@2.1.266/build/pdf.worker.js\";\n\nconst ONCE_TRUE = { once: true };\nconst TYPE_IMG_PNG = { type: \"image/png\" };\nconst parseGIF = promisifyWorker(new GIFWorker());\n\nexport const VOLUME_LABELS = [];\nfor (let i = 0; i <= 20; i++) {\n  let s = \"|\";\n  for (let j = 0; j <= 20; j++) {\n    s += i >= j ? \"|\" : \" \";\n  }\n  s += \"|\";\n  VOLUME_LABELS[i] = s;\n}\n\nclass GIFTexture extends THREE.Texture {\n  constructor(frames, delays, disposals) {\n    super(document.createElement(\"canvas\"));\n    this.image.width = frames[0].width;\n    this.image.height = frames[0].height;\n\n    this._ctx = this.image.getContext(\"2d\");\n\n    this.generateMipmaps = false;\n    this.isVideoTexture = true;\n    this.minFilter = THREE.NearestFilter;\n\n    this.frames = frames;\n    this.delays = delays;\n    this.disposals = disposals;\n\n    this.frame = 0;\n    this.frameStartTime = Date.now();\n  }\n\n  update() {\n    if (!this.frames || !this.delays || !this.disposals) return;\n    const now = Date.now();\n    if (now - this.frameStartTime > this.delays[this.frame]) {\n      if (this.disposals[this.frame] === 2) {\n        this._ctx.clearRect(0, 0, this.image.width, this.image.width);\n      }\n      this.frame = (this.frame + 1) % this.frames.length;\n      this.frameStartTime = now;\n      this._ctx.drawImage(this.frames[this.frame], 0, 0, this.image.width, this.image.height);\n      this.needsUpdate = true;\n    }\n  }\n}\n\nasync function createGIFTexture(url) {\n  return new Promise((resolve, reject) => {\n    fetch(url, { mode: \"cors\" })\n      .then(r => r.arrayBuffer())\n      .then(rawImageData => parseGIF(rawImageData, [rawImageData]))\n      .then(result => {\n        const { frames, delayTimes, disposals } = result;\n        let loadCnt = 0;\n        for (let i = 0; i < frames.length; i++) {\n          const img = new Image();\n          img.onload = e => {\n            loadCnt++;\n            frames[i] = e.target;\n            if (loadCnt === frames.length) {\n              const texture = new GIFTexture(frames, delayTimes, disposals);\n              texture.image.src = url;\n              texture.encoding = THREE.sRGBEncoding;\n              texture.minFilter = THREE.LinearFilter;\n              resolve(texture);\n            }\n          };\n          img.src = frames[i];\n        }\n      })\n      .catch(reject);\n  });\n}\n\nconst isIOS = AFRAME.utils.device.isIOS();\n\n/**\n * Create video element to be used as a texture.\n *\n * @param {string} src - Url to a video file.\n * @returns {Element} Video element.\n */\nasync function createVideoEl() {\n  const videoEl = document.createElement(\"video\");\n  videoEl.setAttribute(\"playsinline\", \"\");\n  videoEl.setAttribute(\"webkit-playsinline\", \"\");\n  // iOS Safari requires the autoplay attribute, or it won't play the video at all.\n  videoEl.autoplay = true;\n  // iOS Safari will not play videos without user interaction. We mute the video so that it can autoplay and then\n  // allow the user to unmute it with an interaction in the unmute-video-button component.\n  videoEl.muted = isIOS;\n  videoEl.preload = \"auto\";\n  videoEl.crossOrigin = \"anonymous\";\n\n  return videoEl;\n}\n\nfunction createVideoTexture(url, contentType) {\n  return new Promise(async (resolve, reject) => {\n    const videoEl = await createVideoEl();\n\n    const texture = new THREE.VideoTexture(videoEl);\n    texture.minFilter = THREE.LinearFilter;\n    texture.encoding = THREE.sRGBEncoding;\n\n    if (url.startsWith(\"hubs://\")) {\n      const streamClientId = url.substring(7).split(\"/\")[1]; // /clients/<client id>/video is only URL for now\n      const stream = await NAF.connection.adapter.getMediaStream(streamClientId, \"video\");\n      videoEl.srcObject = new MediaStream(stream.getVideoTracks());\n      // If hls.js is supported we always use it as it gives us better events\n    } else if (AFRAME.utils.material.isHLS(url, contentType)) {\n      if (HLS.isSupported()) {\n        const corsProxyPrefix = `https://${process.env.CORS_PROXY_SERVER}/`;\n        const baseUrl = url.startsWith(corsProxyPrefix) ? url.substring(corsProxyPrefix.length) : url;\n        const hls = new HLS({\n          xhrSetup: (xhr, u) => {\n            if (u.startsWith(corsProxyPrefix)) {\n              u = u.substring(corsProxyPrefix.length);\n            }\n\n            // HACK HLS.js resolves relative urls internally, but our CORS proxying screws it up. Resolve relative to the original unproxied url.\n            // TODO extend HLS.js to allow overriding of its internal resolving instead\n            if (!u.startsWith(\"http\")) {\n              u = buildAbsoluteURL(baseUrl, u.startsWith(\"/\") ? u : `/${u}`);\n            }\n\n            xhr.open(\"GET\", proxiedUrlFor(u));\n          }\n        });\n        texture.hls = hls;\n        hls.loadSource(url);\n        hls.attachMedia(videoEl);\n        hls.on(HLS.Events.ERROR, function(event, data) {\n          if (data.fatal) {\n            switch (data.type) {\n              case HLS.ErrorTypes.NETWORK_ERROR:\n                // try to recover network error\n                hls.startLoad();\n                break;\n              case HLS.ErrorTypes.MEDIA_ERROR:\n                hls.recoverMediaError();\n                break;\n              default:\n                reject(event);\n                return;\n            }\n          }\n        });\n        // If not, see if native support will work\n      } else if (videoEl.canPlayType(contentType)) {\n        videoEl.src = url;\n        videoEl.onerror = reject;\n      } else {\n        reject(\"HLS unsupported\");\n      }\n    } else {\n      videoEl.src = url;\n      videoEl.onerror = reject;\n    }\n\n    let hasResolved = false;\n\n    const resolveOnce = () => {\n      if (hasResolved) return;\n      hasResolved = true;\n      resolve(texture);\n    };\n\n    videoEl.addEventListener(\"canplay\", resolveOnce, { once: true });\n\n    // HACK: Sometimes iOS fails to fire the canplay event, so we poll for the video dimensions to appear instead.\n    if (isIOS) {\n      const poll = () => {\n        if ((texture.image.videoHeight || texture.image.height) && (texture.image.videoWidth || texture.image.width)) {\n          resolveOnce();\n        } else {\n          setTimeout(poll, 500);\n        }\n      };\n\n      poll();\n    }\n  });\n}\n\nfunction scaleToAspectRatio(el, ratio) {\n  const width = Math.min(1.0, 1.0 / ratio);\n  const height = Math.min(1.0, ratio);\n  el.object3DMap.mesh.scale.set(width, height, 1);\n  el.object3DMap.mesh.matrixNeedsUpdate = true;\n}\n\nfunction disposeTexture(texture) {\n  if (texture.image instanceof HTMLVideoElement) {\n    const video = texture.image;\n    video.pause();\n    video.src = \"\";\n    video.load();\n  }\n\n  if (texture.hls) {\n    texture.hls.destroy();\n  }\n\n  texture.dispose();\n}\n\nclass TextureCache {\n  cache = new Map();\n\n  set(src, texture) {\n    const image = texture.image;\n    this.cache.set(src, {\n      texture,\n      ratio: (image.videoHeight || image.height) / (image.videoWidth || image.width),\n      count: 0\n    });\n    return this.retain(src);\n  }\n\n  has(src) {\n    return this.cache.has(src);\n  }\n\n  get(src) {\n    return this.cache.get(src);\n  }\n\n  retain(src) {\n    const cacheItem = this.cache.get(src);\n    cacheItem.count++;\n    // console.log(\"retain\", src, cacheItem.count);\n    return cacheItem;\n  }\n\n  release(src) {\n    const cacheItem = this.cache.get(src);\n\n    if (!cacheItem) {\n      console.error(`Releasing uncached texture src ${src}`);\n      return;\n    }\n\n    cacheItem.count--;\n    // console.log(\"release\", src, cacheItem.count);\n    if (cacheItem.count <= 0) {\n      // Unload the video element to prevent it from continuing to play in the background\n      disposeTexture(cacheItem.texture);\n      this.cache.delete(src);\n    }\n  }\n}\n\nconst textureCache = new TextureCache();\nconst inflightTextures = new Map();\n\nconst errorImage = new Image();\nerrorImage.src = errorImageSrc;\nconst errorTexture = new THREE.Texture(errorImage);\nerrorTexture.magFilter = THREE.NearestFilter;\nerrorImage.onload = () => {\n  errorTexture.needsUpdate = true;\n};\nconst errorCacheItem = { texture: errorTexture, ratio: 1 };\n\nfunction timeFmt(t) {\n  let s = Math.floor(t),\n    h = Math.floor(s / 3600);\n  s -= h * 3600;\n  let m = Math.floor(s / 60);\n  s -= m * 60;\n  if (h < 10) h = `0${h}`;\n  if (m < 10) m = `0${m}`;\n  if (s < 10) s = `0${s}`;\n  return h === \"00\" ? `${m}:${s}` : `${h}:${m}:${s}`;\n}\n\nAFRAME.registerComponent(\"media-video\", {\n  schema: {\n    src: { type: \"string\" },\n    contentType: { type: \"string\" },\n    volume: { type: \"number\", default: 0.5 },\n    loop: { type: \"boolean\", default: true },\n    audioType: { type: \"string\", default: \"pannernode\" },\n    hidePlaybackControls: { type: \"boolean\", default: false },\n    distanceModel: { type: \"string\", default: \"inverse\" },\n    rolloffFactor: { type: \"number\", default: 1 },\n    refDistance: { type: \"number\", default: 1 },\n    maxDistance: { type: \"number\", default: 10000 },\n    coneInnerAngle: { type: \"number\", default: 360 },\n    coneOuterAngle: { type: \"number\", default: 0 },\n    coneOuterGain: { type: \"number\", default: 0 },\n    videoPaused: { type: \"boolean\" },\n    projection: { type: \"string\", default: \"flat\" },\n    time: { type: \"number\" },\n    tickRate: { default: 1000 }, // ms interval to send time interval updates\n    syncTolerance: { default: 2 }\n  },\n\n  init() {\n    this.onPauseStateChange = this.onPauseStateChange.bind(this);\n    this.tryUpdateVideoPlaybackState = this.tryUpdateVideoPlaybackState.bind(this);\n    this.updateSrc = this.updateSrc.bind(this);\n\n    this.seekForward = this.seekForward.bind(this);\n    this.seekBack = this.seekBack.bind(this);\n    this.volumeUp = this.volumeUp.bind(this);\n    this.volumeDown = this.volumeDown.bind(this);\n    this.snap = this.snap.bind(this);\n    this.changeVolumeBy = this.changeVolumeBy.bind(this);\n    this.togglePlaying = this.togglePlaying.bind(this);\n\n    this.lastUpdate = 0;\n    this.videoMutedAt = 0;\n    this.localSnapCount = 0;\n    this.isSnapping = false;\n    this.onSnapImageLoaded = () => (this.isSnapping = false);\n\n    this.el.setAttribute(\"hover-menu__video\", { template: \"#video-hover-menu\", dirs: [\"forward\", \"back\"] });\n    this.el.components[\"hover-menu__video\"].getHoverMenu().then(menu => {\n      // If we got removed while waiting, do nothing.\n      if (!this.el.parentNode) return;\n\n      this.hoverMenu = menu;\n\n      this.playbackControls = this.el.querySelector(\".video-playback\");\n      this.playPauseButton = this.el.querySelector(\".video-playpause-button\");\n      this.volumeUpButton = this.el.querySelector(\".video-volume-up-button\");\n      this.volumeDownButton = this.el.querySelector(\".video-volume-down-button\");\n      this.seekForwardButton = this.el.querySelector(\".video-seek-forward-button\");\n      this.seekBackButton = this.el.querySelector(\".video-seek-back-button\");\n      this.snapButton = this.el.querySelector(\".video-snap-button\");\n      this.timeLabel = this.el.querySelector(\".video-time-label\");\n      this.volumeLabel = this.el.querySelector(\".video-volume-label\");\n\n      this.playPauseButton.object3D.addEventListener(\"interact\", this.togglePlaying);\n      this.seekForwardButton.object3D.addEventListener(\"interact\", this.seekForward);\n      this.seekBackButton.object3D.addEventListener(\"interact\", this.seekBack);\n      this.volumeUpButton.object3D.addEventListener(\"interact\", this.volumeUp);\n      this.volumeDownButton.object3D.addEventListener(\"interact\", this.volumeDown);\n      this.snapButton.object3D.addEventListener(\"interact\", this.snap);\n\n      this.updateVolumeLabel();\n      this.updateHoverMenuBasedOnLiveState();\n      this.updatePlaybackState();\n    });\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.networkedEl = networkedEl;\n      this.networkedEl.components.networked.applyPersistentFirstSync();\n      this.updatePlaybackState();\n\n      // For scene-owned videos, take ownership after a random delay if nobody\n      // else has so there is a timekeeper. Do not due this on iOS because iOS has an\n      // annoying \"auto-pause\" feature that forces one non-autoplaying video to play\n      // at once, which will pause the videos for everyone in the room if owned.\n      if (!isIOS && NAF.utils.getNetworkOwner(this.networkedEl) === \"scene\") {\n        setTimeout(() => {\n          if (NAF.utils.getNetworkOwner(this.networkedEl) === \"scene\") {\n            NAF.utils.takeOwnership(this.networkedEl);\n          }\n        }, 2000 + Math.floor(Math.random() * 2000));\n      }\n    });\n\n    // from a-sound\n    const sceneEl = this.el.sceneEl;\n    sceneEl.audioListener = sceneEl.audioListener || new THREE.AudioListener();\n    if (sceneEl.camera) {\n      sceneEl.camera.add(sceneEl.audioListener);\n    }\n    sceneEl.addEventListener(\"camera-set-active\", function(evt) {\n      evt.detail.cameraEl.getObject3D(\"camera\").add(sceneEl.audioListener);\n    });\n  },\n\n  seekForward() {\n    if ((!this.videoIsLive && NAF.utils.isMine(this.networkedEl)) || NAF.utils.takeOwnership(this.networkedEl)) {\n      this.video.currentTime += 30;\n      this.el.setAttribute(\"media-video\", \"time\", this.video.currentTime);\n    }\n  },\n\n  seekBack() {\n    if ((!this.videoIsLive && NAF.utils.isMine(this.networkedEl)) || NAF.utils.takeOwnership(this.networkedEl)) {\n      this.video.currentTime -= 10;\n      this.el.setAttribute(\"media-video\", \"time\", this.video.currentTime);\n    }\n  },\n\n  changeVolumeBy(v) {\n    this.el.setAttribute(\"media-video\", \"volume\", THREE.Math.clamp(this.data.volume + v, 0, 1));\n    this.updateVolumeLabel();\n  },\n\n  volumeUp() {\n    this.changeVolumeBy(0.1);\n  },\n\n  volumeDown() {\n    this.changeVolumeBy(-0.1);\n  },\n\n  async snap() {\n    if (this.isSnapping) return;\n    this.isSnapping = true;\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_TOOK_SNAPSHOT);\n\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = this.video.videoWidth;\n    canvas.height = this.video.videoHeight;\n    canvas.getContext(\"2d\").drawImage(this.video, 0, 0, canvas.width, canvas.height);\n    const blob = await new Promise(resolve => canvas.toBlob(resolve));\n    const file = new File([blob], \"snap.png\", TYPE_IMG_PNG);\n\n    this.localSnapCount++;\n    const { entity } = addAndArrangeMedia(this.el, file, \"photo-snapshot\", this.localSnapCount);\n    entity.addEventListener(\"image-loaded\", this.onSnapImageLoaded, ONCE_TRUE);\n  },\n\n  togglePlaying() {\n    // See onPauseStateChanged for note about iOS\n    if (isIOS && this.video.paused && NAF.utils.isMine(this.networkedEl)) {\n      this.video.play();\n      return;\n    }\n\n    if (this.networkedEl && (NAF.utils.isMine(this.networkedEl) || NAF.utils.takeOwnership(this.networkedEl))) {\n      this.tryUpdateVideoPlaybackState(!this.data.videoPaused);\n    }\n  },\n\n  onPauseStateChange() {\n    // iOS Safari will auto-pause other videos if one is manually started (not autoplayed.) So, to keep things\n    // easy to reason about, we *never* broadcast pauses from iOS.\n    //\n    // if an iOS safari user pauses and plays a video they'll pause all the other videos,\n    // which isn't great, but this check will at least ensure they don't pause those videos\n    // for all other users in the room! Of course, if they go and hit play on those videos auto-paused,\n    // they will become the timekeeper, and will seek everyone to where the video was auto-paused.\n    //\n    // This specific case will diverge the network schema and the video player state, so that\n    // this.data.videoPaused is false (so others will keep playing it) but our local player will\n    // have stopped. So we deal with this special case as well when we press the play button.\n    if (isIOS && this.video.paused && NAF.utils.isMine(this.networkedEl)) {\n      return;\n    }\n\n    // Used in the HACK in hub.js for dealing with auto-pause in Oculus Browser\n    if (this._ignorePauseStateChanges) return;\n\n    this.el.setAttribute(\"media-video\", \"videoPaused\", this.video.paused);\n\n    if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n      this.el.emit(\"owned-video-state-changed\");\n    }\n  },\n\n  updatePlaybackState(force) {\n    if (this.hoverMenu) {\n      this.playbackControls.object3D.visible = !this.data.hidePlaybackControls && !!this.video;\n      this.timeLabel.object3D.visible = !this.data.hidePlaybackControls;\n\n      const isPinned = this.el.components.pinnable && this.el.components.pinnable.data.pinned;\n      this.playPauseButton.object3D.visible = !!this.video && (!isPinned || window.APP.hubChannel.can(\"pin_objects\"));\n      this.snapButton.object3D.visible = !!this.video && window.APP.hubChannel.can(\"spawn_and_move_media\");\n      this.seekForwardButton.object3D.visible = !!this.video && !this.videoIsLive;\n      this.seekBackButton.object3D.visible = !!this.video && !this.videoIsLive;\n    }\n\n    // Only update playback position for videos you don't own\n    if (force || (this.networkedEl && !NAF.utils.isMine(this.networkedEl) && this.video)) {\n      if (Math.abs(this.data.time - this.video.currentTime) > this.data.syncTolerance) {\n        this.tryUpdateVideoPlaybackState(this.data.videoPaused, this.data.time);\n      } else {\n        this.tryUpdateVideoPlaybackState(this.data.videoPaused);\n      }\n    }\n\n    // Volume is local, always update it\n    if (this.audio) {\n      this.audio.gain.gain.value = this.data.volume;\n    }\n  },\n\n  tryUpdateVideoPlaybackState(pause, currentTime) {\n    if (this._playbackStateChangeTimeout) {\n      clearTimeout(this._playbackStateChangeTimeout);\n      delete this._playbackStateChangeTimeout;\n    }\n\n    if (!this.videoIsLive && currentTime !== undefined) {\n      this.video.currentTime = currentTime;\n    }\n\n    if (this.hoverMenu) {\n      this.playPauseButton.setAttribute(\"icon-button\", \"active\", pause);\n    }\n\n    if (pause) {\n      this.video.pause();\n    } else {\n      // Need to deal with the fact play() may fail if user has not interacted with browser yet.\n      this.video.play().catch(() => {\n        if (pause !== this.data.videoPaused) return;\n        this._playbackStateChangeTimeout = setTimeout(() => this.tryUpdateVideoPlaybackState(pause, currentTime), 1000);\n      });\n    }\n  },\n\n  async update(oldData) {\n    const src = this.data.src;\n    this.updatePlaybackState();\n\n    if (!src || src === oldData.src) return;\n    return this.updateSrc(oldData);\n  },\n\n  async updateSrc(oldData) {\n    const { src } = this.data;\n\n    this.cleanUp();\n    if (this.mesh && this.mesh.material) {\n      this.mesh.material.map = null;\n      this.mesh.material.needsUpdate = true;\n    }\n\n    let texture;\n    try {\n      texture = await createVideoTexture(src, this.data.contentType);\n\n      // No way to cancel promises, so if src has changed while we were creating the texture just throw it away.\n      if (this.data.src !== src) {\n        disposeTexture(texture);\n        return;\n      }\n\n      if (!src.startsWith(\"hubs://\")) {\n        // TODO FF error here if binding mediastream: The captured HTMLMediaElement is playing a MediaStream. Applying volume or mute status is not currently supported -- not an issue since we have no audio atm in shared video.\n        texture.audioSource = this.el.sceneEl.audioListener.context.createMediaElementSource(texture.image);\n\n        if (this.data.audioType === \"pannernode\") {\n          this.audio = new THREE.PositionalAudio(this.el.sceneEl.audioListener);\n          this.audio.setDistanceModel(this.data.distanceModel);\n          this.audio.setRolloffFactor(this.data.rolloffFactor);\n          this.audio.setRefDistance(this.data.refDistance);\n          this.audio.setMaxDistance(this.data.maxDistance);\n          this.audio.panner.coneInnerAngle = this.data.coneInnerAngle;\n          this.audio.panner.coneOuterAngle = this.data.coneOuterAngle;\n          this.audio.panner.coneOuterGain = this.data.coneOuterGain;\n        } else {\n          this.audio = new THREE.Audio(this.el.sceneEl.audioListener);\n        }\n\n        this.audio.setNodeSource(texture.audioSource);\n        this.el.setObject3D(\"sound\", this.audio);\n      }\n\n      this.video = texture.image;\n      this.video.loop = this.data.loop;\n      this.video.addEventListener(\"pause\", this.onPauseStateChange);\n      this.video.addEventListener(\"play\", this.onPauseStateChange);\n\n      if (texture.hls) {\n        const updateLiveState = () => {\n          this.videoIsLive = texture.hls.levels[texture.hls.currentLevel].details.live;\n          this.updateHoverMenuBasedOnLiveState();\n        };\n        texture.hls.on(HLS.Events.LEVEL_SWITCHED, updateLiveState);\n        if (texture.hls.currentLevel >= 0) {\n          updateLiveState();\n        }\n      } else {\n        this.videoIsLive = this.video.duration === Infinity;\n        this.updateHoverMenuBasedOnLiveState();\n      }\n\n      if (isIOS) {\n        const template = document.getElementById(\"video-unmute\");\n        this.el.appendChild(document.importNode(template.content, true));\n        this.el.setAttribute(\"position-at-box-shape-border__unmute-ui\", {\n          target: \".unmute-ui\",\n          dirs: [\"forward\", \"back\"]\n        });\n      }\n    } catch (e) {\n      console.error(\"Error loading video\", this.data.src, e);\n      texture = errorTexture;\n    }\n\n    const projection = this.data.projection;\n\n    if (!this.mesh || projection !== oldData.projection) {\n      const material = new THREE.MeshBasicMaterial();\n\n      let geometry;\n\n      if (projection === \"360-equirectangular\") {\n        geometry = new THREE.SphereBufferGeometry(1, 64, 32);\n        // invert the geometry on the x-axis so that all of the faces point inward\n        geometry.scale(-1, 1, 1);\n      } else {\n        geometry = new THREE.PlaneBufferGeometry();\n        material.side = THREE.DoubleSide;\n      }\n\n      this.mesh = new THREE.Mesh(geometry, material);\n      this.el.setObject3D(\"mesh\", this.mesh);\n    }\n\n    this.mesh.material.map = texture;\n    this.mesh.material.needsUpdate = true;\n\n    if (projection === \"flat\") {\n      scaleToAspectRatio(this.el, texture.image.videoHeight / texture.image.videoWidth);\n    }\n\n    this.updatePlaybackState(true);\n\n    if (this.video.muted) {\n      this.videoMutedAt = performance.now();\n    }\n\n    this.el.emit(\"video-loaded\", { projection: projection });\n  },\n\n  updateHoverMenuBasedOnLiveState() {\n    if (!this.hoverMenu) return;\n\n    this.seekForwardButton.object3D.visible = !this.videoIsLive;\n    this.seekBackButton.object3D.visible = !this.videoIsLive;\n\n    if (this.videoIsLive) {\n      this.timeLabel.setAttribute(\"text\", \"value\", \"LIVE\");\n    }\n  },\n\n  updateVolumeLabel() {\n    this.volumeLabel.setAttribute(\n      \"text\",\n      \"value\",\n      this.data.volume === 0 ? \"MUTE\" : VOLUME_LABELS[Math.floor(this.data.volume / 0.05)]\n    );\n  },\n\n  tick() {\n    if (!this.video) return;\n\n    const userinput = this.el.sceneEl.systems.userinput;\n    const interaction = this.el.sceneEl.systems.interaction;\n    const volumeMod = userinput.get(paths.actions.cursor.mediaVolumeMod);\n    if (interaction.state.rightRemote.hovered === this.el && volumeMod) {\n      this.changeVolumeBy(volumeMod);\n    }\n\n    const isHeld = interaction.isHeld(this.el);\n\n    if (this.wasHeld && !isHeld) {\n      this.localSnapCount = 0;\n    }\n\n    this.wasHeld = isHeld;\n\n    if (this.hoverMenu && this.hoverMenu.object3D.visible && !this.videoIsLive) {\n      this.timeLabel.setAttribute(\n        \"text\",\n        \"value\",\n        `${timeFmt(this.video.currentTime)} / ${timeFmt(this.video.duration)}`\n      );\n    }\n\n    // If a non-live video is currently playing and we own it, send out time updates\n    if (!this.data.videoPaused && !this.videoIsLive && this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n      const now = performance.now();\n      if (now - this.lastUpdate > this.data.tickRate) {\n        this.el.setAttribute(\"media-video\", \"time\", this.video.currentTime);\n        this.lastUpdate = now;\n      }\n    }\n  },\n\n  cleanUp() {\n    if (this.mesh && this.mesh.material) {\n      disposeTexture(this.mesh.material.map);\n    }\n  },\n\n  remove() {\n    this.cleanUp();\n\n    if (this.audio) {\n      this.el.removeObject3D(\"sound\");\n      this.audio.disconnect();\n      delete this.audio;\n    }\n\n    if (this.video) {\n      this.video.removeEventListener(\"pause\", this.onPauseStateChange);\n      this.video.removeEventListener(\"play\", this.onPauseStateChange);\n    }\n    if (this.hoverMenu) {\n      this.playPauseButton.object3D.removeEventListener(\"interact\", this.togglePlaying);\n      this.volumeUpButton.object3D.removeEventListener(\"interact\", this.volumeUp);\n      this.volumeDownButton.object3D.removeEventListener(\"interact\", this.volumeDown);\n      this.seekForwardButton.object3D.removeEventListener(\"interact\", this.seekForward);\n      this.seekBackButton.object3D.removeEventListener(\"interact\", this.seekBack);\n    }\n  }\n});\n\nAFRAME.registerComponent(\"media-image\", {\n  schema: {\n    src: { type: \"string\" },\n    projection: { type: \"string\", default: \"flat\" },\n    contentType: { type: \"string\" },\n    batch: { default: false }\n  },\n\n  remove() {\n    if (this.data.batch && this.mesh) {\n      this.el.sceneEl.systems[\"hubs-systems\"].batchManagerSystem.removeObject(this.mesh);\n    }\n    if (this.currentSrcIsRetained) {\n      textureCache.release(this.data.src);\n      this.currentSrcIsRetained = false;\n    }\n  },\n\n  async update(oldData) {\n    let texture;\n    let ratio = 1;\n\n    try {\n      const { src, contentType } = this.data;\n      if (!src) return;\n\n      this.el.emit(\"image-loading\");\n\n      if (this.mesh && this.mesh.map && src !== oldData.src) {\n        this.mesh.material.map = null;\n        this.mesh.material.needsUpdate = true;\n        if (this.mesh.map !== errorTexture) {\n          textureCache.release(oldData.src);\n          this.currentSrcIsRetained = false;\n        }\n      }\n\n      let cacheItem;\n      if (textureCache.has(src)) {\n        if (this.currentSrcIsRetained) {\n          cacheItem = textureCache.get(src);\n        } else {\n          cacheItem = textureCache.retain(src);\n        }\n      } else {\n        if (src === \"error\") {\n          cacheItem = errorCacheItem;\n        } else if (inflightTextures.has(src)) {\n          await inflightTextures.get(src);\n          cacheItem = textureCache.retain(src);\n        } else {\n          let promise;\n          if (contentType.includes(\"image/gif\")) {\n            promise = createGIFTexture(src);\n          } else if (contentType.startsWith(\"image/\")) {\n            promise = createImageTexture(src);\n          } else {\n            throw new Error(`Unknown image content type: ${contentType}`);\n          }\n          inflightTextures.set(src, promise);\n          texture = await promise;\n          inflightTextures.delete(src);\n          cacheItem = textureCache.set(src, texture);\n        }\n\n        // No way to cancel promises, so if src has changed or this entity was removed while we were creating the texture just throw it away.\n        if (this.data.src !== src || !this.el.parentNode) {\n          textureCache.release(src);\n          return;\n        }\n      }\n\n      texture = cacheItem.texture;\n      ratio = cacheItem.ratio;\n\n      this.currentSrcIsRetained = true;\n    } catch (e) {\n      console.error(\"Error loading image\", this.data.src, e);\n      texture = errorTexture;\n      this.currentSrcIsRetained = false;\n    }\n\n    const projection = this.data.projection;\n\n    if (!this.mesh || projection !== oldData.projection) {\n      const material = new THREE.MeshBasicMaterial();\n\n      let geometry;\n\n      if (projection === \"360-equirectangular\") {\n        geometry = new THREE.SphereBufferGeometry(1, 64, 32);\n        // invert the geometry on the x-axis so that all of the faces point inward\n        geometry.scale(-1, 1, 1);\n      } else {\n        geometry = new THREE.PlaneBufferGeometry(1, 1, 1, 1, texture.flipY);\n        material.side = THREE.DoubleSide;\n      }\n\n      this.mesh = new THREE.Mesh(geometry, material);\n      this.el.setObject3D(\"mesh\", this.mesh);\n    }\n\n    // We only support transparency on gifs. Other images will support cutout as part of batching, but not alpha transparency for now\n    this.mesh.material.transparent =\n      !this.data.batch || texture == errorTexture || this.data.contentType.includes(\"image/gif\");\n    this.mesh.material.map = texture;\n    this.mesh.material.needsUpdate = true;\n\n    if (projection === \"flat\") {\n      scaleToAspectRatio(this.el, ratio);\n    }\n\n    if (texture !== errorTexture && this.data.batch) {\n      this.el.sceneEl.systems[\"hubs-systems\"].batchManagerSystem.addObject(this.mesh);\n    }\n\n    this.el.emit(\"image-loaded\", { src: this.data.src, projection: projection });\n  }\n});\n\nAFRAME.registerComponent(\"media-pdf\", {\n  schema: {\n    src: { type: \"string\" },\n    projection: { type: \"string\", default: \"flat\" },\n    contentType: { type: \"string\" },\n    index: { default: 0 },\n    batch: { default: false }\n  },\n\n  init() {\n    this.canvas = document.createElement(\"canvas\");\n    this.canvasContext = this.canvas.getContext(\"2d\");\n    this.texture = new THREE.CanvasTexture(this.canvas);\n\n    this.texture.encoding = THREE.sRGBEncoding;\n    this.texture.minFilter = THREE.LinearFilter;\n  },\n\n  remove() {\n    if (this.data.batch && this.mesh) {\n      this.el.sceneEl.systems[\"hubs-systems\"].batchManagerSystem.removeObject(this.mesh);\n    }\n  },\n\n  currentTextureCacheKey() {\n    // We ensure a unique texture for each PDF entity, because they are drawn over during pagination.\n    return `${this.el.object3D.uuid}_${this.canvas.width}_${this.canvas.height}`;\n  },\n\n  async update(oldData) {\n    let texture;\n    let ratio = 1;\n\n    try {\n      const { src, index } = this.data;\n      if (!src) return;\n\n      if (this.renderTask) {\n        await this.renderTask.promise;\n        if (src !== this.data.src || index !== this.data.index) return;\n      }\n\n      this.el.emit(\"pdf-loading\");\n\n      if (src !== oldData.src) {\n        const loadingSrc = this.data.src;\n        const pdf = await pdfjs.getDocument(src);\n        if (loadingSrc !== this.data.src) return;\n\n        this.pdf = pdf;\n        this.el.setAttribute(\"media-pager\", { maxIndex: this.pdf.numPages - 1 });\n      }\n\n      const page = await this.pdf.getPage(index + 1);\n      if (src !== this.data.src || index !== this.data.index) return;\n\n      const viewport = page.getViewport({ scale: 3 });\n      const pw = viewport.width;\n      const ph = viewport.height;\n      texture = this.texture;\n      ratio = ph / pw;\n\n      this.canvas.width = pw;\n      this.canvas.height = ph;\n\n      this.renderTask = page.render({ canvasContext: this.canvasContext, viewport });\n\n      await this.renderTask.promise;\n\n      this.renderTask = null;\n\n      if (src !== this.data.src || index !== this.data.index) return;\n\n      this.currentPageTextureIsRetained = true;\n    } catch (e) {\n      console.error(\"Error loading PDF\", this.data.src, e);\n      texture = errorTexture;\n    }\n\n    if (!this.mesh) {\n      const material = new THREE.MeshBasicMaterial();\n      const geometry = new THREE.PlaneBufferGeometry(1, 1, 1, 1, texture.flipY);\n      material.side = THREE.DoubleSide;\n\n      this.mesh = new THREE.Mesh(geometry, material);\n      this.el.setObject3D(\"mesh\", this.mesh);\n    }\n\n    this.mesh.material.transparent = texture == errorTexture;\n    this.mesh.material.map = texture;\n    this.mesh.material.map.needsUpdate = true;\n    this.mesh.material.needsUpdate = true;\n\n    scaleToAspectRatio(this.el, ratio);\n\n    if (texture !== errorTexture && this.data.batch) {\n      this.el.sceneEl.systems[\"hubs-systems\"].batchManagerSystem.addObject(this.mesh);\n    }\n\n    if (this.el.components[\"media-pager\"] && this.el.components[\"media-pager\"].data.index !== this.data.index) {\n      this.el.setAttribute(\"media-pager\", { index: this.data.index });\n    }\n\n    this.el.emit(\"pdf-loaded\", { src: this.data.src });\n  }\n});\n","import { VOLUME_LABELS } from \"./media-views\";\n\nAFRAME.registerComponent(\"avatar-volume-controls\", {\n  schema: {\n    volume: { type: \"number\", default: 1.0 }\n  },\n\n  init() {\n    this.volumeUp = this.volumeUp.bind(this);\n    this.volumeDown = this.volumeDown.bind(this);\n    this.changeVolumeBy = this.changeVolumeBy.bind(this);\n    this.volumeUpButton = this.el.querySelector(\".avatar-volume-up-button\");\n    this.volumeDownButton = this.el.querySelector(\".avatar-volume-down-button\");\n    this.volumeLabel = this.el.querySelector(\".avatar-volume-label\");\n    this.volumeUpButton.object3D.addEventListener(\"interact\", this.volumeUp);\n    this.volumeDownButton.object3D.addEventListener(\"interact\", this.volumeDown);\n\n    this.updateVolumeLabel();\n  },\n\n  changeVolumeBy(v) {\n    this.el.setAttribute(\"avatar-volume-controls\", \"volume\", THREE.Math.clamp(this.data.volume + v, 0, 1));\n    this.updateVolumeLabel();\n  },\n\n  volumeUp() {\n    this.changeVolumeBy(0.1);\n  },\n\n  volumeDown() {\n    this.changeVolumeBy(-0.1);\n  },\n\n  update() {\n    if (this.audio) {\n      this.audio.gain.gain.value = this.data.volume;\n    }\n  },\n\n  updateVolumeLabel() {\n    this.volumeLabel.setAttribute(\n      \"text\",\n      \"value\",\n      this.data.volume === 0 ? \"Muted\" : VOLUME_LABELS[Math.floor(this.data.volume / 0.05)]\n    );\n  },\n\n  tick() {\n    if (this.audio) return;\n\n    // Walk up to Spine and then search down.\n    const source = this.el.parentNode.parentNode.querySelector(\"[networked-audio-source]\");\n    if (!source) return;\n\n    this.audio = source.components[\"networked-audio-source\"].sound;\n    this.update();\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\n\nAFRAME.registerComponent(\"pinch-to-move\", {\n  schema: {\n    speed: { default: 0.25 }\n  },\n  init() {\n    this.axis = [0, 0];\n  },\n  tick() {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const pinch = userinput.get(paths.device.touchscreen.pinchDelta);\n    if (pinch) {\n      this.axis[1] = pinch * this.data.speed;\n      this.el.emit(\"move\", { axis: this.axis });\n    }\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\n\nconst degToRad = THREE.Math.degToRad;\nconst radToDeg = THREE.Math.radToDeg;\n\nAFRAME.registerComponent(\"pitch-yaw-rotator\", {\n  schema: {\n    minPitch: { default: -90 },\n    maxPitch: { default: 90 }\n  },\n\n  init() {\n    this.pitch = 0;\n    this.yaw = 0;\n    this.onRotateX = this.onRotateX.bind(this);\n    this.el.sceneEl.addEventListener(\"rotateX\", this.onRotateX);\n    this.el.sceneEl.addEventListener(\"enter-vr\", () => this.pause());\n    this.el.sceneEl.addEventListener(\"exit-vr\", () => this.play());\n    this.pendingXRotation = 0;\n  },\n\n  onRotateX(e) {\n    this.pendingXRotation += e.detail.value;\n  },\n\n  look(deltaPitch, deltaYaw) {\n    const { minPitch, maxPitch } = this.data;\n    this.pitch += deltaPitch;\n    this.pitch = THREE.Math.clamp(this.pitch, minPitch, maxPitch);\n    this.yaw += deltaYaw;\n  },\n\n  set(pitch, yaw) {\n    const { minPitch, maxPitch } = this.data;\n    this.pitch = THREE.Math.clamp(radToDeg(pitch), minPitch, maxPitch);\n    this.yaw = radToDeg(yaw);\n  },\n\n  tick() {\n    const scene = AFRAME.scenes[0];\n    const userinput = scene.systems.userinput;\n    const cameraDelta = userinput.get(scene.is(\"entered\") ? paths.actions.cameraDelta : paths.actions.lobbyCameraDelta);\n    let lookX = this.pendingXRotation;\n    let lookY = 0;\n    if (cameraDelta) {\n      lookY += cameraDelta[0];\n      lookX += cameraDelta[1];\n    }\n    if (lookX !== 0 || lookY !== 0) {\n      this.look(lookX, lookY);\n      this.el.object3D.rotation.set(degToRad(this.pitch), degToRad(this.yaw), 0);\n      this.el.object3D.rotation.order = \"YXZ\";\n    }\n    this.pendingXRotation = 0;\n  }\n});\n","import { getBox } from \"../utils/auto-box-collider.js\";\nimport { getLastWorldPosition } from \"../utils/three-utils\";\n\nconst PI = Math.PI;\nconst HALF_PI = PI / 2;\nconst THREE_HALF_PI = 3 * HALF_PI;\nconst right = new THREE.Vector3(1, 0, 0);\nconst forward = new THREE.Vector3(0, 0, 1);\nconst left = new THREE.Vector3(-1, 0, 0);\nconst back = new THREE.Vector3(0, 0, -1);\nconst zero = new THREE.Vector3(0, 0, 0);\nconst dirs = {\n  left: {\n    dir: left,\n    rotation: THREE_HALF_PI,\n    halfExtent: \"x\"\n  },\n  right: {\n    dir: right,\n    rotation: HALF_PI,\n    halfExtent: \"x\"\n  },\n  forward: {\n    dir: forward,\n    rotation: 0,\n    halfExtent: \"z\"\n  },\n  back: {\n    dir: back,\n    rotation: PI,\n    halfExtent: \"z\"\n  }\n};\n\nAFRAME.registerComponent(\"position-at-box-shape-border\", {\n  multiple: true,\n  schema: {\n    target: { type: \"string\" },\n    dirs: { default: [\"left\", \"right\", \"forward\", \"back\"] },\n    animate: { default: true },\n    scale: { default: true }\n  },\n\n  init() {\n    this.cam = this.el.sceneEl.camera.el.object3D;\n    this._updateBox = this._updateBox.bind(this);\n    this._setupTarget = this._setupTarget.bind(this);\n    this.halfExtents = new THREE.Vector3();\n    this.el.sceneEl.systems[\"frame-scheduler\"].schedule(this._updateBox, \"media-components\");\n  },\n\n  remove() {\n    this.el.sceneEl.systems[\"frame-scheduler\"].unschedule(this._updateBox, \"media-components\");\n  },\n\n  update() {\n    this.dirs = this.data.dirs.map(d => dirs[d]);\n  },\n\n  _setupTarget() {\n    this.targetEl = this.el.querySelector(this.data.target);\n    if (!this.targetEl) {\n      console.warn(`Race condition on position-at-box-shape-border on selector ${this.data.target}`);\n      return;\n    }\n\n    this.target = this.targetEl.object3D;\n\n    this.targetEl.addEventListener(\"animationcomplete\", () => {\n      this.targetEl.removeAttribute(\"animation__show\");\n    });\n\n    this.target.scale.setScalar(0.01); // To avoid \"pop\" of gigantic button first time\n    this.target.matrixNeedsUpdate = true;\n  },\n\n  tick() {\n    if (!this.target) {\n      this._setupTarget();\n      return;\n    }\n\n    if (!this.el.getObject3D(\"mesh\")) {\n      return;\n    }\n\n    const isVisible = this.targetEl.object3D.visible;\n    const opening = isVisible && !this.wasVisible;\n    const scaleChanged =\n      this.el.object3D.scale.x !== this.previousScaleX ||\n      this.el.object3D.scale.y !== this.previousScaleY ||\n      this.el.object3D.scale.z !== this.previousScaleZ;\n    const isAnimating = this.targetEl.getAttribute(\"animation__show\");\n\n    // If the target is being shown or the scale changed while the opening animation is being run,\n    // we need to start or re-start the animation.\n    if (opening || (scaleChanged && isAnimating)) {\n      this._updateBox(this.data.animate, true);\n    }\n\n    this.wasVisible = isVisible;\n    this.previousScaleX = this.el.object3D.scale.x;\n    this.previousScaleY = this.el.object3D.scale.y;\n    this.previousScaleZ = this.el.object3D.scale.z;\n  },\n\n  _updateBox: (function() {\n    const camWorldPos = new THREE.Vector3();\n    const targetPosition = new THREE.Vector3();\n    const pointOnBoxFace = new THREE.Vector3();\n    const pointOnBoxFaceToCamera = new THREE.Vector3();\n    const boxCenter = new THREE.Vector3();\n    const tempParentWorldScale = new THREE.Vector3();\n    const boxFaceNormal = new THREE.Vector3();\n    const min = new THREE.Vector3(0.001, 0.001, 0.001);\n\n    return function(animate, forceNewExtents) {\n      if (forceNewExtents || this.mesh !== this.el.getObject3D(\"mesh\")) {\n        this.mesh = this.el.getObject3D(\"mesh\");\n\n        const box = getBox(this.el, this.mesh);\n        this.halfExtents = box.min\n          .clone()\n          .negate()\n          .add(box.max)\n          .multiplyScalar(0.65);\n\n        this.halfExtents.max(min);\n      }\n\n      if (!this.target) return;\n\n      getLastWorldPosition(this.cam, camWorldPos);\n\n      let targetSquareDistance = Infinity;\n      let targetDir = this.dirs[0].dir;\n      let targetHalfExtentStr = this.dirs[0].halfExtent;\n      let targetHalfExtent = this.halfExtents[targetHalfExtentStr];\n      let targetRotation = this.dirs[0].rotation;\n      let targetCameraDot = -1.1;\n\n      this.el.object3D.updateMatrices();\n\n      for (let i = 0; i < this.dirs.length; i++) {\n        const dir = this.dirs[i].dir;\n        const halfExtentStr = this.dirs[i].halfExtent;\n        const halfExtent = this.halfExtents[halfExtentStr];\n        pointOnBoxFace.copy(dir).multiplyScalar(halfExtent);\n        boxCenter.copy(zero);\n\n        this.el.object3D.localToWorld(pointOnBoxFace);\n        this.el.object3D.localToWorld(boxCenter);\n\n        pointOnBoxFaceToCamera.subVectors(camWorldPos, pointOnBoxFace);\n        pointOnBoxFaceToCamera.normalize();\n\n        boxFaceNormal.subVectors(pointOnBoxFace, boxCenter);\n        boxFaceNormal.normalize();\n\n        // Compute dot between camera + box normal to ensure menus are going to be\n        // somewhat perpendicular to camera frustum\n        const cameraAngleDotBoxNormal = boxFaceNormal.dot(pointOnBoxFaceToCamera);\n\n        const squareDistance = pointOnBoxFace.distanceToSquared(camWorldPos);\n        if (cameraAngleDotBoxNormal > targetCameraDot) {\n          targetSquareDistance = squareDistance;\n          targetDir = dir;\n          targetHalfExtent = halfExtent;\n          targetRotation = this.dirs[i].rotation;\n          targetHalfExtentStr = halfExtentStr;\n          targetCameraDot = cameraAngleDotBoxNormal;\n        }\n      }\n\n      this.target.position.copy(targetPosition.copy(targetDir).multiplyScalar(targetHalfExtent));\n      this.target.rotation.set(0, targetRotation, 0);\n\n      tempParentWorldScale.setFromMatrixScale(this.target.parent.matrixWorld);\n\n      const distance = Math.sqrt(targetSquareDistance);\n      const scale = Math.max(this.halfExtents.x, this.halfExtents.z) * distance;\n      const targetScale = Math.min(2.0, Math.max(0.5, scale * tempParentWorldScale.x));\n      const finalScale = this.data.scale ? targetScale / tempParentWorldScale.x : 1;\n\n      if (animate) {\n        this.targetEl.removeAttribute(\"animation__show\");\n\n        this.targetEl.setAttribute(\"animation__show\", {\n          property: \"scale\",\n          dur: 300,\n          from: { x: finalScale * 0.8, y: finalScale * 0.8, z: finalScale * 0.8 },\n          to: { x: finalScale, y: finalScale, z: finalScale },\n          easing: \"easeOutElastic\"\n        });\n      } else if (!this.targetEl.getAttribute(\"animation__show\")) {\n        this.target.scale.setScalar(finalScale);\n      }\n\n      this.target.matrixNeedsUpdate = true;\n    };\n  })()\n});\n","import { getPromotionTokenForFile } from \"../utils/media-utils\";\nimport { SOUND_PIN } from \"../systems/sound-effects-system\";\n\nAFRAME.registerComponent(\"pin-networked-object-button\", {\n  schema: {\n    // Selector for label informing users about Discord bridging of pins.\n    tipSelector: { type: \"string\" },\n\n    // Selector for label to change when pinned/unpinned, must be sibling of this components element\n    labelSelector: { type: \"string\" }\n  },\n\n  init() {\n    this._updateUI = this._updateUI.bind(this);\n    this._updateUIOnStateChange = this._updateUIOnStateChange.bind(this);\n    this.el.sceneEl.addEventListener(\"stateadded\", this._updateUIOnStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this._updateUIOnStateChange);\n\n    this.tipEl = this.el.parentNode.querySelector(this.data.tipSelector);\n    this.labelEl = this.el.parentNode.querySelector(this.data.labelSelector);\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n\n      this._updateUI();\n      this.targetEl.addEventListener(\"pinned\", this._updateUI);\n      this.targetEl.addEventListener(\"unpinned\", this._updateUI);\n    });\n\n    this.onHovered = () => {\n      this.hovering = true;\n      this._updateUI();\n    };\n\n    this.onUnhovered = () => {\n      this.hovering = false;\n      this._updateUI();\n    };\n\n    this.onClick = () => {\n      if (!NAF.utils.isMine(this.targetEl) && !NAF.utils.takeOwnership(this.targetEl)) return;\n\n      const wasPinned = this.targetEl.components.pinnable && this.targetEl.components.pinnable.data.pinned;\n      this.targetEl.setAttribute(\"pinnable\", \"pinned\", !wasPinned);\n      if (!wasPinned) {\n        this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_PIN);\n      }\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n    this.el.object3D.addEventListener(\"hovered\", this.onHovered);\n    this.el.object3D.addEventListener(\"unhovered\", this.onUnhovered);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n    this.el.object3D.removeEventListener(\"hovered\", this.onHovered);\n    this.el.object3D.removeEventListener(\"unhovered\", this.onUnhovered);\n  },\n\n  remove() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this._updateUIOnStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this._updateUIOnStateChange);\n\n    if (this.targetEl) {\n      this.targetEl.removeEventListener(\"pinned\", this._updateUI);\n      this.targetEl.removeEventListener(\"unpinned\", this._updateUI);\n    }\n  },\n\n  _discordBridges() {\n    return window.APP.hubChannel.discordBridges();\n  },\n\n  _updateUIOnStateChange(e) {\n    if (e.detail !== \"frozen\") return;\n    this._updateUI();\n  },\n\n  _updateUI() {\n    const { fileIsOwned, fileId } = this.targetEl.components[\"media-loader\"].data;\n    const canPin =\n      window.APP.hubChannel.can(\"pin_objects\") && !!(fileIsOwned || (fileId && getPromotionTokenForFile(fileId)));\n    this.el.object3D.visible = canPin;\n    this.labelEl.object3D.visible = canPin;\n\n    const isPinned = this.targetEl.getAttribute(\"pinnable\") && this.targetEl.getAttribute(\"pinnable\").pinned;\n    const discordBridges = this._discordBridges();\n    this.tipEl.object3D.visible = !!(canPin && !isPinned && this.hovering && discordBridges.length > 0);\n\n    if (!canPin) return;\n    this.labelEl.setAttribute(\"text\", \"value\", isPinned ? \"un-pin\" : \"pin\");\n    this.el.setAttribute(\"text-button\", \"backgroundColor\", isPinned ? \"#fff\" : \"#ff3550\");\n    this.el.setAttribute(\"text-button\", \"backgroundHoverColor\", isPinned ? \"#bbb\" : \"#fc3545\");\n  }\n});\n","import { findAncestorWithComponent } from \"../utils/scene-graph\";\n\nAFRAME.registerComponent(\"unmute-video-button\", {\n  init() {\n    this.onClick = () => {\n      const videoEl = findAncestorWithComponent(this.el, \"media-video\");\n      const mediaVideo = videoEl.components[\"media-video\"];\n      if (!mediaVideo || !mediaVideo.video || !mediaVideo.videoMutedAt) return;\n\n      // iOS initially plays the sound and *then* mutes it, and sometimes a second video playing\n      // can break all sound in the app. (Likely a Safari bug.) Adding a delay before the unmute\n      // occurs seems to help with reducing this.\n      if (performance.now() - mediaVideo.videoMutedAt < 3000) {\n        return;\n      }\n\n      if (mediaVideo.video.muted) {\n        mediaVideo.video.muted = false;\n        this.el.setAttribute(\"visible\", false);\n      }\n    };\n  },\n\n  play() {\n    // Safari won't accept grab-start or even mousedown as user-initiated gestures,\n    // so we have to use a global touchstart event here.\n    document.addEventListener(\"touchstart\", this.onClick);\n  },\n\n  pause() {\n    document.removeEventListener(\"touchstart\", this.onClick);\n  }\n});\n","import { getLastWorldPosition } from \"../utils/three-utils\";\n\nAFRAME.registerComponent(\"destroy-at-extreme-distances\", {\n  schema: {\n    xMin: { default: -1000 },\n    xMax: { default: 1000 },\n    yMin: { default: -1000 },\n    yMax: { default: 1000 },\n    zMin: { default: -1000 },\n    zMax: { default: 1000 }\n  },\n\n  init() {\n    this._checkForDestroy = this._checkForDestroy.bind(this);\n    this.el.sceneEl.systems[\"frame-scheduler\"].schedule(this._checkForDestroy, \"media-components\");\n  },\n\n  remove() {\n    this.el.sceneEl.systems[\"frame-scheduler\"].unschedule(this._checkForDestroy, \"media-components\");\n  },\n\n  _checkForDestroy: (function() {\n    const pos = new THREE.Vector3();\n    return function() {\n      const { xMin, xMax, yMin, yMax, zMin, zMax } = this.data;\n      getLastWorldPosition(this.el.object3D, pos);\n\n      if (pos.x < xMin || pos.x > xMax || pos.y < yMin || pos.y > yMax || pos.z < zMin || pos.z > zMax) {\n        if (!this.el.components.networked || NAF.utils.isMine(this.el)) {\n          this.el.parentNode.removeChild(this.el);\n        }\n      }\n    };\n  })()\n});\n","import { addAndArrangeMedia } from \"../utils/media-utils\";\nimport { createImageBitmap } from \"../utils/image-bitmap-utils\";\nimport { ObjectTypes } from \"../object-types\";\nimport { paths } from \"../systems/userinput/paths\";\nimport { SOUND_CAMERA_TOOL_TOOK_SNAPSHOT, SOUND_CAMERA_TOOL_COUNTDOWN } from \"../systems/sound-effects-system\";\nimport { getAudioFeedbackScale } from \"./audio-feedback\";\n\nimport cameraModelSrc from \"../assets/camera_tool.glb\";\n\nconst cameraModelPromise = new Promise(resolve => new THREE.GLTFLoader().load(cameraModelSrc, resolve));\n\nconst pathsMap = {\n  \"player-right-controller\": {\n    takeSnapshot: paths.actions.rightHand.takeSnapshot\n  },\n  \"player-left-controller\": {\n    takeSnapshot: paths.actions.leftHand.takeSnapshot\n  },\n  cursor: {\n    takeSnapshot: paths.actions.cursor.takeSnapshot\n  }\n};\n\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\n\nconst VIEWFINDER_FPS = 6;\nconst VIDEO_FPS = 25;\n// Prefer h264 if available due to faster decoding speec on most platforms\nconst videoCodec = [\"h264\", \"vp9\", \"vp8\"].find(\n  codec => window.MediaRecorder && MediaRecorder.isTypeSupported(`video/webm; codecs=${codec}`)\n);\nconst videoMimeType = videoCodec ? `video/webm; codecs=${videoCodec}` : null;\nconst hasWebGL2 = !!document.createElement(\"canvas\").getContext(\"webgl2\");\nconst allowVideo = !!videoMimeType && hasWebGL2;\n\nconst CAPTURE_WIDTH = isMobileVR ? 640 : 1280;\nconst CAPTURE_HEIGHT = isMobileVR ? 360 : 720;\nconst RENDER_WIDTH = 1280;\nconst RENDER_HEIGHT = 720;\nconst CAPTURE_DURATIONS = allowVideo ? [0, 3, 7, 15, 30, 60, Infinity] : [0];\nconst DEFAULT_CAPTURE_DURATION = allowVideo ? 3 : 0;\nconst COUNTDOWN_DURATION = 3;\nconst VIDEO_LOOPS = 3; // Number of times to loop the videos we spawn before stopping them (for perf)\nconst MAX_DURATION_TO_LIMIT_LOOPS = 31; // Max duration for which we limit loops (eg GIFs vs long form videos)\n\nconst snapCanvas = document.createElement(\"canvas\");\n\nasync function pixelsToPNG(pixels, width, height) {\n  snapCanvas.width = width;\n  snapCanvas.height = height;\n  const context = snapCanvas.getContext(\"2d\");\n\n  const imageData = context.createImageData(width, height);\n  imageData.data.set(pixels);\n  const bitmap = await createImageBitmap(imageData);\n  context.scale(1, -1);\n  context.drawImage(bitmap, 0, -height);\n  const blob = await new Promise(resolve => snapCanvas.toBlob(resolve));\n  return new File([blob], \"snap.png\", { type: \"image/png\" });\n}\n\nfunction blitFramebuffer(renderer, src, srcX0, srcY0, srcX1, srcY1, dest, dstX0, dstY0, dstX1, dstY1) {\n  const gl = renderer.context;\n\n  // Copies from one framebuffer to another. Note that at the end of this function, you need to restore\n  // the original framebuffer via setRenderTarget\n  const srcFramebuffer = renderer.properties.get(src).__webglFramebuffer;\n  const destFramebuffer = renderer.properties.get(dest).__webglFramebuffer;\n\n  if (srcFramebuffer && destFramebuffer) {\n    gl.bindFramebuffer(gl.READ_FRAMEBUFFER, srcFramebuffer);\n    gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER, destFramebuffer);\n\n    if (gl.checkFramebufferStatus(gl.READ_FRAMEBUFFER) === gl.FRAMEBUFFER_COMPLETE) {\n      gl.blitFramebuffer(srcX0, srcY0, srcX1, srcY1, dstX0, dstY0, dstX1, dstY1, gl.COLOR_BUFFER_BIT, gl.LINEAR);\n    }\n  }\n}\n\nAFRAME.registerComponent(\"camera-tool\", {\n  schema: {\n    captureDuration: { default: DEFAULT_CAPTURE_DURATION },\n    captureAudio: { default: false },\n    isSnapping: { default: false },\n    isRecording: { default: false },\n    label: { default: \"\" }\n  },\n\n  init() {\n    this.lastUpdate = performance.now();\n    this.localSnapCount = 0; // Counter that is used to arrange photos/videos\n\n    this.showCameraViewfinder = !isMobileVR;\n\n    this.renderTarget = new THREE.WebGLRenderTarget(RENDER_WIDTH, RENDER_HEIGHT, {\n      format: THREE.RGBAFormat,\n      minFilter: THREE.LinearFilter,\n      magFilter: THREE.NearestFilter,\n      encoding: THREE.sRGBEncoding,\n      depth: false,\n      stencil: false\n    });\n\n    this.camera = new THREE.PerspectiveCamera(50, RENDER_WIDTH / RENDER_HEIGHT, 0.1, 30000);\n    this.camera.rotation.set(0, Math.PI, 0);\n    this.camera.position.set(0, 0, 0.05);\n    this.camera.matrixNeedsUpdate = true;\n    this.el.setObject3D(\"camera\", this.camera);\n\n    const material = new THREE.MeshBasicMaterial({\n      map: this.renderTarget.texture\n    });\n\n    // Bit of a hack here to only update the renderTarget when the screens are in view\n    material.map.isVideoTexture = true;\n    material.map.update = () => {\n      if (this.showCameraViewfinder) {\n        this.viewfinderInViewThisFrame = true;\n      }\n    };\n\n    this.el.sceneEl.addEventListener(\"stateadded\", () => this.updateUI());\n    this.el.sceneEl.addEventListener(\"stateremoved\", () => this.updateUI());\n\n    cameraModelPromise.then(model => {\n      const mesh = model.scene.clone();\n      mesh.scale.set(2, 2, 2);\n      mesh.matrixNeedsUpdate = true;\n      this.el.setObject3D(\"mesh\", mesh);\n\n      const width = 0.28;\n      const geometry = new THREE.PlaneBufferGeometry(width, width / this.camera.aspect);\n\n      const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\n      if (environmentMapComponent) {\n        environmentMapComponent.applyEnvironmentMap(this.el.object3D);\n      }\n\n      this.screen = new THREE.Mesh(geometry, material);\n      this.screen.rotation.set(0, Math.PI, 0);\n      this.screen.position.set(0, 0, -0.042);\n      this.screen.matrixNeedsUpdate = true;\n      this.el.setObject3D(\"screen\", this.screen);\n\n      this.selfieScreen = new THREE.Mesh(geometry, material);\n      this.selfieScreen.position.set(0, 0.4, 0);\n      this.selfieScreen.scale.set(-2, 2, 2);\n      this.selfieScreen.matrixNeedsUpdate = true;\n      this.el.setObject3D(\"selfieScreen\", this.selfieScreen);\n\n      this.label = this.el.querySelector(\".label\");\n      this.labelActionBackground = this.el.querySelector(\".label-action-background\");\n      this.labelBackground = this.el.querySelector(\".label-background\");\n      this.durationLabel = this.el.querySelector(\".duration\");\n\n      this.snapIcon = this.el.querySelector(\".snap-icon\");\n      this.recordIcon = this.el.querySelector(\".record-icon\");\n      this.recordAlphaIcon = this.el.querySelector(\".record-alpha-icon\");\n\n      this.label.object3D.visible = false;\n      this.durationLabel.object3D.visible = false;\n\n      this.snapMenu = this.el.querySelector(\".camera-snap-menu\");\n      this.playerCamera = document.querySelector(\"#player-camera\").getObject3D(\"camera\");\n      this.snapButton = this.el.querySelector(\".snap-button\");\n      this.cancelButton = this.el.querySelector(\".cancel-button\");\n      this.nextDurationButton = this.el.querySelector(\".next-duration\");\n      this.prevDurationButton = this.el.querySelector(\".prev-duration\");\n      this.snapButton.object3D.addEventListener(\"interact\", () => this.snapClicked());\n      this.cancelButton.object3D.addEventListener(\"interact\", () => this.cancelSnapping());\n      this.nextDurationButton.object3D.addEventListener(\"interact\", () => this.changeDuration(1));\n      this.prevDurationButton.object3D.addEventListener(\"interact\", () => this.changeDuration(-1));\n      this.stopButton = this.el.querySelector(\".stop-button\");\n      this.stopButton.object3D.addEventListener(\"interact\", () => this.stopRecording());\n      this.captureAudioButton = this.el.querySelector(\".capture-audio\");\n      this.captureAudioIcon = this.el.querySelector(\".capture-audio-icon\");\n      this.captureAudioButton.object3D.addEventListener(\"interact\", () =>\n        this.el.setAttribute(\"camera-tool\", \"captureAudio\", !this.data.captureAudio)\n      );\n\n      this.updateUI();\n\n      this.updateRenderTargetNextTick = true;\n\n      this.cameraSystem = this.el.sceneEl.systems[\"camera-tools\"];\n      this.cameraSystem.register(this.el);\n    });\n  },\n\n  remove() {\n    this.cameraSystem.deregister(this.el);\n    this.el.sceneEl.emit(\"camera_removed\");\n    this.stopRecording();\n  },\n\n  updateViewfinder() {\n    this.updateRenderTargetNextTick = true;\n  },\n\n  changeDuration(delta) {\n    const idx = CAPTURE_DURATIONS.findIndex(d => this.data.captureDuration == d);\n    const newIdx = idx === 0 && delta === -1 ? CAPTURE_DURATIONS.length - 1 : (idx + delta) % CAPTURE_DURATIONS.length;\n    this.el.setAttribute(\"camera-tool\", \"captureDuration\", CAPTURE_DURATIONS[newIdx]);\n  },\n\n  focus(el, track) {\n    if (track) {\n      this.trackTarget = el;\n    } else {\n      this.trackTarget = null;\n    }\n\n    this.lookAt(el);\n  },\n\n  lookAt: (function() {\n    const targetPos = new THREE.Vector3();\n    return function(el) {\n      targetPos.setFromMatrixPosition(el.object3D.matrixWorld);\n      this.el.object3D.lookAt(targetPos);\n      this.el.object3D.matrixNeedsUpdate = true;\n    };\n  })(),\n\n  snapClicked() {\n    if (this.data.isSnapping) return;\n    if (!NAF.utils.isMine(this.el) && !NAF.utils.takeOwnership(this.el)) return;\n\n    this.el.setAttribute(\"camera-tool\", \"isSnapping\", true);\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_COUNTDOWN);\n\n    this.snapCountdown = COUNTDOWN_DURATION;\n    this.el.setAttribute(\"camera-tool\", \"label\", `${this.snapCountdown}`);\n\n    this.countdownInterval = setInterval(async () => {\n      if (!NAF.utils.isMine(this.el) && !NAF.utils.takeOwnership(this.el)) {\n        clearInterval(this.countdownInterval);\n        this.countdownInterval = null;\n        return;\n      }\n\n      this.snapCountdown--;\n\n      if (this.snapCountdown === 0) {\n        clearInterval(this.countdownInterval);\n        this.countdownInterval = null;\n\n        if (this.data.captureDuration === 0) {\n          this.el.setAttribute(\"camera-tool\", { label: \"\", isSnapping: false });\n          this.takeSnapshotNextTick = true;\n        } else {\n          this.beginRecording(this.data.captureDuration);\n        }\n      } else {\n        this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_COUNTDOWN);\n        this.el.setAttribute(\"camera-tool\", \"label\", `${this.snapCountdown}`);\n      }\n    }, 1000);\n  },\n\n  cancelSnapping() {\n    clearInterval(this.countdownInterval);\n    this.stopRecording(true);\n    this.updateUI();\n  },\n\n  update() {\n    this.updateUI();\n  },\n\n  updateUI() {\n    if (!this.label) return;\n\n    const label = this.data.label;\n    const isFrozen = this.el.sceneEl.is(\"frozen\");\n    const hasDuration = this.data.captureDuration !== 0 && this.data.captureDuration !== Infinity;\n    const isPhoto = this.data.captureDuration === 0;\n\n    const isRecordingUnbound = !hasDuration && this.data.isRecording && this.videoRecorder;\n    this.label.object3D.visible = !!label && !isRecordingUnbound;\n    const showActionLabelBackground = this.label.object3D.visible && this.data.isRecording && !isRecordingUnbound;\n\n    if (label) {\n      this.label.setAttribute(\"text\", { value: label, color: showActionLabelBackground ? \"#fafafa\" : \"#ff3464\" });\n    }\n\n    this.labelActionBackground.object3D.visible = showActionLabelBackground;\n    this.labelBackground.object3D.visible = this.label.object3D.visible && !showActionLabelBackground;\n\n    this.stopButton.object3D.visible = isRecordingUnbound;\n\n    if (hasDuration) {\n      this.durationLabel.setAttribute(\"text\", \"value\", `${this.data.captureDuration}`);\n    }\n\n    this.durationLabel.object3D.visible = hasDuration && !this.data.isSnapping && !isFrozen;\n    this.recordIcon.object3D.visible = !hasDuration && !isPhoto && !isFrozen;\n    this.recordAlphaIcon.object3D.visible = hasDuration && !isPhoto && !isFrozen;\n    this.snapIcon.object3D.visible = isPhoto && !isFrozen;\n    this.snapButton.object3D.visible = !this.data.isSnapping && !isFrozen;\n    this.cancelButton.object3D.visible = this.data.isSnapping && !isFrozen;\n    this.prevDurationButton.object3D.visible = this.nextDurationButton.object3D.visible =\n      !this.data.isSnapping && allowVideo && !isFrozen;\n\n    this.captureAudioIcon.setAttribute(\"icon-button\", \"active\", this.data.captureAudio);\n  },\n\n  async beginRecording(duration) {\n    if (!this.videoContext) {\n      this.videoCanvas = document.createElement(\"canvas\");\n      this.videoCanvas.width = CAPTURE_WIDTH;\n      this.videoCanvas.height = CAPTURE_HEIGHT;\n      this.videoContext = this.videoCanvas.getContext(\"2d\");\n      this.videoImageData = this.videoContext.createImageData(CAPTURE_WIDTH, CAPTURE_HEIGHT);\n      this.videoPixels = new Uint8Array(CAPTURE_WIDTH * CAPTURE_HEIGHT * 4);\n      this.videoImageData.data.set(this.videoPixels);\n    }\n\n    const stream = new MediaStream();\n    const track = this.videoCanvas.captureStream(VIDEO_FPS).getVideoTracks()[0];\n\n    if (this.data.captureAudio) {\n      const selfAudio = await NAF.connection.adapter.getMediaStream(NAF.clientId, \"audio\");\n\n      // NOTE: if we don't have a self audio track, we can end up generating an empty video (browser bug?)\n      // if no audio comes through on the listener source. (Eg the room is otherwise silent.)\n      // So for now, if we don't have a track, just disable audio capture.\n      if (selfAudio && selfAudio.getAudioTracks().length > 0) {\n        const context = THREE.AudioContext.getContext();\n        const destination = context.createMediaStreamDestination();\n\n        const listener = this.el.sceneEl.audioListener;\n        if (listener) {\n          // NOTE audio is not captured from camera vantage point for now.\n          listener.getInput().connect(destination);\n        }\n        context.createMediaStreamSource(selfAudio).connect(destination);\n\n        const audio = destination.stream.getAudioTracks()[0];\n        stream.addTrack(audio);\n      }\n    }\n\n    stream.addTrack(track);\n    this.videoRecorder = new MediaRecorder(stream, { mimeType: videoMimeType });\n    const chunks = [];\n    const recordingStartTime = performance.now();\n\n    this.videoRecorder.ondataavailable = e => chunks.push(e.data);\n\n    this.updateRenderTargetNextTick = true;\n\n    this.videoRecorder.start();\n    this.el.setAttribute(\"camera-tool\", { isRecording: true, label: \" \" });\n    this.el.sceneEl.emit(\"action_camera_recording_started\");\n\n    if (duration !== Infinity) {\n      this.videoCountdown = this.data.captureDuration;\n      this.el.setAttribute(\"camera-tool\", \"label\", `${this.videoCountdown}`);\n\n      this.videoCountdownInterval = setInterval(() => {\n        this.videoCountdown--;\n\n        if (this.videoCountdown === 0) {\n          this.stopRecording();\n          this.videoCountdownInterval = null;\n        } else {\n          this.el.setAttribute(\"camera-tool\", \"label\", `${this.videoCountdown}`);\n        }\n      }, 1000);\n    }\n\n    this.videoRecorder._free = () => (chunks.length = 0); // Used for cancelling\n    this.videoRecorder.onstop = async () => {\n      this.el.sceneEl.emit(\"action_camera_recording_ended\");\n\n      if (chunks.length === 0) return;\n      const mimeType = chunks[0].type;\n      const recordingDuration = performance.now() - recordingStartTime;\n      const blob = new Blob(chunks, { type: mimeType });\n\n      chunks.length = 0;\n\n      const { entity, orientation } = addAndArrangeMedia(\n        this.el,\n        new File([blob], \"capture\", { type: mimeType.split(\";\")[0] }), // Drop codec\n        \"video-camera\",\n        this.localSnapCount,\n        !!this.playerIsBehindCamera\n      );\n\n      entity.addEventListener(\n        \"video-loaded\",\n        () => {\n          // If we were recording audio, then pause the video immediately after starting.\n          //\n          // Or, to limit the # of concurrent videos playing, if it was a short clip, let it loop\n          // a few times and then pause it.\n          if (this.data.captureAudio || recordingDuration <= MAX_DURATION_TO_LIMIT_LOOPS * 1000) {\n            setTimeout(() => {\n              if (!NAF.utils.isMine(entity) && !NAF.utils.takeOwnership(entity)) return;\n              entity.components[\"media-video\"].tryUpdateVideoPlaybackState(true);\n            }, this.data.captureAudio ? 0 : recordingDuration * VIDEO_LOOPS + 100);\n          }\n        },\n        { once: true }\n      );\n\n      this.localSnapCount++;\n\n      orientation.then(() => this.el.sceneEl.emit(\"object_spawned\", { objectType: ObjectTypes.CAMERA }));\n    };\n  },\n\n  stopRecording(cancel) {\n    if (this.videoRecorder) {\n      if (cancel) {\n        this.videoRecorder.onstop = () => {};\n        this.videoRecorder._free();\n      }\n\n      this.videoRecorder.stop();\n      this.videoRecorder = null;\n\n      if (!cancel) {\n        this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_TOOK_SNAPSHOT);\n      }\n    }\n    clearInterval(this.videoCountdownInterval);\n\n    this.videoCountdownInterval = null;\n    this.el.setAttribute(\"camera-tool\", \"label\", \"\");\n    this.el.setAttribute(\"camera-tool\", { isRecording: false, isSnapping: false });\n  },\n\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const heldLeftHand = interaction.state.leftHand.held === this.el;\n    const heldRightHand = interaction.state.rightHand.held === this.el;\n    const heldRightRemote = interaction.state.rightRemote.held === this.el;\n\n    const heldThisFrame =\n      (heldLeftHand && userinput.get(interaction.options.leftHand.grabPath)) ||\n      (heldRightHand && userinput.get(interaction.options.rightHand.grabPath)) ||\n      (heldRightRemote && userinput.get(interaction.options.rightRemote.grabPath));\n\n    const isHolding = heldLeftHand || heldRightHand || heldRightRemote;\n\n    this.updateSnapMenuOrientation();\n\n    if (heldThisFrame) {\n      this.localSnapCount = 0;\n    }\n\n    this.showCameraViewfinder = isHolding || !isMobileVR || this.data.isSnapping || this.videoRecorder;\n\n    if (this.screen && this.selfieScreen) {\n      this.screen.visible = this.selfieScreen.visible = !!this.showCameraViewfinder;\n    }\n\n    // Always draw held, snapping, or recording camera viewfinders with a decent framerate\n    if (\n      (isHolding || this.data.isSnapping || this.videoRecorder) &&\n      performance.now() - this.lastUpdate >= 1000 / (this.videoRecorder ? VIDEO_FPS : VIEWFINDER_FPS)\n    ) {\n      this.updateRenderTargetNextTick = true;\n    }\n\n    const isHoldingTrigger = this.isHoldingSnapshotTrigger();\n    const isPermittedToUse = window.APP.hubChannel.can(\"spawn_camera\");\n\n    if (isPermittedToUse) {\n      // If the user lets go of the trigger before 500ms, take a picture, otherwise record until they let go.\n      if (isHoldingTrigger && !this.data.isSnapping && !this.snapTriggerTimeout) {\n        this.snapTriggerTimeout = setTimeout(() => {\n          if (this.isHoldingSnapshotTrigger()) {\n            this.el.setAttribute(\"camera-tool\", \"isSnapping\", true);\n            this.beginRecording(Infinity);\n\n            const releaseInterval = setInterval(() => {\n              if (this.isHoldingSnapshotTrigger()) return;\n              this.stopRecording();\n              clearInterval(releaseInterval);\n            }, 500);\n          }\n\n          this.snapTriggerTimeout = null;\n        }, 500);\n      } else if (!isHoldingTrigger && !this.data.isSnapping && this.snapTriggerTimeout) {\n        clearTimeout(this.snapTriggerTimeout);\n        this.snapTriggerTimeout = null;\n        this.takeSnapshotNextTick = true;\n      }\n    }\n  },\n\n  tock: (function() {\n    const tempHeadScale = new THREE.Vector3();\n\n    return function tock() {\n      const sceneEl = this.el.sceneEl;\n      const renderer = this.renderer || sceneEl.renderer;\n      const now = performance.now();\n      const playerHead = this.cameraSystem.playerHead;\n\n      // Perform lookAt in tock so it will re-orient after grabs, etc.\n      if (this.trackTarget) {\n        if (this.trackTarget.parentNode) {\n          this.lookAt(this.trackTarget);\n        } else {\n          this.trackTarget = null; // Target removed\n        }\n      }\n\n      if (!this.playerHud) {\n        const hudEl = document.getElementById(\"player-hud\");\n        this.playerHud = hudEl && hudEl.object3D;\n      }\n\n      if (\n        this.takeSnapshotNextTick ||\n        (this.updateRenderTargetNextTick && (this.viewfinderInViewThisFrame || this.videoRecorder))\n      ) {\n        if (playerHead) {\n          tempHeadScale.copy(playerHead.scale);\n\n          // We want to scale our own head in between frames now that we're taking a video/photo.\n          let scale = 1;\n          // TODO: The local-audio-analyser has the non-networked media stream, which is active\n          // even while the user is muted. This should be looking at a different analyser that\n          // has the networked media stream instead.\n          const analyser = this.el.sceneEl.systems[\"local-audio-analyser\"];\n\n          if (analyser && playerHead.el.components[\"scale-audio-feedback\"]) {\n            scale = getAudioFeedbackScale(this.el.object3D, playerHead, 1, 2, analyser.volume);\n          }\n\n          playerHead.scale.set(scale, scale, scale);\n          playerHead.updateMatrices(true, true);\n          playerHead.updateMatrixWorld(true, true);\n        }\n\n        let playerHudWasVisible = false;\n\n        if (this.playerHud) {\n          playerHudWasVisible = this.playerHud.visible;\n          this.playerHud.visible = false;\n          if (this.el.sceneEl.systems[\"post-physics\"]) {\n            this.el.sceneEl.systems[\"post-physics\"].spriteSystem.mesh.visible = false;\n          }\n        }\n\n        const tmpVRFlag = renderer.vr.enabled;\n        const tmpOnAfterRender = sceneEl.object3D.onAfterRender;\n        delete sceneEl.object3D.onAfterRender;\n        renderer.vr.enabled = false;\n\n        if (allowVideo && this.videoRecorder && !this.videoRenderTarget) {\n          // Create a separate render target for video becuase we need to flip and (sometimes) downscale it before\n          // encoding it to video.\n          this.videoRenderTarget = new THREE.WebGLRenderTarget(CAPTURE_WIDTH, CAPTURE_HEIGHT, {\n            format: THREE.RGBAFormat,\n            minFilter: THREE.LinearFilter,\n            magFilter: THREE.NearestFilter,\n            encoding: THREE.sRGBEncoding,\n            depth: false,\n            stencil: false\n          });\n\n          // Used to set up framebuffer in three.js as a side effect\n          renderer.setRenderTarget(this.videoRenderTarget);\n        }\n\n        renderer.setRenderTarget(this.renderTarget);\n        renderer.render(sceneEl.object3D, this.camera);\n        renderer.setRenderTarget(null);\n\n        renderer.vr.enabled = tmpVRFlag;\n        sceneEl.object3D.onAfterRender = tmpOnAfterRender;\n        if (playerHead) {\n          playerHead.scale.copy(tempHeadScale);\n          playerHead.updateMatrices(true, true);\n          playerHead.updateMatrixWorld(true, true);\n        }\n        if (this.playerHud) {\n          this.playerHud.visible = playerHudWasVisible;\n          if (this.el.sceneEl.systems[\"post-physics\"]) {\n            this.el.sceneEl.systems[\"post-physics\"].spriteSystem.mesh.visible = true;\n          }\n        }\n        this.lastUpdate = now;\n\n        if (this.videoRecorder) {\n          // This blit operation will (if necessary) scale/resample the view finder render target and, importantly,\n          // flip the texture on Y\n          blitFramebuffer(\n            renderer,\n            this.renderTarget,\n            0,\n            0,\n            RENDER_WIDTH,\n            RENDER_HEIGHT,\n            this.videoRenderTarget,\n            0,\n            CAPTURE_HEIGHT,\n            CAPTURE_WIDTH,\n            0\n          );\n          renderer.readRenderTargetPixels(\n            this.videoRenderTarget,\n            0,\n            0,\n            CAPTURE_WIDTH,\n            CAPTURE_HEIGHT,\n            this.videoPixels\n          );\n          this.videoImageData.data.set(this.videoPixels);\n          this.videoContext.putImageData(this.videoImageData, 0, 0);\n        }\n\n        this.updateRenderTargetNextTick = false;\n        this.viewfinderInViewThisFrame = false;\n      }\n\n      if (this.takeSnapshotNextTick) {\n        if (!this.snapPixels) {\n          this.snapPixels = new Uint8Array(RENDER_WIDTH * RENDER_HEIGHT * 4);\n        }\n        renderer.readRenderTargetPixels(this.renderTarget, 0, 0, RENDER_WIDTH, RENDER_HEIGHT, this.snapPixels);\n\n        pixelsToPNG(this.snapPixels, RENDER_WIDTH, RENDER_HEIGHT).then(file => {\n          const { orientation } = addAndArrangeMedia(\n            this.el,\n            file,\n            \"photo-camera\",\n            this.localSnapCount,\n            !!this.playerIsBehindCamera\n          );\n\n          orientation.then(() => {\n            this.el.sceneEl.emit(\"object_spawned\", { objectType: ObjectTypes.CAMERA });\n          });\n        });\n        sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_TOOK_SNAPSHOT);\n        this.takeSnapshotNextTick = false;\n        this.localSnapCount++;\n      }\n    };\n  })(),\n\n  isHoldingSnapshotTrigger: function() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const heldLeftHand = interaction.state.leftHand.held === this.el;\n    const heldRightHand = interaction.state.rightHand.held === this.el;\n    const heldRightRemote = interaction.state.rightRemote.held === this.el;\n\n    let grabberId;\n    if (heldRightHand) {\n      grabberId = \"player-right-controller\";\n    } else if (heldLeftHand) {\n      grabberId = \"player-left-controller\";\n    } else if (heldRightRemote) {\n      grabberId = \"cursor\";\n    }\n\n    if (grabberId) {\n      const grabberPaths = pathsMap[grabberId];\n      if (userinput.get(grabberPaths.takeSnapshot)) {\n        return true;\n      }\n    }\n\n    return !!userinput.get(paths.actions.takeSnapshot);\n  },\n\n  updateSnapMenuOrientation: (function() {\n    const playerWorld = new THREE.Vector3();\n    const cameraWorld = new THREE.Vector3();\n    const playerToCamera = new THREE.Vector3();\n    const cameraForwardPoint = new THREE.Vector3();\n    const cameraForwardWorld = new THREE.Vector3();\n    return function() {\n      this.el.object3D.getWorldPosition(cameraWorld);\n      this.playerCamera.getWorldPosition(playerWorld);\n      playerToCamera.subVectors(playerWorld, cameraWorld);\n      cameraForwardPoint.set(0, 0, 1);\n      this.el.object3D.localToWorld(cameraForwardPoint);\n      cameraForwardWorld.subVectors(cameraForwardPoint, cameraWorld);\n      cameraForwardWorld.normalize();\n      playerToCamera.normalize();\n\n      const playerIsBehindCamera = cameraForwardWorld.dot(playerToCamera) < 0;\n\n      if (this.playerIsBehindCamera !== playerIsBehindCamera) {\n        this.playerIsBehindCamera = playerIsBehindCamera;\n        this.snapMenu.object3D.rotation.set(0, this.playerIsBehindCamera ? Math.PI : 0, 0);\n        this.snapMenu.object3D.matrixNeedsUpdate = true;\n      }\n    };\n  })()\n});\n","import { addMedia } from \"../utils/media-utils\";\nimport { ObjectContentOrigins } from \"../object-types\";\nimport { guessContentType } from \"../utils/media-url-utils\";\n\nAFRAME.registerComponent(\"clone-media-button\", {\n  init() {\n    this.updateSrc = () => {\n      const src = (this.src = this.targetEl.components[\"media-loader\"].data.src);\n      const visible = src && guessContentType(src) !== \"video/vnd.hubs-webrtc\";\n      this.el.object3D.visible = !!visible;\n    };\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n      this.targetEl.addEventListener(\"media_resolved\", this.updateSrc, { once: true });\n      this.updateSrc();\n    });\n\n    this.onClick = () => {\n      const src = this.src;\n      const { contentSubtype, resize } = this.targetEl.components[\"media-loader\"].data;\n      const { entity } = addMedia(src, \"#interactable-media\", ObjectContentOrigins.URL, contentSubtype, true, resize);\n\n      entity.object3D.matrixNeedsUpdate = true;\n\n      entity.setAttribute(\"offset-relative-to\", {\n        target: \"#player-camera\",\n        offset: { x: 0, y: 0, z: -1.5 }\n      });\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","import { isHubsSceneUrl, isHubsRoomUrl, isHubsAvatarUrl } from \"../utils/media-url-utils\";\nimport { guessContentType } from \"../utils/media-url-utils\";\n\nAFRAME.registerComponent(\"open-media-button\", {\n  init() {\n    this.label = this.el.querySelector(\"[text]\");\n\n    this.updateSrc = () => {\n      const src = (this.src = this.targetEl.components[\"media-loader\"].data.src);\n      const visible = src && guessContentType(src) !== \"video/vnd.hubs-webrtc\";\n      const mayChangeScene = this.el.sceneEl.systems.permissions.canOrWillIfCreator(\"update_hub\");\n\n      this.el.object3D.visible = !!visible;\n\n      if (visible) {\n        let label = \"open link\";\n        if (isHubsAvatarUrl(src)) {\n          label = \"use avatar\";\n        } else if (isHubsSceneUrl(src) && mayChangeScene) {\n          label = \"use scene\";\n        } else if (isHubsRoomUrl(src)) {\n          label = \"visit room\";\n        }\n        this.label.setAttribute(\"text\", \"value\", label);\n      }\n    };\n\n    this.onClick = () => {\n      const mayChangeScene = this.el.sceneEl.systems.permissions.canOrWillIfCreator(\"update_hub\");\n\n      if (isHubsAvatarUrl(this.src)) {\n        const avatarId = new URL(this.src).pathname.split(\"/\").pop();\n        window.APP.store.update({ profile: { avatarId } });\n      } else if (isHubsSceneUrl(this.src) && mayChangeScene) {\n        this.el.sceneEl.emit(\"scene_media_selected\", this.src);\n      } else if (isHubsRoomUrl(this.src)) {\n        location.href = this.src;\n      } else {\n        window.open(this.src);\n      }\n    };\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n      this.targetEl.addEventListener(\"media_resolved\", this.updateSrc, { once: true });\n      this.updateSrc();\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\nconst AMMO_BODY_ATTRIBUTES = { type: \"kinematic\", collisionFilterMask: COLLISION_LAYERS.HANDS };\n\nconst TRANSFORM_MODE = {\n  AXIS: \"axis\",\n  PUPPET: \"puppet\",\n  CURSOR: \"cursor\",\n  ALIGN: \"align\",\n  SCALE: \"scale\"\n};\n\nconst SCALE_SENSITIVITY = 100;\nconst MIN_SCALE = 0.1;\nconst MAX_SCALE = 100;\n\nconst STEP_LENGTH = Math.PI / 10;\nconst CAMERA_WORLD_QUATERNION = new THREE.Quaternion();\nconst CAMERA_WORLD_POSITION = new THREE.Vector3();\nconst TARGET_WORLD_QUATERNION = new THREE.Quaternion();\nconst v = new THREE.Vector3();\nconst v2 = new THREE.Vector3();\nconst q = new THREE.Quaternion();\nconst q2 = new THREE.Quaternion();\n\nAFRAME.registerComponent(\"transform-button\", {\n  schema: {\n    mode: {\n      type: \"string\",\n      oneof: Object.values(TRANSFORM_MODE),\n      default: TRANSFORM_MODE.CURSOR\n    },\n    axis: { type: \"vec3\", default: null }\n  },\n  init() {\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n    });\n    const rightHand = document.querySelector(\"#player-right-controller\");\n    this.onGrabStart = e => {\n      if (!this.targetEl) {\n        return;\n      }\n      if (!NAF.utils.isMine(this.targetEl) && !NAF.utils.takeOwnership(this.targetEl)) {\n        return;\n      }\n      if (this.targetEl.body) {\n        this.targetEl.setAttribute(\"ammo-body\", AMMO_BODY_ATTRIBUTES);\n      }\n      this.transformSystem = this.transformSystem || AFRAME.scenes[0].systems[\"transform-selected-object\"];\n      this.transformSystem.startTransform(\n        this.targetEl.object3D,\n        e.object3D.el.id === \"cursor\" ? rightHand.object3D : e.object3D,\n        this.data\n      );\n    };\n    this.onGrabEnd = () => {\n      this.transformSystem = this.transformSystem || AFRAME.scenes[0].systems[\"transform-selected-object\"];\n      this.transformSystem.stopTransform();\n    };\n  },\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onGrabStart);\n    this.el.object3D.addEventListener(\"holdable-button-down\", this.onGrabStart);\n    this.el.object3D.addEventListener(\"holdable-button-up\", this.onGrabEnd);\n  },\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onGrabStart);\n    this.el.object3D.removeEventListener(\"holdable-button-down\", this.onGrabStart);\n    this.el.object3D.removeEventListener(\"holdable-button-up\", this.onGrabEnd);\n  }\n});\n\nAFRAME.registerSystem(\"transform-selected-object\", {\n  init() {\n    this.target = null;\n    this.mode = null;\n    this.transforming = false;\n    this.axis = new THREE.Vector3();\n    this.store = window.APP.store;\n\n    this.dxStore = 0;\n    this.dxApplied = 0;\n    this.dyAll = 0;\n    this.dyStore = 0;\n    this.dyApplied = 0;\n\n    this.puppet = {\n      initialControllerOrientation: new THREE.Quaternion(),\n      initialControllerOrientation_inverse: new THREE.Quaternion(),\n      initialObjectOrientation: new THREE.Quaternion(),\n      currentControllerOrientation: new THREE.Quaternion(),\n      controllerOrientationDelta: new THREE.Quaternion()\n    };\n\n    this.planarInfo = {\n      plane: new THREE.Mesh(\n        new THREE.PlaneBufferGeometry(100000, 100000, 2, 2),\n        new THREE.MeshBasicMaterial({\n          visible: false,\n          wireframe: true,\n          side: THREE.DoubleSide,\n          transparent: true,\n          opacity: 0.3\n        })\n      ),\n      normal: new THREE.Vector3(),\n      intersections: [],\n      previousPointOnPlane: new THREE.Vector3(),\n      currentPointOnPlane: new THREE.Vector3(),\n      deltaOnPlane: new THREE.Vector3(),\n      finalProjectedVec: new THREE.Vector3()\n    };\n    this.el.object3D.add(this.planarInfo.plane);\n  },\n\n  stopTransform() {\n    this.transforming = false;\n  },\n\n  startPlaneCasting() {\n    const { plane, intersections, previousPointOnPlane } = this.planarInfo;\n\n    this.el.camera.getWorldQuaternion(CAMERA_WORLD_QUATERNION);\n    plane.quaternion.copy(CAMERA_WORLD_QUATERNION);\n    this.target.getWorldPosition(plane.position);\n    plane.matrixNeedsUpdate = true;\n    plane.updateMatrixWorld(true);\n\n    intersections.length = 0;\n    this.raycaster =\n      this.raycaster || document.querySelector(\"#cursor-controller\").components[\"cursor-controller\"].raycaster;\n    const far = this.raycaster.far;\n    this.raycaster.far = 1000;\n    plane.raycast(this.raycaster, intersections);\n    this.raycaster.far = far;\n    this.transforming = !!intersections[0];\n    if (!this.transforming) {\n      return;\n    }\n\n    previousPointOnPlane.copy(intersections[0].point);\n\n    this.target.getWorldQuaternion(TARGET_WORLD_QUATERNION);\n\n    v.set(0, 0, -1).applyQuaternion(CAMERA_WORLD_QUATERNION);\n    v2.set(0, 0, -1).applyQuaternion(TARGET_WORLD_QUATERNION);\n    this.sign = v.dot(v2) > 0 ? 1 : -1;\n\n    v.set(0, 1, 0); //.applyQuaternion(this.CAMERA_WORLD_QUATERNION);\n    v2.set(0, 1, 0).applyQuaternion(TARGET_WORLD_QUATERNION);\n    this.sign2 = v.dot(v2) > 0 ? 1 : -1;\n\n    this.dyAll = 0;\n    this.dyStore = 0;\n    this.dyApplied = 0;\n    this.dxAll = 0;\n    this.dxStore = 0;\n    this.dxApplied = 0;\n  },\n\n  startTransform(target, hand, data) {\n    this.target = target;\n    this.hand = hand;\n    this.mode = data.mode;\n    this.transforming = true;\n\n    if (this.mode === TRANSFORM_MODE.ALIGN) {\n      this.store.update({ activity: { hasRecentered: true } });\n      return;\n    } else if (this.mode === TRANSFORM_MODE.SCALE) {\n      this.store.update({ activity: { hasScaled: true } });\n    } else {\n      this.store.update({ activity: { hasRotated: true } });\n    }\n\n    if (this.mode === TRANSFORM_MODE.PUPPET) {\n      this.target.getWorldQuaternion(this.puppet.initialObjectOrientation);\n      this.hand.getWorldQuaternion(this.puppet.initialControllerOrientation);\n      this.puppet.initialControllerOrientation_inverse.copy(this.puppet.initialControllerOrientation).inverse();\n      return;\n    }\n\n    if (this.mode === TRANSFORM_MODE.AXIS) {\n      this.axis.copy(data.axis);\n    }\n\n    this.startPlaneCasting();\n  },\n\n  puppetingTick() {\n    // Find controller delta as a quaternion, then apply it to the object, snapping in fixed increments if desired:\n    // Snap to fixed angle increments by converting to an Euler,\n    // restricting the angles using Math.floor, and converting back to a quaternion.\n    const {\n      currentControllerOrientation,\n      controllerOrientationDelta,\n      initialControllerOrientation_inverse,\n      initialObjectOrientation\n    } = this.puppet;\n    this.hand.getWorldQuaternion(currentControllerOrientation);\n    controllerOrientationDelta.copy(initialControllerOrientation_inverse).premultiply(currentControllerOrientation);\n    this.target.quaternion.copy(initialObjectOrientation).premultiply(controllerOrientationDelta);\n    this.target.matrixNeedsUpdate = true;\n  },\n\n  cursorAxisOrScaleTick() {\n    const {\n      plane,\n      normal,\n      intersections,\n      previousPointOnPlane,\n      currentPointOnPlane,\n      deltaOnPlane,\n      finalProjectedVec\n    } = this.planarInfo;\n\n    this.target.getWorldPosition(plane.position);\n    this.el.camera.getWorldQuaternion(plane.quaternion);\n    plane.matrixNeedsUpdate = true;\n    const cameraToPlaneDistance = v.sub(plane.position).length();\n\n    intersections.length = 0;\n    const far = this.raycaster.far;\n    this.raycaster.far = 1000;\n    plane.raycast(this.raycaster, intersections);\n    this.raycaster.far = far;\n    const intersection = intersections[0]; // point\n    if (!intersection) return;\n\n    normal.set(0, 0, -1).applyQuaternion(plane.quaternion);\n\n    currentPointOnPlane.copy(intersection.point);\n    deltaOnPlane.copy(currentPointOnPlane).sub(previousPointOnPlane);\n    const SENSITIVITY = 10;\n    finalProjectedVec\n      .copy(deltaOnPlane)\n      .projectOnPlane(normal)\n      .applyQuaternion(q.copy(plane.quaternion).inverse())\n      .multiplyScalar(SENSITIVITY / cameraToPlaneDistance);\n    if (this.mode === TRANSFORM_MODE.CURSOR || this.mode === TRANSFORM_MODE.SCALE) {\n      const modify = AFRAME.scenes[0].systems.userinput.get(paths.actions.transformModifier);\n\n      this.dyAll = this.dyStore + finalProjectedVec.y;\n      this.dyApplied = modify ? this.dyAll : Math.round(this.dyAll / STEP_LENGTH) * STEP_LENGTH;\n      this.dyStore = this.dyAll - this.dyApplied;\n\n      this.dxAll = this.dxStore + finalProjectedVec.x;\n      this.dxApplied = modify ? this.dxAll : Math.round(this.dxAll / STEP_LENGTH) * STEP_LENGTH;\n      this.dxStore = this.dxAll - this.dxApplied;\n\n      if (this.mode === TRANSFORM_MODE.CURSOR) {\n        this.target.getWorldQuaternion(TARGET_WORLD_QUATERNION);\n        v.set(1, 0, 0).applyQuaternion(modify ? CAMERA_WORLD_QUATERNION : TARGET_WORLD_QUATERNION);\n        q.setFromAxisAngle(v, modify ? -this.dyApplied : this.sign2 * this.sign * -this.dyApplied);\n\n        if (modify) {\n          v.set(0, 1, 0).applyQuaternion(CAMERA_WORLD_QUATERNION);\n        } else {\n          v.set(0, 1, 0);\n        }\n        q2.setFromAxisAngle(v, this.dxApplied);\n\n        this.target.quaternion.premultiply(q).premultiply(q2);\n      } else {\n        const scaleFactor =\n          THREE.Math.clamp(finalProjectedVec.y + finalProjectedVec.x, -0.0005, 0.0005) * SCALE_SENSITIVITY;\n\n        const newScale = this.target.scale.x * (1.0 + scaleFactor);\n\n        if (newScale > MIN_SCALE && newScale < MAX_SCALE) {\n          this.target.scale.multiplyScalar(1.0 + scaleFactor);\n        }\n      }\n\n      this.target.matrixNeedsUpdate = true;\n    } else if (this.mode === TRANSFORM_MODE.AXIS) {\n      this.dxAll = this.dxStore + finalProjectedVec.x;\n      this.dxApplied = Math.round(this.dxAll / STEP_LENGTH) * STEP_LENGTH;\n      this.dxStore = this.dxAll - this.dxApplied;\n\n      this.target.quaternion.multiply(q.setFromAxisAngle(this.axis, -this.sign * this.dxApplied));\n      this.target.matrixNeedsUpdate = true;\n    }\n\n    previousPointOnPlane.copy(currentPointOnPlane);\n  },\n\n  tick() {\n    if (!this.transforming) {\n      return;\n    }\n\n    if (this.mode === TRANSFORM_MODE.ALIGN) {\n      this.el.camera.getWorldPosition(CAMERA_WORLD_POSITION);\n      this.target.lookAt(CAMERA_WORLD_POSITION);\n      this.transforming = false;\n      return;\n    }\n\n    if (this.mode === TRANSFORM_MODE.PUPPET) {\n      this.puppetingTick();\n      return;\n    }\n    this.cursorAxisOrScaleTick();\n  }\n});\n\nAFRAME.registerComponent(\"transform-button-selector\", {\n  tick() {\n    const hand = AFRAME.scenes[0].systems.userinput.get(paths.actions.rightHand.pose);\n    if (!hand) {\n      if (this.el.components[\"transform-button\"].data.mode !== TRANSFORM_MODE.CURSOR) {\n        this.el.setAttribute(\"transform-button\", \"mode\", TRANSFORM_MODE.CURSOR);\n      }\n    } else {\n      if (this.el.components[\"transform-button\"].data.mode !== TRANSFORM_MODE.PUPPET) {\n        this.el.setAttribute(\"transform-button\", \"mode\", TRANSFORM_MODE.PUPPET);\n      }\n    }\n  }\n});\n\nconst FORWARD = new THREE.Vector3(0, 0, 1);\nconst TWO_PI = 2 * Math.PI;\nAFRAME.registerComponent(\"visible-if-transforming\", {\n  init() {},\n  tick(t) {\n    const shouldBeVisible = AFRAME.scenes[0].systems[\"transform-selected-object\"].transforming;\n    const visibleNeedsUpdate = this.el.getAttribute(\"visible\") !== shouldBeVisible;\n    if (visibleNeedsUpdate) {\n      this.el.setAttribute(\"visible\", AFRAME.scenes[0].systems[\"transform-selected-object\"].transforming);\n    }\n\n    if (shouldBeVisible) {\n      this.el.object3D.quaternion.setFromAxisAngle(FORWARD, TWO_PI * Math.sin(t / 1000.0));\n      this.el.object3D.matrixNeedsUpdate = true;\n    }\n  }\n});\n","const CYLINDER_TEXTURE =\n  \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAAQCAYAAADXnxW3AAAACXBIWXMAAAsTAAALEwEAmpwYAAAKT2lDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVNnVFPpFj333vRCS4iAlEtvUhUIIFJCi4AUkSYqIQkQSoghodkVUcERRUUEG8igiAOOjoCMFVEsDIoK2AfkIaKOg6OIisr74Xuja9a89+bN/rXXPues852zzwfACAyWSDNRNYAMqUIeEeCDx8TG4eQuQIEKJHAAEAizZCFz/SMBAPh+PDwrIsAHvgABeNMLCADATZvAMByH/w/qQplcAYCEAcB0kThLCIAUAEB6jkKmAEBGAYCdmCZTAKAEAGDLY2LjAFAtAGAnf+bTAICd+Jl7AQBblCEVAaCRACATZYhEAGg7AKzPVopFAFgwABRmS8Q5ANgtADBJV2ZIALC3AMDOEAuyAAgMADBRiIUpAAR7AGDIIyN4AISZABRG8lc88SuuEOcqAAB4mbI8uSQ5RYFbCC1xB1dXLh4ozkkXKxQ2YQJhmkAuwnmZGTKBNA/g88wAAKCRFRHgg/P9eM4Ors7ONo62Dl8t6r8G/yJiYuP+5c+rcEAAAOF0ftH+LC+zGoA7BoBt/qIl7gRoXgugdfeLZrIPQLUAoOnaV/Nw+H48PEWhkLnZ2eXk5NhKxEJbYcpXff5nwl/AV/1s+X48/Pf14L7iJIEyXYFHBPjgwsz0TKUcz5IJhGLc5o9H/LcL//wd0yLESWK5WCoU41EScY5EmozzMqUiiUKSKcUl0v9k4t8s+wM+3zUAsGo+AXuRLahdYwP2SycQWHTA4vcAAPK7b8HUKAgDgGiD4c93/+8//UegJQCAZkmScQAAXkQkLlTKsz/HCAAARKCBKrBBG/TBGCzABhzBBdzBC/xgNoRCJMTCQhBCCmSAHHJgKayCQiiGzbAdKmAv1EAdNMBRaIaTcA4uwlW4Dj1wD/phCJ7BKLyBCQRByAgTYSHaiAFiilgjjggXmYX4IcFIBBKLJCDJiBRRIkuRNUgxUopUIFVIHfI9cgI5h1xGupE7yAAygvyGvEcxlIGyUT3UDLVDuag3GoRGogvQZHQxmo8WoJvQcrQaPYw2oefQq2gP2o8+Q8cwwOgYBzPEbDAuxsNCsTgsCZNjy7EirAyrxhqwVqwDu4n1Y8+xdwQSgUXACTYEd0IgYR5BSFhMWE7YSKggHCQ0EdoJNwkDhFHCJyKTqEu0JroR+cQYYjIxh1hILCPWEo8TLxB7iEPENyQSiUMyJ7mQAkmxpFTSEtJG0m5SI+ksqZs0SBojk8naZGuyBzmULCAryIXkneTD5DPkG+Qh8lsKnWJAcaT4U+IoUspqShnlEOU05QZlmDJBVaOaUt2ooVQRNY9aQq2htlKvUYeoEzR1mjnNgxZJS6WtopXTGmgXaPdpr+h0uhHdlR5Ol9BX0svpR+iX6AP0dwwNhhWDx4hnKBmbGAcYZxl3GK+YTKYZ04sZx1QwNzHrmOeZD5lvVVgqtip8FZHKCpVKlSaVGyovVKmqpqreqgtV81XLVI+pXlN9rkZVM1PjqQnUlqtVqp1Q61MbU2epO6iHqmeob1Q/pH5Z/YkGWcNMw09DpFGgsV/jvMYgC2MZs3gsIWsNq4Z1gTXEJrHN2Xx2KruY/R27iz2qqaE5QzNKM1ezUvOUZj8H45hx+Jx0TgnnKKeX836K3hTvKeIpG6Y0TLkxZVxrqpaXllirSKtRq0frvTau7aedpr1Fu1n7gQ5Bx0onXCdHZ4/OBZ3nU9lT3acKpxZNPTr1ri6qa6UbobtEd79up+6Ynr5egJ5Mb6feeb3n+hx9L/1U/W36p/VHDFgGswwkBtsMzhg8xTVxbzwdL8fb8VFDXcNAQ6VhlWGX4YSRudE8o9VGjUYPjGnGXOMk423GbcajJgYmISZLTepN7ppSTbmmKaY7TDtMx83MzaLN1pk1mz0x1zLnm+eb15vft2BaeFostqi2uGVJsuRaplnutrxuhVo5WaVYVVpds0atna0l1rutu6cRp7lOk06rntZnw7Dxtsm2qbcZsOXYBtuutm22fWFnYhdnt8Wuw+6TvZN9un2N/T0HDYfZDqsdWh1+c7RyFDpWOt6azpzuP33F9JbpL2dYzxDP2DPjthPLKcRpnVOb00dnF2e5c4PziIuJS4LLLpc+Lpsbxt3IveRKdPVxXeF60vWdm7Obwu2o26/uNu5p7ofcn8w0nymeWTNz0MPIQ+BR5dE/C5+VMGvfrH5PQ0+BZ7XnIy9jL5FXrdewt6V3qvdh7xc+9j5yn+M+4zw33jLeWV/MN8C3yLfLT8Nvnl+F30N/I/9k/3r/0QCngCUBZwOJgUGBWwL7+Hp8Ib+OPzrbZfay2e1BjKC5QRVBj4KtguXBrSFoyOyQrSH355jOkc5pDoVQfujW0Adh5mGLw34MJ4WHhVeGP45wiFga0TGXNXfR3ENz30T6RJZE3ptnMU85ry1KNSo+qi5qPNo3ujS6P8YuZlnM1VidWElsSxw5LiquNm5svt/87fOH4p3iC+N7F5gvyF1weaHOwvSFpxapLhIsOpZATIhOOJTwQRAqqBaMJfITdyWOCnnCHcJnIi/RNtGI2ENcKh5O8kgqTXqS7JG8NXkkxTOlLOW5hCepkLxMDUzdmzqeFpp2IG0yPTq9MYOSkZBxQqohTZO2Z+pn5mZ2y6xlhbL+xW6Lty8elQfJa7OQrAVZLQq2QqboVFoo1yoHsmdlV2a/zYnKOZarnivN7cyzytuQN5zvn//tEsIS4ZK2pYZLVy0dWOa9rGo5sjxxedsK4xUFK4ZWBqw8uIq2Km3VT6vtV5eufr0mek1rgV7ByoLBtQFr6wtVCuWFfevc1+1dT1gvWd+1YfqGnRs+FYmKrhTbF5cVf9go3HjlG4dvyr+Z3JS0qavEuWTPZtJm6ebeLZ5bDpaql+aXDm4N2dq0Dd9WtO319kXbL5fNKNu7g7ZDuaO/PLi8ZafJzs07P1SkVPRU+lQ27tLdtWHX+G7R7ht7vPY07NXbW7z3/T7JvttVAVVN1WbVZftJ+7P3P66Jqun4lvttXa1ObXHtxwPSA/0HIw6217nU1R3SPVRSj9Yr60cOxx++/p3vdy0NNg1VjZzG4iNwRHnk6fcJ3/ceDTradox7rOEH0x92HWcdL2pCmvKaRptTmvtbYlu6T8w+0dbq3nr8R9sfD5w0PFl5SvNUyWna6YLTk2fyz4ydlZ19fi753GDborZ752PO32oPb++6EHTh0kX/i+c7vDvOXPK4dPKy2+UTV7hXmq86X23qdOo8/pPTT8e7nLuarrlca7nuer21e2b36RueN87d9L158Rb/1tWeOT3dvfN6b/fF9/XfFt1+cif9zsu72Xcn7q28T7xf9EDtQdlD3YfVP1v+3Njv3H9qwHeg89HcR/cGhYPP/pH1jw9DBY+Zj8uGDYbrnjg+OTniP3L96fynQ89kzyaeF/6i/suuFxYvfvjV69fO0ZjRoZfyl5O/bXyl/erA6xmv28bCxh6+yXgzMV70VvvtwXfcdx3vo98PT+R8IH8o/2j5sfVT0Kf7kxmTk/8EA5jz/GMzLdsAAAAgY0hSTQAAeiUAAICDAAD5/wAAgOkAAHUwAADqYAAAOpgAABdvkl/FRgAAADJJREFUeNpEx7ENgDAAAzArK0JA6f8X9oewlcWStU1wBGdwB08wgjeYm79jc2nbYH0DAC/+CORJxO5fAAAAAElFTkSuQmCC\";\n\nimport { SOUND_TELEPORT_START, SOUND_TELEPORT_END } from \"../systems/sound-effects-system\";\n\nfunction easeIn(t) {\n  return t * t;\n}\n\nfunction easeOutIn(t) {\n  if (t < 0.5) return 0.5 * ((t = t * 2 - 1) * t * t + 1);\n  return 0.5 * (t = t * 2 - 1) * t * t + 0.5;\n}\n\nconst RayCurve = function(numPoints, width) {\n  this.geometry = new THREE.BufferGeometry();\n  this.vertices = new Float32Array(numPoints * 3 * 2);\n  this.uvs = new Float32Array(numPoints * 2 * 2);\n  this.width = width;\n\n  this.geometry.addAttribute(\"position\", new THREE.BufferAttribute(this.vertices, 3).setDynamic(true));\n\n  this.material = new THREE.MeshBasicMaterial({\n    side: THREE.DoubleSide,\n    transparent: true\n  });\n\n  this.mesh = new THREE.Mesh(this.geometry, this.material);\n  this.mesh.drawMode = THREE.TriangleStripDrawMode;\n\n  this.mesh.frustumCulled = false;\n  this.mesh.vertices = this.vertices;\n\n  this.direction = new THREE.Vector3();\n  this.numPoints = numPoints;\n};\n\nRayCurve.prototype = {\n  setDirection: function(direction) {\n    const UP = new THREE.Vector3(0, 1, 0);\n    this.direction\n      .copy(direction)\n      .cross(UP)\n      .normalize()\n      .multiplyScalar(this.width / 2);\n  },\n\n  setWidth: function(width) {\n    this.width = width;\n  },\n\n  setPoint: (function() {\n    const posA = new THREE.Vector3();\n    const posB = new THREE.Vector3();\n\n    return function(i, point) {\n      posA.copy(point).add(this.direction);\n      posB.copy(point).sub(this.direction);\n\n      let idx = 2 * 3 * i;\n      this.vertices[idx++] = posA.x;\n      this.vertices[idx++] = posA.y;\n      this.vertices[idx++] = posA.z;\n\n      this.vertices[idx++] = posB.x;\n      this.vertices[idx++] = posB.y;\n      this.vertices[idx++] = posB.z;\n\n      this.geometry.attributes.position.needsUpdate = true;\n    };\n  })()\n};\n\nfunction parabolicCurve(p0, v0, t, out) {\n  out.x = p0.x + v0.x * t;\n  out.y = p0.y + v0.y * t - 4.9 * t * t;\n  out.z = p0.z + v0.z * t;\n  return out;\n}\n\nfunction isValidNormalsAngle(collisionNormal, referenceNormal, landingMaxAngle) {\n  const angleNormals = referenceNormal.angleTo(collisionNormal);\n  return THREE.Math.RAD2DEG * angleNormals <= landingMaxAngle;\n}\n\nconst checkLineIntersection = (function() {\n  const direction = new THREE.Vector3();\n  return function checkLineIntersection(start, end, meshes, raycaster, referenceNormal, landingMaxAngle, hitPoint) {\n    direction.copy(end).sub(start);\n    const distance = direction.length();\n    raycaster.far = distance;\n    raycaster.set(start, direction.normalize());\n    const intersects = raycaster.intersectObjects(meshes, true);\n    if (intersects.length > 0 && isValidNormalsAngle(intersects[0].face.normal, referenceNormal, landingMaxAngle)) {\n      hitPoint.copy(intersects[0].point);\n      return true;\n    }\n    return false;\n  };\n})();\n\nfunction getMeshes(collisionEntities) {\n  return collisionEntities\n    .map(function(entity) {\n      return entity.getObject3D(\"mesh\");\n    })\n    .filter(function(n) {\n      return n;\n    });\n}\n\nconst MISS_OPACITY = 0.1;\nconst HIT_OPACITY = 0.3;\nconst MISS_COLOR = 0xff0000;\nconst HIT_COLOR = 0x00ff00;\nconst FORWARD = new THREE.Vector3(0, 0, -1);\nconst LANDING_NORMAL = new THREE.Vector3(0, 1, 0);\nconst MAX_LANDING_ANGLE = 45;\nconst DRAW_TIME_MS = 400;\nconst q = new THREE.Quaternion();\nconst vecHelper = new THREE.Vector3();\n\nAFRAME.registerComponent(\"teleporter\", {\n  schema: {\n    start: { type: \"string\" },\n    confirm: { type: \"string\" },\n    speed: { default: 12 },\n    collisionEntities: { default: \"\" },\n    hitCylinderColor: { type: \"color\", default: \"#99ff99\" },\n    hitCylinderRadius: { default: 0.25, min: 0 },\n    outerRadius: { default: 0.6, min: 0 },\n    hitCylinderHeight: { default: 0.3, min: 0 }\n  },\n\n  init() {\n    this.isTeleporting = false;\n    this.rayCurve = new RayCurve(20, 0.025);\n    this.rayCurve.mesh.visible = false;\n    this.teleportEntity = document.createElement(\"a-entity\");\n    this.teleportEntity.setObject3D(\"mesh\", this.rayCurve.mesh);\n    this.el.sceneEl.appendChild(this.teleportEntity);\n\n    this.p0 = new THREE.Vector3();\n    this.v0 = new THREE.Vector3();\n    this.parabola = Array.from(new Array(this.rayCurve.numPoints), () => new THREE.Vector3());\n    this.hit = false;\n    this.hitPoint = new THREE.Vector3();\n    this.meshes = [];\n    this.raycaster = new THREE.Raycaster();\n    this.rigWorldPosition = new THREE.Vector3();\n    this.newRigWorldPosition = new THREE.Vector3();\n    this.teleportOriginWorldPosition = new THREE.Vector3();\n\n    this.teleportEventDetail = {\n      oldPosition: this.rigWorldPosition,\n      newPosition: this.newRigWorldPosition,\n      hitPoint: this.hitPoint\n    };\n    this.prevHitHeight = 0;\n    this.direction = new THREE.Vector3();\n    this.hitEntity = this.createHitEntity();\n    this.hitEntity.object3D.visible = false;\n    this.el.sceneEl.appendChild(this.hitEntity);\n    this.queryCollisionEntities();\n  },\n\n  queryCollisionEntities: function() {\n    this.collisionEntities = [].slice.call(this.el.sceneEl.querySelectorAll(this.data.collisionEntities));\n    this.meshes = getMeshes(this.collisionEntities);\n  },\n\n  remove() {\n    this.stopPlayingTeleportSound();\n  },\n\n  stopPlayingTeleportSound() {\n    if (this.teleportingSound) {\n      const sfx = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem;\n      sfx.stopSoundNode(this.teleportingSound.source);\n      this.teleportingSound = null;\n    }\n  },\n\n  tick(t, dt) {\n    if (!this.el.sceneEl.is(\"entered\")) return;\n    const sfx = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem;\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const { start, confirm, speed } = this.data;\n    const object3D = this.el.object3D;\n\n    if (!this.isTeleporting && userinput.get(start)) {\n      this.isTeleporting = true;\n      this.timeTeleporting = 0;\n      this.hit = false;\n      this.rayCurve.mesh.visible = true;\n      this.rayCurve.mesh.updateMatrixWorld();\n      this.rayCurve.mesh.material.opacity = MISS_OPACITY;\n      this.rayCurve.mesh.material.color.set(MISS_COLOR);\n      this.rayCurve.mesh.material.needsUpdate = true;\n      this.teleportingSound = sfx.playSoundLoopedWithGain(SOUND_TELEPORT_START);\n      if (this.teleportingSound) {\n        this.teleportingSound.gain.gain.value = 0.005;\n      }\n    }\n\n    if (!this.isTeleporting) {\n      return;\n    }\n    if (this.teleportingSound) {\n      this.teleportingSound.gain.gain.value = Math.min(0.025, this.teleportingSound.gain.gain.value + 0.00002 * dt);\n    }\n\n    if (userinput.get(confirm)) {\n      this.hitEntity.setAttribute(\"visible\", false);\n      this.isTeleporting = false;\n      this.rayCurve.mesh.visible = false;\n\n      if (this.teleportingSound) {\n        this.stopPlayingTeleportSound();\n      }\n\n      if (!this.hit || this.timeTeleporting < DRAW_TIME_MS) {\n        return;\n      }\n\n      this.characterController =\n        this.characterController || document.querySelector(\"#player-rig\").components[\"character-controller\"];\n      this.characterController.teleportTo(this.hitPoint);\n\n      sfx.playSoundOneShot(SOUND_TELEPORT_END);\n      return;\n    }\n\n    this.timeTeleporting += dt;\n    object3D.updateMatrixWorld();\n    object3D.matrixWorld.decompose(this.p0, q, vecHelper);\n    this.direction\n      .copy(FORWARD)\n      .applyQuaternion(q)\n      .normalize();\n    this.rayCurve.setDirection(this.direction);\n    this.v0.copy(this.direction).multiplyScalar(speed);\n\n    let collidedIndex = this.rayCurve.numPoints - 1;\n\n    this.hit = false;\n    this.parabola[0].copy(this.p0);\n    const timeSegment = 1 / (this.rayCurve.numPoints - 1);\n    for (let i = 1; i < this.rayCurve.numPoints; i++) {\n      const t = i * timeSegment;\n      parabolicCurve(this.p0, this.v0, t, vecHelper);\n      this.parabola[i].copy(vecHelper);\n\n      if (\n        checkLineIntersection(\n          this.parabola[i - 1],\n          this.parabola[i],\n          this.meshes,\n          this.raycaster,\n          LANDING_NORMAL,\n          MAX_LANDING_ANGLE,\n          this.hitPoint\n        )\n      ) {\n        this.hit = true;\n        collidedIndex = i;\n        break;\n      }\n    }\n\n    const percentToDraw = this.timeTeleporting > DRAW_TIME_MS ? 1 : this.timeTeleporting / DRAW_TIME_MS;\n    const percentRaycasted = collidedIndex / (this.rayCurve.numPoints - 1);\n    const segmentT = (percentToDraw * percentRaycasted) / (this.rayCurve.numPoints - 1);\n\n    for (let i = 0; i < this.rayCurve.numPoints; i++) {\n      const t = i * segmentT;\n      parabolicCurve(this.p0, this.v0, t, vecHelper);\n      this.rayCurve.setPoint(i, vecHelper);\n    }\n\n    const color = this.hit ? HIT_COLOR : MISS_COLOR;\n    const opacity = this.hit && this.timeTeleporting >= DRAW_TIME_MS ? HIT_OPACITY : MISS_OPACITY;\n    this.rayCurve.material.color.set(color);\n    this.rayCurve.material.opacity = opacity;\n\n    this.hitEntity.setAttribute(\"visible\", this.hit);\n    if (this.hit) {\n      this.hitEntity.setAttribute(\"position\", this.hitPoint);\n      this.hitEntity.object3D.traverse(o => {\n        o.matrixNeedsUpdate = true;\n      });\n      const hitEntityOpacity = HIT_OPACITY * easeOutIn(percentToDraw);\n      const dRadii = this.data.outerRadius - this.data.hitCylinderRadius;\n      const outerScale = (this.data.outerRadius - easeIn(percentToDraw) * dRadii) / this.data.outerRadius;\n      this.outerTorus.object3D.scale.set(outerScale, outerScale, 1);\n      this.torus.setAttribute(\"material\", \"opacity\", hitEntityOpacity);\n      this.cylinder.setAttribute(\"material\", \"opacity\", hitEntityOpacity);\n    }\n  },\n\n  createHitEntity() {\n    const data = this.data;\n\n    // Parent.\n    const hitEntity = document.createElement(\"a-entity\");\n    hitEntity.className = \"hitEntity\";\n\n    // Torus.\n    this.torus = document.createElement(\"a-entity\");\n    this.torus.setAttribute(\"geometry\", {\n      primitive: \"torus\",\n      radius: data.hitCylinderRadius,\n      radiusTubular: 0.01,\n      segmentsRadial: 16,\n      segmentsTubular: 18\n    });\n    this.torus.setAttribute(\"rotation\", { x: 90, y: 0, z: 0 });\n    this.torus.setAttribute(\"material\", {\n      shader: \"flat\",\n      color: data.hitCylinderColor,\n      side: \"double\",\n      depthTest: false\n    });\n    hitEntity.appendChild(this.torus);\n\n    // Cylinder.\n    this.cylinder = document.createElement(\"a-entity\");\n    this.cylinder.setAttribute(\"position\", { x: 0, y: data.hitCylinderHeight / 2, z: 0 });\n    if (window.createImageBitmap !== undefined) {\n      this.cylinder.setAttribute(\"rotation\", { x: 0, y: 0, z: 180 });\n    }\n    this.cylinder.setAttribute(\"geometry\", {\n      primitive: \"cylinder\",\n      segmentsHeight: 1,\n      radius: data.hitCylinderRadius,\n      height: data.hitCylinderHeight,\n      openEnded: true\n    });\n    this.cylinder.setAttribute(\"material\", {\n      shader: \"flat\",\n      color: data.hitCylinderColor,\n      side: \"double\",\n      src: CYLINDER_TEXTURE,\n      transparent: true,\n      depthTest: false\n    });\n    hitEntity.appendChild(this.cylinder);\n\n    // create another torus for animating when the hit destination is ready to go\n    this.outerTorus = document.createElement(\"a-entity\");\n    this.outerTorus.setAttribute(\"geometry\", {\n      primitive: \"torus\",\n      radius: data.outerRadius,\n      radiusTubular: 0.01,\n      segmentsRadial: 16,\n      segmentsTubular: 18\n    });\n    this.outerTorus.setAttribute(\"rotation\", { x: 90, y: 0, z: 0 });\n    this.outerTorus.setAttribute(\"material\", {\n      shader: \"flat\",\n      color: data.hitCylinderColor,\n      side: \"double\",\n      opacity: HIT_OPACITY,\n      depthTest: false\n    });\n    this.outerTorus.setAttribute(\"id\", \"outerTorus\");\n    hitEntity.appendChild(this.outerTorus);\n\n    return hitEntity;\n  }\n});\n","import createTextGeometry from \"three-bmfont-text\";\n\n// 1 to match other A-Frame default widths.\nconst DEFAULT_WIDTH = 1;\n\n// @bryik set anisotropy to 16. Improves look of large amounts of text when viewed from angle.\nconst MAX_ANISOTROPY = 16;\n\n/**\n * Due to using negative scale, we return the opposite side specified.\n * https://github.com/mrdoob/three.js/pull/12787/\n */\nfunction parseSide(side) {\n  switch (side) {\n    case \"back\": {\n      return THREE.FrontSide;\n    }\n    case \"double\": {\n      return THREE.DoubleSide;\n    }\n    default: {\n      return THREE.BackSide;\n    }\n  }\n}\n\n/**\n * Determine wrap pixel count. Either specified or by experimental fudge factor.\n * Note that experimental factor will never be correct for variable width fonts.\n */\nfunction computeWidth(wrapPixels, wrapCount, widthFactor) {\n  return wrapPixels || (0.5 + wrapCount) * widthFactor;\n}\n\n/**\n * Compute default font width factor to use.\n */\nfunction computeFontWidthFactor(font) {\n  let sum = 0;\n  let digitsum = 0;\n  let digits = 0;\n  for (const ch of font.chars) {\n    sum += ch.xadvance;\n    if (ch.id >= 48 && ch.id <= 57) {\n      digits++;\n      digitsum += ch.xadvance;\n    }\n  }\n  return digits ? digitsum / digits : sum / font.chars.length;\n}\n\nfunction loadFont(src) {\n  return fetch(src)\n    .then(resp => resp.json())\n    .then(font => {\n      // Fix negative Y offsets for Roboto MSDF font from tool. Experimentally determined.\n      if (src.indexOf(\"/Roboto-msdf.json\") >= 0) {\n        for (const ch of font.chars) {\n          ch.yoffset += 30;\n        }\n      }\n      font.widthFactor = computeFontWidthFactor(font);\n      return font;\n    });\n}\n\nfunction loadTexture(src) {\n  return new Promise((resolve, reject) => {\n    new THREE.ImageLoader().load(\n      src,\n      image => {\n        const texture = new THREE.Texture();\n        texture.image = image;\n        texture.needsUpdate = true;\n        texture.anisotropy = MAX_ANISOTROPY;\n        resolve(texture);\n      },\n      undefined,\n      err => {\n        console.error(\"Error loading font image\", src, err);\n        reject(null);\n      }\n    );\n  });\n}\n\nconst FONTS = {\n  roboto: {\n    json: loadFont(\"https://cdn.aframe.io/fonts/Roboto-msdf.json\"),\n    texture: loadTexture(\"https://cdn.aframe.io/fonts/Roboto-msdf.png\")\n  }\n};\n\nAFRAME.registerComponent(\"text\", {\n  multiple: true,\n  schema: {\n    align: { type: \"string\", default: \"left\", oneOf: [\"left\", \"right\", \"center\"] },\n    alphaTest: { default: 0.5 },\n    // `anchor` defaults to center to match geometries.\n    anchor: { default: \"center\", oneOf: [\"left\", \"right\", \"center\", \"align\"] },\n    baseline: { default: \"center\", oneOf: [\"top\", \"center\", \"bottom\"] },\n    color: { type: \"color\", default: \"#FFF\" },\n    font: { type: \"string\", default: \"roboto\" },\n    // `height` has no default, will be populated at layout.\n    height: { type: \"number\" },\n    letterSpacing: { type: \"number\", default: 0 },\n    // `lineHeight` defaults to font's `lineHeight` value.\n    lineHeight: { type: \"number\" },\n    // `negate` must be true for fonts generated with older versions of msdfgen (white background).\n    negate: { type: \"boolean\", default: true },\n    opacity: { type: \"number\", default: 1.0 },\n    side: { default: \"front\", oneOf: [\"front\", \"back\", \"double\"] },\n    tabSize: { default: 4 },\n    transparent: { default: true },\n    value: { type: \"string\" },\n    whiteSpace: { default: \"normal\", oneOf: [\"normal\", \"pre\", \"nowrap\"] },\n    // `width` defaults to geometry width if present, else `DEFAULT_WIDTH`.\n    width: { type: \"number\" },\n    // `wrapCount` units are about one default font character. Wrap roughly at this number.\n    wrapCount: { type: \"number\", default: 40 },\n    // `wrapPixels` will wrap using bmfont pixel units (e.g., dejavu's is 32 pixels).\n    wrapPixels: { type: \"number\" },\n    // `xOffset` to add padding.\n    xOffset: { type: \"number\", default: 0 },\n    // `zOffset` will provide a small z offset to avoid z-fighting.\n    zOffset: { type: \"number\", default: 0.001 }\n  },\n\n  init: function() {\n    const shaderData = this.getShaderData(this.data);\n    this.shaderObject = new AFRAME.shaders[\"msdf\"].Shader();\n    this.shaderObject.el = this.el;\n    this.shaderObject.init(shaderData);\n    this.shaderObject.update(shaderData);\n    this.shaderObject.material.transparent = shaderData.transparent; // Apparently, was not set on `init` nor `update`.\n    this.shaderObject.material.side = shaderData.side;\n    this.geometry = createTextGeometry();\n    this.mesh = new THREE.Mesh(this.geometry, this.shaderObject.material);\n    this.el.setObject3D(this.attrName, this.mesh);\n  },\n\n  update: function(oldData) {\n    const data = this.data;\n    const shaderData = this.getShaderData(this.data);\n    this.shaderObject.update(shaderData);\n    this.shaderObject.material.transparent = shaderData.transparent; // Apparently, was not set on `init` nor `update`.\n    this.shaderObject.material.side = shaderData.side;\n\n    // New font. `updateFont` will later change data and layout.\n    if (oldData.font !== data.font) {\n      this.updateFont().catch(err => console.error(err));\n    }\n\n    // Not a new font, but we need to accomodate other changes with the existing font.\n    if (this.currentFont != null) {\n      this.updateGeometry(this.geometry, this.currentFont);\n      this.updateLayout(this.currentFont);\n    }\n  },\n\n  /**\n   * Clean up geometry, material, texture, mesh, objects.\n   */\n  remove: function() {\n    this.geometry.dispose();\n    this.geometry = null;\n    this.el.removeObject3D(this.attrName);\n    this.shaderObject.material.dispose();\n    this.shaderObject.material = null;\n    delete this.shaderObject;\n  },\n\n  getShaderData: (function() {\n    const shaderData = {};\n    return function(data) {\n      shaderData.alphaTest = data.alphaTest;\n      shaderData.color = data.color;\n      shaderData.opacity = data.opacity;\n      shaderData.side = parseSide(data.side);\n      shaderData.transparent = data.transparent;\n      shaderData.negate = data.negate;\n      return shaderData;\n    };\n  })(),\n\n  /**\n   * Load font for geometry, load font image for material, and apply.\n   */\n  updateFont: function() {\n    const data = this.data;\n    const geometry = this.geometry;\n\n    // Make invisible during font swap.\n    this.mesh.visible = false;\n    const fetchFontData = Promise.all([FONTS[data.font].json, FONTS[data.font].texture]);\n    return fetchFontData.then(([font, texture]) => {\n      if (font.pages.length !== 1) {\n        throw new Error(\"Currently only single-page bitmap fonts are supported.\");\n      }\n      this.currentFont = font;\n      this.updateGeometry(geometry, font);\n      this.shaderObject.update({ map: texture });\n      this.updateLayout(font);\n      this.mesh.visible = true;\n    });\n  },\n\n  /**\n   * Update layout with anchor, alignment, baseline, and considering any meshes.\n   */\n  updateLayout: function(font) {\n    const el = this.el;\n    const data = this.data;\n    const geometry = this.geometry;\n    const mesh = this.mesh;\n\n    if (!geometry.layout) {\n      return;\n    }\n\n    // Determine width to use (defined width, geometry's width, or default width).\n    const geometryComponent = el.getAttribute(\"geometry\");\n    const width = data.width || (geometryComponent && geometryComponent.width) || DEFAULT_WIDTH;\n\n    // Determine wrap pixel count. Either specified or by experimental fudge factor.\n    // Note that experimental factor will never be correct for variable width fonts.\n    const textRenderWidth = computeWidth(data.wrapPixels, data.wrapCount, font.widthFactor);\n    const textScale = width / textRenderWidth;\n\n    // Determine height to use.\n    const layout = geometry.layout;\n    const height = textScale * (layout.height + layout.descender);\n\n    // Update geometry dimensions to match text layout if width and height are set to 0.\n    // For example, scales a plane to fit text.\n    if (geometryComponent && geometryComponent.primitive === \"plane\") {\n      if (!geometryComponent.width) {\n        el.setAttribute(\"geometry\", \"width\", width);\n      }\n      if (!geometryComponent.height) {\n        el.setAttribute(\"geometry\", \"height\", height);\n      }\n    }\n\n    // Calculate X position to anchor text left, center, or right.\n    const anchor = data.anchor === \"align\" ? data.align : data.anchor;\n    let x, y;\n    if (anchor === \"left\") {\n      x = 0;\n    } else if (anchor === \"right\") {\n      x = -1 * layout.width;\n    } else if (anchor === \"center\") {\n      x = (-1 * layout.width) / 2;\n    } else {\n      throw new TypeError(\"Invalid text.anchor property value\", anchor);\n    }\n\n    // Calculate Y position to anchor text top, center, or bottom.\n    const baseline = data.baseline;\n    if (baseline === \"bottom\") {\n      y = 0;\n    } else if (baseline === \"top\") {\n      y = -1 * layout.height + layout.ascender;\n    } else if (baseline === \"center\") {\n      y = (-1 * layout.height) / 2;\n    } else {\n      throw new TypeError(\"Invalid text.baseline property value\", baseline);\n    }\n\n    // Position and scale mesh to apply layout.\n    mesh.position.x = x * textScale + data.xOffset;\n    mesh.position.y = y * textScale;\n    // Place text slightly in front to avoid Z-fighting.\n    mesh.position.z = data.zOffset;\n    mesh.scale.set(textScale, -1 * textScale, textScale);\n  },\n\n  /**\n   * Update the text geometry using `three-bmfont-text.update`.\n   */\n  updateGeometry: (function() {\n    const geometryUpdateBase = {};\n    const geometryUpdateData = {};\n    const newLineRegex = /\\\\n/g;\n    const tabRegex = /\\\\t/g;\n\n    return function(geometry, font) {\n      const data = this.data;\n\n      geometryUpdateData.font = font;\n      geometryUpdateData.lineHeight =\n        data.lineHeight && isFinite(data.lineHeight) ? data.lineHeight : font.common.lineHeight;\n      geometryUpdateData.text = data.value\n        .toString()\n        .replace(newLineRegex, \"\\n\")\n        .replace(tabRegex, \"\\t\");\n      geometryUpdateData.width = computeWidth(data.wrapPixels, data.wrapCount, font.widthFactor);\n      geometry.update(Object.assign(geometryUpdateBase, data, geometryUpdateData));\n    };\n  })()\n});\n","export const sets = {};\nsets.global = \"global\";\nsets.inputFocused = \"inputFocused\";\nsets.cursorHoveringOnPen = \"cursorHoveringOnPen\";\nsets.cursorHoveringOnCamera = \"cursorHoveringOnCamera\";\nsets.cursorHoveringOnInteractable = \"cursorHoveringOnInteractable\";\nsets.cursorHoveringOnUI = \"cursorHoveringOnUI\";\nsets.cursorHoveringOnVideo = \"cursorHoveringOnVideo\";\nsets.cursorHoveringOnNothing = \"cursorHoveringOnNothing\";\nsets.cursorHoldingPen = \"cursorHoldingPen\";\nsets.cursorHoldingCamera = \"cursorHoldingCamera\";\nsets.cursorHoldingInteractable = \"cursorHoldingInteractable\";\nsets.cursorHoldingUI = \"cursorHoldingUI\";\nsets.cursorHoldingNothing = \"cursorHoldingNothing\";\nsets.rightHandTeleporting = \"rightHandTeleporting\";\nsets.rightHandHoveringOnPen = \"rightHandHoveringOnPen\";\nsets.rightHandHoveringOnCamera = \"rightHandHoveringOnCamera\";\nsets.rightHandHoveringOnInteractable = \"rightHandHoveringOnInteractable\";\nsets.rightHandHoveringOnNothing = \"rightHandHoveringOnNothing\";\nsets.rightHandHoldingPen = \"rightHandHoldingPen\";\nsets.rightHandHoldingCamera = \"rightHandHoldingCamera\";\nsets.rightHandHoldingInteractable = \"rightHandHoldingInteractable\";\nsets.leftHandTeleporting = \"leftHandTeleporting\";\nsets.leftHandHoveringOnPen = \"leftHandHoveringOnPen\";\nsets.leftHandHoveringOnCamera = \"leftHandHoveringOnCamera\";\nsets.leftHandHoveringOnInteractable = \"leftHandHoveringOnInteractable\";\nsets.leftHandHoldingPen = \"leftHandHoldingPen\";\nsets.leftHandHoldingCamera = \"leftHandHoldingCamera\";\nsets.leftHandHoldingInteractable = \"leftHandHoldingInteractable\";\nsets.leftHandHoveringOnNothing = \"leftHandHoveringOnNothing\";\n","const { detect } = require(\"detect-browser\");\n\nconst browser = detect();\n\n// Precision on device detection is fuzzy -- we can sometimes know if a device is definitely\n// available, or definitely *not* available, and assume it may be available otherwise.\nexport const VR_DEVICE_AVAILABILITY = {\n  yes: \"yes\", // Implies VR can be launched into on this device immediately, in this browser\n  no: \"no\", // Implies this VR device is definitely not supported regardless of browser\n  maybe: \"maybe\" // Implies this device may support this VR platform, but may not be installed or in a compatible browser\n};\n\nfunction isMaybeGearVRCompatibleDevice(ua) {\n  return /\\WAndroid\\W/.test(ua);\n}\n\nfunction isMaybeDaydreamCompatibleDevice(ua) {\n  return /\\WAndroid\\W/.test(ua);\n}\n\n// Blacklist of VR device name regex matchers that we do not want to consider as valid VR devices\n// that can be entered into as a \"generic\" entry flow.\nconst GENERIC_ENTRY_TYPE_DEVICE_BLACKLIST = [/cardboard/i];\n\n// Tries to determine VR entry compatibility regardless of the current browser.\n//\n// For each VR \"entry type\", returns VR_DEVICE_AVAILABILITY.yes if that type can be launched into directly from this browser\n// on this device, returns VR_DEVICE_AVAILABILITY.no if that type is known to not be possible to ever use on this device no matter what,\n// and VR_DEVICE_AVAILABILITY.maybe if the device potentially could support that type if a different browser was running, or if\n// the software was setup, an HMD was purchased, etc.\n//\n// When \"yes\" or \"maybe\", we should present the option. If \"maybe\", when chosen try to get them into a compatible browser.\n// Once in a compatible browser, we should assume it will work (if it doesn't, it's because they don't have the headset,\n// haven't installed the software, our guess about their phone was wrong, etc.)\n//\n// At the time of this writing there are the following VR \"entry types\" that will be validated by this method:\n//\n// - screen: Enter \"on-screen\" in 2D\n// - generic: Generic WebVR (platform/OS agnostic indicator if a general 'Enter VR' option should be presented.)\n// - daydream: Google Daydream\n// - gearvr: Oculus GearVR\n// - cardboard: Google Cardboard\n//\nexport async function getAvailableVREntryTypes() {\n  const ua = navigator.userAgent;\n  const isSamsungBrowser = browser.name === \"chrome\" && /SamsungBrowser/.test(ua);\n  const isMobile = AFRAME.utils.device.isMobile();\n  const isMobileVR = AFRAME.utils.device.isMobileVR();\n\n  // This needs to be kept up-to-date with the latest browsers that can support VR and Hubs.\n  // Checking for navigator.getVRDisplays always passes b/c of polyfill.\n  const isWebVRCapableBrowser = window.hasNativeWebVRImplementation;\n\n  const isDaydreamCapableBrowser = !!(isWebVRCapableBrowser && browser.name === \"chrome\" && !isSamsungBrowser);\n  const isIDevice = AFRAME.utils.device.isIOS();\n  const isFirefoxBrowser = browser.name === \"firefox\";\n  const isUIWebView = typeof navigator.mediaDevices === \"undefined\";\n\n  const safari = isIDevice\n    ? !isUIWebView\n      ? VR_DEVICE_AVAILABILITY.yes\n      : VR_DEVICE_AVAILABILITY.maybe\n    : VR_DEVICE_AVAILABILITY.no;\n\n  const isCardboardCapableBrowser = !!(isMobile && !isIDevice && browser.name === \"chrome\" && !isSamsungBrowser);\n\n  let displays = [];\n  try {\n    // Skip getVRDisplays on desktop Chrome since the API is in a broken state there.\n    // See https://github.com/mozilla/hubs/issues/892\n    if (browser.name !== \"chrome\" || isMobile) {\n      // We pull the displays on non-WebVR capable mobile browsers so we can pick up cardboard.\n      displays = isWebVRCapableBrowser || isCardboardCapableBrowser ? await navigator.getVRDisplays() : [];\n    }\n  } catch (e) {\n    console.warn(\"navigator.getVRDisplays() failed\", e);\n  }\n\n  const isOculusBrowser = /Oculus/.test(ua);\n\n  const screen = isMobileVR\n    ? VR_DEVICE_AVAILABILITY.no\n    : isIDevice && isUIWebView\n      ? VR_DEVICE_AVAILABILITY.maybe\n      : VR_DEVICE_AVAILABILITY.yes;\n\n  // HACK -- we prompt the user to install firefox if they click the VR button on a non-WebVR compatible\n  // browser. once we change this (ie when Chrome has VR support) then this check can be removed. Without this\n  // check if you have FF on Mac/Linux you'll get the confusing flow of having a VR button but then\n  // being asked to download FF.\n  const isNonWebVRFirefox = !isWebVRCapableBrowser && isFirefoxBrowser;\n  let generic = isMobile || isNonWebVRFirefox ? VR_DEVICE_AVAILABILITY.no : VR_DEVICE_AVAILABILITY.maybe;\n  let cardboard = VR_DEVICE_AVAILABILITY.no;\n\n  // We only consider GearVR support as \"maybe\" and never \"yes\". The only browser\n  // that will detect GearVR outside of VR is Samsung Internet, and we'd prefer to launch into Oculus\n  // Browser for now since Samsung Internet requires an additional WebVR installation + flag, so return \"maybe\".\n  //\n  // If we are in Oculus Browser (ie, we are literally wearing a GearVR) then return 'yes'.\n  let gearvr = VR_DEVICE_AVAILABILITY.no;\n  if (isMaybeGearVRCompatibleDevice(ua)) {\n    gearvr = isOculusBrowser ? VR_DEVICE_AVAILABILITY.yes : VR_DEVICE_AVAILABILITY.maybe;\n  }\n\n  // For daydream detection, we first check if they are on an Android compatible device, and assume they\n  // may support daydream *unless* this browser has WebVR capabilities, in which case we can do better.\n  let daydream =\n    isMaybeDaydreamCompatibleDevice(ua) && !isMobileVR ? VR_DEVICE_AVAILABILITY.maybe : VR_DEVICE_AVAILABILITY.no;\n\n  cardboard =\n    isCardboardCapableBrowser && displays.find(d => d.capabilities.canPresent && /cardboard/i.test(d.displayName))\n      ? VR_DEVICE_AVAILABILITY.yes\n      : VR_DEVICE_AVAILABILITY.no;\n\n  if (isWebVRCapableBrowser) {\n    // Generic is supported for non-blacklisted devices and presentable HMDs.\n    generic = displays.find(\n      d => d.capabilities.canPresent && !GENERIC_ENTRY_TYPE_DEVICE_BLACKLIST.find(r => r.test(d.displayName))\n    )\n      ? VR_DEVICE_AVAILABILITY.yes\n      : VR_DEVICE_AVAILABILITY.no;\n\n    // For daydream detection, in a WebVR browser we can increase confidence in daydream compatibility.\n    const hasDaydreamWebVRDevice = displays.find(d => /daydream/i.test(d.displayName));\n\n    if (hasDaydreamWebVRDevice) {\n      // If we detected daydream via WebVR\n      daydream = VR_DEVICE_AVAILABILITY.yes;\n      generic = VR_DEVICE_AVAILABILITY.no;\n    } else if (isDaydreamCapableBrowser) {\n      // If we didn't detect daydream in a daydream capable browser, we definitely can't run daydream at all.\n      daydream = VR_DEVICE_AVAILABILITY.no;\n    }\n  }\n\n  return { screen, generic, gearvr, daydream, cardboard, safari };\n}\n","const isMobileVR = AFRAME.utils.device.isMobileVR();\n\nexport function canShare() {\n  // TODO, fix up when OB/FxR support sharing\n  return navigator.share && !isMobileVR;\n}\n\n/**\n * Wraps navigator.share with a fallback to twitter for unsupported browsers\n */\nexport function share(opts) {\n  if (canShare()) {\n    return navigator.share(opts);\n  } else {\n    const { title, url } = opts;\n    const width = 550;\n    const height = 420;\n    const left = (screen.width - width) / 2;\n    const top = (screen.height - height) / 2;\n    const params = `scrollbars=no,menubar=no,toolbar=no,status=no,width=${width},height=${height},top=${top},left=${left}`;\n    const tweetLink = `https://twitter.com/intent/tweet?url=${encodeURIComponent(url)}&text=${encodeURIComponent(\n      title\n    )}`;\n    window.open(tweetLink, \"_blank\", params);\n    return Promise.resolve();\n  }\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Route } from \"react-router\";\n\n/**\n * A react-router Route that looks for a key/value pair in the state to render something.\n */\nclass StateRoute extends React.Component {\n  static propTypes = {\n    stateKey: PropTypes.string,\n    stateValue: PropTypes.string,\n    history: PropTypes.object\n  };\n\n  render() {\n    const { history, stateKey, stateValue, ...routeProps } = this.props;\n\n    if (\n      (!history.location.state && !stateValue) ||\n      (history.location.state &&\n        (history.location.state[stateKey] === stateValue || (!history.location.state[stateKey] && !stateValue)))\n    ) {\n      return <Route path=\"/\" {...routeProps} />;\n    }\n\n    return null;\n  }\n}\n\nexport default StateRoute;\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\n\nimport styles from \"../assets/stylesheets/promote-client-dialog.scss\";\nimport DialogContainer from \"./dialog-container\";\n\nexport default class PromoteClientDialog extends Component {\n  static propTypes = {\n    displayName: PropTypes.string,\n    onConfirm: PropTypes.func,\n    onClose: PropTypes.func\n  };\n\n  render() {\n    return (\n      <DialogContainer title=\"Promote User\" {...this.props}>\n        <div className={styles.message}>\n          <FormattedMessage id=\"promote.message\" />\n        </div>\n        <button\n          className={styles.confirmButton}\n          onClick={() => {\n            this.props.onConfirm();\n            this.props.onClose();\n          }}\n        >\n          <FormattedMessage id=\"promote.confirm-prefix\" />\n          <span>{this.props.displayName}</span>\n        </button>\n        <button className={styles.cancelButton} onClick={() => this.props.onClose()}>\n          <FormattedMessage id=\"promote.cancel\" />\n        </button>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport DialogContainer from \"./dialog-container.js\";\nimport PromoteClientDialog from \"./promote-client-dialog.js\";\nimport styles from \"../assets/stylesheets/client-info-dialog.scss\";\nimport { FormattedMessage } from \"react-intl\";\nimport { sluglessPath } from \"../utils/history\";\nimport { getAvatarThumbnailUrl } from \"../utils/avatar-utils\";\n\nexport function getClientInfoClientId(location) {\n  const { search } = location;\n  const urlParams = new URLSearchParams(search);\n  const pathname = sluglessPath(location);\n\n  if (!pathname.startsWith(\"/client\") && !urlParams.get(\"client_id\")) return null;\n  return urlParams.get(\"client_id\") || pathname.substring(9);\n}\n\nexport default class ClientInfoDialog extends Component {\n  static propTypes = {\n    clientId: PropTypes.string,\n    history: PropTypes.object,\n    hubChannel: PropTypes.object,\n    presences: PropTypes.object,\n    performConditionalSignIn: PropTypes.func,\n    onClose: PropTypes.func,\n    showNonHistoriedDialog: PropTypes.func\n  };\n\n  state = {\n    avatarThumbnailUrl: null\n  };\n\n  kick() {\n    const { clientId, performConditionalSignIn, hubChannel, onClose } = this.props;\n\n    performConditionalSignIn(\n      () => hubChannel.can(\"kick_users\"),\n      async () => await hubChannel.kick(clientId),\n      \"kick-user\"\n    );\n\n    onClose();\n  }\n\n  hide() {\n    const { clientId, onClose, hubChannel } = this.props;\n    hubChannel.hide(clientId);\n    onClose();\n  }\n\n  mute() {\n    const { clientId, performConditionalSignIn, hubChannel, onClose } = this.props;\n\n    performConditionalSignIn(\n      () => hubChannel.can(\"mute_users\"),\n      async () => await hubChannel.mute(clientId),\n      \"mute-user\"\n    );\n\n    onClose();\n  }\n\n  addOwner() {\n    const { clientId, performConditionalSignIn, hubChannel, onClose } = this.props;\n    const { profile } = this.getPresenceEntry();\n\n    performConditionalSignIn(\n      () => hubChannel.can(\"update_roles\"),\n      async () => {\n        onClose();\n\n        this.props.showNonHistoriedDialog(PromoteClientDialog, {\n          displayName: profile.displayName,\n          onConfirm: () => hubChannel.addOwner(clientId)\n        });\n      },\n      \"add-owner\"\n    );\n  }\n\n  removeOwner() {\n    const { clientId, performConditionalSignIn, hubChannel, onClose } = this.props;\n\n    performConditionalSignIn(\n      () => hubChannel.can(\"update_roles\"),\n      async () => await hubChannel.removeOwner(clientId),\n      \"remove-owner\"\n    );\n\n    onClose();\n  }\n\n  unhide() {\n    const { clientId, hubChannel, onClose } = this.props;\n    hubChannel.unhide(clientId);\n    onClose();\n  }\n\n  getPresenceEntry() {\n    if (!this.props.presences) return null;\n\n    const presence = Object.entries(this.props.presences).find(([k]) => k === this.props.clientId);\n    if (!presence) return { profile: {}, roles: {} };\n\n    const metas = presence[1].metas;\n    return metas[metas.length - 1];\n  }\n\n  componentDidMount() {\n    const { profile } = this.getPresenceEntry();\n    if (profile.avatarId) {\n      getAvatarThumbnailUrl(profile.avatarId).then(avatarThumbnailUrl => this.setState({ avatarThumbnailUrl }));\n    }\n  }\n\n  render() {\n    const { profile, roles } = this.getPresenceEntry();\n\n    const { displayName, communityIdentifier } = profile;\n    const { hubChannel, clientId, onClose } = this.props;\n    const title = (\n      <div className={styles.title}>\n        {displayName}\n        <div className={styles.communityIdentifier}>{communityIdentifier}</div>\n      </div>\n    );\n    const mayKick = hubChannel.canOrWillIfCreator(\"kick_users\");\n    const mayMute = hubChannel.canOrWillIfCreator(\"mute_users\");\n    const targetIsOwner = !!roles.owner;\n    const targetIsCreator = !!roles.creator;\n    const targetIsSignedIn = !!roles.signed_in;\n    const mayAddOwner = hubChannel.canOrWillIfCreator(\"update_roles\") && !targetIsOwner && !targetIsCreator;\n    const mayRemoveOwner = hubChannel.canOrWillIfCreator(\"update_roles\") && targetIsOwner && !targetIsCreator;\n    const isHidden = hubChannel.isHidden(clientId);\n\n    return (\n      <DialogContainer className={styles.clientInfoDialog} title={title} wide={true} {...this.props}>\n        <div className={styles.roomInfo}>\n          <div className={styles.clientProfileImage}>\n            <img src={this.state.avatarThumbnailUrl} />\n          </div>\n          <div className={styles.clientActionButtons}>\n            {mayAddOwner && (\n              <button\n                onClick={() => this.addOwner()}\n                disabled={!targetIsSignedIn}\n                title={targetIsSignedIn ? \"Promote\" : `${profile.displayName} is signed out.`}\n              >\n                <img className={styles.buttonIcon} src=\"../assets/images/add-owner.png\" />\n                <FormattedMessage id=\"client-info.add-owner\" />\n              </button>\n            )}\n            {mayRemoveOwner && (\n              <button onClick={() => this.removeOwner()}>\n                <img className={styles.buttonIcon} src=\"../assets/images/remove-owner.png\" />\n                <FormattedMessage id=\"client-info.remove-owner\" />\n              </button>\n            )}\n            {!isHidden && (\n              <button onClick={() => this.hide()}>\n                <FormattedMessage id=\"client-info.hide-button\" />\n              </button>\n            )}\n            {isHidden && (\n              <button onClick={() => this.unhide()}>\n                <FormattedMessage id=\"client-info.unhide-button\" />\n              </button>\n            )}\n            {mayMute && (\n              <button onClick={() => this.mute()}>\n                <FormattedMessage id=\"client-info.mute-button\" />\n              </button>\n            )}\n            {mayKick && (\n              <button onClick={() => this.kick()}>\n                <FormattedMessage id=\"client-info.kick-button\" />\n              </button>\n            )}\n            <button className={styles.cancel} onClick={onClose}>\n              <FormattedMessage id=\"client-info.cancel\" />\n            </button>\n          </div>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { IntlProvider, FormattedMessage } from \"react-intl\";\nimport { lang, messages } from \"../utils/i18n\";\nimport loaderStyles from \"../assets/stylesheets/loader.scss\";\n\nclass Loader extends Component {\n  static propTypes = {\n    scene: PropTypes.object,\n    finished: PropTypes.bool,\n    onLoaded: PropTypes.func\n  };\n\n  doneWithInitialLoad = false;\n  state = {\n    loadingNum: 0,\n    loadedNum: 0\n  };\n\n  componentDidMount() {\n    this.props.scene.addEventListener(\"model-loading\", this.onObjectLoading);\n    this.props.scene.addEventListener(\"image-loading\", this.onObjectLoading);\n    this.props.scene.addEventListener(\"pdf-loading\", this.onObjectLoading);\n    this.props.scene.addEventListener(\"model-loaded\", this.onObjectLoaded);\n    this.props.scene.addEventListener(\"image-loaded\", this.onObjectLoaded);\n    this.props.scene.addEventListener(\"pdf-loaded\", this.onObjectLoaded);\n    this.props.scene.addEventListener(\"model-error\", this.onObjectLoaded);\n    this.props.scene.addEventListener(\n      \"environment-scene-loaded\",\n      () => {\n        this.environmentSceneLoaded = true;\n        this.tryFinishLoading();\n      },\n      { once: true }\n    );\n  }\n\n  componentWillUnmount() {\n    this.props.scene.removeEventListener(\"model-loading\", this.onObjectLoading);\n    this.props.scene.removeEventListener(\"image-loading\", this.onObjectLoading);\n    this.props.scene.removeEventListener(\"pdf-loading\", this.onObjectLoading);\n    this.props.scene.removeEventListener(\"model-loaded\", this.onObjectLoaded);\n    this.props.scene.removeEventListener(\"image-loaded\", this.onObjectLoaded);\n    this.props.scene.removeEventListener(\"pdf-loaded\", this.onObjectLoaded);\n    this.props.scene.removeEventListener(\"model-error\", this.onObjectLoaded);\n  }\n\n  onObjectLoading = () => {\n    if (!this.doneWithInitialLoad && this.loadingTimeout) {\n      window.clearTimeout(this.loadingTimeout);\n      this.loadingTimeout = null;\n    }\n\n    this.setState(state => {\n      return { loadingNum: state.loadingNum + 1 };\n    });\n  };\n\n  onObjectLoaded = () => {\n    this.setState(state => {\n      return { loadedNum: state.loadedNum + 1 };\n    });\n\n    this.tryFinishLoading();\n  };\n\n  tryFinishLoading = () => {\n    if (!this.doneWithInitialLoad && this.loadingTimeout) window.clearTimeout(this.loadingTimeout);\n\n    if (this.environmentSceneLoaded) {\n      this.loadingTimeout = window.setTimeout(() => {\n        this.doneWithInitialLoad = true;\n        if (this.props.onLoaded) {\n          this.props.onLoaded();\n        }\n      }, 1500);\n    }\n  };\n\n  render() {\n    const nomore = (\n      <h4 className={loaderStyles.loadingText}>\n        <FormattedMessage id=\"loader.entering_lobby\" />\n      </h4>\n    );\n    const progress = this.state.loadingNum === 0 ? \" \" : `${this.state.loadedNum} / ${this.state.loadingNum} `;\n    const usual = (\n      <h4 className={loaderStyles.loadingText}>\n        <FormattedMessage id=\"loader.loading\" />\n        {progress}\n        <FormattedMessage id={this.state.loadingNum !== 1 ? \"loader.objects\" : \"loader.object\"} />\n        ...\n      </h4>\n    );\n    return (\n      <IntlProvider locale={lang} messages={messages}>\n        <div className=\"loading-panel\">\n          <img className=\"loading-panel__logo\" style={{height: 150, width: 150}} src={this.props.loadingIcon} />\n\n          {this.props.finished ? nomore : usual}\n\n          <div className=\"loader-wrap loader-bottom\">\n            <div className=\"loader\">\n              <div className=\"loader-center\" />\n            </div>\n          </div>\n        </div>\n      </IntlProvider>\n    );\n  }\n}\n\nexport default Loader;\n","import React from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport PropTypes from \"prop-types\";\n\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nconst AutoExitWarning = props => (\n  <div className=\"autoexit-panel\">\n    <div className=\"autoexit-panel__title\">\n      <FormattedMessage id=\"autoexit.title\" />\n      <span>{props.secondsRemaining}</span>\n      <FormattedMessage id=\"autoexit.title_units\" />\n    </div>\n    <div className=\"autoexit-panel__subtitle\">\n      <FormattedMessage id=\"autoexit.subtitle\" />\n    </div>\n    <WithHoverSound>\n      <div className=\"autoexit-panel__cancel-button\" onClick={props.onCancel}>\n        <FormattedMessage id=\"autoexit.cancel\" />\n      </div>\n    </WithHoverSound>\n  </div>\n);\n\nAutoExitWarning.propTypes = {\n  secondsRemaining: PropTypes.number,\n  onCancel: PropTypes.func\n};\n\nexport default AutoExitWarning;\n","import React from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport PropTypes from \"prop-types\";\n\nimport MobileScreenEntryImg from \"../assets/images/mobile_screen_entry.svg\";\nimport DesktopScreenEntryImg from \"../assets/images/desktop_screen_entry.svg\";\nimport GenericVREntryImg from \"../assets/images/generic_vr_entry.svg\";\nimport GearVREntryImg from \"../assets/images/gearvr_entry.svg\";\nimport DaydreamEntryImg from \"../assets/images/daydream_entry.svg\";\nimport styles from \"../assets/stylesheets/entry.scss\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\nimport cx from \"classnames\";\n\nconst EntryButton = props => {\n  return (\n    <WithHoverSound>\n      <button\n        className={cx([{ [styles.entryButton]: true, [styles.entryButtonSecondary]: props.secondary }])}\n        onClick={props.onClick}\n      >\n        <img src={props.iconSrc} className={styles.icon} />\n        <div className={styles.label}>\n          <div className={styles.contents}>\n            <span>\n              <FormattedMessage id={props.prefixMessageId} />\n            </span>\n            <span className={styles.bolded}>\n              <FormattedMessage id={props.mediumMessageId} />\n            </span>\n            {props.subtitle && (\n              <div className={styles.subtitle}>\n                <FormattedMessage id={props.subtitle} />\n              </div>\n            )}\n          </div>\n        </div>\n      </button>\n    </WithHoverSound>\n  );\n};\n\nEntryButton.propTypes = {\n  onClick: PropTypes.func,\n  iconSrc: PropTypes.string,\n  secondary: PropTypes.bool,\n  prefixMessageId: PropTypes.string,\n  mediumMessageId: PropTypes.string,\n  subtitle: PropTypes.string,\n  isInHMD: PropTypes.bool\n};\n\nconst isMobile = AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR();\n\nexport const TwoDEntryButton = props => {\n  const entryButtonProps = {\n    ...props,\n    iconSrc: isMobile ? MobileScreenEntryImg : DesktopScreenEntryImg,\n    prefixMessageId: \"entry.screen-prefix\",\n    mediumMessageId: isMobile ? \"entry.mobile-screen\" : \"entry.desktop-screen\"\n  };\n\n  return <EntryButton {...entryButtonProps} />;\n};\n\nexport const GenericEntryButton = props => {\n  const entryButtonProps = {\n    ...props,\n    iconSrc: GenericVREntryImg,\n    prefixMessageId: \"entry.generic-prefix\",\n    mediumMessageId: \"entry.generic-medium\",\n    subtitle: isMobile ? null : \"entry.generic-subtitle-desktop\"\n  };\n\n  return <EntryButton {...entryButtonProps} />;\n};\n\nexport const GearVREntryButton = props => {\n  const entryButtonProps = {\n    ...props,\n    iconSrc: GearVREntryImg,\n    prefixMessageId: \"entry.gearvr-prefix\",\n    mediumMessageId: \"entry.gearvr-medium\"\n  };\n\n  return <EntryButton {...entryButtonProps} />;\n};\n\nexport const DaydreamEntryButton = props => {\n  const entryButtonProps = {\n    ...props,\n    iconSrc: DaydreamEntryImg,\n    prefixMessageId: \"entry.daydream-prefix\",\n    mediumMessageId: \"entry.daydream-medium\"\n  };\n\n  return <EntryButton {...entryButtonProps} />;\n};\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { injectIntl, FormattedMessage } from \"react-intl\";\nimport classNames from \"classnames\";\nimport { faPencilAlt } from \"@fortawesome/free-solid-svg-icons/faPencilAlt\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nimport { SCHEMA } from \"../storage/store\";\nimport styles from \"../assets/stylesheets/profile.scss\";\n// import hubLogo from \"../assets/images/hub-preview-white.png\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\nimport { fetchAvatar } from \"../utils/avatar-utils\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\nimport { replaceHistoryState } from \"../utils/history\";\nimport StateLink from \"./state-link\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\n\nimport AvatarPreview from \"./avatar-preview\";\n\nclass ProfileEntryPanel extends Component {\n  static propTypes = {\n    displayNameOverride: PropTypes.string,\n    store: PropTypes.object,\n    mediaSearchStore: PropTypes.object,\n    messages: PropTypes.object,\n    finished: PropTypes.func,\n    intl: PropTypes.object,\n    history: PropTypes.object,\n    avatarId: PropTypes.string,\n    onClose: PropTypes.func\n  };\n\n  state = {\n    avatarId: null,\n    displayName: null,\n    avatar: null\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = this.getStateFromProfile();\n    if (props.avatarId) {\n      this.state.avatarId = props.avatarId;\n    }\n    this.props.store.addEventListener(\"statechanged\", this.storeUpdated);\n    this.scene = document.querySelector(\"a-scene\");\n  }\n\n  getStateFromProfile = () => {\n    const { displayName, avatarId } = this.props.store.state.profile;\n    return { displayName, avatarId };\n  };\n\n  storeUpdated = () => this.setState(this.getStateFromProfile());\n\n  saveStateAndFinish = e => {\n    e && e.preventDefault();\n\n    const { displayName } = this.props.store.state.profile;\n    const { hasChangedName } = this.props.store.state.activity;\n\n    const hasChangedNowOrPreviously = hasChangedName || this.state.displayName !== displayName;\n    this.props.store.update({\n      activity: {\n        hasChangedName: hasChangedNowOrPreviously,\n        hasAcceptedProfile: true\n      },\n      profile: {\n        displayName: this.state.displayName,\n        avatarId: this.state.avatarId\n      }\n    });\n    this.props.finished();\n  };\n\n  stopPropagation = e => {\n    e.stopPropagation();\n  };\n\n  setAvatarFromMediaResult = ({ detail: entry }) => {\n    this.setState({ avatarId: entry.id });\n    // Replace history state with the current avatar id since this component gets destroyed when we open the\n    // avatar editor and we want the back button to work. We read the history state back via the avatarId prop.\n    // We read the current state key from history since it could be \"overlay\" or \"entry_step\".\n    replaceHistoryState(this.props.history, this.props.history.location.state.key, \"profile\", { avatarId: entry.id });\n  };\n\n  componentDidMount() {\n    if (this.nameInput) {\n      // stop propagation so that avatar doesn't move when wasd'ing during text input.\n      this.nameInput.addEventListener(\"keydown\", this.stopPropagation);\n      this.nameInput.addEventListener(\"keypress\", this.stopPropagation);\n      this.nameInput.addEventListener(\"keyup\", this.stopPropagation);\n    }\n    this.scene.addEventListener(\"action_selected_media_result_entry\", this.setAvatarFromMediaResult);\n    // This handles editing avatars in the entry_step, since this component remains mounted with the same avatarId\n    this.scene.addEventListener(\"action_avatar_saved\", this.refetchAvatar);\n\n    this.refetchAvatar();\n  }\n\n  componentDidUpdate(_prevProps, prevState) {\n    if (prevState.avatarId !== this.state.avatarId) {\n      this.refetchAvatar();\n    }\n  }\n\n  componentWillUnmount() {\n    this.props.store.removeEventListener(\"statechanged\", this.storeUpdated);\n    if (this.nameInput) {\n      this.nameInput.removeEventListener(\"keydown\", this.stopPropagation);\n      this.nameInput.removeEventListener(\"keypress\", this.stopPropagation);\n      this.nameInput.removeEventListener(\"keyup\", this.stopPropagation);\n    }\n    this.scene.removeEventListener(\"action_selected_media_result_entry\", this.setAvatarFromMediaResult);\n    this.scene.removeEventListener(\"action_avatar_saved\", this.refetchAvatar);\n  }\n\n  refetchAvatar = async () => {\n    const avatar = await fetchAvatar(this.state.avatarId);\n    if (this.state.avatarId !== avatar.avatar_id) return; // This is an old result, ignore it\n    this.setState({ avatar });\n  };\n\n  render() {\n    const { formatMessage } = this.props.intl;\n\n    return (\n      <div className={styles.profileEntry}>\n        <div className={styles.close}>\n          <a onClick={() => this.props.onClose()}>\n            <i>\n              <FontAwesomeIcon icon={faTimes} />\n            </i>\n          </a>\n        </div>\n        <form onSubmit={this.saveStateAndFinish} className={styles.form}>\n          <div className={classNames([styles.box, styles.darkened])}>\n            <label htmlFor=\"#profile-entry-display-name\" className={styles.title}>\n              <FormattedMessage id=\"profile.header\" />\n            </label>\n            {this.props.displayNameOverride ? (\n              <span className={styles.displayName}>{this.props.displayNameOverride}</span>\n            ) : (\n              <input\n                id=\"profile-entry-display-name\"\n                className={styles.formFieldText}\n                value={this.state.displayName}\n                onFocus={e => handleTextFieldFocus(e.target)}\n                onBlur={() => handleTextFieldBlur()}\n                onChange={e => this.setState({ displayName: e.target.value })}\n                required\n                spellCheck=\"false\"\n                pattern={SCHEMA.definitions.profile.properties.displayName.pattern}\n                title={formatMessage({ id: \"profile.display_name.validation_warning\" })}\n                ref={inp => (this.nameInput = inp)}\n              />\n            )}\n\n            {this.state.avatar ? (\n              <div className={styles.preview}>\n                <AvatarPreview avatarGltfUrl={this.state.avatar.gltf_url} />\n\n                {this.state.avatar.account_id === this.props.store.credentialsAccountId && (\n                  <StateLink\n                    stateKey=\"overlay\"\n                    stateValue=\"avatar-editor\"\n                    stateDetail={{ avatarId: this.state.avatarId, hideDelete: true, returnToProfile: true }}\n                    history={this.props.history}\n                    className={styles.editAvatar}\n                  >\n                    <FontAwesomeIcon icon={faPencilAlt} />\n                  </StateLink>\n                )}\n\n                <div className={styles.chooseAvatar}>\n                  <a onClick={() => this.props.mediaSearchStore.sourceNavigateWithNoNav(\"avatars\")}>\n                    <FormattedMessage id=\"profile.choose_avatar\" />\n                  </a>\n                </div>\n              </div>\n            ) : (\n              <div className={styles.preview}>\n                <div className={styles.chooseAvatar}>\n                  <a onClick={() => this.props.mediaSearchStore.sourceNavigateWithNoNav(\"avatars\")}>\n                    <FormattedMessage id=\"profile.choose_avatar\" />\n                  </a>\n                </div>\n              </div>\n            )}\n\n            <WithHoverSound>\n              <input className={styles.formSubmit} type=\"submit\" value={formatMessage({ id: \"profile.save\" })} />\n            </WithHoverSound>\n            <div className={styles.links}>\n              <WithHoverSound>\n                <a\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  href={this.props.termsLink || \"https://github.com/mozilla/hubs/blob/master/TERMS.md\"}\n                >\n                  <FormattedMessage id=\"profile.terms_of_use\" />\n                </a>\n              </WithHoverSound>\n\n              <WithHoverSound>\n                <a\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  href={this.props.privacyLink || \"https://github.com/mozilla/hubs/blob/master/PRIVACY.md\"}\n                >\n                  <FormattedMessage id=\"profile.privacy_notice\" />\n                </a>\n              </WithHoverSound>\n            </div>\n          </div>\n        </form>\n        <img className={styles.logo} src={this.props.logo} />\n      </div>\n    );\n  }\n}\n\nexport default injectIntl(ProfileEntryPanel);\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { injectIntl, FormattedMessage } from \"react-intl\";\nimport classNames from \"classnames\";\nimport { faAngleRight } from \"@fortawesome/free-solid-svg-icons/faAngleRight\";\nimport { faSearch } from \"@fortawesome/free-solid-svg-icons/faSearch\";\nimport { faStar } from \"@fortawesome/free-solid-svg-icons/faStar\";\nimport { faCloudUploadAlt } from \"@fortawesome/free-solid-svg-icons/faCloudUploadAlt\";\nimport { faLink } from \"@fortawesome/free-solid-svg-icons/faLink\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nimport styles from \"../assets/stylesheets/media-browser.scss\";\nimport { pushHistoryPath, pushHistoryState, sluglessPath } from \"../utils/history\";\nimport { SOURCES } from \"../storage/media-search-store\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\nimport { showFullScreenIfWasFullScreen } from \"../utils/fullscreen\";\nimport MediaTiles from \"./media-tiles\";\n\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\n\nconst PRIVACY_POLICY_LINKS = {\n  videos: \"https://privacy.microsoft.com/en-us/privacystatement\",\n  images: \"https://privacy.microsoft.com/en-us/privacystatement\",\n  gifs: \"https://tenor.com/legal-privacy\",\n  sketchfab: \"https://sketchfab.com/privacy\",\n  poly: \"https://policies.google.com/privacy\",\n  youtube: \"https://policies.google.com/privacy\",\n  twitch: \"https://www.twitch.tv/p/legal/privacy-policy/\"\n};\n\nconst DEFAULT_FACETS = {\n  sketchfab: [\n    { text: \"Animals\", params: { filter: \"animals-pets\" } },\n    { text: \"Architecture\", params: { filter: \"architecture\" } },\n    { text: \"Art\", params: { filter: \"art-abstract\" } },\n    { text: \"Vehicles\", params: { filter: \"cars-vehicles\" } },\n    { text: \"Characters\", params: { filter: \"characters-creatures\" } },\n    { text: \"Culture\", params: { filter: \"cultural-heritage-history\" } },\n    { text: \"Gadgets\", params: { filter: \"electronics-gadgets\" } },\n    { text: \"Fashion\", params: { filter: \"fashion-style\" } },\n    { text: \"Food\", params: { filter: \"food-drink\" } },\n    { text: \"Furniture\", params: { filter: \"furniture-home\" } },\n    { text: \"Music\", params: { filter: \"music\" } },\n    { text: \"Nature\", params: { filter: \"nature-plants\" } },\n    { text: \"News\", params: { filter: \"news-politics\" } },\n    { text: \"People\", params: { filter: \"people\" } },\n    { text: \"Places\", params: { filter: \"places-travel\" } },\n    { text: \"Science\", params: { filter: \"science-technology\" } },\n    { text: \"Sports\", params: { filter: \"sports-fitness\" } },\n    { text: \"Weapons\", params: { filter: \"weapons-military\" } }\n  ],\n  poly: [\n    { text: \"Animals\", params: { filter: \"animals\" } },\n    { text: \"Architecture\", params: { filter: \"architecture\" } },\n    { text: \"Art\", params: { filter: \"art\" } },\n    { text: \"Food\", params: { filter: \"food\" } },\n    { text: \"Nature\", params: { filter: \"nature\" } },\n    { text: \"Objects\", params: { filter: \"objects\" } },\n    { text: \"People\", params: { filter: \"people\" } },\n    { text: \"Scenes\", params: { filter: \"scenes\" } },\n    { text: \"Transport\", params: { filter: \"transport\" } }\n  ],\n  avatars: [\n    { text: \"Featured\", params: { filter: \"featured\" } },\n    { text: \"My Avatars\", params: { filter: \"my-avatars\" } }\n  ],\n  favorites: [],\n  scenes: [{ text: \"Featured\", params: { filter: \"featured\" } }, { text: \"My Scenes\", params: { filter: \"my-scenes\" } }]\n};\n\nclass MediaBrowser extends Component {\n  static propTypes = {\n    mediaSearchStore: PropTypes.object,\n    history: PropTypes.object,\n    intl: PropTypes.object,\n    hubChannel: PropTypes.object,\n    onMediaSearchResultEntrySelected: PropTypes.func,\n    performConditionalSignIn: PropTypes.func\n  };\n\n  state = { query: \"\", facets: [], showNav: true, selectNextResult: false, clearStashedQueryOnClose: false };\n\n  constructor(props) {\n    super(props);\n    this.state = this.getStoreAndHistoryState(props);\n    this.props.mediaSearchStore.addEventListener(\"statechanged\", this.storeUpdated);\n    this.props.mediaSearchStore.addEventListener(\"sourcechanged\", this.sourceChanged);\n  }\n\n  componentDidMount() {}\n\n  componentWillUnmount() {\n    this.props.mediaSearchStore.removeEventListener(\"statechanged\", this.storeUpdated);\n    this.props.mediaSearchStore.removeEventListener(\"sourcechanged\", this.sourceChanged);\n  }\n\n  storeUpdated = () => {\n    const newState = this.getStoreAndHistoryState(this.props);\n    this.setState(newState);\n\n    if (this.state.selectNextResult) {\n      if (newState.result && newState.result.entries.length > 0) {\n        this.selectEntry(newState.result.entries[0]);\n      } else {\n        this.close();\n      }\n    }\n  };\n\n  sourceChanged = () => {\n    if (this.inputRef && !isMobile && !isMobileVR) {\n      this.inputRef.focus();\n    }\n  };\n\n  getUrlSource = searchParams =>\n    searchParams.get(\"media_source\") || sluglessPath(this.props.history.location).substring(7);\n\n  getStoreAndHistoryState = props => {\n    const searchParams = new URLSearchParams(props.history.location.search);\n    const result = props.mediaSearchStore.result;\n\n    const newState = { result, query: this.state.query || searchParams.get(\"q\") || \"\" };\n    const urlSource = this.getUrlSource(searchParams);\n    newState.showNav = !!(searchParams.get(\"media_nav\") !== \"false\");\n\n    if (result && result.suggestions && result.suggestions.length > 0) {\n      newState.facets = result.suggestions.map(s => {\n        return { text: s, params: { q: s } };\n      });\n    } else {\n      newState.facets = DEFAULT_FACETS[urlSource] || [];\n    }\n\n    return newState;\n  };\n\n  handleQueryUpdated = (query, forceNow) => {\n    this.setState({ result: null });\n\n    if (this._sendQueryTimeout) {\n      clearTimeout(this._sendQueryTimeout);\n      this._sendQueryTimeout = null;\n    }\n\n    if (forceNow) {\n      this.props.mediaSearchStore.filterQueryNavigate(\"\", query);\n    } else {\n      // Don't update search on every keystroke, but buffer for some ms.\n      this._sendQueryTimeout = setTimeout(() => {\n        // Drop filter for now, so entering text drops into \"search all\" mode\n        this.props.mediaSearchStore.filterQueryNavigate(\"\", query);\n        this._sendQueryTimeout = null;\n      }, 500);\n    }\n\n    this.setState({ query });\n  };\n\n  handleEntryClicked = (evt, entry) => {\n    evt.preventDefault();\n\n    if (!entry.lucky_query) {\n      this.selectEntry(entry);\n    } else {\n      // Entry has a pointer to another \"i'm feeling lucky\" query -- used for trending videos\n      //\n      // Also, mark the browser to clear the stashed query on close, since this is a temporary\n      // query we are running to get the result we want.\n      this.setState({ clearStashedQueryOnClose: true });\n      this.handleQueryUpdated(entry.lucky_query, true);\n    }\n  };\n\n  selectEntry = entry => {\n    if (!this.props.onMediaSearchResultEntrySelected) return;\n    this.props.onMediaSearchResultEntrySelected(entry);\n    this.close();\n  };\n\n  handleSourceClicked = source => {\n    this.props.mediaSearchStore.sourceNavigate(source);\n  };\n\n  handleFacetClicked = facet => {\n    const searchParams = this.getSearchClearedSearchParams(true, true);\n\n    for (const [k, v] of Object.entries(facet.params)) {\n      searchParams.set(k, v);\n    }\n\n    pushHistoryPath(this.props.history, this.props.history.location.pathname, searchParams.toString());\n  };\n\n  getSearchClearedSearchParams = (keepSource, keepNav) => {\n    return this.props.mediaSearchStore.getSearchClearedSearchParams(this.props.history.location, keepSource, keepNav);\n  };\n\n  pushExitMediaBrowserHistory = (stashLastSearchParams = true) => {\n    this.props.mediaSearchStore.pushExitMediaBrowserHistory(this.props.history, stashLastSearchParams);\n  };\n\n  showCustomMediaDialog = source => {\n    const isSceneApiType = source === \"scenes\";\n    const isAvatarApiType = source === \"avatars\";\n    this.pushExitMediaBrowserHistory(!isAvatarApiType);\n    const dialog = isSceneApiType ? \"change_scene\" : isAvatarApiType ? \"avatar_url\" : \"create\";\n    pushHistoryState(this.props.history, \"modal\", dialog);\n  };\n\n  close = () => {\n    showFullScreenIfWasFullScreen();\n    const urlSource = this.getUrlSource(new URLSearchParams(this.props.history.location.search));\n    this.pushExitMediaBrowserHistory(urlSource !== \"avatars\" && urlSource !== \"favorites\");\n    if (this.state.clearStashedQueryOnClose) {\n      this.props.mediaSearchStore.clearStashedQuery();\n    }\n  };\n\n  handlePager = delta => {\n    this.setState({ result: null });\n    this.props.mediaSearchStore.pageNavigate(delta);\n    this.browserDiv.scrollTop = 0;\n  };\n\n  render() {\n    const { formatMessage } = this.props.intl;\n    const searchParams = new URLSearchParams(this.props.history.location.search);\n    const urlSource = this.getUrlSource(searchParams);\n    const isSceneApiType = urlSource === \"scenes\";\n    const isFavorites = urlSource === \"favorites\";\n    const showCustomOption =\n      !isFavorites && (!isSceneApiType || this.props.hubChannel.canOrWillIfCreator(\"update_hub\"));\n    const entries = (this.state.result && this.state.result.entries) || [];\n    const hideSearch = urlSource === \"avatars\" || urlSource === \"favorites\";\n    const showEmptyStringOnNoResult = urlSource !== \"avatars\" && urlSource !== \"scenes\";\n\n    // Don't render anything if we just did a feeling lucky query and are waiting on result.\n    if (this.state.selectNextResult) return <div />;\n    const handleCustomClicked = urlSource => {\n      const isAvatarApiType = urlSource === \"avatars\";\n      if (isAvatarApiType) {\n        this.showCustomMediaDialog(urlSource);\n      } else {\n        this.props.performConditionalSignIn(\n          () => !isSceneApiType || this.props.hubChannel.can(\"update_hub\"),\n          () => this.showCustomMediaDialog(urlSource),\n          \"change-scene\"\n        );\n      }\n    };\n\n    return (\n      <div className={styles.mediaBrowser} ref={browserDiv => (this.browserDiv = browserDiv)}>\n        <div className={classNames([styles.box, styles.darkened])}>\n          <div className={classNames(styles.header, { [styles.noSearch]: hideSearch })}>\n            <div className={styles.headerLeft}>\n              <a onClick={() => this.close()}>\n                <i>\n                  <FontAwesomeIcon icon={faTimes} />\n                </i>\n              </a>\n            </div>\n            <div className={styles.headerCenter}>\n              {urlSource === \"favorites\" && (\n                <div className={styles.favoritesHeader}>\n                  <i>\n                    <FontAwesomeIcon icon={faStar} />\n                  </i>\n                  <FormattedMessage id=\"media-browser.favorites-header\" />\n                </div>\n              )}\n              {!hideSearch && (\n                <div className={styles.search}>\n                  <i className={styles.searchIcon}>\n                    <FontAwesomeIcon icon={faSearch} />\n                  </i>\n                  <input\n                    type=\"text\"\n                    autoFocus={!isMobile && !isMobileVR}\n                    ref={r => (this.inputRef = r)}\n                    placeholder={formatMessage({\n                      id: `media-browser.search-placeholder.${urlSource}`\n                    })}\n                    onFocus={e => handleTextFieldFocus(e.target)}\n                    onBlur={() => handleTextFieldBlur()}\n                    onKeyDown={e => {\n                      if (e.key === \"Enter\" && e.ctrlKey) {\n                        if (entries.length > 0 && !this._sendQueryTimeout) {\n                          this.handleEntryClicked(e, entries[0]);\n                        } else if (this.state.query.trim() !== \"\") {\n                          this.handleQueryUpdated(this.state.query, true);\n                          this.setState({ selectNextResult: true });\n                        } else {\n                          this.close();\n                        }\n                      } else if (e.key === \"Escape\" || (e.key === \"Enter\" && isMobile)) {\n                        e.target.blur();\n                      }\n                    }}\n                    value={this.state.query}\n                    onChange={e => this.handleQueryUpdated(e.target.value)}\n                  />\n                  <i className={styles.searchClear} onClick={() => this.handleQueryUpdated(\"\", true)}>\n                    <FontAwesomeIcon icon={faTimes} />\n                  </i>\n                </div>\n              )}\n              <div className={styles.engineAttribution}>\n                {!hideSearch &&\n                  urlSource !== \"scenes\" &&\n                  urlSource !== \"avatars\" &&\n                  urlSource !== \"favorites\" && (\n                    <div className={styles.engineAttributionContents}>\n                      <FormattedMessage id={`media-browser.powered_by.${urlSource}`} />\n                      {PRIVACY_POLICY_LINKS[urlSource] && (\n                        <a href={PRIVACY_POLICY_LINKS[urlSource]} target=\"_blank\" rel=\"noreferrer noopener\">\n                          <FormattedMessage id=\"media-browser.privacy_policy\" />\n                        </a>\n                      )}\n                    </div>\n                  )}\n                {urlSource === \"scenes\" && (\n                  <div className={styles.engineAttributionContents}>\n                    <FormattedMessage id={`media-browser.powered_by.${urlSource}`} />\n                    <a href=\"/spoke\" target=\"_blank\" rel=\"noreferrer noopener\">\n                      <FormattedMessage id=\"media-browser.spoke\" />\n                    </a>\n                    |\n                    <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"/?report\">\n                      <FormattedMessage id=\"media-browser.report_issue\" />\n                    </a>\n                  </div>\n                )}\n              </div>\n            </div>\n            <div className={styles.headerRight}>\n              {showCustomOption && (\n                <a onClick={() => handleCustomClicked(urlSource)} className={styles.createButton}>\n                  <i>\n                    <FontAwesomeIcon icon={[\"scenes\", \"avatars\"].includes(urlSource) ? faLink : faCloudUploadAlt} />\n                  </i>\n                </a>\n              )}\n              {showCustomOption && (\n                <a onClick={() => handleCustomClicked(urlSource)} className={styles.createLink}>\n                  <FormattedMessage\n                    id={`media-browser.add_custom_${\n                      this.state.result && isSceneApiType ? \"scene\" : urlSource === \"avatars\" ? \"avatar\" : \"object\"\n                    }`}\n                  />\n                </a>\n              )}\n            </div>\n          </div>\n\n          {this.state.showNav && (\n            <div className={styles.nav}>\n              {SOURCES.map(s => (\n                <a\n                  onClick={() => this.handleSourceClicked(s)}\n                  key={s}\n                  className={classNames({ [styles.navSource]: true, [styles.navSourceSelected]: urlSource === s })}\n                >\n                  <FormattedMessage id={`media-browser.nav_title.${s}`} />\n                </a>\n              ))}\n              <div className={styles.navRightPad}>&nbsp;</div>\n              <div className={styles.navScrollArrow}>\n                <FontAwesomeIcon icon={faAngleRight} />\n              </div>\n            </div>\n          )}\n\n          {this.state.facets &&\n            this.state.facets.length > 0 && (\n              <div className={styles.facets}>\n                {this.state.facets.map((s, i) => (\n                  <a onClick={() => this.handleFacetClicked(s)} key={i} className={styles.facet}>\n                    {s.text}\n                  </a>\n                ))}\n              </div>\n            )}\n\n          {this.props.mediaSearchStore.isFetching ||\n          this._sendQueryTimeout ||\n          (this.state.result && this.state.result.entries.length > 0) ||\n          !showEmptyStringOnNoResult ? (\n            <MediaTiles\n              result={this.state.result}\n              history={this.props.history}\n              urlSource={urlSource}\n              handleEntryClicked={this.handleEntryClicked}\n              handlePager={this.handlePager}\n            />\n          ) : (\n            <div className={styles.emptyString}>\n              <FormattedMessage id={`media-browser.empty.${urlSource}`} />\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default injectIntl(MediaBrowser);\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport giphyLogo from \"../assets/images/giphy_logo.png\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faPaperclip } from \"@fortawesome/free-solid-svg-icons/faPaperclip\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport styles from \"../assets/stylesheets/create-object-dialog.scss\";\nimport cx from \"classnames\";\nimport DialogContainer from \"./dialog-container.js\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nconst attributionHostnames = {\n  \"giphy.com\": giphyLogo,\n  \"media.giphy.com\": giphyLogo\n};\n\nconst DEFAULT_OBJECT_URL = \"https://asset-bundles-prod.reticulum.io/interactables/Ducky/DuckyMesh-438ff8e022.gltf\";\nconst isMobile = AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR();\nconst instructions = \"Paste a URL to an image, video, model, scene, or upload.\";\nconst desktopTips = \"Tip: You can paste URLs directly into Hubs with Ctrl+V\";\nconst references = (\n  <span>\n    For models, try{\" \"}\n    <a href=\"https://sketchfab.com/search?features=downloadable&type=models\" target=\"_blank\" rel=\"noopener noreferrer\">\n      Sketchfab\n    </a>,{\" \"}\n    <a href=\"http://poly.google.com/\" target=\"_blank\" rel=\"noopener noreferrer\">\n      Google Poly\n    </a>, or our{\" \"}\n    <a href=\"https://sketchfab.com/mozillareality\" target=\"_blank\" rel=\"noopener noreferrer\">\n      collection\n    </a>.\n  </span>\n);\n\nconst mobileInstructions = (\n  <div>\n    <p>{instructions}</p>\n    <p>{references}</p>\n  </div>\n);\nconst desktopInstructions = (\n  <div>\n    <p>{instructions}</p>\n    <p>{references}</p>\n    <p>{desktopTips}</p>\n  </div>\n);\n\nlet lastUrl = \"\";\nconst fileInputId = \"file-input\";\n\nexport default class CreateObjectDialog extends Component {\n  state = {\n    url: \"\",\n    file: null,\n    fileName: \"\"\n  };\n\n  static propTypes = {\n    onCreate: PropTypes.func,\n    onClose: PropTypes.func\n  };\n\n  componentDidMount() {\n    this.setState({ url: lastUrl });\n  }\n\n  componentWillUnmount() {\n    lastUrl = this.state.url;\n  }\n\n  onUrlChange = e => {\n    let attributionImage = this.state.attributionImage;\n    if (e.target && e.target.value && e.target.validity.valid) {\n      const url = new URL(e.target.value);\n      attributionImage = attributionHostnames[url.hostname];\n    }\n    this.setState({\n      url: e.target && e.target.value,\n      attributionImage: attributionImage\n    });\n  };\n\n  onFileChange = e => {\n    this.setState({\n      file: e.target.files[0],\n      fileName: e.target.files[0].name\n    });\n  };\n\n  reset = e => {\n    e.preventDefault();\n    this.setState({\n      url: \"\",\n      file: null,\n      fileName: \"\"\n    });\n    this.fileInput.value = null;\n  };\n\n  onCreateClicked = e => {\n    e.preventDefault();\n    this.props.onCreate(this.state.file || this.state.url || DEFAULT_OBJECT_URL);\n    this.props.onClose();\n  };\n\n  render() {\n    const { onCreate, onClose, ...other } = this.props; // eslint-disable-line no-unused-vars\n\n    const cancelButton = (\n      <WithHoverSound>\n        <label className={cx(styles.smallButton, styles.cancelIcon)} onClick={this.reset}>\n          <FontAwesomeIcon icon={faTimes} />\n        </label>\n      </WithHoverSound>\n    );\n    const uploadButton = (\n      <WithHoverSound>\n        <label htmlFor={fileInputId} className={cx(styles.smallButton, styles.uploadIcon)}>\n          <FontAwesomeIcon icon={faPaperclip} />\n        </label>\n      </WithHoverSound>\n    );\n    const filenameLabel = <label className={cx(styles.leftSideOfInput)}>{this.state.fileName}</label>;\n    const urlInput = (\n      <input\n        className={cx(styles.leftSideOfInput)}\n        placeholder=\"Image/Video/glTF URL\"\n        onFocus={e => handleTextFieldFocus(e.target)}\n        onBlur={() => handleTextFieldBlur()}\n        onChange={this.onUrlChange}\n        type=\"url\"\n        value={this.state.url}\n      />\n    );\n\n    return (\n      <DialogContainer title=\"Create Object\" onClose={this.props.onClose} {...other}>\n        <div>\n          {isMobile ? mobileInstructions : desktopInstructions}\n          <form onSubmit={this.onCreateClicked}>\n            <div className={styles.addMediaForm}>\n              <input\n                id={fileInputId}\n                ref={f => (this.fileInput = f)}\n                className={styles.hideFileInput}\n                type=\"file\"\n                onChange={this.onFileChange}\n              />\n              <div className={styles.inputBorder}>\n                {this.state.file ? filenameLabel : urlInput}\n                {this.state.url || this.state.fileName ? cancelButton : uploadButton}\n              </div>\n              <div className={styles.buttons}>\n                <WithHoverSound>\n                  <button className={styles.actionButton}>\n                    <span>Create</span>\n                  </button>\n                </WithHoverSound>\n              </div>\n              {this.state.attributionImage ? (\n                <div>\n                  <img src={this.state.attributionImage} />\n                </div>\n              ) : null}\n            </div>\n          </form>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"../assets/stylesheets/change-scene-dialog.scss\";\nimport cx from \"classnames\";\nimport DialogContainer from \"./dialog-container.js\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport default class ChangeSceneDialog extends Component {\n  state = {\n    url: \"\"\n  };\n\n  static propTypes = {\n    onChange: PropTypes.func,\n    onClose: PropTypes.func\n  };\n\n  onUrlChange = e => {\n    this.setState({\n      url: e.target && e.target.value\n    });\n  };\n\n  reset = e => {\n    e.preventDefault();\n    this.setState({ url: \"\" });\n  };\n\n  onChangeClicked = e => {\n    e.preventDefault();\n\n    if (this.state.url) {\n      this.props.onChange(this.state.url);\n    }\n\n    this.props.onClose();\n  };\n\n  render() {\n    const { onChange, onClose } = this.props; // eslint-disable-line no-unused-vars\n\n    return (\n      <DialogContainer title=\"Custom Scene\" onClose={this.props.onClose}>\n        <div>\n          <div>\n            <p>\n              Paste a URL to a{\" \"}\n              <a href=\"/spoke\" target=\"_blank\" rel=\"noopener noreferrer\">\n                Spoke\n              </a>{\" \"}\n              scene or a URL to a{\" \"}\n              <a href=\"https://en.wikipedia.org/wiki/GlTF#GLB\" target=\"_blank\" rel=\"noopener noreferrer\">\n                GLB\n              </a>.\n            </p>\n          </div>\n          <form onSubmit={this.onChangeClicked}>\n            <div className={styles.changeSceneForm}>\n              <div className={styles.inputBorder}>\n                <input\n                  className={cx(styles.leftSideOfInput)}\n                  placeholder=\"Scene URL\"\n                  onFocus={e => handleTextFieldFocus(e.target)}\n                  onBlur={() => handleTextFieldBlur()}\n                  onChange={this.onUrlChange}\n                  type=\"url\"\n                  value={this.state.url}\n                />\n              </div>\n              <div className={styles.buttons}>\n                <button className={styles.actionButton}>\n                  <FormattedMessage id=\"change-scene-dialog.change-scene\" />\n                </button>\n              </div>\n              <div className={styles.spokeCreate}>\n                <div>\n                  <FormattedMessage id=\"change-scene-dialog.create-in-spoke\" />\n                </div>\n                <a className={styles.spokeLaunch} href=\"/spoke/new\" target=\"_blank\" rel=\"noopener noreferrer\">\n                  <FormattedMessage id=\"change-scene-dialog.new-spoke-project\" />\n                </a>\n              </div>\n            </div>\n          </form>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\n\nimport styles from \"../assets/stylesheets/avatar-url-dialog.scss\";\nimport DialogContainer from \"./dialog-container.js\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\n\nexport default class AvatarUrlDialog extends Component {\n  state = {\n    url: \"\"\n  };\n\n  static propTypes = {\n    onChange: PropTypes.func,\n    onClose: PropTypes.func\n  };\n\n  onUrlChange = e => {\n    this.setState({\n      url: e.target && e.target.value\n    });\n  };\n\n  onChangeClicked = e => {\n    e.preventDefault();\n\n    if (this.state.url) {\n      this.props.onChange(this.state.url);\n    }\n\n    this.props.onClose();\n  };\n\n  render() {\n    return (\n      <DialogContainer title=\"Custom Avatar URL\" className={styles.avatarUrlDialog} onClose={this.props.onClose}>\n        <p>\n          Paste a URL to a{\" \"}\n          <a href=\"https://en.wikipedia.org/wiki/GlTF#GLB\" target=\"_blank\" rel=\"noopener noreferrer\">\n            GLB\n          </a>.\n        </p>\n        <form className=\"form\" onSubmit={this.onChangeClicked}>\n          <input\n            className=\"url-field\"\n            placeholder=\"Avatar GLB URL\"\n            onFocus={e => handleTextFieldFocus(e.target)}\n            onBlur={() => handleTextFieldBlur()}\n            onChange={this.onUrlChange}\n            type=\"url\"\n            value={this.state.url}\n          />\n          <button className=\"submit\">\n            <FormattedMessage id=\"avatar-url-dialog.apply\" />\n          </button>\n        </form>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport DialogContainer from \"./dialog-container.js\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nexport default class HelpDialog extends Component {\n  render() {\n    return (\n      <DialogContainer title=\"Getting Started\" {...this.props}>\n        <div className=\"info-dialog__help\">\n          <p style={{ textAlign: \"center\" }}>\n            Join the Hubs community on{\" \"}\n            <WithHoverSound>\n              <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://discord.gg/wHmY4nd\">\n                Discord\n              </a>\n            </WithHoverSound>\n            !\n          </p>\n          <p>When in a room, other avatars can see and hear you.</p>\n          <p>\n            Use your controller&apos;s action button to teleport from place to place. If it has a grip, use it to pick\n            up objects.\n          </p>\n          <p>\n            In VR, <b>look up</b> to find your menu.\n          </p>\n          <p>\n            The <b>Mic Toggle</b> mutes your mic.\n          </p>\n          <p>\n            The <b>Pause Toggle</b> pauses all other avatars and lets you block others or pin or remove objects.\n          </p>\n          <p>\n            See detailed{\" \"}\n            <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://github.com/mozilla/hubs/wiki/Hubs-Features\">\n              feature\n            </a>{\" \"}\n            and{\" \"}\n            <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://github.com/mozilla/hubs/wiki/Hubs-Controls\">\n              controls\n            </a>{\" \"}\n            documentation.\n          </p>\n          <p className=\"dialog__box__contents__links\">\n            <WithHoverSound>\n              <a target=\"_blank\" rel=\"noopener noreferrer\" href={this.props.termsLink || \"https://github.com/mozilla/hubs/blob/master/TERMS.md\"}>\n                <FormattedMessage id=\"profile.terms_of_use\" />\n              </a>\n            </WithHoverSound>\n            <WithHoverSound>\n              <a\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                href={this.props.privacyLink || \"https://github.com/mozilla/hubs/blob/master/PRIVACY.md\"}\n              >\n                <FormattedMessage id=\"profile.privacy_notice\" />\n              </a>\n            </WithHoverSound>\n            <WithHoverSound>\n              <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"/?report\">\n                <FormattedMessage id=\"help.report_issue\" />\n              </a>\n            </WithHoverSound>\n          </p>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport copy from \"copy-to-clipboard\";\nimport classNames from \"classnames\";\nimport { FormattedMessage } from \"react-intl\";\nimport { share, canShare } from \"../utils/share\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nimport { WithHoverSound } from \"./wrap-with-audio\";\nimport styles from \"../assets/stylesheets/invite-dialog.scss\";\n\nfunction pad(num, size) {\n  let s = `${num}`;\n  while (s.length < size) s = `0${s}`;\n  return s;\n}\n\nexport default class InviteDialog extends Component {\n  static propTypes = {\n    entryCode: PropTypes.number,\n    hubId: PropTypes.string,\n    allowShare: PropTypes.bool,\n    isModal: PropTypes.bool,\n    onClose: PropTypes.func,\n    hasPush: PropTypes.bool,\n    isSubscribed: PropTypes.bool,\n    onSubscribeChanged: PropTypes.func,\n    embedUrl: PropTypes.string\n  };\n\n  state = {\n    copyButtonActive: false,\n    shareButtonActive: false\n  };\n\n  shareClicked = url => {\n    this.setState({ shareButtonActive: true });\n    share({ url, title: \"Join me now in #hubs!\" }).then(() => {\n      this.setState({ shareButtonActive: false });\n    });\n  };\n\n  copyClicked = link => {\n    this.setState({ copyButtonActive: true });\n    setTimeout(() => this.setState({ copyButtonActive: false }), 5000);\n\n    copy(link);\n  };\n\n  render() {\n    const { entryCode, embedUrl } = this.props;\n\n    const entryCodeString = pad(entryCode, 6);\n    const shortLinkText = `hub.link/${this.props.hubId}`;\n    const shortLink = \"https://\" + shortLinkText;\n    const embedText = `<iframe src=\"${embedUrl}\" style=\"width: 1024px; height: 768px;\" allow=\"microphone; camera; vr; speaker;\"></iframe>`;\n\n    return (\n      <div className={classNames({ [styles.dialog]: true, [styles.modal]: this.props.isModal })}>\n        {!this.props.isModal && <div className={styles.attachPoint} />}\n        <WithHoverSound>\n          <button className={styles.close} onClick={() => this.props.onClose()}>\n            <i>\n              <FontAwesomeIcon icon={faTimes} />\n            </i>\n          </button>\n        </WithHoverSound>\n        <div>\n          <FormattedMessage id={`invite.enter_via${this.props.isModal ? \"_modal\" : \"\"}`} />\n          <WithHoverSound>\n            <a href=\"https://hub.link\" target=\"_blank\" className={styles.hubLinkLink} rel=\"noopener noreferrer\">\n              hub.link\n            </a>\n          </WithHoverSound>\n          <FormattedMessage id=\"invite.and_enter_code\" />\n        </div>\n        <div className={styles.code}>\n          {entryCodeString.split(\"\").map((d, i) => (\n            <div className={classNames({ [styles.digit]: true, [styles[`digit_${i}`]]: true })} key={`link_code_${i}`}>\n              {d}\n            </div>\n          ))}\n        </div>\n        <div>\n          <FormattedMessage id={`invite.or_visit${this.props.isModal ? \"_modal\" : \"\"}`} />\n        </div>\n        <div className={styles.domain}>\n          <input type=\"text\" readOnly onFocus={e => e.target.select()} value={shortLinkText} />\n        </div>\n        <div className={styles.buttons}>\n          <WithHoverSound>\n            <button className={styles.linkButton} onClick={this.copyClicked.bind(this, shortLink)}>\n              <span>{this.state.copyButtonActive ? \"copied!\" : \"copy\"}</span>\n            </button>\n          </WithHoverSound>\n          {this.props.allowShare &&\n            canShare() && (\n              <WithHoverSound>\n                <button className={styles.linkButton} onClick={this.shareClicked.bind(this, shortLink)}>\n                  <span>{this.state.shareButtonActive ? \"sharing...\" : \"share\"}</span>\n                </button>\n              </WithHoverSound>\n            )}\n          {this.props.allowShare &&\n            !canShare() && (\n              <WithHoverSound>\n                <button className={styles.linkButton} onClick={this.shareClicked.bind(this, shortLink)}>\n                  <FormattedMessage id=\"invite.tweet\" />\n                </button>\n              </WithHoverSound>\n            )}\n        </div>\n        {embedUrl && (\n          <div className={styles.embed}>\n            <div>\n              <FormattedMessage id={`invite.embed`} />\n            </div>\n            <div className={styles.embedText}>\n              <input\n                type=\"text\"\n                readOnly\n                onFocus={e => {\n                  e.target.select();\n                  this.setState({ showEmbedTip: true });\n                }}\n                onBlur={() => this.setState({ showEmbedTip: false })}\n                value={embedText}\n              />\n            </div>\n            {this.state.showEmbedTip && (\n              <div className={styles.embedTipWrap}>\n                <div className={styles.embedTip}>\n                  <div className={styles.embedTipAttachPoint} />\n                  <FormattedMessage id=\"invite.embed-tip\" />\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n        {this.props.hasPush && (\n          <div className={styles.subscribe}>\n            <input\n              id=\"subscribe\"\n              type=\"checkbox\"\n              onChange={() => this.props.onSubscribeChanged()}\n              checked={this.props.isSubscribed}\n            />\n            <label htmlFor=\"subscribe\">\n              <FormattedMessage id=\"entry.notify_me\" />\n            </label>\n          </div>\n        )}\n\n        {this.props.isModal && (\n          <button className={styles.enterVrButton} onClick={() => this.props.onClose()}>\n            <FormattedMessage id=\"entry.return-to-vr\" />\n          </button>\n        )}\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport DialogContainer from \"./dialog-container.js\";\nimport PropTypes from \"prop-types\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nexport default class InviteTeamDialog extends Component {\n  static propTypes = {\n    hubChannel: PropTypes.object\n  };\n\n  state = {\n    inviteButtonText: \"invite a hubs team member\"\n  };\n\n  constructor(props) {\n    super(props);\n  }\n\n  inviteClicked = () => {\n    this.setState({ inviteButtonText: \"OK! We'll be there shortly.\" });\n    this.props.hubChannel.requestSupport();\n  };\n\n  render() {\n    return (\n      <DialogContainer title=\"Let's Chat!\" {...this.props}>\n        <div>\n          <div>\n            <p>Have an idea for Hubs? Having trouble?</p>\n            <p>We&apos;d love to chat. Someone from our team will join you in just a few minutes.</p>\n          </div>\n          <div className=\"invite-team-form\">\n            <div className=\"invite-team-form__buttons\">\n              <WithHoverSound>\n                <button className=\"invite-team-form__action-button\" onClick={this.inviteClicked}>\n                  <span>{this.state.inviteButtonText}</span>\n                </button>\n              </WithHoverSound>\n            </div>\n          </div>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { FormattedMessage } from \"react-intl\";\nimport LinkDialogHeader from \"../assets/images/link_dialog_header.svg\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nimport styles from \"../assets/stylesheets/link-dialog.scss\";\n\nexport default class LinkDialog extends Component {\n  static propTypes = {\n    linkCode: PropTypes.string,\n    onClose: PropTypes.func\n  };\n\n  render() {\n    const { linkCode } = this.props;\n\n    return (\n      <div className={styles.dialog}>\n        <WithHoverSound>\n          <div className={styles.close} onClick={() => this.props.onClose()}>\n            <span></span>\n          </div>\n        </WithHoverSound>\n        <div>\n          {!linkCode && (\n            <div>\n              <div className={classNames(\"loading-panel\", styles.codeLoadingPanel)}>\n                <div className=\"loader-wrap\">\n                  <div className=\"loader\">\n                    <div className=\"loader-center\" />\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n          {linkCode && (\n            <div className={styles.contents}>\n              <img className={styles.imageHeader} src={LinkDialogHeader} />\n              <div className={styles.header}>\n                <FormattedMessage id=\"link.connect_headset\" />\n              </div>\n              <div>\n                <FormattedMessage id=\"link.in_your_browser\" />\n              </div>\n              <WithHoverSound>\n                <a href=\"https://hub.link\" className={styles.domain} target=\"_blank\" rel=\"noopener noreferrer\">\n                  hub.link\n                </a>\n              </WithHoverSound>\n              <div>\n                <FormattedMessage id=\"link.enter_code\" />\n              </div>\n              {linkCode && (\n                <div className={styles.code}>\n                  {linkCode.split(\"\").map((d, i) => (\n                    <span className={styles.digit} key={`link_code_${i}`}>\n                      {d}\n                    </span>\n                  ))}\n                </div>\n              )}\n              <div className={styles.keepOpen}>\n                <FormattedMessage id=\"link.do_not_close\" />\n              </div>\n              <WithHoverSound>\n                <button className={styles.closeButton} onClick={() => this.props.onClose()}>\n                  <FormattedMessage id=\"link.cancel\" />\n                </button>\n              </WithHoverSound>\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport copy from \"copy-to-clipboard\";\nimport DialogContainer from \"./dialog-container.js\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nexport default class SafariDialog extends Component {\n  state = {\n    copyLinkButtonText: \"copy\"\n  };\n\n  copyLinkClicked = link => {\n    copy(link);\n    this.setState({ copyLinkButtonText: \"copied!\" });\n  };\n\n  render() {\n    const onCopyClicked = this.copyLinkClicked.bind(this, document.location);\n    return (\n      <DialogContainer title=\"Open in Safari\" {...this.props}>\n        <div>\n          <div>We do not currently support your current browser on iOS. Copy and paste this link directly in Safari.</div>\n          <div className=\"invite-form\">\n            <input\n              type=\"text\"\n              readOnly\n              onFocus={e => e.target.select()}\n              value={document.location}\n              className=\"invite-form__link_field\"\n            />\n            <div className=\"invite-form__buttons\">\n              <WithHoverSound>\n                <button className=\"invite-form__action-button\" onClick={onCopyClicked}>\n                  <span>{this.state.copyLinkButtonText}</span>\n                </button>\n              </WithHoverSound>\n            </div>\n          </div>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport DialogContainer from \"./dialog-container.js\";\n\nexport default class SafariMicDialog extends Component {\n  render() {\n    return (\n      <DialogContainer title=\"Microphone Access Required\" {...this.props}>\n        <div>\n          <div>\n            Hubs requires microphone permissions in Safari. <br />\n            Please reload and allow microphone access to continue.\n          </div>\n          <div className=\"invite-form\">\n            <div className=\"invite-form__buttons\">\n              <button className=\"invite-form__action-button\" onClick={() => location.reload()}>\n                Reload\n              </button>\n            </div>\n          </div>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport cx from \"classnames\";\nimport { FormattedMessage } from \"react-intl\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\n\nimport styles from \"../assets/stylesheets/room-settings-dialog.scss\";\nimport DialogContainer from \"./dialog-container\";\n\nexport default class RoomSettingsDialog extends Component {\n  static propTypes = {\n    initialSettings: PropTypes.object,\n    onChange: PropTypes.func,\n    onClose: PropTypes.func\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = props.initialSettings;\n  }\n\n  onSubmit = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    this.props.onChange(this.state);\n    this.props.onClose();\n  };\n\n  renderCheckbox(member_permission, disabled, onChange) {\n    return (\n      <label className={cx(styles.permission, { [styles.permissionDisabled]: disabled })} key={member_permission}>\n        <input\n          type=\"checkbox\"\n          checked={this.state.member_permissions[member_permission]}\n          disabled={disabled}\n          onChange={\n            onChange ||\n            (e =>\n              this.setState({\n                member_permissions: { ...this.state.member_permissions, [member_permission]: e.target.checked }\n              }))\n          }\n        />\n        <FormattedMessage id={`room-settings.${member_permission}`} />\n      </label>\n    );\n  }\n\n  render() {\n    return (\n      <DialogContainer title=\"Room Settings\" {...this.props}>\n        <form onSubmit={this.onSubmit} className={styles.roomSettingsForm}>\n          <span className={styles.subtitle}>\n            <FormattedMessage id=\"room-settings.name-subtitle\" />\n          </span>\n          <input\n            name=\"name\"\n            type=\"text\"\n            required\n            autoFocus\n            autoComplete=\"off\"\n            placeholder=\"Room name\"\n            value={this.state.name}\n            onFocus={e => handleTextFieldFocus(e.target)}\n            onBlur={() => handleTextFieldBlur()}\n            onChange={e => this.setState({ name: e.target.value })}\n            className={styles.nameField}\n          />\n          <span className={styles.subtitle}>\n            <FormattedMessage id=\"room-settings.permissions-subtitle\" />\n          </span>\n          <div className={styles.permissions}>\n            {this.renderCheckbox(\"spawn_and_move_media\", false, e => {\n              const newMemberPermissions = {\n                spawn_and_move_media: e.target.checked\n              };\n              if (!e.target.checked) {\n                newMemberPermissions.spawn_camera = false;\n                newMemberPermissions.pin_objects = false;\n              }\n              this.setState({ member_permissions: { ...this.state.member_permissions, ...newMemberPermissions } });\n            })}\n            <div className={styles.permissionsGroup}>\n              {this.renderCheckbox(\"spawn_camera\", !this.state.member_permissions.spawn_and_move_media)}\n              {this.renderCheckbox(\"pin_objects\", !this.state.member_permissions.spawn_and_move_media)}\n            </div>\n            {this.renderCheckbox(\"spawn_drawing\")}\n          </div>\n          <button type=\"submit\" className={styles.nextButton}>\n            <FormattedMessage id=\"room-settings.apply\" />\n          </button>\n        </form>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\n\nimport styles from \"../assets/stylesheets/close-room-dialog.scss\";\nimport DialogContainer from \"./dialog-container\";\n\nexport default class CloseRoomDialog extends Component {\n  static propTypes = {\n    onConfirm: PropTypes.func,\n    onClose: PropTypes.func\n  };\n\n  render() {\n    return (\n      <DialogContainer title=\"Close Room\" {...this.props}>\n        <div className={styles.message}>\n          <FormattedMessage id=\"close-room.message\" />\n        </div>\n        <button\n          className={styles.confirmButton}\n          onClick={() => {\n            this.props.onConfirm();\n            this.props.onClose();\n          }}\n        >\n          <FormattedMessage id=\"close-room.confirm\" />\n        </button>\n        <button className={styles.cancelButton} onClick={() => this.props.onClose()}>\n          <FormattedMessage id=\"close-room.cancel\" />\n        </button>\n      </DialogContainer>\n    );\n  }\n}\n","import { sets } from \"./userinput/sets\";\nimport { paths } from \"./userinput/paths\";\n\n// The output of this system is activeTips which shows, if any, the tips to show at the top\n// and bottom of the screen. There are named tips (eg locomotion) that each have validators.\n//\n// Each frame we run all the non-finished validators and take the first tip (by order)\n// which is VALID. Any tip that returns FINISHED will no longer be considered without\n// a local storage reset.\n\n// Validators can return these values:\n//\n// INVALID - Tip is not valid to show\n// VALID - Tip is valid to show\n// FINISH - Tip should always be assumed INVALID going forward\n//\n//\n// Tips have \"scope\", which is a certain context within which the validators are run (right now,\n// just the top of bottom of the screen.) They are also platform-local.\nconst INVALID = 0;\nconst VALID = 1;\nconst FINISH = 2;\n\nconst LOCAL_STORAGE_KEY = \"__hubs_finished_tips\";\nconst NUM_ENTRIES_FOR_FEEDBACK_TIP = 3;\n\nconst TIPS = {\n  desktop: {\n    top: [\"pen_mode\", \"video_share_mode\", \"mute_mode\"],\n    bottom: [\n      \"look\",\n      \"locomotion\",\n      \"turning\",\n      \"spawn_menu\",\n      \"object_grab\",\n      \"object_zoom\",\n      \"object_scale\",\n      \"freeze_gesture\",\n      \"menu_hover\",\n      \"object_recenter_button\",\n      \"object_rotate_button\",\n      \"object_scale_button\",\n      \"object_pin\",\n      \"invite\",\n      \"pen_color\",\n      \"pen_size\",\n      \"feedback\"\n    ]\n  },\n  mobile: {\n    top: [\"pen_mode\", \"video_share_mode\", \"freeze_mode\", \"mute_mode\"],\n    bottom: [\n      \"look\",\n      \"locomotion\",\n      \"spawn_menu\",\n      \"object_grab\",\n      \"freeze_gesture\",\n      \"object_recenter_button\",\n      \"object_rotate_button\",\n      \"object_scale_button\",\n      \"object_pin\",\n      \"invite\",\n      \"feedback\"\n    ]\n  },\n  standalone: { top: [], bottom: [] }\n};\n\n// These tips, if closed, will only clear themselves, not all tips.\nconst LOCAL_CLOSE_TIPS = [\"feedback\", \"invite\", \"object_pin\"];\n\n// These tips will remain active even if the user closes the tips globally.\nconst KEEP_ACTIVE_AFTER_GLOBAL_CLOSE = [\"feedback\"];\n\nlet localStorageCache = null;\nlet finishedScopes = {}; // Optimization, lets system skip scopes altogether once finished.\n\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\n\nconst tipPlatform = () => {\n  if (isMobileVR) return \"standalone\";\n  return isMobile ? \"mobile\" : \"desktop\";\n};\n\nconst platformTips = TIPS[tipPlatform()];\n\nconst isTipFinished = tip => {\n  if (localStorageCache === null) {\n    localStorageCache = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY));\n  }\n\n  return !!(localStorageCache[tip] && localStorageCache[tip].finished);\n};\n\nexport const markTipFinished = tip => {\n  const storeData = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY));\n  storeData[tip] = { finished: true };\n  localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(storeData));\n  localStorageCache = null;\n};\n\nexport const handleTipClose = (fullTip, scope) => {\n  const tip = fullTip.split(\".\")[1];\n\n  // Invite and pinning tips should be locally cleared, others should clear all remaining tips.\n  const tips = LOCAL_CLOSE_TIPS.includes(tip) ? [tip] : platformTips[scope];\n\n  for (let i = 0; i < tips.length; i++) {\n    const t = tips[i];\n\n    if (!KEEP_ACTIVE_AFTER_GLOBAL_CLOSE.includes(t) || t === tip) {\n      markTipFinished(t);\n    }\n  }\n};\n\nexport const resetTips = () => {\n  localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify({}));\n  localStorageCache = null;\n  window.APP.store.resetTipActivityFlags();\n  window.APP.store.resetConfirmedBroadcastedRooms();\n  finishedScopes = {};\n};\n\nconst VALIDATORS = {\n  look: function(userinput) {\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    const cameraDelta = userinput.get(\n      isMobile ? paths.device.touchscreen.touchCameraDelta : paths.device.smartMouse.cameraDelta\n    );\n    return cameraDelta ? FINISH : VALID;\n  },\n  locomotion: function(userinput) {\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    const accel = userinput.get(paths.actions.characterAcceleration);\n\n    // User moved\n    return accel && (accel[0] !== 0 || accel[1] !== 0) ? FINISH : VALID;\n  },\n  turning: function(userinput) {\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (userinput.get(paths.actions.snapRotateLeft) || userinput.get(paths.actions.snapRotateRight)) return FINISH;\n    return VALID;\n  },\n  spawn_menu: function(userinput, scene, mediaCounter) {\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (mediaCounter.count() === 0) return VALID;\n    return FINISH;\n  },\n  freeze_gesture: function(userinput, scene, mediaCounter) {\n    if (mediaCounter.count() === 0) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingInteractable)) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (scene.is(\"frozen\") && userinput.activeSets.includes(sets.cursorHoveringOnInteractable)) return FINISH;\n    return scene.is(\"frozen\") ? INVALID : VALID;\n  },\n  menu_hover: function(userinput, scene, mediaCounter) {\n    if (mediaCounter.count() === 0) return INVALID;\n    if (!scene.is(\"frozen\")) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (scene.is(\"frozen\") && userinput.activeSets.includes(sets.cursorHoveringOnInteractable)) return FINISH;\n    return VALID;\n  },\n  invite: function(userinput, scene) {\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingCamera)) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingInteractable)) return INVALID;\n    return scene.is(\"copresent\") ? FINISH : VALID;\n  },\n  object_grab: function(userinput, scene, mediaCounter) {\n    if (scene.is(\"frozen\")) return INVALID;\n    if (mediaCounter.count() === 0) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingCamera)) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingInteractable)) return FINISH;\n    return VALID;\n  },\n  object_rotate_button: function(userinput, scene, mediaCounter, store) {\n    if (!scene.is(\"frozen\")) return INVALID;\n    if (mediaCounter.count() === 0) return INVALID;\n    if (store && store.state.activity.hasRotated) return FINISH;\n    return VALID;\n  },\n  object_scale_button: function(userinput, scene, mediaCounter, store) {\n    if (!scene.is(\"frozen\")) return INVALID;\n    if (mediaCounter.count() === 0) return INVALID;\n    if (store && store.state.activity.hasScaled) return FINISH;\n    return VALID;\n  },\n  object_recenter_button: function(userinput, scene, mediaCounter, store) {\n    if (!scene.is(\"frozen\")) return INVALID;\n    if (mediaCounter.count() === 0) return INVALID;\n    if (store && store.state.activity.hasRecentered) return FINISH;\n    return VALID;\n  },\n  object_pin: function(userinput, scene, mediaCounter, store) {\n    if (!scene.is(\"frozen\")) return INVALID;\n    if (mediaCounter.count() === 0) return INVALID;\n    if (store && store.state.activity.hasPinned) return FINISH;\n    return VALID;\n  },\n  object_zoom: function(userinput, scene) {\n    if (scene.is(\"frozen\")) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingCamera)) return INVALID;\n    if (!userinput.activeSets.includes(sets.cursorHoldingInteractable)) return INVALID;\n    if (userinput.get(paths.actions.cursor.modDelta)) return FINISH;\n    return VALID;\n  },\n  object_scale: function(userinput, scene) {\n    if (scene.is(\"frozen\")) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingCamera)) return INVALID;\n    if (!userinput.activeSets.includes(sets.cursorHoldingInteractable)) return INVALID;\n    if (userinput.get(paths.actions.cursor.scaleGrabbedGrabbable)) return FINISH;\n    return VALID;\n  },\n  pen_color: function(userinput) {\n    if (!userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (userinput.get(paths.actions.cursor.penNextColor) || userinput.get(paths.actions.cursor.penPrevColor)) {\n      return FINISH;\n    }\n    return VALID;\n  },\n  pen_size: function(userinput) {\n    if (!userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (userinput.get(paths.actions.cursor.scalePenTip)) return FINISH;\n    return VALID;\n  },\n  pen_mode: function(userinput) {\n    if (!userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    return VALID;\n  },\n  freeze_mode: function(userinput, scene) {\n    return scene.is(\"frozen\") ? VALID : INVALID;\n  },\n  video_share_mode: function(userinput, scene) {\n    return scene.is(\"sharing_video\") ? VALID : INVALID;\n  },\n  mute_mode: function(userinput, scene) {\n    return scene.is(\"muted\") ? VALID : INVALID;\n  },\n  feedback: function(userinput, scene, mediaCounter, store) {\n    if (store && store.state.activity.entryCount >= NUM_ENTRIES_FOR_FEEDBACK_TIP) return VALID;\n    return INVALID;\n  }\n};\n\nAFRAME.registerSystem(\"tips\", {\n  init: function() {\n    this.activeTips = {};\n    this._finishedScopes = {};\n    this._performStep = this._performStep.bind(this);\n\n    if (localStorage.getItem(LOCAL_STORAGE_KEY) === null) {\n      localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify({}));\n    }\n  },\n\n  tick: function() {\n    if (isMobileVR) return; // Optimization for now, don't bother with this on mobile VR until we have real tips\n\n    if (!this._userinput) {\n      this._userinput = this.el.systems.userinput;\n\n      if (!this._userinput) return;\n    }\n\n    if (!this._mediaCounter) {\n      this._mediaCounter =\n        document.querySelector(\"#media-counter\") &&\n        document.querySelector(\"#media-counter\").components[\"networked-counter\"];\n\n      if (!this._mediaCounter) return;\n    }\n\n    const tips = platformTips;\n\n    const prevTop = this.activeTips.top;\n    const prevBottom = this.activeTips.bottom;\n\n    this._performStep(tips.top, \"top\");\n    this._performStep(tips.bottom, \"bottom\");\n\n    if (prevTop !== this.activeTips.top || prevBottom !== this.activeTips.bottom) {\n      this.el.emit(\"tips_changed\", this.activeTips);\n    }\n  },\n\n  _performStep: function(tips, scope) {\n    if (finishedScopes[scope]) return;\n\n    let chosenTip = null;\n    let finishCount = 0;\n\n    for (let i = 0; i < tips.length; i++) {\n      const tip = tips[i];\n      if (isTipFinished(tip)) {\n        finishCount++;\n        continue;\n      }\n\n      switch (VALIDATORS[tip](this._userinput, this.el, this._mediaCounter, window.APP.store)) {\n        case FINISH:\n          markTipFinished(tip);\n          break;\n        case VALID:\n          chosenTip = `${tipPlatform()}.${tip}`;\n          break;\n      }\n\n      if (chosenTip) break;\n    }\n\n    this.activeTips[scope] = chosenTip;\n\n    if (finishCount === tips.length) {\n      // Optimization: Tips are completed for this scope, no need to re-walk.\n      finishedScopes[scope] = true;\n    }\n  }\n});\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\nimport classNames from \"classnames\";\nimport styles from \"../assets/stylesheets/tip.scss\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport { handleTipClose } from \"../systems/tips.js\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nexport default class Tip extends Component {\n  static propTypes = {\n    history: PropTypes.object,\n    tip: PropTypes.string,\n    tipRegion: PropTypes.string,\n    broadcastTarget: PropTypes.string,\n    pushHistoryState: PropTypes.func,\n    onClose: PropTypes.func\n  };\n\n  render() {\n    const { tip, tipRegion, broadcastTarget, pushHistoryState } = this.props;\n    let tipBody;\n\n    if ([\".spawn_menu\", \"_button\"].find(x => tip.endsWith(x))) {\n      tipBody = (\n        <div className={styles.splitTip}>\n          <FormattedMessage id={`tips.${tip}-pre`} />\n          <div\n            className={classNames({\n              [styles.splitTipIcon]: true,\n              [styles[tip.split(\".\")[1] + \"-icon\"]]: true\n            })}\n          />\n          <FormattedMessage id={`tips.${tip}-post`} />\n        </div>\n      );\n    } else if (tip === \"discord\") {\n      tipBody = (\n        <div className={styles.tip}>\n          <span>{`Chat in this room is being bridged to ${broadcastTarget} on Discord.`}</span>\n        </div>\n      );\n    } else if (tip === \"embed\") {\n      tipBody = (\n        <div className={styles.tip}>\n          <FormattedMessage id=\"embed.presence-warning\" />\n        </div>\n      );\n    } else if (tip.endsWith(\".feedback\")) {\n      tipBody = (\n        <div className={styles.tip}>\n          <FormattedMessage id={`tips.${tip}`} />\n          &nbsp;\n          <button\n            className={styles.tipLink}\n            onClick={() => {\n              handleTipClose(tip, tipRegion);\n              pushHistoryState(\"modal\", \"feedback\");\n            }}\n          >\n            <FormattedMessage id={`tips.${tip}-link`} />\n          </button>\n        </div>\n      );\n    } else {\n      tipBody = (\n        <div className={styles.tip}>\n          <FormattedMessage id={`tips.${tip}`} />\n        </div>\n      );\n    }\n\n    return (\n      <div className={styles.tipRoot}>\n        <button\n          className={styles.tipCancel}\n          onClick={() => (this.props.onClose ? this.props.onClose(tip, tipRegion) : handleTipClose(tip, tipRegion))}\n        >\n          <i>\n            <FontAwesomeIcon icon={faTimes} />\n          </i>\n        </button>\n        {tipBody}\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport DialogContainer from \"./dialog-container.js\";\n\nexport default class WebRTCScreenshareUnsupportedDialog extends Component {\n  render() {\n    return (\n      <DialogContainer title=\"Share Screen\" {...this.props}>\n        <div style={{ display: \"flex\", flexDirection: \"column\", alignItems: \"center\" }}>\n          <p>\n            Your browser doesn&apos;t seem to support screen sharing.\n            <br />\n            To share your screen in Hubs, you can use Firefox.\n          </p>\n          <a\n            className=\"info-dialog--action-button\"\n            target=\"_blank\"\n            rel=\"noreferrer noopener\"\n            href=\"https://www.mozilla.org/firefox\"\n          >\n            Download Firefox\n          </a>\n          <p style={{ fontSize: \"0.8em\" }}>\n            You can try&nbsp;\n            <a\n              href=\"https://www.webrtc-experiment.com/screen-sharing/#5591174797993739\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n            >\n              testing WebRTC screen sharing\n            </a>&nbsp;in your browser.\n          </p>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport DialogContainer from \"./dialog-container.js\";\n\nexport default class WebAssemblyUnsupportedDialog extends Component {\n  render() {\n    return (\n      <DialogContainer title=\"WebAssembly Unsupported\" {...this.props}>\n        <div style={{ display: \"flex\", flexDirection: \"column\", alignItems: \"center\" }}>\n          <p>\n            Your browser doesn&apos;t seem to support WebAssembly.\n            <br />\n            Please update or switch to a newer browser.\n          </p>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport DialogContainer from \"./dialog-container.js\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nexport default class WebVRRecommendDialog extends Component {\n  render() {\n    return (\n      <DialogContainer title=\"Enter in VR\" {...this.props}>\n        <div style={{ display: \"flex\", flexDirection: \"column\", alignItems: \"center\" }}>\n          <p>To enter with Oculus or SteamVR, you can use Firefox.</p>\n          <WithHoverSound>\n            <a\n              className=\"info-dialog--action-button\"\n              href=\"https://www.mozilla.org/firefox\"\n              target=\"_blank\"\n              rel=\"noreferrer noopener\"\n            >\n              Download Firefox\n            </a>\n          </WithHoverSound>\n          <p style={{ fontSize: \"0.8em\" }}>\n            For a list of browsers with experimental VR support, visit{\" \"}\n            <WithHoverSound>\n              <a href=\"https://webvr.rocks\" target=\"_blank\" rel=\"noopener noreferrer\">\n                WebVR Rocks\n              </a>\n            </WithHoverSound>\n          </p>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport DialogContainer from \"./dialog-container.js\";\nimport styles from \"../assets/stylesheets/feedback-dialog.scss\";\n\nexport default class FeedbackDialog extends Component {\n  render() {\n    return (\n      <DialogContainer wide={true} title=\"\" {...this.props}>\n        <iframe\n          className={styles.formFrame}\n          src=\"https://docs.google.com/forms/d/e/1FAIpQLSe1C-7hCA1XMT8IL8XBnjlxMAU1JXrwAW8YkbmbBJ4B3pDSsw/viewform?embedded=true\"\n          frameBorder=\"0\"\n          marginHeight=\"0\"\n          marginWidth=\"0\"\n        >\n          Loading...\n        </iframe>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport DialogContainer from \"./dialog-container.js\";\nimport styles from \"../assets/stylesheets/leave-room-dialog.scss\";\nimport { FormattedMessage } from \"react-intl\";\nimport PropTypes from \"prop-types\";\n\nexport default class LeaveRoomDialog extends Component {\n  static propTypes = {\n    messageType: PropTypes.string,\n    destinationUrl: PropTypes.string\n  };\n\n  render() {\n    return (\n      <DialogContainer title=\"Leave Room\" {...this.props}>\n        <div className={styles.leaveRoom}>\n          <div>\n            <FormattedMessage id={`leave-room-dialog.${this.props.messageType}.message`} />\n          </div>\n          <a href={this.props.destinationUrl} rel=\"noopener noreferrer\">\n            <FormattedMessage id={`leave-room-dialog.${this.props.messageType}.confirm`} />\n          </a>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport DialogContainer from \"./dialog-container.js\";\nimport styles from \"../assets/stylesheets/room-info-dialog.scss\";\nimport { scaledThumbnailUrlFor } from \"../utils/media-url-utils\";\n\nexport default class RoomInfoDialog extends Component {\n  static propTypes = {\n    hubName: PropTypes.string,\n    scene: PropTypes.object\n  };\n\n  render() {\n    const toAttributionDiv = (a, i) => {\n      if (a.url) {\n        const source = a.url.includes(\"sketchfab.com\")\n          ? \"on Sketchfab\"\n          : a.url.includes(\"poly.google.com\")\n            ? \"on Google Poly\"\n            : \"\";\n\n        return (\n          <div className={styles.attribution} key={`${a.url} ${i}`}>\n            <div className={styles.attributionName}>\n              <a href={a.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                {a.name}\n              </a>\n            </div>\n            <div className={styles.attributionAuthor}>\n              by {a.author} {source}\n            </div>\n          </div>\n        );\n      } else {\n        return (\n          <div className={styles.attribution} key={`${a.name} ${a.author} {i}`}>\n            <div className={styles.attributionName}>{a.name}</div>\n            <div className={styles.attributionAuthor}>by {a.author}</div>\n          </div>\n        );\n      }\n    };\n\n    let attributions = null;\n    let creator = null;\n\n    if (this.props.scene.attributions) {\n      creator = this.props.scene.attributions.creator;\n      attributions = (\n        <div>\n          {this.props.scene.attributions.content && this.props.scene.attributions.content.map(toAttributionDiv)}\n        </div>\n      );\n    }\n\n    const title = <div className={styles.title}>{this.props.hubName}</div>;\n\n    return (\n      <DialogContainer title={title} wide={true} {...this.props}>\n        <div className={styles.roomInfo}>\n          <div className={styles.sceneScreenshot}>\n            <a href={this.props.scene.url} target=\"_blank\" rel=\"noopener noreferrer\">\n              <img src={scaledThumbnailUrlFor(this.props.scene.screenshot_url, 400, 480)} />\n            </a>\n          </div>\n          <div className={styles.sceneDetails}>\n            <div className={styles.sceneMain}>\n              <div className={styles.sceneName}>\n                <a href={this.props.scene.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                  {this.props.scene.name}\n                </a>\n              </div>\n              <div className={styles.sceneCreator}>{creator}</div>\n            </div>\n            <div className={styles.sceneAttributions}>{attributions}</div>\n            <div className={styles.sceneButtons}> </div>\n          </div>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport DialogContainer from \"./dialog-container.js\";\nimport { FormattedMessage } from \"react-intl\";\nimport styles from \"../assets/stylesheets/oauth-dialog.scss\";\nimport classNames from \"classnames\";\n\nexport default class OAuthDialog extends Component {\n  static propTypes = {\n    oauthInfo: PropTypes.array\n  };\n  renderSignInDisclaimer(type) {\n    return (\n      <div>\n        <div>\n          You&apos;ll need to sign in to <span className={styles.oauthTypeName}>{type}</span> to access this room.\n        </div>\n        <br />\n        <div>We&apos;ll ask for access to your e-mail address so you can skip signing in next time.</div>\n        <p className={styles.privacyNotice}>\n          By proceeding, you agree to the{\" \"}\n          <a rel=\"noopener noreferrer\" target=\"_blank\" href={this.props.termsLink || \"https://github.com/mozilla/hubs/blob/master/TERMS.md\"}>\n            terms of use\n          </a>{\" \"}\n          and{\" \"}\n          <a rel=\"noopener noreferrer\" target=\"_blank\" href={this.props.privacyLink || \"https://github.com/mozilla/hubs/blob/master/PRIVACY.md\"}>\n            privacy notice\n          </a>.\n        </p>\n      </div>\n    );\n  }\n\n  renderTweetDisclaimer() {\n    return (\n      <div className={styles.twitterMessage}>\n        <FormattedMessage id=\"oauth-dialog.message.twitter\" />\n      </div>\n    );\n  }\n\n  render() {\n    const info = this.props.oauthInfo && this.props.oauthInfo[0];\n    const closable = info && info.type === \"twitter\"; // NOTE: for now, allow closing dialog if doing Twitter sign in (currently just for sharing)\n\n    return (\n      <DialogContainer title=\"\" closable={closable} {...this.props}>\n        <div>\n          {info && (info.type === \"twitter\" ? this.renderTweetDisclaimer() : this.renderSignInDisclaimer(info.type))}\n          <div className=\"invite-form\">\n            <div className={`invite-form__buttons ${styles.oauthButtons}`}>\n              {info ? (\n                <a\n                  href={info.url}\n                  key={info.type}\n                  className={classNames({\n                    [styles.oauthButton]: true,\n                    [styles.oauthTwitterButton]: info.type === \"twitter\",\n                    [styles.oauthDiscordButton]: info.type === \"discord\"\n                  })}\n                >\n                  <FormattedMessage id={`oauth-dialog.sign-in.${info.type}`} />\n                </a>\n              ) : (\n                <div className=\"loader-wrap loader-mid\">\n                  <div className=\"loader\">\n                    <div className=\"loader-center\" />\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport DialogContainer from \"./dialog-container.js\";\nimport styles from \"../assets/stylesheets/tweet-dialog.scss\";\nimport Editor, { createEditorStateWithText } from \"draft-js-plugins-editor\";\nimport { FormattedMessage } from \"react-intl\";\nimport { fetchReticulumAuthenticated } from \"../utils/phoenix-utils\";\nimport createEmojiPlugin from \"draft-js-emoji-plugin\";\nimport createHashtagPlugin from \"draft-js-hashtag-plugin\";\nimport createLinkifyPlugin from \"draft-js-linkify-plugin\";\nimport createCounterPlugin from \"draft-js-counter-plugin\";\nimport classNames from \"classnames\";\nimport { scaledThumbnailUrlFor } from \"../utils/media-url-utils\";\nimport { Modifier, EditorState } from \"draft-js\";\nimport \"draft-js-emoji-plugin/lib/plugin.css\";\nimport \"draft-js-hashtag-plugin/lib/plugin.css\";\nimport \"draft-js-linkify-plugin/lib/plugin.css\";\nimport \"draft-js-counter-plugin/lib/plugin.css\";\n\nconst emojiPlugin = createEmojiPlugin();\nconst hashtagPlugin = createHashtagPlugin();\nconst linkifyPlugin = createLinkifyPlugin();\nconst counterPlugin = createCounterPlugin();\n\n// Taken from draft-js-emoji\nconst addEmoji = (emoji, editorState) => {\n  const contentState = editorState.getCurrentContent();\n  const contentStateWithEntity = contentState.createEntity(\"emoji\", \"IMMUTABLE\", { emojiUnicode: emoji });\n  const entityKey = contentStateWithEntity.getLastCreatedEntityKey();\n  const currentSelectionState = editorState.getSelection();\n\n  let emojiAddedContent;\n  let emojiEndPos = 0;\n  let blockSize = 0;\n\n  // in case text is selected it is removed and then the emoji is added\n  const afterRemovalContentState = Modifier.removeRange(contentState, currentSelectionState, \"backward\");\n\n  // deciding on the position to insert emoji\n  const targetSelection = afterRemovalContentState.getSelectionAfter();\n\n  emojiAddedContent = Modifier.insertText(afterRemovalContentState, targetSelection, emoji, null, entityKey);\n\n  emojiEndPos = targetSelection.getAnchorOffset();\n  const blockKey = targetSelection.getAnchorKey();\n  blockSize = contentState.getBlockForKey(blockKey).getLength();\n\n  // If the emoji is inserted at the end, a space is appended right after for\n  // a smooth writing experience.\n  if (emojiEndPos === blockSize) {\n    emojiAddedContent = Modifier.insertText(emojiAddedContent, emojiAddedContent.getSelectionAfter(), \" \");\n  }\n\n  const newEditorState = EditorState.push(editorState, emojiAddedContent, \"insert-emoji\");\n  return EditorState.forceSelection(newEditorState, emojiAddedContent.getSelectionAfter());\n};\n\nexport default class TweetDialog extends Component {\n  static propTypes = {\n    history: PropTypes.object,\n    onClose: PropTypes.func\n  };\n\n  constructor(props) {\n    super();\n\n    this.state = {\n      editorState: createEditorStateWithText(props.history.location.state.detail.text || \"\"),\n      suggestions: []\n    };\n  }\n\n  componentDidMount() {\n    // Calling this immediately seems to break editor initialization\n    setTimeout(() => {\n      this.editorRef.focus();\n\n      // Other attempts at doing this resulted in no visible cursor or weird editor behavior:\n      this.setState({ editorState: addEmoji(\"\", this.state.editorState) });\n    });\n  }\n\n  async sendTweet() {\n    // For now assume url is a stored file media url\n    const media_stored_file_url = this.props.history.location.state.detail.url;\n    const body = this.state.editorState.getCurrentContent().getPlainText();\n\n    const payload = { media_stored_file_url, body };\n    this.setState({ posting: true });\n    await fetchReticulumAuthenticated(\"/api/v1/twitter/tweets\", \"POST\", payload);\n    this.setState({ posting: false, posted: true });\n  }\n\n  renderPostedDialog() {\n    return (\n      <DialogContainer wide={true} allowOverflow={true} closable={false} title=\"\" {...this.props}>\n        <div className={styles.posted}>\n          <div className={styles.message}>\n            <FormattedMessage id=\"tweet-dialog.posted\" />\n          </div>\n\n          <div className={styles.buttons}>\n            <button className={styles.tweetButton} onClick={() => this.props.onClose()}>\n              <FormattedMessage id=\"tweet-dialog.close\" />\n            </button>\n          </div>\n        </div>\n      </DialogContainer>\n    );\n  }\n\n  renderTweetDialog() {\n    const { EmojiSuggestions, EmojiSelect } = emojiPlugin;\n    const { CharCounter } = counterPlugin;\n    const { url, contentSubtype } = this.props.history.location.state.detail;\n\n    return (\n      <DialogContainer\n        wide={true}\n        allowOverflow={true}\n        title=\"\"\n        additionalClass={styles.dialogBackground}\n        {...this.props}\n      >\n        <div className={styles.tweet}>\n          <div className={styles.editor} onClick={() => this.editorRef.focus()}>\n            <div className={styles.editorInner}>\n              <Editor\n                ref={r => (this.editorRef = r)}\n                editorState={this.state.editorState}\n                onChange={editorState => this.setState({ editorState })}\n                plugins={[emojiPlugin, hashtagPlugin, linkifyPlugin, counterPlugin]}\n              />\n            </div>\n\n            <div className={styles.emojiButton}>\n              <EmojiSelect />\n            </div>\n\n            <div className={styles.emojiSuggestions}>\n              <EmojiSuggestions />\n            </div>\n\n            {this.state.editorState.getCurrentContent().getPlainText().length > 200 && (\n              <div className={styles.counter}>\n                <CharCounter editorState={this.state.editorState} limit={280} /> / 280\n              </div>\n            )}\n\n            <div className={styles.media}>\n              {contentSubtype && contentSubtype.startsWith(\"video\") ? (\n                <video src={url} width={450} height={255} controls />\n              ) : (\n                <img src={scaledThumbnailUrlFor(url, 450, 255)} />\n              )}\n            </div>\n          </div>\n\n          {!this.state.posting ? (\n            <div className={styles.buttons}>\n              <button\n                className={styles.tweetButton}\n                onClick={() => this.sendTweet()}\n                disabled={this.state.editorState.getCurrentContent().getPlainText().length > 280}\n              >\n                <FormattedMessage id=\"tweet-dialog.tweet\" />\n              </button>\n            </div>\n          ) : (\n            <div className={classNames([\"loader-wrap\", \"loader-mid\", styles.tweetLoader])}>\n              <div className=\"loader\">\n                <div className=\"loader-center\" />\n              </div>\n            </div>\n          )}\n        </div>\n      </DialogContainer>\n    );\n  }\n\n  render() {\n    if (this.state.posted) {\n      return this.renderPostedDialog();\n    } else {\n      return this.renderTweetDialog();\n    }\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"../assets/stylesheets/message-entry.scss\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\nimport { faPaperPlane } from \"@fortawesome/free-solid-svg-icons/faPaperPlane\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nclass LobbyChatBox extends Component {\n  static propTypes = {\n    discordBridges: PropTypes.array,\n    occupantCount: PropTypes.number,\n    onSendMessage: PropTypes.func\n  };\n\n  state = {\n    pendingMessage: \"\"\n  };\n\n  sendMessage = e => {\n    e.preventDefault();\n    if (this.props.onSendMessage) {\n      this.props.onSendMessage(this.state.pendingMessage);\n    }\n    this.setState({ pendingMessage: \"\" });\n  };\n\n  render() {\n    const textRows = this.state.pendingMessage.split(\"\\n\").length;\n    const pendingMessageTextareaHeight = textRows * 28 + \"px\";\n    const pendingMessageFieldHeight = textRows * 28 + 20 + \"px\";\n    const discordSnippet = this.props.discordBridges.map(ch => \"#\" + ch).join(\", \");\n    const occupantSnippet = `${this.props.occupantCount - 1} other${this.props.occupantCount > 2 ? \"s\" : \"\"}`;\n    const messageEntryPlaceholder =\n      this.props.occupantCount <= 1\n        ? \"Nobody is here yet...\"\n        : this.props.discordBridges.length\n          ? `Send message to ${occupantSnippet} and ${discordSnippet}...`\n          : `Send message to ${occupantSnippet}...`;\n\n    return (\n      <form onSubmit={this.sendMessage}>\n        <div\n          className={classNames({\n            [styles.messageEntry]: true,\n            [styles.messageEntryDisabled]: this.props.occupantCount <= 1\n          })}\n          style={{ height: pendingMessageFieldHeight }}\n        >\n          <textarea\n            className={classNames([styles.messageEntryInput, \"chat-focus-target\"])}\n            value={this.state.pendingMessage}\n            rows={textRows}\n            style={{ height: pendingMessageTextareaHeight }}\n            onFocus={e => handleTextFieldFocus(e.target)}\n            onBlur={() => handleTextFieldBlur()}\n            onChange={e => this.setState({ pendingMessage: e.target.value })}\n            disabled={this.props.occupantCount <= 1 ? true : false}\n            onKeyDown={e => {\n              if (e.key === \"Enter\" && !e.shiftKey) {\n                this.sendMessage(e);\n              } else if (e.key === \"Escape\") {\n                e.target.blur();\n              }\n            }}\n            placeholder={messageEntryPlaceholder}\n          />\n          <WithHoverSound>\n            <button\n              className={classNames([styles.messageEntryButton, styles.messageEntrySubmit])}\n              disabled={this.props.occupantCount <= 1 ? true : false}\n              type=\"submit\"\n            >\n              <i>\n                <FontAwesomeIcon icon={faPaperPlane} />\n              </i>\n            </button>\n          </WithHoverSound>\n        </div>\n      </form>\n    );\n  }\n}\n\nexport default LobbyChatBox;\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"../assets/stylesheets/chat-command-help.scss\";\nimport classNames from \"classnames\";\nimport { FormattedMessage } from \"react-intl\";\nimport qsTruthy from \"../utils/qs_truthy\";\n\nexport default class ChatCommandHelp extends Component {\n  static propTypes = {\n    matchingPrefix: PropTypes.string,\n    onTop: PropTypes.bool\n  };\n\n  render() {\n    const commands = [\n      \"leave\",\n      \"fly\",\n      \"grow\",\n      \"shrink\",\n      \"duck\",\n      \"debug\",\n      \"vrstats\",\n      \"scene <scene url>\",\n      \"rename <new name>\"\n    ];\n\n    if (qsTruthy(\"video_capture\")) {\n      commands.push(\"capture [stop]\");\n    }\n\n    return (\n      <div className={classNames({ [styles.commandHelp]: true, [styles.commandHelpOnTop]: this.props.onTop })}>\n        {commands.map(\n          c =>\n            (this.props.matchingPrefix === \"\" ||\n              c.split(\" \")[0].startsWith(this.props.matchingPrefix.split(\" \")[0])) && (\n              <div className={styles.entry} key={c}>\n                <div className={styles.command}>/{c}</div>\n                <div>\n                  <FormattedMessage id={`commands.${c.split(\" \")[0]}`} />\n                </div>\n              </div>\n            )\n        )}\n      </div>\n    );\n  }\n}\n","// https://stackoverflow.com/questions/6209161/extract-the-current-dom-and-print-it-as-a-string-with-styles-intact\n//\n// Mapping between tag names and css default values lookup tables. This allows to exclude default values in the result.\nconst defaultStylesByTagName = {};\n\n// Styles inherited from style sheets will not be rendered for elements with these tag names\nconst noStyleTags = {\n  BASE: true,\n  HEAD: true,\n  HTML: true,\n  META: true,\n  NOFRAME: true,\n  NOSCRIPT: true,\n  PARAM: true,\n  SCRIPT: true,\n  STYLE: true,\n  TITLE: true\n};\n\n// This list determines which css default values lookup tables are precomputed at load time\n// Lookup tables for other tag names will be automatically built at runtime if needed\nconst tagNames = [\n  \"A\",\n  \"ABBR\",\n  \"ADDRESS\",\n  \"AREA\",\n  \"ARTICLE\",\n  \"ASIDE\",\n  \"AUDIO\",\n  \"B\",\n  \"BASE\",\n  \"BDI\",\n  \"BDO\",\n  \"BLOCKQUOTE\",\n  \"BODY\",\n  \"BR\",\n  \"BUTTON\",\n  \"CANVAS\",\n  \"CAPTION\",\n  \"CENTER\",\n  \"CITE\",\n  \"CODE\",\n  \"COL\",\n  \"COLGROUP\",\n  \"COMMAND\",\n  \"DATALIST\",\n  \"DD\",\n  \"DEL\",\n  \"DETAILS\",\n  \"DFN\",\n  \"DIV\",\n  \"DL\",\n  \"DT\",\n  \"EM\",\n  \"EMBED\",\n  \"FIELDSET\",\n  \"FIGCAPTION\",\n  \"FIGURE\",\n  \"FONT\",\n  \"FOOTER\",\n  \"FORM\",\n  \"H1\",\n  \"H2\",\n  \"H3\",\n  \"H4\",\n  \"H5\",\n  \"H6\",\n  \"HEAD\",\n  \"HEADER\",\n  \"HGROUP\",\n  \"HR\",\n  \"HTML\",\n  \"I\",\n  \"IFRAME\",\n  \"IMG\",\n  \"INPUT\",\n  \"INS\",\n  \"KBD\",\n  \"KEYGEN\",\n  \"LABEL\",\n  \"LEGEND\",\n  \"LI\",\n  \"LINK\",\n  \"MAP\",\n  \"MARK\",\n  \"MATH\",\n  \"MENU\",\n  \"META\",\n  \"METER\",\n  \"NAV\",\n  \"NOBR\",\n  \"NOSCRIPT\",\n  \"OBJECT\",\n  \"OL\",\n  \"OPTION\",\n  \"OPTGROUP\",\n  \"OUTPUT\",\n  \"P\",\n  \"PARAM\",\n  \"PRE\",\n  \"PROGRESS\",\n  \"Q\",\n  \"RP\",\n  \"RT\",\n  \"RUBY\",\n  \"S\",\n  \"SAMP\",\n  \"SCRIPT\",\n  \"SECTION\",\n  \"SELECT\",\n  \"SMALL\",\n  \"SOURCE\",\n  \"SPAN\",\n  \"STRONG\",\n  \"STYLE\",\n  \"SUB\",\n  \"SUMMARY\",\n  \"SUP\",\n  \"SVG\",\n  \"TABLE\",\n  \"TBODY\",\n  \"TD\",\n  \"TEXTAREA\",\n  \"TFOOT\",\n  \"TH\",\n  \"THEAD\",\n  \"TIME\",\n  \"TITLE\",\n  \"TR\",\n  \"TRACK\",\n  \"U\",\n  \"UL\",\n  \"VAR\",\n  \"VIDEO\",\n  \"WBR\"\n];\n\nfunction computeDefaultStyleByTagName(tagName) {\n  const defaultStyle = {};\n  const element = document.body.appendChild(document.createElement(tagName));\n  const computedStyle = getComputedStyle(element);\n  for (let i = 0; i < computedStyle.length; i++) {\n    defaultStyle[computedStyle[i]] = computedStyle[computedStyle[i]];\n  }\n  document.body.removeChild(element);\n  return defaultStyle;\n}\n\nfunction getDefaultStyleByTagName(tagName) {\n  tagName = tagName.toUpperCase();\n  if (!defaultStylesByTagName[tagName]) {\n    defaultStylesByTagName[tagName] = computeDefaultStyleByTagName(tagName);\n  }\n  return defaultStylesByTagName[tagName];\n}\n\nexport function warmSerializeElement() {\n  for (let i = 0; i < tagNames.length; i++) {\n    if (!noStyleTags[tagNames[i]]) {\n      defaultStylesByTagName[tagNames[i]] = computeDefaultStyleByTagName(tagNames[i]);\n    }\n  }\n}\n\nexport default function serializeElement(el) {\n  if (Object.keys(defaultStylesByTagName).length === 0) {\n    // Precompute the lookup tables.\n    warmSerializeElement();\n  }\n\n  if (el.nodeType !== Node.ELEMENT_NODE) {\n    throw new TypeError();\n  }\n  const cssTexts = [];\n  const elements = el.querySelectorAll(\"*\");\n  for (let i = 0; i < elements.length; i++) {\n    const e = elements[i];\n    if (!noStyleTags[e.tagName]) {\n      const computedStyle = getComputedStyle(e);\n      const defaultStyle = getDefaultStyleByTagName(e.tagName);\n      cssTexts[i] = e.style.cssText;\n      for (let ii = 0; ii < computedStyle.length; ii++) {\n        const cssPropName = computedStyle[ii];\n\n        // Skip non-standard CSS for now, because it overwrites things like color\n        if (cssPropName.startsWith(\"-webkit\")) continue;\n\n        if (computedStyle[cssPropName] !== defaultStyle[cssPropName]) {\n          e.style[cssPropName] = computedStyle[cssPropName];\n        }\n      }\n    }\n  }\n  const result = el.outerHTML;\n  for (let i = 0; i < elements.length; i++) {\n    elements[i].style.cssText = cssTexts[i];\n  }\n  return result;\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\nimport classNames from \"classnames\";\n\nimport rootStyles from \"../assets/stylesheets/ui-root.scss\";\nimport styles from \"../assets/stylesheets/presence-list.scss\";\nimport PhoneImage from \"../assets/images/presence_phone.png\";\nimport DesktopImage from \"../assets/images/presence_desktop.png\";\nimport DiscordImage from \"../assets/images/presence_discord.png\";\nimport CameraImage from \"../assets/images/presence_camera.png\";\nimport HMDImage from \"../assets/images/presence_vr.png\";\nimport maskEmail from \"../utils/mask-email\";\nimport StateLink from \"./state-link.js\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faUsers } from \"@fortawesome/free-solid-svg-icons/faUsers\";\nimport { faPencilAlt } from \"@fortawesome/free-solid-svg-icons/faPencilAlt\";\nimport { pushHistoryPath, withSlug } from \"../utils/history\";\n\nfunction getPresenceImage(ctx) {\n  if (ctx && ctx.mobile) {\n    return PhoneImage;\n  } else if (ctx && ctx.hmd) {\n    return HMDImage;\n  } else if (ctx && ctx.discord) {\n    return DiscordImage;\n  } else {\n    return DesktopImage;\n  }\n}\n\nexport function navigateToClientInfo(history, clientId) {\n  const currentParams = new URLSearchParams(history.location.search);\n\n  if (process.env.RETICULUM_SERVER && document.location.host !== process.env.RETICULUM_SERVER) {\n    currentParams.set(\"client_id\", clientId);\n    pushHistoryPath(history, history.location.pathname, currentParams.toString());\n  } else {\n    pushHistoryPath(history, withSlug(history.location, `/clients/${clientId}`), currentParams.toString());\n  }\n}\n\nexport default class PresenceList extends Component {\n  static propTypes = {\n    presences: PropTypes.object,\n    history: PropTypes.object,\n    sessionId: PropTypes.string,\n    signedIn: PropTypes.bool,\n    email: PropTypes.string,\n    onSignIn: PropTypes.func,\n    onSignOut: PropTypes.func\n  };\n\n  state = {\n    expanded: false\n  };\n\n  navigateToClientInfo = clientId => {\n    navigateToClientInfo(this.props.history, clientId);\n  };\n\n  domForPresence = ([sessionId, data]) => {\n    const meta = data.metas[data.metas.length - 1];\n    const context = meta.context;\n    const profile = meta.profile;\n    const recording = meta.streaming || meta.recording;\n    const image = recording ? CameraImage : getPresenceImage(context);\n    const isBot = context && context.discord;\n    const isOwner = meta.roles && meta.roles.owner;\n    const badge = isOwner && (\n      <span className={styles.moderatorBadge} title=\"Moderator\">\n        &#x2605;\n      </span>\n    );\n\n    return (\n      <WithHoverSound key={sessionId}>\n        <div className={styles.row}>\n          <div className={styles.icon}>\n            <img src={image} />\n          </div>\n          <div\n            className={classNames({\n              [styles.listItem]: true\n            })}\n          >\n            {sessionId === this.props.sessionId ? (\n              <StateLink className={styles.self} stateKey=\"overlay\" stateValue=\"profile\" history={this.props.history}>\n                {profile && profile.displayName}\n                {badge}\n                <i>\n                  <FontAwesomeIcon icon={faPencilAlt} />\n                </i>\n              </StateLink>\n            ) : (\n              <div>\n                {!isBot ? (\n                  <button className={styles.clientLink} onClick={() => this.navigateToClientInfo(sessionId)}>\n                    {profile && profile.displayName}\n                  </button>\n                ) : (\n                  <span>{profile && profile.displayName}</span>\n                )}\n                {badge}\n              </div>\n            )}\n          </div>\n          <div className={styles.presence}>\n            <FormattedMessage id={`presence.in_${meta.presence}`} />\n          </div>\n        </div>\n      </WithHoverSound>\n    );\n  };\n\n  componentDidMount() {\n    document.querySelector(\".a-canvas\").addEventListener(\"mouseup\", () => {\n      if (this.state.expanded) {\n        this.setState({ expanded: false });\n      }\n    });\n  }\n\n  renderExpandedList() {\n    return (\n      <div className={styles.presenceList}>\n        <div className={styles.attachPoint} />\n        <div className={styles.contents}>\n          <div className={styles.rows}>\n            {Object.entries(this.props.presences || {})\n              .filter(([k]) => k === this.props.sessionId)\n              .map(this.domForPresence)}\n            {Object.entries(this.props.presences || {})\n              .filter(([k]) => k !== this.props.sessionId)\n              .map(this.domForPresence)}\n          </div>\n          <div className={styles.signIn}>\n            {this.props.signedIn ? (\n              <div>\n                <span>\n                  <FormattedMessage id=\"sign-in.as\" /> {maskEmail(this.props.email)}\n                </span>{\" \"}\n                <a onClick={this.props.onSignOut}>\n                  <FormattedMessage id=\"sign-in.out\" />\n                </a>\n              </div>\n            ) : (\n              <a onClick={this.props.onSignIn}>\n                <FormattedMessage id=\"sign-in.in\" />\n              </a>\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  render() {\n    const occupantCount = this.props.presences ? Object.entries(this.props.presences).length : 0;\n    return (\n      <div>\n        <div\n          onClick={() => this.setState({ expanded: !this.state.expanded })}\n          className={classNames({\n            [rootStyles.presenceInfo]: true,\n            [rootStyles.presenceInfoSelected]: this.state.expanded\n          })}\n        >\n          <FontAwesomeIcon icon={faUsers} />\n          <span className={rootStyles.occupantCount}>{occupantCount}</span>\n        </div>\n        {this.state.expanded && this.renderExpandedList()}\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport PropTypes from \"prop-types\";\nimport styles from \"../assets/stylesheets/presence-log.scss\";\nimport classNames from \"classnames\";\nimport Linkify from \"react-linkify\";\nimport { toArray as toEmojis } from \"react-emoji-render\";\nimport serializeElement from \"../utils/serialize-element\";\nimport { navigateToClientInfo } from \"./presence-list\";\n\nconst messageCanvas = document.createElement(\"canvas\");\nconst emojiRegex = /(?:[\\u2700-\\u27bf]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\u0023-\\u0039]\\ufe0f?\\u20e3|\\u3299|\\u3297|\\u303d|\\u3030|\\u24c2|\\ud83c[\\udd70-\\udd71]|\\ud83c[\\udd7e-\\udd7f]|\\ud83c\\udd8e|\\ud83c[\\udd91-\\udd9a]|\\ud83c[\\udde6-\\uddff]|[\\ud83c[\\ude01-\\ude02]|\\ud83c\\ude1a|\\ud83c\\ude2f|[\\ud83c[\\ude32-\\ude3a]|[\\ud83c[\\ude50-\\ude51]|\\u203c|\\u2049|[\\u25aa-\\u25ab]|\\u25b6|\\u25c0|[\\u25fb-\\u25fe]|\\u00a9|\\u00ae|\\u2122|\\u2139|\\ud83c\\udc04|[\\u2600-\\u26FF]|\\u2b05|\\u2b06|\\u2b07|\\u2b1b|\\u2b1c|\\u2b50|\\u2b55|\\u231a|\\u231b|\\u2328|\\u23cf|[\\u23e9-\\u23f3]|[\\u23f8-\\u23fa]|\\ud83c\\udccf|\\u2934|\\u2935|[\\u2190-\\u21ff])/;\nconst urlRegex = /^https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_+.~#?&//=]*)$/;\nconst textureLoader = new THREE.TextureLoader();\n\n// Hacky word wrapping, needed because the SVG conversion doesn't properly deal\n// with wrapping in Firefox for some reason. (The CSS white-space is set to pre)\nconst wordWrap = body => {\n  const maxCharsPerLine = 40;\n  const words = body.split(\" \");\n  const outWords = [];\n  let c = 0;\n\n  for (let i = 0; i < words.length; i++) {\n    const word = words[i];\n\n    if (word.startsWith(\":\") && word.endsWith(\":\")) {\n      c++;\n    } else {\n      c += word.length;\n    }\n\n    outWords.push(word);\n\n    if (c >= maxCharsPerLine) {\n      c = 0;\n      outWords.push(\"\\n\");\n    }\n  }\n\n  return outWords.join(\" \");\n};\n\nconst messageBodyDom = (body, from, fromSessionId, includeFromLink, history) => {\n  // Support wrapping text in ` to get monospace, and multiline.\n  const multiLine = body.split(\"\\n\").length > 1;\n  const wrapStyle = multiLine ? styles.messageWrapMulti : styles.messageWrap;\n  const mono = body.startsWith(\"`\") && body.endsWith(\"`\");\n  const messageBodyClasses = {\n    [styles.messageBody]: true,\n    [styles.messageBodyMulti]: multiLine,\n    [styles.messageBodyMono]: mono\n  };\n  const includeClientLink = includeFromLink && fromSessionId && history && NAF.clientId !== fromSessionId;\n  const onFromClick = includeClientLink ? () => navigateToClientInfo(history, fromSessionId) : () => {};\n\n  if (!multiLine) {\n    body = wordWrap(body);\n  }\n\n  const cleanedBody = (mono ? body.substring(1, body.length - 1) : body).trim();\n\n  return (\n    <div className={wrapStyle}>\n      {from && (\n        <div\n          onClick={onFromClick}\n          className={classNames({ [styles.messageSource]: true, [styles.messageSourceLink]: includeClientLink })}\n        >\n          {from}:\n        </div>\n      )}\n      <div className={classNames(messageBodyClasses)}>\n        <Linkify properties={{ target: \"_blank\", rel: \"noopener referrer\" }}>{toEmojis(cleanedBody)}</Linkify>\n      </div>\n    </div>\n  );\n};\n\nfunction renderChatMessage(body, from, allowEmojiRender, lowResolution) {\n  const isOneLine = body.split(\"\\n\").length === 1;\n  const context = messageCanvas.getContext(\"2d\");\n  const emoji = toEmojis(body);\n  const isEmoji =\n    allowEmojiRender &&\n    emoji.length === 1 &&\n    emoji[0].props &&\n    emoji[0].props.children.match &&\n    emoji[0].props.children.match(emojiRegex);\n\n  const el = document.createElement(\"div\");\n  el.setAttribute(\"xmlns\", \"http://www.w3.org/1999/xhtml\");\n  el.setAttribute(\"class\", `${styles.presenceLog} ${styles.presenceLogSpawn}`);\n\n  // The element is added to the DOM in order to have layout compute the width & height,\n  // and then it is removed after being rendered.\n  document.body.appendChild(el);\n\n  const entryDom = (\n    <div\n      className={classNames({\n        [styles.presenceLogEntry]: !isEmoji,\n        [styles.presenceLogEntryOneLine]: !isEmoji && isOneLine,\n        [styles.presenceLogEmoji]: isEmoji\n      })}\n    >\n      {messageBodyDom(body, from)}\n    </div>\n  );\n\n  return new Promise(resolve => {\n    ReactDOM.render(entryDom, el, () => {\n      // Scale by 12x\n      let objectScale = \"8.33%\";\n      let scale = 12;\n\n      if (lowResolution) {\n        // In low res, scale by 4x\n        objectScale = \"25%\";\n        scale = 4;\n      }\n\n      messageCanvas.width = el.offsetWidth * (scale + 0.1);\n      messageCanvas.height = el.offsetHeight * (scale + 0.1);\n\n      const xhtml = encodeURIComponent(`\n          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${messageCanvas.width}\" height=\"${messageCanvas.height}\">\n            <foreignObject width=\"${objectScale}\" height=\"${objectScale}\" style=\"transform: scale(${scale});\">\n              ${serializeElement(el)}\n            </foreignObject>\n          </svg>\n    `);\n      const img = new Image();\n\n      img.onload = async () => {\n        context.drawImage(img, 0, 0);\n        const blob = await new Promise(resolve => messageCanvas.toBlob(resolve));\n        ReactDOM.unmountComponentAtNode(el);\n        el.remove();\n        resolve(blob);\n      };\n\n      img.src = \"data:image/svg+xml,\" + xhtml;\n    });\n  });\n}\n\nexport async function createInWorldLogMessage({ name, type, body }) {\n  if (type !== \"chat\") return;\n\n  const lowResolution = AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR();\n  const blob = await renderChatMessage(body, name, false, lowResolution);\n  const entity = document.createElement(\"a-entity\");\n  const meshEntity = document.createElement(\"a-entity\");\n\n  document.querySelector(\"a-scene\").appendChild(entity);\n\n  entity.appendChild(meshEntity);\n  entity.setAttribute(\"follow-in-fov\", {\n    target: \"#player-camera\",\n    offset: { x: 0, y: 0.0, z: -0.8 }\n  });\n\n  const blobUrl = URL.createObjectURL(blob);\n\n  meshEntity.setAttribute(\"animation__float\", {\n    property: \"position\",\n    dur: 10000,\n    from: { x: 0, y: 0, z: 0 },\n    to: { x: 0, y: 0.05, z: -0.05 },\n    easing: \"easeOutQuad\"\n  });\n\n  entity.setAttribute(\"animation__spawn\", {\n    property: \"scale\",\n    dur: 200,\n    from: { x: 0.1, y: 0.1, z: 0.1 },\n    to: { x: 1, y: 1, z: 1 },\n    easing: \"easeOutElastic\"\n  });\n\n  meshEntity.setAttribute(\"animation__opacity\", {\n    property: \"meshMaterial.opacity\",\n    isRawProperty: true,\n    delay: 3000,\n    dur: 8000,\n    from: 1.0,\n    to: 0.0,\n    easing: \"easeInQuad\"\n  });\n\n  meshEntity.addEventListener(\"animationcomplete__opacity\", () => {\n    entity.parentNode.removeChild(entity);\n  });\n\n  textureLoader.load(blobUrl, texture => {\n    const material = new THREE.MeshBasicMaterial();\n    material.transparent = true;\n    material.map = texture;\n    material.generateMipmaps = false;\n    material.needsUpdate = true;\n\n    const geometry = new THREE.PlaneBufferGeometry(1, 1, 1, 1, texture.flipY);\n    const mesh = new THREE.Mesh(geometry, material);\n    meshEntity.setObject3D(\"mesh\", mesh);\n    meshEntity.meshMaterial = material;\n    const scaleFactor = 4000.0 / (lowResolution ? 3.0 : 1.0);\n    meshEntity.object3DMap.mesh.scale.set(texture.image.width / scaleFactor, texture.image.height / scaleFactor, 1);\n  });\n}\n\nexport async function spawnChatMessage(body, from) {\n  if (body.length === 0) return;\n\n  if (body.match(urlRegex)) {\n    document.querySelector(\"a-scene\").emit(\"add_media\", body);\n    return;\n  }\n\n  const blob = await renderChatMessage(body, from, true, false);\n  document.querySelector(\"a-scene\").emit(\"add_media\", new File([blob], \"message.png\", { type: \"image/png\" }));\n}\n\nexport default function ChatMessage(props) {\n  return (\n    <div className={props.className}>\n      {props.maySpawn && (\n        <button\n          className={classNames(styles.iconButton, styles.spawnMessage)}\n          onClick={() => spawnChatMessage(props.body)}\n        />\n      )}\n      {messageBodyDom(props.body, props.name, props.sessionId, props.includeFromLink, props.history)}\n    </div>\n  );\n}\n\nChatMessage.propTypes = {\n  name: PropTypes.string,\n  maySpawn: PropTypes.bool,\n  body: PropTypes.string,\n  sessionId: PropTypes.string,\n  history: PropTypes.object,\n  className: PropTypes.string,\n  includeFromLink: PropTypes.bool\n};\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"../assets/stylesheets/message-entry.scss\";\nimport ChatCommandHelp from \"./chat-command-help\";\nimport { faPaperPlane } from \"@fortawesome/free-solid-svg-icons/faPaperPlane\";\nimport { faCamera } from \"@fortawesome/free-solid-svg-icons/faCamera\";\nimport { faPlus } from \"@fortawesome/free-solid-svg-icons/faPlus\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\nimport { spawnChatMessage } from \"./chat-message\";\nimport { pushHistoryState } from \"../utils/history\";\n\nconst isMobile = AFRAME.utils.device.isMobile();\n\nclass InWorldChatBox extends Component {\n  static propTypes = {\n    discordBridges: PropTypes.array,\n    onSendMessage: PropTypes.func,\n    onObjectCreated: PropTypes.func,\n    history: PropTypes.object,\n    enableSpawning: PropTypes.bool\n  };\n\n  state = {\n    pendingMessage: \"\"\n  };\n\n  sendMessage = e => {\n    e.preventDefault();\n    if (this.props.onSendMessage) {\n      this.props.onSendMessage(this.state.pendingMessage);\n    }\n    this.setState({ pendingMessage: \"\" });\n  };\n\n  render() {\n    const textRows = this.state.pendingMessage.split(\"\\n\").length;\n    const pendingMessageTextareaHeight = textRows * 28 + \"px\";\n    const pendingMessageFieldHeight = textRows * 28 + 20 + \"px\";\n    const discordSnippet = this.props.discordBridges.map(ch => \"#\" + ch).join(\", \");\n\n    return (\n      <form onSubmit={this.sendMessage}>\n        <div\n          className={classNames({ [styles.messageEntryInRoom]: true, [styles.messageEntryOnMobile]: isMobile })}\n          style={{ height: pendingMessageFieldHeight }}\n        >\n          {this.state.pendingMessage.startsWith(\"/\") && (\n            <ChatCommandHelp matchingPrefix={this.state.pendingMessage.substring(1)} />\n          )}\n          <input\n            id=\"message-entry-media-input\"\n            type=\"file\"\n            style={{ display: \"none\" }}\n            accept={isMobile ? \"image/*\" : \"*\"}\n            multiple\n            onChange={e => {\n              if (this.props.onObjectCreated) {\n                for (const file of e.target.files) {\n                  this.props.onObjectCreated(file);\n                }\n              }\n            }}\n          />\n          {this.props.enableSpawning && (\n            <label\n              htmlFor=\"message-entry-media-input\"\n              title={\"Upload\"}\n              className={classNames([\n                styles.messageEntryButton,\n                styles.messageEntryButtonInRoom,\n                styles.messageEntryUpload\n              ])}\n            >\n              <i>\n                <FontAwesomeIcon icon={isMobile ? faCamera : faPlus} />\n              </i>\n            </label>\n          )}\n          <textarea\n            style={{ height: pendingMessageTextareaHeight }}\n            className={classNames([\n              styles.messageEntryInput,\n              styles.messageEntryInputInRoom,\n              \"chat-focus-target\",\n              !this.props.enableSpawning && styles.messageEntryInputNoSpawn\n            ])}\n            value={this.state.pendingMessage}\n            rows={textRows}\n            onFocus={e => {\n              handleTextFieldFocus(e.target);\n            }}\n            onBlur={() => {\n              handleTextFieldBlur();\n            }}\n            onChange={e => {\n              e.stopPropagation();\n              this.setState({ pendingMessage: e.target.value });\n            }}\n            onKeyDown={e => {\n              if (e.key === \"Enter\" && !e.ctrlKey && !e.shiftKey) {\n                this.sendMessage(e);\n              } else if (e.key === \"Enter\" && e.ctrlKey) {\n                spawnChatMessage(e.target.value);\n                this.setState({ pendingMessage: \"\" });\n                e.target.blur();\n              } else if (e.key === \"Escape\") {\n                e.target.blur();\n              }\n            }}\n            placeholder={this.props.discordBridges.length ? `Send to room and ${discordSnippet}...` : \"Send to room...\"}\n          />\n          {this.props.enableSpawning && (\n            <button\n              className={classNames([styles.messageEntrySpawn])}\n              onClick={() => {\n                if (this.state.pendingMessage.length > 0) {\n                  spawnChatMessage(this.state.pendingMessage);\n                  this.setState({ pendingMessage: \"\" });\n                } else {\n                  pushHistoryState(this.props.history, \"modal\", \"create\");\n                }\n              }}\n            />\n          )}\n          <button\n            type=\"submit\"\n            className={classNames([\n              styles.messageEntryButton,\n              styles.messageEntryButtonInRoom,\n              styles.messageEntrySubmit\n            ])}\n          >\n            <i>\n              <FontAwesomeIcon icon={faPaperPlane} />\n            </i>\n          </button>\n        </div>\n      </form>\n    );\n  }\n}\n\nexport default InWorldChatBox;\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\nimport { fetchReticulumAuthenticated } from \"../utils/phoenix-utils\";\nimport { upload } from \"../utils/media-utils\";\nimport classNames from \"classnames\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nimport AvatarPreview from \"./avatar-preview\";\nimport styles from \"../assets/stylesheets/avatar-editor.scss\";\n\nconst AVATARS_API = \"/api/v1/avatars\";\n\nexport default class AvatarEditor extends Component {\n  static propTypes = {\n    avatarId: PropTypes.string,\n    onSignIn: PropTypes.func,\n    onSave: PropTypes.func,\n    onClose: PropTypes.func,\n    signedIn: PropTypes.bool,\n    hideDelete: PropTypes.bool,\n    debug: PropTypes.bool,\n    className: PropTypes.string\n  };\n\n  state = {\n    avatar: { name: \"My Avatar\", parent_avatar_listing_id: \"basebot\", files: {} },\n    previewGltfUrl: null\n  };\n\n  constructor(props) {\n    super(props);\n    // Blank avatar, used to create base avatar\n    // this.state = { avatar: { name: \"Base bot avatar\", files: {} } };\n\n    this.inputFiles = {};\n  }\n\n  componentDidMount = async () => {\n    if (this.props.avatarId) {\n      const avatar = await this.fetchAvatar(this.props.avatarId);\n      avatar.creatorAttribution = (avatar.attributions && avatar.attributions.creator) || \"\";\n      Object.assign(this.inputFiles, avatar.files);\n      this.setState({ avatar, previewGltfUrl: avatar.base_gltf_url });\n    } else {\n      const { base_gltf_url } = await this.fetchAvatar(\"basebot\");\n      this.setState({ previewGltfUrl: base_gltf_url });\n    }\n  };\n\n  fetchAvatar = avatarId => {\n    return fetchReticulumAuthenticated(`${AVATARS_API}/${avatarId}`).then(({ avatars }) => avatars[0]);\n  };\n\n  createOrUpdateAvatar = avatar => {\n    return fetchReticulumAuthenticated(\n      avatar.avatar_id ? `${AVATARS_API}/${avatar.avatar_id}` : AVATARS_API,\n      avatar.avatar_id ? \"PUT\" : \"POST\",\n      { avatar }\n    ).then(({ avatars }) => avatars[0]);\n  };\n\n  uploadAvatar = async e => {\n    e.preventDefault();\n\n    if (this.inputFiles.glb && this.inputFiles.glb instanceof File) {\n      const gltfLoader = new THREE.GLTFLoader();\n      const gltfUrl = URL.createObjectURL(this.inputFiles.glb);\n      const onProgress = console.log;\n      const parser = await new Promise((resolve, reject) =>\n        gltfLoader.createParser(gltfUrl, resolve, onProgress, reject)\n      );\n      URL.revokeObjectURL(gltfUrl);\n\n      const { content, body } = parser.extensions.KHR_binary_glTF;\n\n      // Inject hubs components on upload. Used to create base avatar\n      // const gltf = parser.json;\n      // Object.assign(gltf.scenes[0], {\n      //   extensions: {\n      //     MOZ_hubs_components: {\n      //       \"loop-animation\": {\n      //         clip: \"idle_eyes\"\n      //       }\n      //     }\n      //   }\n      // });\n      // Object.assign(gltf.nodes.find(n => n.name === \"Head\"), {\n      //   extensions: {\n      //     MOZ_hubs_components: {\n      //       \"scale-audio-feedback\": \"\"\n      //     }\n      //   }\n      // });\n      // content = JSON.stringify(gltf);\n\n      this.inputFiles.gltf = new File([content], \"file.gltf\", {\n        type: \"model/gltf\"\n      });\n      this.inputFiles.bin = new File([body], \"file.bin\", {\n        type: \"application/octet-stream\"\n      });\n    }\n\n    this.inputFiles.thumbnail = new File([await this.preview.getWrappedInstance().snapshot()], \"thumbnail.png\", {\n      type: \"image/png\"\n    });\n\n    const filesToUpload = [\"gltf\", \"bin\", \"base_map\", \"emissive_map\", \"normal_map\", \"orm_map\", \"thumbnail\"].filter(\n      k => this.inputFiles[k] === null || this.inputFiles[k] instanceof File\n    );\n\n    this.setState({ uploading: true });\n\n    const fileUploads = await Promise.all(filesToUpload.map(f => this.inputFiles[f] && upload(this.inputFiles[f])));\n    const avatar = {\n      ...this.state.avatar,\n      attributions: {\n        creator: this.state.avatar.creatorAttribution\n      },\n      files: fileUploads\n        .map((resp, i) => [filesToUpload[i], resp && [resp.file_id, resp.meta.access_token, resp.meta.promotion_token]])\n        .reduce((o, [k, v]) => ({ ...o, [k]: v }), {})\n    };\n\n    await this.createOrUpdateAvatar(avatar);\n\n    this.setState({ uploading: false });\n\n    if (this.props.onSave) this.props.onSave();\n  };\n\n  deleteAvatar = async e => {\n    e.preventDefault();\n    await fetchReticulumAuthenticated(`${AVATARS_API}/${this.state.avatar.avatar_id}`, \"DELETE\");\n    if (this.props.onSave) this.props.onSave();\n  };\n\n  fileField = (name, label, accept, disabled = false, title) => (\n    <div className=\"file-input-row\" key={name} title={title}>\n      <label htmlFor={`avatar-file_${name}`}>\n        <div className=\"img-box\" />\n        <span>{label}</span>\n      </label>\n      <input\n        id={`avatar-file_${name}`}\n        type=\"file\"\n        accept={accept}\n        disabled={disabled}\n        onChange={e => {\n          this.inputFiles[name] = e.target.files[0];\n          e.target.value = null;\n        }}\n      />\n      {this.state.avatar.files[name] && (\n        <a\n          onClick={() => {\n            this.inputFiles[name] = null;\n          }}\n        >\n          <i>\n            <FontAwesomeIcon icon={faTimes} />\n          </i>\n        </a>\n      )}\n    </div>\n  );\n\n  mapField = (name, label, accept, disabled = false, title) => (\n    <div className=\"file-input-row\" key={name} title={title}>\n      <label htmlFor={`avatar-file_${name}`}>\n        <div className=\"img-box\">{this.state.avatar.files[name] && <img src={this.state.avatar.files[name]} />}</div>\n        <span>{label}</span>\n      </label>\n      <input\n        id={`avatar-file_${name}`}\n        type=\"file\"\n        accept={accept}\n        disabled={disabled}\n        onChange={e => {\n          const file = e.target.files[0];\n          e.target.value = null;\n          this.inputFiles[name] = file;\n          URL.revokeObjectURL(this.state.avatar.files[name]);\n          this.setState({\n            avatar: {\n              ...this.state.avatar,\n              files: {\n                ...this.state.avatar.files,\n                [name]: URL.createObjectURL(file)\n              }\n            }\n          });\n        }}\n      />\n      {this.state.avatar.files[name] && (\n        <a\n          onClick={() => {\n            this.inputFiles[name] = null;\n            URL.revokeObjectURL(this.state.avatar.files[name]);\n            this.setState({\n              avatar: {\n                ...this.state.avatar,\n                files: {\n                  ...this.state.avatar.files,\n                  [name]: null\n                }\n              }\n            });\n          }}\n        >\n          <i>\n            <FontAwesomeIcon icon={faTimes} />\n          </i>\n        </a>\n      )}\n    </div>\n  );\n\n  textField = (name, placeholder, disabled, required) => (\n    <div>\n      <input\n        id={`avatar-${name}`}\n        type=\"text\"\n        disabled={disabled}\n        required={required}\n        placeholder={placeholder}\n        className=\"text-field\"\n        value={this.state.avatar[name] || \"\"}\n        onChange={e => this.setState({ avatar: { ...this.state.avatar, [name]: e.target.value } })}\n      />\n    </div>\n  );\n\n  textarea = (name, placeholder, disabled) => (\n    <div>\n      <textarea\n        id={`avatar-${name}`}\n        disabled={disabled}\n        placeholder={placeholder}\n        className=\"textarea\"\n        value={this.state.avatar[name] || \"\"}\n        onChange={e => this.setState({ avatar: { ...this.state.avatar, [name]: e.target.value } })}\n      />\n    </div>\n  );\n\n  checkbox = (name, children, disabled) => (\n    <div className=\"checkbox-container\">\n      <input\n        id={`avatar-${name}`}\n        type=\"checkbox\"\n        className=\"checkbox\"\n        disabled={disabled}\n        checked={!!this.state.avatar[name]}\n        onChange={e => this.setState({ avatar: { ...this.state.avatar, [name]: e.target.checked } })}\n      />\n      <label htmlFor={`#avatar-${name}`}>{children}</label>\n    </div>\n  );\n\n  render() {\n    const { debug } = this.props;\n    return (\n      <div className={classNames(styles.avatarEditor, this.props.className)}>\n        {this.props.onClose && (\n          <a className=\"close-button\" onClick={this.props.onClose}>\n            <i>\n              <FontAwesomeIcon icon={faTimes} />\n            </i>\n          </a>\n        )}\n        {this.props.signedIn ? (\n          <form onSubmit={this.uploadAvatar} className=\"center\">\n            <div className=\"split\">\n              <div className=\"form-body\">\n                {debug && this.textField(\"avatar_id\", \"Avatar ID\", true)}\n                {debug && this.textField(\"parent_avatar_id\", \"Parent Avatar ID\")}\n                {debug && this.textField(\"parent_avatar_listing_id\", \"Parent Avatar Listing ID\")}\n                {this.textField(\"name\", \"Name\", false, true)}\n                {debug && this.textarea(\"description\", \"Description\")}\n                {debug && this.fileField(\"glb\", \"Avatar GLB\", \"model/gltf+binary,.glb\")}\n\n                {this.mapField(\"base_map\", \"Base Map\", \"image/*\")}\n                {this.mapField(\"emissive_map\", \"Emissive Map\", \"image/*\")}\n                {this.mapField(\"normal_map\", \"Normal Map\", \"image/*\")}\n\n                {this.mapField(\"orm_map\", \"ORM Map\", \"image/*\", false, \"Occlussion (r), Roughness (g), Metallic (b)\")}\n\n                <hr />\n\n                {this.checkbox(\n                  \"allow_promotion\",\n                  <span>\n                    Allow{\" \"}\n                    <a\n                      href=\"https://github.com/mozilla/hubs/blob/master/PROMOTION.md\"\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                    >\n                      Promotion\n                    </a>\n                  </span>\n                )}\n                {this.checkbox(\n                  \"allow_remixing\",\n                  <span>\n                    Allow{\" \"}\n                    <a\n                      href=\"https://github.com/mozilla/hubs/blob/master/REMIXING.md\"\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                    >\n                      Remixing\n                    </a>{\" \"}\n                    <span className=\"license\">\n                      (under{\" \"}\n                      <a href=\"https://creativecommons.org/licenses/by/3.0/\" target=\"_blank\" rel=\"noopener noreferrer\">\n                        CC-BY 3.0\n                      </a>)\n                    </span>\n                  </span>\n                )}\n                {this.textField(\"creatorAttribution\", \"Attribution (optional)\", false, false)}\n\n                {/* {this.mapField(\"ao_map\", \"AO Map\", \"images/\\*\", true)} */}\n                {/* {this.mapField(\"metallic_map\", \"Metallic Map\", \"image/\\*\", true)} */}\n                {/* {this.mapField(\"roughness_map\", \"Roughness Map\", \"image/\\*\", true)} */}\n              </div>\n              <AvatarPreview\n                className=\"preview\"\n                avatarGltfUrl={this.state.previewGltfUrl}\n                {...this.inputFiles}\n                ref={p => (this.preview = p)}\n              />\n            </div>\n            <div className=\"info\">\n              <p>\n                <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://tryquilt.io/\">\n                  <FormattedMessage id=\"avatar-editor.quilt-link\" />\n                </a>\n              </p>\n              <p>\n                <FormattedMessage id=\"avatar-editor.info\" />\n                <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://github.com/j-conrad/hubs-avatar-pipelines\">\n                  <FormattedMessage id=\"avatar-editor.info-link\" />\n                </a>\n              </p>\n            </div>\n            <div>\n              <input\n                disabled={this.state.uploading}\n                className=\"form-submit\"\n                type=\"submit\"\n                value={this.state.uploading ? \"Uploading...\" : \"Save\"}\n              />\n            </div>\n            {!this.props.hideDelete && (\n              <div className=\"delete-avatar\">\n                {this.state.confirmDelete ? (\n                  <span>\n                    are you sure? <a onClick={this.deleteAvatar}>yes</a> /{\" \"}\n                    <a onClick={() => this.setState({ confirmDelete: false })}>no</a>\n                  </span>\n                ) : (\n                  <a onClick={() => this.setState({ confirmDelete: true })}>delete avatar</a>\n                )}\n              </div>\n            )}\n          </form>\n        ) : (\n          <a onClick={this.props.onSignIn}>\n            <FormattedMessage id=\"sign-in.in\" />\n          </a>\n        )}\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\nimport MovingAverage from \"moving-average\";\n\nexport default class MicLevelWidget extends Component {\n  static propTypes = {\n    hasAudioTrack: PropTypes.bool,\n    muteOnEntry: PropTypes.bool,\n    scene: PropTypes.object\n  };\n\n  state = {\n    volume: 0\n  };\n\n  componentDidMount() {\n    this.startAnalyser();\n  }\n\n  componentWillUnmount() {\n    this.stopAnalyser();\n  }\n\n  stopAnalyser() {\n    if (this.micUpdateInterval != null) {\n      clearInterval(this.micUpdateInterval);\n    }\n  }\n\n  startAnalyser() {\n    if (this.micUpdateInterval) {\n      clearInterval(this.micUpdateInterval);\n    }\n    const micLevelMovingAverage = MovingAverage(100);\n    let max = 0;\n    this.micUpdateInterval = setInterval(() => {\n      const analyser = this.props.scene.systems[\"local-audio-analyser\"];\n      max = Math.max(analyser.volume, max);\n      // We use a moving average to smooth out the visual animation or else it would twitch too fast for\n      // the css renderer to keep up.\n      micLevelMovingAverage.push(Date.now(), analyser.volume);\n      const average = micLevelMovingAverage.movingAverage();\n      const volume = max === 0 ? 0 : average / max;\n      if (Math.abs(this.state.volume - volume) > 0.05) {\n        this.setState({ volume });\n      }\n    }, 50);\n  }\n\n  render() {\n    const maxLevelHeight = 111;\n    const micClip = {\n      clip: `rect(${maxLevelHeight - Math.floor(this.state.volume * maxLevelHeight)}px, 111px, 111px, 0px)`\n    };\n\n    return (\n      <div className=\"audio-setup-panel__levels__icon\">\n        <img\n          src=\"../assets/images/level_background.png\"\n          srcSet=\"../assets/images/level_background@2x.png 2x\"\n          className=\"audio-setup-panel__levels__icon-part\"\n        />\n        {!this.props.muteOnEntry && (\n          <img\n            src=\"../assets/images/level_fill.png\"\n            srcSet=\"../assets/images/level_fill@2x.png 2x\"\n            className=\"audio-setup-panel__levels__icon-part\"\n            style={micClip}\n          />\n        )}\n        {this.props.hasAudioTrack && !this.props.muteOnEntry ? (\n          <img\n            src=\"../assets/images/mic_level.png\"\n            srcSet=\"../assets/images/mic_level@2x.png 2x\"\n            className=\"audio-setup-panel__levels__icon-part\"\n          />\n        ) : (\n          <img\n            src=\"../assets/images/mic_denied.png\"\n            srcSet=\"../assets/images/mic_denied@2x.png 2x\"\n            className=\"audio-setup-panel__levels__icon-part\"\n          />\n        )}\n        {this.props.hasAudioTrack &&\n          !this.props.muteOnEntry && (\n            <div className=\"audio-setup-panel__levels__test_label\">\n              <FormattedMessage id=\"audio.talk_to_test\" />\n            </div>\n          )}\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nimport webmTone from \"../assets/sfx/tone.webm\";\nimport mp3Tone from \"../assets/sfx/tone.mp3\";\nimport oggTone from \"../assets/sfx/tone.ogg\";\nimport wavTone from \"../assets/sfx/tone.wav\";\n\nexport default class OutputLevelWidget extends Component {\n  state = {\n    tonePlaying: false\n  };\n\n  constructor(props) {\n    super(props);\n    this.playTestTone = this.playTestTone.bind(this);\n    this.toneClip = document.createElement(\"audio\");\n    if (this.toneClip.canPlayType(\"audio/webm\")) {\n      this.toneClip.src = webmTone;\n    } else if (this.toneClip.canPlayType(\"audio/mpeg\")) {\n      this.toneClip.src = mp3Tone;\n    } else if (this.toneClip.canPlayType(\"audio/ogg\")) {\n      this.toneClip.src = oggTone;\n    } else {\n      this.toneClip.src = wavTone;\n    }\n  }\n\n  componentWillUnmount() {\n    this.toneClip.pause();\n    this.toneClip.currentTime = 0;\n    if (this.testToneTimeout != null) {\n      clearTimeout(this.testToneTimeout);\n    }\n  }\n\n  playTestTone() {\n    if (this.testToneTimeout != null) {\n      clearTimeout(this.testToneTimeout);\n    }\n    this.toneClip.currentTime = 0;\n    this.toneClip.play();\n    this.setState({ tonePlaying: true });\n    this.testToneTimeout = setTimeout(() => {\n      this.setState({ tonePlaying: false });\n    }, 1393);\n  }\n\n  render() {\n    const maxLevelHeight = 111;\n    const speakerClip = { clip: `rect(${this.state.tonePlaying ? 0 : maxLevelHeight}px, 111px, 111px, 0px)` };\n    return (\n      <WithHoverSound>\n        <div className=\"audio-setup-panel__levels__icon_clickable\" onClick={this.playTestTone}>\n          <img\n            src=\"../assets/images/level_action_background.png\"\n            srcSet=\"../assets/images/level_action_background@2x.png 2x\"\n            className=\"audio-setup-panel__levels__icon-part\"\n          />\n          <img\n            src=\"../assets/images/level_action_fill.png\"\n            srcSet=\"../assets/images/level_action_fill@2x.png 2x\"\n            className=\"audio-setup-panel__levels__icon-part\"\n            style={speakerClip}\n          />\n          <img\n            src=\"../assets/images/speaker_level.png\"\n            srcSet=\"../assets/images/speaker_level@2x.png 2x\"\n            className=\"audio-setup-panel__levels__icon-part\"\n          />\n          <div className=\"audio-setup-panel__levels__test_label\">\n            <FormattedMessage id=\"audio.click_to_test\" />\n          </div>\n        </div>\n      </WithHoverSound>\n    );\n  }\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport styles from \"../assets/stylesheets/presence-log.scss\";\nimport classNames from \"classnames\";\n\nimport { share } from \"../utils/share\";\nimport { getLandingPageForPhoto } from \"../utils/phoenix-utils\";\n\nexport default function PhotoMessage({ name, body: { src: url }, className, maySpawn, hubId }) {\n  const landingPageUrl = getLandingPageForPhoto(url);\n  const onShareClicked = share.bind(null, {\n    url: landingPageUrl,\n    title: `Taken in #hubs, join me at https://hub.link/${hubId}`\n  });\n  return (\n    <div className={className}>\n      {maySpawn && <button className={classNames(styles.iconButton, styles.share)} onClick={onShareClicked} />}\n      <div className={styles.mediaBody}>\n        <span>\n          <b>{name}</b>\n        </span>\n        <span>\n          {\"took a \"}\n          <b>\n            <a href={landingPageUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n              photo\n            </a>\n          </b>.\n        </span>\n      </div>\n      <a href={landingPageUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n        <img src={url} />\n      </a>\n    </div>\n  );\n}\nPhotoMessage.propTypes = {\n  name: PropTypes.string,\n  maySpawn: PropTypes.bool,\n  body: PropTypes.object,\n  className: PropTypes.string,\n  hubId: PropTypes.string\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport styles from \"../assets/stylesheets/presence-log.scss\";\nimport classNames from \"classnames\";\n\nimport { share } from \"../utils/share\";\n\nexport default function VideoMessage({ name, body: { src: url }, className, maySpawn, hubId }) {\n  const onShareClicked = share.bind(null, {\n    url: url,\n    title: `Taken in #hubs, join me at https://hub.link/${hubId}`\n  });\n  return (\n    <div className={className}>\n      {maySpawn && <button className={classNames(styles.iconButton, styles.share)} onClick={onShareClicked} />}\n      <div className={styles.mediaBody}>\n        <span>\n          <b>{name}</b>\n        </span>\n        <span>\n          {\"took a \"}\n          <b>\n            <a href={url} target=\"_blank\" rel=\"noopener noreferrer\">\n              video\n            </a>\n          </b>.\n        </span>\n      </div>\n    </div>\n  );\n}\nVideoMessage.propTypes = {\n  name: PropTypes.string,\n  maySpawn: PropTypes.bool,\n  body: PropTypes.object,\n  className: PropTypes.string,\n  hubId: PropTypes.string\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"../assets/stylesheets/presence-log.scss\";\nimport classNames from \"classnames\";\nimport { proxiedUrlFor } from \"../utils/media-url-utils\";\n\nfunction spawnImage(url) {\n  document.querySelector(\"a-scene\").emit(\"add_media\", url);\n}\n\nexport default function ImageMessage({ name, body: { src: url }, className, maySpawn }) {\n  return (\n    <div className={className}>\n      {maySpawn && (\n        <button className={classNames(styles.iconButton, styles.spawnMessage)} onClick={() => spawnImage(url)} />\n      )}\n      <div className={styles.mediaBody}>{name && <div className={styles.messageSource}>{name}:</div>}</div>\n      <a href={url} target=\"_blank\" rel=\"noopener noreferrer\">\n        <img src={proxiedUrlFor(url)} />\n      </a>\n    </div>\n  );\n}\n\nImageMessage.propTypes = {\n  name: PropTypes.string,\n  maySpawn: PropTypes.bool,\n  body: PropTypes.object,\n  className: PropTypes.string\n};\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"../assets/stylesheets/presence-log.scss\";\nimport classNames from \"classnames\";\nimport { FormattedMessage } from \"react-intl\";\n\nimport ChatMessage from \"./chat-message\";\nimport PhotoMessage from \"./photo-message\";\nimport VideoMessage from \"./video-message\";\nimport ImageMessage from \"./image-message\";\nimport { getPresenceContextForSession } from \"../utils/phoenix-utils\";\n\nexport default class PresenceLog extends Component {\n  static propTypes = {\n    entries: PropTypes.array,\n    inRoom: PropTypes.bool,\n    hubId: PropTypes.string,\n    history: PropTypes.object,\n    presences: PropTypes.object\n  };\n\n  constructor(props) {\n    super(props);\n  }\n\n  domForEntry = e => {\n    const entryClasses = {\n      [styles.presenceLogEntry]: true,\n      [styles.presenceLogEntryWithButton]: (e.type === \"chat\" || e.type === \"image\") && e.maySpawn,\n      [styles.presenceLogChat]: e.type === \"chat\",\n      [styles.expired]: !!e.expired\n    };\n\n    const presenceContext = e.sessionId ? getPresenceContextForSession(this.props.presences, e.sessionId) : {};\n    const isBot = !!presenceContext.discord;\n\n    switch (e.type) {\n      case \"join\":\n      case \"entered\":\n        return (\n          <div key={e.key} className={classNames(entryClasses)}>\n            <b>{e.name}</b>&nbsp;<FormattedMessage id={`presence.${e.type}_${e.presence}`} />\n          </div>\n        );\n      case \"leave\":\n        return (\n          <div key={e.key} className={classNames(entryClasses)}>\n            <b>{e.name}</b>&nbsp;<FormattedMessage id={`presence.${e.type}`} />\n          </div>\n        );\n      case \"display_name_changed\":\n        return (\n          <div key={e.key} className={classNames(entryClasses)}>\n            <b>{e.oldName}</b>&nbsp;<FormattedMessage id=\"presence.name_change\" />&nbsp;<b>{e.newName}</b>.\n          </div>\n        );\n      case \"scene_changed\":\n        return (\n          <div key={e.key} className={classNames(entryClasses)}>\n            <b>{e.name}</b>&nbsp;<FormattedMessage id=\"presence.scene_change\" />&nbsp;<b>{e.sceneName}</b>.\n          </div>\n        );\n      case \"hub_name_changed\":\n        return (\n          <div key={e.key} className={classNames(entryClasses)}>\n            <b>{e.name}</b>&nbsp;<FormattedMessage id=\"presence.hub_name_change\" />&nbsp;<b>{e.hubName}</b>.\n          </div>\n        );\n      case \"chat\":\n        return (\n          <ChatMessage\n            key={e.key}\n            name={e.name}\n            className={classNames(entryClasses)}\n            body={e.body}\n            maySpawn={e.maySpawn}\n            sessionId={e.sessionId}\n            includeFromLink={this.props.inRoom && !isBot}\n            history={this.props.history}\n          />\n        );\n      case \"image\":\n        return (\n          <ImageMessage\n            key={e.key}\n            name={e.name}\n            className={classNames(entryClasses, styles.media)}\n            body={e.body}\n            maySpawn={e.maySpawn}\n          />\n        );\n      case \"photo\":\n        return (\n          <PhotoMessage\n            key={e.key}\n            name={e.name}\n            className={classNames(entryClasses, styles.media)}\n            body={e.body}\n            maySpawn={e.maySpawn}\n            hubId={this.props.hubId}\n          />\n        );\n      case \"video\":\n        return (\n          <VideoMessage\n            key={e.key}\n            name={e.name}\n            className={classNames(entryClasses, styles.media)}\n            body={e.body}\n            maySpawn={e.maySpawn}\n            hubId={this.props.hubId}\n          />\n        );\n      case \"log\":\n        return (\n          <div key={e.key} className={classNames(entryClasses)}>\n            {e.body}\n          </div>\n        );\n    }\n  };\n\n  render() {\n    const presenceClasses = {\n      [styles.presenceLog]: true,\n      [styles.presenceLogInRoom]: this.props.inRoom\n    };\n\n    return <div className={classNames(presenceClasses)}>{this.props.entries.map(this.domForEntry)}</div>;\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\nimport classNames from \"classnames\";\nimport StateLink from \"./state-link.js\";\nimport { resetTips } from \"../systems/tips\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faImage } from \"@fortawesome/free-solid-svg-icons/faImage\";\nimport { faStar } from \"@fortawesome/free-solid-svg-icons/faStar\";\nimport { faDoorClosed } from \"@fortawesome/free-solid-svg-icons/faDoorClosed\";\nimport { faPencilAlt } from \"@fortawesome/free-solid-svg-icons/faPencilAlt\";\nimport { faInfoCircle } from \"@fortawesome/free-solid-svg-icons/faInfoCircle\";\nimport { faBars } from \"@fortawesome/free-solid-svg-icons/faBars\";\nimport { faPlus } from \"@fortawesome/free-solid-svg-icons/faPlus\";\nimport { faMinus } from \"@fortawesome/free-solid-svg-icons/faMinus\";\nimport { faVideo } from \"@fortawesome/free-solid-svg-icons/faVideo\";\nimport { showFullScreenIfAvailable } from \"../utils/fullscreen\";\nimport LeaveRoomDialog from \"./leave-room-dialog.js\";\n\nimport styles from \"../assets/stylesheets/settings-menu.scss\";\nimport rootStyles from \"../assets/stylesheets/ui-root.scss\";\n\nexport default class SettingsMenu extends Component {\n  static propTypes = {\n    history: PropTypes.object,\n    isStreaming: PropTypes.bool,\n    toggleStreamerMode: PropTypes.func,\n    mediaSearchStore: PropTypes.object,\n    scene: PropTypes.object,\n    hubScene: PropTypes.object,\n    hubChannel: PropTypes.object,\n    performConditionalSignIn: PropTypes.func,\n    showNonHistoriedDialog: PropTypes.func,\n    pushHistoryState: PropTypes.func,\n    toggleFlyMode: PropTypes.func\n  };\n\n  state = {\n    expanded: false\n  };\n\n  componentDidMount() {\n    document.querySelector(\".a-canvas\").addEventListener(\"mouseup\", () => {\n      if (this.state.expanded) {\n        this.setState({ expanded: false });\n      }\n    });\n  }\n\n  renderExpandedMenu() {\n    const rowClasses = classNames([styles.row, styles.settingsRow]);\n    const rowHeader = classNames([styles.row, styles.settingsRow, styles.rowHeader]);\n    const showRoomSettings = !!this.props.hubChannel.canOrWillIfCreator(\"update_hub\");\n    // const showRoomSettings = false;\n    // const showCloseRoom = !!this.props.hubChannel.canOrWillIfCreator(\"close_hub\");\n    const showCloseRoom = false;\n    const showRoomInfo = !!this.props.hubScene;\n    // const showRoomInfo = false;\n    // const showRoomSection = showRoomSettings || showRoomInfo || showCloseRoom;\n    const showRoomSection = false;\n    const showStreamerMode = this.props.scene.is(\"entered\") && !!this.props.hubChannel.canOrWillIfCreator(\"kick_users\");\n\n    const playerRig = document.querySelector(\"#player-rig\");\n    const flyEnabled = playerRig.getAttribute(\"character-controller\", \"fly\").fly;\n\n    // Draw self first\n    return (\n      <div className={styles.settingsMenu}>\n        <div className={styles.attachPoint} />\n        <div className={styles.contents}>\n          <div className={styles.rows}>\n            <div className={rowHeader}>\n              <FormattedMessage id=\"settings.row-profile\" />\n            </div>\n            <div className={rowClasses}>\n              <div className={styles.icon}>\n                <img src=\"../assets/images/change_avatar.svg\" />\n              </div>\n              <div className={styles.listItem}>\n                <StateLink\n                  stateKey=\"overlay\"\n                  stateValue=\"profile\"\n                  history={this.props.history}\n                  onClick={() => this.setState({ expanded: false })}\n                >\n                  <FormattedMessage id=\"settings.change-avatar\" />\n                </StateLink>\n              </div>\n            </div>\n            <div className={rowClasses}>\n                <div className={styles.icon}>\n                  <i>\n                    <FontAwesomeIcon icon={faStar} />\n                  </i>\n                </div>\n                <div className={styles.listItem}>\n                  <div\n                    className={styles.listItemLink}\n                    onClick={() => {\n                      this.props.toggleFlyMode(!flyEnabled);\n                      this.setState({ expanded: false });\n                    }}\n                  >\n                    {flyEnabled ? \"Disable\" : \"Enable\"} Fly Mode\n                  </div>\n                </div>\n              </div>\n            {false ? <div className={rowClasses}>\n              <div className={styles.icon}>\n                <i>\n                  <FontAwesomeIcon icon={faStar} />\n                </i>\n              </div>\n              <div className={styles.listItem}>\n                <div\n                  className={styles.listItemLink}\n                  onClick={() => {\n                    this.props.performConditionalSignIn(\n                      () => this.props.hubChannel.signedIn,\n                      () => {\n                        showFullScreenIfAvailable();\n                        this.props.mediaSearchStore.sourceNavigateWithNoNav(\"favorites\");\n                      },\n                      \"favorite-rooms\"\n                    );\n                  }}\n                >\n                  <FormattedMessage id=\"settings.favorites\" />\n                </div>\n              </div>\n            </div> : <span />}\n            {showRoomSection && (\n              <div className={rowHeader}>\n                <FormattedMessage id=\"settings.row-room\" />\n              </div>\n            )}\n            {false && showRoomSettings && (\n              <div className={rowClasses}>\n                <div className={styles.icon}>\n                  <i>\n                    <FontAwesomeIcon icon={faImage} />\n                  </i>\n                </div>\n                <div className={styles.listItem}>\n                  <div\n                    className={styles.listItemLink}\n                    onClick={() => {\n                      this.props.performConditionalSignIn(\n                        () => this.props.hubChannel.can(\"update_hub\"),\n                        () => {\n                          showFullScreenIfAvailable();\n                          this.props.mediaSearchStore.sourceNavigateWithNoNav(\"scenes\");\n                          this.setState({ expanded: false });\n                        },\n                        \"change-scene\"\n                      );\n                    }}\n                  >\n                    <FormattedMessage id=\"settings.change-scene\" />\n                  </div>\n                </div>\n              </div>\n            )}\n            {showRoomSettings && (\n              <div className={rowClasses}>\n                <div className={styles.icon}>\n                  <i>\n                    <FontAwesomeIcon icon={faPencilAlt} />\n                  </i>\n                </div>\n                <div className={styles.listItem}>\n                  <a\n                    href=\"#\"\n                    onClick={e => {\n                      e.preventDefault();\n\n                      this.props.performConditionalSignIn(\n                        () => this.props.hubChannel.can(\"update_hub\"),\n                        () => {\n                          this.props.pushHistoryState(\"modal\", \"room_settings\");\n                          this.setState({ expanded: false });\n                        },\n                        \"room-settings\"\n                      );\n                    }}\n                  >\n                    <FormattedMessage id=\"settings.room-settings\" />\n                  </a>\n                </div>\n              </div>\n            )}\n            {showCloseRoom && (\n              <div className={rowClasses}>\n                <div className={styles.icon}>\n                  <i>\n                    <FontAwesomeIcon icon={faDoorClosed} />\n                  </i>\n                </div>\n                <div className={styles.listItem}>\n                  <a\n                    href=\"#\"\n                    onClick={e => {\n                      e.preventDefault();\n\n                      this.props.performConditionalSignIn(\n                        () => this.props.hubChannel.can(\"update_hub\"),\n                        () => {\n                          this.props.pushHistoryState(\"modal\", \"close_room\");\n                          this.setState({ expanded: false });\n                        },\n                        \"close-room\"\n                      );\n                    }}\n                  >\n                    <FormattedMessage id=\"settings.close-room\" />\n                  </a>\n                </div>\n              </div>\n            )}\n            {showRoomInfo && (\n              <div className={rowClasses}>\n                <div className={styles.icon}>\n                  <i>\n                    <FontAwesomeIcon icon={faInfoCircle} />\n                  </i>\n                </div>\n                <div className={styles.listItem}>\n                  <StateLink\n                    stateKey=\"modal\"\n                    stateValue=\"room_info\"\n                    history={this.props.history}\n                    onClick={() => this.setState({ expanded: false })}\n                  >\n                    <FormattedMessage id=\"settings.room-info\" />\n                  </StateLink>\n                </div>\n              </div>\n            )}\n            <div className={rowClasses}>\n              <div className={styles.icon}>\n                <i>\n                  <FontAwesomeIcon icon={faDoorClosed} />\n                </i>\n              </div>\n              <div className={styles.listItem}>\n                <a\n                  href=\"#\"\n                  onClick={e => {\n                    e.preventDefault();\n                    this.props.showNonHistoriedDialog(LeaveRoomDialog, {\n                      destinationUrl: \"/\",\n                      messageType: \"create-room\"\n                    });\n                    this.setState({ expanded: false });\n                  }}\n                >\n                  <FormattedMessage id=\"settings.leave-room\" />\n                </a>\n              </div>\n            </div>\n            {showStreamerMode ? (\n              <div className={rowHeader}>\n                <FormattedMessage id=\"settings.row-tools\" />\n              </div>\n            ) : (\n              <div />\n            )}\n            {showStreamerMode ? (\n              <div className={rowClasses}>\n                <div className={styles.icon}>\n                  <i>\n                    <FontAwesomeIcon icon={faVideo} />\n                  </i>\n                </div>\n                <div className={styles.listItem}>\n                  <div\n                    className={styles.listItemLink}\n                    onClick={() => {\n                      this.props.toggleStreamerMode(true);\n                      this.setState({ expanded: false });\n                    }}\n                  >\n                    <FormattedMessage id=\"settings.enable-streamer-mode\" />\n                  </div>\n                </div>\n              </div>\n            ) : (\n              <div />\n            )}\n            {false && <div className={classNames([styles.bottomLinksMain])}>\n              <a href=\"/whats-new\" target=\"_blank\" rel=\"noreferrer noopener\">\n                <FormattedMessage id=\"settings.whats-new\" />\n              </a>\n              <button\n                onClick={e => {\n                  e.preventDefault();\n                  resetTips();\n                  this.setState({ expanded: false });\n                }}\n              >\n                <FormattedMessage id=\"settings.tips\" />\n              </button>\n              <a href=\"https://github.com/mozilla/hubs/wiki/Hubs-Controls\" target=\"_blank\" rel=\"noreferrer noopener\">\n                <FormattedMessage id=\"settings.controls\" />\n              </a>\n            </div>}\n            {false && <div className={classNames([styles.bottomLinks])}>\n              <a href=\"https://github.com/mozilla/hubs/wiki/Hubs-Features\" target=\"_blank\" rel=\"noreferrer noopener\">\n                <FormattedMessage id=\"settings.features\" />\n              </a>\n              <a href=\"https://discord.gg/wHmY4nd\" target=\"_blank\" rel=\"noreferrer noopener\">\n                <FormattedMessage id=\"settings.community\" />\n              </a>\n              <button\n                onClick={e => {\n                  e.preventDefault();\n                  this.props.pushHistoryState(\"modal\", \"feedback\");\n                }}\n              >\n                <FormattedMessage id=\"settings.send-feedback\" />\n              </button>\n              <a className={styles.bottomLink} href=\"/?report\" target=\"_blank\" rel=\"noreferrer noopener\">\n                <FormattedMessage id=\"settings.report\" />\n              </a>\n              <a\n                className={styles.bottomLink}\n                href={this.props.termsLink || \"https://github.com/mozilla/hubs/blob/master/TERMS.md\"}\n                target=\"_blank\"\n                rel=\"noreferrer noopener\"\n              >\n                <FormattedMessage id=\"settings.terms\" />\n              </a>\n              <a\n                className={styles.bottomLink}\n                href={this.props.privacyLink || \"https://github.com/mozilla/hubs/blob/master/PRIVACY.md\"}\n                target=\"_blank\"\n                rel=\"noreferrer noopener\"\n              >\n                <FormattedMessage id=\"settings.privacy\" />\n              </a>\n            </div>}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  render() {\n    return (\n      <div>\n        <FontAwesomeIcon\n          icon={faBars}\n          onClick={() => this.setState({ expanded: !this.state.expanded })}\n          className={classNames({\n            [rootStyles.cornerButton]: true,\n            [rootStyles.cornerButtonSelected]: this.state.expanded\n          })}\n        />\n        {this.state.expanded && this.renderExpandedMenu()}\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n// import hubLogo from \"../assets/images/hub-preview-white.png\";\nimport styles from \"../assets/stylesheets/preload-overlay.scss\";\nimport { FormattedMessage } from \"react-intl\";\n\nconst isMobile = AFRAME.utils.device.isMobile();\n\nexport default class PreloadOverlay extends Component {\n  static propTypes = {\n    hubName: PropTypes.string,\n    hubScene: PropTypes.object,\n    baseUrl: PropTypes.string,\n    onLoadClicked: PropTypes.func\n  };\n\n  render() {\n    return (\n      <div className={styles.treatment}>\n        <div className={styles.screenshot}>\n          {this.props.hubScene && <img className={styles.screenshot} src={this.props.hubScene.screenshot_url} />}\n        </div>\n        <a href=\"/\" target=\"_blank\" rel=\"noopener noreferrer\" className={styles.logo}>\n          <img src={this.props.logo} />\n        </a>\n        <div className={styles.mainPanel}>\n          <div className={styles.hubName}>{this.props.hubName}</div>\n          {this.props.onLoadClicked &&\n            (!isMobile ? (\n              <button className={styles.loadButton} onClick={this.props.onLoadClicked}>\n                <FormattedMessage id=\"embed.load-button\" />\n              </button>\n            ) : (\n              <a href={this.props.baseUrl} target=\"_blank\" className={styles.loadButton} rel=\"noreferrer noopener\">\n                <FormattedMessage id=\"embed.load-button\" />\n              </a>\n            ))}\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport cx from \"classnames\";\n\nconst { detect } = require(\"detect-browser\");\nimport styles from \"../assets/stylesheets/2d-hud.scss\";\nimport uiStyles from \"../assets/stylesheets/ui-root.scss\";\nimport spritesheet from \"../assets/images/spritesheets/css-spritesheet.css\";\nimport { FormattedMessage } from \"react-intl\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport { micLevelForVolume } from \"../components/audio-feedback\";\n\nconst SPRITESHEET_ICONS = {\n  MIC: [\n    spritesheet.mic0,\n    spritesheet.mic1,\n    spritesheet.mic2,\n    spritesheet.mic3,\n    spritesheet.mic4,\n    spritesheet.mic5,\n    spritesheet.mic6,\n    spritesheet.mic7\n  ],\n  MIC_OFF: [\n    spritesheet.micOff0,\n    spritesheet.micOff1,\n    spritesheet.micOff2,\n    spritesheet.micOff3,\n    spritesheet.micOff4,\n    spritesheet.micOff5,\n    spritesheet.micOff6,\n    spritesheet.micOff7\n  ]\n};\nconst browser = detect();\nconst noop = () => {};\n\nclass TopHUD extends Component {\n  static propTypes = {\n    scene: PropTypes.object,\n    muted: PropTypes.bool,\n    flyingEnabled: PropTypes.bool,\n    isCursorHoldingPen: PropTypes.bool,\n    hasActiveCamera: PropTypes.bool,\n    frozen: PropTypes.bool,\n    watching: PropTypes.bool,\n    onWatchEnded: PropTypes.func,\n    videoShareMediaSource: PropTypes.string,\n    showVideoShareFailed: PropTypes.bool,\n    hideVideoShareFailedTip: PropTypes.func,\n    activeTip: PropTypes.string,\n    history: PropTypes.object,\n    onToggleMute: PropTypes.func,\n    onToggleFreeze: PropTypes.func,\n    onSpawnPen: PropTypes.func,\n    onSpawnCamera: PropTypes.func,\n    onShareVideo: PropTypes.func,\n    onEndShareVideo: PropTypes.func,\n    onShareVideoNotCapable: PropTypes.func,\n    mediaSearchStore: PropTypes.object,\n    isStreaming: PropTypes.bool,\n    showStreamingTip: PropTypes.bool,\n    hideStreamingTip: PropTypes.func\n  };\n\n  state = {\n    showVideoShareOptions: false,\n    lastActiveMediaSource: null,\n    micLevel: 0,\n    cameraDisabled: false,\n    penDisabled: false,\n    mediaDisabled: false\n  };\n\n  constructor(props) {\n    super(props);\n    this.state.cameraDisabled = !window.APP.hubChannel.can(\"spawn_camera\");\n    this.state.penDisabled = !window.APP.hubChannel.can(\"spawn_drawing\");\n    this.state.mediaDisabled = !window.APP.hubChannel.can(\"spawn_and_move_media\");\n    this.state.megaphoneDisabled = !window.APP.hubChannel.canOrWillIfCreator(\"update_hub\")\n  }\n\n  onPermissionsUpdated = () => {\n    this.setState({\n      cameraDisabled: !window.APP.hubChannel.can(\"spawn_camera\"),\n      penDisabled: !window.APP.hubChannel.can(\"spawn_drawing\"),\n      mediaDisabled: !window.APP.hubChannel.can(\"spawn_and_move_media\")\n    });\n  };\n\n  componentDidMount = () => {\n    let max = 0;\n    if (this.micUpdateInterval) {\n      clearInterval(this.micUpdateInterval);\n    }\n    this.micUpdateInterval = setInterval(() => {\n      const volume = this.props.scene.systems[\"local-audio-analyser\"].volume;\n      max = Math.max(volume, max);\n      const micLevel = micLevelForVolume(volume, max);\n      if (micLevel !== this.state.micLevel) {\n        this.setState({ micLevel });\n      }\n    }, 50);\n    window.APP.hubChannel.addEventListener(\"permissions_updated\", this.onPermissionsUpdated);\n  };\n\n  componentWillUnmount = () => {\n    if (this.micUpdateInterval) {\n      clearInterval(this.micUpdateInterval);\n    }\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.onPermissionsUpdated);\n  };\n\n  handleVideoShareClicked = source => {\n    if ((source === \"screen\" || source === \"window\") && browser.name !== \"firefox\") {\n      this.props.onShareVideoNotCapable();\n      return;\n    }\n\n    if (this.props.videoShareMediaSource) {\n      this.props.onEndShareVideo();\n    } else {\n      this.props.onShareVideo(source);\n      this.setState({ lastActiveMediaSource: source });\n    }\n  };\n\n  buildVideoSharingButtons = () => {\n    const isMobile = AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR();\n\n    const videoShareExtraOptionTypes = [];\n    const primaryVideoShareType =\n      this.props.videoShareMediaSource || this.state.lastActiveMediaSource || (isMobile ? \"camera\" : \"screen\");\n\n    if (this.state.showVideoShareOptions) {\n      videoShareExtraOptionTypes.push(primaryVideoShareType);\n\n      [\"screen\", \"window\", \"camera\"].forEach(t => {\n        if (videoShareExtraOptionTypes.indexOf(t) === -1) {\n          videoShareExtraOptionTypes.push(t);\n        }\n      });\n    }\n\n    const showExtrasOnHover = () => {\n      if (isMobile) return;\n\n      clearTimeout(this.hideVideoSharingButtonTimeout);\n\n      if (!this.props.videoShareMediaSource) {\n        this.setState({ showVideoShareOptions: true });\n      }\n    };\n\n    const hideExtrasOnOut = () => {\n      this.hideVideoSharingButtonTimeout = setTimeout(() => {\n        this.setState({ showVideoShareOptions: false });\n      }, 250);\n    };\n\n    const maybeHandlePrimaryShare = () => {\n      if (!this.state.showVideoShareOptions) {\n        this.handleVideoShareClicked(primaryVideoShareType);\n      }\n    };\n\n    const capitalize = str => str[0].toUpperCase() + str.slice(1);\n\n    return (\n      <div\n        className={cx(styles.iconButton, styles[`share_${primaryVideoShareType}`], {\n          [styles.active]: this.props.videoShareMediaSource === primaryVideoShareType,\n          [styles.disabled]: this.state.mediaDisabled,\n          [styles.videoShare]: true\n        })}\n        title={\n          this.props.videoShareMediaSource !== null\n            ? \"Stop sharing\"\n            : `Share ${capitalize(primaryVideoShareType)}${this.state.mediaDisabled ? \" Disabled\" : \"\"}`\n        }\n        onClick={this.state.mediaDisabled ? noop : maybeHandlePrimaryShare}\n        onMouseOver={this.state.mediaDisabled ? noop : showExtrasOnHover}\n      >\n        {videoShareExtraOptionTypes.length > 0 && (\n          <div className={cx(styles.videoShareExtraOptions)} onMouseOut={hideExtrasOnOut}>\n            {videoShareExtraOptionTypes.map(type => (\n              <div\n                key={type}\n                className={cx(styles.iconButton, styles[`share_${type}`], {\n                  [styles.active]: this.props.videoShareMediaSource === type,\n                  [styles.disabled]: this.state.mediaDisabled\n                })}\n                title={\n                  this.props.videoShareMediaSource === type\n                    ? \"Stop sharing\"\n                    : `Share ${capitalize(type)}${this.state.mediaDisabled ? \" Disabled\" : \"\"}`\n                }\n                onClick={this.state.mediaDisabled ? noop : () => this.handleVideoShareClicked(type)}\n                onMouseOver={this.state.mediaDisabled ? noop : showExtrasOnHover}\n              />\n            ))}\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  render() {\n    const videoSharingButtons = this.buildVideoSharingButtons();\n    const isMobile = AFRAME.utils.device.isMobile();\n    const tipDivForType = (type, cancelFunc) => (\n      <div className={cx(styles.topTip)}>\n        {cancelFunc && (\n          <button className={styles.tipCancel} onClick={cancelFunc}>\n            <i>\n              <FontAwesomeIcon icon={faTimes} />\n            </i>\n          </button>\n        )}\n        {!this.props.frozen && <div className={cx([styles.attachPoint, styles[`attach_${type.split(\".\")[1]}`]])} />}\n        <FormattedMessage id={`tips.${type}`} />\n      </div>\n    );\n\n    let tip;\n\n    if (this.props.watching) {\n      tip = (\n        <div className={cx([styles.topTip, styles.topTipNoHud])}>\n          <button className={styles.tipCancel} onClick={() => this.props.onWatchEnded()}>\n            <i>\n              <FontAwesomeIcon icon={faTimes} />\n            </i>\n          </button>\n          <FormattedMessage id={`tips.${isMobile ? \"mobile\" : \"desktop\"}.watching`} />\n          {!isMobile && (\n            <button className={styles.tipCancelText} onClick={() => this.props.onWatchEnded()}>\n              <FormattedMessage id=\"tips.watching.back\" />\n            </button>\n          )}\n        </div>\n      );\n    } else if (this.props.showVideoShareFailed) {\n      tip = tipDivForType(`${isMobile ? \"mobile\" : \"desktop\"}.video_share_failed`, this.props.hideVideoShareFailedTip);\n    } else if (this.props.activeTip) {\n      tip = tipDivForType(this.props.activeTip);\n    }\n\n    const micLevel = this.state.micLevel;\n    const micIconClass = this.props.muted ? SPRITESHEET_ICONS.MIC_OFF[micLevel] : SPRITESHEET_ICONS.MIC[micLevel];\n    // Hide buttons when frozen.\n    return (\n      <div className={cx(styles.container, styles.top, styles.unselectable, uiStyles.uiInteractive)}>\n        {this.props.frozen || this.props.watching ? (\n          <div className={cx(uiStyles.uiInteractive, styles.panel)}>{tip}</div>\n        ) : (\n          <div className={cx(uiStyles.uiInteractive, styles.panel)}>\n            {tip}\n            {videoSharingButtons}\n            <div\n              className={cx(styles.iconButton, micIconClass)}\n              title={this.props.muted ? \"Unmute Mic\" : \"Mute Mic\"}\n              onClick={this.props.onToggleMute}\n            />\n            <button\n              className={cx(uiStyles.uiInteractive, styles.iconButton, styles.spawn, {\n                [styles.disabled]: this.state.mediaDisabled\n              })}\n              onClick={\n                this.state.mediaDisabled ? noop : () => this.props.mediaSearchStore.sourceNavigateToDefaultSource()\n              }\n            />\n            {false && <div\n              className={cx(styles.iconButton, styles.pen, {\n                [styles.active]: this.props.isCursorHoldingPen,\n                [styles.disabled]: this.state.penDisabled\n              })}\n              title={`Pen${this.state.penDisabled ? \" Disabled\" : \"\"}`}\n              onClick={this.state.penDisabled ? noop : this.props.onSpawnPen}\n            />}\n            <div\n              className={cx(styles.iconButton, styles.camera, {\n                [styles.active]: this.props.hasActiveCamera,\n                [styles.disabled]: this.state.cameraDisabled\n              })}\n              title={`Camera${this.state.cameraDisabled ? \" Disabled\" : \"\"}`}\n              onClick={this.state.cameraDisabled ? noop : this.props.onSpawnCamera}\n            />\n            <div\n              className={cx(styles.iconButton, styles.fly, { [styles.active]: this.props.flyingEnabled })}\n              title={this.props.flyingEnabled ? \"Disable Flying\" : \"Enable Flying\"}\n              onClick={()=>this.props.onToggleFlying(!this.props.flyingEnabled)}\n            />\n            {!this.state.megaphoneDisabled && <div\n              className={cx(styles.iconButton, styles.megaphone, { [styles.active]: this.props.megaphoneEnabled })}\n              title={this.props.megaphoneEnabled ? \"Disable Megaphone\" : \"Enable Megaphone\"}\n              onClick={()=>this.props.onToggleMegaphone(!this.props.megaphoneEnabled)}\n            />}\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default { TopHUD };\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"../assets/stylesheets/spectating-label.scss\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport class SpectatingLabel extends Component {\n  static propTypes = {\n    name: PropTypes.string\n  };\n\n  render() {\n    return (\n      <div className={styles.label}>\n        <FormattedMessage id=\"lobby.watching\" />\n        <b>{this.props.name}</b>\n      </div>\n    );\n  }\n}\n","import { willRequireUserGesture, showFullScreenIfAvailable } from \"./fullscreen\";\nimport screenfull from \"screenfull\";\n\nlet _isIn2DInterstitial = false;\nlet _exitAction = null;\n\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\n\nconst afterUserGesturePrompt = f => {\n  const scene = document.querySelector(\"a-scene\");\n  scene.addEventListener(\"2d-interstitial-gesture-complete\", f, { once: true });\n  scene.emit(\"2d-interstitial-gesture-required\");\n};\n\nexport function handleExitTo2DInterstitial(isLower, exitAction) {\n  const scene = document.querySelector(\"a-scene\");\n  if (!scene.is(\"vr-mode\")) {\n    if (isMobileVR && willRequireUserGesture()) {\n      afterUserGesturePrompt(() => {\n        showFullScreenIfAvailable();\n      });\n    }\n\n    return;\n  }\n\n  _isIn2DInterstitial = true;\n  _exitAction = exitAction;\n\n  if (isMobileVR) {\n    // Immersive browser, exit VR.\n    scene.exitVR().then(() => {\n      afterUserGesturePrompt(() => {\n        showFullScreenIfAvailable();\n      });\n    });\n  } else {\n    // Non-immersive browser, show notice\n    const vrNotice = document.querySelector(\".vr-notice\");\n    vrNotice.object3D.visible = true;\n    vrNotice.setAttribute(\"follow-in-fov\", {\n      angle: isLower ? 39 : -15\n    });\n  }\n}\n\nexport function exit2DInterstitialAndEnterVR(force) {\n  if (!force && !_isIn2DInterstitial) {\n    return;\n  }\n\n  _isIn2DInterstitial = false;\n\n  document.querySelector(\".vr-notice\").object3D.visible = false;\n\n  const scene = document.querySelector(\"a-scene\");\n\n  if (isMobileVR) {\n    if (screenfull.isFullscreen) {\n      screenfull.exit();\n      afterUserGesturePrompt(() => scene.enterVR());\n    } else {\n      scene.enterVR();\n    }\n  } else {\n    if (!scene.is(\"vr-mode\")) {\n      scene.enterVR();\n    }\n  }\n}\n\nexport function isIn2DInterstitial() {\n  return _isIn2DInterstitial;\n}\n\nexport function forceExitFrom2DInterstitial() {\n  if (!_isIn2DInterstitial) return;\n\n  if (_exitAction) {\n    _exitAction();\n    _exitAction = null;\n  }\n\n  exit2DInterstitialAndEnterVR();\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport copy from \"copy-to-clipboard\";\nimport { getAirtableAssets, airtableAssetsInitialState } from '../everyspace/airtable'\nimport { IntlProvider, FormattedMessage, addLocaleData } from \"react-intl\";\nimport en from \"react-intl/locale-data/en\";\nimport screenfull from \"screenfull\";\nimport { HelmetComponent } from \"../everyspace/helmet\";\nimport { VR_DEVICE_AVAILABILITY } from \"../utils/vr-caps-detect\";\nimport { canShare } from \"../utils/share\";\nimport styles from \"../assets/stylesheets/ui-root.scss\";\nimport entryStyles from \"../assets/stylesheets/entry.scss\";\nimport inviteStyles from \"../assets/stylesheets/invite-dialog.scss\";\nimport { ReactAudioContext, WithHoverSound } from \"./wrap-with-audio\";\nimport {\n  pushHistoryState,\n  clearHistoryState,\n  popToBeginningOfHubHistory,\n  navigateToPriorPage,\n  sluglessPath\n} from \"../utils/history\";\nimport StateLink from \"./state-link.js\";\nimport StateRoute from \"./state-route.js\";\nimport { getPresenceProfileForSession, discordBridgesForPresences } from \"../utils/phoenix-utils\";\nimport { getClientInfoClientId } from \"./client-info-dialog\";\nimport { getCurrentStreamer } from \"../utils/component-utils\";\n\nimport { lang, messages } from \"../utils/i18n\";\nimport Loader from \"./loader\";\nimport AutoExitWarning from \"./auto-exit-warning\";\nimport { TwoDEntryButton, GenericEntryButton, DaydreamEntryButton } from \"./entry-buttons.js\";\nimport ProfileEntryPanel from \"./profile-entry-panel\";\nimport MediaBrowser from \"./media-browser\";\n\nimport CreateObjectDialog from \"./create-object-dialog.js\";\nimport ChangeSceneDialog from \"./change-scene-dialog.js\";\nimport AvatarUrlDialog from \"./avatar-url-dialog.js\";\nimport HelpDialog from \"./help-dialog.js\";\nimport InviteDialog from \"./invite-dialog.js\";\nimport InviteTeamDialog from \"./invite-team-dialog.js\";\nimport LinkDialog from \"./link-dialog.js\";\nimport SafariDialog from \"./safari-dialog.js\";\nimport SafariMicDialog from \"./safari-mic-dialog.js\";\nimport SignInDialog from \"./sign-in-dialog.js\";\nimport RoomSettingsDialog from \"./room-settings-dialog.js\";\nimport CloseRoomDialog from \"./close-room-dialog.js\";\nimport Tip from \"./tip.js\";\nimport WebRTCScreenshareUnsupportedDialog from \"./webrtc-screenshare-unsupported-dialog.js\";\nimport WebAssemblyUnsupportedDialog from \"./webassembly-unsupported-dialog.js\";\nimport WebVRRecommendDialog from \"./webvr-recommend-dialog.js\";\nimport FeedbackDialog from \"./feedback-dialog.js\";\nimport LeaveRoomDialog from \"./leave-room-dialog.js\";\nimport RoomInfoDialog from \"./room-info-dialog.js\";\nimport ClientInfoDialog from \"./client-info-dialog.js\";\nimport OAuthDialog from \"./oauth-dialog.js\";\nimport TweetDialog from \"./tweet-dialog.js\";\nimport LobbyChatBox from \"./lobby-chat-box.js\";\nimport InWorldChatBox from \"./in-world-chat-box.js\";\nimport AvatarEditor from \"./avatar-editor\";\nimport MicLevelWidget from \"./mic-level-widget.js\";\nimport OutputLevelWidget from \"./output-level-widget.js\";\nimport PresenceLog from \"./presence-log.js\";\nimport PresenceList from \"./presence-list.js\";\nimport SettingsMenu from \"./settings-menu.js\";\nimport PreloadOverlay from \"./preload-overlay.js\";\nimport TwoDHUD from \"./2d-hud\";\nimport { SpectatingLabel } from \"./spectating-label\";\nimport { showFullScreenIfAvailable, showFullScreenIfWasFullScreen } from \"../utils/fullscreen\";\nimport { exit2DInterstitialAndEnterVR, isIn2DInterstitial } from \"../utils/vr-interstitial\";\n\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport { faStar } from \"@fortawesome/free-solid-svg-icons/faStar\";\nimport { faArrowLeft } from \"@fortawesome/free-solid-svg-icons/faArrowLeft\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nimport qsTruthy from \"../utils/qs_truthy\";\nconst avatarEditorDebug = qsTruthy(\"avatarEditorDebug\");\n\naddLocaleData([...en]);\n\n// This is a list of regexes that match the microphone labels of HMDs.\n//\n// If entering VR mode, and if any of these regexes match an audio device,\n// the user will be prevented from entering VR until one of those devices is\n// selected as the microphone.\n//\n// Note that this doesn't have to be exhaustive: if no devices match any regex\n// then we rely upon the user to select the proper mic.\nconst HMD_MIC_REGEXES = [/\\Wvive\\W/i, /\\Wrift\\W/i];\n\nconst IN_ROOM_MODAL_ROUTER_PATHS = [\"/media\"];\nconst IN_ROOM_MODAL_QUERY_VARS = [\"media_source\"];\n\nconst LOBBY_MODAL_ROUTER_PATHS = [\"/media/scenes\", \"/media/avatars\", \"/media/favorites\"];\nconst LOBBY_MODAL_QUERY_VARS = [\"media_source\"];\nconst LOBBY_MODAL_QUERY_VALUES = [\"scenes\", \"avatars\", \"favorites\"];\n\nasync function grantedMicLabels() {\n  const mediaDevices = await navigator.mediaDevices.enumerateDevices();\n  return mediaDevices.filter(d => d.label && d.kind === \"audioinput\").map(d => d.label);\n}\n\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\nconst isMobilePhoneOrVR = isMobile || isMobileVR;\n\nconst AUTO_EXIT_TIMER_SECONDS = 10;\n\nclass UIRoot extends Component {\n  willCompileAndUploadMaterials = false;\n\n  static propTypes = {\n    enterScene: PropTypes.func,\n    exitScene: PropTypes.func,\n    onSendMessage: PropTypes.func,\n    disableAutoExitOnConcurrentLoad: PropTypes.bool,\n    forcedVREntryType: PropTypes.string,\n    isBotMode: PropTypes.bool,\n    store: PropTypes.object,\n    mediaSearchStore: PropTypes.object,\n    scene: PropTypes.object,\n    authChannel: PropTypes.object,\n    hubChannel: PropTypes.object,\n    linkChannel: PropTypes.object,\n    hubEntryCode: PropTypes.number,\n    availableVREntryTypes: PropTypes.object,\n    environmentSceneLoaded: PropTypes.bool,\n    roomUnavailableReason: PropTypes.string,\n    platformUnsupportedReason: PropTypes.string,\n    hubId: PropTypes.string,\n    hubName: PropTypes.string,\n    hubMemberPermissions: PropTypes.object,\n    hubScene: PropTypes.object,\n    hubIsBound: PropTypes.bool,\n    isSupportAvailable: PropTypes.bool,\n    presenceLogEntries: PropTypes.array,\n    presences: PropTypes.object,\n    sessionId: PropTypes.string,\n    subscriptions: PropTypes.object,\n    initialIsSubscribed: PropTypes.bool,\n    initialIsFavorited: PropTypes.bool,\n    showSignInDialog: PropTypes.bool,\n    signInMessageId: PropTypes.string,\n    signInCompleteMessageId: PropTypes.string,\n    signInContinueTextId: PropTypes.string,\n    onContinueAfterSignIn: PropTypes.func,\n    showSafariDialog: PropTypes.bool,\n    showSafariMicDialog: PropTypes.bool,\n    showWebAssemblyDialog: PropTypes.bool,\n    showOAuthDialog: PropTypes.bool,\n    onCloseOAuthDialog: PropTypes.func,\n    oauthInfo: PropTypes.array,\n    isCursorHoldingPen: PropTypes.bool,\n    hasActiveCamera: PropTypes.bool,\n    onMediaSearchResultEntrySelected: PropTypes.func,\n    onAvatarSaved: PropTypes.func,\n    activeTips: PropTypes.object,\n    location: PropTypes.object,\n    history: PropTypes.object,\n    showInterstitialPrompt: PropTypes.bool,\n    onInterstitialPromptClicked: PropTypes.func,\n    performConditionalSignIn: PropTypes.func,\n    hide: PropTypes.bool,\n    showPreload: PropTypes.bool,\n    onPreloadLoadClicked: PropTypes.func,\n    embed: PropTypes.bool,\n    embedToken: PropTypes.string,\n    onLoaded: PropTypes.func\n  };\n\n  state = {\n    enterInVR: false,\n    muteOnEntry: false,\n    entered: false,\n    dialog: null,\n    showShareDialog: false,\n    broadcastTipDismissed: false,\n    linkCode: null,\n    linkCodeCancel: null,\n    miniInviteActivated: false,\n\n    didConnectToNetworkedScene: false,\n    noMoreLoadingUpdates: false,\n    hideLoader: false,\n    watching: false,\n    isStreaming: false,\n    showStreamingTip: false,\n\n    waitingOnAudio: false,\n    mediaStream: null,\n    audioTrack: null,\n    micDevices: [],\n\n    autoExitTimerStartedAt: null,\n    autoExitTimerInterval: null,\n    secondsRemainingBeforeAutoExit: Infinity,\n\n    muted: false,\n    flyingEnabled: false,\n    frozen: false,\n\n    exited: false,\n\n    signedIn: false,\n    videoShareMediaSource: null,\n    showVideoShareFailed: false\n  };\n\n  constructor(props) {\n    super(props);\n    if (props.showSafariMicDialog) {\n      this.state.dialog = <SafariMicDialog closable={false} />;\n    }\n    if (props.showSafariDialog) {\n      this.state.dialog = <SafariDialog closable={false} />;\n    }\n    if (props.showWebAssemblyDialog) {\n      this.state.dialog = <WebAssemblyUnsupportedDialog closable={false} />;\n    }\n\n    props.mediaSearchStore.setHistory(props.history);\n\n    // An exit handler that discards event arguments and can be cleaned up.\n    this.exitEventHandler = () => this.exit();\n\n    this.state.airtableAssets = airtableAssetsInitialState;\n  }\n\n  componentDidUpdate(prevProps) {\n    const { hubChannel, showSignInDialog } = this.props;\n    if (hubChannel) {\n      const { signedIn } = hubChannel;\n      if (signedIn !== this.state.signedIn) {\n        this.setState({ signedIn });\n      }\n    }\n    if (prevProps.showSignInDialog !== showSignInDialog) {\n      if (showSignInDialog) {\n        this.showContextualSignInDialog();\n      } else {\n        this.closeDialog();\n      }\n    }\n    if (!this.willCompileAndUploadMaterials && this.state.noMoreLoadingUpdates) {\n      this.willCompileAndUploadMaterials = true;\n      // We want to ensure that react and the browser have had the chance to render / update.\n      // See https://stackoverflow.com/a/34999925 , although our solution flipped setTimeout and requestAnimationFrame\n      window.requestAnimationFrame(() => {\n        window.setTimeout(() => {\n          if (!this.props.isBotMode) {\n            this.props.scene.renderer.compileAndUploadMaterials(this.props.scene.object3D, this.props.scene.camera);\n          }\n\n          if (!this.state.hideLoader) {\n            this.setState({ hideLoader: true });\n          }\n        }, 0);\n      });\n    }\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"concurrentload\", this.onConcurrentLoad);\n    document.querySelector(\".a-canvas\").addEventListener(\"mouseup\", () => {\n      if (this.state.showShareDialog) {\n        this.setState({ showShareDialog: false });\n      }\n    });\n\n    this.props.scene.addEventListener(\n      \"didConnectToNetworkedScene\",\n      () => {\n        this.setState({ didConnectToNetworkedScene: true });\n      },\n      { once: true }\n    );\n    this.props.scene.addEventListener(\"loaded\", this.onSceneLoaded);\n    this.props.scene.addEventListener(\"stateadded\", this.onAframeStateChanged);\n    this.props.scene.addEventListener(\"stateremoved\", this.onAframeStateChanged);\n    this.props.scene.addEventListener(\"share_video_enabled\", this.onShareVideoEnabled);\n    this.props.scene.addEventListener(\"share_video_disabled\", this.onShareVideoDisabled);\n    this.props.scene.addEventListener(\"share_video_failed\", this.onShareVideoFailed);\n    this.props.scene.addEventListener(\"exit\", this.exitEventHandler);\n    this.props.scene.addEventListener(\"action_exit_watch\", () => this.setState({ watching: false, hide: false }));\n\n    const scene = this.props.scene;\n\n    this.props.store.addEventListener(\"statechanged\", this.onStoreChanged);\n\n    const unsubscribe = this.props.history.listen((location, action) => {\n      const state = location.state;\n\n      // If we just hit back into the entry flow, just go back to the page before the room landing page.\n      if (action === \"POP\" && state && state.entry_step && this.state.entered) {\n        unsubscribe();\n        navigateToPriorPage(this.props.history);\n        return;\n      }\n    });\n\n    // If we refreshed the page with any state history (eg if we were in the entry flow\n    // or had a modal/overlay open) just reset everything to the beginning of the flow by\n    // erasing all history that was accumulated for this room (including across refreshes.)\n    //\n    // We don't do this for the media browser case, since we want to be able to share\n    // links to the browser pages\n    if (this.props.history.location.state && !sluglessPath(this.props.history.location).startsWith(\"/media\")) {\n      popToBeginningOfHubHistory(this.props.history);\n    }\n\n    this.setState({\n      audioContext: {\n        playSound: sound => {\n          scene.emit(sound);\n        },\n        onMouseLeave: () => {\n          //          scene.emit(\"play_sound-hud_mouse_leave\");\n        }\n      }\n    });\n\n    if (this.props.forcedVREntryType && this.props.forcedVREntryType.endsWith(\"_now\")) {\n      setTimeout(() => this.handleForceEntry(), 2000);\n    }\n\n    this.fetchAirtableAssets()\n  }\n\n  fetchAirtableAssets = async () => {\n    const airtableAssets = await getAirtableAssets()\n    if (airtableAssets) this.setState({ airtableAssets })\n  }\n\n  componentWillUnmount() {\n    this.props.scene.removeEventListener(\"loaded\", this.onSceneLoaded);\n    this.props.scene.removeEventListener(\"exit\", this.exitEventHandler);\n    this.props.scene.removeEventListener(\"share_video_enabled\", this.onShareVideoEnabled);\n    this.props.scene.removeEventListener(\"share_video_disabled\", this.onShareVideoDisabled);\n    this.props.scene.removeEventListener(\"share_video_failed\", this.onShareVideoFailed);\n  }\n\n  // SignInDialog = ({onClose, message, onSignIn}) => <SignInDialog onClose={onClose} message={message} onSignIn={onSignIn} privacyLink={this.state.airtableAssets.Privacy_Link} termsLink={this.state.airtableAssets.Terms_Link} />\n\n  showContextualSignInDialog = () => {\n    const {\n      signInMessageId,\n      authChannel,\n      signInCompleteMessageId,\n      signInContinueTextId,\n      onContinueAfterSignIn\n    } = this.props;\n\n    this.showNonHistoriedDialog(SignInDialog, {\n      message: messages[signInMessageId],\n      onSignIn: async email => {\n        const { authComplete } = await authChannel.startAuthentication(email, this.props.hubChannel);\n\n        this.showNonHistoriedDialog(SignInDialog, { authStarted: true, onClose: onContinueAfterSignIn });\n\n        await authComplete;\n\n        this.setState({ signedIn: true });\n        this.showNonHistoriedDialog(SignInDialog, {\n          authComplete: true,\n          message: messages[signInCompleteMessageId],\n          continueText: messages[signInContinueTextId],\n          onClose: onContinueAfterSignIn,\n          onContinue: onContinueAfterSignIn\n        });\n      },\n      onClose: onContinueAfterSignIn\n    });\n  };\n\n  updateSubscribedState = () => {\n    const isSubscribed = this.props.subscriptions && this.props.subscriptions.isSubscribed();\n    this.setState({ isSubscribed });\n  };\n\n  toggleFavorited = () => {\n    this.props.performConditionalSignIn(\n      () => this.props.hubChannel.signedIn,\n      () => {\n        const isFavorited = this.isFavorited();\n\n        this.props.hubChannel[isFavorited ? \"unfavorite\" : \"favorite\"]();\n        this.setState({ isFavorited: !isFavorited });\n      },\n      \"favorite-room\"\n    );\n  };\n\n  isFavorited = () => {\n    return this.state.isFavorited !== undefined ? this.state.isFavorited : this.props.initialIsFavorited;\n  };\n\n  onLoadingFinished = () => {\n    this.setState({ noMoreLoadingUpdates: true });\n\n    if (this.props.onLoaded) {\n      this.props.onLoaded();\n    }\n  };\n\n  onSceneLoaded = () => {\n    this.setState({ sceneLoaded: true });\n  };\n\n  // TODO: we need to come up with a cleaner way to handle the shared state between aframe and react than emmitting events and setting state on the scene\n  onAframeStateChanged = e => {\n    if (!(e.detail === \"muted\" || e.detail === \"frozen\")) return;\n    this.setState({\n      [e.detail]: this.props.scene.is(e.detail)\n    });\n  };\n\n  onShareVideoEnabled = e => {\n    this.setState({ videoShareMediaSource: e.detail.source });\n  };\n\n  onShareVideoDisabled = () => {\n    this.setState({ videoShareMediaSource: null });\n  };\n\n  onShareVideoFailed = () => {\n    this.setState({ showVideoShareFailed: true });\n  };\n\n  toggleMute = () => {\n    this.props.scene.emit(\"action_mute\");\n  };\n\n  toggleMegaphone = () => {\n    this.props.scene.emit(\"action_megaphone\");\n  };\n\n  toggleMegaphone = enable => {\n    const playerRig = document.querySelector(\"#player-rig\");\n    const enabled = playerRig.getAttribute(\"player-info\").megaphoneEnabled;\n    playerRig.setAttribute(\"player-info\", \"megaphoneEnabled\", !enabled);  \n    this.setState({megaphoneEnabled: !enabled})\n  }\n\n  toggleFreeze = () => {\n    this.props.scene.emit(\"action_freeze\");\n  };\n\n  shareVideo = mediaSource => {\n    this.props.scene.emit(`action_share_${mediaSource}`);\n  };\n\n  endShareVideo = () => {\n    this.props.scene.emit(\"action_end_video_sharing\");\n  };\n\n  spawnPen = () => {\n    this.props.scene.emit(\"penButtonPressed\");\n  };\n\n  onSubscribeChanged = async () => {\n    if (!this.props.subscriptions) return;\n\n    await this.props.subscriptions.toggle();\n    this.updateSubscribedState();\n  };\n\n  handleForceEntry = () => {\n    if (!this.props.forcedVREntryType) return;\n\n    if (this.props.forcedVREntryType.startsWith(\"daydream\")) {\n      this.enterDaydream();\n    } else if (this.props.forcedVREntryType.startsWith(\"vr\")) {\n      this.enterVR();\n    } else if (this.props.forcedVREntryType.startsWith(\"2d\")) {\n      this.enter2D();\n    }\n  };\n\n  onConcurrentLoad = () => {\n    if (this.props.disableAutoExitOnConcurrentLoad) return;\n\n    const autoExitTimerInterval = setInterval(() => {\n      let secondsRemainingBeforeAutoExit = Infinity;\n\n      if (this.state.autoExitTimerStartedAt) {\n        const secondsSinceStart = (new Date() - this.state.autoExitTimerStartedAt) / 1000;\n        secondsRemainingBeforeAutoExit = Math.max(0, Math.floor(AUTO_EXIT_TIMER_SECONDS - secondsSinceStart));\n      }\n\n      this.setState({ secondsRemainingBeforeAutoExit });\n      this.checkForAutoExit();\n    }, 500);\n\n    this.setState({ autoExitTimerStartedAt: new Date(), autoExitTimerInterval });\n  };\n\n  checkForAutoExit = () => {\n    if (this.state.secondsRemainingBeforeAutoExit !== 0) return;\n    this.endAutoExitTimer();\n    this.exit();\n  };\n\n  exit = reason => {\n    this.props.exitScene(reason);\n    this.setState({ exited: true });\n  };\n\n  isWaitingForAutoExit = () => {\n    return this.state.secondsRemainingBeforeAutoExit <= AUTO_EXIT_TIMER_SECONDS;\n  };\n\n  endAutoExitTimer = () => {\n    clearInterval(this.state.autoExitTimerInterval);\n    this.setState({\n      autoExitTimerStartedAt: null,\n      autoExitTimerInterval: null,\n      secondsRemainingBeforeAutoExit: Infinity\n    });\n  };\n\n  performDirectEntryFlow = async enterInVR => {\n    this.setState({ enterInVR, waitingOnAudio: true });\n\n    const hasGrantedMic = (await grantedMicLabels()).length > 0;\n\n    if (hasGrantedMic) {\n      await this.setMediaStreamToDefault();\n      this.beginOrSkipAudioSetup();\n    } else {\n      this.pushHistoryState(\"entry_step\", \"mic_grant\");\n    }\n\n    this.setState({ waitingOnAudio: false });\n  };\n\n  enter2D = async () => {\n    await this.performDirectEntryFlow(false);\n  };\n\n  enterVR = async () => {\n    if (this.props.forcedVREntryType || this.props.availableVREntryTypes.generic !== VR_DEVICE_AVAILABILITY.maybe) {\n      await this.performDirectEntryFlow(true);\n    } else {\n      this.pushHistoryState(\"modal\", \"webvr\");\n    }\n  };\n\n  enterDaydream = async () => {\n    await this.performDirectEntryFlow(true);\n  };\n\n  micDeviceChanged = async ev => {\n    const constraints = { audio: { deviceId: { exact: [ev.target.value] } } };\n    await this.fetchAudioTrack(constraints);\n    await this.setupNewMediaStream();\n  };\n\n  setMediaStreamToDefault = async () => {\n    let hasAudio = false;\n    const { lastUsedMicDeviceId } = this.props.store.state.settings;\n\n    // Try to fetch last used mic, if there was one.\n    if (lastUsedMicDeviceId) {\n      hasAudio = await this.fetchAudioTrack({ audio: { deviceId: { ideal: lastUsedMicDeviceId } } });\n    } else {\n      hasAudio = await this.fetchAudioTrack({ audio: true });\n    }\n\n    await this.setupNewMediaStream();\n\n    return { hasAudio };\n  };\n\n  fetchAudioTrack = async constraints => {\n    if (this.state.audioTrack) {\n      this.state.audioTrack.stop();\n    }\n\n    try {\n      const mediaStream = await navigator.mediaDevices.getUserMedia(constraints);\n      const audioTrack = mediaStream.getAudioTracks()[0];\n      this.setState({ audioTrack });\n\n      if (/Oculus/.test(navigator.userAgent)) {\n        // HACK Oculus Browser 6 seems to randomly end the microphone audio stream. This re-creates it.\n        // Note the ended event will only fire if some external event ends the stream, not if we call stop().\n        const recreateAudioStream = async () => {\n          console.warn(\n            \"Oculus Browser 6 bug hit: Audio stream track ended without calling stop. Recreating audio stream.\"\n          );\n\n          const mediaStream = await navigator.mediaDevices.getUserMedia(constraints);\n          const audioTrack = mediaStream.getAudioTracks()[0];\n          NAF.connection.adapter.setLocalMediaStream(mediaStream);\n          audioTrack.addEventListener(\"ended\", recreateAudioStream, { once: true });\n        };\n\n        audioTrack.addEventListener(\"ended\", recreateAudioStream, { once: true });\n      }\n\n      return true;\n    } catch (e) {\n      // Error fetching audio track, most likely a permission denial.\n      this.setState({ audioTrack: null });\n      return false;\n    }\n  };\n\n  setupNewMediaStream = async () => {\n    const mediaStream = new MediaStream();\n\n    await this.fetchMicDevices();\n\n    // we should definitely have an audioTrack at this point unless they denied mic access\n    if (this.state.audioTrack) {\n      mediaStream.addTrack(this.state.audioTrack);\n      const micDeviceId = this.micDeviceIdForMicLabel(this.micLabelForMediaStream(mediaStream));\n      if (micDeviceId) {\n        this.props.store.update({ settings: { lastUsedMicDeviceId: micDeviceId } });\n      }\n      const mediaStreamForMicAnalysis = new MediaStream();\n      mediaStreamForMicAnalysis.addTrack(this.state.audioTrack.clone());\n      this.props.scene.emit(\"local-media-stream-created\", { mediaStream: mediaStreamForMicAnalysis });\n    }\n\n    this.setState({ mediaStream });\n  };\n\n  onMicGrantButton = async () => {\n    if (this.props.location.state && this.props.location.state.entry_step === \"mic_grant\") {\n      const { hasAudio } = await this.setMediaStreamToDefault();\n\n      if (hasAudio) {\n        this.pushHistoryState(\"entry_step\", \"mic_granted\");\n      } else {\n        this.beginOrSkipAudioSetup();\n      }\n    } else {\n      this.beginOrSkipAudioSetup();\n    }\n  };\n\n  beginOrSkipAudioSetup = () => {\n    const skipAudioSetup = this.props.forcedVREntryType && this.props.forcedVREntryType.endsWith(\"_now\");\n\n    if (skipAudioSetup) {\n      this.onAudioReadyButton();\n    } else {\n      this.pushHistoryState(\"entry_step\", \"audio\");\n    }\n  };\n\n  fetchMicDevices = () => {\n    return new Promise(resolve => {\n      navigator.mediaDevices.enumerateDevices().then(mediaDevices => {\n        this.setState(\n          {\n            micDevices: mediaDevices\n              .filter(d => d.kind === \"audioinput\")\n              .map(d => ({ deviceId: d.deviceId, label: d.label }))\n          },\n          resolve\n        );\n      });\n    });\n  };\n\n  shouldShowHmdMicWarning = () => {\n    if (isMobile || AFRAME.utils.device.isMobileVR()) return false;\n    if (!this.state.enterInVR) return false;\n    if (!this.hasHmdMicrophone()) return false;\n\n    return !HMD_MIC_REGEXES.find(r => this.selectedMicLabel().match(r));\n  };\n\n  hasHmdMicrophone = () => {\n    return !!this.state.micDevices.find(d => HMD_MIC_REGEXES.find(r => d.label.match(r)));\n  };\n\n  micLabelForMediaStream = mediaStream => {\n    return (mediaStream && mediaStream.getAudioTracks().length > 0 && mediaStream.getAudioTracks()[0].label) || \"\";\n  };\n\n  selectedMicLabel = () => {\n    return this.micLabelForMediaStream(this.state.mediaStream);\n  };\n\n  micDeviceIdForMicLabel = label => {\n    return this.state.micDevices.filter(d => d.label === label).map(d => d.deviceId)[0];\n  };\n\n  selectedMicDeviceId = () => {\n    return this.micDeviceIdForMicLabel(this.selectedMicLabel());\n  };\n\n  shouldShowFullScreen = () => {\n    // Disable full screen on iOS, since Safari's fullscreen mode does not let you prevent native pinch-to-zoom gestures.\n    return (\n      (isMobile || AFRAME.utils.device.isMobileVR()) &&\n      !AFRAME.utils.device.isIOS() &&\n      !this.state.enterInVR &&\n      screenfull.enabled\n    );\n  };\n\n  onAudioReadyButton = () => {\n    if (!this.state.enterInVR) {\n      showFullScreenIfAvailable();\n    }\n\n    this.props.enterScene(this.state.mediaStream, this.state.enterInVR, this.state.muteOnEntry);\n\n    const mediaStream = this.state.mediaStream;\n\n    if (mediaStream) {\n      if (mediaStream.getAudioTracks().length > 0) {\n        console.log(`Using microphone: ${mediaStream.getAudioTracks()[0].label}`);\n      }\n\n      if (mediaStream.getVideoTracks().length > 0) {\n        console.log(\"Screen sharing enabled.\");\n      }\n    }\n\n    this.setState({ entered: true, showShareDialog: false });\n    clearHistoryState(this.props.history);\n  };\n\n  attemptLink = async () => {\n    this.pushHistoryState(\"overlay\", \"link\");\n    const { code, cancel, onFinished } = await this.props.linkChannel.generateCode();\n    this.setState({ linkCode: code, linkCodeCancel: cancel });\n    onFinished.then(() => {\n      this.setState({ log: false, linkCode: null, linkCodeCancel: null });\n      this.props.history.goBack();\n    });\n  };\n\n  showShareDialog = () => {\n    this.props.store.update({ activity: { hasOpenedShare: true } });\n    this.setState({ showShareDialog: true });\n  };\n\n  toggleShareDialog = async () => {\n    this.props.store.update({ activity: { hasOpenedShare: true } });\n    this.setState({ showShareDialog: !this.state.showShareDialog });\n  };\n\n  createObject = media => {\n    this.props.scene.emit(\"add_media\", media);\n  };\n\n  changeScene = url => {\n    this.props.hubChannel.updateScene(url);\n  };\n\n  setAvatarUrl = url => {\n    this.props.store.update({ profile: { ...this.props.store.state.profile, ...{ avatarId: url } } });\n  };\n\n  closeDialog = () => {\n    if (this.state.dialog) {\n      this.setState({ dialog: null });\n    } else {\n      this.props.history.goBack();\n    }\n\n    if (isIn2DInterstitial()) {\n      exit2DInterstitialAndEnterVR();\n    } else {\n      showFullScreenIfWasFullScreen();\n    }\n  };\n\n  showNonHistoriedDialog = (DialogClass, props = {}) => {\n    this.setState({\n      dialog: <DialogClass {...{ onClose: this.closeDialog, ...props }} />\n    });\n  };\n\n  toggleStreamerMode = enable => {\n    const playerRig = document.querySelector(\"#player-rig\");\n    playerRig.setAttribute(\"character-controller\", \"fly\", enable);\n\n    if (enable) {\n      this.props.hubChannel.beginStreaming();\n      this.setState({ isStreaming: true, showStreamingTip: true });\n    } else {\n      this.props.hubChannel.endStreaming();\n      this.setState({ isStreaming: false });\n    }\n  };\n\n  toggleFlyMode = enable => {\n    const playerRig = document.querySelector(\"#player-rig\");\n    playerRig.setAttribute(\"character-controller\", \"fly\", enable);  \n    this.setState({flyingEnabled: enable})\n  }\n\n  renderDialog = (DialogClass, props = {}) => <DialogClass {...{ onClose: this.closeDialog, ...props }} />;\n\n  showSignInDialog = () => {\n    this.showNonHistoriedDialog(SignInDialog, {\n      message: messages[\"sign-in.prompt\"],\n      onSignIn: async email => {\n        const { authComplete } = await this.props.authChannel.startAuthentication(email, this.props.hubChannel);\n\n        this.showNonHistoriedDialog(SignInDialog, { authStarted: true });\n\n        await authComplete;\n\n        this.setState({ signedIn: true });\n        this.closeDialog();\n      }\n    });\n  };\n\n  signOut = async () => {\n    await this.props.authChannel.signOut(this.props.hubChannel);\n    this.setState({ signedIn: false });\n  };\n\n  showWebRTCScreenshareUnsupportedDialog = () => {\n    this.pushHistoryState(\"modal\", \"webrtc-screenshare\");\n  };\n\n  onMiniInviteClicked = () => {\n    const link = \"https://hub.link/\" + this.props.hubId;\n\n    this.setState({ miniInviteActivated: true });\n    setTimeout(() => {\n      this.setState({ miniInviteActivated: false });\n    }, 5000);\n\n    if (canShare()) {\n      navigator.share({ title: document.title, url: link });\n    } else {\n      copy(link);\n    }\n  };\n\n  sendMessage = msg => {\n    this.props.onSendMessage(msg);\n  };\n\n  occupantCount = () => {\n    return this.props.presences ? Object.entries(this.props.presences).length : 0;\n  };\n\n  onStoreChanged = () => {\n    const broadcastedRoomConfirmed = this.props.store.state.confirmedBroadcastedRooms.includes(this.props.hubId);\n    if (broadcastedRoomConfirmed !== this.state.broadcastTipDismissed) {\n      this.setState({ broadcastTipDismissed: broadcastedRoomConfirmed });\n    }\n  };\n\n  confirmBroadcastedRoom = () => {\n    this.props.store.update({ confirmedBroadcastedRooms: [this.props.hubId] });\n  };\n\n  discordBridges = () => {\n    if (!this.props.presences) {\n      return [];\n    } else {\n      return discordBridgesForPresences(this.props.presences);\n    }\n  };\n\n  hasEmbedPresence = () => {\n    if (!this.props.presences) {\n      return false;\n    } else {\n      for (const p of Object.values(this.props.presences)) {\n        for (const m of p.metas) {\n          if (m.context && m.context.embed) {\n            return true;\n          }\n        }\n      }\n    }\n\n    return false;\n  };\n\n  pushHistoryState = (k, v) => pushHistoryState(this.props.history, k, v);\n\n  renderInterstitialPrompt = () => {\n    return (\n      <IntlProvider locale={lang} messages={messages}>\n        <div className={styles.interstitial} onClick={() => this.props.onInterstitialPromptClicked()}>\n          <div>\n            <FormattedMessage id=\"interstitial.prompt\" />\n          </div>\n        </div>\n      </IntlProvider>\n    );\n  };\n\n  renderExitedPane = () => {\n    let subtitle = null;\n    if (this.props.roomUnavailableReason === \"closed\") {\n      // TODO i18n, due to links and markup\n      subtitle = (\n        <div>\n          Sorry, this room is no longer available.\n          <p />A room may be closed if we receive reports that it violates our{\" \"}\n          <WithHoverSound>\n            <a target=\"_blank\" rel=\"noreferrer noopener\" href=\"https://github.com/mozilla/hubs/blob/master/TERMS.md\">\n              Terms of Use\n            </a>\n          </WithHoverSound>\n          .<br />\n          If you have questions, contact us at{\" \"}\n          <WithHoverSound>\n            <a href=\"mailto:hubs@mozilla.com\">hubs@mozilla.com</a>\n          </WithHoverSound>\n          .<p />\n          If you&apos;d like to run your own server, hubs&apos;s source code is available on{\" \"}\n          <WithHoverSound>\n            <a href=\"https://github.com/mozilla/hubs\">GitHub</a>\n          </WithHoverSound>\n          .\n        </div>\n      );\n    } else if (this.props.platformUnsupportedReason === \"no_data_channels\") {\n      // TODO i18n, due to links and markup\n      subtitle = (\n        <div>\n          Your browser does not support{\" \"}\n          <WithHoverSound>\n            <a\n              href=\"https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/createDataChannel#Browser_compatibility\"\n              rel=\"noreferrer noopener\"\n            >\n              WebRTC Data Channels\n            </a>\n          </WithHoverSound>\n          , which is required to use Hubs.\n          <br />\n          If you&quot;d like to use Hubs with Oculus or SteamVR, you can{\" \"}\n          <WithHoverSound>\n            <a href=\"https://www.mozilla.org/firefox\" rel=\"noreferrer noopener\">\n              Download Firefox\n            </a>\n          </WithHoverSound>\n          .\n        </div>\n      );\n    } else {\n      const reason = this.props.roomUnavailableReason || this.props.platformUnsupportedReason;\n      const exitSubtitleId = `exit.subtitle.${reason || \"exited\"}`;\n      subtitle = (\n        <div>\n          <FormattedMessage id={exitSubtitleId} />\n          <p />\n          {![\"left\", \"disconnected\"].includes(this.props.roomUnavailableReason) && (\n            <div>\n              You can also{\" \"}\n              <WithHoverSound>\n                <a href=\"/\">create a new room</a>\n              </WithHoverSound>\n              .\n            </div>\n          )}\n        </div>\n      );\n    }\n\n    return (\n      <IntlProvider locale={lang} messages={messages}>\n        <div className=\"exited-panel\">\n          <img className=\"exited-panel__logo\" src=\"../assets/images/logo.svg\" />\n          <div className=\"exited-panel__subtitle\">{subtitle}</div>\n        </div>\n      </IntlProvider>\n    );\n  };\n\n  renderBotMode = () => {\n    return (\n      <div className=\"loading-panel\">\n        <img className=\"loading-panel__logo\" src=\"../assets/images/logo.svg\" />\n        <input type=\"file\" id=\"bot-audio-input\" accept=\"audio/*\" />\n        <input type=\"file\" id=\"bot-data-input\" accept=\"application/json\" />\n      </div>\n    );\n  };\n\n  renderEntryStartPanel = () => {\n    const { hasAcceptedProfile, hasChangedName } = this.props.store.state.activity;\n    const promptForNameAndAvatarBeforeEntry = this.props.hubIsBound ? !hasAcceptedProfile : !hasChangedName;\n\n    return (\n      <div className={entryStyles.entryPanel}>\n        <div className={entryStyles.name}>\n\n          <span>{this.props.hubName}</span>\n\n          {false && this.props.hubChannel.canOrWillIfCreator(\"update_hub\") ? (\n\n            <button\n              className={entryStyles.renameButton}\n              onClick={() =>\n                this.props.performConditionalSignIn(\n                  () => this.props.hubChannel.can(\"update_hub\"),\n                  () => this.pushHistoryState(\"modal\", \"room_settings\"),\n                  \"room-settings\"\n                )\n              }\n            >\n              {this.props.hubName}\n            </button>\n          ) : false ? (\n            <span>{this.props.hubName}</span>\n          ) : <span />}\n          <button onClick={() => this.setState({ watching: true })} className={entryStyles.collapseButton}>\n            <i>\n              <FontAwesomeIcon icon={faTimes} />\n            </i>\n          </button>\n\n          {false && <button\n            onClick={() => this.toggleFavorited()}\n            className={classNames({\n              [entryStyles.entryFavoriteButton]: true,\n              [entryStyles.favoriteButton]: true,\n              [entryStyles.favorited]: this.isFavorited()\n            })}\n          >\n            <i title=\"Favorite\">\n              <FontAwesomeIcon icon={faStar} />\n            </i>\n          </button>}\n        </div>\n\n        <div className={entryStyles.roomSubtitle}>\n          <FormattedMessage id=\"entry.lobby\" />\n        </div>\n\n        <div className={entryStyles.center}>\n\n          <LobbyChatBox\n            occupantCount={this.occupantCount()}\n            discordBridges={this.discordBridges()}\n            onSendMessage={this.sendMessage}\n          />\n        </div>\n\n        {!this.state.waitingOnAudio ? (\n          <div className={entryStyles.buttonContainer}>\n            {!isMobileVR && (\n              <a\n                onClick={e => {\n                  e.preventDefault();\n                  this.attemptLink();\n                }}\n                className={classNames([entryStyles.secondaryActionButton, entryStyles.wideButton])}\n              >\n                <FormattedMessage id=\"entry.device-medium\" />\n                <div className={entryStyles.buttonSubtitle}>\n                  <FormattedMessage id={isMobile ? \"entry.device-subtitle-mobile\" : \"entry.device-subtitle-desktop\"} />\n                </div>\n              </a>\n            )}\n            {promptForNameAndAvatarBeforeEntry || !this.props.forcedVREntryType ? (\n              <StateLink\n                stateKey=\"entry_step\"\n                stateValue={promptForNameAndAvatarBeforeEntry ? \"profile\" : \"device\"}\n                history={this.props.history}\n                className={classNames([entryStyles.actionButton, entryStyles.wideButton])}\n              >\n                <FormattedMessage id=\"entry.enter-room\" />\n              </StateLink>\n            ) : (\n              <a\n                onClick={e => {\n                  e.preventDefault();\n                  this.handleForceEntry();\n                }}\n                className={classNames([entryStyles.actionButton, entryStyles.wideButton])}\n              >\n                <FormattedMessage id=\"entry.enter-room\" />\n              </a>\n            )}\n          </div>\n        ) : (\n          <div>\n            <div className=\"loader-wrap loader-mid\">\n              <div className=\"loader\">\n                <div className=\"loader-center\" />\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  renderDevicePanel = () => {\n    return (\n      <div className={entryStyles.entryPanel}>\n        <div onClick={() => this.props.history.goBack()} className={entryStyles.back}>\n          <i>\n            <FontAwesomeIcon icon={faArrowLeft} />\n          </i>\n          <FormattedMessage id=\"entry.back\" />\n        </div>\n\n        <div className={entryStyles.title}>\n          <FormattedMessage id=\"entry.choose-device\" />\n        </div>\n\n        {!this.state.waitingOnAudio ? (\n          <div className={entryStyles.buttonContainer}>\n            {this.props.availableVREntryTypes.cardboard !== VR_DEVICE_AVAILABILITY.no && (\n              <div className={entryStyles.secondary} onClick={this.enterVR}>\n                <FormattedMessage id=\"entry.cardboard\" />\n              </div>\n            )}\n            {this.props.availableVREntryTypes.generic !== VR_DEVICE_AVAILABILITY.no && (\n              <GenericEntryButton secondary={true} onClick={this.enterVR} />\n            )}\n            {this.props.availableVREntryTypes.daydream === VR_DEVICE_AVAILABILITY.yes && (\n              <DaydreamEntryButton secondary={true} onClick={this.enterDaydream} subtitle={null} />\n            )}\n            {this.props.availableVREntryTypes.screen === VR_DEVICE_AVAILABILITY.yes && (\n              <TwoDEntryButton onClick={this.enter2D} />\n            )}\n          </div>\n        ) : (\n          <div className={entryStyles.audioLoader}>\n            <div className=\"loader-wrap loader-mid\">\n              <div className=\"loader\">\n                <div className=\"loader-center\" />\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  renderMicPanel = granted => {\n    return (\n      <div className=\"mic-grant-panel\">\n        <div onClick={() => this.props.history.goBack()} className={entryStyles.back}>\n          <i>\n            <FontAwesomeIcon icon={faArrowLeft} />\n          </i>\n          <FormattedMessage id=\"entry.back\" />\n        </div>\n\n        <div className=\"mic-grant-panel__grant-container\">\n          <div className=\"mic-grant-panel__title\">\n            <FormattedMessage id={granted ? \"audio.granted-title\" : \"audio.grant-title\"} />\n          </div>\n          <div className=\"mic-grant-panel__subtitle\">\n            <FormattedMessage id={granted ? \"audio.granted-subtitle\" : \"audio.grant-subtitle\"} />\n          </div>\n          <div className=\"mic-grant-panel__button-container\">\n            {granted ? (\n              <WithHoverSound>\n                <button className=\"mic-grant-panel__button\" onClick={this.onMicGrantButton}>\n                  <img src=\"../assets/images/mic_granted.png\" srcSet=\"../assets/images/mic_granted@2x.png 2x\" />\n                </button>\n              </WithHoverSound>\n            ) : (\n              <WithHoverSound>\n                <button className=\"mic-grant-panel__button\" onClick={this.onMicGrantButton}>\n                  <img src=\"../assets/images/mic_denied.png\" srcSet=\"../assets/images/mic_denied@2x.png 2x\" />\n                </button>\n              </WithHoverSound>\n            )}\n          </div>\n          <div className=\"mic-grant-panel__next-container\">\n            <WithHoverSound>\n              <button className={classNames(\"mic-grant-panel__next\")} onClick={this.onMicGrantButton}>\n                <FormattedMessage id=\"audio.granted-next\" />\n              </button>\n            </WithHoverSound>\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  renderAudioSetupPanel = () => {\n    const subtitleId = isMobilePhoneOrVR ? \"audio.subtitle-mobile\" : \"audio.subtitle-desktop\";\n    return (\n      <div className=\"audio-setup-panel\">\n        <div onClick={() => this.props.history.goBack()} className={entryStyles.back}>\n          <i>\n            <FontAwesomeIcon icon={faArrowLeft} />\n          </i>\n          <FormattedMessage id=\"entry.back\" />\n        </div>\n\n        <div>\n          <div className=\"audio-setup-panel__title\">\n            <FormattedMessage id=\"audio.title\" />\n          </div>\n          <div className=\"audio-setup-panel__subtitle\">\n            {(isMobilePhoneOrVR || this.state.enterInVR) && <FormattedMessage id={subtitleId} />}\n          </div>\n          <div className=\"audio-setup-panel__levels\">\n            <MicLevelWidget\n              scene={this.props.scene}\n              hasAudioTrack={!!this.state.audioTrack}\n              muteOnEntry={this.state.muteOnEntry}\n            />\n            <OutputLevelWidget />\n          </div>\n          {this.state.audioTrack && this.state.micDevices.length > 1 ? (\n            <div className=\"audio-setup-panel__device-chooser\">\n              <WithHoverSound>\n                <select\n                  className=\"audio-setup-panel__device-chooser__dropdown\"\n                  value={this.selectedMicDeviceId()}\n                  onChange={this.micDeviceChanged}\n                >\n                  {this.state.micDevices.map(d => (\n                    <option key={d.deviceId} value={d.deviceId}>\n                      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n                      {d.label}\n                    </option>\n                  ))}\n                </select>\n              </WithHoverSound>\n              <img\n                className=\"audio-setup-panel__device-chooser__mic-icon\"\n                src=\"../assets/images/mic_small.png\"\n                srcSet=\"../assets/images/mic_small@2x.png 2x\"\n              />\n              <img\n                className=\"audio-setup-panel__device-chooser__dropdown-arrow\"\n                src=\"../assets/images/dropdown_arrow.png\"\n                srcSet=\"../assets/images/dropdown_arrow@2x.png 2x\"\n              />\n            </div>\n          ) : (\n            <div />\n          )}\n          {this.shouldShowHmdMicWarning() && (\n            <div className=\"audio-setup-panel__hmd-mic-warning\">\n              <img\n                src=\"../assets/images/warning_icon.png\"\n                srcSet=\"../assets/images/warning_icon@2x.png 2x\"\n                className=\"audio-setup-panel__hmd-mic-warning__icon\"\n              />\n              <span className=\"audio-setup-panel__hmd-mic-warning__label\">\n                <FormattedMessage id=\"audio.hmd-mic-warning\" />\n              </span>\n            </div>\n          )}\n        </div>\n        <div className=\"audio-setup-panel__mute-container\">\n          <input\n            id=\"mute-on-entry\"\n            type=\"checkbox\"\n            onChange={() => this.setState({ muteOnEntry: !this.state.muteOnEntry })}\n            checked={this.state.muteOnEntry}\n          />\n          <label htmlFor=\"mute-on-entry\">\n            <FormattedMessage id=\"entry.mute-on-entry\" />\n          </label>\n        </div>\n        <div className=\"audio-setup-panel__enter-button-container\">\n          <WithHoverSound>\n            <button className=\"audio-setup-panel__enter-button\" onClick={this.onAudioReadyButton}>\n              <FormattedMessage id=\"audio.enter-now\" />\n            </button>\n          </WithHoverSound>\n        </div>\n      </div>\n    );\n  };\n\n  isInModalOrOverlay = () => {\n    if (\n      this.state.entered &&\n      (IN_ROOM_MODAL_ROUTER_PATHS.find(x => sluglessPath(this.props.history.location).startsWith(x)) ||\n        IN_ROOM_MODAL_QUERY_VARS.find(x => new URLSearchParams(this.props.history.location.search).get(x)))\n    ) {\n      return true;\n    }\n\n    if (\n      !this.state.entered &&\n      (LOBBY_MODAL_ROUTER_PATHS.find(x => sluglessPath(this.props.history.location).startsWith(x)) ||\n        LOBBY_MODAL_QUERY_VARS.find(\n          (x, i) => new URLSearchParams(this.props.history.location.search).get(x) === LOBBY_MODAL_QUERY_VALUES[i]\n        ))\n    ) {\n      return true;\n    }\n\n    return !!(\n      (this.props.history &&\n        this.props.history.location.state &&\n        (this.props.history.location.state.modal || this.props.history.location.state.overlay)) ||\n      this.state.dialog\n    );\n  };\n\n  render() {\n    if (this.props.hide || this.state.hide) return <div />;\n\n    const isExited = this.state.exited || this.props.roomUnavailableReason || this.props.platformUnsupportedReason;\n    const preload = this.props.showPreload;\n\n    const isLoading =\n      !preload &&\n      (!this.state.hideLoader || !this.state.didConnectToNetworkedScene) &&\n      !(this.props.showSafariMicDialog || this.props.showSafariDialog || this.props.showWebAssemblyDialog);\n\n    const rootStyles = {\n      [styles.ui]: true,\n      \"ui-root\": true,\n      \"in-modal-or-overlay\": this.isInModalOrOverlay()\n    };\n    const hasPush = navigator.serviceWorker && \"PushManager\" in window;\n\n    if (this.props.showOAuthDialog && !this.props.showInterstitialPrompt)\n      return (\n        <IntlProvider locale={lang} messages={messages}>\n          <div className={classNames(rootStyles)}>\n            <OAuthDialog onClose={this.props.onCloseOAuthDialog} oauthInfo={this.props.oauthInfo}  privacyLink={this.state.airtableAssets.Privacy_Link} termsLink={this.state.airtableAssets.Terms_Link} />\n          </div>\n        </IntlProvider>\n      );\n    if (isExited) return this.renderExitedPane();\n    if (isLoading) {\n      return (\n        <Loader loadingIcon={this.state.airtableAssets.Icon} scene={this.props.scene} finished={this.state.noMoreLoadingUpdates} onLoaded={this.onLoadingFinished} />\n      );\n    }\n    if (this.props.showInterstitialPrompt) return this.renderInterstitialPrompt();\n    if (this.props.isBotMode) return this.renderBotMode();\n\n    const embed = this.props.embed;\n    const entered = this.state.entered;\n    const watching = this.state.watching;\n    const enteredOrWatching = entered || watching;\n    const enteredOrWatchingOrPreload = entered || watching || preload;\n    const baseUrl = `${location.protocol}//${location.host}${location.pathname}`;\n    const inEntryFlow = !!(\n      this.props.history &&\n      this.props.history.location.state &&\n      this.props.history.location.state.entry_step\n    );\n\n    const entryDialog =\n      this.props.availableVREntryTypes &&\n      !preload &&\n      (this.isWaitingForAutoExit() ? (\n        <AutoExitWarning\n          secondsRemaining={this.state.secondsRemainingBeforeAutoExit}\n          onCancel={this.endAutoExitTimer}\n        />\n      ) : (\n        <div className={entryStyles.entryDialog}>\n          <StateRoute stateKey=\"entry_step\" stateValue=\"device\" history={this.props.history}>\n            {this.renderDevicePanel()}\n          </StateRoute>\n          <StateRoute stateKey=\"entry_step\" stateValue=\"mic_grant\" history={this.props.history}>\n            {this.renderMicPanel(false)}\n          </StateRoute>\n          <StateRoute stateKey=\"entry_step\" stateValue=\"mic_granted\" history={this.props.history}>\n            {this.renderMicPanel(true)}\n          </StateRoute>\n          <StateRoute stateKey=\"entry_step\" stateValue=\"audio\" history={this.props.history}>\n            {this.renderAudioSetupPanel()}\n          </StateRoute>\n          <StateRoute stateKey=\"entry_step\" stateValue=\"\" history={this.props.history}>\n            {this.renderEntryStartPanel()}\n          </StateRoute>\n        </div>\n      ));\n\n    const dialogBoxContentsClassNames = classNames({\n      [styles.uiInteractive]: !this.isInModalOrOverlay(),\n      [styles.uiDialogBoxContents]: true,\n      [styles.backgrounded]: this.isInModalOrOverlay()\n    });\n\n    const showVREntryButton = entered && isMobileVR;\n\n    const presenceLogEntries = this.props.presenceLogEntries || [];\n\n    const mediaSource = this.props.mediaSearchStore.getUrlMediaSource(this.props.history.location);\n\n    // Allow scene picker pre-entry, otherwise wait until entry\n    const showMediaBrowser =\n      mediaSource && ([\"scenes\", \"avatars\", \"favorites\"].includes(mediaSource) || this.state.entered);\n    const hasTopTip = (this.props.activeTips && this.props.activeTips.top) || this.state.showVideoShareFailed;\n\n    const clientInfoClientId = getClientInfoClientId(this.props.history.location);\n    const showClientInfo = !!clientInfoClientId;\n\n    const discordBridges = this.discordBridges();\n    const discordSnippet = discordBridges.map(ch => \"#\" + ch).join(\", \");\n    const hasEmbedPresence = this.hasEmbedPresence();\n    const hasDiscordBridges = discordBridges.length > 0;\n    const showBroadcastTip =\n      (hasDiscordBridges || (hasEmbedPresence && !this.props.embed)) && !this.state.broadcastTipDismissed;\n\n    const showInviteTip =\n      !showVREntryButton &&\n      !hasTopTip &&\n      !entered &&\n      !embed &&\n      !preload &&\n      !watching &&\n      !hasTopTip &&\n      !inEntryFlow &&\n      !this.props.store.state.activity.hasOpenedShare &&\n      this.occupantCount() <= 1;\n\n    const showChooseSceneButton =\n    false && \n      !showVREntryButton &&\n      !entered &&\n      !embed &&\n      !preload &&\n      !watching &&\n      !showInviteTip &&\n      !this.state.showShareDialog &&\n      this.props.hubChannel &&\n      this.props.hubChannel.canOrWillIfCreator(\"update_hub\");\n\n    const displayNameOverride = this.props.hubIsBound\n      ? getPresenceProfileForSession(this.props.presences, this.props.sessionId).displayName\n      : null;\n\n    const streaming = this.state.isStreaming;\n    const streamingTip = streaming &&\n      this.state.showStreamingTip && (\n        <div className={classNames([styles.streamingTip])}>\n          <div className={classNames([styles.streamingTipAttachPoint])} />\n          <button\n            title=\"Dismiss\"\n            className={styles.streamingTipClose}\n            onClick={() => this.setState({ showStreamingTip: false })}\n          >\n            <FontAwesomeIcon icon={faTimes} />\n          </button>\n\n          <div className={styles.streamingTipMessage}>\n            <FormattedMessage id=\"tips.streaming\" />\n          </div>\n        </div>\n      );\n\n    const streamer = getCurrentStreamer();\n    const streamerName = streamer && streamer.displayName;\n\n    return (\n      <ReactAudioContext.Provider value={this.state.audioContext}>\n        <IntlProvider locale={lang} messages={messages}>\n          <div className={classNames(rootStyles)}>\n            <HelmetComponent page=\"Live\" assets={this.state.airtableAssets} />\n            {this.state.dialog}\n            {preload && (\n              <PreloadOverlay\n                hubName={this.props.hubName}\n                hubScene={this.props.hubScene}\n                baseUrl={baseUrl}\n                onLoadClicked={this.props.onPreloadLoadClicked}\n                logo={this.state.DarkLogo}\n              />\n            )}\n            <StateRoute\n              stateKey=\"overlay\"\n              stateValue=\"profile\"\n              history={this.props.history}\n              render={props => (\n                <ProfileEntryPanel\n                  {...props}\n                  displayNameOverride={displayNameOverride}\n                  finished={() => this.pushHistoryState()}\n                  onClose={() => this.pushHistoryState()}\n                  store={this.props.store}\n                  mediaSearchStore={this.props.mediaSearchStore}\n                  avatarId={props.location.state.detail && props.location.state.detail.avatarId}\n                  logo={this.state.airtableAssets.DarkLogo}\n                  privacyLink={this.state.airtableAssets.Privacy_Link}\n                  termsLink={this.state.airtableAssets.Terms_Link}\n                />\n              )}\n            />\n            <StateRoute\n              stateKey=\"overlay\"\n              stateValue=\"avatar-editor\"\n              history={this.props.history}\n              render={props => (\n                <AvatarEditor\n                  className={styles.avatarEditor}\n                  signedIn={this.state.signedIn}\n                  onSignIn={this.showSignInDialog}\n                  onSave={() => {\n                    if (props.location.state.detail && props.location.state.detail.returnToProfile) {\n                      this.props.history.goBack();\n                    } else {\n                      this.props.history.goBack();\n                      // We are returning to the media browser. Trigger an update so that the filter switches to\n                      // my-avatars, now that we've saved an avatar.\n                      this.props.mediaSearchStore.sourceNavigateWithNoNav(\"avatars\");\n                    }\n                    this.props.onAvatarSaved();\n                  }}\n                  onClose={() => this.props.history.goBack()}\n                  store={this.props.store}\n                  debug={avatarEditorDebug}\n                  avatarId={props.location.state.detail && props.location.state.detail.avatarId}\n                  hideDelete={props.location.state.detail && props.location.state.detail.hideDelete}\n                />\n              )}\n            />\n            {showMediaBrowser && (\n              <MediaBrowser\n                history={this.props.history}\n                mediaSearchStore={this.props.mediaSearchStore}\n                hubChannel={this.props.hubChannel}\n                onMediaSearchResultEntrySelected={entry => {\n                  if (entry.type === \"hub\") {\n                    this.showNonHistoriedDialog(LeaveRoomDialog, {\n                      destinationUrl: entry.url,\n                      messageType: \"join-room\"\n                    });\n                  } else {\n                    this.props.onMediaSearchResultEntrySelected(entry);\n                  }\n                }}\n                performConditionalSignIn={this.props.performConditionalSignIn}\n              />\n            )}\n            <StateRoute\n              stateKey=\"entry_step\"\n              stateValue=\"profile\"\n              history={this.props.history}\n              render={props => (\n                <ProfileEntryPanel\n                  {...props}\n                  displayNameOverride={displayNameOverride}\n                  finished={() => {\n                    if (this.props.forcedVREntryType) {\n                      this.pushHistoryState();\n                      this.handleForceEntry();\n                    } else {\n                      this.pushHistoryState(\"entry_step\", \"device\");\n                    }\n                  }}\n                  onClose={() => this.pushHistoryState()}\n                  store={this.props.store}\n                  mediaSearchStore={this.props.mediaSearchStore}\n                  avatarId={props.location.state.detail && props.location.state.detail.avatarId}\n                  logo={this.state.airtableAssets.DarkLogo}\n                  privacyLink={this.state.airtableAssets.Privacy_Link}\n                  termsLink={this.state.airtableAssets.Terms_Link}\n                />\n              )}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"room_settings\"\n              history={this.props.history}\n              render={() =>\n                this.renderDialog(RoomSettingsDialog, {\n                  initialSettings: { name: this.props.hubName, member_permissions: this.props.hubMemberPermissions },\n                  onChange: settings => this.props.hubChannel.updateHub(settings)\n                })\n              }\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"close_room\"\n              history={this.props.history}\n              render={() => this.renderDialog(CloseRoomDialog, { onConfirm: () => this.props.hubChannel.closeHub() })}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"help\"\n              history={this.props.history}\n              render={() => this.renderDialog(<HelpDialog privacyLink={this.state.airtableAssets.Privacy_Link} termsLink={this.state.airtableAssets.Terms_Link} />)}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"support\"\n              history={this.props.history}\n              render={() => this.renderDialog(InviteTeamDialog, { hubChannel: this.props.hubChannel })}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"create\"\n              history={this.props.history}\n              render={() => this.renderDialog(CreateObjectDialog, { onCreate: this.createObject })}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"change_scene\"\n              history={this.props.history}\n              render={() => this.renderDialog(ChangeSceneDialog, { onChange: this.changeScene })}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"avatar_url\"\n              history={this.props.history}\n              render={() => this.renderDialog(AvatarUrlDialog, { onChange: this.setAvatarUrl })}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"webvr\"\n              history={this.props.history}\n              render={() => this.renderDialog(WebVRRecommendDialog)}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"webrtc-screenshare\"\n              history={this.props.history}\n              render={() => this.renderDialog(WebRTCScreenshareUnsupportedDialog)}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"room_info\"\n              history={this.props.history}\n              render={() =>\n                this.renderDialog(RoomInfoDialog, { scene: this.props.hubScene, hubName: this.props.hubName })\n              }\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"feedback\"\n              history={this.props.history}\n              render={() =>\n                this.renderDialog(FeedbackDialog, {\n                  history: this.props.history,\n                  onClose: () => this.pushHistoryState(\"modal\", null)\n                })\n              }\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"tweet\"\n              history={this.props.history}\n              render={() => this.renderDialog(TweetDialog, { history: this.props.history, onClose: this.closeDialog })}\n            />\n            {showClientInfo && (\n              <ClientInfoDialog\n                clientId={clientInfoClientId}\n                onClose={this.closeDialog}\n                history={this.props.history}\n                presences={this.props.presences}\n                hubChannel={this.props.hubChannel}\n                showNonHistoriedDialog={this.showNonHistoriedDialog}\n                performConditionalSignIn={this.props.performConditionalSignIn}\n              />\n            )}\n            {(!enteredOrWatching || this.isWaitingForAutoExit()) && (\n              <div className={styles.uiDialog}>\n                <PresenceLog\n                  entries={presenceLogEntries}\n                  presences={this.props.presences}\n                  hubId={this.props.hubId}\n                  history={this.props.history}\n                />\n                <div className={dialogBoxContentsClassNames}>{entryDialog}</div>\n              </div>\n            )}\n            {enteredOrWatchingOrPreload && (\n              <PresenceLog\n                inRoom={true}\n                presences={this.props.presences}\n                entries={presenceLogEntries}\n                hubId={this.props.hubId}\n                history={this.props.history}\n              />\n            )}\n            {entered &&\n              this.props.activeTips &&\n              this.props.activeTips.bottom &&\n              (!presenceLogEntries || presenceLogEntries.length === 0) &&\n              !showBroadcastTip && (\n                <Tip tip={this.props.activeTips.bottom} tipRegion=\"bottom\" pushHistoryState={this.pushHistoryState} />\n              )}\n            {enteredOrWatchingOrPreload &&\n              showBroadcastTip && (\n                <Tip\n                  tip={hasDiscordBridges ? \"discord\" : \"embed\"}\n                  broadcastTarget={discordSnippet}\n                  onClose={() => this.confirmBroadcastedRoom()}\n                />\n              )}\n            {enteredOrWatchingOrPreload && (\n              <InWorldChatBox\n                discordBridges={discordBridges}\n                onSendMessage={this.sendMessage}\n                onObjectCreated={this.createObject}\n                enableSpawning={entered}\n                history={this.props.history}\n              />\n            )}\n            {this.state.frozen && (\n              <button className={styles.leaveButton} onClick={() => this.exit(\"left\")}>\n                <FormattedMessage id=\"entry.leave-room\" />\n              </button>\n            )}\n            {!this.state.frozen &&\n              !watching &&\n              !preload && (\n                <div\n                  className={classNames({\n                    [inviteStyles.inviteContainer]: true,\n                    [inviteStyles.inviteContainerBelowHud]: entered,\n                    [inviteStyles.inviteContainerInverted]: this.state.showShareDialog\n                  })}\n                >\n                  {false && !embed &&\n                    !showVREntryButton &&\n                    !hasTopTip &&\n                    !streaming && (\n                      <WithHoverSound>\n                        <button\n                          className={classNames({\n                            [inviteStyles.inviteButton]: true,\n                            [inviteStyles.hideSmallScreens]: this.occupantCount() > 1 && entered\n                          })}\n                          onClick={() => this.toggleShareDialog()}\n                        >\n                          <FormattedMessage id=\"entry.share-button\" />\n                        </button>\n                      </WithHoverSound>\n                    )}\n                  {showChooseSceneButton && (\n                    <button\n                      className={classNames([styles.chooseSceneButton])}\n                      onClick={() => {\n                        this.props.performConditionalSignIn(\n                          () => this.props.hubChannel.can(\"update_hub\"),\n                          () => {\n                            showFullScreenIfAvailable();\n                            this.props.mediaSearchStore.sourceNavigateWithNoNav(\"scenes\");\n                          },\n                          \"change-scene\"\n                        );\n                      }}\n                    >\n                      <FormattedMessage id=\"entry.change-scene\" />\n                    </button>\n                  )}\n\n                  {showInviteTip && (\n                    <div className={styles.inviteTip}>\n                      <div className={styles.inviteTipAttachPoint} />\n                      <FormattedMessage id={`entry.${isMobile ? \"mobile\" : \"desktop\"}.invite-tip`} />\n                    </div>\n                  )}\n                  {!embed &&\n                    !showVREntryButton &&\n                    this.occupantCount() > 1 &&\n                    !hasTopTip &&\n                    entered &&\n                    !streaming && (\n                      <WithHoverSound>\n                        <button onClick={this.onMiniInviteClicked} className={inviteStyles.inviteMiniButton}>\n                          <span>\n                            {this.state.miniInviteActivated\n                              ? navigator.share\n                                ? \"sharing...\"\n                                : \"copied!\"\n                              : \"hub.link/\" + this.props.hubId}\n                          </span>\n                        </button>\n                      </WithHoverSound>\n                    )}\n                  {showVREntryButton && (\n                    <WithHoverSound>\n                      <button className={inviteStyles.enterButton} onClick={() => exit2DInterstitialAndEnterVR(true)}>\n                        <FormattedMessage id=\"entry.enter-in-vr\" />\n                      </button>\n                    </WithHoverSound>\n                  )}\n                  {embed && (\n                    <a href={baseUrl} className={inviteStyles.enterButton} target=\"_blank\" rel=\"noopener noreferrer\">\n                      <FormattedMessage id=\"entry.open-in-window\" />\n                    </a>\n                  )}\n                  {this.state.showShareDialog && (\n                    <InviteDialog\n                      allowShare={!isMobileVR}\n                      entryCode={this.props.hubEntryCode}\n                      embedUrl={\n                        this.props.embedToken && !isMobilePhoneOrVR\n                          ? `${baseUrl}?embed_token=${this.props.embedToken}`\n                          : null\n                      }\n                      hasPush={hasPush}\n                      isSubscribed={\n                        this.state.isSubscribed === undefined ? this.props.initialIsSubscribed : this.state.isSubscribed\n                      }\n                      onSubscribeChanged={() => this.onSubscribeChanged()}\n                      hubId={this.props.hubId}\n                      onClose={() => this.setState({ showShareDialog: false })}\n                    />\n                  )}\n                </div>\n              )}\n            <StateRoute\n              stateKey=\"overlay\"\n              stateValue=\"invite\"\n              history={this.props.history}\n              render={() => (\n                <InviteDialog\n                  allowShare={!!navigator.share}\n                  entryCode={this.props.hubEntryCode}\n                  hubId={this.props.hubId}\n                  isModal={true}\n                  onClose={() => {\n                    this.props.history.goBack();\n                    exit2DInterstitialAndEnterVR();\n                  }}\n                />\n              )}\n            />\n            <StateRoute\n              stateKey=\"overlay\"\n              stateValue=\"link\"\n              history={this.props.history}\n              render={() => (\n                <LinkDialog\n                  linkCode={this.state.linkCode}\n                  onClose={() => {\n                    this.state.linkCodeCancel();\n                    this.setState({ linkCode: null, linkCodeCancel: null });\n                    this.props.history.goBack();\n                  }}\n                />\n              )}\n            />\n            {streaming && (\n              <button\n                title=\"Exit Camera Mode\"\n                onClick={() => this.toggleStreamerMode(false)}\n                className={classNames([styles.cornerButton, styles.cameraModeExitButton])}\n              >\n                <FontAwesomeIcon icon={faTimes} />\n              </button>\n            )}\n            {streamingTip}\n\n            <PresenceList\n              history={this.props.history}\n              presences={this.props.presences}\n              sessionId={this.props.sessionId}\n              signedIn={this.state.signedIn}\n              email={this.props.store.state.credentials.email}\n              onSignIn={this.showSignInDialog}\n              onSignOut={this.signOut}\n            />\n\n            {!streaming &&\n              !preload && (\n                <SettingsMenu\n                  history={this.props.history}\n                  mediaSearchStore={this.props.mediaSearchStore}\n                  isStreaming={streaming}\n                  toggleStreamerMode={this.toggleStreamerMode}\n                  hubChannel={this.props.hubChannel}\n                  hubScene={this.props.hubScene}\n                  scene={this.props.scene}\n                  performConditionalSignIn={this.props.performConditionalSignIn}\n                  showNonHistoriedDialog={this.showNonHistoriedDialog}\n                  pushHistoryState={this.pushHistoryState}\n                  toggleFlyMode={this.toggleFlyMode}\n                  privacyLink={this.state.airtableAssets.Privacy_Link} \n                  termsLink={this.state.airtableAssets.Terms_Link}\n                />\n              )}\n            {!entered && !streaming && !isMobile && streamerName && <SpectatingLabel name={streamerName} />}\n            {enteredOrWatching && (\n              <div className={styles.topHud}>\n                <TwoDHUD.TopHUD\n                  scene={this.props.scene}\n                  history={this.props.history}\n                  mediaSearchStore={this.props.mediaSearchStore}\n                  muted={this.state.muted}\n                  frozen={this.state.frozen}\n                  watching={this.state.watching}\n                  onWatchEnded={() => this.setState({ watching: false })}\n                  videoShareMediaSource={this.state.videoShareMediaSource}\n                  showVideoShareFailed={this.state.showVideoShareFailed}\n                  hideVideoShareFailedTip={() => this.setState({ showVideoShareFailed: false })}\n                  activeTip={this.props.activeTips && this.props.activeTips.top}\n                  isCursorHoldingPen={this.props.isCursorHoldingPen}\n                  hasActiveCamera={this.props.hasActiveCamera}\n                  onToggleMute={this.toggleMute}\n                  onToggleFlying={this.toggleFlyMode}\n                  flyingEnabled={this.state.flyingEnabled}\n                  onToggleMegaphone={this.toggleMegaphone}\n                  megaphoneEnabled={this.state.megaphoneEnabled}\n                  onToggleFreeze={this.toggleFreeze}\n                  onSpawnPen={this.spawnPen}\n                  onSpawnCamera={() => this.props.scene.emit(\"action_toggle_camera\")}\n                  onShareVideo={this.shareVideo}\n                  onEndShareVideo={this.endShareVideo}\n                  onShareVideoNotCapable={() => this.showWebRTCScreenshareUnsupportedDialog()}\n                  isStreaming={streaming}\n                  showStreamingTip={this.state.showStreamingTip}\n                  hideStreamingTip={() => {\n                    this.setState({ showStreamingTip: false });\n                  }}\n                />\n                {false && !watching && !streaming ? (\n                  <div className={styles.nagCornerButton}>\n                    <button onClick={() => this.pushHistoryState(\"modal\", \"feedback\")}>\n                      <FormattedMessage id=\"feedback.prompt\" />\n                    </button>\n                  </div>\n                ) : (\n                  <div className={styles.nagCornerButton}>\n                    <button onClick={() => this.setState({ hide: true })}>\n                      <FormattedMessage id=\"hide-ui.prompt\" />\n                    </button>\n                  </div>\n                )}\n\n                {false && !streaming && (\n                  <button\n                    onClick={() => this.toggleFavorited()}\n                    className={classNames({\n                      [entryStyles.favorited]: this.isFavorited(),\n                      [styles.inRoomFavoriteButton]: true\n                    })}\n                  >\n                    <i title=\"Favorite\">\n                      <FontAwesomeIcon icon={faStar} />\n                    </i>\n                  </button>\n                )}\n              </div>\n            )}\n          </div>\n        </IntlProvider>\n      </ReactAudioContext.Provider>\n    );\n  }\n}\n\nexport default UIRoot;\n","import jwtDecode from \"jwt-decode\";\nimport { EventTarget } from \"event-target-shim\";\nimport { Presence } from \"phoenix\";\nimport { migrateChannelToSocket, discordBridgesForPresences } from \"./phoenix-utils\";\n\nconst MS_PER_DAY = 1000 * 60 * 60 * 24;\nconst MS_PER_MONTH = 1000 * 60 * 60 * 24 * 30;\n\nfunction isSameMonth(da, db) {\n  return da.getFullYear() == db.getFullYear() && da.getMonth() == db.getMonth();\n}\n\nfunction isSameDay(da, db) {\n  return isSameMonth(da, db) && da.getDate() == db.getDate();\n}\n\n// Permissions that will be assumed if the user becomes the creator.\nconst HUB_CREATOR_PERMISSIONS = [\"update_hub\", \"update_roles\", \"close_hub\", \"mute_users\", \"kick_users\"];\nconst VALID_PERMISSIONS =\n  HUB_CREATOR_PERMISSIONS + [\"tweet\", \"spawn_camera\", \"spawn_drawing\", \"spawn_and_move_media\", \"pin_objects\"];\n\nexport default class HubChannel extends EventTarget {\n  constructor(store, hubId) {\n    super();\n    this.store = store;\n    this.hubId = hubId;\n    this._signedIn = !!this.store.state.credentials.token;\n    this._permissions = {};\n    this._blockedSessionIds = new Set();\n  }\n\n  get signedIn() {\n    return this._signedIn;\n  }\n\n  // Returns true if this current session has the given permission.\n  can(permission) {\n    if (!VALID_PERMISSIONS.includes(permission)) throw new Error(`Invalid permission name: ${permission}`);\n    return this._permissions && this._permissions[permission];\n  }\n\n  // Returns true if the current session has the given permission, *or* will get the permission\n  // if they sign in and become the creator.\n  canOrWillIfCreator(permission) {\n    if (this._getCreatorAssignmentToken() && HUB_CREATOR_PERMISSIONS.includes(permission)) return true;\n    return this.can(permission);\n  }\n\n  // Migrates this hub channel to a new phoenix channel and presence\n  async migrateToSocket(socket, params) {\n    let presenceBindings;\n\n    // Unbind presence, and then set up bindings after reconnect\n    if (this.presence) {\n      presenceBindings = {\n        onJoin: this.presence.caller.onJoin,\n        onLeave: this.presence.caller.onLeave,\n        onSync: this.presence.caller.onSync\n      };\n\n      this.presence.onJoin(function() {});\n      this.presence.onLeave(function() {});\n      this.presence.onSync(function() {});\n    }\n\n    this.channel = await migrateChannelToSocket(this.channel, socket, params);\n    this.presence = new Presence(this.channel);\n\n    if (presenceBindings) {\n      this.presence.onJoin(presenceBindings.onJoin);\n      this.presence.onLeave(presenceBindings.onLeave);\n      this.presence.onSync(presenceBindings.onSync);\n    }\n  }\n\n  setPhoenixChannel = channel => {\n    this.channel = channel;\n    this.presence = new Presence(channel);\n  };\n\n  setPermissionsFromToken = token => {\n    // Note: token is not verified.\n    this._permissions = jwtDecode(token);\n    this.dispatchEvent(new CustomEvent(\"permissions_updated\"));\n\n    // Refresh the token 1 minute before it expires.\n    const nextRefresh = new Date(this._permissions.exp * 1000 - 60 * 1000) - new Date();\n    setTimeout(async () => {\n      const result = await this.fetchPermissions();\n      this.dispatchEvent(new CustomEvent(\"permissions-refreshed\", { detail: result }));\n    }, nextRefresh);\n  };\n\n  sendEntryEvent = async () => {\n    if (!this.channel) {\n      console.warn(\"No phoenix channel initialized before room entry.\");\n      return;\n    }\n\n    let entryDisplayType = \"Screen\";\n\n    if (navigator.getVRDisplays) {\n      const vrDisplay = (await navigator.getVRDisplays()).find(d => d.isPresenting);\n\n      if (vrDisplay) {\n        entryDisplayType = vrDisplay.displayName;\n      }\n    }\n\n    // This is fairly hacky, but gets the # of initial occupants\n    let initialOccupantCount = 0;\n\n    if (NAF.connection.adapter && NAF.connection.adapter.publisher) {\n      initialOccupantCount = NAF.connection.adapter.publisher.initialOccupants.length;\n    }\n\n    const entryTimingFlags = this.getEntryTimingFlags();\n\n    const entryEvent = {\n      ...entryTimingFlags,\n      initialOccupantCount,\n      entryDisplayType,\n      userAgent: navigator.userAgent\n    };\n\n    this.channel.push(\"events:entered\", entryEvent);\n  };\n\n  beginStreaming() {\n    this.channel.push(\"events:begin_streaming\", {});\n  }\n\n  endStreaming() {\n    this.channel.push(\"events:end_streaming\", {});\n  }\n\n  beginRecording() {\n    this.channel.push(\"events:begin_recording\", {});\n  }\n\n  endRecording() {\n    this.channel.push(\"events:end_recording\", {});\n  }\n\n  getEntryTimingFlags = () => {\n    const entryTimingFlags = { isNewDaily: true, isNewMonthly: true, isNewDayWindow: true, isNewMonthWindow: true };\n    const storedLastEnteredAt = this.store.state.activity.lastEnteredAt;\n\n    if (!storedLastEnteredAt) {\n      return entryTimingFlags;\n    }\n\n    const now = new Date();\n    const lastEntered = new Date(storedLastEnteredAt);\n    const msSinceLastEntered = now - lastEntered;\n\n    // note that new daily and new monthly is based on client local time\n    entryTimingFlags.isNewDaily = !isSameDay(now, lastEntered);\n    entryTimingFlags.isNewMonthly = !isSameMonth(now, lastEntered);\n    entryTimingFlags.isNewDayWindow = msSinceLastEntered > MS_PER_DAY;\n    entryTimingFlags.isNewMonthWindow = msSinceLastEntered > MS_PER_MONTH;\n\n    return entryTimingFlags;\n  };\n\n  sendObjectSpawnedEvent = objectType => {\n    if (!this.channel) {\n      console.warn(\"No phoenix channel initialized before object spawn.\");\n      return;\n    }\n\n    const spawnEvent = {\n      object_type: objectType\n    };\n\n    this.channel.push(\"events:object_spawned\", spawnEvent);\n  };\n\n  sendProfileUpdate = () => {\n    this.channel.push(\"events:profile_updated\", { profile: this.store.state.profile });\n  };\n\n  updateScene = url => {\n    if (!this._permissions.update_hub) return \"unauthorized\";\n    this.channel.push(\"update_scene\", { url });\n  };\n\n  updateHub = settings => {\n    if (!this._permissions.update_hub) return \"unauthorized\";\n    this.channel.push(\"update_hub\", settings);\n  };\n\n  closeHub = () => {\n    if (!this._permissions.close_hub) return \"unauthorized\";\n    this.channel.push(\"close_hub\", {});\n  };\n\n  subscribe = subscription => {\n    this.channel.push(\"subscribe\", { subscription });\n  };\n\n  // If true, will tell the server to not send us any NAF traffic\n  allowNAFTraffic = allow => {\n    this.channel.push(allow ? \"unblock_naf\" : \"block_naf\", {});\n  };\n\n  unsubscribe = subscription => {\n    return new Promise(resolve => this.channel.push(\"unsubscribe\", { subscription }).receive(\"ok\", resolve));\n  };\n\n  sendMessage = (body, type = \"chat\") => {\n    if (!body) return;\n    this.channel.push(\"message\", { body, type });\n  };\n\n  _getCreatorAssignmentToken = () => {\n    const creatorAssignmentTokenEntry =\n      this.store.state.creatorAssignmentTokens &&\n      this.store.state.creatorAssignmentTokens.find(t => t.hubId === this.hubId);\n\n    return creatorAssignmentTokenEntry && creatorAssignmentTokenEntry.creatorAssignmentToken;\n  };\n\n  signIn = token => {\n    return new Promise((resolve, reject) => {\n      const creator_assignment_token = this._getCreatorAssignmentToken();\n\n      this.channel\n        .push(\"sign_in\", { token, creator_assignment_token })\n        .receive(\"ok\", ({ perms_token }) => {\n          this.setPermissionsFromToken(perms_token);\n          this._signedIn = true;\n          resolve();\n        })\n        .receive(\"error\", err => {\n          if (err.reason === \"invalid_token\") {\n            console.warn(\"sign in failed\", err);\n            // Token expired or invalid TODO purge from storage if possible\n            resolve();\n          } else {\n            console.error(\"sign in failed\", err);\n            reject();\n          }\n        });\n    });\n  };\n\n  signOut = () => {\n    return new Promise((resolve, reject) => {\n      this.channel\n        .push(\"sign_out\")\n        .receive(\"ok\", async () => {\n          this._signedIn = false;\n          await this.fetchPermissions();\n          resolve();\n        })\n        .receive(\"error\", reject);\n    });\n  };\n\n  getHost = () => {\n    return new Promise((resolve, reject) => {\n      this.channel\n        .push(\"get_host\")\n        .receive(\"ok\", res => {\n          resolve(res.host);\n        })\n        .receive(\"error\", reject);\n    });\n  };\n\n  getTwitterOAuthURL = () => {\n    return new Promise((resolve, reject) => {\n      this.channel\n        .push(\"oauth\", { type: \"twitter\" })\n        .receive(\"ok\", res => {\n          resolve(res.oauth_url);\n        })\n        .receive(\"error\", reject);\n    });\n  };\n\n  discordBridges = () => {\n    if (!this.presence || !this.presence.state) return [];\n    return discordBridgesForPresences(this.presence.state);\n  };\n\n  pin = (id, gltfNode, fileId, fileAccessToken, promotionToken) => {\n    const payload = { id, gltf_node: gltfNode };\n    if (fileId && promotionToken) {\n      payload.file_id = fileId;\n      payload.file_access_token = fileAccessToken;\n      payload.promotion_token = promotionToken;\n    }\n    return new Promise((resolve, reject) => {\n      this.channel\n        .push(\"pin\", payload)\n        .receive(\"ok\", resolve)\n        .receive(\"error\", reject);\n    });\n  };\n\n  unpin = (id, fileId) => {\n    const payload = { id };\n    if (fileId) {\n      payload.file_id = fileId;\n    }\n    this.channel.push(\"unpin\", payload);\n  };\n\n  fetchPermissions = () => {\n    return new Promise((resolve, reject) => {\n      this.channel\n        .push(\"refresh_perms_token\")\n        .receive(\"ok\", res => {\n          this.setPermissionsFromToken(res.perms_token);\n          resolve({ permsToken: res.perms_token, permissions: this._permissions });\n        })\n        .receive(\"error\", reject);\n    });\n  };\n\n  mute = sessionId => this.channel.push(\"mute\", { session_id: sessionId });\n  addOwner = sessionId => this.channel.push(\"add_owner\", { session_id: sessionId });\n  removeOwner = sessionId => this.channel.push(\"remove_owner\", { session_id: sessionId });\n\n  hide = sessionId => {\n    NAF.connection.adapter.block(sessionId);\n    this.channel.push(\"block\", { session_id: sessionId });\n    this._blockedSessionIds.add(sessionId);\n  };\n\n  unhide = sessionId => {\n    if (!this._blockedSessionIds.has(sessionId)) return;\n    NAF.connection.adapter.unblock(sessionId);\n    NAF.connection.entities.completeSync(sessionId);\n    this.channel.push(\"unblock\", { session_id: sessionId });\n    this._blockedSessionIds.delete(sessionId);\n  };\n\n  isHidden = sessionId => this._blockedSessionIds.has(sessionId);\n\n  kick = async sessionId => {\n    const permsToken = await this.fetchPermissions();\n    NAF.connection.adapter.kick(sessionId, permsToken);\n    this.channel.push(\"kick\", { session_id: sessionId });\n  };\n\n  requestSupport = () => this.channel.push(\"events:request_support\", {});\n  favorite = () => this.channel.push(\"favorite\", {});\n  unfavorite = () => this.channel.push(\"unfavorite\", {});\n\n  disconnect = () => {\n    if (this.channel) {\n      this.channel.socket.disconnect();\n    }\n  };\n}\n","const PHYSICS_CONSTANTS = require(\"aframe-physics-system/src/constants\"),\n  SHAPE = PHYSICS_CONSTANTS.SHAPE,\n  FIT = PHYSICS_CONSTANTS.FIT;\n\nfunction exceedsDensityThreshold(count, subtree) {\n  const bounds = subtree.boundingData;\n  const triangleThreshold = 1000;\n  const minimumVolume = 0.1;\n  const minimumTriangles = 100;\n  const dx = bounds[3] - bounds[0];\n  const dy = bounds[4] - bounds[1];\n  const dz = bounds[5] - bounds[2];\n  const volume = dx * dy * dz;\n\n  if (volume < minimumVolume) {\n    return false;\n  }\n\n  if (count < minimumTriangles) {\n    return false;\n  }\n\n  return count / volume > triangleThreshold;\n}\n\nfunction isHighDensity(subtree) {\n  if (subtree.count) {\n    const result = exceedsDensityThreshold(subtree.count, subtree);\n    return result === true ? true : subtree.count;\n  } else {\n    const leftResult = isHighDensity(subtree.left);\n    if (leftResult === true) return true;\n    const rightResult = isHighDensity(subtree.right);\n    if (rightResult === true) return true;\n\n    const count = leftResult + rightResult;\n    const result = exceedsDensityThreshold(count, subtree);\n    return result === true ? true : count;\n  }\n}\n\nfunction isGeometryHighDensity(geo) {\n  const bvh = geo.boundsTree;\n  const roots = bvh._roots;\n  for (let i = 0; i < roots.length; ++i) {\n    return isHighDensity(roots[i]) === true;\n  }\n  return false;\n}\n\nexport const traverseMeshesAndAddShapes = (function() {\n  const shapePrefix = \"ammo-shape__\";\n  const shapes = [];\n  return function(el) {\n    const meshRoot = el.object3DMap.mesh;\n    while (shapes.length > 0) {\n      const { id, entity } = shapes.pop();\n      entity.removeAttribute(id);\n    }\n\n    console.group(\"traverseMeshesAndAddShapes\");\n\n    if (document.querySelector([\"[ammo-shape__trimesh]\", \"[ammo-shape__heightfield]\"])) {\n      console.log(\"heightfield or trimesh found on scene\");\n    } else {\n      console.log(\"collision not found in scene\");\n\n      let isHighDensity = false;\n      meshRoot.traverse(o => {\n        if (\n          o.isMesh &&\n          (!THREE.Sky || o.__proto__ != THREE.Sky.prototype) &&\n          !o.name.startsWith(\"Floor_Plan\") &&\n          !o.name.startsWith(\"Ground_Plane\") &&\n          o.geometry.boundsTree\n        ) {\n          if (isGeometryHighDensity(o.geometry)) {\n            isHighDensity = true;\n            return;\n          }\n        }\n      });\n\n      let navMesh = null;\n\n      if (isHighDensity) {\n        console.log(\"mesh contains high triangle density region\");\n        navMesh = document.querySelector(\"[nav-mesh]\");\n      }\n\n      if (navMesh) {\n        console.log(`mesh density exceeded, using floor plan only`);\n        navMesh.setAttribute(shapePrefix + \"floorPlan\", {\n          type: SHAPE.MESH,\n          margin: 0.01,\n          fit: FIT.ALL,\n          includeInvisible: true\n        });\n        shapes.push({ id: shapePrefix + \"floorPlan\", entity: navMesh });\n      } else if (!isHighDensity) {\n        el.setAttribute(shapePrefix + \"environment\", {\n          type: SHAPE.MESH,\n          margin: 0.01,\n          fit: FIT.ALL\n        });\n        shapes.push({ id: shapePrefix + \"environment\", entity: el });\n        console.log(\"adding mesh shape for all visible meshes\");\n      } else {\n        el.setAttribute(shapePrefix + \"defaultFloor\", {\n          type: SHAPE.BOX,\n          margin: 0.01,\n          halfExtents: { x: 4000, y: 0.5, z: 4000 },\n          offset: { x: 0, y: -0.5, z: 0 },\n          fit: FIT.MANUAL\n        });\n        shapes.push({ id: shapePrefix + \"defaultFloor\", entity: el });\n        console.log(\"adding default floor collision\");\n      }\n    }\n    console.groupEnd();\n  };\n})();\n","import { spawnChatMessage } from \"./react-components/chat-message\";\nimport { SOUND_QUACK, SOUND_SPECIAL_QUACK } from \"./systems/sound-effects-system\";\n\nconst DUCK_URL = \"https://asset-bundles-prod.reticulum.io/interactables/Ducky/DuckyMesh-438ff8e022.gltf\";\n\n// Handles user-entered messages\nexport default class MessageDispatch {\n  constructor(scene, entryManager, hubChannel, addToPresenceLog, remountUI, mediaSearchStore) {\n    this.scene = scene;\n    this.entryManager = entryManager;\n    this.hubChannel = hubChannel;\n    this.addToPresenceLog = addToPresenceLog;\n    this.remountUI = remountUI;\n    this.mediaSearchStore = mediaSearchStore;\n  }\n\n  log = body => {\n    this.addToPresenceLog({ type: \"log\", body });\n  };\n\n  dispatch = message => {\n    if (message.startsWith(\"/\")) {\n      const commandParts = message.substring(1).split(\" \");\n      this.dispatchCommand(commandParts[0], ...commandParts.slice(1));\n      document.activeElement.blur(); // Commands should blur\n    } else {\n      this.hubChannel.sendMessage(message);\n    }\n  };\n\n  dispatchCommand = (command, ...args) => {\n    const entered = this.scene.is(\"entered\");\n\n    if (!entered) {\n      this.addToPresenceLog({ type: \"log\", body: \"You must enter the room to use this command.\" });\n      return;\n    }\n\n    const playerRig = document.querySelector(\"#player-rig\");\n    const scales = [0.0625, 0.125, 0.25, 0.5, 1.0, 1.5, 3, 5, 7.5, 12.5];\n    const curScale = playerRig.object3D.scale;\n    let err;\n    let physicsSystem;\n    const captureSystem = this.scene.systems[\"capture-system\"];\n\n    switch (command) {\n      case \"fly\":\n        if (playerRig.getAttribute(\"character-controller\").fly !== true) {\n          playerRig.setAttribute(\"character-controller\", \"fly\", true);\n          this.addToPresenceLog({ type: \"log\", body: \"Fly mode enabled.\" });\n        } else {\n          playerRig.setAttribute(\"character-controller\", \"fly\", false);\n          this.addToPresenceLog({ type: \"log\", body: \"Fly mode disabled.\" });\n        }\n        break;\n      case \"grow\":\n        for (let i = 0; i < scales.length; i++) {\n          if (scales[i] > curScale.x) {\n            playerRig.object3D.scale.set(scales[i], scales[i], scales[i]);\n            playerRig.object3D.matrixNeedsUpdate = true;\n            break;\n          }\n        }\n\n        break;\n      case \"shrink\":\n        for (let i = scales.length - 1; i >= 0; i--) {\n          if (curScale.x > scales[i]) {\n            playerRig.object3D.scale.set(scales[i], scales[i], scales[i]);\n            break;\n          }\n        }\n\n        break;\n      case \"leave\":\n        this.entryManager.exitScene();\n        this.remountUI({ roomUnavailableReason: \"left\" });\n        break;\n      case \"duck\":\n        spawnChatMessage(DUCK_URL);\n        if (Math.random() < 0.01) {\n          this.scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SPECIAL_QUACK);\n        } else {\n          this.scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_QUACK);\n        }\n        break;\n      case \"debug\":\n        physicsSystem = document.querySelector(\"a-scene\").systems.physics;\n        physicsSystem.setDebug(!physicsSystem.debug);\n        break;\n      case \"vrstats\":\n        document.getElementById(\"stats\").components[\"stats-plus\"].toggleVRStats();\n        break;\n      case \"scene\":\n        if (args[0]) {\n          err = this.hubChannel.updateScene(args[0]);\n\n          if (err === \"unauthorized\") {\n            this.addToPresenceLog({ type: \"log\", body: \"You do not have permission to change the scene.\" });\n          }\n        } else if (this.hubChannel.canOrWillIfCreator(\"update_hub\")) {\n          this.mediaSearchStore.sourceNavigateWithNoNav(\"scenes\");\n        }\n\n        break;\n      case \"rename\":\n        err = this.hubChannel.rename(args.join(\" \"));\n        if (err === \"unauthorized\") {\n          this.addToPresenceLog({ type: \"log\", body: \"You do not have permission to rename this room.\" });\n        }\n        break;\n      case \"capture\":\n        if (!captureSystem.available()) {\n          this.log(\"Capture unavailable.\");\n          break;\n        }\n        if (args[0] === \"stop\") {\n          if (captureSystem.started()) {\n            captureSystem.stop();\n            this.log(\"Capture stopped.\");\n          } else {\n            this.log(\"Capture already stopped.\");\n          }\n        } else {\n          if (captureSystem.started()) {\n            this.log(\"Capture already running.\");\n          } else {\n            captureSystem.start();\n            this.log(\"Capture started.\");\n          }\n        }\n        break;\n    }\n  };\n}\n","import qsTruthy from \"./utils/qs_truthy\";\nimport nextTick from \"./utils/next-tick\";\nimport pinnedEntityToGltf from \"./utils/pinned-entity-to-gltf\";\n\nconst isBotMode = qsTruthy(\"bot\");\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isDebug = qsTruthy(\"debug\");\nconst qs = new URLSearchParams(location.search);\n\nimport { addMedia, getPromotionTokenForFile } from \"./utils/media-utils\";\nimport {\n  isIn2DInterstitial,\n  handleExitTo2DInterstitial,\n  exit2DInterstitialAndEnterVR,\n  forceExitFrom2DInterstitial\n} from \"./utils/vr-interstitial\";\nimport { ObjectContentOrigins } from \"./object-types\";\nimport { getAvatarSrc, getAvatarType } from \"./utils/avatar-utils\";\nimport { pushHistoryState } from \"./utils/history\";\nimport { SOUND_ENTER_SCENE } from \"./systems/sound-effects-system\";\n\nconst isIOS = AFRAME.utils.device.isIOS();\n\nexport default class SceneEntryManager {\n  constructor(hubChannel, authChannel, availableVREntryTypes, history) {\n    this.hubChannel = hubChannel;\n    this.authChannel = authChannel;\n    this.availableVREntryTypes = availableVREntryTypes;\n    this.store = window.APP.store;\n    this.mediaSearchStore = window.APP.mediaSearchStore;\n    this.scene = document.querySelector(\"a-scene\");\n    this.cursorController = document.querySelector(\"#cursor-controller\");\n    this.playerRig = document.querySelector(\"#player-rig\");\n    this._entered = false;\n    this.performConditionalSignIn = () => {};\n    this.history = history;\n  }\n\n  init = () => {\n    this.whenSceneLoaded(() => {\n      this.cursorController.components[\"cursor-controller\"].enabled = false;\n    });\n  };\n\n  hasEntered = () => {\n    return this._entered;\n  };\n\n  enterScene = async (mediaStream, enterInVR, muteOnEntry) => {\n    const playerCamera = document.querySelector(\"#player-camera\");\n    playerCamera.removeAttribute(\"scene-preview-camera\");\n\n    if (isDebug) {\n      NAF.connection.adapter.session.options.verbose = true;\n    }\n\n    if (enterInVR) {\n      // This specific scene state var is used to check if the user went through the\n      // entry flow and chose VR entry, and is used to preempt VR mode on refreshes.\n      this.scene.addState(\"vr-entered\");\n\n      // HACK - A-Frame calls getVRDisplays at module load, we want to do it here to\n      // force gamepads to become live.\n      navigator.getVRDisplays();\n\n      exit2DInterstitialAndEnterVR(true);\n    }\n\n    if (isMobile || qsTruthy(\"mobile\")) {\n      this.playerRig.setAttribute(\"virtual-gamepad-controls\", {});\n    }\n\n    this._setupPlayerRig();\n    this._setupBlocking();\n    this._setupKicking();\n    this._setupMedia(mediaStream);\n    this._setupCamera();\n\n    if (qsTruthy(\"offline\")) return;\n\n    this._spawnAvatar();\n\n    this.scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_ENTER_SCENE);\n\n    if (isBotMode) {\n      this._runBot(mediaStream);\n      return;\n    }\n\n    if (mediaStream) {\n      NAF.connection.adapter.setLocalMediaStream(mediaStream);\n    }\n\n    this.scene.classList.remove(\"hand-cursor\");\n    this.scene.classList.add(\"no-cursor\");\n\n    this.cursorController.components[\"cursor-controller\"].enabled = true;\n    this._entered = true;\n\n    // Delay sending entry event telemetry until VR display is presenting.\n    (async () => {\n      while (enterInVR && !(await navigator.getVRDisplays()).find(d => d.isPresenting)) {\n        await nextTick();\n      }\n\n      this.hubChannel.sendEntryEvent().then(() => {\n        this.store.update({ activity: { lastEnteredAt: new Date().toISOString() } });\n      });\n    })();\n\n    // Bump stored entry count after 30s\n    setTimeout(() => this.store.bumpEntryCount(), 30000);\n\n    this.scene.addState(\"entered\");\n\n    if (muteOnEntry) {\n      this.scene.emit(\"action_mute\");\n    }\n  };\n\n  whenSceneLoaded = callback => {\n    if (this.scene.hasLoaded) {\n      callback();\n    } else {\n      this.scene.addEventListener(\"loaded\", callback);\n    }\n  };\n\n  enterSceneWhenLoaded = (mediaStream, enterInVR) => {\n    this.whenSceneLoaded(() => this.enterScene(mediaStream, enterInVR));\n  };\n\n  exitScene = () => {\n    if (NAF.connection.adapter && NAF.connection.adapter.localMediaStream) {\n      NAF.connection.adapter.localMediaStream.getTracks().forEach(t => t.stop());\n    }\n    if (this.hubChannel) {\n      this.hubChannel.disconnect();\n    }\n    if (this.scene.renderer) {\n      this.scene.renderer.setAnimationLoop(null); // Stop animation loop, TODO A-Frame should do this\n    }\n    document.body.removeChild(this.scene);\n  };\n\n  _setupPlayerRig = () => {\n    this._setPlayerInfoFromProfile();\n    this.store.addEventListener(\"statechanged\", this._setPlayerInfoFromProfile);\n\n    const avatarScale = parseInt(qs.get(\"avatar_scale\"), 10);\n    if (avatarScale) {\n      this.playerRig.setAttribute(\"scale\", { x: avatarScale, y: avatarScale, z: avatarScale });\n    }\n  };\n\n  _setPlayerInfoFromProfile = async () => {\n    const avatarId = this.store.state.profile.avatarId;\n    const avatarSrc = await getAvatarSrc(avatarId);\n\n    this.playerRig.setAttribute(\"player-info\", { avatarSrc, avatarType: getAvatarType(avatarId) });\n  };\n\n  _setupKicking = () => {\n    // This event is only received by the kicker\n    document.body.addEventListener(\"kicked\", ({ detail }) => {\n      const { clientId: kickedClientId } = detail;\n      const { entities } = NAF.connection.entities;\n      for (const id in entities) {\n        const entity = entities[id];\n        if (NAF.utils.getCreator(entity) !== kickedClientId) continue;\n\n        if (entity.components.networked.data.persistent) {\n          NAF.utils.takeOwnership(entity);\n          this._unpinElement(entity);\n          entity.parentNode.removeChild(entity);\n        } else {\n          NAF.entities.removeEntity(id);\n        }\n      }\n    });\n  };\n\n  _setupBlocking = () => {\n    document.body.addEventListener(\"blocked\", ev => {\n      NAF.connection.entities.removeEntitiesOfClient(ev.detail.clientId);\n    });\n\n    document.body.addEventListener(\"unblocked\", ev => {\n      NAF.connection.entities.completeSync(ev.detail.clientId, true);\n    });\n  };\n\n  _pinElement = async el => {\n    const { networkId } = el.components.networked.data;\n\n    const { fileId, src } = el.components[\"media-loader\"].data;\n\n    let fileAccessToken, promotionToken;\n    if (fileId) {\n      fileAccessToken = new URL(src).searchParams.get(\"token\");\n      const storedPromotionToken = getPromotionTokenForFile(fileId);\n      if (storedPromotionToken) {\n        promotionToken = storedPromotionToken.promotionToken;\n      }\n    }\n\n    const gltfNode = pinnedEntityToGltf(el);\n    if (!gltfNode) return;\n    el.setAttribute(\"networked\", { persistent: true });\n    el.setAttribute(\"media-loader\", { fileIsOwned: true });\n\n    try {\n      await this.hubChannel.pin(networkId, gltfNode, fileId, fileAccessToken, promotionToken);\n      this.store.update({ activity: { hasPinned: true } });\n    } catch (e) {\n      if (e.reason === \"invalid_token\") {\n        await this.authChannel.signOut(this.hubChannel);\n        this._signInAndPinOrUnpinElement(el);\n      } else {\n        console.warn(\"Pin failed for unknown reason\", e);\n      }\n    }\n  };\n\n  _signInAndPinOrUnpinElement = (el, pin) => {\n    const action = pin ? () => this._pinElement(el) : async () => await this._unpinElement(el);\n\n    this.performConditionalSignIn(() => this.hubChannel.signedIn, action, pin ? \"pin\" : \"unpin\", () => {\n      // UI pins/un-pins the entity optimistically, so we undo that here.\n      // Note we have to disable the sign in flow here otherwise this will recurse.\n      this._disableSignInOnPinAction = true;\n      el.setAttribute(\"pinnable\", \"pinned\", !pin);\n      this._disableSignInOnPinAction = false;\n    });\n  };\n\n  _unpinElement = el => {\n    const components = el.components;\n    const networked = components.networked;\n\n    if (!networked || !networked.data || !NAF.utils.isMine(el)) return;\n\n    const networkId = components.networked.data.networkId;\n    el.setAttribute(\"networked\", { persistent: false });\n\n    const mediaLoader = components[\"media-loader\"];\n    const fileId = mediaLoader.data && mediaLoader.data.fileId;\n\n    this.hubChannel.unpin(networkId, fileId);\n  };\n\n  _setupMedia = mediaStream => {\n    const offset = { x: 0, y: 0, z: -1.5 };\n    const spawnMediaInfrontOfPlayer = (src, contentOrigin) => {\n      if (!this.hubChannel.can(\"spawn_and_move_media\")) return;\n      const { entity, orientation } = addMedia(\n        src,\n        \"#interactable-media\",\n        contentOrigin,\n        null,\n        !(src instanceof MediaStream),\n        true\n      );\n      orientation.then(or => {\n        entity.setAttribute(\"offset-relative-to\", {\n          target: \"#player-camera\",\n          offset,\n          orientation: or\n        });\n      });\n\n      return entity;\n    };\n\n    this.scene.addEventListener(\"add_media\", e => {\n      const contentOrigin = e.detail instanceof File ? ObjectContentOrigins.FILE : ObjectContentOrigins.URL;\n\n      spawnMediaInfrontOfPlayer(e.detail, contentOrigin);\n    });\n\n    this.scene.addEventListener(\"pinned\", e => {\n      if (this._disableSignInOnPinAction) return;\n      this._signInAndPinOrUnpinElement(e.detail.el, true);\n    });\n\n    this.scene.addEventListener(\"unpinned\", e => {\n      if (this._disableSignInOnPinAction) return;\n      this._signInAndPinOrUnpinElement(e.detail.el, false);\n    });\n\n    this.scene.addEventListener(\"object_spawned\", e => {\n      this.hubChannel.sendObjectSpawnedEvent(e.detail.objectType);\n    });\n\n    this.scene.addEventListener(\"action_spawn\", () => {\n      handleExitTo2DInterstitial(false, () => window.APP.mediaSearchStore.pushExitMediaBrowserHistory());\n      window.APP.mediaSearchStore.sourceNavigateToDefaultSource();\n    });\n\n    this.scene.addEventListener(\"action_invite\", () => {\n      handleExitTo2DInterstitial(false, () => this.history.goBack());\n      pushHistoryState(this.history, \"overlay\", \"invite\");\n    });\n\n    this.scene.addEventListener(\"action_kick_client\", ({ detail: { clientId } }) => {\n      this.performConditionalSignIn(\n        () => this.hubChannel.can(\"kick_users\"),\n        async () => await window.APP.hubChannel.kick(clientId),\n        \"kick-user\"\n      );\n    });\n\n    this.scene.addEventListener(\"action_mute_client\", ({ detail: { clientId } }) => {\n      this.performConditionalSignIn(\n        () => this.hubChannel.can(\"mute_users\"),\n        () => window.APP.hubChannel.mute(clientId),\n        \"mute-user\"\n      );\n    });\n\n    this.scene.addEventListener(\"action_vr_notice_closed\", () => forceExitFrom2DInterstitial());\n\n    document.addEventListener(\"paste\", e => {\n      if (\n        (e.target.matches(\"input, textarea\") || e.target.contentEditable === \"true\") &&\n        document.activeElement === e.target\n      )\n        return;\n\n      // Never paste into scene if dialog is open\n      const uiRoot = document.querySelector(\".ui-root\");\n      if (uiRoot && uiRoot.classList.contains(\"in-modal-or-overlay\")) return;\n\n      const url = e.clipboardData.getData(\"text\");\n      const files = e.clipboardData.files && e.clipboardData.files;\n      if (url) {\n        spawnMediaInfrontOfPlayer(url, ObjectContentOrigins.URL);\n      } else {\n        for (const file of files) {\n          spawnMediaInfrontOfPlayer(file, ObjectContentOrigins.CLIPBOARD);\n        }\n      }\n    });\n\n    document.addEventListener(\"dragover\", e => e.preventDefault());\n\n    document.addEventListener(\"drop\", e => {\n      e.preventDefault();\n\n      let url = e.dataTransfer.getData(\"url\");\n\n      if (!url) {\n        // Sometimes dataTransfer text contains a valid URL, so try for that.\n        try {\n          url = new URL(e.dataTransfer.getData(\"text\")).href;\n        } catch (e) {\n          // Nope, not this time.\n        }\n      }\n\n      const files = e.dataTransfer.files;\n\n      if (url) {\n        spawnMediaInfrontOfPlayer(url, ObjectContentOrigins.URL);\n      } else {\n        for (const file of files) {\n          spawnMediaInfrontOfPlayer(file, ObjectContentOrigins.FILE);\n        }\n      }\n    });\n\n    let currentVideoShareEntity;\n    let isHandlingVideoShare = false;\n\n    const shareVideoMediaStream = async constraints => {\n      if (isHandlingVideoShare) return;\n      isHandlingVideoShare = true;\n\n      let newStream;\n\n      try {\n        newStream = await navigator.mediaDevices.getUserMedia(constraints);\n      } catch (e) {\n        isHandlingVideoShare = false;\n        this.scene.emit(\"share_video_failed\");\n        return;\n      }\n\n      const videoTracks = newStream ? newStream.getVideoTracks() : [];\n\n      if (videoTracks.length > 0) {\n        newStream.getVideoTracks().forEach(track => mediaStream.addTrack(track));\n        NAF.connection.adapter.setLocalMediaStream(mediaStream);\n        currentVideoShareEntity = spawnMediaInfrontOfPlayer(mediaStream, undefined);\n\n        // Wire up custom removal event which will stop the stream.\n        currentVideoShareEntity.setAttribute(\"emit-scene-event-on-remove\", \"event:action_end_video_sharing\");\n      }\n\n      this.scene.emit(\"share_video_enabled\", { source: constraints.video.mediaSource });\n      this.scene.addState(\"sharing_video\");\n      isHandlingVideoShare = false;\n    };\n\n    this.scene.addEventListener(\"action_share_camera\", () => {\n      shareVideoMediaStream({\n        video: {\n          mediaSource: \"camera\",\n          width: isIOS ? { max: 1280 } : { max: 1280, ideal: 720 },\n          frameRate: 30\n        }\n      });\n    });\n\n    this.scene.addEventListener(\"action_share_window\", () => {\n      shareVideoMediaStream({\n        video: {\n          mediaSource: \"window\",\n          // Work around BMO 1449832 by calculating the width. This will break for multi monitors if you share anything\n          // other than your current monitor that has a different aspect ratio.\n          width: 720 * (screen.width / screen.height),\n          height: 720,\n          frameRate: 30\n        }\n      });\n    });\n\n    this.scene.addEventListener(\"action_share_screen\", () => {\n      shareVideoMediaStream({\n        video: {\n          mediaSource: \"screen\",\n          // Work around BMO 1449832 by calculating the width. This will break for multi monitors if you share anything\n          // other than your current monitor that has a different aspect ratio.\n          width: 720 * (screen.width / screen.height),\n          height: 720,\n          frameRate: 30\n        }\n      });\n    });\n\n    this.scene.addEventListener(\"action_end_video_sharing\", () => {\n      if (isHandlingVideoShare) return;\n      isHandlingVideoShare = true;\n\n      if (currentVideoShareEntity && currentVideoShareEntity.parentNode) {\n        NAF.utils.takeOwnership(currentVideoShareEntity);\n        currentVideoShareEntity.parentNode.removeChild(currentVideoShareEntity);\n      }\n\n      for (const track of mediaStream.getVideoTracks()) {\n        mediaStream.removeTrack(track);\n      }\n\n      NAF.connection.adapter.setLocalMediaStream(mediaStream);\n      currentVideoShareEntity = null;\n\n      this.scene.emit(\"share_video_disabled\");\n      this.scene.removeState(\"sharing_video\");\n      isHandlingVideoShare = false;\n    });\n\n    this.scene.addEventListener(\"action_selected_media_result_entry\", e => {\n      // TODO spawn in space when no rights\n      const entry = e.detail;\n      if ([\"avatar\", \"avatar_listing\"].includes(entry.type)) return;\n      if ((entry.type === \"scene_listing\" || entry.type === \"scene\") && this.hubChannel.can(\"update_hub\")) return;\n\n      // If user has HMD lifted up or gone through interstitial, delay spawning for now. eventually show a modal\n      const spawnDelay = isIn2DInterstitial() ? 3000 : 0;\n\n      setTimeout(() => {\n        spawnMediaInfrontOfPlayer(entry.url, ObjectContentOrigins.URL);\n      }, spawnDelay);\n\n      exit2DInterstitialAndEnterVR();\n    });\n\n    this.mediaSearchStore.addEventListener(\"media-exit\", () => {\n      exit2DInterstitialAndEnterVR();\n    });\n  };\n\n  _setupCamera = () => {\n    this.scene.addEventListener(\"action_toggle_camera\", () => {\n      if (!this.hubChannel.can(\"spawn_camera\")) return;\n      const myCamera = this.scene.systems[\"camera-tools\"].getMyCamera();\n\n      if (myCamera) {\n        myCamera.parentNode.removeChild(myCamera);\n        this.scene.removeState(\"camera\");\n      } else {\n        const entity = document.createElement(\"a-entity\");\n        entity.setAttribute(\"networked\", { template: \"#interactable-camera\" });\n        entity.setAttribute(\"offset-relative-to\", {\n          target: \"#player-camera\",\n          offset: { x: 0, y: 0, z: -1.5 }\n        });\n        this.scene.appendChild(entity);\n        this.scene.addState(\"camera\");\n      }\n\n      // Need to wait a frame so camera is registered with system.\n      setTimeout(() => this.scene.emit(\"camera_toggled\"));\n    });\n\n    this.scene.addEventListener(\"photo_taken\", e => this.hubChannel.sendMessage({ src: e.detail }, \"photo\"));\n    this.scene.addEventListener(\"video_taken\", e => this.hubChannel.sendMessage({ src: e.detail }, \"video\"));\n  };\n\n  _spawnAvatar = () => {\n    this.playerRig.setAttribute(\"networked\", \"template: #remote-avatar; attachTemplateToLocal: false;\");\n    this.playerRig.setAttribute(\"networked-avatar\", \"\");\n    this.playerRig.emit(\"entered\");\n  };\n\n  _runBot = async mediaStream => {\n    const audioEl = document.createElement(\"audio\");\n    let audioInput;\n    let dataInput;\n\n    // Wait for startup to render form\n    do {\n      audioInput = document.querySelector(\"#bot-audio-input\");\n      dataInput = document.querySelector(\"#bot-data-input\");\n      await nextTick();\n    } while (!audioInput || !dataInput);\n\n    const getAudio = () => {\n      audioEl.loop = true;\n      audioEl.muted = true;\n      audioEl.crossorigin = \"anonymous\";\n      audioEl.src = URL.createObjectURL(audioInput.files[0]);\n      document.body.appendChild(audioEl);\n    };\n\n    if (audioInput.files && audioInput.files.length > 0) {\n      getAudio();\n    } else {\n      audioInput.onchange = getAudio;\n    }\n\n    const camera = document.querySelector(\"#player-camera\");\n    const leftController = document.querySelector(\"#player-left-controller\");\n    const rightController = document.querySelector(\"#player-right-controller\");\n    const getRecording = () => {\n      fetch(URL.createObjectURL(dataInput.files[0]))\n        .then(resp => resp.json())\n        .then(recording => {\n          camera.setAttribute(\"replay\", \"\");\n          camera.components[\"replay\"].poses = recording.camera.poses;\n\n          leftController.setAttribute(\"replay\", \"\");\n          leftController.components[\"replay\"].poses = recording.left.poses;\n          leftController.removeAttribute(\"visibility-by-path\");\n          leftController.removeAttribute(\"track-pose\");\n          leftController.setAttribute(\"visible\", true);\n\n          rightController.setAttribute(\"replay\", \"\");\n          rightController.components[\"replay\"].poses = recording.right.poses;\n          rightController.removeAttribute(\"visibility-by-path\");\n          rightController.removeAttribute(\"track-pose\");\n          rightController.setAttribute(\"visible\", true);\n        });\n    };\n\n    if (dataInput.files && dataInput.files.length > 0) {\n      getRecording();\n    } else {\n      dataInput.onchange = getRecording;\n    }\n\n    await new Promise(resolve => audioEl.addEventListener(\"canplay\", resolve));\n    mediaStream.addTrack(\n      audioEl.captureStream\n        ? audioEl.captureStream().getAudioTracks()[0]\n        : audioEl.mozCaptureStream\n          ? audioEl.mozCaptureStream().getAudioTracks()[0]\n          : null\n    );\n    NAF.connection.adapter.setLocalMediaStream(mediaStream);\n    audioEl.play();\n  };\n}\n","export default function pinnedEntityToGltf(el) {\n  if (!NAF.utils.isMine(el)) return;\n\n  // Construct a GLTF node from this entity\n  const object3D = el.object3D;\n  const components = el.components;\n  const networkId = components.networked.data.networkId;\n\n  const gltfComponents = {};\n  // TODO: Move to MOZ_hubs_components and include version number. Requires migration of existing room objects.\n  // Please do this before making a breaking change to the data stored here.\n  const gltfNode = { name: networkId, extensions: { HUBS_components: gltfComponents } };\n\n  // Adapted from three.js GLTFExporter\n  const equalArray = (x, y) => x.length === y.length && x.every((v, i) => v === y[i]);\n  const rotation = object3D.quaternion.toArray();\n  const position = object3D.position.toArray();\n  const scale = object3D.scale.toArray();\n\n  if (!equalArray(rotation, [0, 0, 0, 1])) gltfNode.rotation = rotation;\n  if (!equalArray(position, [0, 0, 0])) gltfNode.translation = position;\n  if (!equalArray(scale, [1, 1, 1])) gltfNode.scale = scale;\n\n  if (components[\"media-loader\"]) {\n    const mediaSrc = components[\"media-loader\"].data.src;\n    const mediaContentSubtype = components[\"media-loader\"].data.contentSubtype;\n\n    if (mediaSrc.startsWith(\"hubs://\") && mediaSrc.endsWith(\"/video\")) {\n      // Do not persist hubs client video urls\n      return null;\n    }\n\n    gltfComponents.media = { src: mediaSrc, contentSubtype: mediaContentSubtype, id: networkId };\n\n    if (components[\"media-pdf\"]) {\n      gltfComponents.media.pageIndex = components[\"media-pdf\"].data.index;\n    }\n\n    if (components[\"media-video\"] && components[\"media-video\"].data.videoPaused) {\n      gltfComponents.media.paused = true;\n      gltfComponents.media.time = components[\"media-video\"].data.time;\n    }\n  }\n\n  gltfComponents.pinnable = { pinned: true };\n\n  return gltfNode;\n}\n","import nextTick from \"./utils/next-tick.js\";\nconst INIT_TIMEOUT_MS = 5000;\n\n// Manages web push subscriptions\n//\nfunction urlBase64ToUint8Array(base64String) {\n  const padding = \"=\".repeat((4 - (base64String.length % 4)) % 4);\n  const base64 = (base64String + padding).replace(/-/g, \"+\").replace(/_/g, \"/\");\n\n  const rawData = window.atob(base64);\n  const outputArray = new Uint8Array(rawData.length);\n\n  for (let i = 0; i < rawData.length; ++i) {\n    outputArray[i] = rawData.charCodeAt(i);\n  }\n  return outputArray;\n}\n\nexport default class Subscriptions {\n  constructor(hubId) {\n    this.hubId = hubId;\n  }\n\n  setHubChannel = hubChannel => {\n    this.hubChannel = hubChannel;\n  };\n\n  setRegistration = registration => {\n    this.registration = registration;\n  };\n\n  setRegistrationFailed = () => {\n    this.registration = null;\n  };\n\n  setVapidPublicKey = vapidPublicKey => {\n    this.vapidPublicKey = vapidPublicKey;\n  };\n\n  setSubscribed = isSubscribed => {\n    this._isSubscribed = isSubscribed;\n  };\n\n  isSubscribed = () => {\n    return this._isSubscribed;\n  };\n\n  getCurrentEndpoint = async () => {\n    if (!navigator.serviceWorker) return null;\n    const startedAt = performance.now();\n\n    // registration becomes null if failed, non null if registered\n    while (this.registration === undefined && performance.now() - startedAt < INIT_TIMEOUT_MS) await nextTick();\n    if (performance.now() - startedAt >= INIT_TIMEOUT_MS) console.warn(\"Service worker registration timed out.\");\n    if (!this.registration || !this.registration.pushManager) return null;\n\n    while (this.vapidPublicKey === undefined) await nextTick();\n    if (this.vapidPublicKey === null) return null;\n\n    try {\n      const convertedVapidKey = urlBase64ToUint8Array(this.vapidPublicKey);\n\n      if (\n        (await this.registration.pushManager.permissionState({\n          userVisibleOnly: true,\n          applicationServerKey: convertedVapidKey\n        })) !== \"granted\"\n      )\n        return null;\n    } catch (e) {\n      return null; // Chrome can throw here complaining about userVisible if push is not right\n    }\n    const sub = await this.registration.pushManager.getSubscription();\n    if (!sub) return null;\n\n    return sub.endpoint;\n  };\n\n  toggle = async () => {\n    if (!this.registration) return;\n\n    if (this._isSubscribed) {\n      const pushSubscription = await this.registration.pushManager.getSubscription();\n      const res = await this.hubChannel.unsubscribe(pushSubscription);\n\n      if (res && res.has_remaining_subscriptions === false) {\n        pushSubscription.unsubscribe();\n      }\n    } else {\n      let pushSubscription = await this.registration.pushManager.getSubscription();\n\n      if (!pushSubscription) {\n        const convertedVapidKey = urlBase64ToUint8Array(this.vapidPublicKey);\n\n        pushSubscription = await this.registration.pushManager.subscribe({\n          userVisibleOnly: true,\n          applicationServerKey: convertedVapidKey\n        });\n      }\n\n      this.hubChannel.subscribe(pushSubscription);\n    }\n\n    this._isSubscribed = !this._isSubscribed;\n  };\n}\n","import { forEachMaterial } from \"../utils/material-utils\";\nimport qsTruthy from \"../utils/qs_truthy\";\n\nconst invaderPos = new AFRAME.THREE.Vector3();\nconst bubblePos = new AFRAME.THREE.Vector3();\nconst isDebug = qsTruthy(\"debug\");\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\n\n/**\n * Updates invaders every tick, doing one per frame on mobile VR.\n * testing multiline things\n * @namespace avatar/personal-space-bubble\n * @system personal-space-bubble\n */\nAFRAME.registerSystem(\"personal-space-bubble\", {\n  schema: {\n    debug: { default: false },\n    enabled: { default: true }\n  },\n\n  init() {\n    this.invaders = [];\n    this.bubbles = [];\n    this.tickCount = 0;\n    this._updateInvaders = this._updateInvaders.bind(this);\n  },\n\n  registerBubble(bubble) {\n    this.bubbles.push(bubble);\n  },\n\n  unregisterBubble(bubble) {\n    const index = this.bubbles.indexOf(bubble);\n\n    if (index !== -1) {\n      this.bubbles.splice(index, 1);\n    }\n  },\n\n  registerInvader(invader) {\n    NAF.utils.getNetworkedEntity(invader.el).then(networkedEl => {\n      const owner = NAF.utils.getNetworkOwner(networkedEl);\n\n      if (owner !== NAF.clientId) {\n        this.invaders.push(invader);\n      }\n    });\n  },\n\n  unregisterInvader(invader) {\n    const index = this.invaders.indexOf(invader);\n\n    if (index !== -1) {\n      this.invaders.splice(index, 1);\n    }\n  },\n\n  update() {\n    for (let i = 0; i < this.bubbles.length; i++) {\n      this.bubbles[i].updateDebug();\n    }\n\n    for (let i = 0; i < this.invaders.length; i++) {\n      this.invaders[i].updateDebug();\n      if (!this.data.enabled) {\n        this.invaders[i].setInvading(false);\n      }\n    }\n\n    if (this.data.enabled) {\n      this.el.addState(\"spacebubble\");\n    } else {\n      this.el.removeState(\"spacebubble\");\n    }\n  },\n\n  tick() {\n    this._updateInvaders();\n    this.tickCount++;\n  },\n\n  _updateInvaders: (function() {\n    const tempInvasionFlags = [];\n\n    const setInvaderFlag = (i, invaders, bubble) => {\n      // Hide the invader if inside the bubble\n      const invader = invaders[i];\n      invaderPos.setFromMatrixPosition(invader.el.object3D.matrixWorld);\n\n      const distanceSquared = bubblePos.distanceToSquared(invaderPos);\n      const radiusSum = bubble.data.radius + invader.data.radius;\n\n      if (distanceSquared < radiusSum * radiusSum) {\n        tempInvasionFlags[i] = true;\n      }\n    };\n\n    const flushInvadingFlagsForIndex = (i, invaders) => {\n      if (invaders[i].invading !== tempInvasionFlags[i]) {\n        invaders[i].setInvading(tempInvasionFlags[i]);\n      }\n    };\n\n    return function() {\n      if (!this.data.enabled) return;\n      if (this.invaders.length === 0) return;\n\n      tempInvasionFlags.length = 0;\n\n      // precondition for this stuff -- the bubbles and invaders need updated world matrices.\n      // right now this is satisfied because we update the world matrices in the character controller\n      for (let i = 0; i < this.invaders.length; i++) {\n        this.invaders[i].el.object3D.updateMatrices(); // We read matrixWorld below, update matrices here\n        tempInvasionFlags[i] = false;\n      }\n\n      // Loop through all of the space bubbles (usually one)\n      for (let i = 0; i < this.bubbles.length; i++) {\n        const bubble = this.bubbles[i];\n\n        bubble.el.object3D.updateMatrices();\n        bubblePos.setFromMatrixPosition(bubble.el.object3D.matrixWorld);\n\n        if (!isMobileVR) {\n          for (let j = 0; j < this.invaders.length; j++) {\n            setInvaderFlag(j, this.invaders, bubble);\n          }\n        } else {\n          // Optimization: update one invader per frame on mobile VR\n          setInvaderFlag(this.tickCount % this.invaders.length, this.invaders, bubble);\n        }\n      }\n\n      if (!isMobileVR) {\n        for (let i = 0; i < this.invaders.length; i++) {\n          flushInvadingFlagsForIndex(i, this.invaders);\n        }\n      } else {\n        flushInvadingFlagsForIndex(this.tickCount % this.invaders.length, this.invaders);\n      }\n    };\n  })()\n});\n\nfunction createSphereGizmo(radius) {\n  const geometry = new THREE.SphereBufferGeometry(radius, 10, 10);\n  const wireframe = new THREE.WireframeGeometry(geometry);\n  const line = new THREE.LineSegments(wireframe);\n  line.material.opacity = 0.5;\n  line.material.transparent = true;\n  return line;\n}\n\n// TODO: we need to come up with a more generic way of doing this as this is very specific to our avatars.\n/**\n * Specifies a mesh associated with an invader.\n * @namespace avatar/personal-space-bubble\n * @component space-invader-mesh\n */\nAFRAME.registerComponent(\"space-invader-mesh\", {\n  schema: {\n    meshName: { type: \"string\" }\n  },\n  update() {\n    this.targetMesh = this.el.object3D.getObjectByName(this.data.meshName);\n  }\n});\n\nfunction findInvaderMesh(entity) {\n  while (entity && !(entity.components && entity.components[\"space-invader-mesh\"])) {\n    entity = entity.parentNode;\n  }\n  return entity && entity.components[\"space-invader-mesh\"].targetMesh;\n}\n\nconst DEBUG_OBJ = \"psb-debug\";\n\n/**\n * Represents an entity that can invade a personal space bubble\n * @namespace avatar/personal-space-bubble\n * @component personal-space-invader\n */\nAFRAME.registerComponent(\"personal-space-invader\", {\n  schema: {\n    radius: { type: \"number\", default: 0.1 },\n    useMaterial: { default: false },\n    debug: { default: false },\n    invadingOpacity: { default: 0.3 }\n  },\n\n  init() {\n    const system = this.el.sceneEl.systems[\"personal-space-bubble\"];\n    system.registerInvader(this);\n    if (this.data.useMaterial) {\n      const mesh = findInvaderMesh(this.el);\n      if (mesh) {\n        this.targetMesh = mesh;\n      }\n    }\n    this.invading = false;\n  },\n\n  update() {\n    this.radiusSquared = this.data.radius * this.data.radius;\n    this.updateDebug();\n  },\n\n  updateDebug() {\n    const system = this.el.sceneEl.systems[\"personal-space-bubble\"];\n    if (system.data.debug || this.data.debug) {\n      !this.el.object3DMap[DEBUG_OBJ] && this.el.setObject3D(DEBUG_OBJ, createSphereGizmo(this.data.radius));\n    } else if (this.el.object3DMap[DEBUG_OBJ]) {\n      this.el.removeObject3D(DEBUG_OBJ);\n    }\n  },\n\n  remove() {\n    this.el.sceneEl.systems[\"personal-space-bubble\"].unregisterInvader(this);\n  },\n\n  setInvading(invading) {\n    if (this.invading === invading) return;\n\n    if (this.targetMesh && this.targetMesh.material) {\n      forEachMaterial(this.targetMesh, material => {\n        material.opacity = invading ? this.data.invadingOpacity : 1;\n        material.transparent = invading;\n      });\n    } else {\n      this.el.object3D.visible = !invading;\n    }\n    this.invading = invading;\n  }\n});\n\n/**\n * Represents a personal space bubble on an entity.\n * @namespace avatar/personal-space-bubble\n * @component personal-space-bubble\n */\nAFRAME.registerComponent(\"personal-space-bubble\", {\n  schema: {\n    radius: { type: \"number\", default: 0.8 },\n    debug: { default: false }\n  },\n  init() {\n    this.system.registerBubble(this);\n  },\n\n  update() {\n    this.radiusSquared = this.data.radius * this.data.radius;\n    this.updateDebug();\n  },\n\n  updateDebug() {\n    if (!isDebug) return;\n\n    if (this.system.data.debug || this.data.debug) {\n      !this.el.object3DMap[DEBUG_OBJ] && this.el.setObject3D(DEBUG_OBJ, createSphereGizmo(this.data.radius));\n    } else if (this.el.object3DMap[DEBUG_OBJ]) {\n      this.el.removeObject3D(DEBUG_OBJ);\n    }\n  },\n\n  remove() {\n    this.system.unregisterBubble(this);\n  }\n});\n","import { waitForDOMContentLoaded } from \"../utils/async-utils\";\n\nconst CAMERA_UPDATE_FRAME_DELAY = 10; // Update one camera every N'th frame\n\n// Used for tracking and managing camera tools in the scene\nAFRAME.registerSystem(\"camera-tools\", {\n  init() {\n    this.cameraEls = [];\n    this.cameraUpdateCount = 0;\n    this.ticks = 0;\n\n    waitForDOMContentLoaded().then(() => {\n      const playerModelEl = document.querySelector(\"#player-rig .model\");\n      playerModelEl.addEventListener(\"model-loading\", () => (this.playerHead = null));\n      playerModelEl.addEventListener(\"model-loaded\", this.updatePlayerHead.bind(this));\n      this.updatePlayerHead();\n    });\n  },\n\n  updatePlayerHead() {\n    const headEl = document.getElementById(\"player-head\");\n    this.playerHead = headEl && headEl.object3D;\n  },\n\n  register(el) {\n    this.cameraEls.push(el);\n    el.addEventListener(\"ownership-changed\", this._onOwnershipChange);\n    delete this.myCamera;\n  },\n\n  deregister(el) {\n    this.cameraEls = this.cameraEls.filter(c => c !== el);\n    el.removeEventListener(\"ownership-changed\", this._onOwnershipChange);\n    delete this.myCamera;\n  },\n\n  getMyCamera() {\n    if (this.myCamera !== undefined) return this.myCamera;\n    this.myCamera = this.cameraEls.find(NAF.utils.isMine) || null;\n    return this.myCamera;\n  },\n\n  _onOwnershipChange() {\n    this.myCamera = null;\n  },\n\n  tick() {\n    this.ticks++;\n\n    // We update at most one camera viewfinder per frame.\n    if (this.ticks % CAMERA_UPDATE_FRAME_DELAY === 0) {\n      if (this.cameraEls.length == 0) return;\n\n      this.cameraUpdateCount++;\n      this.cameraEls[this.cameraUpdateCount % this.cameraEls.length].components[\"camera-tool\"].updateViewfinder();\n    }\n  }\n});\n","import { paths } from \"../paths\";\n\n// TODO: Where do these values (500, 10, 2) come from?\nconst modeMod = {\n  [WheelEvent.DOM_DELTA_PIXEL]: 500,\n  [WheelEvent.DOM_DELTA_LINE]: 10,\n  [WheelEvent.DOM_DELTA_PAGE]: 2\n};\n\nconst isInModal = (() => {\n  let uiRoot = null;\n\n  return function() {\n    if (!uiRoot) {\n      uiRoot = document.querySelector(\".ui-root\");\n    }\n\n    return uiRoot && uiRoot.classList.contains(\"in-modal-or-overlay\");\n  };\n})();\n\nexport class MouseDevice {\n  constructor() {\n    this.events = [];\n    this.coords = [0, 0]; // normalized screenspace coordinates in [(-1, 1), (-1, 1)]\n    this.movementXY = [0, 0]; // deltas\n    this.buttonLeft = false;\n    this.buttonRight = false;\n    this.wheel = 0; // delta\n\n    const queueEvent = this.events.push.bind(this.events);\n    const canvas = document.querySelector(\"canvas\");\n    [\"mousedown\", \"wheel\"].map(x => canvas.addEventListener(x, queueEvent));\n    [\"mousemove\", \"mouseup\"].map(x => window.addEventListener(x, queueEvent));\n\n    document.addEventListener(\"wheel\", e => {\n      // Do not capture wheel events if they are being sent to an modal/overlay\n      if (!isInModal()) {\n        e.preventDefault();\n      }\n    });\n  }\n\n  process(event) {\n    if (event.type === \"wheel\") {\n      this.wheel += (event.deltaX + event.deltaY) / modeMod[event.deltaMode];\n      return true;\n    }\n\n    const left = event.button === 0;\n    const right = event.button === 2;\n    this.coords[0] = (event.clientX / window.innerWidth) * 2 - 1;\n    this.coords[1] = -(event.clientY / window.innerHeight) * 2 + 1;\n    this.movementXY[0] += event.movementX;\n    this.movementXY[1] += event.movementY;\n    if (event.type === \"mousedown\" && left) {\n      this.mouseDownLeftThisFrame = true;\n      this.buttonLeft = true;\n    } else if (event.type === \"mousedown\" && right) {\n      this.mouseDownRightThisFrame = true;\n      this.buttonRight = true;\n    } else if (event.type === \"mouseup\" && left) {\n      if (this.mouseDownLeftThisFrame) {\n        return false;\n      }\n      this.buttonLeft = false;\n    } else if (event.type === \"mouseup\" && right) {\n      if (this.mouseDownRightThisFrame) {\n        return false;\n      }\n      this.buttonRight = false;\n    }\n    return true;\n  }\n\n  write(frame) {\n    this.movementXY[0] = 0; // deltas\n    this.movementXY[1] = 0; // deltas\n    this.wheel = 0; // delta\n\n    this.didStopProcessingEarly = false;\n    this.mouseDownLeftThisFrame = false;\n    this.mouseDownRightThisFrame = false;\n\n    for (let i = 0; i < this.events.length; i++) {\n      const event = this.events[i];\n      if (!this.process(event)) {\n        this.didStopProcessingEarly = true;\n        this.events.splice(0, i);\n        break;\n      }\n    }\n\n    if (!this.didStopProcessingEarly) {\n      this.events.length = 0;\n    }\n\n    frame.setVector2(paths.device.mouse.coords, this.coords[0], this.coords[1]);\n    frame.setVector2(paths.device.mouse.movementXY, this.movementXY[0], this.movementXY[1]);\n    frame.setValueType(paths.device.mouse.buttonLeft, this.buttonLeft);\n    frame.setValueType(paths.device.mouse.buttonRight, this.buttonRight);\n    frame.setValueType(paths.device.mouse.wheel, this.wheel);\n  }\n}\n\nwindow.oncontextmenu = e => {\n  if (!isInModal()) {\n    e.preventDefault();\n  }\n};\n","// You might prefer to use this over a Set because iterating over a set allocates memory\nexport function ArrayBackedSet(initialItems) {\n  return {\n    items: initialItems || [],\n    has(item) {\n      return this.items.indexOf(item) !== -1;\n    },\n    add(item) {\n      if (!this.has(item)) {\n        this.items.push(item);\n      }\n    },\n    delete(item) {\n      const index = this.items.indexOf(item);\n      if (index !== -1) {\n        this.items[index] = this.items[this.items.length - 1];\n        this.items.pop();\n      }\n    },\n    clear() {\n      this.items.length = 0;\n    }\n  };\n}\n","import { paths } from \"../paths\";\nimport { ArrayBackedSet } from \"../array-backed-set\";\nexport class KeyboardDevice {\n  constructor() {\n    this.seenKeys = new ArrayBackedSet();\n    this.keys = {};\n    this.events = [];\n\n    [\"keydown\", \"keyup\"].map(x =>\n      document.addEventListener(x, e => {\n        if (!e.key) return;\n        this.events.push(e);\n\n        // Block browser hotkeys for chat command, media browser and freeze\n        if (\n          (e.type === \"keydown\" &&\n            e.key === \"/\" &&\n            ![\"TEXTAREA\", \"INPUT\"].includes(document.activeElement && document.activeElement.nodeName) &&\n            !(document.activeElement && document.activeElement.contentEditable === \"true\")) ||\n          (e.ctrlKey &&\n            (e.key === \"1\" ||\n              e.key === \"2\" ||\n              e.key === \"3\" ||\n              e.key === \"4\" ||\n              e.key === \"5\" ||\n              e.key === \"6\" ||\n              e.key === \"7\" ||\n              e.key === \"8\" ||\n              e.key === \"9\" ||\n              e.key === \"0\")) ||\n          e.key === \"Tab\"\n        ) {\n          e.preventDefault();\n          return false;\n        }\n      })\n    );\n    [\"blur\"].map(x => window.addEventListener(x, this.events.push.bind(this.events)));\n  }\n\n  write(frame) {\n    for (let i = 0; i < this.events.length; i++) {\n      const event = this.events[i];\n      if (event.type === \"blur\") {\n        this.keys = {};\n        this.seenKeys.clear();\n      } else {\n        const key = event.key.toLowerCase();\n        this.keys[key] = event.type === \"keydown\";\n        this.seenKeys.add(key);\n      }\n    }\n\n    this.events.length = 0;\n\n    for (let i = 0; i < this.seenKeys.items.length; i++) {\n      const key = this.seenKeys.items[i];\n      const path = paths.device.keyboard.key(key);\n      frame.setValueType(path, this.keys[key]);\n    }\n  }\n}\n","import { paths } from \"../paths\";\n\nexport class HudDevice {\n  constructor() {\n    this.events = [];\n    document.querySelector(\"a-scene\").addEventListener(\"penButtonPressed\", this.events.push.bind(this.events));\n  }\n\n  write(frame) {\n    frame.setValueType(paths.device.hud.penButton, this.events.length !== 0);\n    while (this.events.length) {\n      this.events.pop();\n    }\n  }\n}\n","import { paths } from \"../paths\";\n\nexport class XboxControllerDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n    this.buttonMap = [\n      { name: \"a\", buttonId: 0 },\n      { name: \"b\", buttonId: 1 },\n      { name: \"x\", buttonId: 2 },\n      { name: \"y\", buttonId: 3 },\n      { name: \"leftBumper\", buttonId: 4 },\n      { name: \"rightBumper\", buttonId: 5 },\n      { name: \"leftTrigger\", buttonId: 6 },\n      { name: \"rightTrigger\", buttonId: 7 },\n      { name: \"back\", buttonId: 8 },\n      { name: \"start\", buttonId: 9 },\n      { name: \"leftJoystick\", buttonId: 10 },\n      { name: \"rightJoystick\", buttonId: 11 },\n      { name: \"dpadUp\", buttonId: 12 },\n      { name: \"dpadDown\", buttonId: 13 },\n      { name: \"dpadLeft\", buttonId: 14 },\n      { name: \"dpadRight\", buttonId: 15 }\n    ];\n    this.axisMap = [\n      { name: \"leftJoystickHorizontal\", axisId: 0 },\n      { name: \"leftJoystickVertical\", axisId: 1 },\n      { name: \"rightJoystickHorizontal\", axisId: 2 },\n      { name: \"rightJoystickVertical\", axisId: 3 }\n    ];\n  }\n\n  write(frame) {\n    this.gamepad = navigator.getGamepads()[this.gamepad.index];\n    if (this.gamepad.connected) {\n      const xboxPaths = paths.device.xbox;\n      this.buttonMap.forEach(b => {\n        const path = xboxPaths.button(b.name);\n        const button = this.gamepad.buttons[b.buttonId];\n        frame.setValueType(path.pressed, !!button.pressed);\n        frame.setValueType(path.touched, !!button.touched);\n        frame.setValueType(path.value, button.value);\n      });\n      frame.setValueType(xboxPaths.axesSum, 0);\n      this.axisMap.forEach(axis => {\n        frame.setValueType(xboxPaths.axis(axis.name), this.gamepad.axes[axis.axisId]);\n        frame.setValueType(xboxPaths.axesSum, frame.get(xboxPaths.axesSum) + Math.abs(this.gamepad.axes[axis.axisId]));\n      });\n\n      if (this.gamepad.hapticActuators && this.gamepad.hapticActuators[0]) {\n        frame.setValueType(paths.haptics.actuators[this.gamepad.hand], this.gamepad.hapticActuators[0]);\n      }\n    }\n  }\n}\n","const THREE = typeof window !== \"undefined\" && window.THREE;\nconst Vector3 = (THREE && THREE.Vector3) || function() {};\nconst Quaternion = (THREE && THREE.Quaternion) || function() {};\nconst forward = typeof window !== \"undefined\" && window.THREE && new THREE.Vector3(0, 0, -1);\nexport function Pose() {\n  return {\n    position: new Vector3(),\n    direction: new Vector3(),\n    orientation: new Quaternion(),\n    fromOriginAndDirection: function(origin, direction) {\n      this.position = origin;\n      this.direction = direction;\n      this.orientation = this.orientation.setFromUnitVectors(forward, direction);\n      return this;\n    },\n    fromCameraProjection: function(camera, normalizedX, normalizedY) {\n      this.position.setFromMatrixPosition(camera.matrixWorld);\n      this.direction\n        .set(normalizedX, normalizedY, 0.5)\n        .unproject(camera)\n        .sub(this.position)\n        .normalize();\n      this.fromOriginAndDirection(this.position, this.direction);\n      return this;\n    },\n    copy: function(pose) {\n      this.position.copy(pose.position);\n      this.direction.copy(pose.direction);\n      this.orientation.copy(pose.orientation);\n    }\n  };\n}\n","// Vector from eyes to elbow (divided by user height).\nconst EYES_TO_ELBOW = { x: 0.175, y: -0.3, z: -0.03 };\n// Vector from eyes to elbow (divided by user height).\nconst FOREARM = { x: 0, y: 0, z: -0.175 };\n\nexport const applyArmModel = (function() {\n  const controllerEuler = new THREE.Euler();\n  const deltaControllerPosition = new THREE.Vector3();\n  const controllerQuaternion = new THREE.Quaternion();\n  const controllerPosition = new THREE.Vector3();\n  return function applyArmModel(gamepadPose, hand, headObject3D, userHeight) {\n    headObject3D.updateMatrices();\n    controllerPosition.copy(headObject3D.position);\n    controllerPosition.y = controllerPosition.y - userHeight;\n    deltaControllerPosition.set(\n      EYES_TO_ELBOW.x * (hand === \"left\" ? -1 : hand === \"right\" ? 1 : 0),\n      EYES_TO_ELBOW.y,\n      EYES_TO_ELBOW.z\n    );\n    deltaControllerPosition.multiplyScalar(userHeight);\n    deltaControllerPosition.applyAxisAngle(headObject3D.up, headObject3D.rotation.y);\n    controllerPosition.add(deltaControllerPosition);\n    deltaControllerPosition.set(FOREARM.x, FOREARM.y, FOREARM.z);\n    deltaControllerPosition.multiplyScalar(userHeight);\n    controllerQuaternion.fromArray(gamepadPose.orientation);\n    controllerEuler.setFromQuaternion(controllerQuaternion);\n    controllerEuler.set(controllerEuler.x, controllerEuler.y, 0);\n    deltaControllerPosition.applyEuler(controllerEuler);\n    controllerPosition.add(deltaControllerPosition);\n    return controllerPosition;\n  };\n})();\n","export const copySittingToStandingTransform = function copySittingToStandingTransform(matrix) {\n  navigator.getVRDisplays &&\n    navigator.getVRDisplays().then(displays => {\n      if (displays[0] && displays[0].stageParameters && displays[0].stageParameters.sittingToStandingTransform) {\n        matrix.fromArray(displays[0].stageParameters.sittingToStandingTransform);\n      }\n    });\n};\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { applyArmModel } from \"../arm-model.js\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\n\nconst TOUCHPAD = paths.device.oculusgo.touchpad;\nconst TRIGGER = paths.device.oculusgo.trigger;\n\nexport class OculusGoControllerDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n    this.rayObjectRotation = new THREE.Quaternion();\n    this.pose = new Pose();\n    this.q = new THREE.Quaternion();\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n    this.matrix = new THREE.Matrix4();\n    this.orientation = new THREE.Quaternion();\n\n    // TODO ideally we should just be getting pose from the gamepad\n    // TODO if controller is set to left hand, we still use right hand query here\n    // because otherwise things break.\n    this.rayObject = document.querySelector(\"#player-right-controller\").object3D;\n    this.headObject3D = document.querySelector(\"#player-camera\").object3D;\n    navigator.getGamepads();\n  }\n\n  write(frame) {\n    // Have to call navigator.getGamepads() in order for the gamepad object to update.\n    navigator.getGamepads();\n    if (this.gamepad.connected) {\n      frame.setValueType(TOUCHPAD.axisX, this.gamepad.axes[0]);\n      frame.setValueType(TOUCHPAD.axisY, this.gamepad.axes[1]);\n      frame.setValueType(TOUCHPAD.pressed, this.gamepad.buttons[0].pressed);\n      frame.setValueType(TOUCHPAD.touched, this.gamepad.buttons[0].touched);\n      frame.setValueType(TOUCHPAD.value, this.gamepad.buttons[0].value);\n      frame.setValueType(TRIGGER.pressed, this.gamepad.buttons[1].pressed);\n      frame.setValueType(TRIGGER.touched, this.gamepad.buttons[1].touched);\n      frame.setValueType(TRIGGER.value, this.gamepad.buttons[1].value);\n\n      this.rayObject.updateMatrices();\n      this.rayObject.getWorldQuaternion(this.q);\n      frame.setValueType(paths.actions.rayObjectRotation, this.q);\n      const rayMatrixWorld = this.rayObject.matrixWorld;\n      this.rayObjectRotation.setFromRotationMatrix(rayMatrixWorld);\n      this.pose.position.setFromMatrixPosition(rayMatrixWorld);\n      this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n      this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n      frame.setPose(paths.device.oculusgo.pose, this.pose);\n\n      if (this.gamepad.pose.orientation) {\n        // TODO if controller is set to left hand, we still draw right hand until\n        // bindings are overhauled to handle primary/secondary hands.\n        frame.setMatrix4(\n          paths.device.oculusgo.matrix,\n          this.matrix\n            .compose(\n              applyArmModel(this.gamepad.pose, this.gamepad.hand, this.headObject3D, 1.6),\n              this.orientation.fromArray(this.gamepad.pose.orientation),\n              ONES\n            )\n            .premultiply(this.sittingToStandingMatrix)\n        );\n      }\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { applyArmModel } from \"../arm-model.js\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\n\nconst TOUCHPAD = paths.device.gearVRController.button(\"touchpad\");\nconst TRIGGER = paths.device.gearVRController.button(\"trigger\");\nconst TOUCHPAD_X = paths.device.gearVRController.axis(\"touchpadX\");\nconst TOUCHPAD_Y = paths.device.gearVRController.axis(\"touchpadY\");\n\nexport class GearVRControllerDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n    this.buttonMap = [{ name: \"touchpad\", buttonId: 0 }, { name: \"trigger\", buttonId: 1 }];\n    this.axisMap = [{ name: \"touchpadX\", axisId: 0 }, { name: \"touchpadY\", axisId: 1 }];\n\n    this.rayObjectRotation = new THREE.Quaternion();\n    this.selector = `#player-${gamepad.hand}-controller`;\n    this.pose = new Pose();\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n\n    this.matrix = new THREE.Matrix4();\n    this.orientation = new THREE.Quaternion();\n  }\n\n  write(frame) {\n    // Chrome requires a call to getGamepads() for the gamepad state to update.\n    navigator.getGamepads();\n    if (this.gamepad.connected) {\n      const touchpad = this.gamepad.buttons[0];\n      frame.setValueType(TOUCHPAD.pressed, !!touchpad.pressed);\n      frame.setValueType(TOUCHPAD.touched, !!touchpad.touched);\n      frame.setValueType(TOUCHPAD.value, !!touchpad.value);\n\n      const trigger = this.gamepad.buttons[1];\n      frame.setValueType(TRIGGER.pressed, !!trigger.pressed);\n      frame.setValueType(TRIGGER.touched, !!trigger.touched);\n      frame.setValueType(TRIGGER.value, !!trigger.value);\n\n      frame.setValueType(TOUCHPAD_X, this.gamepad.axes[0]);\n      frame.setValueType(TOUCHPAD_Y, this.gamepad.axes[1]);\n\n      // TODO we should just be getting pose from the gamepad\n      if (!this.rayObject) {\n        this.rayObject = document.querySelector(this.selector).object3D;\n      }\n      this.rayObject.updateMatrixWorld();\n      this.rayObjectRotation.setFromRotationMatrix(this.rayObject.matrixWorld);\n      this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\n      this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n      this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n      frame.setPose(paths.device.gearVRController.pose, this.pose);\n      this.headObject3D = this.headObject3D || document.querySelector(\"#player-camera\").object3D;\n      if (this.gamepad.pose.orientation) {\n        frame.setMatrix4(\n          paths.device.gearVRController.matrix,\n          this.matrix\n            .compose(\n              applyArmModel(this.gamepad.pose, this.gamepad.hand, this.headObject3D, 1.6),\n              this.orientation.fromArray(this.gamepad.pose.orientation),\n              ONES\n            )\n            .premultiply(this.sittingToStandingMatrix)\n        );\n      }\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\n\nexport const leftOculusTouchButtonMap = [\n  { name: \"thumbStick\", buttonId: 0 },\n  { name: \"trigger\", buttonId: 1 },\n  { name: \"grip\", buttonId: 2 },\n  { name: \"x\", buttonId: 3 },\n  { name: \"y\", buttonId: 4 }\n];\nexport const rightOculusTouchButtonMap = [\n  { name: \"thumbStick\", buttonId: 0 },\n  { name: \"trigger\", buttonId: 1 },\n  { name: \"grip\", buttonId: 2 },\n  { name: \"a\", buttonId: 3 },\n  { name: \"b\", buttonId: 4 }\n];\n\nconst LEFT_HAND_OFFSET = new THREE.Matrix4().makeTranslation(-0.025, -0.03, 0.1);\nconst RIGHT_HAND_OFFSET = new THREE.Matrix4().makeTranslation(0.025, -0.03, 0.1);\n\nexport class OculusTouchControllerDevice {\n  constructor(gamepad) {\n    this.rayObjectRotation = new THREE.Quaternion();\n\n    // wake the gamepad api up. otherwise it does not report touch controllers.\n    // in chrome it still won't unless you enter vr.\n    navigator.getVRDisplays();\n\n    const buttonMaps = {\n      left: leftOculusTouchButtonMap,\n      right: rightOculusTouchButtonMap\n    };\n\n    const devicePaths = {\n      left: paths.device.leftOculusTouch,\n      right: paths.device.rightOculusTouch\n    };\n\n    this.gamepad = gamepad;\n    this.pose = new Pose();\n    this.buttonMap = buttonMaps[gamepad.hand];\n    this.axisMap = [{ name: \"joyX\", axisId: 0 }, { name: \"joyY\", axisId: 1 }];\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n    this.matrix = new THREE.Matrix4();\n    this.path = devicePaths[gamepad.hand];\n    this.selector = `#player-${gamepad.hand}-controller`;\n\n    this.position = new THREE.Vector3();\n    this.orientation = new THREE.Quaternion();\n    this.handOffset = this.gamepad.hand === \"left\" ? LEFT_HAND_OFFSET : RIGHT_HAND_OFFSET;\n  }\n\n  write(frame) {\n    if (!this.gamepad) return;\n    this.gamepad = navigator.getGamepads()[this.gamepad.index];\n    if (!this.gamepad || !this.gamepad.connected) return;\n\n    this.buttonMap.forEach(b => {\n      const path = this.path.button(b.name);\n      const button = this.gamepad.buttons[b.buttonId];\n      frame.setValueType(path.pressed, !!button.pressed);\n      frame.setValueType(path.touched, !!button.touched);\n      frame.setValueType(path.value, button.value);\n    });\n    frame.setValueType(this.path.axesSum, 0);\n    this.axisMap.forEach(axis => {\n      frame.setValueType(this.path.axis(axis.name), this.gamepad.axes[axis.axisId]);\n      frame.setValueType(this.path.axesSum, frame.get(this.path.axesSum) + Math.abs(this.gamepad.axes[axis.axisId]));\n    });\n\n    this.rayObject = this.rayObject || document.querySelector(this.selector).object3D;\n    this.rayObject.updateMatrixWorld();\n    this.rayObjectRotation.setFromRotationMatrix(this.rayObject.matrixWorld);\n    this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\n    this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n    this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n    frame.setPose(this.path.pose, this.pose);\n    if (this.gamepad.pose.position && this.gamepad.pose.orientation) {\n      frame.setMatrix4(\n        this.path.matrix,\n        this.matrix\n          .compose(\n            this.position.fromArray(this.gamepad.pose.position),\n            this.orientation.fromArray(this.gamepad.pose.orientation),\n            ONES\n          )\n          .premultiply(this.sittingToStandingMatrix)\n          .multiply(this.handOffset)\n      );\n    }\n    if (this.gamepad.hapticActuators && this.gamepad.hapticActuators[0]) {\n      frame.setValueType(paths.haptics.actuators[this.gamepad.hand], this.gamepad.hapticActuators[0]);\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { applyArmModel } from \"../arm-model\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\nconst HAND_OFFSET = new THREE.Matrix4().makeTranslation(0, 0, -0.04);\n\nconst TOUCHPAD = paths.device.daydream.button(\"touchpad\");\nconst TOUCHPAD_X = paths.device.daydream.axis(\"touchpadX\");\nconst TOUCHPAD_Y = paths.device.daydream.axis(\"touchpadY\");\nconst POSE = paths.device.daydream.pose;\nconst MATRIX = paths.device.daydream.matrix;\n\nexport class DaydreamControllerDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n\n    this.rayObjectRotation = new THREE.Quaternion();\n    this.selector = `#player-${gamepad.hand || \"right\"}-controller`;\n    this.pose = new Pose();\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n    this.matrix = new THREE.Matrix4();\n    this.orientation = new THREE.Quaternion();\n  }\n\n  write(frame) {\n    this.gamepad = navigator.getGamepads()[0];\n    if (this.gamepad && this.gamepad.connected) {\n      const button = this.gamepad.buttons[0];\n      frame.setValueType(TOUCHPAD.pressed, !!button.pressed);\n      frame.setValueType(TOUCHPAD.touched, !!button.touched);\n      frame.setValueType(TOUCHPAD.value, !!button.value);\n\n      frame.setValueType(TOUCHPAD_X, this.gamepad.axes[0]);\n      frame.setValueType(TOUCHPAD_Y, this.gamepad.axes[1]);\n\n      // TODO ideally we should just be getting pose from the gamepad\n      if (!this.rayObject) {\n        this.rayObject = document.querySelector(this.selector).object3D;\n      }\n      this.rayObject.updateMatrixWorld();\n      this.rayObjectRotation.setFromRotationMatrix(this.rayObject.matrixWorld);\n      this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\n      this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n      this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n      frame.setPose(POSE, this.pose);\n\n      this.headObject3D = this.headObject3D || document.querySelector(\"#player-camera\").object3D;\n\n      if (this.gamepad.pose.orientation) {\n        frame.setMatrix4(\n          MATRIX,\n          this.matrix\n            .compose(\n              applyArmModel(this.gamepad.pose, this.gamepad.hand, this.headObject3D, 1.6),\n              this.orientation.fromArray(this.gamepad.pose.orientation),\n              ONES\n            )\n            .premultiply(this.sittingToStandingMatrix)\n            .multiply(HAND_OFFSET)\n        );\n      }\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\nconst HAND_OFFSET = new THREE.Matrix4().compose(\n  new THREE.Vector3(0, 0, 0.13),\n  new THREE.Quaternion().setFromEuler(new THREE.Euler(-40 * THREE.Math.DEG2RAD, 0, 0)),\n  new THREE.Vector3(1, 1, 1)\n);\nconst RAY_ROTATION = new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(1, 0, 0), -Math.PI / 12);\n\nexport class ViveControllerDevice {\n  constructor(gamepad) {\n    // wake the gamepad api up. otherwise it does not report touch controllers.\n    // in chrome it still won't unless you enter vr.\n    navigator.getVRDisplays();\n    this.gamepad = gamepad;\n\n    if (this.gamepad.id === \"HTC Vive Focus Plus Controller\") {\n      this.buttonMap = [\n        { name: \"touchpad\", buttonId: 0 },\n        { name: \"trigger\", buttonId: 1 },\n        { name: \"grip\", buttonId: 2 }\n      ];\n    } else {\n      if (gamepad.axes.length === 2) {\n        this.isViveWand = true;\n      }\n      this.buttonMap = [\n        { name: \"touchpad\", buttonId: 0 },\n        { name: \"trigger\", buttonId: 1 },\n        { name: \"grip\", buttonId: 2 },\n        { name: \"top\", buttonId: 3 }\n      ];\n    }\n    this.axisMap = [\n      { name: \"touchX\", axisId: 0 },\n      { name: \"touchY\", axisId: 1 },\n      { name: \"joyX\", axisId: 2 },\n      { name: \"joyY\", axisId: 3 }\n    ];\n\n    this.pose = new Pose();\n    this.rayObjectRotation = new THREE.Quaternion();\n    this.path = paths.device.vive[gamepad.hand || \"right\"];\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n\n    this.matrix = new THREE.Matrix4();\n    this.position = new THREE.Vector3();\n    this.orientation = new THREE.Quaternion();\n  }\n\n  write(frame) {\n    const gamepads = navigator.getGamepads();\n    if (gamepads.length < this.gamepad.index + 1) {\n      //workaround for: https://bugzilla.mozilla.org/show_bug.cgi?id=1568076\n      return;\n    }\n    this.gamepad = gamepads[this.gamepad.index];\n    if (!this.gamepad.connected) return;\n\n    this.buttonMap.forEach(b => {\n      const path = this.path.button(b.name);\n      const button = this.gamepad.buttons[b.buttonId];\n      frame.setValueType(path.pressed, !!button.pressed);\n      frame.setValueType(path.touched, !!button.touched);\n      frame.setValueType(path.value, button.value);\n    });\n    frame.setValueType(this.path.axesSum, 0);\n    this.axisMap.forEach(axis => {\n      frame.setValueType(this.path.axis(axis.name), this.gamepad.axes[axis.axisId]);\n      frame.setValueType(this.path.axesSum, frame.get(this.path.axesSum) + Math.abs(this.gamepad.axes[axis.axisId]));\n    });\n\n    if (!this.selector) {\n      if (this.gamepad.hand) {\n        this.path = paths.device.vive[this.gamepad.hand];\n        this.selector = `#player-${this.gamepad.hand}-controller`;\n        console.warn(\"gamepad hand eventually specified\");\n      } else {\n        return;\n      }\n    }\n    const el = document.querySelector(this.selector);\n    const rayObject = el.object3D;\n    rayObject.updateMatrixWorld();\n    this.rayObjectRotation.setFromRotationMatrix(rayObject.matrixWorld);\n    this.pose.position.setFromMatrixPosition(rayObject.matrixWorld);\n    this.pose.direction\n      .set(0, 0, -1)\n      .applyQuaternion(RAY_ROTATION)\n      .applyQuaternion(this.rayObjectRotation);\n    this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n    frame.setPose(this.path.pose, this.pose);\n\n    if (this.gamepad.pose.position && this.gamepad.pose.orientation) {\n      frame.setMatrix4(\n        this.path.matrix,\n        this.matrix\n          .compose(\n            this.position.fromArray(this.gamepad.pose.position),\n            this.orientation.fromArray(this.gamepad.pose.orientation),\n            ONES\n          )\n          .premultiply(this.sittingToStandingMatrix)\n          .multiply(HAND_OFFSET)\n      );\n    }\n\n    if (this.gamepad.hapticActuators && this.gamepad.hapticActuators[0]) {\n      frame.setValueType(paths.haptics.actuators[this.gamepad.hand], this.gamepad.hapticActuators[0]);\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\nconst ONES = new THREE.Vector3(1, 1, 1);\nconst HAND_OFFSET = new THREE.Matrix4().compose(\n  new THREE.Vector3(0, -0.017, 0.13),\n  new THREE.Quaternion().setFromEuler(new THREE.Euler(-40 * THREE.Math.DEG2RAD, 0, 0)),\n  new THREE.Vector3(1, 1, 1)\n);\n\nexport class WindowsMixedRealityControllerDevice {\n  constructor(gamepad) {\n    this.rayObject = null;\n    this.rayObjectRotation = new THREE.Quaternion();\n\n    // wake the gamepad api up. otherwise it does not report touch controllers.\n    // in chrome it still won't unless you enter vr.\n    navigator.getVRDisplays();\n\n    this.gamepad = gamepad;\n    this.pose = new Pose();\n\n    if (gamepad.hand) {\n      this.selector = `#player-${gamepad.hand}-controller`;\n    }\n\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n    this.matrix = new THREE.Matrix4();\n    this.position = new THREE.Vector3();\n    this.orientation = new THREE.Quaternion();\n  }\n  write(frame) {\n    this.gamepad = navigator.getGamepads()[this.gamepad.index];\n    if (!this.gamepad.connected) return;\n\n    const path = paths.device.wmr[this.gamepad.hand || \"right\"];\n\n    frame.setValueType(path.touchpad.pressed, this.gamepad.buttons[0].pressed);\n    frame.setValueType(path.touchpad.touched, this.gamepad.buttons[0].touched);\n    frame.setValueType(path.touchpad.value, this.gamepad.buttons[0].value);\n\n    frame.setValueType(path.trigger.pressed, this.gamepad.buttons[1].pressed);\n    frame.setValueType(path.trigger.touched, this.gamepad.buttons[1].touched);\n    frame.setValueType(path.trigger.value, this.gamepad.buttons[1].value);\n\n    frame.setValueType(path.grip.pressed, this.gamepad.buttons[2].pressed);\n    frame.setValueType(path.grip.touched, this.gamepad.buttons[2].touched);\n    frame.setValueType(path.grip.value, this.gamepad.buttons[2].value);\n\n    frame.setValueType(path.menu.pressed, this.gamepad.buttons[3].pressed);\n    frame.setValueType(path.menu.touched, this.gamepad.buttons[3].touched);\n    frame.setValueType(path.menu.value, this.gamepad.buttons[3].value);\n\n    frame.setValueType(path.touchpad.axisX, this.gamepad.axes[0]);\n    frame.setValueType(path.touchpad.axisY, this.gamepad.axes[1]);\n    frame.setValueType(path.joystick.axisX, this.gamepad.axes[2]);\n    frame.setValueType(path.joystick.axisY, this.gamepad.axes[3]);\n\n    if (!this.selector) {\n      if (!this.gamepad.hand) return;\n      this.selector = `#player-${this.gamepad.hand}-controller`;\n    }\n\n    this.rayObject = this.rayObject || document.querySelector(this.selector).object3D;\n    this.rayObject.updateMatrixWorld();\n    this.rayObjectRotation.setFromRotationMatrix(this.rayObject.matrixWorld);\n\n    this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\n    this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n    this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n    frame.setPose(path.pose, this.pose);\n\n    if (this.gamepad.pose.position && this.gamepad.pose.orientation) {\n      frame.setMatrix4(\n        path.matrix,\n        this.matrix\n          .compose(\n            this.position.fromArray(this.gamepad.pose.position),\n            this.orientation.fromArray(this.gamepad.pose.orientation),\n            ONES\n          )\n          .premultiply(this.sittingToStandingMatrix)\n          .multiply(HAND_OFFSET)\n      );\n    }\n\n    if (this.gamepad.hapticActuators && this.gamepad.hapticActuators[0]) {\n      frame.setValueType(paths.haptics.actuators[this.gamepad.hand], this.gamepad.hapticActuators[0]);\n    }\n  }\n}\n","import { paths } from \"../paths\";\n\nconst TWOPI = Math.PI * 2;\n\nclass CircularBuffer {\n  constructor(length) {\n    this.items = new Array(length).fill(0);\n    this.writePtr = 0;\n  }\n\n  push(item) {\n    this.items[this.writePtr] = item;\n    this.writePtr = (this.writePtr + 1) % this.items.length;\n  }\n}\n\nconst abs = Math.abs;\n// Input: two numbers between [-Math.PI, Math.PI]\n// Output: difference between them, where -Math.PI === Math.PI\nconst difference = (curr, prev) => {\n  const a = curr - prev;\n  const b = curr + TWOPI - prev;\n  const c = curr - (prev + TWOPI);\n  if (abs(a) < abs(b)) {\n    if (abs(a) < abs(c)) {\n      return a;\n    }\n  }\n  if (abs(b) < abs(c)) {\n    return b;\n  }\n\n  return c;\n};\n\nconst average = a => {\n  let sum = 0;\n  for (let i = 0; i < a.length; i++) {\n    const n = a[i];\n    sum += n;\n  }\n  return sum / a.length;\n};\n\nexport class GyroDevice {\n  constructor() {\n    this.hmdEuler = new THREE.Euler();\n    this.hmdQuaternion = new THREE.Quaternion();\n    this.prevX = this.hmdEuler.x;\n    this.prevY = this.hmdEuler.y;\n    this.dXBuffer = new CircularBuffer(6);\n    this.dYBuffer = new CircularBuffer(6);\n    this.hasPolyfill = window.webvrpolyfill;\n    if (this.hasPolyfill) {\n      this.vrDisplay = window.webvrpolyfill.getPolyfillDisplays()[0];\n      this.frameData = new window.webvrpolyfill.constructor.VRFrameData();\n    }\n  }\n\n  write(frame) {\n    if (!this.hasPolyfill) {\n      return;\n    }\n    const hmdEuler = this.hmdEuler;\n    this.vrDisplay.getFrameData(this.frameData);\n    if (this.frameData.pose.orientation !== null) {\n      this.hmdQuaternion.fromArray(this.frameData.pose.orientation);\n      hmdEuler.setFromQuaternion(this.hmdQuaternion, \"YXZ\");\n    }\n\n    // Don't use gyro values when device is lying flat\n    if (hmdEuler.x < -Math.PI * 0.475) return;\n\n    const dX = THREE.Math.RAD2DEG * difference(hmdEuler.x, this.prevX);\n    const dY = THREE.Math.RAD2DEG * difference(hmdEuler.y, this.prevY);\n\n    this.dXBuffer.push(Math.abs(dX) < 0.001 ? 0 : dX);\n    this.dYBuffer.push(Math.abs(dY) < 0.001 ? 0 : dY);\n\n    this.averageDeltaX = average(this.dXBuffer.items);\n    this.averageDeltaY = average(this.dYBuffer.items);\n\n    this.prevX = hmdEuler.x;\n    this.prevY = hmdEuler.y;\n    frame.setValueType(paths.device.gyro.averageDeltaX, this.averageDeltaX);\n    frame.setValueType(paths.device.gyro.averageDeltaY, this.averageDeltaY);\n  }\n}\n","/* global AFRAME Ammo NAF */\nimport { paths } from \"./userinput/paths\";\nimport { SOUND_HOVER_OR_GRAB } from \"./sound-effects-system\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\nimport { canMove } from \"../utils/permissions-utils\";\n\nfunction findHandCollisionTargetForHand(body) {\n  const driver = AFRAME.scenes[0].systems.physics.driver;\n  const numManifolds = driver.dispatcher.getNumManifolds();\n  const handPtr = Ammo.getPointer(body);\n  for (let i = 0; i < numManifolds; i++) {\n    const persistentManifold = driver.dispatcher.getManifoldByIndexInternal(i);\n    const body0ptr = Ammo.getPointer(persistentManifold.getBody0());\n    const body1ptr = Ammo.getPointer(persistentManifold.getBody1());\n    if (handPtr !== body0ptr && handPtr !== body1ptr) {\n      continue;\n    }\n    const numContacts = persistentManifold.getNumContacts();\n    for (let j = 0; j < numContacts; j++) {\n      const manifoldPoint = persistentManifold.getContactPoint(j);\n      if (manifoldPoint.getDistance() <= 10e-6) {\n        const object3D = driver.els.get(handPtr === body0ptr ? body1ptr : body0ptr).object3D;\n        if (object3D.el && object3D.el.components.tags && object3D.el.components.tags.data.isHandCollisionTarget) {\n          return object3D.el;\n        }\n        return null;\n      }\n    }\n  }\n  return null;\n}\n\nconst remoteHoverTargets = new Map();\nexport function findRemoteHoverTarget(object3D) {\n  if (!object3D) return null;\n  const target = remoteHoverTargets.get(object3D);\n  return target || findRemoteHoverTarget(object3D.parent);\n}\nAFRAME.registerComponent(\"is-remote-hover-target\", {\n  init: function() {\n    remoteHoverTargets.set(this.el.object3D, this.el);\n  },\n  remove: function() {\n    remoteHoverTargets.delete(this.el.object3D);\n  }\n});\n\nfunction isUI(el) {\n  return (\n    el && el.components.tags && (el.components.tags.data.singleActionButton || el.components.tags.data.holdableButton)\n  );\n}\n\nAFRAME.registerSystem(\"interaction\", {\n  updateCursorIntersection: function(intersection) {\n    this.rightRemoteHoverTarget = intersection && findRemoteHoverTarget(intersection.object);\n  },\n\n  isHeld(el) {\n    return this.state.leftHand.held === el || this.state.rightHand.held === el || this.state.rightRemote.held === el;\n  },\n\n  init: function() {\n    this.options = {\n      leftHand: {\n        entity: null,\n        grabPath: paths.actions.leftHand.grab,\n        dropPath: paths.actions.leftHand.drop,\n        hoverFn: findHandCollisionTargetForHand\n      },\n      rightHand: {\n        entity: null,\n        grabPath: paths.actions.rightHand.grab,\n        dropPath: paths.actions.rightHand.drop,\n        hoverFn: findHandCollisionTargetForHand\n      },\n      rightRemote: {\n        entity: null,\n        grabPath: paths.actions.cursor.grab,\n        dropPath: paths.actions.cursor.drop,\n        hoverFn: this.getRightRemoteHoverTarget\n      }\n    };\n    this.state = {\n      leftHand: {\n        hovered: null,\n        held: null,\n        spawning: null\n      },\n      rightHand: {\n        hovered: null,\n        held: null,\n        spawning: null\n      },\n      rightRemote: {\n        hovered: null,\n        held: null,\n        spawning: null\n      }\n    };\n    this.previousState = {\n      leftHand: {\n        hovered: null,\n        held: null,\n        spawning: null\n      },\n      rightHand: {\n        hovered: null,\n        held: null,\n        spawning: null\n      },\n      rightRemote: {\n        hovered: null,\n        held: null,\n        spawning: null\n      }\n    };\n\n    waitForDOMContentLoaded().then(() => {\n      this.cursorController = document.querySelector(\"#cursor-controller\");\n      this.options.leftHand.entity = document.querySelector(\"#player-left-controller\");\n      this.options.rightHand.entity = document.querySelector(\"#player-right-controller\");\n      this.options.rightRemote.entity = document.querySelector(\"#cursor\");\n    });\n  },\n\n  getRightRemoteHoverTarget() {\n    return this.rightRemoteHoverTarget;\n  },\n\n  tickInteractor(options, state) {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    if (state.held) {\n      const networked = state.held.components[\"networked\"];\n      const lostOwnership = networked && networked.data && networked.data.owner !== NAF.clientId;\n      if (userinput.get(options.dropPath) || lostOwnership) {\n        state.held = null;\n      }\n    } else {\n      state.hovered = options.hoverFn.call(this, options.entity.body);\n      if (state.hovered) {\n        const entity = state.hovered;\n        const isHoldable = entity.components.tags && entity.components.tags.data.isHoldable;\n        const isFrozen = this.el.is(\"frozen\");\n        const isPinned = entity.components.pinnable && entity.components.pinnable.data.pinned;\n        if (isHoldable && userinput.get(options.grabPath) && (isFrozen || !isPinned) && canMove(entity)) {\n          state.held = entity;\n        }\n      }\n    }\n  },\n\n  tick2(sfx) {\n    if (!this.el.is(\"entered\")) return;\n\n    Object.assign(this.previousState.rightHand, this.state.rightHand);\n    Object.assign(this.previousState.rightRemote, this.state.rightRemote);\n    Object.assign(this.previousState.leftHand, this.state.leftHand);\n\n    this.rightHandTeleporter =\n      this.rightHandTeleporter || document.querySelector(\"#player-right-controller\").components[\"teleporter\"];\n    this.gazeTeleporter = this.gazeTeleporter || document.querySelector(\"#gaze-teleport\").components[\"teleporter\"];\n\n    if (this.options.leftHand.entity.object3D.visible) {\n      this.tickInteractor(this.options.leftHand, this.state.leftHand);\n    }\n    if (this.options.rightHand.entity.object3D.visible && !this.state.rightRemote.held) {\n      this.tickInteractor(this.options.rightHand, this.state.rightHand);\n    }\n\n    if (!this.state.rightHand.held && !this.state.rightHand.hovered) {\n      this.tickInteractor(this.options.rightRemote, this.state.rightRemote);\n    }\n\n    const rightHandInteracting = this.state.rightHand.hovered || this.state.rightHand.held;\n    const rightHandTeleporting = this.rightHandTeleporter.isTeleporting || this.gazeTeleporter.isTeleporting;\n    const rightRemotePenIntersectingInVR =\n      this.el.sceneEl.is(\"vr-mode\") &&\n      this.state.rightRemote.held &&\n      this.state.rightRemote.held.components &&\n      this.state.rightRemote.held.components.tags &&\n      this.state.rightRemote.held.components.tags.data.isPen &&\n      this.state.rightRemote.held.children[0].components.pen.intersection;\n\n    const enableRightRemote = !rightHandInteracting && !rightHandTeleporting && !rightRemotePenIntersectingInVR;\n\n    this.cursorController.components[\"cursor-controller\"].enabled = enableRightRemote;\n\n    if (!enableRightRemote) {\n      this.state.rightRemote.hovered = null;\n    }\n\n    if (\n      this.state.leftHand.held !== this.previousState.leftHand.held ||\n      this.state.rightHand.held !== this.previousState.rightHand.held ||\n      this.state.rightRemote.held !== this.previousState.rightRemote.held ||\n      (isUI(this.state.rightRemote.hovered) &&\n        this.state.rightRemote.hovered !== this.previousState.rightRemote.hovered)\n    ) {\n      sfx.playSoundOneShot(SOUND_HOVER_OR_GRAB);\n    }\n\n    if (this.el.systems.userinput.get(paths.actions.logInteractionState)) {\n      console.log(\n        \"Interaction System State\\nleftHand held\",\n        this.state.leftHand.held,\n        \"\\nleftHand hovered\",\n        this.state.leftHand.hovered,\n        \"\\nrightHand held\",\n        this.state.rightHand.held,\n        \"\\nrightHand hovered\",\n        this.state.rightHand.hovered,\n        \"\\nrightRemote held\",\n        this.state.rightRemote.held,\n        \"\\nrightRemote hovered\",\n        this.state.rightRemote.hovered\n      );\n    }\n  }\n});\n","import { sets } from \"../sets\";\nimport { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { findRemoteHoverTarget } from \"../../interactions\";\nimport { canMove } from \"../../../utils/permissions-utils\";\n\nconst calculateCursorPose = function(camera, coords, origin, direction, cursorPose) {\n  origin.setFromMatrixPosition(camera.matrixWorld);\n  direction\n    .set(coords[0], coords[1], 0.5)\n    .unproject(camera)\n    .sub(origin)\n    .normalize();\n  cursorPose.fromOriginAndDirection(origin, direction);\n  return cursorPose;\n};\n\nexport class AppAwareMouseDevice {\n  constructor() {\n    this.prevButtonLeft = false;\n    this.clickedOnAnything = false;\n    this.cursorPose = new Pose();\n    this.prevCursorPose = new Pose();\n    this.origin = new THREE.Vector3();\n    this.prevOrigin = new THREE.Vector3();\n    this.direction = new THREE.Vector3();\n    this.prevDirection = new THREE.Vector3();\n  }\n\n  write(frame) {\n    this.prevCursorPose.copy(this.cursorPose);\n    this.prevOrigin.copy(this.origin);\n    this.prevDirection.copy(this.prevDirection);\n\n    if (!this.cursorController) {\n      this.cursorController = document.querySelector(\"[cursor-controller]\").components[\"cursor-controller\"];\n    }\n\n    if (!this.camera) {\n      this.camera = document.querySelector(\"#player-camera\").components.camera.camera;\n    }\n\n    const buttonLeft = frame.get(paths.device.mouse.buttonLeft);\n    const buttonRight = frame.get(paths.device.mouse.buttonRight);\n    if (buttonLeft && !this.prevButtonLeft) {\n      const rawIntersections = [];\n      this.cursorController.raycaster.intersectObjects(\n        AFRAME.scenes[0].systems[\"hubs-systems\"].cursorTargettingSystem.targets,\n        true,\n        rawIntersections\n      );\n      const intersection = rawIntersections.find(x => x.object.el);\n      const remoteHoverTarget = intersection && findRemoteHoverTarget(intersection.object);\n      const userinput = AFRAME.scenes[0].systems.userinput;\n      const isInteractable =\n        intersection &&\n        intersection.object.el.matches(\".pen, .pen *, .video, .video *, .interactable, .interactable *\");\n      const isPinned =\n        remoteHoverTarget && remoteHoverTarget.components.pinnable && remoteHoverTarget.components.pinnable.data.pinned;\n      const isFrozen = AFRAME.scenes[0].is(\"frozen\");\n      this.clickedOnAnything =\n        (isInteractable && (isFrozen || !isPinned) && canMove(remoteHoverTarget)) ||\n        userinput.activeSets.includes(sets.cursorHoldingPen) ||\n        userinput.activeSets.includes(sets.cursorHoldingInteractable) ||\n        userinput.activeSets.includes(sets.cursorHoldingCamera);\n    }\n    this.prevButtonLeft = buttonLeft;\n\n    if (!buttonLeft) {\n      this.clickedOnAnything = false;\n    }\n\n    if ((!this.clickedOnAnything && buttonLeft) || buttonRight) {\n      const movementXY = frame.get(paths.device.mouse.movementXY);\n      if (movementXY) {\n        frame.setVector2(paths.device.smartMouse.cameraDelta, movementXY[0], movementXY[1]);\n      }\n    }\n\n    const coords = frame.get(paths.device.mouse.coords);\n    frame.setPose(\n      paths.device.smartMouse.cursorPose,\n      calculateCursorPose(this.camera, coords, this.origin, this.direction, this.cursorPose)\n    );\n  }\n}\n","export function touchIsAssigned(touch, assignments) {\n  return (\n    assignments.find(assignment => {\n      return assignment.touch.identifier === touch.identifier;\n    }) !== undefined\n  );\n}\n\nexport function jobIsAssigned(job, assignments) {\n  return (\n    assignments.find(assignment => {\n      return assignment.job === job;\n    }) !== undefined\n  );\n}\n\nexport function assign(touch, job, assignments) {\n  if (touchIsAssigned(touch, assignments) || jobIsAssigned(job, assignments)) {\n    console.error(\"cannot reassign touches or jobs. unassign first\");\n    return undefined;\n  }\n  const assignment = { job, touch };\n  assignments.push(assignment);\n  return assignment;\n}\n\nexport function unassign(touch, job, assignments) {\n  function match(assignment) {\n    return assignment.touch.identifier === touch.identifier && assignment.job === job;\n  }\n  assignments.splice(assignments.findIndex(match), 1);\n}\n\nexport function findByJob(job, assignments) {\n  return assignments.find(assignment => {\n    return assignment.job === job;\n  });\n}\n\nexport function findByTouch(touch, assignments) {\n  return assignments.find(assignment => {\n    return assignment.touch.identifier === touch.identifier;\n  });\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { touchIsAssigned, jobIsAssigned, assign, unassign, findByJob, findByTouch } from \"./touchscreen/assignments\";\nimport { findRemoteHoverTarget } from \"../../interactions\";\nimport { canMove } from \"../../../utils/permissions-utils\";\n\nconst MOVE_CURSOR_JOB = \"MOVE CURSOR\";\nconst MOVE_CAMERA_JOB = \"MOVE CAMERA\";\nconst FIRST_PINCHER_JOB = \"FIRST PINCHER\";\nconst SECOND_PINCHER_JOB = \"SECOND PINCHER\";\n\nconst TAP_PATHS = [\n  paths.device.touchscreen.tap1,\n  paths.device.touchscreen.tap2,\n  paths.device.touchscreen.tap3,\n  paths.device.touchscreen.tap4,\n  paths.device.touchscreen.tap5\n];\n\nfunction distance(x1, y1, x2, y2) {\n  const dx = x1 - x2;\n  const dy = y1 - y2;\n  return Math.sqrt(dx * dx + dy * dy);\n}\n\nconst getPlayerCamera = (() => {\n  let playerCamera;\n\n  return function() {\n    if (!playerCamera) {\n      playerCamera = document.querySelector(\"#player-camera\").components.camera.camera;\n    }\n\n    return playerCamera;\n  };\n})();\n\nfunction shouldMoveCursor(touch, raycaster) {\n  const isCursorGrabbing = !!AFRAME.scenes[0].systems.interaction.state.rightRemote.held;\n  if (isCursorGrabbing) {\n    return true;\n  }\n  const rawIntersections = [];\n  raycaster.setFromCamera(\n    {\n      x: (touch.clientX / window.innerWidth) * 2 - 1,\n      y: -(touch.clientY / window.innerHeight) * 2 + 1\n    },\n    getPlayerCamera()\n  );\n  raycaster.intersectObjects(\n    AFRAME.scenes[0].systems[\"hubs-systems\"].cursorTargettingSystem.targets,\n    true,\n    rawIntersections\n  );\n  const intersection = rawIntersections.find(x => x.object.el);\n  const remoteHoverTarget = intersection && findRemoteHoverTarget(intersection.object);\n  const isInteractable = intersection && intersection.object.el.matches(\".interactable, .interactable *\");\n  const isPinned =\n    remoteHoverTarget && remoteHoverTarget.components.pinnable && remoteHoverTarget.components.pinnable.data.pinned;\n  const isFrozen = AFRAME.scenes[0].is(\"frozen\");\n  return isInteractable && (isFrozen || !isPinned) && canMove(remoteHoverTarget);\n}\n\nexport class AppAwareTouchscreenDevice {\n  constructor() {\n    this.raycaster = new THREE.Raycaster(new THREE.Vector3(), new THREE.Vector3(), 0, 4);\n    this.assignments = [];\n    this.pinch = { initialDistance: 0, currentDistance: 0, delta: 0 };\n\n    // When touches appear, this timestamps and then watches for the high water mark of # of touches\n    this.pendingTap = { maxTouchCount: 0, startedAt: 0 };\n    this.tapIndexToWriteNextFrame = 0;\n\n    this.events = [];\n    [\"touchstart\", \"touchend\", \"touchmove\", \"touchcancel\"].map(x =>\n      document.querySelector(\"canvas\").addEventListener(x, this.events.push.bind(this.events))\n    );\n  }\n\n  end(touch) {\n    if (!touchIsAssigned(touch, this.assignments)) {\n      console.warn(\"touch does not have a job\", touch);\n    } else {\n      const assignment = findByTouch(touch, this.assignments);\n      switch (assignment.job) {\n        case MOVE_CURSOR_JOB:\n        case MOVE_CAMERA_JOB:\n          // If grab was being delayed, we should fire the initial grab and also delay the unassignment\n          // to ensure we write at least two frames with the grab down (since the action set will change)\n          // and otherwise we'd not see the falling xform.\n          if (assignment.framesUntilGrab >= 0) {\n            assignment.framesUntilUnassign = assignment.framesUntilGrab + 2;\n          } else {\n            unassign(assignment.touch, assignment.job, this.assignments);\n          }\n\n          break;\n        case FIRST_PINCHER_JOB:\n          unassign(assignment.touch, assignment.job, this.assignments);\n          this.pinch = { initialDistance: 0, currentDistance: 0, delta: 0 };\n\n          if (jobIsAssigned(SECOND_PINCHER_JOB, this.assignments)) {\n            const second = findByJob(SECOND_PINCHER_JOB, this.assignments);\n            unassign(second.touch, second.job, this.assignments);\n            if (jobIsAssigned(MOVE_CAMERA_JOB, this.assignments)) {\n              // reassign secondPincher to firstPincher\n              const first = assign(second.touch, FIRST_PINCHER_JOB, this.assignments);\n              first.clientX = second.clientX;\n              first.clientY = second.clientY;\n            } else {\n              // reassign secondPincher to moveCamera\n              const cameraMover = assign(second.touch, MOVE_CAMERA_JOB, this.assignments);\n              cameraMover.clientX = second.clientX;\n              cameraMover.clientY = second.clientY;\n              cameraMover.delta = [0, 0];\n            }\n          }\n          break;\n        case SECOND_PINCHER_JOB:\n          unassign(assignment.touch, assignment.job, this.assignments);\n          this.pinch = { initialDistance: 0, currentDistance: 0, delta: 0 };\n          if (jobIsAssigned(FIRST_PINCHER_JOB, this.assignments) && !jobIsAssigned(MOVE_CAMERA_JOB, this.assignments)) {\n            //reassign firstPincher to moveCamera\n            const first = findByJob(FIRST_PINCHER_JOB, this.assignments);\n            unassign(first.touch, first.job, this.assignments);\n            const cameraMover = assign(first.touch, MOVE_CAMERA_JOB, this.assignments);\n            cameraMover.clientX = first.clientX;\n            cameraMover.clientY = first.clientY;\n            cameraMover.delta = [0, 0];\n          }\n          break;\n      }\n    }\n\n    // Touches cleared, determine what to do with pending tap\n    if (this.assignments.length === 0) {\n      if (this.pendingTap.maxTouchCount > 0 && performance.now() - this.pendingTap.startedAt <= 125) {\n        this.tapIndexToWriteNextFrame = this.pendingTap.maxTouchCount;\n      }\n\n      this.pendingTap = { maxTouchCount: 0 };\n    }\n  }\n\n  move(touch) {\n    if (!touchIsAssigned(touch, this.assignments)) {\n      if (!touch.target.classList[0] || !touch.target.classList[0].startsWith(\"virtual-gamepad-controls\")) {\n        console.warn(\"touch does not have job\", touch);\n      }\n      return;\n    }\n\n    const assignment = findByTouch(touch, this.assignments);\n    switch (assignment.job) {\n      case MOVE_CURSOR_JOB:\n        assignment.cursorPose.fromCameraProjection(\n          getPlayerCamera(),\n          (touch.clientX / window.innerWidth) * 2 - 1,\n          -(touch.clientY / window.innerHeight) * 2 + 1\n        );\n        break;\n      case MOVE_CAMERA_JOB:\n        assignment.delta[0] += touch.clientX - assignment.clientX;\n        assignment.delta[1] += touch.clientY - assignment.clientY;\n        assignment.clientX = touch.clientX;\n        assignment.clientY = touch.clientY;\n        break;\n      case FIRST_PINCHER_JOB:\n      case SECOND_PINCHER_JOB:\n        assignment.clientX = touch.clientX;\n        assignment.clientY = touch.clientY;\n        if (jobIsAssigned(FIRST_PINCHER_JOB, this.assignments) && jobIsAssigned(SECOND_PINCHER_JOB, this.assignments)) {\n          const first = findByJob(FIRST_PINCHER_JOB, this.assignments);\n          const second = findByJob(SECOND_PINCHER_JOB, this.assignments);\n          const currentDistance = distance(first.clientX, first.clientY, second.clientX, second.clientY);\n          this.pinch.delta += currentDistance - this.pinch.currentDistance;\n          this.pinch.currentDistance = currentDistance;\n        }\n        break;\n    }\n  }\n\n  start(touch) {\n    if (touchIsAssigned(touch, this.assignments)) {\n      console.error(\"touch already has a job\");\n      return;\n    }\n\n    const isFirstTouch = this.assignments.length === 0;\n    const isSecondTouch = this.assignments.length === 1;\n    const isThirdTouch = this.assignments.length === 2;\n\n    const hasSecondPinch = !!findByJob(SECOND_PINCHER_JOB, this.assignments);\n\n    if (isFirstTouch || (isThirdTouch && hasSecondPinch)) {\n      let assignment;\n\n      // First touch or third touch and other two fingers were pinching\n      if (shouldMoveCursor(touch, this.raycaster)) {\n        assignment = assign(touch, MOVE_CURSOR_JOB, this.assignments);\n\n        // Grabbing objects is delayed by several frames:\n        // - We don't want the physics constraint to be applied too early, which results in crazy velocities\n        // - We don't want to mis-trigger grabs if the user is about to put down a second finger.\n        assignment.framesUntilGrab = 2;\n      } else {\n        assignment = assign(touch, MOVE_CAMERA_JOB, this.assignments);\n        assignment.delta = [0, 0];\n      }\n\n      assignment.clientX = touch.clientX;\n      assignment.clientY = touch.clientY;\n\n      // On touch down, we always move the cursor on the first frame, but the MOVE_CURSOR_JOB indicates\n      // the touch will then track the cursor (instead of the camera)\n      assignment.cursorPose = new Pose().fromCameraProjection(\n        getPlayerCamera(),\n        (touch.clientX / window.innerWidth) * 2 - 1,\n        -(touch.clientY / window.innerHeight) * 2 + 1\n      );\n    } else if (isSecondTouch || isThirdTouch) {\n      const cursorJob = findByJob(MOVE_CURSOR_JOB, this.assignments);\n\n      if (isSecondTouch && cursorJob && cursorJob.framesUntilGrab < 0) {\n        // The second touch is happening after grab activated, so assign this touch to first pinch.\n        const first = assign(touch, FIRST_PINCHER_JOB, this.assignments);\n        first.clientX = touch.clientX;\n        first.clientY = touch.clientY;\n      } else {\n        // Second or third touch, but third touch only if not pinching\n        if (isSecondTouch) {\n          // The second touch is happening before the grab activated, so re-assign the first\n          // to the first pinch, and effectively cancel the grab.\n          const previousAssignment = this.assignments[0];\n          unassign(previousAssignment.touch, previousAssignment.job, this.assignments);\n          const first = assign(previousAssignment.touch, FIRST_PINCHER_JOB, this.assignments);\n          first.clientX = previousAssignment.clientX;\n          first.clientY = previousAssignment.clientY;\n        }\n\n        const first = findByJob(FIRST_PINCHER_JOB, this.assignments);\n\n        if (!first) {\n          const first = assign(touch, FIRST_PINCHER_JOB, this.assignments);\n          first.clientX = touch.clientX;\n          first.clientY = touch.clientY;\n          return;\n        } else {\n          const second = assign(touch, SECOND_PINCHER_JOB, this.assignments);\n          second.clientX = touch.clientX;\n          second.clientY = touch.clientY;\n\n          const initialDistance = distance(first.clientX, first.clientY, second.clientX, second.clientY);\n\n          this.pinch = {\n            initialDistance,\n            currentDistance: initialDistance,\n            delta: 0\n          };\n        }\n      }\n    }\n\n    if (this.pendingTap.maxTouchCount === 0 && this.assignments.length > 0) {\n      this.pendingTap.startedAt = performance.now();\n    }\n\n    this.pendingTap.maxTouchCount = Math.max(this.pendingTap.maxTouchCount, this.assignments.length);\n  }\n\n  process(event) {\n    switch (event.type) {\n      case \"touchstart\":\n        for (const touch of event.changedTouches) {\n          this.start(touch);\n        }\n        break;\n      case \"touchmove\":\n        for (const touch of event.touches) {\n          this.move(touch);\n        }\n        break;\n      case \"touchend\":\n      case \"touchcancel\":\n        for (const touch of event.changedTouches) {\n          this.end(touch);\n        }\n        break;\n    }\n  }\n\n  write(frame) {\n    if (this.pinch) {\n      this.pinch.delta = 0;\n    }\n    const cameraMover =\n      jobIsAssigned(MOVE_CAMERA_JOB, this.assignments) && findByJob(MOVE_CAMERA_JOB, this.assignments);\n    if (cameraMover) {\n      cameraMover.delta[0] = 0;\n      cameraMover.delta[1] = 0;\n    }\n\n    this.events.forEach(event => {\n      this.process(event);\n    });\n    while (this.events.length) {\n      this.events.pop();\n    }\n\n    const path = paths.device.touchscreen;\n    const hasCursorJob = jobIsAssigned(MOVE_CURSOR_JOB, this.assignments);\n    const hasCameraJob = jobIsAssigned(MOVE_CAMERA_JOB, this.assignments);\n\n    if (hasCursorJob || hasCameraJob) {\n      frame.setValueType(path.isTouching, true);\n\n      const assignment = findByJob(MOVE_CURSOR_JOB, this.assignments) || findByJob(MOVE_CAMERA_JOB, this.assignments);\n      frame.setPose(path.cursorPose, assignment.cursorPose);\n    }\n\n    frame.setValueType(path.isTouchingGrabbable, false);\n\n    if (hasCursorJob) {\n      const assignment = findByJob(MOVE_CURSOR_JOB, this.assignments);\n      frame.setValueType(path.isTouchingGrabbable, assignment.framesUntilGrab <= 0);\n      assignment.framesUntilGrab--;\n\n      if (assignment.framesUntilUnassign >= 0) {\n        if (assignment.framesUntilUnassign === 0) {\n          unassign(assignment.touch, assignment.job, this.assignments);\n        }\n\n        assignment.framesUntilUnassign--;\n      }\n    }\n\n    if (hasCameraJob) {\n      const delta = findByJob(MOVE_CAMERA_JOB, this.assignments).delta;\n      frame.setVector2(path.touchCameraDelta, delta[0], delta[1]);\n    }\n\n    frame.setValueType(path.pinch.delta, this.pinch.delta);\n    frame.setValueType(path.pinch.initialDistance, this.pinch.initialDistance);\n    frame.setValueType(path.pinch.currentDistance, this.pinch.currentDistance);\n\n    if (this.tapIndexToWriteNextFrame && this.tapIndexToWriteNextFrame < TAP_PATHS.length) {\n      // write to tap-X path if we had an X-fingered tap\n      frame.setValueType(TAP_PATHS[this.tapIndexToWriteNextFrame - 1], true);\n    }\n\n    this.tapIndexToWriteNextFrame = 0;\n  }\n}\n","import { Pose } from \"../pose\";\nimport { angleTo4Direction } from \"../../../utils/dpad\";\n\nexport const xforms = {\n  noop: function() {},\n  copy: function(frame, src, dest) {\n    frame.setValueType(dest.value, frame.get(src.value));\n  },\n  scale: function(scalar) {\n    return function scale(frame, src, dest) {\n      if (frame.get(src.value) !== undefined) {\n        frame.setValueType(dest.value, frame.get(src.value) * scalar);\n      }\n    };\n  },\n  scaleExp: function(scalar, exp = 1) {\n    return function scale(frame, src, dest) {\n      if (frame.get(src.value) !== undefined) {\n        if (exp === 1) {\n          frame.setValueType(dest.value, frame.get(src.value) * scalar);\n        } else {\n          frame.setValueType(dest.value, Math.pow(frame.get(src.value), exp) * scalar);\n        }\n      }\n    };\n  },\n  deadzone: function(deadzoneSize) {\n    return function deadzone(frame, src, dest) {\n      frame.setValueType(dest.value, Math.abs(frame.get(src.value)) < deadzoneSize ? 0 : frame.get(src.value));\n    };\n  },\n  split_vec2: function(frame, src, dest) {\n    const value = frame.get(src.value);\n    if (value !== undefined) {\n      frame.setValueType(dest.x, value[0]);\n      frame.setValueType(dest.y, value[1]);\n    }\n  },\n  compose_vec2: function(frame, src, dest) {\n    const x = frame.get(src.x);\n    const y = frame.get(src.y);\n    if (x !== undefined && y !== undefined) {\n      frame.setVector2(dest.value, x, y);\n    }\n  },\n  negate: function(frame, src, dest) {\n    frame.setValueType(dest.value, -frame.get(src.value));\n  },\n  copyIfFalse: function(frame, src, dest) {\n    frame.setValueType(dest.value, frame.get(src.bool) ? undefined : frame.get(src.value));\n  },\n  copyIfTrue: function(frame, src, dest) {\n    frame.setValueType(dest.value, frame.get(src.bool) ? frame.get(src.value) : undefined);\n  },\n  zeroIfDefined: function(frame, src, dest) {\n    frame.setValueType(dest.value, frame.get(src.bool) !== undefined ? 0 : frame.get(src.value));\n  },\n  true: function(frame, src, dest) {\n    frame.setValueType(dest.value, true);\n  },\n  rising: function rising(frame, src, dest, prevState) {\n    frame.setValueType(dest.value, frame.get(src.value) && prevState === false);\n    return !!frame.get(src.value);\n  },\n  risingWithFrameDelay: function(n) {\n    return function risingWithFrameDelay(frame, src, dest, state = { values: new Array(n) }) {\n      frame.setValueType(dest.value, state.values.shift());\n      state.values.push(frame.get(src.value) && !state.prev);\n      state.prev = frame.get(src.value);\n      return state;\n    };\n  },\n  falling: function falling(frame, src, dest, prevState) {\n    frame.setValueType(dest.value, !frame.get(src.value) && prevState);\n    return !!frame.get(src.value);\n  },\n  vec2Zero: function(frame, _, dest) {\n    frame.setVector2(dest.value, 0, 0);\n  },\n  poseFromCameraProjection: function() {\n    let camera;\n    const pose = new Pose();\n    return function poseFromCameraProjection(frame, src, dest) {\n      if (!camera) {\n        camera = document.querySelector(\"#player-camera\").components.camera.camera;\n      }\n      const value = frame.get(src.value);\n      frame.setPose(dest.value, pose.fromCameraProjection(camera, value[0], value[1]));\n    };\n  },\n  vec2dpad: function(deadzoneRadius, invertX = false, invertY = false) {\n    const deadzoneRadiusSquared = deadzoneRadius * deadzoneRadius;\n\n    return function vec2dpad(frame, src, dest) {\n      if (!frame.get(src.value)) return;\n      const [x, y] = frame.get(src.value);\n      const inCenter = x * x + y * y < deadzoneRadiusSquared;\n      const direction = inCenter ? \"center\" : angleTo4Direction(Math.atan2(invertX ? -x : x, invertY ? -y : y));\n      if (!dest[direction]) return;\n      frame.setValueType(dest[direction], true);\n    };\n  },\n  always: function(constValue) {\n    return function always(frame, _, dest) {\n      frame.setValueType(dest.value, constValue);\n    };\n  },\n  wasd_to_vec2: function(frame, { w, a, s, d }, { vec2 }) {\n    let x = 0;\n    let y = 0;\n    if (frame.get(a)) x -= 1;\n    if (frame.get(d)) x += 1;\n    if (frame.get(w)) y += 1;\n    if (frame.get(s)) y -= 1;\n    frame.setVector2(vec2, x, y);\n  },\n  add_vec2: function(frame, src, dest) {\n    const first = frame.get(src.first);\n    const second = frame.get(src.second);\n    if (first && second) {\n      frame.setVector2(dest.value, first[0] + second[0], first[1] + second[1]);\n    } else if (second) {\n      frame.setVector2(dest.value, second[0], second[1]);\n    } else if (first) {\n      frame.setVector2(dest.value, first[0], first[1]);\n    }\n  },\n  max_vec2: function(frame, src, dest) {\n    const first = frame.get(src.first);\n    const second = frame.get(src.second);\n    if (first && second) {\n      const max =\n        first[0] * first[0] + first[1] * first[1] > second[0] * second[0] + second[1] * second[1] ? first : second;\n      frame.setVector2(dest.value, max[0], max[1]);\n    } else if (second) {\n      frame.setVector2(dest.value, second[0], second[1]);\n    } else if (first) {\n      frame.setVector2(dest.value, first[0], first[1]);\n    }\n  },\n  normalize_vec2: function(frame, src, dest) {\n    const vec2 = frame.get(src.value);\n    if (vec2) {\n      if (vec2[0] === 0 && vec2[0] === 0) {\n        frame.setVector2(dest.value, vec2[0], vec2[1]);\n      } else {\n        const l = Math.sqrt(vec2[0] * vec2[0] + vec2[1] * vec2[1]);\n        frame.setVector2(dest.value, vec2[0] / l, vec2[1] / l);\n      }\n    }\n  },\n  all: function(frame, src, dest) {\n    for (let i = 0, l = src.length; i < l; i++) {\n      const path = src[i];\n      if (!frame.get(path)) {\n        frame.setValueType(dest.value, false);\n        return;\n      }\n    }\n    frame.setValueType(dest.value, true);\n  },\n  any: function(frame, src, dest) {\n    for (let i = 0, l = src.length; i < l; i++) {\n      const path = src[i];\n      if (frame.get(path)) {\n        frame.setValueType(dest.value, true);\n        return;\n      }\n    }\n    frame.setValueType(dest.value, false);\n  },\n  touch_axis_scroll(scale = 1, snap_to) {\n    return function touch_axis_scroll(frame, src, dest, state = { value: 0, touching: false }) {\n      if (snap_to === undefined || Math.abs(frame.get(src.value) - state.value) >= snap_to) {\n        frame.setValueType(\n          dest.value,\n          state.touching && frame.get(src.touching) ? scale * (frame.get(src.value) - state.value) : 0\n        );\n      }\n\n      state.value = frame.get(src.value);\n      state.touching = frame.get(src.touching);\n\n      return state;\n    };\n  }\n};\n","export function angleTo4Direction(angle) {\n  angle = (angle * THREE.Math.RAD2DEG + 180 + 45) % 360;\n  if (angle > 0 && angle < 90) {\n    return \"north\";\n  } else if (angle >= 90 && angle < 180) {\n    return \"west\";\n  } else if (angle >= 180 && angle < 270) {\n    return \"south\";\n  } else {\n    return \"east\";\n  }\n}\n\nexport function angleTo8Direction(angle) {\n  angle = (angle * THREE.Math.RAD2DEG + 180 + 45) % 360;\n  let direction = \"\";\n  if ((angle >= 0 && angle < 120) || angle >= 330) {\n    direction += \"north\";\n  }\n  if (angle >= 150 && angle < 300) {\n    direction += \"south\";\n  }\n  if (angle >= 60 && angle < 210) {\n    direction += \"west\";\n  }\n  if ((angle >= 240 && angle < 360) || angle < 30) {\n    direction += \"east\";\n  }\n  return direction;\n}\n","export const addSetsToBindings = mapping => {\n  for (const setName in mapping) {\n    for (const binding of mapping[setName]) {\n      if (!binding.sets) {\n        binding.sets = [];\n      }\n      binding.sets.push(setName);\n    }\n  }\n  return mapping;\n};\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\n// import { Pose } from \"../pose\";\n\nconst wasd_vec2 = \"/var/mouse-and-keyboard/wasd_vec2\";\nconst keyboardCharacterAcceleration = \"/var/mouse-and-keyboard/keyboardCharacterAcceleration\";\nconst arrows_vec2 = \"/var/mouse-and-keyboard/arrows_vec2\";\nconst togglePenWithRMB = \"/vars/mouse-and-keyboard/drop_pen_with_RMB\";\nconst togglePenWithEsc = \"/vars/mouse-and-keyboard/drop_pen_with_esc\";\nconst togglePenWithP = \"/vars/mouse-and-keyboard/drop_pen_with_p\";\nconst togglePenWithHud = \"/vars/mouse-and-keyboard/drop_pen_with_hud\";\nconst togglePen = \"/vars/mouse-and-keyboard/togglePen\";\n\nconst k = name => {\n  return `/keyboard-mouse-user/keyboard-var/${name}`;\n};\n\nexport const keyboardMouseUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {},\n      dest: { value: paths.actions.cursor.hideLine },\n      xform: xforms.always(true)\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"arrowup\"),\n        a: paths.device.keyboard.key(\"arrowleft\"),\n        s: paths.device.keyboard.key(\"arrowdown\"),\n        d: paths.device.keyboard.key(\"arrowright\")\n      },\n      dest: { vec2: arrows_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"w\"),\n        a: paths.device.keyboard.key(\"a\"),\n        s: paths.device.keyboard.key(\"s\"),\n        d: paths.device.keyboard.key(\"d\")\n      },\n      dest: { vec2: wasd_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        first: wasd_vec2,\n        second: arrows_vec2\n      },\n      dest: { value: keyboardCharacterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: { value: keyboardCharacterAcceleration },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.normalize_vec2\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"shift\") },\n      dest: { value: paths.actions.boost },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: paths.actions.camera.exitMirror },\n      xform: xforms.falling\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"q\") },\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"e\") },\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Tab\") },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: paths.actions.thaw },\n      xform: xforms.falling\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"p\") },\n      dest: { value: togglePenWithP },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.hud.penButton },\n      dest: { value: togglePenWithHud },\n      xform: xforms.rising\n    },\n    {\n      src: [togglePenWithHud, togglePenWithP],\n      dest: { value: togglePen },\n      xform: xforms.any\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.spawnPen },\n      xform: xforms.rising,\n      priority: 100\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"c\") },\n      dest: { value: paths.actions.toggleCamera },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"x\") },\n      dest: { value: paths.actions.takeSnapshot },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.smartMouse.cursorPose },\n      dest: { value: paths.actions.cursor.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.smartMouse.cameraDelta },\n      dest: { x: \"/var/smartMouseCamDeltaX\", y: \"/var/smartMouseCamDeltaY\" },\n      xform: xforms.split_vec2\n    },\n    {\n      src: { value: \"/var/smartMouseCamDeltaX\" },\n      dest: { value: \"/var/smartMouseCamDeltaXScaled\" },\n      xform: xforms.scale(-0.2)\n    },\n    {\n      src: { value: \"/var/smartMouseCamDeltaY\" },\n      dest: { value: \"/var/smartMouseCamDeltaYScaled\" },\n      xform: xforms.scale(-0.1)\n    },\n    {\n      src: { x: \"/var/smartMouseCamDeltaXScaled\", y: \"/var/smartMouseCamDeltaYScaled\" },\n      dest: { value: paths.actions.cameraDelta },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: paths.actions.cameraDelta },\n      dest: { value: paths.actions.lobbyCameraDelta },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"m\")\n      },\n      dest: {\n        value: paths.actions.muteMic\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"t\")\n      },\n      dest: {\n        value: paths.actions.focusChat\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"/\")\n      },\n      dest: {\n        value: paths.actions.focusChatCommand\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: paths.actions.mediaExit },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"1\")\n      },\n      dest: { value: \"/var/shift+1\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+1\" },\n      dest: { value: paths.actions.mediaSearch1 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"2\")\n      },\n      dest: { value: \"/var/shift+2\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+2\" },\n      dest: { value: paths.actions.mediaSearch2 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"3\")\n      },\n      dest: { value: \"/var/shift+3\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+3\" },\n      dest: { value: paths.actions.mediaSearch3 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"4\")\n      },\n      dest: { value: \"/var/shift+4\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+4\" },\n      dest: { value: paths.actions.mediaSearch4 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"5\")\n      },\n      dest: { value: \"/var/shift+5\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+5\" },\n      dest: { value: paths.actions.mediaSearch5 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"6\")\n      },\n      dest: { value: \"/var/shift+6\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+6\" },\n      dest: { value: paths.actions.mediaSearch6 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"7\")\n      },\n      dest: { value: \"/var/shift+7\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+7\" },\n      dest: { value: paths.actions.mediaSearch7 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"8\")\n      },\n      dest: { value: \"/var/shift+8\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+8\" },\n      dest: { value: paths.actions.mediaSearch8 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"l\")\n      },\n      dest: {\n        value: paths.actions.logDebugFrame\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"k\")\n      },\n      dest: {\n        value: paths.actions.logInteractionState\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.mouse.buttonRight\n      },\n      dest: {\n        value: paths.actions.startGazeTeleport\n      },\n      xform: xforms.rising,\n      priority: 100\n    },\n    {\n      src: {\n        value: paths.device.mouse.buttonRight\n      },\n      dest: {\n        value: paths.actions.stopGazeTeleport\n      },\n      xform: xforms.falling,\n      priority: 100\n    }\n\n    // Helpful bindings for debugging hands in 2D\n    // {\n    //   src: {},\n    //   dest: { value: paths.actions.rightHand.matrix },\n    //   xform: xforms.always(\n    //     new THREE.Matrix4().compose(\n    //       new THREE.Vector3(0.2, 1.3, -0.8),\n    //       new THREE.Quaternion(0, 0, 0, 0),\n    //       new THREE.Vector3(1, 1, 1)\n    //     )\n    //   )\n    // },\n    // {\n    //   src: {},\n    //   dest: { value: paths.actions.leftHand.matrix },\n    //   xform: xforms.always(\n    //     new THREE.Matrix4().compose(\n    //       new THREE.Vector3(-0.2, 1.4, -0.8),\n    //       new THREE.Quaternion(0, 0, 0, 0),\n    //       new THREE.Vector3(1, 1, 1)\n    //     )\n    //   )\n    // }\n  ],\n\n  [sets.cursorHoldingPen]: [\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.keyboard.key(\"q\")\n      },\n      dest: { value: \"/var/shift+q\" },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+q\" },\n      dest: { value: paths.actions.cursor.penPrevColor },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.keyboard.key(\"e\")\n      },\n      dest: { value: \"/var/shift+e\" },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+e\" },\n      dest: { value: paths.actions.cursor.penNextColor },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.keyboard.key(\"q\")\n      },\n      dest: { value: \"/var/notshift+q\" },\n      xform: xforms.copyIfFalse\n    },\n    {\n      src: { value: \"/var/notshift+q\" },\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.keyboard.key(\"e\")\n      },\n      dest: { value: \"/var/notshift+e\" },\n      xform: xforms.copyIfFalse\n    },\n    {\n      src: { value: \"/var/notshift+e\" },\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        value: k(\"wheelWithShift\")\n      },\n      dest: { value: \"/var/cursorScalePenTipWheel\" },\n      xform: xforms.copy,\n      priority: 200\n    },\n    {\n      src: { value: \"/var/cursorScalePenTipWheel\" },\n      dest: { value: paths.actions.cursor.scalePenTip },\n      xform: xforms.scale(0.03)\n    },\n    {\n      src: { value: paths.device.mouse.buttonRight },\n      dest: { value: togglePenWithRMB },\n      xform: xforms.falling,\n      priority: 200\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: togglePenWithEsc },\n      xform: xforms.rising\n    },\n    {\n      src: [togglePenWithRMB, togglePenWithEsc, togglePenWithP, togglePenWithHud],\n      dest: { value: togglePen },\n      xform: xforms.any\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"z\")\n      },\n      dest: { value: paths.actions.cursor.undoDrawing },\n      priority: 1001,\n      xform: xforms.rising\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.pen.remove },\n      xform: xforms.rising,\n      priority: 200\n    }\n  ],\n\n  [sets.cursorHoldingCamera]: [\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.falling,\n      priority: 2\n    }\n  ],\n\n  [sets.cursorHoldingInteractable]: [\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.mouse.wheel\n      },\n      dest: {\n        value: k(\"wheelWithShift\")\n      },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.mouse.wheel\n      },\n      dest: {\n        value: k(\"wheelWithoutShift\")\n      },\n      xform: xforms.copyIfFalse\n    },\n    {\n      src: {\n        value: k(\"wheelWithoutShift\")\n      },\n      dest: { value: paths.actions.cursor.modDelta },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: k(\"wheelWithShift\")\n      },\n      dest: { value: paths.actions.cursor.scaleGrabbedGrabbable },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.falling,\n      priority: 2\n    }\n  ],\n  [sets.cursorHoldingUI]: [\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"shift\") },\n      dest: { value: paths.actions.transformModifier },\n      xform: xforms.copy\n    }\n  ],\n  [sets.cursorHoveringOnInteractable]: [\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n  [sets.cursorHoveringOnVideo]: [\n    {\n      src: { value: paths.device.mouse.wheel },\n      dest: { value: paths.actions.cursor.mediaVolumeMod },\n      xform: xforms.scale(-0.3)\n    }\n  ],\n  [sets.inputFocused]: [\n    {\n      src: { value: \"/device/keyboard\" },\n      dest: { value: paths.noop },\n      xform: xforms.noop,\n      priority: 1000\n    }\n  ],\n\n  [sets.cursorHoveringOnUI]: [\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.rising\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst zero = \"/vars/touchscreen/zero\";\nconst forward = \"/vars/touchscreen/pinchDeltaForward\";\nconst touchCamDelta = \"vars/touchscreen/touchCameraDelta\";\nconst touchCamDeltaX = \"vars/touchscreen/touchCameraDelta/x\";\nconst touchCamDeltaY = \"vars/touchscreen/touchCameraDelta/y\";\nconst touchCamDeltaXScaled = \"vars/touchscreen/touchCameraDelta/x/scaled\";\nconst touchCamDeltaYScaled = \"vars/touchscreen/touchCameraDelta/y/scaled\";\nconst gyroCamDelta = \"vars/gyro/gyroCameraDelta\";\nconst gyroCamDeltaXScaled = \"vars/gyro/gyroCameraDelta/x/scaled\";\nconst gyroCamDeltaYScaled = \"vars/gyro/gyroCameraDelta/y/scaled\";\nconst togglePen = \"/vars/touchscreen/togglePen\";\n\nexport const touchscreenUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {},\n      dest: { value: paths.actions.cursor.hideLine },\n      xform: xforms.always(true)\n    },\n    {\n      src: { value: paths.device.touchscreen.pinch.delta },\n      dest: { value: forward },\n      xform: xforms.scale(0.25)\n    },\n    {\n      src: { value: paths.device.touchscreen.tap2 },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.copy\n    },\n    {\n      src: {},\n      dest: { value: zero },\n      xform: xforms.always(0)\n    },\n    {\n      src: { x: zero, y: forward },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: paths.device.touchscreen.cursorPose },\n      dest: { value: paths.actions.cursor.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.touchscreen.touchCameraDelta },\n      dest: { x: touchCamDeltaX, y: touchCamDeltaY },\n      xform: xforms.split_vec2\n    },\n    {\n      src: { value: touchCamDeltaX },\n      dest: { value: touchCamDeltaXScaled },\n      xform: xforms.scale(0.18)\n    },\n    {\n      src: { value: touchCamDeltaY },\n      dest: { value: touchCamDeltaYScaled },\n      xform: xforms.scale(0.35)\n    },\n    {\n      src: { x: touchCamDeltaXScaled, y: touchCamDeltaYScaled },\n      dest: { value: touchCamDelta },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: paths.device.gyro.averageDeltaX },\n      dest: { value: gyroCamDeltaXScaled },\n      xform: xforms.scale(1.0)\n    },\n    {\n      src: { value: paths.device.gyro.averageDeltaY },\n      dest: { value: gyroCamDeltaYScaled },\n      xform: xforms.scale(1.0)\n    },\n    {\n      src: { x: gyroCamDeltaYScaled, y: gyroCamDeltaXScaled },\n      dest: { value: gyroCamDelta },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        first: touchCamDelta,\n        second: gyroCamDelta\n      },\n      dest: { value: paths.actions.cameraDelta },\n      xform: xforms.add_vec2\n    },\n    {\n      src: { value: touchCamDelta },\n      dest: { value: paths.actions.lobbyCameraDelta },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.touchscreen.isTouchingGrabbable },\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.hud.penButton },\n      dest: { value: togglePen },\n      xform: xforms.rising\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.spawnPen },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n  [sets.cursorHoldingInteractable]: [\n    {\n      src: { value: paths.device.touchscreen.isTouchingGrabbable },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.falling,\n      priority: 1\n    }\n  ],\n\n  [sets.cursorHoveringOnPen]: [],\n  [sets.cursorHoldingPen]: [\n    {\n      src: { value: paths.device.touchscreen.isTouchingGrabbable },\n      dest: { value: paths.actions.cursor.startDrawing },\n      xform: xforms.risingWithFrameDelay(5),\n      priority: 2\n    },\n    {\n      src: { value: paths.device.touchscreen.isTouchingGrabbable },\n      dest: { value: paths.actions.cursor.stopDrawing },\n      xform: xforms.falling,\n      priority: 2\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.pen.remove },\n      xform: xforms.rising,\n      priority: 3\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nexport const keyboardDebuggingBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {\n        value: paths.device.keyboard.key(\"l\")\n      },\n      dest: {\n        value: paths.actions.logDebugFrame\n      },\n      xform: xforms.rising\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst name = \"/touch/var/\";\n\nconst leftButton = paths.device.leftOculusTouch.button;\nconst leftAxis = paths.device.leftOculusTouch.axis;\nconst leftPose = paths.device.leftOculusTouch.pose;\nconst rightButton = paths.device.rightOculusTouch.button;\nconst rightAxis = paths.device.rightOculusTouch.axis;\nconst rightPose = paths.device.rightOculusTouch.pose;\n\nconst leftJoyXDeadzoned = `${name}left/joy/x/deadzoned`;\nconst leftJoyYDeadzoned = `${name}left/joy/y/deadzoned`;\nconst scaledLeftJoyX = `${name}left/scaledJoyX`;\nconst scaledLeftJoyY = `${name}left/scaledJoyY`;\nconst cursorDrop2 = `${name}right/cursorDrop2`;\nconst cursorDrop1 = `${name}right/cursorDrop1`;\nconst rightHandDrop2 = `${name}right/rightHandDrop2`;\nconst rightGripRisingGrab = `${name}right/grip/RisingGrab`;\nconst rightTriggerRisingGrab = `${name}right/trigger/RisingGrab`;\nconst leftGripRisingGrab = `${name}left/grip/RisingGrab`;\nconst leftTriggerRisingGrab = `${name}left/trigger/RisingGrab`;\nconst rightDpadNorth = `${name}rightDpad/north`;\nconst rightDpadSouth = `${name}rightDpad/south`;\nconst rightDpadEast = `${name}rightDpad/east`;\nconst rightDpadWest = `${name}rightDpad/west`;\nconst rightDpadCenter = `${name}rightDpad/center`;\nconst rightJoy = `${name}right/joy`;\nconst rightJoyY1 = `${name}right/joyY1`;\nconst rightJoyY2 = `${name}right/joyY2`;\nconst rightJoyYDeadzoned = `${name}right/joy/y/deadzoned`;\nconst leftDpadNorth = `${name}leftDpad/north`;\nconst leftDpadSouth = `${name}leftDpad/south`;\nconst leftDpadEast = `${name}leftDpad/east`;\nconst leftDpadWest = `${name}leftDpad/west`;\nconst leftDpadCenter = `${name}leftDpad/center`;\nconst leftJoy = `${name}left/joy`;\nconst oculusTouchCharacterAcceleration = `${name}characterAcceleration`;\nconst keyboardCharacterAcceleration = \"/var/keyboard/characterAcceleration\";\nconst characterAcceleration = \"/var/oculus-touch/nonNormalizedCharacterAcceleration\";\nconst wasd_vec2 = \"/var/keyboard/wasd_vec2\";\nconst arrows_vec2 = \"/var/keyboard/arrows_vec2\";\nconst keyboardBoost = \"/var/keyboard-oculus/boost\";\nconst rightBoost = \"/var/right-oculus/boost\";\nconst leftBoost = \"/var/left-oculus/boost\";\nconst rightTouchSnapRight = `${name}/right/snap-right`;\nconst rightTouchSnapLeft = `${name}/right/snap-left`;\nconst keyboardSnapRight = `${name}/keyboard/snap-right`;\nconst keyboardSnapLeft = `${name}/keyboard/snap-left`;\n\nconst lowerButtons = `${name}buttons/lower`;\n\nconst ensureFrozenViaButtons = `${name}buttons/ensureFrozen`;\nconst ensureFrozenViaKeyboard = `${name}keyboard/ensureFrozen`;\n\nconst thawViaButtons = `${name}buttons/thaw`;\nconst thawViaKeyboard = `${name}keyboard/thaw`;\n\nconst v = s => {\n  return \"/oculus-touch-user-vars/\" + s;\n};\nconst leftGripPressed1 = v(\"leftGripPressed1\");\nconst leftGripPressed2 = v(\"leftGripPressed2\");\nconst rightGripPressed1 = v(\"rightGripPressed1\");\nconst rightGripPressed2 = v(\"rightGripPressed2\");\nconst leftTriggerPressed1 = v(\"leftTriggerPressed1\");\nconst leftTriggerPressed2 = v(\"leftTriggerPressed2\");\nconst rightTriggerPressed1 = v(\"rightTriggerPressed1\");\nconst rightTriggerPressed2 = v(\"rightTriggerPressed2\");\n\nexport const oculusTouchUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {\n        value: paths.device.leftOculusTouch.matrix\n      },\n      dest: {\n        value: paths.actions.leftHand.matrix\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: paths.device.rightOculusTouch.matrix\n      },\n      dest: {\n        value: paths.actions.rightHand.matrix\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [ensureFrozenViaButtons, ensureFrozenViaKeyboard],\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.any\n    },\n    {\n      src: [thawViaButtons, thawViaKeyboard],\n      dest: { value: paths.actions.thaw },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: leftButton(\"grip\").pressed\n      },\n      dest: {\n        value: leftGripPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: leftButton(\"grip\").pressed\n      },\n      dest: {\n        value: leftGripPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: leftGripPressed1\n      },\n      dest: {\n        value: paths.actions.leftHand.middleRingPinky\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [leftButton(\"x\").touched, leftButton(\"y\").touched, leftButton(\"thumbStick\").touched],\n      dest: {\n        value: paths.actions.leftHand.thumb\n      },\n      xform: xforms.any\n    },\n    {\n      src: { value: leftButton(\"trigger\").pressed },\n      dest: {\n        value: leftTriggerPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftButton(\"trigger\").pressed },\n      dest: {\n        value: leftTriggerPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftTriggerPressed1 },\n      dest: {\n        value: paths.actions.leftHand.index\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightButton(\"grip\").pressed\n      },\n      dest: {\n        value: rightGripPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightButton(\"grip\").pressed\n      },\n      dest: {\n        value: rightGripPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightGripPressed1\n      },\n      dest: {\n        value: paths.actions.rightHand.middleRingPinky\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [rightButton(\"a\").touched, rightButton(\"b\").touched, rightButton(\"thumbStick\").touched],\n      dest: {\n        value: paths.actions.rightHand.thumb\n      },\n      xform: xforms.any\n    },\n    {\n      src: { value: rightButton(\"trigger\").pressed },\n      dest: {\n        value: rightTriggerPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightButton(\"trigger\").pressed },\n      dest: {\n        value: rightTriggerPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightTriggerPressed1 },\n      dest: {\n        value: paths.actions.rightHand.index\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: leftAxis(\"joyX\"),\n        y: leftAxis(\"joyY\")\n      },\n      dest: {\n        value: leftJoy\n      },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: leftJoy\n      },\n      dest: {\n        north: leftDpadNorth,\n        south: leftDpadSouth,\n        east: leftDpadEast,\n        west: leftDpadWest,\n        center: leftDpadCenter\n      },\n      xform: xforms.vec2dpad(0.2, false, true)\n    },\n    {\n      src: {\n        value: rightAxis(\"joyY\")\n      },\n      dest: { value: rightJoyY1 },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightAxis(\"joyY\")\n      },\n      dest: { value: rightJoyY2 },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: rightAxis(\"joyX\"),\n        y: rightJoyY1\n      },\n      dest: {\n        value: rightJoy\n      },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: rightJoy\n      },\n      dest: {\n        north: rightDpadNorth,\n        south: rightDpadSouth,\n        east: rightDpadEast,\n        west: rightDpadWest,\n        center: rightDpadCenter\n      },\n      xform: xforms.vec2dpad(0.2, false, true)\n    },\n    {\n      src: {\n        value: rightDpadEast\n      },\n      dest: {\n        value: rightTouchSnapRight\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"e\") },\n      dest: { value: keyboardSnapRight },\n      xform: xforms.rising\n    },\n    {\n      src: [rightTouchSnapRight, keyboardSnapRight],\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.any\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Tab\") },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: ensureFrozenViaKeyboard },\n      xform: xforms.copy\n    },\n    {\n      src: [leftButton(\"x\").pressed, rightButton(\"a\").pressed],\n      dest: { value: lowerButtons },\n      xform: xforms.any\n    },\n    {\n      src: { value: lowerButtons },\n      dest: { value: ensureFrozenViaButtons },\n      xform: xforms.copy\n    },\n    {\n      src: { value: lowerButtons },\n      dest: { value: thawViaButtons },\n      xform: xforms.falling\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: thawViaKeyboard },\n      xform: xforms.falling\n    },\n    {\n      src: {\n        value: rightDpadWest\n      },\n      dest: {\n        value: rightTouchSnapLeft\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"q\") },\n      dest: { value: keyboardSnapLeft },\n      xform: xforms.rising\n    },\n    {\n      src: [rightTouchSnapLeft, keyboardSnapLeft],\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: leftAxis(\"joyY\")\n      },\n      dest: {\n        value: leftJoyYDeadzoned\n      },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: {\n        value: leftJoyYDeadzoned\n      },\n      dest: {\n        value: scaledLeftJoyY\n      },\n      xform: xforms.scale(-1.5) // horizontal character speed modifier\n    },\n    {\n      src: {\n        value: leftAxis(\"joyX\")\n      },\n      dest: {\n        value: leftJoyXDeadzoned\n      },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: {\n        value: leftJoyXDeadzoned\n      },\n      dest: {\n        value: scaledLeftJoyX\n      },\n      xform: xforms.scale(1.5) // horizontal character speed modifier\n    },\n    {\n      src: {\n        x: scaledLeftJoyX,\n        y: scaledLeftJoyY\n      },\n      dest: { value: oculusTouchCharacterAcceleration },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"arrowup\"),\n        a: paths.device.keyboard.key(\"arrowleft\"),\n        s: paths.device.keyboard.key(\"arrowdown\"),\n        d: paths.device.keyboard.key(\"arrowright\")\n      },\n      dest: { vec2: arrows_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"w\"),\n        a: paths.device.keyboard.key(\"a\"),\n        s: paths.device.keyboard.key(\"s\"),\n        d: paths.device.keyboard.key(\"d\")\n      },\n      dest: { vec2: wasd_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        first: wasd_vec2,\n        second: arrows_vec2\n      },\n      dest: { value: keyboardCharacterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: {\n        first: oculusTouchCharacterAcceleration,\n        second: keyboardCharacterAcceleration\n      },\n      dest: {\n        value: characterAcceleration\n      },\n      xform: xforms.max_vec2\n    },\n    {\n      src: {\n        value: characterAcceleration,\n        override: \"/device/overrides/foo\"\n      },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"shift\") },\n      dest: { value: keyboardBoost },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: leftButton(\"y\").pressed\n      },\n      dest: {\n        value: leftBoost\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightButton(\"b\").pressed\n      },\n      dest: {\n        value: rightBoost\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [keyboardBoost, leftBoost, rightBoost],\n      dest: { value: paths.actions.boost },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"t\")\n      },\n      dest: {\n        value: paths.actions.focusChat\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"/\")\n      },\n      dest: {\n        value: paths.actions.focusChatCommand\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: paths.actions.mediaExit },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"p\") },\n      dest: { value: paths.actions.spawnPen },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"c\") },\n      dest: { value: paths.actions.toggleCamera },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"x\") },\n      dest: { value: paths.actions.takeSnapshot },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"1\")\n      },\n      dest: { value: \"/var/shift+1\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+1\" },\n      dest: { value: paths.actions.mediaSearch1 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"2\")\n      },\n      dest: { value: \"/var/shift+2\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+2\" },\n      dest: { value: paths.actions.mediaSearch2 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"3\")\n      },\n      dest: { value: \"/var/shift+3\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+3\" },\n      dest: { value: paths.actions.mediaSearch3 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"4\")\n      },\n      dest: { value: \"/var/shift+4\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+4\" },\n      dest: { value: paths.actions.mediaSearch4 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"5\")\n      },\n      dest: { value: \"/var/shift+5\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+5\" },\n      dest: { value: paths.actions.mediaSearch5 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"6\")\n      },\n      dest: { value: \"/var/shift+6\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+6\" },\n      dest: { value: paths.actions.mediaSearch6 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"7\")\n      },\n      dest: { value: \"/var/shift+7\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+7\" },\n      dest: { value: paths.actions.mediaSearch7 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"8\")\n      },\n      dest: { value: \"/var/shift+8\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+8\" },\n      dest: { value: paths.actions.mediaSearch8 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"l\")\n      },\n      dest: {\n        value: paths.actions.logDebugFrame\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"k\")\n      },\n      dest: {\n        value: paths.actions.logInteractionState\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"m\")\n      },\n      dest: {\n        value: paths.actions.muteMic\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rightPose },\n      dest: { value: paths.actions.cursor.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightPose },\n      dest: { value: paths.actions.rightHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftPose },\n      dest: { value: paths.actions.leftHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    }\n  ],\n\n  [sets.leftHandHoveringOnNothing]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startTeleport },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.cursorHoveringOnUI]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.cursorHoveringOnVideo]: [\n    {\n      src: { value: rightAxis(\"joyY\") },\n      dest: { value: paths.actions.cursor.mediaVolumeMod },\n      xform: xforms.scale(-0.01)\n    }\n  ],\n\n  [sets.cursorHoveringOnNothing]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.leftHandHoveringOnInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: leftGripRisingGrab },\n      xform: xforms.rising\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: leftTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [leftGripRisingGrab],\n      dest: { value: paths.actions.leftHand.grab },\n      xform: xforms.any,\n      priority: 2\n    }\n  ],\n\n  [sets.leftHandHoldingInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.falling\n    },\n    {\n      src: {},\n      dest: { value: ensureFrozenViaButtons },\n      priority: 1,\n      xform: xforms.always(false)\n    }\n  ],\n\n  [sets.leftHandHoveringOnPen]: [],\n  [sets.leftHandHoldingPen]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        value: leftDpadEast,\n        override: \"/device/overrides/foo\"\n      },\n      dest: {\n        value: paths.actions.leftHand.penNextColor\n      },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: {\n        value: leftDpadWest,\n        override: \"/device/overrides/foo\"\n      },\n      dest: {\n        value: paths.actions.leftHand.penPrevColor\n      },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: leftJoyYDeadzoned },\n      dest: { value: paths.actions.leftHand.scalePenTip },\n      xform: xforms.scaleExp(-0.005, 5),\n      priority: 1\n    },\n    {\n      src: { value: leftButton(\"y\").pressed },\n      dest: { value: paths.actions.leftHand.switchDrawMode },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: leftButton(\"x\").pressed },\n      dest: { value: paths.actions.leftHand.undoDrawing },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.cursorHoveringOnInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rightGripRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: rightTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [rightGripRisingGrab],\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.any,\n      priority: 2\n    }\n  ],\n\n  [sets.cursorHoldingUI]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: cursorDrop2 },\n      xform: xforms.falling,\n      priority: 5\n    }\n  ],\n\n  [sets.cursorHoldingInteractable]: [\n    {\n      src: { value: rightAxis(\"joyY\") },\n      dest: { value: paths.actions.cursor.modDelta },\n      xform: xforms.scale(0.1)\n    },\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: cursorDrop1 },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: [cursorDrop1, cursorDrop2],\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.any,\n      priority: 2\n    },\n    {\n      src: {},\n      dest: { value: ensureFrozenViaButtons },\n      priority: 1,\n      xform: xforms.always(false)\n    }\n  ],\n\n  [sets.cursorHoveringOnPen]: [],\n\n  [sets.cursorHoldingPen]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: rightButton(\"b\").pressed },\n      dest: { value: paths.actions.cursor.undoDrawing },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.rightHandHoveringOnInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rightGripRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: rightTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [rightGripRisingGrab],\n      dest: { value: paths.actions.rightHand.grab },\n      xform: xforms.any,\n      priority: 2\n    }\n  ],\n\n  [sets.rightHandHoldingInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: {\n        value: rightHandDrop2\n      },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: [rightHandDrop2],\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.any,\n      priority: 2\n    },\n    {\n      src: {},\n      dest: { value: ensureFrozenViaButtons },\n      priority: 1,\n      xform: xforms.always(false)\n    }\n  ],\n  [sets.rightHandHoveringOnPen]: [],\n  [sets.rightHandHoldingPen]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        value: rightDpadEast\n      },\n      dest: {\n        value: paths.actions.rightHand.penNextColor\n      },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: {\n        value: rightDpadWest\n      },\n      dest: {\n        value: paths.actions.rightHand.penPrevColor\n      },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: {\n        value: rightAxis(\"joyY\")\n      },\n      dest: {\n        value: rightJoyYDeadzoned\n      },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: rightJoyYDeadzoned },\n      dest: { value: paths.actions.rightHand.scalePenTip },\n      xform: xforms.scaleExp(-0.005, 5),\n      priority: 2\n    },\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: rightButton(\"b\").pressed },\n      dest: { value: paths.actions.rightHand.switchDrawMode },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: rightButton(\"a\").pressed },\n      dest: { value: paths.actions.rightHand.undoDrawing },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.cursorHoveringOnCamera]: [],\n  [sets.rightHandHoveringOnCamera]: [],\n  [sets.leftHandHoveringOnCamera]: [],\n\n  [sets.rightHandHoldingCamera]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.takeSnapshot },\n      xform: xforms.copy,\n      priority: 4\n    }\n  ],\n  [sets.leftHandHoldingCamera]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.takeSnapshot },\n      xform: xforms.copy,\n      priority: 4\n    }\n  ],\n  [sets.cursorHoldingCamera]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.takeSnapshot },\n      xform: xforms.copy,\n      priority: 4\n    }\n  ],\n\n  [sets.rightHandHoveringOnNothing]: [],\n  [sets.inputFocused]: [\n    {\n      src: { value: \"/device/keyboard\" },\n      dest: { value: paths.noop },\n      xform: xforms.noop,\n      priority: 1000\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst v = name => {\n  return `/vive-user/vive-var/${name}`;\n};\n\nconst lButton = paths.device.vive.left.button;\nconst lAxis = paths.device.vive.left.axis;\nconst lPose = paths.device.vive.left.pose;\nconst lJoyScaled = v(\"left/joy/scaled\");\nconst lJoyXScaled = v(\"left/joyX/scaled\");\nconst lJoyYScaled = v(\"left/joyY/scaled\");\nconst lTouch = v(\"left/touch\");\nconst lTouchScaled = v(\"left/touch/scaled\");\nconst lTouchXScaled = v(\"left/touchX/scaled\");\nconst lTouchYScaled = v(\"left/touchY/scaled\");\nconst lDpadNorth = v(\"left/dpad/north\");\nconst lDpadSouth = v(\"left/dpad/south\");\nconst lDpadEast = v(\"left/dpad/east\");\nconst lDpadWest = v(\"left/dpad/west\");\nconst lDpadCenter = v(\"left/dpad/center\");\nconst lTriggerFallingStopDrawing = v(\"left/trigger/falling/stopDrawing\");\nconst lGripFallingStopDrawing = v(\"left/grip/falling/stopDrawing\");\nconst lTriggerRisingGrab = v(\"left/trigger/rising/grab\");\nconst lGripRisingGrab = v(\"left/grab/rising/grab\");\nconst lTouchpadRising2 = v(\"left/touchpad/rising2\");\nconst lTouchpadRising1 = v(\"left/touchpad/rising1\");\nconst touchCharacterAcceleration = v(\"left/touch/characterAcceleration\");\nconst lCharacterAcceleration = v(\"left/characterAcceleration\");\nconst characterAcceleration = v(\"nonNormalizedCharacterAcceleration\");\nconst leftBoost = v(\"left/boost\");\n\nconst rButton = paths.device.vive.right.button;\nconst rAxis = paths.device.vive.right.axis;\nconst rPose = paths.device.vive.right.pose;\nconst rTouch = v(\"right/touch\");\nconst rJoy = v(\"right/joy\");\nconst rDpadNorth1 = v(\"right/dpad/north\");\nconst rDpadSouth1 = v(\"right/dpad/south\");\nconst rDpadEast1 = v(\"right/dpad/east\");\nconst rDpadWest1 = v(\"right/dpad/west\");\nconst rDpadCenter1 = v(\"right/dpad/center\");\nconst rDpadNorth2 = v(\"right/dpad/north2\");\nconst rDpadSouth2 = v(\"right/dpad/south2\");\nconst rDpadEast2 = v(\"right/dpad/east2\");\nconst rDpadWest2 = v(\"right/dpad/west2\");\nconst rDpadCenter2 = v(\"right/dpad/center2\");\nconst rDpadCenterStrip = v(\"right/dpad/centerStrip\");\nconst rTouchpadRising = v(\"right/touchpad/rising\");\nconst rTouchpadFalling = v(\"right/touchpad/falling\");\nconst rightBoost = v(\"right/boost\");\nconst rTriggerRisingGrab = v(\"right/trigger/rising/grab\");\nconst rGripRisingGrab = v(\"right/grab/rising/grab\");\nconst cursorDrop1 = v(\"right/cursorDrop1\");\nconst cursorDrop2 = v(\"right/cursorDrop2\");\nconst rTriggerStopTeleport = v(\"right/trigger/stopTeleport\");\nconst rTouchpadStopTeleport = v(\"right/touchpad/stopTeleport\");\nconst rootForFrozenOverrideWhenHolding = \"rootForFrozenOverrideWhenHolding\";\n\nconst ensureFrozenViaDpad = v(\"dpad/ensureFrozen\");\nconst ensureFrozenViaKeyboard = v(\"keyboard/ensureFrozen\");\n\nconst thawViaDpad = v(\"dpad/thaw\");\nconst thawViaKeyboard = v(\"keyboard/thaw\");\n\nconst rSnapRight1 = v(\"right/snap-right\");\nconst rSnapLeft1 = v(\"right/snap-left\");\nconst rSnapRight2 = v(\"right/snap-right2\");\nconst rSnapLeft2 = v(\"right/snap-left2\");\n\nconst k = name => {\n  return `/vive-user/keyboard-var/${name}`;\n};\nconst keyboardSnapRight = k(\"snap-right\");\nconst keyboardSnapLeft = k(\"snap-left\");\nconst keyboardCharacterAcceleration = k(\"characterAcceleration\");\nconst wasd_vec2 = k(\"wasd_vec2\");\nconst arrows_vec2 = k(\"arrows_vec2\");\nconst keyboardBoost = k(\"boost\");\n\nconst leftGripPressed1 = v(\"leftGripPressed1\");\nconst leftGripPressed2 = v(\"leftGripPressed2\");\nconst rightGripPressed1 = v(\"rightGripPressed1\");\nconst rightGripPressed2 = v(\"rightGripPressed2\");\nconst leftTriggerPressed1 = v(\"leftTriggerPressed1\");\nconst leftTriggerPressed2 = v(\"leftTriggerPressed2\");\nconst leftTouchpadPressed1 = v(\"leftTouchpadPressed1\");\nconst leftTouchpadPressed2 = v(\"leftTouchpadPressed2\");\nconst rightTriggerPressed1 = v(\"rightTriggerPressed1\");\nconst rightTriggerPressed2 = v(\"rightTriggerPressed2\");\nconst leftTouchpadFallingStopTeleport = v(\"leftTouchpadFallingStopTeleport\");\nconst leftTriggerFallingStopTeleport = v(\"leftTriggerFallingStopTeleport\");\nconst leftGripFallingWhileHoldingPen = v(\"leftGripFallingWhileHoldingPen\");\n\nexport const viveUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {\n        value: paths.device.vive.left.matrix\n      },\n      dest: {\n        value: paths.actions.leftHand.matrix\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: paths.device.vive.right.matrix\n      },\n      dest: {\n        value: paths.actions.rightHand.matrix\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [ensureFrozenViaDpad, ensureFrozenViaKeyboard],\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.any\n    },\n    {\n      src: [thawViaDpad, thawViaKeyboard],\n      dest: { value: paths.actions.thaw },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: lButton(\"grip\").pressed\n      },\n      dest: {\n        value: leftGripPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: leftGripPressed1\n      },\n      dest: {\n        value: paths.actions.leftHand.middleRingPinky\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: lButton(\"grip\").pressed\n      },\n      dest: {\n        value: leftGripPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [lButton(\"touchpad\").touched, lButton(\"top\").touched],\n      dest: {\n        value: paths.actions.leftHand.thumb\n      },\n      xform: xforms.any\n    },\n    {\n      src: { value: leftTriggerPressed1 },\n      dest: {\n        value: paths.actions.leftHand.index\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: lButton(\"trigger\").pressed },\n      dest: {\n        value: leftTriggerPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: lButton(\"trigger\").pressed },\n      dest: {\n        value: leftTriggerPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rButton(\"grip\").pressed\n      },\n      dest: {\n        value: rightGripPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rButton(\"grip\").pressed\n      },\n      dest: {\n        value: rightGripPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightGripPressed1\n      },\n      dest: {\n        value: paths.actions.rightHand.middleRingPinky\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [rButton(\"touchpad\").touched, rButton(\"top\").touched],\n      dest: {\n        value: paths.actions.rightHand.thumb\n      },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: rButton(\"trigger\").pressed\n      },\n      dest: { value: rightTriggerPressed1 },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rButton(\"trigger\").pressed\n      },\n      dest: { value: rightTriggerPressed2 },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightTriggerPressed1 },\n      dest: {\n        value: paths.actions.rightHand.index\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: lAxis(\"touchX\"),\n        y: lAxis(\"touchY\")\n      },\n      dest: {\n        value: lTouch\n      },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: lTouch\n      },\n      dest: {\n        north: lDpadNorth,\n        south: lDpadSouth,\n        east: lDpadEast,\n        west: lDpadWest,\n        center: lDpadCenter\n      },\n      xform: xforms.vec2dpad(0.35)\n    },\n    {\n      src: {\n        value: lButton(\"touchpad\").pressed\n      },\n      dest: {\n        value: leftTouchpadPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: lButton(\"touchpad\").pressed\n      },\n      dest: {\n        value: leftTouchpadPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: rAxis(\"touchX\"),\n        y: rAxis(\"touchY\")\n      },\n      dest: {\n        value: rTouch\n      },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: rTouch\n      },\n      dest: {\n        north: rDpadNorth1,\n        south: rDpadSouth1,\n        east: rDpadEast1,\n        west: rDpadWest1,\n        center: rDpadCenter1\n      },\n      xform: xforms.vec2dpad(0.35, false, true)\n    },\n    {\n      src: {\n        x: rAxis(\"joyX\"),\n        y: rAxis(\"joyY\")\n      },\n      dest: {\n        value: rJoy\n      },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: rJoy\n      },\n      dest: {\n        north: rDpadNorth2,\n        south: rDpadSouth2,\n        east: rDpadEast2,\n        west: rDpadWest2,\n        center: rDpadCenter2\n      },\n      xform: xforms.vec2dpad(0.35, false, true)\n    },\n    {\n      src: [rDpadNorth1, rDpadSouth1, rDpadCenter1],\n      dest: { value: rDpadCenterStrip },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: rButton(\"touchpad\").pressed\n      },\n      dest: {\n        value: rTouchpadRising\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: rButton(\"touchpad\").pressed\n      },\n      dest: {\n        value: rTouchpadFalling\n      },\n      xform: xforms.falling\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadEast1\n      },\n      dest: {\n        value: rSnapRight1\n      },\n      xform: xforms.copyIfTrue,\n      priority: 1\n    },\n    {\n      src: {\n        value: rDpadEast2\n      },\n      dest: {\n        value: rSnapRight2\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"e\") },\n      dest: { value: keyboardSnapRight },\n      xform: xforms.rising\n    },\n    {\n      src: [rSnapRight1, rSnapRight2, keyboardSnapRight],\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.any\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Tab\") },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: ensureFrozenViaKeyboard },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: thawViaKeyboard },\n      xform: xforms.falling\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"p\") },\n      dest: { value: paths.actions.spawnPen },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"c\") },\n      dest: { value: paths.actions.toggleCamera },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"x\") },\n      dest: { value: paths.actions.takeSnapshot },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rButton(\"touchpad\").pressed, bool: rDpadCenterStrip },\n      dest: { value: ensureFrozenViaDpad },\n      root: rootForFrozenOverrideWhenHolding,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: rTouchpadFalling },\n      dest: { value: thawViaDpad },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadWest1\n      },\n      dest: {\n        value: rSnapLeft1\n      },\n      xform: xforms.copyIfTrue,\n      priority: 1\n    },\n    {\n      src: {\n        value: rDpadWest2\n      },\n      dest: {\n        value: rSnapLeft2\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"q\") },\n      dest: { value: keyboardSnapLeft },\n      xform: xforms.rising\n    },\n    {\n      src: [rSnapLeft1, rSnapLeft2, keyboardSnapLeft],\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: lAxis(\"touchX\")\n      },\n      dest: {\n        value: lTouchXScaled\n      },\n      xform: xforms.scale(1.5) // horizontal character speed modifier\n    },\n    {\n      src: {\n        value: lAxis(\"touchY\")\n      },\n      dest: { value: lTouchYScaled },\n      xform: xforms.scale(1.5) // vertical character speed modifier\n    },\n    {\n      src: {\n        x: lTouchXScaled,\n        y: lTouchYScaled\n      },\n      dest: { value: lTouchScaled },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        bool: leftTouchpadPressed2,\n        value: lTouchScaled\n      },\n      dest: { value: touchCharacterAcceleration },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: {\n        value: lAxis(\"joyX\")\n      },\n      dest: {\n        value: lJoyXScaled\n      },\n      xform: xforms.scale(1.5) // horizontal character speed modifier\n    },\n    {\n      src: {\n        value: lAxis(\"joyY\")\n      },\n      dest: { value: lJoyYScaled },\n      xform: xforms.scale(1.5) // vertical character speed modifier\n    },\n    {\n      src: {\n        x: lJoyXScaled,\n        y: lJoyYScaled\n      },\n      dest: { value: lJoyScaled },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        first: lJoyScaled,\n        second: touchCharacterAcceleration\n      },\n      dest: { value: lCharacterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"arrowup\"),\n        a: paths.device.keyboard.key(\"arrowleft\"),\n        s: paths.device.keyboard.key(\"arrowdown\"),\n        d: paths.device.keyboard.key(\"arrowright\")\n      },\n      dest: { vec2: arrows_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"w\"),\n        a: paths.device.keyboard.key(\"a\"),\n        s: paths.device.keyboard.key(\"s\"),\n        d: paths.device.keyboard.key(\"d\")\n      },\n      dest: { vec2: wasd_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"t\")\n      },\n      dest: {\n        value: paths.actions.focusChat\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"/\")\n      },\n      dest: {\n        value: paths.actions.focusChatCommand\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: paths.actions.mediaExit },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"1\")\n      },\n      dest: { value: \"/var/shift+1\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+1\" },\n      dest: { value: paths.actions.mediaSearch1 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"2\")\n      },\n      dest: { value: \"/var/shift+2\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+2\" },\n      dest: { value: paths.actions.mediaSearch2 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"3\")\n      },\n      dest: { value: \"/var/shift+3\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+3\" },\n      dest: { value: paths.actions.mediaSearch3 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"4\")\n      },\n      dest: { value: \"/var/shift+4\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+4\" },\n      dest: { value: paths.actions.mediaSearch4 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"5\")\n      },\n      dest: { value: \"/var/shift+5\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+5\" },\n      dest: { value: paths.actions.mediaSearch5 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"6\")\n      },\n      dest: { value: \"/var/shift+6\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+6\" },\n      dest: { value: paths.actions.mediaSearch6 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"7\")\n      },\n      dest: { value: \"/var/shift+7\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+7\" },\n      dest: { value: paths.actions.mediaSearch7 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"8\")\n      },\n      dest: { value: \"/var/shift+8\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+8\" },\n      dest: { value: paths.actions.mediaSearch8 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"l\")\n      },\n      dest: {\n        value: paths.actions.logDebugFrame\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"k\")\n      },\n      dest: {\n        value: paths.actions.logInteractionState\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"m\")\n      },\n      dest: {\n        value: paths.actions.muteMic\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        first: wasd_vec2,\n        second: arrows_vec2\n      },\n      dest: { value: keyboardCharacterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: {\n        first: lCharacterAcceleration,\n        second: keyboardCharacterAcceleration\n      },\n      dest: {\n        value: characterAcceleration\n      },\n      xform: xforms.max_vec2\n    },\n    {\n      src: { value: characterAcceleration },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.normalize_vec2\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"shift\") },\n      dest: { value: keyboardBoost },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: lButton(\"top\").pressed\n      },\n      dest: {\n        value: leftBoost\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rButton(\"top\").pressed\n      },\n      dest: {\n        value: rightBoost\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [keyboardBoost, leftBoost, rightBoost],\n      dest: { value: paths.actions.boost },\n      xform: xforms.any\n    },\n    {\n      src: { value: rPose },\n      dest: { value: paths.actions.cursor.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rPose },\n      dest: { value: paths.actions.rightHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: lPose },\n      dest: { value: paths.actions.leftHand.pose },\n      xform: xforms.copy\n    }\n  ],\n  [sets.rightHandTeleporting]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: rTriggerStopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: { value: rButton(\"touchpad\").pressed },\n      dest: { value: rTouchpadStopTeleport },\n      xform: xforms.falling\n    },\n    {\n      src: [rTriggerStopTeleport, rTouchpadStopTeleport],\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.any\n    }\n  ],\n  [sets.leftHandHoveringOnNothing]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startTeleport },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.leftHandTeleporting]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: leftTriggerFallingStopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: [leftTriggerFallingStopTeleport, leftTouchpadFallingStopTeleport, leftGripFallingWhileHoldingPen],\n      dest: { value: paths.actions.leftHand.stopTeleport },\n      xform: xforms.any\n    }\n  ],\n\n  [sets.rightHandHoveringOnNothing]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.cursorHoveringOnNothing]: [],\n\n  [sets.cursorHoveringOnUI]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.cursorHoveringOnVideo]: [\n    {\n      src: {\n        value: rAxis(\"touchY\"),\n        touching: rButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.mediaVolumeMod },\n      xform: xforms.touch_axis_scroll(0.1)\n    },\n    {\n      src: {\n        value: rAxis(\"joyY\")\n      },\n      dest: { value: paths.actions.cursor.mediaVolumeMod },\n      xform: xforms.scale(0.02)\n    }\n  ],\n\n  [sets.leftHandHoveringOnInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: lGripRisingGrab },\n      xform: xforms.rising\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: lTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: [lGripRisingGrab],\n      dest: { value: paths.actions.leftHand.grab },\n      xform: xforms.any\n    }\n  ],\n\n  [sets.leftHandHoldingInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.falling,\n      priority: 1\n    }\n  ],\n\n  [sets.leftHandHoveringOnPen]: [],\n  [sets.leftHandHoldingPen]: [\n    {\n      src: { value: leftTouchpadPressed2 },\n      dest: { value: leftTouchpadFallingStopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: {\n        value: leftTouchpadPressed2\n      },\n      dest: {\n        value: lTouchpadRising1\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: {\n        bool: lTouchpadRising1,\n        value: lDpadCenter\n      },\n      dest: { value: paths.actions.leftHand.startTeleport },\n      xform: xforms.copyIfTrue,\n      priority: 1\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startDrawing },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: lTriggerFallingStopDrawing },\n      xform: xforms.falling,\n      priority: 2\n    },\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: lGripFallingStopDrawing },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: leftGripFallingWhileHoldingPen },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: [lTriggerFallingStopDrawing, lGripFallingStopDrawing],\n      dest: { value: paths.actions.leftHand.stopDrawing },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: leftTouchpadPressed2\n      },\n      dest: {\n        value: lTouchpadRising2\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: {\n        bool: lTouchpadRising2,\n        value: lDpadNorth\n      },\n      dest: {\n        value: paths.actions.leftHand.penNextColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        bool: lTouchpadRising2,\n        value: lDpadSouth\n      },\n      dest: {\n        value: paths.actions.leftHand.penPrevColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        value: lAxis(\"touchX\"),\n        touching: lButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.leftHand.scalePenTip },\n      xform: xforms.touch_axis_scroll(0.05)\n    },\n    {\n      src: { value: rButton(\"top\").pressed },\n      dest: { value: paths.actions.leftHand.undoDrawing },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: lButton(\"top\").pressed },\n      dest: { value: paths.actions.leftHand.switchDrawMode },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.cursorHoveringOnInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rGripRisingGrab },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: rTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: [rGripRisingGrab],\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.any\n    }\n  ],\n\n  [sets.cursorHoldingUI]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: {\n        value: cursorDrop2\n      },\n      xform: xforms.falling,\n      priority: 4\n    }\n  ],\n\n  [sets.cursorHoldingInteractable]: [\n    {\n      src: {\n        value: rAxis(\"touchY\"),\n        touching: rButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.modDelta },\n      xform: xforms.touch_axis_scroll(-1)\n    },\n    {\n      src: {\n        value: rAxis(\"joyY\")\n      },\n      dest: { value: paths.actions.cursor.modDelta },\n      xform: xforms.scale(-0.02)\n    },\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: cursorDrop1 },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: [cursorDrop1, cursorDrop2],\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.any\n    },\n    {\n      src: {},\n      dest: { value: ensureFrozenViaDpad },\n      root: rootForFrozenOverrideWhenHolding,\n      xform: xforms.always(false)\n    }\n  ],\n\n  [sets.cursorHoveringOnPen]: [],\n\n  [sets.cursorHoldingPen]: [\n    {\n      src: [cursorDrop1],\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.noop,\n      priority: 1\n    },\n    {\n      src: [cursorDrop2],\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.noop,\n      priority: 1\n    },\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadCenter1\n      },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        value: rAxis(\"touchX\"),\n        touching: rButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.scalePenTip },\n      xform: xforms.touch_axis_scroll(0.1)\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadNorth1\n      },\n      dest: {\n        value: paths.actions.cursor.penNextColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadSouth1\n      },\n      dest: {\n        value: paths.actions.cursor.penPrevColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: { value: rButton(\"top\").pressed },\n      dest: { value: paths.actions.cursor.undoDrawing },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.rightHandHoveringOnInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rGripRisingGrab },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: rTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [rGripRisingGrab],\n      dest: { value: paths.actions.rightHand.grab },\n      xform: xforms.any\n    }\n  ],\n\n  [sets.rightHandHoldingInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: {},\n      dest: { value: ensureFrozenViaDpad },\n      root: rootForFrozenOverrideWhenHolding,\n      xform: xforms.always(false)\n    }\n  ],\n  [sets.rightHandHoveringOnPen]: [],\n  [sets.rightHandHoldingPen]: [\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadCenter1\n      },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadNorth1\n      },\n      dest: {\n        value: paths.actions.rightHand.penNextColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadSouth1\n      },\n      dest: {\n        value: paths.actions.rightHand.penPrevColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        value: rAxis(\"touchX\"),\n        touching: rButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.rightHand.scalePenTip },\n      xform: xforms.touch_axis_scroll(0.05)\n    },\n    {\n      src: { value: lButton(\"top\").pressed },\n      dest: { value: paths.actions.rightHand.undoDrawing },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: rButton(\"top\").pressed },\n      dest: { value: paths.actions.rightHand.switchDrawMode },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.cursorHoveringOnCamera]: [],\n  [sets.rightHandHoveringOnCamera]: [],\n  [sets.leftHandHoveringOnCamera]: [],\n\n  [sets.rightHandHoldingCamera]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.takeSnapshot },\n      xform: xforms.copy,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.noop },\n      xform: xforms.falling,\n      priority: 3\n    }\n  ],\n  [sets.leftHandHoldingCamera]: [\n    {\n      src: { value: lButton(\"trigger\").pressed },\n      dest: { value: paths.actions.leftHand.takeSnapshot },\n      xform: xforms.copy\n    }\n  ],\n  [sets.cursorHoldingCamera]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.takeSnapshot },\n      xform: xforms.copy,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.noop },\n      xform: xforms.falling,\n      priority: 3\n    }\n  ],\n  [sets.inputFocused]: [\n    {\n      src: { value: \"/device/keyboard\" },\n      dest: { value: paths.noop },\n      xform: xforms.noop,\n      priority: 1000\n    }\n  ]\n});\n\nexport const viveWandUserBindings = addSetsToBindings({\n  [sets.leftHandHoldingPen]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n  [sets.rightHandHoldingPen]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst lGripPressed = paths.device.wmr.left.grip.pressed;\nconst rGripPressed = paths.device.wmr.right.grip.pressed;\nconst rTriggerPressed = paths.device.wmr.right.trigger.pressed;\n\nconst rJoyNorth = paths.device.wmr.v(\"right/joy/north\");\nconst rGripRising = paths.device.wmr.v(\"right/grip/rising\");\nconst rTriggerRising = paths.device.wmr.v(\"right/trigger/rising\");\nconst rGripFalling = paths.device.wmr.v(\"right/grip/falling\");\nconst rTriggerFalling = paths.device.wmr.v(\"right/trigger/falling\");\n\nfunction dpadVariables(hand) {\n  return {\n    padWest: paths.device.wmr.v(hand + \"/pad/west\"),\n    padEast: paths.device.wmr.v(hand + \"/pad/east\"),\n    padNorth: paths.device.wmr.v(hand + \"/pad/north\"),\n    padSouth: paths.device.wmr.v(hand + \"/pad/south\"),\n    padCenter: paths.device.wmr.v(hand + \"/pad/center\"),\n    padCenterStrip: paths.device.wmr.v(hand + \"/pad/centerStrip\")\n  };\n}\n\nfunction dpadBindings(hand) {\n  const { padWest, padEast, padNorth, padSouth, padCenter, padCenterStrip } = dpadVariables(hand);\n  const pad = paths.device.wmr.v(hand + \"/pad\");\n  return [\n    {\n      src: {\n        x: paths.device.wmr[hand].touchpad.axisX,\n        y: paths.device.wmr[hand].touchpad.axisY\n      },\n      dest: { value: pad },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: pad },\n      dest: {\n        west: padWest,\n        east: padEast,\n        north: padNorth,\n        south: padSouth,\n        center: padCenter\n      },\n      xform: xforms.vec2dpad(0.5, false, false)\n    },\n    {\n      src: [padNorth, padCenter, padSouth],\n      dest: { value: padCenterStrip },\n      xform: xforms.any\n    }\n  ];\n}\n\nconst neverFrozenBinding = {\n  src: {},\n  dest: { value: paths.actions.ensureFrozen },\n  xform: xforms.always(false)\n};\n\nfunction penBindings(hand, forCursor) {\n  const padY = paths.device.wmr[hand].touchpad.axisY;\n  const triggerPressed = paths.device.wmr[hand].trigger.pressed;\n  const padPressed = paths.device.wmr[hand].touchpad.pressed;\n  const padTouched = paths.device.wmr[hand].touchpad.touched;\n\n  const padRising = paths.device.wmr.v(hand + \"/pad/rising\");\n  const padCenterStripTouched = paths.device.wmr.v(hand + \"/pad/centerStrip/touched\");\n  const { padWest, padEast, padCenter, padCenterStrip } = dpadVariables(hand);\n\n  const actions = paths.actions[forCursor ? \"cursor\" : hand + \"Hand\"];\n\n  return [\n    neverFrozenBinding,\n    ...dpadBindings(hand),\n    {\n      src: { value: triggerPressed },\n      dest: { value: actions.startDrawing },\n      xform: xforms.rising\n    },\n    {\n      src: { value: triggerPressed },\n      dest: { value: actions.stopDrawing },\n      xform: xforms.falling\n    },\n    {\n      src: { value: padPressed },\n      dest: { value: padRising },\n      xform: xforms.rising\n    },\n    {\n      src: { bool: padRising, value: padWest },\n      dest: { value: actions.penPrevColor },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { bool: padRising, value: padEast },\n      dest: { value: actions.penNextColor },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: [padCenterStrip, padTouched],\n      dest: { value: padCenterStripTouched },\n      xform: xforms.all\n    },\n    {\n      src: { value: padY, touching: padCenterStripTouched },\n      dest: { value: actions.scalePenTip },\n      xform: xforms.touch_axis_scroll(-0.05)\n    },\n    {\n      src: [padRising, padCenter],\n      dest: { value: actions.undoDrawing },\n      xform: xforms.all\n    }\n  ];\n}\n\nfunction handPoseBindings(hand) {\n  const padTouched = paths.device.wmr[hand].touchpad.touched;\n  const triggerPressed = paths.device.wmr[hand].trigger.pressed;\n  const gripPressed = paths.device.wmr[hand].grip.pressed;\n  const actions = paths.actions[hand + \"Hand\"];\n  return [\n    {\n      src: { value: padTouched },\n      dest: { value: actions.thumb },\n      xform: xforms.copy\n    },\n    {\n      src: { value: triggerPressed },\n      dest: { value: actions.index },\n      xform: xforms.copy\n    },\n    {\n      src: { value: gripPressed },\n      dest: { value: actions.middleRingPinky },\n      xform: xforms.copy\n    }\n  ];\n}\n\nfunction freezeBindings() {\n  const leftPadPressed = paths.device.wmr.left.touchpad.pressed;\n  const rightPadPressed = paths.device.wmr.right.touchpad.pressed;\n  const leftPadFalling = paths.device.wmr.v(\"left/touchpad/falling\");\n  const rightPadFalling = paths.device.wmr.v(\"right/touchpad/falling\");\n  const keyboardSaceFalling = paths.device.wmr.k(\"space/falling\");\n  return [\n    {\n      src: [paths.device.keyboard.key(\" \"), leftPadPressed, rightPadPressed],\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.any\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: keyboardSaceFalling },\n      xform: xforms.falling\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Tab\") },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.rising\n    },\n    {\n      src: { value: leftPadPressed },\n      dest: { value: leftPadFalling },\n      xform: xforms.falling\n    },\n    {\n      src: { value: rightPadPressed },\n      dest: { value: rightPadFalling },\n      xform: xforms.falling\n    },\n    {\n      src: [keyboardSaceFalling, leftPadFalling, rightPadFalling],\n      dest: { value: paths.actions.thaw },\n      xform: xforms.any\n    }\n  ];\n}\n\nfunction characterAccelerationBindings() {\n  const wasd_vec2 = paths.device.wmr.k(\"wasd_vec2\");\n  const arrows_vec2 = paths.device.wmr.k(\"arrows_vec2\");\n  const keyboardCharacterAcceleration = paths.device.wmr.k(\"characterAcceleration\");\n  const lJoyXDeadzoned = paths.device.wmr.v(\"left/joy/x/deadzoned\");\n  const lJoyYDeadzoned = paths.device.wmr.v(\"left/joy/y/deadzoned\");\n  const lJoyXScaled = paths.device.wmr.v(\"left/joy/x/scaled\");\n  const lJoyYScaled = paths.device.wmr.v(\"left/joy/y/scaled\");\n  const lCharacterAcceleration = paths.device.wmr.v(\"left/characterAcceleration\");\n  return [\n    {\n      src: {\n        w: paths.device.keyboard.key(\"arrowup\"),\n        a: paths.device.keyboard.key(\"arrowleft\"),\n        s: paths.device.keyboard.key(\"arrowdown\"),\n        d: paths.device.keyboard.key(\"arrowright\")\n      },\n      dest: { vec2: arrows_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"w\"),\n        a: paths.device.keyboard.key(\"a\"),\n        s: paths.device.keyboard.key(\"s\"),\n        d: paths.device.keyboard.key(\"d\")\n      },\n      dest: { vec2: wasd_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        first: wasd_vec2,\n        second: arrows_vec2\n      },\n      dest: { value: keyboardCharacterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: { value: paths.device.wmr.left.joystick.axisX },\n      dest: { value: lJoyXDeadzoned },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: lJoyXDeadzoned },\n      dest: { value: lJoyXScaled },\n      xform: xforms.scale(1.5) // horizontal character speed modifier\n    },\n    {\n      src: { value: paths.device.wmr.left.joystick.axisY },\n      dest: { value: lJoyYDeadzoned },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: lJoyYDeadzoned },\n      dest: { value: lJoyYScaled },\n      xform: xforms.scale(-1.5) // vertical character speed modifier\n    },\n    {\n      src: { x: lJoyXScaled, y: lJoyYScaled },\n      dest: { value: lCharacterAcceleration },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        first: lCharacterAcceleration,\n        second: keyboardCharacterAcceleration\n      },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: [\n        paths.device.wmr.left.trigger.pressed,\n        paths.device.wmr.right.trigger.pressed,\n        paths.device.keyboard.key(\"shift\")\n      ],\n      dest: { value: paths.actions.boost },\n      xform: xforms.any\n    }\n  ];\n}\n\nfunction cursorModDeltaBindings() {\n  const { padNorth, padSouth } = dpadVariables(\"right\");\n  const rPadNorthOrSouth = paths.device.wmr.v(\"right/pad/northOrSouth\");\n  const rPadNorthOrSouthPressed = paths.device.wmr.v(\"right/pad/northOrSouth/pressed\");\n  const rPadNorthOrSouthPressedY = paths.device.wmr.v(\"right/pad/northOrSouthpressed/y\");\n  return [\n    ...dpadBindings(\"right\"),\n    {\n      src: [padNorth, padSouth],\n      dest: { value: rPadNorthOrSouth },\n      xform: xforms.any\n    },\n    {\n      src: [rPadNorthOrSouth, paths.device.wmr.right.touchpad.pressed],\n      dest: { value: rPadNorthOrSouthPressed },\n      xform: xforms.all\n    },\n    {\n      src: {\n        bool: rPadNorthOrSouthPressed,\n        value: paths.device.wmr.right.touchpad.axisY\n      },\n      dest: { value: rPadNorthOrSouthPressedY },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: rPadNorthOrSouthPressedY },\n      dest: { value: paths.actions.cursor.modDelta },\n      xform: xforms.scale(0.1)\n    }\n  ];\n}\n\nfunction cursorMediaVolumeModBindings() {\n  const hand = \"right\";\n  const padY = paths.device.wmr[hand].touchpad.axisY;\n  const padTouched = paths.device.wmr[hand].touchpad.touched;\n\n  const padCenterStripTouched = paths.device.wmr.v(hand + \"/pad/centerStrip/touched\");\n  const { padCenterStrip } = dpadVariables(hand);\n\n  return [\n    ...dpadBindings(hand),\n    {\n      src: [padCenterStrip, padTouched],\n      dest: { value: padCenterStripTouched },\n      xform: xforms.all\n    },\n    {\n      src: { value: padY, touching: padCenterStripTouched },\n      dest: { value: paths.actions.cursor.mediaVolumeMod },\n      xform: xforms.touch_axis_scroll(-0.1)\n    }\n  ];\n}\n\nfunction holdingCameraBindings(hand, forCursor) {\n  const actions = paths.actions[forCursor ? \"cursor\" : hand + \"Hand\"];\n  return [\n    neverFrozenBinding,\n    {\n      src: { value: paths.device.wmr[hand].trigger.pressed },\n      dest: { value: actions.takeSnapshot },\n      xform: xforms.copy\n    }\n  ];\n}\n\nfunction teleportationAndRotationBindings() {\n  const rJoy = paths.device.wmr.v(\"right/joy\");\n  const rJoyWest = paths.device.wmr.v(\"right/joy/west\");\n  const rJoyEast = paths.device.wmr.v(\"right/joy/East\");\n  const rJoyWestRising = paths.device.wmr.v(\"right/joy/west/rising\");\n  const rJoyEastRising = paths.device.wmr.v(\"right/joy/east/rising\");\n  const keyboardQRising = paths.device.wmr.k(\"q/rising\");\n  const keyboardERising = paths.device.wmr.k(\"e/rising\");\n  return [\n    {\n      src: {\n        x: paths.device.wmr.right.joystick.axisX,\n        y: paths.device.wmr.right.joystick.axisY\n      },\n      dest: { value: rJoy },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: rJoy },\n      dest: {\n        north: rJoyNorth,\n        west: rJoyWest,\n        east: rJoyEast\n      },\n      xform: xforms.vec2dpad(0.2, false, false)\n    },\n    {\n      src: { value: rJoyNorth },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rJoyWest },\n      dest: { value: rJoyWestRising },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rJoyEast },\n      dest: { value: rJoyEastRising },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"q\") },\n      dest: { value: keyboardQRising },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"e\") },\n      dest: { value: keyboardERising },\n      xform: xforms.rising\n    },\n    {\n      src: [rJoyWestRising, keyboardQRising],\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.any\n    },\n    {\n      src: [rJoyEastRising, keyboardERising],\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.any\n    }\n  ];\n}\n\nexport const wmrUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: { value: paths.device.wmr.left.matrix },\n      dest: { value: paths.actions.leftHand.matrix },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.wmr.right.matrix },\n      dest: { value: paths.actions.rightHand.matrix },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.wmr.left.pose },\n      dest: { value: paths.actions.leftHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.wmr.right.pose },\n      dest: { value: paths.actions.cursor.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.wmr.right.pose },\n      dest: { value: paths.actions.rightHand.pose },\n      xform: xforms.copy\n    },\n    ...handPoseBindings(\"left\"),\n    ...handPoseBindings(\"right\"),\n    ...freezeBindings(),\n    ...teleportationAndRotationBindings(),\n    ...characterAccelerationBindings(),\n    {\n      src: {\n        value: paths.device.keyboard.key(\"m\")\n      },\n      dest: {\n        value: paths.actions.muteMic\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"t\")\n      },\n      dest: {\n        value: paths.actions.focusChat\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"/\")\n      },\n      dest: {\n        value: paths.actions.focusChatCommand\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: paths.actions.mediaExit },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"1\")\n      },\n      dest: { value: \"/var/shift+1\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+1\" },\n      dest: { value: paths.actions.mediaSearch1 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"2\")\n      },\n      dest: { value: \"/var/shift+2\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+2\" },\n      dest: { value: paths.actions.mediaSearch2 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"3\")\n      },\n      dest: { value: \"/var/shift+3\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+3\" },\n      dest: { value: paths.actions.mediaSearch3 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"4\")\n      },\n      dest: { value: \"/var/shift+4\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+4\" },\n      dest: { value: paths.actions.mediaSearch4 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"5\")\n      },\n      dest: { value: \"/var/shift+5\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+5\" },\n      dest: { value: paths.actions.mediaSearch5 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"6\")\n      },\n      dest: { value: \"/var/shift+6\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+6\" },\n      dest: { value: paths.actions.mediaSearch6 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"7\")\n      },\n      dest: { value: \"/var/shift+7\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+7\" },\n      dest: { value: paths.actions.mediaSearch7 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"8\")\n      },\n      dest: { value: \"/var/shift+8\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+8\" },\n      dest: { value: paths.actions.mediaSearch8 },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.leftHandHoveringOnNothing]: [],\n  [sets.cursorHoveringOnNothing]: [],\n  [sets.rightHandHoveringOnNothing]: [],\n\n  [sets.rightHandTeleporting]: [\n    {\n      src: { value: rJoyNorth },\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.falling\n    }\n  ],\n\n  [sets.cursorHoveringOnUI]: [\n    {\n      src: { value: rTriggerPressed },\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.cursorHoveringOnVideo]: [...cursorMediaVolumeModBindings()],\n\n  [sets.leftHandHoveringOnInteractable]: [\n    {\n      src: { value: lGripPressed },\n      dest: { value: paths.actions.leftHand.grab },\n      xform: xforms.rising\n    }\n  ],\n  [sets.cursorHoveringOnInteractable]: [\n    {\n      src: { value: rGripPressed },\n      dest: { value: rGripRising },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rTriggerPressed },\n      dest: { value: rTriggerRising },\n      xform: xforms.rising\n    },\n    {\n      src: [rGripRising, rTriggerRising],\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.any\n    }\n  ],\n  [sets.rightHandHoveringOnInteractable]: [\n    {\n      src: { value: rGripPressed },\n      dest: { value: paths.actions.rightHand.grab },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.leftHandHoldingInteractable]: [\n    neverFrozenBinding,\n    {\n      src: { value: lGripPressed },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.falling\n    }\n  ],\n  [sets.cursorHoldingInteractable]: [\n    neverFrozenBinding,\n    ...cursorModDeltaBindings(),\n    {\n      src: { value: rGripPressed },\n      dest: { value: rGripFalling },\n      xform: xforms.falling\n    },\n    {\n      src: { value: rTriggerPressed },\n      dest: { value: rTriggerFalling },\n      xform: xforms.falling\n    },\n    {\n      src: [rGripFalling, rTriggerFalling],\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.any\n    }\n  ],\n  [sets.rightHandHoldingInteractable]: [\n    neverFrozenBinding,\n    {\n      src: { value: rGripPressed },\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.falling\n    }\n  ],\n\n  [sets.leftHandHoveringOnPen]: [],\n  [sets.cursorHoveringOnPen]: [],\n  [sets.rightHandHoveringOnPen]: [],\n\n  [sets.leftHandHoldingPen]: penBindings(\"left\"),\n  [sets.cursorHoldingPen]: penBindings(\"right\", true),\n  [sets.rightHandHoldingPen]: penBindings(\"right\"),\n\n  [sets.leftHandHoveringOnCamera]: [],\n  [sets.cursorHoveringOnCamera]: [],\n  [sets.rightHandHoveringOnCamera]: [],\n\n  [sets.leftHandHoldingCamera]: holdingCameraBindings(\"left\"),\n  [sets.cursorHoldingCamera]: holdingCameraBindings(\"right\", true),\n  [sets.rightHandHoldingCamera]: holdingCameraBindings(\"right\"),\n\n  [sets.inputFocused]: [\n    {\n      src: { value: \"/device/keyboard\" },\n      dest: { value: paths.noop },\n      xform: xforms.noop,\n      priority: 1000\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst button = paths.device.xbox.button;\nconst axis = paths.device.xbox.axis;\nconst scaledRightJoystickVertical = paths.device.xbox.v(\"scaledRightJoystickVertical\");\nconst scaledLeftJoystickCursorDelta = paths.device.xbox.v(\"scaledLeftJoystickCursorDelta\");\nconst deadzonedRightJoystickHorizontal = paths.device.xbox.v(\"deadzonedRightJoystickHorizontal\");\nconst deadzonedRightJoystickVertical = paths.device.xbox.v(\"deadzonedRightJoystickVertical\");\nconst deadzonedLeftJoystickHorizontal = paths.device.xbox.v(\"deadzonedLeftJoystickHorizontal\");\nconst deadzonedLeftJoystickVertical = paths.device.xbox.v(\"deadzonedLeftJoystickVertical\");\nconst vec2Zero = paths.device.xbox.v(\"vec2Zero\");\nconst zero = paths.device.xbox.v(\"zero\");\n\nfunction characterAccelerationBindings(disableForwardOnTrigger) {\n  const scaledLeftJoystickHorizontal = paths.device.xbox.v(\"scaledLeftJoystickHorizontal\");\n  const scaledLeftJoystickVertical = paths.device.xbox.v(\"scaledLeftJoystickVertical\");\n  const scaledLeftJoystickForwardAcceleration = paths.device.xbox.v(\"scaledLeftJoystickForwardAcceleration\");\n  return [\n    {\n      src: { value: deadzonedLeftJoystickHorizontal },\n      dest: { value: scaledLeftJoystickHorizontal },\n      xform: xforms.scale(1.5) // horizontal move speed modifier\n    },\n    {\n      src: { value: deadzonedLeftJoystickVertical },\n      dest: { value: scaledLeftJoystickVertical },\n      xform: xforms.scale(-1.25) // vertical move speed modifier\n    },\n    {\n      src: {\n        bool: button(\"leftTrigger\").pressed,\n        value: scaledLeftJoystickVertical\n      },\n      dest: { value: scaledLeftJoystickForwardAcceleration },\n      xform: disableForwardOnTrigger ? xforms.copyIfFalse : xforms.copy\n    },\n    {\n      src: {\n        x: scaledLeftJoystickHorizontal,\n        y: scaledLeftJoystickForwardAcceleration\n      },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.compose_vec2\n    }\n  ];\n}\n\nexport const xboxControllerUserBindings = addSetsToBindings({\n  [sets.cursorHoldingPen]: [\n    {\n      src: { value: button(\"rightTrigger\").pressed },\n      dest: { value: paths.actions.cursor.startDrawing },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: { value: button(\"rightTrigger\").pressed },\n      dest: { value: paths.actions.cursor.stopDrawing },\n      xform: xforms.falling,\n      priority: 200\n    },\n    {\n      src: { value: button(\"b\").pressed },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.rising\n    },\n    {\n      src: { value: button(\"y\").pressed },\n      dest: { value: paths.actions.cursor.undoDrawing },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: { value: button(\"a\").pressed },\n      dest: { value: paths.actions.cursor.penNextColor },\n      xform: xforms.rising\n    },\n    {\n      src: { value: button(\"x\").pressed },\n      dest: { value: paths.actions.cursor.penPrevColor },\n      xform: xforms.rising\n    }\n  ],\n  [sets.global]: [\n    {\n      src: {},\n      dest: { value: paths.actions.cursor.hideLine },\n      xform: xforms.always(true)\n    },\n    {\n      src: { value: axis(\"rightJoystickHorizontal\") },\n      dest: { value: deadzonedRightJoystickHorizontal },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: deadzonedRightJoystickHorizontal },\n      dest: { value: paths.actions.angularVelocity },\n      xform: xforms.scale(0.6) // horizontal look speed modifier\n    },\n    {\n      src: { value: axis(\"rightJoystickVertical\") },\n      dest: { value: deadzonedRightJoystickVertical },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: deadzonedRightJoystickVertical },\n      dest: { value: scaledRightJoystickVertical },\n      xform: xforms.scale(-1.25) // vertical look speed modifier\n    },\n    {\n      src: {},\n      dest: { value: zero },\n      xform: xforms.always(0)\n    },\n    {\n      src: {\n        x: zero,\n        y: scaledRightJoystickVertical\n      },\n      dest: { value: paths.actions.cameraDelta },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: paths.actions.cameraDelta },\n      dest: { value: paths.actions.lobbyCameraDelta },\n      xform: xforms.copy\n    },\n    {\n      src: { value: axis(\"leftJoystickHorizontal\") },\n      dest: { value: deadzonedLeftJoystickHorizontal },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: axis(\"leftJoystickVertical\") },\n      dest: { value: deadzonedLeftJoystickVertical },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: button(\"leftTrigger\").pressed },\n      dest: { value: paths.actions.boost },\n      xform: xforms.copy\n    },\n    {\n      src: { value: button(\"leftBumper\").pressed },\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.rising\n    },\n    {\n      src: { value: button(\"rightBumper\").pressed },\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.rising\n    },\n    {\n      src: {},\n      dest: { value: vec2Zero },\n      xform: xforms.vec2Zero\n    },\n    {\n      src: { value: vec2Zero },\n      dest: { value: paths.actions.cursor.pose },\n      xform: xforms.poseFromCameraProjection()\n    },\n    {\n      src: { value: button(\"y\").pressed },\n      dest: { value: paths.actions.spawnPen },\n      xform: xforms.rising,\n      priority: 100\n    },\n    {\n      src: { value: button(\"dpadUp\").pressed },\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.copy\n    },\n    {\n      src: { value: button(\"dpadUp\").pressed },\n      dest: { value: paths.actions.thaw },\n      xform: xforms.falling\n    },\n    {\n      src: { value: button(\"start\").pressed },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.rising\n    },\n    {\n      src: { value: button(\"a\").pressed },\n      dest: { value: paths.actions.startGazeTeleport },\n      xform: xforms.rising\n    },\n    {\n      src: { value: button(\"a\").pressed },\n      dest: { value: paths.actions.stopGazeTeleport },\n      xform: xforms.falling\n    }\n  ],\n  [sets.cursorHoldingNothing]: [...characterAccelerationBindings()],\n  [sets.cursorHoldingInteractable]: [\n    ...characterAccelerationBindings(true),\n    {\n      src: { value: button(\"rightTrigger\").pressed },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.falling,\n      priority: 100\n    },\n    {\n      src: { value: deadzonedLeftJoystickVertical },\n      dest: { value: scaledLeftJoystickCursorDelta },\n      xform: xforms.scale(0.25)\n    },\n    {\n      src: {\n        bool: button(\"leftTrigger\").pressed,\n        value: scaledLeftJoystickCursorDelta\n      },\n      dest: { value: paths.actions.cursor.modDelta },\n      xform: xforms.copyIfTrue\n    }\n  ],\n  [sets.cursorHoveringOnUI]: [\n    {\n      src: { value: button(\"rightTrigger\").pressed },\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.rising\n    }\n  ],\n  [sets.cursorHoveringOnInteractable]: [\n    ...characterAccelerationBindings(),\n    {\n      src: { value: button(\"rightTrigger\").pressed },\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.rising,\n      priority: 100\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\n// vars\nconst v = s => `/vars/daydream/${s}`;\nconst touchpad = v(\"touchpad/axis\");\nconst touchpadRising = v(\"touchpad/rising\");\nconst touchpadFalling = v(\"touchpad/falling\");\nconst touchpadPressed = v(\"touchpad/pressed\");\nconst dpadNorth = v(\"dpad/north\");\nconst dpadSouth = v(\"dpad/south\");\nconst dpadEast = v(\"dpad/east\");\nconst dpadWest = v(\"dpad/west\");\nconst dpadCenter = v(\"dpad/center\");\nconst brushSizeDelta = v(\"brushSizeDelta\");\nconst cursorModDelta = v(\"cursorModDelta\");\nconst dpadSouthDrop = v(\"dropSouth\");\nconst dpadCenterDrop = v(\"dropCenter\");\n\nconst grabBinding = [\n  {\n    src: { value: dpadCenter, bool: touchpadRising },\n    dest: { value: paths.actions.cursor.grab },\n    xform: xforms.copyIfTrue,\n    priority: 100\n  }\n];\n\nconst dropOnCenterOrSouth = [\n  {\n    src: { value: dpadCenter, bool: touchpadRising },\n    dest: { value: dpadCenterDrop },\n    xform: xforms.copyIfTrue,\n    priority: 100\n  },\n  {\n    src: { value: dpadSouth, bool: touchpadRising },\n    dest: { value: dpadSouthDrop },\n    xform: xforms.copyIfTrue,\n    priority: 100\n  },\n  {\n    src: [dpadCenterDrop, dpadSouthDrop],\n    dest: { value: paths.actions.cursor.drop },\n    xform: xforms.any\n  }\n];\n\nexport const daydreamUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: { value: paths.device.daydream.matrix },\n      dest: { value: paths.actions.rightHand.matrix },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: paths.device.daydream.axis(\"touchpadX\"),\n        y: paths.device.daydream.axis(\"touchpadY\")\n      },\n      dest: { value: touchpad },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: paths.device.daydream.button(\"touchpad\").pressed\n      },\n      dest: { value: touchpadRising },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.daydream.button(\"touchpad\").pressed\n      },\n      dest: { value: touchpadFalling },\n      xform: xforms.falling\n    },\n    {\n      src: {\n        value: paths.device.daydream.button(\"touchpad\").pressed\n      },\n      dest: { value: touchpadPressed },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: touchpad\n      },\n      dest: {\n        north: dpadNorth,\n        south: dpadSouth,\n        east: dpadEast,\n        west: dpadWest,\n        center: dpadCenter\n      },\n      xform: xforms.vec2dpad(0.5)\n    },\n    {\n      src: {\n        value: dpadEast,\n        bool: touchpadRising\n      },\n      dest: {\n        value: paths.actions.snapRotateRight\n      },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: {\n        value: dpadWest,\n        bool: touchpadRising\n      },\n      dest: {\n        value: paths.actions.snapRotateLeft\n      },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: {\n        value: dpadCenter,\n        bool: touchpadRising\n      },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: paths.device.daydream.pose },\n      dest: { value: paths.actions.cursor.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.daydream.pose },\n      dest: { value: paths.actions.rightHand.pose },\n      xform: xforms.copy\n    }\n  ],\n\n  [sets.cursorHoveringOnInteractable]: grabBinding,\n  [sets.cursorHoveringOnUI]: grabBinding,\n\n  [sets.cursorHoveringOnVideo]: [\n    {\n      src: {\n        value: paths.device.daydream.axis(\"touchpadY\"),\n        touching: paths.device.daydream.button(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.mediaVolumeMod },\n      xform: xforms.touch_axis_scroll(-0.1)\n    }\n  ],\n\n  [sets.cursorHoldingInteractable]: [\n    {\n      src: { value: touchpadFalling },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: paths.device.daydream.axis(\"touchpadY\"),\n        touching: paths.device.daydream.button(\"touchpad\").touched\n      },\n      dest: { value: cursorModDelta },\n      xform: xforms.touch_axis_scroll()\n    },\n    {\n      src: { value: cursorModDelta },\n      dest: { value: paths.actions.cursor.modDelta },\n      xform: xforms.copy\n    }\n  ],\n\n  [sets.rightHandTeleporting]: [\n    {\n      src: { value: touchpadFalling },\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.copy\n    }\n  ],\n\n  [sets.cursorHoldingPen]: [\n    {\n      src: { value: dpadNorth, bool: touchpadRising },\n      dest: { value: paths.actions.cursor.startDrawing },\n      xform: xforms.copyIfTrue,\n      priority: 100\n    },\n    {\n      src: { value: touchpadFalling },\n      dest: { value: paths.actions.cursor.stopDrawing },\n      xform: xforms.copy,\n      priority: 100\n    },\n    {\n      src: {\n        value: paths.device.daydream.axis(\"touchpadX\"),\n        touching: paths.device.daydream.button(\"touchpad\").touched\n      },\n      dest: { value: brushSizeDelta },\n      xform: xforms.touch_axis_scroll(-0.1)\n    },\n    {\n      src: {\n        value: brushSizeDelta,\n        bool: touchpadPressed\n      },\n      dest: { value: paths.actions.cursor.scalePenTip },\n      xform: xforms.copyIfFalse,\n      priority: 100\n    },\n    {\n      src: { value: dpadEast, bool: touchpadRising },\n      dest: {\n        value: paths.actions.cursor.penPrevColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 100\n    },\n    {\n      src: { value: dpadWest, bool: touchpadRising },\n      dest: {\n        value: paths.actions.cursor.penNextColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 100\n    },\n    {\n      src: {\n        value: cursorModDelta,\n        bool: touchpadPressed\n      },\n      dest: { value: paths.actions.cursor.modDelta },\n      xform: xforms.copyIfFalse,\n      priority: 100\n    },\n    ...dropOnCenterOrSouth\n  ],\n\n  [sets.cursorHoldingCamera]: [\n    // Don't drop on touchpad release\n    {\n      src: {\n        value: touchpadFalling\n      },\n      xform: xforms.noop,\n      priority: 100\n    },\n    {\n      src: {\n        value: dpadNorth,\n        bool: touchpadRising\n      },\n      dest: { value: paths.actions.cursor.takeSnapshot },\n      xform: xforms.copy,\n      priority: 100\n    },\n    ...dropOnCenterOrSouth\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nexport const cardboardUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: { value: paths.device.touchscreen.isTouching },\n      dest: {\n        value: paths.actions.startGazeTeleport\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.touchscreen.isTouching },\n      dest: {\n        value: paths.actions.stopGazeTeleport\n      },\n      xform: xforms.falling\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nexport default function generate3DOFTriggerBindings(device) {\n  const touchpad = device.v(\"touchpad\");\n  const touchpadButton = device.button(\"touchpad\");\n  const triggerButton = device.button(\"trigger\");\n  const touchpadX = device.axis(\"touchpadX\");\n  const touchpadXForPen = device.axis(\"touchpadXForPen\");\n  const touchpadY = device.axis(\"touchpadY\");\n  const touchpadYForPen = device.axis(\"touchpadYForPen\");\n  const touchpadRising = device.v(\"touchpad/rising\");\n  const touchpadFalling = device.v(\"touchpad/falling\");\n  const triggerRising = device.v(\"trigger/rising\");\n  const triggerFalling = device.v(\"trigger/falling\");\n  const dpadNorth = device.v(\"dpad/north\");\n  const dpadSouth = device.v(\"dpad/south\");\n  const dpadEast = device.v(\"dpad/east\");\n  const dpadWest = device.v(\"dpad/west\");\n  const dpadCenter = device.v(\"dpad/center\");\n  const dpadCenterStrip = device.v(\"dpad/centerStrip\");\n  const dpadBottomCenterStrip = device.v(\"dpad/bottomCenterStrip\");\n  const togglePen = \"/vars/oculus-go/togglePen\";\n\n  const grabBinding = {\n    src: {\n      value: triggerRising\n    },\n    dest: { value: paths.actions.cursor.grab },\n    xform: xforms.copy,\n    priority: 200\n  };\n  const dropBinding = {\n    src: {\n      value: triggerFalling\n    },\n    dest: { value: paths.actions.cursor.drop },\n    xform: xforms.copy,\n    priority: 200\n  };\n\n  return addSetsToBindings({\n    [sets.global]: [\n      {\n        src: { value: device.matrix },\n        dest: { value: paths.actions.rightHand.matrix },\n        xform: xforms.copy\n      },\n      {\n        src: {\n          value: triggerButton.pressed\n        },\n        dest: { value: triggerRising },\n        xform: xforms.rising\n      },\n      {\n        src: {\n          value: triggerButton.pressed\n        },\n        dest: { value: triggerFalling },\n        xform: xforms.falling\n      },\n      {\n        src: {\n          value: touchpadButton.pressed\n        },\n        dest: { value: touchpadRising },\n        xform: xforms.rising,\n        priority: 100\n      },\n      {\n        src: {\n          value: touchpadButton.pressed\n        },\n        dest: { value: touchpadFalling },\n        xform: xforms.falling,\n        priority: 100\n      },\n      {\n        src: {\n          x: touchpadX,\n          y: touchpadY\n        },\n        dest: { value: touchpad },\n        xform: xforms.compose_vec2\n      },\n      {\n        src: { value: touchpadX },\n        dest: { value: touchpadXForPen },\n        xform: xforms.copy\n      },\n      {\n        src: { value: touchpadY },\n        dest: { value: touchpadYForPen },\n        xform: xforms.copy\n      },\n      {\n        src: {\n          value: touchpad\n        },\n        dest: {\n          north: dpadNorth,\n          south: dpadSouth,\n          east: dpadEast,\n          west: dpadWest,\n          center: dpadCenter\n        },\n        xform: xforms.vec2dpad(0.3)\n      },\n      {\n        src: [dpadCenter, dpadSouth],\n        dest: { value: dpadBottomCenterStrip },\n        xform: xforms.any\n      },\n      {\n        src: [dpadNorth, dpadBottomCenterStrip],\n        dest: { value: dpadCenterStrip },\n        xform: xforms.any\n      },\n      {\n        src: {\n          value: dpadCenterStrip,\n          bool: touchpadButton.pressed\n        },\n        dest: {\n          value: paths.actions.ensureFrozen\n        },\n        priority: 100,\n        xform: xforms.copyIfTrue\n      },\n      {\n        src: { value: touchpadFalling },\n        dest: {\n          value: paths.actions.thaw\n        },\n        xform: xforms.copy\n      },\n      {\n        src: {\n          value: dpadEast,\n          bool: touchpadRising\n        },\n        dest: {\n          value: paths.actions.snapRotateRight\n        },\n        xform: xforms.copyIfTrue,\n        priority: 100\n      },\n      {\n        src: {\n          value: dpadWest,\n          bool: touchpadRising\n        },\n        dest: {\n          value: paths.actions.snapRotateLeft\n        },\n        xform: xforms.copyIfTrue,\n        priority: 100\n      },\n      {\n        src: {\n          value: triggerRising\n        },\n        dest: { value: paths.actions.rightHand.startTeleport },\n        xform: xforms.copy,\n        priority: 100\n      },\n      {\n        src: { value: device.pose },\n        dest: { value: paths.actions.cursor.pose },\n        xform: xforms.copy\n      },\n      {\n        src: { value: device.pose },\n        dest: { value: paths.actions.rightHand.pose },\n        xform: xforms.copy\n      },\n      {\n        src: { value: touchpadButton.touched },\n        dest: { value: paths.actions.rightHand.thumb },\n        xform: xforms.copy\n      },\n      {\n        src: { value: triggerButton.pressed },\n        dest: { value: paths.actions.rightHand.index },\n        xform: xforms.copy\n      },\n      {\n        src: { value: triggerButton.pressed },\n        dest: { value: paths.actions.rightHand.middleRingPinky },\n        xform: xforms.copy\n      }\n    ],\n\n    [sets.cursorHoveringOnInteractable]: [grabBinding],\n    [sets.cursorHoveringOnUI]: [grabBinding],\n    [sets.cursorHoldingUI]: [dropBinding],\n    [sets.cursorHoveringOnVideo]: [\n      {\n        src: {\n          value: touchpadY,\n          touching: touchpadButton.touched\n        },\n        dest: { value: paths.actions.cursor.mediaVolumeMod },\n        xform: xforms.touch_axis_scroll(-0.1)\n      }\n    ],\n\n    [sets.cursorHoldingInteractable]: [\n      {\n        src: {\n          value: triggerFalling\n        },\n        dest: { value: paths.actions.cursor.drop },\n        xform: xforms.copy,\n        priority: 200\n      },\n      {\n        src: {\n          value: touchpadY,\n          touching: touchpadButton.touched\n        },\n        dest: { value: paths.actions.cursor.modDelta },\n        xform: xforms.touch_axis_scroll()\n      },\n      {\n        src: { value: dpadCenterStrip },\n        priority: 200,\n        xform: xforms.noop\n      }\n    ],\n\n    [sets.rightHandTeleporting]: [\n      {\n        src: {\n          value: triggerFalling\n        },\n        dest: { value: paths.actions.rightHand.stopTeleport },\n        xform: xforms.copy,\n        priority: 100\n      }\n    ],\n\n    [sets.cursorHoldingPen]: [\n      {\n        src: {\n          value: triggerRising\n        },\n        dest: { value: paths.actions.cursor.startDrawing },\n        xform: xforms.copy,\n        priority: 300\n      },\n      {\n        src: {\n          value: triggerFalling\n        },\n        dest: { value: paths.actions.cursor.stopDrawing },\n        xform: xforms.copy,\n        priority: 300\n      },\n      {\n        src: {\n          value: touchpadXForPen,\n          touching: touchpadButton.touched\n        },\n        dest: { value: paths.actions.cursor.scalePenTip },\n        xform: xforms.touch_axis_scroll(0.1, 0.1),\n        priority: 200\n      },\n      {\n        src: {\n          value: touchpadYForPen,\n          touching: touchpadButton.touched\n        },\n        dest: { value: paths.actions.cursor.modDelta },\n        xform: xforms.touch_axis_scroll(1, 0.1),\n        priority: 200\n      },\n      {\n        src: {\n          value: dpadBottomCenterStrip,\n          bool: touchpadFalling\n        },\n        dest: { value: togglePen },\n        xform: xforms.copyIfTrue,\n        priority: 300\n      },\n      {\n        src: { value: togglePen },\n        dest: { value: paths.actions.cursor.drop },\n        xform: xforms.rising,\n        priority: 200\n      },\n      {\n        src: { value: togglePen },\n        dest: { value: paths.actions.pen.remove },\n        xform: xforms.rising,\n        priority: 200\n      },\n      {\n        src: {\n          value: dpadEast,\n          bool: touchpadRising\n        },\n        dest: {\n          value: paths.actions.cursor.penPrevColor\n        },\n        xform: xforms.copyIfTrue,\n        priority: 200\n      },\n      {\n        src: {\n          value: dpadWest,\n          bool: touchpadRising\n        },\n        dest: {\n          value: paths.actions.cursor.penNextColor\n        },\n        xform: xforms.copyIfTrue,\n        priority: 200\n      },\n      {\n        src: {\n          value: dpadNorth,\n          bool: touchpadRising\n        },\n        dest: {\n          value: paths.actions.cursor.undoDrawing\n        },\n        xform: xforms.copyIfTrue,\n        priority: 200\n      }\n    ],\n\n    [sets.cursorHoldingCamera]: [\n      {\n        src: {\n          value: triggerRising\n        },\n        dest: { value: paths.actions.cursor.takeSnapshot },\n        xform: xforms.copy,\n        priority: 300\n      }\n    ]\n  });\n}\n","import { sets } from \"./sets\";\n\nlet leftTeleporter, rightTeleporter;\n\nexport function resolveActionSets() {\n  leftTeleporter = leftTeleporter || document.querySelector(\"#player-left-controller\").components.teleporter;\n  rightTeleporter = rightTeleporter || document.querySelector(\"#player-right-controller\").components.teleporter;\n  const userinput = AFRAME.scenes[0].systems.userinput;\n  const { leftHand, rightHand, rightRemote } = AFRAME.scenes[0].systems.interaction.state;\n\n  userinput.toggleSet(sets.leftHandHoveringOnNothing, !leftHand.held && !leftHand.hovered);\n  userinput.toggleSet(\n    sets.leftHandHoveringOnPen,\n    !leftHand.held &&\n      leftHand.hovered &&\n      leftHand.hovered.components.tags &&\n      leftHand.hovered.components.tags.data.isPen\n  );\n  userinput.toggleSet(\n    sets.leftHandHoveringOnCamera,\n    !leftHand.held && leftHand.hovered && leftHand.hovered.components[\"camera-tool\"]\n  );\n  userinput.toggleSet(\n    sets.leftHandHoveringOnInteractable,\n    !leftHand.held &&\n      (leftHand.hovered &&\n        ((leftHand.hovered.components.tags && leftHand.hovered.components.tags.data.offersRemoteConstraint) ||\n          leftHand.hovered.components[\"super-spawner\"]))\n  );\n  userinput.toggleSet(\n    sets.leftHandHoveringOnVideo,\n    !leftHand.held && leftHand.hovered && leftHand.hovered.components[\"media-video\"]\n  );\n  userinput.toggleSet(\n    sets.leftHandHoldingPen,\n    leftHand.held && leftHand.held.components.tags && leftHand.held.components.tags.data.isPen\n  );\n  userinput.toggleSet(sets.leftHandHoldingCamera, leftHand.held && leftHand.held.components[\"camera-tool\"]);\n  userinput.toggleSet(sets.leftHandHoldingInteractable, leftHand.held);\n\n  userinput.toggleSet(\n    sets.rightHandHoveringOnNothing,\n    !rightRemote.held && !rightRemote.hovered && !rightHand.held && !rightHand.hovered\n  );\n  userinput.toggleSet(\n    sets.rightHandHoveringOnPen,\n    !rightHand.held &&\n      rightHand.hovered &&\n      rightHand.hovered.components.tags &&\n      rightHand.hovered.components.tags.data.isPen\n  );\n  userinput.toggleSet(\n    sets.rightHandHoveringOnCamera,\n    !rightHand.held && rightHand.hovered && rightHand.hovered.components[\"camera-tool\"]\n  );\n  userinput.toggleSet(\n    sets.rightHandHoveringOnInteractable,\n    !rightHand.held &&\n      (rightHand.hovered &&\n        ((rightHand.hovered.components.tags && rightHand.hovered.components.tags.data.offersRemoteConstraint) ||\n          rightHand.hovered.components[\"super-spawner\"]))\n  );\n  userinput.toggleSet(\n    sets.rightHandHoveringOnVideo,\n    !rightHand.held && rightHand.hovered && rightHand.hovered.components[\"media-video\"]\n  );\n  userinput.toggleSet(\n    sets.rightHandHoldingPen,\n    rightHand.held && rightHand.held.components.tags && rightHand.held.components.tags.data.isPen\n  );\n  userinput.toggleSet(sets.rightHandHoldingCamera, rightHand.held && rightHand.held.components[\"camera-tool\"]);\n  userinput.toggleSet(sets.rightHandHoldingInteractable, rightHand.held);\n\n  userinput.toggleSet(\n    sets.cursorHoveringOnNothing,\n    !rightHand.held && !rightHand.hovered && !rightRemote.held && !rightRemote.hovered\n  );\n  userinput.toggleSet(\n    sets.cursorHoveringOnPen,\n    !rightHand.held &&\n      !rightHand.hovered &&\n      !rightRemote.held &&\n      rightRemote.hovered &&\n      rightRemote.hovered.components.tags &&\n      rightRemote.hovered.components.tags.data.isPen\n  );\n  userinput.toggleSet(\n    sets.cursorHoveringOnCamera,\n\n    !rightHand.held &&\n      !rightHand.hovered &&\n      !rightRemote.held &&\n      rightRemote.hovered &&\n      rightRemote.hovered.components[\"camera-tool\"]\n  );\n  userinput.toggleSet(\n    sets.cursorHoveringOnInteractable,\n    !rightHand.held &&\n      !rightHand.hovered &&\n      !rightRemote.held &&\n      rightRemote.hovered &&\n      ((rightRemote.hovered.components.tags && rightRemote.hovered.components.tags.data.offersRemoteConstraint) ||\n        rightRemote.hovered.components[\"super-spawner\"])\n  );\n  userinput.toggleSet(\n    sets.cursorHoveringOnUI,\n    !rightHand.held &&\n      !rightHand.hovered &&\n      !rightRemote.held &&\n      rightRemote.hovered &&\n      (rightRemote.hovered.components.tags &&\n        (rightRemote.hovered.components.tags.data.singleActionButton ||\n          rightRemote.hovered.components.tags.data.holdableButton))\n  );\n  userinput.toggleSet(\n    sets.cursorHoveringOnVideo,\n    !rightHand.held &&\n      !rightHand.hovered &&\n      !rightRemote.held &&\n      rightRemote.hovered &&\n      rightRemote.hovered.components[\"media-video\"]\n  );\n\n  userinput.toggleSet(sets.cursorHoldingNothing, !rightHand.held && !rightRemote.held);\n  userinput.toggleSet(\n    sets.cursorHoldingPen,\n\n    !rightHand.held &&\n      !rightHand.hovered &&\n      rightRemote.held &&\n      rightRemote.held.components.tags &&\n      rightRemote.held.components.tags.data.isPen\n  );\n  userinput.toggleSet(\n    sets.cursorHoldingCamera,\n    !rightHand.held && !rightHand.hovered && rightRemote.held && rightRemote.held.components[\"camera-tool\"]\n  );\n  userinput.toggleSet(\n    sets.cursorHoldingUI,\n    !rightHand.held &&\n      !rightHand.hovered &&\n      rightRemote.held &&\n      rightRemote.held.components.tags &&\n      rightRemote.held.components.tags.data.holdableButton\n  );\n  userinput.toggleSet(sets.cursorHoldingInteractable, rightRemote.held);\n\n  userinput.toggleSet(sets.leftHandTeleporting, leftTeleporter.isTeleporting);\n  userinput.toggleSet(sets.rightHandTeleporting, rightTeleporter.isTeleporting);\n\n  userinput.toggleSet(\n    sets.inputFocused,\n    document.activeElement.nodeName === \"INPUT\" ||\n      document.activeElement.nodeName === \"TEXTAREA\" ||\n      document.activeElement.contentEditable === \"true\"\n  );\n}\n","import { paths } from \"../paths\";\n\nexport class GamepadDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n  }\n\n  write(frame) {\n    if (this.gamepad.connected) {\n      this.gamepad.buttons.forEach((button, i) => {\n        const buttonPath = paths.device.gamepad(this.gamepad.index).button(i);\n        frame.setValueType(buttonPath.pressed, !!button.pressed);\n        frame.setValueType(buttonPath.touched, !!button.touched);\n        frame.setValueType(buttonPath.value, button.value);\n      });\n      this.gamepad.axes.forEach((axis, i) => {\n        frame.setValueType(paths.device.gamepad(this.gamepad.index).axis(i), axis);\n      });\n    }\n  }\n}\n","export const gamepadBindings = {};\n","import { sets } from \"./sets\";\nimport { paths } from \"./paths\";\n\nimport { MouseDevice } from \"./devices/mouse\";\nimport { KeyboardDevice } from \"./devices/keyboard\";\nimport { HudDevice } from \"./devices/hud\";\nimport { XboxControllerDevice } from \"./devices/xbox-controller\";\nimport { OculusGoControllerDevice } from \"./devices/oculus-go-controller\";\nimport { GearVRControllerDevice } from \"./devices/gear-vr-controller\";\nimport { OculusTouchControllerDevice } from \"./devices/oculus-touch-controller\";\nimport { DaydreamControllerDevice } from \"./devices/daydream-controller\";\nimport { ViveControllerDevice } from \"./devices/vive-controller\";\nimport { WindowsMixedRealityControllerDevice } from \"./devices/windows-mixed-reality-controller\";\nimport { GyroDevice } from \"./devices/gyro\";\n\nimport { AppAwareMouseDevice } from \"./devices/app-aware-mouse\";\nimport { AppAwareTouchscreenDevice } from \"./devices/app-aware-touchscreen\";\n\nimport { keyboardMouseUserBindings } from \"./bindings/keyboard-mouse-user\";\nimport { touchscreenUserBindings } from \"./bindings/touchscreen-user\";\nimport { keyboardDebuggingBindings } from \"./bindings/keyboard-debugging\";\nimport { oculusTouchUserBindings } from \"./bindings/oculus-touch-user\";\nimport { viveUserBindings, viveWandUserBindings } from \"./bindings/vive-user\";\nimport { wmrUserBindings } from \"./bindings/windows-mixed-reality-user\";\nimport { xboxControllerUserBindings } from \"./bindings/xbox-controller-user\";\nimport { daydreamUserBindings } from \"./bindings/daydream-user\";\nimport { cardboardUserBindings } from \"./bindings/cardboard-user\";\n\nimport generate3DOFTriggerBindings from \"./bindings/oculus-go-user\";\nconst oculusGoUserBindings = generate3DOFTriggerBindings(paths.device.oculusgo);\nconst gearVRControllerUserBindings = generate3DOFTriggerBindings(paths.device.gearVRController);\n\nimport { resolveActionSets } from \"./resolve-action-sets\";\nimport { GamepadDevice } from \"./devices/gamepad\";\nimport { gamepadBindings } from \"./bindings/generic-gamepad\";\nimport { getAvailableVREntryTypes, VR_DEVICE_AVAILABILITY } from \"../../utils/vr-caps-detect\";\nimport { ArrayBackedSet } from \"./array-backed-set\";\n\nfunction arrayContentsDiffer(a, b) {\n  if (a.length !== b.length) return true;\n\n  for (let i = 0, il = a.length; i < il; i++) {\n    const elem = a[i];\n    let found = false;\n\n    for (let j = 0, jl = b.length; j < jl; j++) {\n      if (elem === b[j]) {\n        found = true;\n        break;\n      }\n    }\n\n    if (!found) return true;\n  }\n\n  return false;\n}\n\nconst satisfiesPath = (binding, path) => {\n  for (const key in binding.dest) {\n    if (binding.dest[key].indexOf(path) !== -1) {\n      return true;\n    }\n  }\n  return false;\n};\n\nconst satisfyPath = (bindings, path) => {\n  for (const binding of bindings) {\n    if (satisfiesPath(binding, path)) {\n      return true;\n    }\n  }\n  return false;\n};\n\nconst satisfiedBy = (binding, bindings) => {\n  for (const path of Object.values(binding.src)) {\n    if (path.startsWith(\"/device/\")) continue;\n    if (!satisfyPath(bindings, path)) return false;\n  }\n  return true;\n};\n\nfunction dependencySort(mappings) {\n  const unsorted = [];\n  for (const mapping of mappings) {\n    for (const setName in mapping) {\n      for (const binding of mapping[setName]) {\n        unsorted.push(binding);\n      }\n    }\n  }\n\n  const sorted = [];\n  while (unsorted.length > 0) {\n    const binding = unsorted.shift();\n    if (satisfiedBy(binding, sorted)) {\n      sorted.push(binding);\n    } else {\n      unsorted.push(binding);\n    }\n  }\n\n  return sorted;\n}\n\nfunction canMask(masker, masked) {\n  if (masker.priority === undefined) {\n    masker.priority = 0;\n  }\n  if (masked.priority === undefined) {\n    masked.priority = 0;\n  }\n  if (masked.priority >= masker.priority) return false;\n  for (const maskerKey in masker.src) {\n    const maskerPath = masker.src[maskerKey];\n    for (const maskedKey in masked.src) {\n      const maskedPath = masked.src[maskedKey];\n      if (maskedPath.indexOf(maskerPath) !== -1) {\n        return true;\n      }\n    }\n  }\n  return false;\n}\n\nfunction computeMasks(bindings) {\n  const masks = new Array(bindings.length);\n  for (let row = 0; row < bindings.length; row++) {\n    const masksRow = (masks[row] = []);\n    const bindingsRow = bindings[row];\n    for (let col = 0; col < bindings.length; col++) {\n      if (canMask(bindings[col], bindingsRow)) {\n        masksRow.push(col);\n      }\n    }\n  }\n  return masks;\n}\n\nfunction isActive(binding, sets) {\n  for (let i = 0; i < binding.sets.length; i++) {\n    if (sets.includes(binding.sets[i])) {\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction computeExecutionStrategy(sortedBindings, masks, activeSets) {\n  const actives = new Array(sortedBindings.length);\n  for (let row = 0; row < sortedBindings.length; row++) {\n    actives[row] = isActive(sortedBindings[row], activeSets);\n  }\n\n  const masked = new Array(sortedBindings.length);\n  for (let row = 0; row < sortedBindings.length; row++) {\n    const maskedRow = (masked[row] = []);\n    const masksRow = masks[row];\n    for (let col = 0; col < sortedBindings.length; col++) {\n      if (actives[col] && masksRow.indexOf(col) !== -1) {\n        maskedRow.push(col);\n      }\n    }\n  }\n\n  return { actives, masked };\n}\n\nAFRAME.registerSystem(\"userinput\", {\n  get(path) {\n    if (!this.frame) return;\n    return this.frame.get(path);\n  },\n\n  toggleSet(set, value) {\n    this.pendingSetChanges.push(set);\n    this.pendingSetChanges.push(!!value);\n  },\n\n  init() {\n    this.frame = {\n      generation: 0,\n      values: {},\n      generations: {},\n      get: function(path) {\n        if (this.generations[path] !== this.generation) return undefined;\n        return this.values[path];\n      },\n      setValueType: function(path, value) {\n        this.values[path] = value;\n        this.generations[path] = this.generation;\n      },\n      setVector2: function(path, a, b) {\n        const value = this.values[path] || [];\n        value[0] = a;\n        value[1] = b;\n        this.values[path] = value;\n        this.generations[path] = this.generation;\n      },\n      setPose: function(path, pose) {\n        this.setValueType(path, pose);\n      },\n      setMatrix4: function(path, mat4) {\n        // Should we assume the incoming mat4 is safe to store instead of copying values?\n        const value = this.values[path] || new THREE.Matrix4();\n        value.copy(mat4);\n        this.values[path] = value;\n        this.generations[path] = this.generation;\n      }\n    };\n\n    this.prevActiveSets = [];\n    this.activeSets = [sets.global];\n    this.pendingSetChanges = [];\n    this.xformStates = new Map();\n    this.activeDevices = new ArrayBackedSet([new HudDevice()]);\n\n    const isMobile = AFRAME.utils.device.isMobile();\n    const isMobileVR = AFRAME.utils.device.isMobileVR();\n\n    if (!(isMobile || isMobileVR)) {\n      this.activeDevices.add(new MouseDevice());\n      this.activeDevices.add(new AppAwareMouseDevice());\n      this.activeDevices.add(new KeyboardDevice());\n    } else if (!isMobileVR) {\n      this.activeDevices.add(new AppAwareTouchscreenDevice());\n      this.activeDevices.add(new KeyboardDevice());\n      this.activeDevices.add(new GyroDevice());\n    }\n\n    this.isMobile = isMobile;\n    this.isMobileVR = isMobileVR;\n\n    this.registeredMappings = new Set([keyboardDebuggingBindings]);\n    this.registeredMappingsChanged = true;\n\n    const vrGamepadMappings = new Map();\n    vrGamepadMappings.set(WindowsMixedRealityControllerDevice, wmrUserBindings);\n    vrGamepadMappings.set(ViveControllerDevice, viveUserBindings);\n    vrGamepadMappings.set(OculusTouchControllerDevice, oculusTouchUserBindings);\n    vrGamepadMappings.set(OculusGoControllerDevice, oculusGoUserBindings);\n    vrGamepadMappings.set(GearVRControllerDevice, gearVRControllerUserBindings);\n    vrGamepadMappings.set(DaydreamControllerDevice, daydreamUserBindings);\n\n    const nonVRGamepadMappings = new Map();\n    nonVRGamepadMappings.set(XboxControllerDevice, xboxControllerUserBindings);\n    nonVRGamepadMappings.set(GamepadDevice, gamepadBindings);\n\n    const updateBindingsForVRMode = () => {\n      const inVRMode = this.el.sceneEl.is(\"vr-mode\");\n      const isMobile = AFRAME.utils.device.isMobile();\n\n      if (inVRMode) {\n        console.log(\"Using VR bindings.\");\n        this.registeredMappings.delete(isMobile ? touchscreenUserBindings : keyboardMouseUserBindings);\n        // add mappings for all active VR input devices\n        for (let i = 0; i < this.activeDevices.items.length; i++) {\n          const activeDevice = this.activeDevices.items[i];\n          const mapping = vrGamepadMappings.get(activeDevice.constructor);\n          mapping && this.registeredMappings.add(mapping);\n          if (activeDevice instanceof ViveControllerDevice && activeDevice.isViveWand) {\n            this.registeredMappings.add(viveWandUserBindings);\n          }\n        }\n\n        // Handle cardboard by looking of VR device caps\n        if (isMobile) {\n          getAvailableVREntryTypes().then(availableVREntryTypes => {\n            if (availableVREntryTypes.cardboard === VR_DEVICE_AVAILABILITY.yes) {\n              this.registeredMappings.add(cardboardUserBindings);\n              this.registeredMappingsChanged = true;\n            }\n          });\n        }\n      } else {\n        console.log(\"Using Non-VR bindings.\");\n        // remove mappings for all active VR input devices\n        for (let i = 0; i < this.activeDevices.items.length; i++) {\n          const activeDevice = this.activeDevices.items[i];\n          this.registeredMappings.delete(vrGamepadMappings.get(activeDevice.constructor));\n        }\n        this.registeredMappings.add(isMobile ? touchscreenUserBindings : keyboardMouseUserBindings);\n      }\n\n      for (let i = 0; i < this.activeDevices.items.length; i++) {\n        const activeDevice = this.activeDevices.items[i];\n        const mapping = nonVRGamepadMappings.get(activeDevice.constructor);\n        mapping && this.registeredMappings.add(mapping);\n      }\n\n      this.registeredMappingsChanged = true;\n    };\n\n    const gamepadConnected = e => {\n      let gamepadDevice;\n      for (let i = 0; i < this.activeDevices.items.length; i++) {\n        const activeDevice = this.activeDevices.items[i];\n        if (activeDevice.gamepad && activeDevice.gamepad.index === e.gamepad.index) {\n          console.warn(\"connected already fired for gamepad\", e.gamepad);\n          return; // multiple connect events without a disconnect event\n        }\n      }\n      // HACK Firefox Nightly bug causes corrupt gamepad names for OpenVR, so do startsWith\n      if (e.gamepad.id.startsWith(\"OpenVR Gamepad\") || e.gamepad.id === \"HTC Vive Focus Plus Controller\") {\n        gamepadDevice = new ViveControllerDevice(e.gamepad);\n      } else if (e.gamepad.id.startsWith(\"Oculus Touch\")) {\n        gamepadDevice = new OculusTouchControllerDevice(e.gamepad);\n      } else if (e.gamepad.id.startsWith(\"Spatial Controller\")) {\n        gamepadDevice = new WindowsMixedRealityControllerDevice(e.gamepad);\n      } else if (e.gamepad.id === \"Oculus Go Controller\") {\n        gamepadDevice = new OculusGoControllerDevice(e.gamepad);\n      } else if (e.gamepad.id === \"Gear VR Controller\" || e.gamepad.id === \"HTC Vive Focus Controller\") {\n        gamepadDevice = new GearVRControllerDevice(e.gamepad);\n      } else if (e.gamepad.id === \"Daydream Controller\") {\n        gamepadDevice = new DaydreamControllerDevice(e.gamepad);\n      } else if (e.gamepad.mapping === \"standard\") {\n        // Our XboxController device and bindings should be generic enough for most gamepads.\n        gamepadDevice = new XboxControllerDevice(e.gamepad);\n      } else {\n        // This device doesn't actually have any bindings, but we need to fallback to something.\n        gamepadDevice = new GamepadDevice(e.gamepad);\n      }\n\n      this.activeDevices.add(gamepadDevice);\n\n      updateBindingsForVRMode();\n    };\n\n    const gamepadDisconnected = e => {\n      for (let i = 0; i < this.activeDevices.items.length; i++) {\n        const device = this.activeDevices.items[i];\n        if (device.gamepad && device.gamepad.index === e.gamepad.index) {\n          this.registeredMappings.delete(\n            vrGamepadMappings.get(device.constructor) || nonVRGamepadMappings.get(device.constructor)\n          );\n          this.activeDevices.delete(device);\n          return;\n        }\n      }\n\n      updateBindingsForVRMode();\n    };\n\n    window.addEventListener(\"gamepadconnected\", gamepadConnected, false);\n    window.addEventListener(\"gamepaddisconnected\", gamepadDisconnected, false);\n    for (const gamepad of navigator.getGamepads()) {\n      gamepad && gamepadConnected({ gamepad });\n    }\n\n    this.el.sceneEl.addEventListener(\"enter-vr\", updateBindingsForVRMode);\n    this.el.sceneEl.addEventListener(\"exit-vr\", updateBindingsForVRMode);\n\n    updateBindingsForVRMode();\n  },\n\n  maybeToggleXboxMapping() {\n    if (this.isMobile || this.isMobileVR) return;\n\n    const vrAxesSum =\n      (this.get(paths.device.vive.left.axesSum) || 0) +\n      (this.get(paths.device.vive.right.axesSum) || 0) +\n      (this.get(paths.device.leftOculusTouch.axesSum) || 0) +\n      (this.get(paths.device.rightOculusTouch.axesSum) || 0);\n    const mouseMovement = this.get(paths.device.mouse.movementXY);\n    const nonXboxActivity = (mouseMovement[0] || mouseMovement[1]) > 2 || vrAxesSum > 0.5;\n\n    const hasXboxMapping = this.registeredMappings.has(xboxControllerUserBindings);\n\n    if (nonXboxActivity && hasXboxMapping) {\n      this.registeredMappings.delete(xboxControllerUserBindings);\n      this.registeredMappingsChanged = true;\n    } else if (this.get(paths.device.xbox.axesSum) > 0.5 && !hasXboxMapping) {\n      this.registeredMappings.add(xboxControllerUserBindings);\n      this.registeredMappingsChanged = true;\n    }\n  },\n\n  tick2() {\n    this.frame.generation += 1;\n    const registeredMappingsChanged = this.registeredMappingsChanged;\n    if (registeredMappingsChanged) {\n      this.registeredMappingsChanged = false;\n      this.prevSortedBindings = this.sortedBindings;\n      this.sortedBindings = dependencySort(this.registeredMappings);\n      if (!this.prevSortedBindings) {\n        this.prevSortedBindings = this.sortedBindings;\n      }\n      this.masks = computeMasks(this.sortedBindings);\n    }\n\n    this.prevActiveSets.length = 0;\n    for (let i = 0; i < this.activeSets.length; i++) {\n      const item = this.activeSets[i];\n      this.prevActiveSets.push(item);\n    }\n    resolveActionSets();\n    for (let i = 0, l = this.pendingSetChanges.length; i < l; i += 2) {\n      const set = this.pendingSetChanges[i];\n      const value = this.pendingSetChanges[i + 1];\n\n      if (value) {\n        if (!this.activeSets.includes(set)) {\n          this.activeSets.push(set);\n        }\n      } else {\n        const idx = this.activeSets.indexOf(set);\n\n        if (idx > -1) {\n          this.activeSets.splice(idx, 1);\n        }\n      }\n    }\n    const activeSetsChanged = arrayContentsDiffer(this.prevActiveSets, this.activeSets);\n    this.pendingSetChanges.length = 0;\n    if (registeredMappingsChanged || activeSetsChanged || (!this.actives && !this.masked)) {\n      this.prevActives = this.actives;\n      this.prevMasked = this.masked;\n      const { actives, masked } = computeExecutionStrategy(this.sortedBindings, this.masks, this.activeSets);\n      this.actives = actives;\n      this.masked = masked;\n    }\n\n    for (let i = 0; i < this.activeDevices.items.length; i++) {\n      this.activeDevices.items[i].write(this.frame);\n    }\n\n    for (let i = 0; i < this.sortedBindings.length; i++) {\n      if (!this.actives[i] || this.masked[i].length > 0) continue;\n\n      const binding = this.sortedBindings[i];\n\n      let bindingExistedLastFrame = true;\n      if (!registeredMappingsChanged && activeSetsChanged && this.prevSortedBindings) {\n        const j = this.prevSortedBindings.indexOf(binding);\n        bindingExistedLastFrame = j > -1 && this.prevActives[j] && this.prevMasked[j].length === 0;\n      }\n      if (!bindingExistedLastFrame) {\n        this.xformStates.delete(binding);\n      }\n\n      const { src, dest, xform, debug } = binding;\n\n      let oldValue;\n\n      if (debug) {\n        oldValue = this.frame.get(dest.value);\n      }\n\n      const newState = xform(this.frame, src, dest, this.xformStates.get(binding));\n\n      if (debug) {\n        // Note for now this only works with bindings that have { value: } sources and dests\n        console.log(\n          `${JSON.stringify(src.value)} (${src.value && JSON.stringify(this.frame.get(src.value))}) to ${JSON.stringify(\n            dest\n          )}: ${oldValue} -> ${this.frame.get(dest.value)}`\n        );\n      }\n\n      if (newState !== undefined) {\n        this.xformStates.set(binding, newState);\n      }\n    }\n\n    this.prevSortedBindings = this.sortedBindings;\n\n    this.maybeToggleXboxMapping();\n  }\n});\n","import { paths } from \"./paths\";\nimport qsTruthy from \"../../utils/qs_truthy\";\n\nconst PATHS_TO_SHOW = [\"/actions/\", \"/device/\"];\n\nAFRAME.registerSystem(\"userinput-debug\", {\n  active: true,\n\n  tick() {\n    if (!this.active) return;\n\n    const userinput = AFRAME.scenes[0].systems.userinput;\n\n    if (this.userinputFrameStatus) {\n      const replacer = (k, v) => {\n        if (typeof v === \"number\") {\n          return `${v >= 0 ? \"+\" : \"\"}${v.toFixed(3)}`;\n        }\n        return v;\n      };\n      const pathsOutput = [];\n      const { frame } = userinput;\n      for (const key in frame.values) {\n        if (!frame.get(key)) continue;\n        if (!PATHS_TO_SHOW.some(x => key.startsWith(x))) continue;\n        let val = JSON.stringify(frame.get(key), replacer);\n        if (val) val = val.replace(/{\"(\\w{3,})\":/g, '{\\n  \"$1\":').replace(/,\"(\\w{3,})\":/g, ',\\n  \"$1\":');\n        pathsOutput.push(`${key} -> ${val}`);\n      }\n      this.userinputFrameStatus.textContent = pathsOutput.join(\"\\n\");\n    }\n\n    if (userinput.get(paths.actions.logDebugFrame)) {\n      if (qsTruthy(\"userinput_debug\") && !this.userinputFrameStatus) {\n        this.userinputFrameStatus = document.createElement(\"div\");\n        this.userinputFrameStatus.id = \"userinput-frame-status\";\n        this.userinputFrameStatus.style = `\n          position: absolute;\n          z-index: 2;\n          left: 0; bottom: 0;\n          background: white;\n          white-space: pre;\n          font-family: monospace;\n          font-size: 8pt;\n        `;\n        document.body.append(this.userinputFrameStatus);\n      }\n\n      console.log(userinput);\n      console.log(\"sorted\", userinput.sortedBindings);\n      console.log(\"actives\", userinput.actives);\n      console.log(\"masks\", userinput.masks);\n      console.log(\"masked\", userinput.masked);\n      console.log(\"devices\", userinput.activeDevices);\n      console.log(\"activeSets\", userinput.activeSets);\n      console.log(\"frame\", userinput.frame);\n      console.log(\"xformStates\", userinput.xformStates);\n      const { sortedBindings, actives, masked } = userinput;\n      for (const i in sortedBindings) {\n        const sb = [];\n        if (masked[i].length > 0) {\n          for (const j of masked[i]) {\n            sb.push(JSON.stringify(sortedBindings[j]));\n          }\n        }\n\n        if (this.logBindings) {\n          console.log(\n            \"binding: \",\n            i,\n            \"\\n\",\n            sortedBindings[i],\n            \"\\n\",\n            \"dest: \",\n            sortedBindings[i].dest && Object.values(sortedBindings[i].dest),\n            \"\\n\",\n            \"active: \",\n            actives[i],\n            \"\\n\",\n            \"maskedBy: \",\n            masked[i],\n            \"\\n\",\n            sb.join(\"\\n\"),\n            \"\\n\"\n          );\n        }\n      }\n    }\n  }\n});\n","import { paths } from \"./userinput/paths\";\nimport { SOURCES } from \"../storage/media-search-store\";\n\nconst MEDIA_SEARCH_PATHS = [\n  paths.actions.mediaSearch1,\n  paths.actions.mediaSearch2,\n  paths.actions.mediaSearch3,\n  paths.actions.mediaSearch4,\n  paths.actions.mediaSearch5,\n  paths.actions.mediaSearch6,\n  paths.actions.mediaSearch7,\n  paths.actions.mediaSearch8\n];\n\n// Every frame, looks for input paths that trigger UI-relevant events and handles them.\nAFRAME.registerSystem(\"ui-hotkeys\", {\n  init() {\n    this.mediaSearchStore = window.APP.mediaSearchStore;\n  },\n\n  tick: function() {\n    if (!this.userinput) {\n      this.userinput = this.el.systems.userinput;\n    }\n\n    if (this.userinput.get(paths.actions.focusChat)) {\n      this.focusChat();\n    }\n\n    if (this.userinput.get(paths.actions.focusChatCommand)) {\n      this.focusChat(\"/\");\n    }\n\n    if (this.userinput.get(paths.actions.mediaExit)) {\n      if (window.APP.history.location.state && window.APP.history.location.state.value !== \"avatar-editor\") {\n        this.mediaSearchStore.pushExitMediaBrowserHistory();\n      }\n\n      this.el.emit(\"action_exit_watch\");\n    }\n\n    for (let i = 0; i < MEDIA_SEARCH_PATHS.length; i++) {\n      if (this.userinput.get(MEDIA_SEARCH_PATHS[i]) && window.APP.hubChannel.can(\"spawn_and_move_media\")) {\n        this.mediaSearchStore.sourceNavigate(SOURCES[i]);\n      }\n    }\n\n    if (this.userinput.get(paths.actions.toggleCamera)) {\n      this.el.emit(\"action_toggle_camera\");\n    }\n  },\n\n  focusChat: function(prefix) {\n    const target = document.querySelector(\".chat-focus-target\");\n    if (!target) return;\n\n    target.focus();\n\n    if (prefix) {\n      target.value = prefix;\n    }\n  }\n});\n","import { waitForDOMContentLoaded } from \"../utils/async-utils\";\n\nexport class CursorTargettingSystem {\n  constructor() {\n    this.targets = [];\n    this.setDirty = this.setDirty.bind(this);\n    this.dirty = true;\n\n    // TODO: Use the MutationRecords passed into the callback function to determine added/removed nodes!\n    this.observer = new MutationObserver(this.setDirty);\n\n    waitForDOMContentLoaded().then(() => {\n      const scene = document.querySelector(\"a-scene\");\n      this.rightRemote = document.querySelector(\"#cursor-controller\");\n      this.observer.observe(scene, { childList: true, attributes: true, subtree: true });\n      scene.addEventListener(\"object3dset\", this.setDirty);\n      scene.addEventListener(\"object3dremove\", this.setDirty);\n    });\n  }\n\n  setDirty() {\n    this.dirty = true;\n  }\n\n  tick(t) {\n    if (this.dirty) {\n      this.populateEntities(this.targets);\n      this.dirty = false;\n    }\n\n    this.rightRemote.components[\"cursor-controller\"].tick2(t);\n  }\n\n  populateEntities(targets) {\n    targets.length = 0;\n    // TODO: Do not querySelectorAll on the entire scene every time anything changes!\n    const els = AFRAME.scenes[0].querySelectorAll(\".collidable, .interactable, .ui\");\n    for (let i = 0; i < els.length; i++) {\n      if (els[i].object3D) {\n        targets.push(els[i].object3D);\n      }\n    }\n  }\n\n  remove() {\n    this.observer.disconnect();\n    AFRAME.scenes[0].removeEventListener(\"object3dset\", this.setDirty);\n    AFRAME.scenes[0].removeEventListener(\"object3dremove\", this.setDirty);\n  }\n}\n","/* global NAF AFRAME */\nconst ACTIVATION_STATE = require(\"aframe-physics-system/src/constants\").ACTIVATION_STATE;\n\nexport class ConstraintsSystem {\n  constructor() {\n    this.prevLeftHand = {\n      held: null,\n      hovered: null,\n      spawning: null\n    };\n    this.prevRightHand = {\n      held: null,\n      hovered: null,\n      spawning: null\n    };\n    this.prevRightRemote = {\n      held: null,\n      hovered: null,\n      spawning: null\n    };\n  }\n\n  tickInteractor(constraintTag, entityId, state, prevState) {\n    if (prevState.held === state.held) {\n      if (!state.spawning && prevState.spawning && state.held && state.held.components.tags.data[constraintTag]) {\n        state.held.setAttribute(\"ammo-body\", {\n          type: \"dynamic\",\n          activationState: ACTIVATION_STATE.DISABLE_DEACTIVATION\n        });\n        state.held.setAttribute(\"ammo-constraint__\" + entityId, { target: \"#\" + entityId });\n      }\n      return;\n    }\n    if (prevState.held && prevState.held.components.tags.data[constraintTag]) {\n      prevState.held.removeAttribute(\"ammo-constraint__\" + entityId);\n      let hasAnotherConstraint = false;\n      for (const componentName in prevState.held.components) {\n        if (componentName.startsWith(\"ammo-constraint\")) {\n          hasAnotherConstraint = true;\n        }\n      }\n      if (!hasAnotherConstraint) {\n        prevState.held.setAttribute(\"ammo-body\", { activationState: ACTIVATION_STATE.ACTIVE_TAG });\n      }\n    }\n    if (!state.spawning && state.held && state.held.components.tags.data[constraintTag]) {\n      if (!state.held.components[\"networked\"] || NAF.utils.isMine(state.held) || NAF.utils.takeOwnership(state.held)) {\n        state.held.setAttribute(\"ammo-body\", {\n          type: \"dynamic\",\n          activationState: ACTIVATION_STATE.DISABLE_DEACTIVATION\n        });\n        state.held.setAttribute(\"ammo-constraint__\" + entityId, { target: \"#\" + entityId });\n      } else {\n        console.log(\"Failed to obtain ownership while trying to create constraint on networked object.\");\n      }\n    }\n  }\n\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n\n    this.tickInteractor(\n      \"offersHandConstraint\",\n      interaction.options.leftHand.entity.id,\n      interaction.state.leftHand,\n      this.prevLeftHand\n    );\n    this.tickInteractor(\n      \"offersHandConstraint\",\n      interaction.options.rightHand.entity.id,\n      interaction.state.rightHand,\n      this.prevRightHand\n    );\n    this.tickInteractor(\n      \"offersRemoteConstraint\",\n      interaction.options.rightRemote.entity.id,\n      interaction.state.rightRemote,\n      this.prevRightRemote\n    );\n\n    Object.assign(this.prevLeftHand, interaction.state.leftHand);\n    Object.assign(this.prevRightHand, interaction.state.rightHand);\n    Object.assign(this.prevRightRemote, interaction.state.rightRemote);\n  }\n}\n","/* global THREE AFRAME */\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\nconst COLLISION_FILTER_MASK_HANDS = { collisionFilterMask: COLLISION_LAYERS.HANDS };\nexport const distanceBetweenStretchers = (() => {\n  const a = new THREE.Vector3();\n  const b = new THREE.Vector3();\n  return function distanceBetweenStretchers(obj1, obj2) {\n    obj1.getWorldPosition(a);\n    obj2.getWorldPosition(b);\n    return a.distanceTo(b);\n  };\n})();\n\nexport class TwoPointStretchingSystem {\n  constructor() {\n    this.initialScale = new THREE.Vector3();\n  }\n\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const { leftHand, rightHand, rightRemote } = interaction.state;\n\n    const stretching = leftHand.held && (leftHand.held === rightHand.held || leftHand.held === rightRemote.held);\n    let leftStretcher, rightStretcher;\n    if (stretching) {\n      leftStretcher = interaction.options.leftHand.entity.object3D;\n      rightStretcher =\n        leftHand.held === rightHand.held\n          ? interaction.options.rightHand.entity.object3D\n          : interaction.options.rightRemote.entity.object3D;\n      if (\n        leftStretcher !== this.previousLeftStretcher ||\n        rightStretcher !== this.previousRightStretcher ||\n        leftHand.held !== this.stretched\n      ) {\n        this.initialStretchDistance = distanceBetweenStretchers(leftStretcher, rightStretcher);\n        this.stretched = leftHand.held;\n        this.initialScale.copy(this.stretched.object3D.scale);\n        if (this.stretched.components[\"ammo-body\"]) {\n          this.stretched.setAttribute(\"ammo-body\", COLLISION_FILTER_MASK_HANDS);\n        }\n      }\n\n      this.stretched.object3D.scale\n        .copy(this.initialScale)\n        .multiplyScalar(distanceBetweenStretchers(leftStretcher, rightStretcher) / this.initialStretchDistance);\n      this.stretched.object3D.matrixNeedsUpdate = true;\n    }\n\n    this.previousLeftStretcher = leftStretcher;\n    this.previousRightStretcher = rightStretcher;\n  }\n}\n","export class SingleActionButtonSystem {\n  tick() {\n    this.didInteractThisFrame = false;\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const hovered = interaction.state.rightRemote.hovered;\n    if (\n      hovered &&\n      userinput.get(interaction.options.rightRemote.grabPath) &&\n      hovered.components.tags &&\n      hovered.components.tags.data.singleActionButton\n    ) {\n      this.didInteractThisFrame = true;\n      hovered.object3D.dispatchEvent({\n        type: \"interact\",\n        object3D: interaction.options.rightRemote.entity.object3D\n      });\n    }\n  }\n}\n\nexport class HoldableButtonSystem {\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const held = interaction.state.rightRemote.held;\n\n    if (this.prevHeld && this.prevHeld !== held) {\n      this.prevHeld.object3D.dispatchEvent({\n        type: \"holdable-button-up\",\n        object3D: interaction.options.rightRemote.entity.object3D\n      });\n    }\n    if (held && this.prevHeld !== held) {\n      held.object3D.dispatchEvent({\n        type: \"holdable-button-down\",\n        object3D: interaction.options.rightRemote.entity.object3D\n      });\n    }\n\n    this.prevHeld = held;\n  }\n}\n\nconst hasButtonComponent = (function() {\n  const BUTTON_COMPONENT_NAMES = [\"icon-button\", \"text-button\", \"pin-networked-object-button\", \"mic-button\"];\n  return function hasButtonComponent(components) {\n    for (let i = 0; i < BUTTON_COMPONENT_NAMES.length; i++) {\n      if (components[BUTTON_COMPONENT_NAMES[i]]) {\n        return true;\n      }\n    }\n    return false;\n  };\n})();\n\nfunction getHoverableButton(hovered) {\n  if (!hovered) return null;\n  if (hasButtonComponent(hovered.components)) return hovered;\n  if (hovered.children) {\n    // TODO: not sure if looping thru children here is desireable, but we did this to accomodate the rounded-button mixins\n    for (let i = 0; i < hovered.children.length; i++) {\n      if (hasButtonComponent(hovered.children[i].components)) {\n        return hovered.children[i];\n      }\n    }\n  }\n  return null;\n}\n\nfunction dispatch(el, event) {\n  el.object3D.dispatchEvent(event);\n  if (el.children) {\n    for (let i = 0; i < el.children.length; i++) {\n      if (hasButtonComponent(el.children[i].components)) {\n        el.children[i].object3D.dispatchEvent(event);\n      }\n    }\n  }\n}\n\nconst HOVERED = { type: \"hovered\" };\nconst UNHOVERED = { type: \"unhovered\" };\nexport class HoverButtonSystem {\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const button = getHoverableButton(interaction.state.rightRemote.hovered);\n\n    if (this.prevButton && this.prevButton !== button) {\n      dispatch(this.prevButton, UNHOVERED);\n    }\n\n    if (button && this.prevButton !== button) {\n      dispatch(button, HOVERED);\n    }\n\n    this.prevButton = button;\n  }\n}\n","function getSpecificHoverMenu(el) {\n  return (\n    el.components[\"hover-menu\"] ||\n    el.components[\"hover-menu__video\"] ||\n    el.components[\"hover-menu__hubs-item\"] ||\n    el.components[\"hover-menu__link\"] ||\n    el.components[\"hover-menu__photo\"]\n  );\n}\n\nfunction findHoverMenu(hovered) {\n  if (!hovered) return null;\n  const hoverMenu = getSpecificHoverMenu(hovered);\n  if (hoverMenu) {\n    return hoverMenu;\n  }\n  if (!(hovered.components.tags && hovered.components.tags.data.isHoverMenuChild)) {\n    return null;\n  }\n  let el = hovered.parentNode;\n  while (!getSpecificHoverMenu(el)) {\n    el = el.parentNode;\n  }\n  return getSpecificHoverMenu(el);\n}\n\nexport class HoverMenuSystem {\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const hoverMenu = findHoverMenu(interaction.state.rightRemote.hovered);\n\n    if (this.prevHoverMenu && this.prevHoverMenu !== hoverMenu) {\n      this.prevHoverMenu.hovering = false;\n      this.prevHoverMenu.applyHoverState();\n    }\n\n    if (hoverMenu && this.prevHoverMenu !== hoverMenu) {\n      hoverMenu.hovering = true;\n      hoverMenu.applyHoverState();\n    }\n\n    this.prevHoverMenu = hoverMenu;\n  }\n}\n","import { addMedia } from \"../utils/media-utils\";\nimport { ObjectContentOrigins } from \"../object-types\";\n\n// WARNING: This system mutates interaction system state!\nexport class SuperSpawnerSystem {\n  maybeSpawn(state, entity, grabPath) {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const superSpawner = state.hovered && state.hovered.components[\"super-spawner\"];\n    if (\n      superSpawner &&\n      !superSpawner.cooldownTimeout &&\n      userinput.get(grabPath) &&\n      window.APP.hubChannel.can(\"spawn_and_move_media\")\n    ) {\n      this.performSpawn(state, entity, grabPath, userinput, superSpawner);\n    }\n  }\n\n  performSpawn(state, entity, grabPath, userinput, superSpawner) {\n    entity.object3D.updateMatrices();\n    entity.object3D.matrix.decompose(entity.object3D.position, entity.object3D.quaternion, entity.object3D.scale);\n    const data = superSpawner.data;\n    const spawnedEntity = addMedia(\n      data.src,\n      data.template,\n      ObjectContentOrigins.SPAWNER,\n      null,\n      data.resolve,\n      data.resize,\n      false\n    ).entity;\n    spawnedEntity.object3D.position.copy(\n      data.useCustomSpawnPosition ? data.spawnPosition : superSpawner.el.object3D.position\n    );\n    spawnedEntity.object3D.rotation.copy(\n      data.useCustomSpawnRotation ? data.spawnRotation : superSpawner.el.object3D.rotation\n    );\n    spawnedEntity.object3D.scale.copy(data.useCustomSpawnScale ? data.spawnScale : superSpawner.el.object3D.scale);\n    spawnedEntity.object3D.matrixNeedsUpdate = true;\n    state.held = spawnedEntity;\n\n    superSpawner.activateCooldown();\n    state.spawning = true;\n    // WARNING: previously used waitForEvent which is semantically different than\n    // entity.addEventListener(\"body-loaded\", ...) and adding a callback fn via\n    // addEventListener will not work unless the callback function wraps its code in setTimeout(()=>{...}, 0)\n    spawnedEntity.addEventListener(\n      \"body-loaded\",\n      () => {\n        setTimeout(() => {\n          state.spawning = false;\n          spawnedEntity.object3D.position.copy(\n            data.useCustomSpawnPosition ? data.spawnPosition : superSpawner.el.object3D.position\n          );\n          if (data.centerSpawnedObject) {\n            spawnedEntity.body.position.copy(entity.object3D.position);\n          }\n          spawnedEntity.object3D.matrixNeedsUpdate = true;\n        });\n      },\n      { once: true }\n    );\n  }\n\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    this.maybeSpawn(\n      interaction.state.leftHand,\n      interaction.options.leftHand.entity,\n      interaction.options.leftHand.grabPath\n    );\n    this.maybeSpawn(\n      interaction.state.rightHand,\n      interaction.options.rightHand.entity,\n      interaction.options.rightHand.grabPath\n    );\n    this.maybeSpawn(\n      interaction.state.rightRemote,\n      interaction.options.rightRemote.entity,\n      interaction.options.rightRemote.grabPath\n    );\n  }\n}\n","import { paths } from \"./userinput/paths\";\nimport { distanceBetweenStretchers } from \"./two-point-stretching-system\";\n\nfunction copyState(previous, current, isTeleporting) {\n  previous.held = current.held;\n  previous.hovered = current.hovered;\n  previous.isTeleporting = isTeleporting;\n}\n\n// TODO: These strengths should be written into bindings, since vibration strength varies across devices.\nconst STRENGTH = {\n  DROP: 0.1,\n  PICKUP: 0.2,\n  BUTTON_PRESSED: 0.2,\n  HOVER: 0.08,\n  STRETCH_BASE: 0.05,\n  STRETCH_DISTANCE: 0.2,\n  TELEPORTING: 0.08,\n  TELEPORTED: 0.2\n};\n\nfunction determineStrength(previous, current, isTeleporting) {\n  if (previous.held && !current.held) {\n    return STRENGTH.DROP;\n  } else if (!previous.held && current.held) {\n    return STRENGTH.PICKUP;\n  } else if (!previous.hovered && current.hovered) {\n    return STRENGTH.HOVER;\n  } else if (isTeleporting) {\n    return STRENGTH.TELEPORTING;\n  } else if (previous.isTeleporting && !isTeleporting) {\n    return STRENGTH.TELEPORTED;\n  } else {\n    return 0;\n  }\n}\n\nfunction determineStretchStrength(stretchSystem) {\n  if (!stretchSystem.stretcherLeft || !stretchSystem.stretcherRight) {\n    return 0;\n  }\n\n  return THREE.Math.clamp(\n    STRENGTH.STRETCH_BASE +\n      STRENGTH.STRETCH_DISTANCE *\n        Math.abs(\n          distanceBetweenStretchers(stretchSystem.stretcherLeft, stretchSystem.stretcherRight) -\n            stretchSystem.initialStretchDistance\n        ),\n    0,\n    0.5\n  );\n}\n\nexport class HapticFeedbackSystem {\n  constructor() {\n    this.state = {\n      rightHand: {\n        held: null,\n        hovered: null,\n        isTeleporting: false\n      },\n      rightRemote: {\n        held: null,\n        hovered: null,\n        isTeleporting: false\n      },\n      leftHand: {\n        held: null,\n        hovered: null,\n        isTeleporting: false\n      }\n    };\n  }\n\n  tick(twoPointStretchingSystem, didClickButton) {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const leftActuator = userinput.get(paths.haptics.actuators.left);\n    const rightActuator = userinput.get(paths.haptics.actuators.right);\n    if (!leftActuator && !rightActuator) {\n      return;\n    }\n\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const { leftHand, rightHand, rightRemote } = interaction.state;\n    this.leftTeleporter =\n      this.leftTeleporter || document.querySelector(\"#player-left-controller\").components.teleporter;\n    this.rightTeleporter =\n      this.rightTeleporter || document.querySelector(\"#player-right-controller\").components.teleporter;\n\n    const leftHandStrength = determineStrength(this.state.leftHand, leftHand, this.leftTeleporter.isTeleporting);\n    const rightHandStrength = determineStrength(this.state.rightHand, rightHand, this.rightTeleporter.isTeleporting);\n    const rightRemoteStrength = determineStrength(this.state.rightRemote, rightRemote, false);\n    const buttonPressedStrength = didClickButton ? STRENGTH.BUTTON_PRESSED : 0;\n    const stretchingStrength = determineStretchStrength(twoPointStretchingSystem);\n\n    const leftStrength = Math.max(leftHandStrength, stretchingStrength);\n    const rightStrength = Math.max(rightHandStrength, rightRemoteStrength, stretchingStrength, buttonPressedStrength);\n\n    if (leftStrength && leftActuator) {\n      leftActuator.pulse(leftStrength, 15);\n    }\n\n    if (rightStrength && rightActuator) {\n      rightActuator.pulse(rightStrength, 15);\n    }\n\n    copyState(this.state.rightHand, rightHand, this.rightTeleporter.isTeleporting);\n    copyState(this.state.leftHand, leftHand, this.leftTeleporter.isTeleporting);\n    copyState(this.state.rightRemote, rightRemote, false);\n  }\n}\n","import { BatchRawUniformGroup } from \"@mozillareality/three-batch-manager\";\n\nconst tempVec3 = new Array(3);\nconst tempVec4 = new Array(4);\n\nexport const INSTANCE_DATA_BYTE_LENGTH = 112;\nconst DEFAULT_COLOR = new THREE.Color(1, 1, 1);\nconst HIDE_MATRIX = new THREE.Matrix4().makeScale(0, 0, 0);\n\nexport function sizeofInstances(instanceCount) {\n  const hubsDataSize =\n    instanceCount * 4 * 4 + // sweepParams\n    4 *\n      (3 + // interactorOnePos\n      1 + // isFrozen\n      3 + // interactorTwoPos\n        1); // time\n  return instanceCount * INSTANCE_DATA_BYTE_LENGTH + hubsDataSize;\n}\n\nexport default class HubsBatchRawUniformGroup extends BatchRawUniformGroup {\n  constructor(maxInstances, meshToEl) {\n    const data = new ArrayBuffer(sizeofInstances(maxInstances));\n    super(maxInstances, \"InstanceData\", data);\n\n    let offset = this.offset;\n    this.hubs_sweepParams = new Float32Array(this.data, offset, 4 * maxInstances);\n    offset += this.hubs_sweepParams.byteLength;\n\n    this.hubs_interactorOnePos = new Float32Array(this.data, offset, 3);\n    offset += this.hubs_interactorOnePos.byteLength;\n\n    this.hubs_isFrozen = new Uint32Array(this.data, offset, 1);\n    offset += this.hubs_isFrozen.byteLength;\n\n    this.hubs_interactorTwoPos = new Float32Array(this.data, offset, 3);\n    offset += this.hubs_interactorTwoPos.byteLength;\n\n    this.hubs_time = new Float32Array(this.data, offset, 1);\n    offset += this.hubs_time.byteLength;\n\n    this.offset = offset;\n\n    this.meshToEl = meshToEl;\n  }\n\n  update(time) {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    let interactorOne, interactorTwo;\n\n    for (let instanceId = 0; instanceId < this.meshes.length; instanceId++) {\n      const mesh = this.meshes[instanceId];\n      if (!mesh) continue;\n\n      mesh.updateMatrices();\n\n      // TODO need to account for nested visibility deeper than 1 level\n      this.setInstanceTransform(instanceId, mesh.visible && mesh.parent.visible ? mesh.matrixWorld : HIDE_MATRIX);\n      this.setInstanceColor(instanceId, mesh.material.color || DEFAULT_COLOR, mesh.material.opacity || 1);\n\n      const el = this.meshToEl.get(mesh);\n      if (el) {\n        const obj = el.object3D;\n        const hoverableVisuals = el.components[\"hoverable-visuals\"];\n        const worldY = obj.matrixWorld.elements[13];\n        const scaledRadius = obj.scale.y * hoverableVisuals.boundingSphere.radius;\n\n        const isPinned = el.components.pinnable && el.components.pinnable.data.pinned;\n        const isSpawner = !!el.components[\"super-spawner\"];\n        const isFrozen = el.sceneEl.is(\"frozen\");\n        const hideDueToPinning = !isSpawner && isPinned && !isFrozen;\n\n        let highlightInteractorOne, highlightInteractorTwo;\n        if (interaction.state.leftHand.hovered === el && !interaction.state.leftHand.held) {\n          interactorOne = interaction.options.leftHand.entity.object3D;\n          highlightInteractorOne = true;\n        }\n\n        if (interaction.state.rightRemote.hovered === el && !interaction.state.rightRemote.held) {\n          interactorTwo = interaction.options.rightRemote.entity.object3D;\n          highlightInteractorTwo = true;\n        } else if (interaction.state.rightHand.hovered === el && !interaction.state.rightHand.held) {\n          interactorTwo = interaction.options.rightHand.entity.object3D;\n          highlightInteractorTwo = true;\n        }\n\n        tempVec4[0] = worldY - scaledRadius;\n        tempVec4[1] = worldY + scaledRadius;\n        tempVec4[2] = !!highlightInteractorOne && !hideDueToPinning;\n        tempVec4[3] = !!highlightInteractorTwo && !hideDueToPinning;\n        this.hubs_sweepParams.set(tempVec4, instanceId * 4);\n      }\n    }\n\n    if (interactorOne) {\n      tempVec3[0] = interactorOne.matrixWorld.elements[12];\n      tempVec3[1] = interactorOne.matrixWorld.elements[13];\n      tempVec3[2] = interactorOne.matrixWorld.elements[14];\n      this.hubs_interactorOnePos.set(tempVec3);\n    }\n\n    if (interactorTwo) {\n      tempVec3[0] = interactorTwo.matrixWorld.elements[12];\n      tempVec3[1] = interactorTwo.matrixWorld.elements[13];\n      tempVec3[2] = interactorTwo.matrixWorld.elements[14];\n      this.hubs_interactorTwoPos.set(tempVec3);\n    }\n\n    this.hubs_time[0] = time;\n    this.hubs_isFrozen[0] = AFRAME.scenes[0].is(\"frozen\") ? 1 : 0;\n  }\n}\n","import { BatchManager } from \"@mozillareality/three-batch-manager\";\n\nimport HubsBatchRawUniformGroup from \"./render-manager/hubs-batch-raw-uniform-group\";\nimport { sizeofInstances } from \"./render-manager/hubs-batch-raw-uniform-group\";\nimport unlitBatchVert from \"./render-manager/unlit-batch.vert\";\nimport unlitBatchFrag from \"./render-manager/unlit-batch.frag\";\nimport qsTruthy from \"../utils/qs_truthy\";\n\nconst MAX_INSTANCES = 500;\nconst UBO_BYTE_LENGTH = sizeofInstances(MAX_INSTANCES);\n\nexport class BatchManagerSystem {\n  constructor(scene, renderer) {\n    this.meshToEl = new WeakMap();\n    const gl = renderer.context;\n\n    if (qsTruthy(\"disableBatching\")) {\n      console.warn(\"Batching disabled by user via disableBatching. Disabling batching.\");\n      return;\n    }\n\n    if (!(window.WebGL2RenderingContext && gl instanceof WebGL2RenderingContext)) {\n      console.warn(\"Batching requires WebGL 2. Disabling batching.\");\n      return;\n    }\n\n    if (UBO_BYTE_LENGTH > gl.getParameter(gl.MAX_UNIFORM_BLOCK_SIZE)) {\n      console.warn(\"Insufficient MAX_UNIFORM_BLOCK_SIZE, Disabling batching\");\n      return;\n    }\n\n    this.batchingEnabled = true;\n\n    this.ubo = new HubsBatchRawUniformGroup(MAX_INSTANCES, this.meshToEl);\n    this.batchManager = new BatchManager(scene, renderer, {\n      maxInstances: MAX_INSTANCES,\n      ubo: this.ubo,\n      shaders: {\n        unlit: {\n          vertexShader: unlitBatchVert,\n          fragmentShader: unlitBatchFrag\n        }\n      }\n    });\n  }\n\n  addObject(rootObject) {\n    if (!this.batchingEnabled) return 0;\n\n    let batchedCount = 0;\n    rootObject.traverse(object => {\n      if (object.isMesh) {\n        if (this.batchManager.addMesh(object)) batchedCount++;\n      }\n    });\n    return batchedCount;\n  }\n\n  removeObject(rootObject) {\n    if (!this.batchingEnabled) return;\n\n    rootObject.traverse(object => {\n      if (object.isMesh) {\n        this.batchManager.removeMesh(object);\n      }\n    });\n  }\n\n  tick(time) {\n    if (!this.batchingEnabled) return;\n\n    this.batchManager.update(time);\n  }\n}\n","export class LobbyCameraSystem {\n  tick() {\n    const el = document.querySelector(\"[scene-preview-camera]\");\n    if (el) {\n      el.components[\"scene-preview-camera\"].tick2();\n    }\n  }\n}\n","import { CursorTargettingSystem } from \"./cursor-targetting-system\";\nimport { ConstraintsSystem } from \"./constraints-system\";\nimport { TwoPointStretchingSystem } from \"./two-point-stretching-system\";\nimport { SingleActionButtonSystem, HoldableButtonSystem, HoverButtonSystem } from \"./button-systems\";\nimport { HoverMenuSystem } from \"./hover-menu-system\";\nimport { SuperSpawnerSystem } from \"./super-spawner-system\";\nimport { HapticFeedbackSystem } from \"./haptic-feedback-system\";\nimport { SoundEffectsSystem } from \"./sound-effects-system\";\n\nimport { BatchManagerSystem } from \"./render-manager-system\";\nimport { LobbyCameraSystem } from \"./lobby-camera-system\";\n\nAFRAME.registerSystem(\"hubs-systems\", {\n  init() {\n    this.cursorTargettingSystem = new CursorTargettingSystem();\n    this.constraintsSystem = new ConstraintsSystem();\n    this.twoPointStretchingSystem = new TwoPointStretchingSystem();\n    this.singleActionButtonSystem = new SingleActionButtonSystem();\n    this.holdableButtonSystem = new HoldableButtonSystem();\n    this.hoverButtonSystem = new HoverButtonSystem();\n    this.hoverMenuSystem = new HoverMenuSystem();\n    this.superSpawnerSystem = new SuperSpawnerSystem();\n    this.hapticFeedbackSystem = new HapticFeedbackSystem();\n    this.soundEffectsSystem = new SoundEffectsSystem();\n    this.lobbyCameraSystem = new LobbyCameraSystem();\n    this.batchManagerSystem = new BatchManagerSystem(this.el.sceneEl.object3D, this.el.sceneEl.renderer);\n  },\n\n  tick(t) {\n    const systems = AFRAME.scenes[0].systems;\n    systems.userinput.tick2();\n    systems.interaction.tick2(this.soundEffectsSystem);\n    this.superSpawnerSystem.tick();\n    this.cursorTargettingSystem.tick(t);\n    this.constraintsSystem.tick();\n    this.twoPointStretchingSystem.tick();\n    this.singleActionButtonSystem.tick();\n    this.holdableButtonSystem.tick();\n    this.hoverButtonSystem.tick();\n    this.hoverMenuSystem.tick();\n    this.hapticFeedbackSystem.tick(this.twoPointStretchingSystem, this.singleActionButtonSystem.didInteractThisFrame);\n    this.soundEffectsSystem.tick();\n    this.lobbyCameraSystem.tick();\n    // batchManager is ticked in \"post-physics\" system\n  },\n\n  remove() {\n    this.cursorTargettingSystem.remove();\n  }\n});\n","import qsTruthy from \"../utils/qs_truthy\";\n\nAFRAME.registerSystem(\"capture-system\", {\n  init() {\n    this._gotAudioTrack = false;\n    this._recorderTimeout = null;\n  },\n\n  _initRecorder() {\n    if (!this.available()) return;\n\n    this._stream = new MediaStream();\n\n    const video = this.el.canvas.captureStream().getVideoTracks()[0];\n    this._stream.addTrack(video);\n\n    this._recorder = new MediaRecorder(this._stream, { mimeType: \"video/webm; codecs=vp8\" });\n\n    const chunks = [];\n\n    this._recorder.ondataavailable = e => {\n      chunks.push(e.data);\n    };\n    this._recorder.onstop = () => {\n      if (chunks.length === 0) return;\n      const mimeType = chunks[0].type;\n      const blob = new Blob(chunks, { type: mimeType });\n      chunks.length = 0;\n      this.el.emit(\"add_media\", new File([blob], \"capture\", { type: mimeType }));\n    };\n  },\n\n  available() {\n    return qsTruthy(\"video_capture\") && window.MediaRecorder && MediaRecorder.isTypeSupported(\"video/webm; codecs=vp8\");\n  },\n\n  started() {\n    return this._recorder && this._recorder.state !== \"inactive\";\n  },\n\n  _tryAddingAudioTrack() {\n    if (this._gotAudioTrack || !this.el.audioListener) return;\n\n    const listener = this.el.audioListener;\n    const destination = listener.context.createMediaStreamDestination();\n    listener.getInput().connect(destination);\n    const audio = destination.stream.getAudioTracks()[0];\n\n    this._stream.addTrack(audio);\n    this._gotAudioTrack = true;\n  },\n\n  start() {\n    if (!this._recorder) {\n      this._initRecorder();\n    }\n\n    // The scene doesn't get an audioListener until something in the scene is playing audio.\n    // So we have to get the audio track lazily.\n    this._tryAddingAudioTrack();\n\n    if (!this.started()) {\n      this._recorder.start();\n      this._recorderTimeout = setTimeout(() => {\n        if (this.started()) {\n          this._recorder.stop();\n        }\n      }, 15000);\n    }\n  },\n\n  stop() {\n    if (this.started()) {\n      clearTimeout(this._recorderTimeout);\n      this._recorder.stop();\n    }\n  }\n});\n","/* global AFRAME THREE */\n\n// See doc/spritesheet-generation.md for information about this spritesheet\nimport spritesheet from \"../assets/images/spritesheets/sprite-system-spritesheet.json\";\nimport { createImageTexture } from \"../utils/media-utils\";\nimport spritesheetPng from \"../assets/images/spritesheets/sprite-system-spritesheet.png\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\nimport vert from \"./sprites/sprite.vert\";\nimport frag from \"./sprites/sprite.frag\";\n\nconst multiviewVertPrefix = [\n  // GLSL 3.0 conversion\n  \"#version 300 es\",\n  \"#define attribute in\",\n  \"#define varying out\",\n  \"#define texture2D texture\",\n  \"#extension GL_OVR_multiview : require\",\n  \"layout(num_views = 2) in;\",\n  \"uniform mat4 modelViewMatrix;\",\n  \"uniform mat4 modelViewMatrix2;\",\n  \"#define modelViewMatrix (gl_ViewID_OVR==0u?modelViewMatrix:modelViewMatrix2)\",\n  \"uniform mat4 projectionMatrix;\",\n  \"uniform mat4 projectionMatrix2;\",\n  \"#define projectionMatrix (gl_ViewID_OVR==0u?projectionMatrix:projectionMatrix2)\",\n  \"\"\n].join(\"\\n\");\nconst nonmultiviewVertPrefix = [\"uniform mat4 modelViewMatrix;\", \"uniform mat4 projectionMatrix;\", \"\"].join(\"\\n\");\n\nconst multiviewFragPrefix = [\n  \"#version 300 es\",\n  \"#define varying in\",\n  \"out highp vec4 pc_fragColor;\",\n  \"#define gl_FragColor pc_fragColor\",\n  \"#define texture2D texture\",\n  \"\"\n].join(\"\\n\");\n\nconst nonmultiviewFragPrefix = \"\";\n\nfunction isVisible(o) {\n  if (!o.visible) return false;\n  if (!o.parent) return true;\n  return isVisible(o.parent);\n}\n\nAFRAME.registerComponent(\"sprite\", {\n  schema: { name: { type: \"string\" } },\n  tick() {\n    // TODO when we run out of sprites we currently just stop rendering them. We need to do something better.\n    if (!(this.didRegisterWithSystem || this.didFailToRegister) && this.el.sceneEl.systems[\"post-physics\"]) {\n      const registered = this.el.sceneEl.systems[\"post-physics\"].spriteSystem.add(this);\n      this.didRegisterWithSystem = registered > 0;\n      this.didFailToRegister = registered < 0;\n    }\n  },\n\n  update() {\n    if (this.didRegisterWithSystem) {\n      this.el.sceneEl.systems[\"post-physics\"].spriteSystem.updateUVs(this);\n    }\n  },\n\n  remove() {\n    if (this.didRegisterWithSystem) {\n      this.el.sceneEl.systems[\"post-physics\"].spriteSystem.remove(this);\n    }\n  }\n});\n\nconst normalizedFrame = (function() {\n  const memo = new Map();\n  return function normalizedFrame(name, spritesheet, missingSprites) {\n    let ret = memo.get(name);\n    if (ret) {\n      return ret;\n    } else {\n      if (!spritesheet.frames[name]) {\n        if (missingSprites.indexOf(name) === -1) {\n          missingSprites.push(name);\n        }\n        ret = { x: 0, y: 0, w: 0, h: 0 };\n        memo.set(name, ret);\n        return ret;\n      }\n      const size = spritesheet.meta.size;\n      const frame = spritesheet.frames[name].frame;\n      ret = {\n        x: frame.x / size.w,\n        y: frame.y / size.h,\n        w: frame.w / size.w,\n        h: frame.h / size.h\n      };\n      memo.set(name, ret);\n      return ret;\n    }\n  };\n})();\n\nconst raycastOnSprite = (function() {\n  const vA = new THREE.Vector3();\n  const vB = new THREE.Vector3();\n  const vC = new THREE.Vector3();\n  const vD = new THREE.Vector3();\n  const point = new THREE.Vector3();\n  const intersectionInfo = { distance: 0, point, object: null };\n\n  return function raycast(raycaster, intersects) {\n    vA.set(-0.5, 0.5, 0).applyMatrix4(this.matrixWorld);\n    vB.set(0.5, 0.5, 0).applyMatrix4(this.matrixWorld);\n    vC.set(-0.5, -0.5, 0).applyMatrix4(this.matrixWorld);\n    let intersect = raycaster.ray.intersectTriangle(vA, vC, vB, false, point);\n    if (intersect === null) {\n      vD.set(0.5, -0.5, 0).applyMatrix4(this.matrixWorld);\n      intersect = raycaster.ray.intersectTriangle(vB, vC, vD, false, point);\n      if (intersect === null) {\n        return;\n      }\n    }\n\n    const distance = raycaster.ray.origin.distanceTo(point);\n    if (distance < raycaster.near || distance > raycaster.far) return;\n\n    intersectionInfo.distance = distance;\n    intersectionInfo.point = point;\n    intersectionInfo.object = this;\n    intersects.push(intersectionInfo);\n  };\n})();\n\nfunction getHoverableVisuals(el) {\n  if (!el || !el.components) return null;\n  if (el.components[\"hoverable-visuals\"]) {\n    return el.components[\"hoverable-visuals\"];\n  }\n  return getHoverableVisuals(el.parentEl);\n}\n\nfunction enableSweepingEffect(comp) {\n  const hoverableVisuals = getHoverableVisuals(comp.el);\n  if (!hoverableVisuals) {\n    return false;\n  }\n\n  const isPinned = hoverableVisuals.el.components.pinnable && hoverableVisuals.el.components.pinnable.data.pinned;\n  const isSpawner = !!hoverableVisuals.el.components[\"super-spawner\"];\n  const isFrozen = hoverableVisuals.el.sceneEl.is(\"frozen\");\n  const hideDueToPinning = !isSpawner && isPinned && !isFrozen;\n  return hoverableVisuals.data.enableSweepingEffect && !hideDueToPinning;\n}\n\nfunction createGeometry(maxSprites) {\n  const geometry = new THREE.BufferGeometry();\n  geometry.addAttribute(\"a_vertices\", new THREE.BufferAttribute(new Float32Array(maxSprites * 3 * 4), 3, false));\n  geometry.addAttribute(\n    \"a_hubs_EnableSweepingEffect\",\n    new THREE.BufferAttribute(new Float32Array(maxSprites * 4), 1, false)\n  );\n  geometry.addAttribute(\n    \"a_hubs_SweepParams\",\n    new THREE.BufferAttribute(new Float32Array(maxSprites * 4 * 2), 2, false)\n  );\n  geometry.addAttribute(\"a_uvs\", new THREE.BufferAttribute(new Float32Array(maxSprites * 2 * 4), 2, false));\n  const mvCols = new THREE.InterleavedBuffer(new Float32Array(maxSprites * 16 * 4), 16);\n  geometry.addAttribute(\"mvCol0\", new THREE.InterleavedBufferAttribute(mvCols, 4, 0, false));\n  geometry.addAttribute(\"mvCol1\", new THREE.InterleavedBufferAttribute(mvCols, 4, 4, false));\n  geometry.addAttribute(\"mvCol2\", new THREE.InterleavedBufferAttribute(mvCols, 4, 8, false));\n  geometry.addAttribute(\"mvCol3\", new THREE.InterleavedBufferAttribute(mvCols, 4, 12, false));\n  const indices = new Array(3 * 2 * maxSprites);\n  for (let i = 0; i < maxSprites; i++) {\n    indices[i * 3 * 2 + 0] = i * 4 + 0;\n    indices[i * 3 * 2 + 1] = i * 4 + 2;\n    indices[i * 3 * 2 + 2] = i * 4 + 1;\n    indices[i * 3 * 2 + 3] = i * 4 + 1;\n    indices[i * 3 * 2 + 4] = i * 4 + 2;\n    indices[i * 3 * 2 + 5] = i * 4 + 3;\n  }\n  geometry.setIndex(indices);\n  return geometry;\n}\n\nconst ZEROS = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n\nexport class SpriteSystem {\n  raycast(raycaster, intersects) {\n    for (let i = 0; i < this.slots.length; i++) {\n      if (!this.slots[i]) continue;\n\n      const o = this.indexWithSprite.get(i).el.object3D;\n      if (isVisible(o)) {\n        raycastOnSprite.call(o, raycaster, intersects);\n      }\n    }\n    return intersects;\n  }\n  constructor(scene) {\n    this.missingSprites = [];\n    this.maxSprites = 512;\n    this.slots = new Array(this.maxSprites);\n    this.spriteWithIndex = new Map();\n    this.indexWithSprite = new Map();\n    this.stack = new Array(this.maxSprites);\n    for (let i = 0; i < this.maxSprites; i++) {\n      this.stack[i] = this.maxSprites - 1 - i;\n    }\n\n    const vertexShader = String.prototype.concat(\n      scene.renderer.vr.multiview ? multiviewVertPrefix : nonmultiviewVertPrefix,\n      vert\n    );\n    const fragmentShader = String.prototype.concat(\n      scene.renderer.vr.multiview ? multiviewFragPrefix : nonmultiviewFragPrefix,\n      frag\n    );\n    Promise.all([createImageTexture(spritesheetPng), waitForDOMContentLoaded()]).then(([spritesheetTexture]) => {\n      const material = new THREE.RawShaderMaterial({\n        uniforms: {\n          u_spritesheet: { value: spritesheetTexture },\n          hubs_Time: { value: 0 }\n        },\n        vertexShader,\n        fragmentShader,\n        side: THREE.DoubleSide,\n        transparent: true\n      });\n      this.mesh = new THREE.Mesh(createGeometry(this.maxSprites), material);\n      const el = document.createElement(\"a-entity\");\n      el.classList.add(\"ui\");\n      scene.appendChild(el);\n      el.setObject3D(\"mesh\", this.mesh);\n      this.mesh.frustumCulled = false;\n      this.mesh.renderOrder = window.APP.RENDER_ORDER.HUD_ICONS;\n      this.mesh.raycast = this.raycast.bind(this);\n    });\n  }\n\n  tick(t) {\n    if (!this.mesh) return;\n\n    this.mesh.material.uniforms.hubs_Time.value = t;\n    this.mesh.material.uniformsNeedUpdate = true;\n\n    const mvCols = this.mesh.geometry.attributes[\"mvCol0\"].data; // interleaved\n    const aEnableSweepingEffect = this.mesh.geometry.attributes[\"a_hubs_EnableSweepingEffect\"];\n    const aSweepParams = this.mesh.geometry.attributes[\"a_hubs_SweepParams\"];\n    for (let i = 0; i < this.slots.length; i++) {\n      if (!this.slots[i]) continue;\n\n      const sprite = this.indexWithSprite.get(i);\n      if (isVisible(sprite.el.object3D)) {\n        const enableSweepingEffectValue = enableSweepingEffect(sprite) ? 1 : 0;\n        aEnableSweepingEffect.array[i * 4 + 0] = enableSweepingEffectValue;\n        aEnableSweepingEffect.array[i * 4 + 1] = enableSweepingEffectValue;\n        aEnableSweepingEffect.array[i * 4 + 2] = enableSweepingEffectValue;\n        aEnableSweepingEffect.array[i * 4 + 3] = enableSweepingEffectValue;\n        aEnableSweepingEffect.needsUpdate = true;\n        if (enableSweepingEffectValue) {\n          const hoverableVisuals = getHoverableVisuals(sprite.el);\n          const s = hoverableVisuals.sweepParams[0];\n          const t = hoverableVisuals.sweepParams[1];\n          aSweepParams.setXY(4 * i + 0, s, t);\n          aSweepParams.setXY(4 * i + 1, s, t);\n          aSweepParams.setXY(4 * i + 2, s, t);\n          aSweepParams.setXY(4 * i + 3, s, t);\n          aSweepParams.needsUpdate = true;\n        }\n\n        sprite.el.object3D.updateMatrices();\n        const mat4 = sprite.el.object3D.matrixWorld;\n        mvCols.array.set(mat4.elements, i * 4 * 16 + 0);\n        mvCols.array.set(mat4.elements, i * 4 * 16 + 1 * 16);\n        mvCols.array.set(mat4.elements, i * 4 * 16 + 2 * 16);\n        mvCols.array.set(mat4.elements, i * 4 * 16 + 3 * 16);\n        mvCols.needsUpdate = true;\n      } else {\n        mvCols.array.set(ZEROS, i * 4 * 16 + 0);\n        mvCols.array.set(ZEROS, i * 4 * 16 + 1 * 16);\n        mvCols.array.set(ZEROS, i * 4 * 16 + 2 * 16);\n        mvCols.array.set(ZEROS, i * 4 * 16 + 3 * 16);\n        mvCols.needsUpdate = true;\n      }\n    }\n  }\n\n  updateUVs(sprite) {\n    const flipY = this.mesh.material.uniforms.u_spritesheet.value.flipY;\n    const i = this.spriteWithIndex.get(sprite);\n    const frame = normalizedFrame(sprite.data.name, spritesheet, this.missingSprites);\n    const aUvs = this.mesh.geometry.attributes[\"a_uvs\"];\n\n    aUvs.setXY(i * 4 + 0, frame.x, flipY ? 1 - frame.y : frame.y);\n    aUvs.setXY(i * 4 + 1, frame.x + frame.w, flipY ? 1 - frame.y : frame.y);\n    aUvs.setXY(i * 4 + 2, frame.x, flipY ? 1 - frame.y - frame.h : frame.y + frame.h);\n    aUvs.setXY(i * 4 + 3, frame.x + frame.w, flipY ? 1 - frame.y - frame.h : frame.y + frame.h);\n    aUvs.needsUpdate = true;\n  }\n\n  add(sprite) {\n    if (!this.mesh) {\n      return 0;\n    }\n    const i = this.stack.pop();\n    if (i === undefined) {\n      console.error(\"Too many sprites\");\n      return -1;\n    }\n    this.slots[i] = true;\n    this.spriteWithIndex.set(sprite, i);\n    this.indexWithSprite.set(i, sprite);\n\n    this.updateUVs(sprite);\n\n    const aVertices = this.mesh.geometry.attributes[\"a_vertices\"];\n    aVertices.setXYZ(i * 4 + 0, -0.5, 0.5, 0);\n    aVertices.setXYZ(i * 4 + 1, 0.5, 0.5, 0);\n    aVertices.setXYZ(i * 4 + 2, -0.5, -0.5, 0);\n    aVertices.setXYZ(i * 4 + 3, 0.5, -0.5, 0);\n    aVertices.needsUpdate = true;\n    return 1;\n  }\n\n  remove(sprite) {\n    const i = this.spriteWithIndex.get(sprite);\n    this.spriteWithIndex.delete(sprite);\n    this.indexWithSprite.delete(i);\n    this.slots[i] = false;\n    this.stack.push(i);\n\n    const mvCols = this.mesh.geometry.attributes[\"mvCol0\"].data; // interleaved\n    mvCols.array.set(ZEROS, i * 4 * 16 + 0);\n    mvCols.array.set(ZEROS, i * 4 * 16 + 1 * 16);\n    mvCols.array.set(ZEROS, i * 4 * 16 + 2 * 16);\n    mvCols.array.set(ZEROS, i * 4 * 16 + 3 * 16);\n    mvCols.needsUpdate = true;\n  }\n}\n","import { SpriteSystem } from \"./sprites\";\n\nconst i = window.setInterval(() => {\n  if (AFRAME.scenes[0] && AFRAME.scenes[0].systems && AFRAME.scenes[0].systems.physics) {\n    AFRAME.registerSystem(\"post-physics\", {\n      init() {\n        this.spriteSystem = new SpriteSystem(this.el);\n        this.hubsSystems = this.el.sceneEl.systems[\"hubs-systems\"];\n      },\n      tick(t, dt) {\n        this.spriteSystem.tick(t, dt);\n        this.hubsSystems.batchManagerSystem.tick(t);\n      }\n    });\n    window.clearInterval(i);\n  }\n}, 1000);\n","import { paths } from \"../systems/userinput/paths\";\n\nAFRAME.registerComponent(\"scalable-when-grabbed\", {\n  tick: function() {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    if (interaction.state.rightRemote.held !== this.el) return;\n    const deltaScale = userinput.get(paths.actions.cursor.scaleGrabbedGrabbable);\n    if (!deltaScale) return;\n\n    this.el.object3D.scale.addScalar(deltaScale).clampScalar(0.1, 100);\n    this.el.object3D.matrixNeedsUpdate = true;\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\nimport { sets } from \"../systems/userinput/sets\";\nimport { getLastWorldPosition } from \"../utils/three-utils\";\n\nconst HIGHLIGHT = new THREE.Color(23 / 255, 64 / 255, 118 / 255);\nconst NO_HIGHLIGHT = new THREE.Color(190 / 255, 190 / 255, 190 / 255);\nconst TRANSFORM_COLOR_1 = new THREE.Color(150 / 255, 80 / 255, 150 / 255);\nconst TRANSFORM_COLOR_2 = new THREE.Color(23 / 255, 64 / 255, 118 / 255);\nAFRAME.registerComponent(\"cursor-controller\", {\n  schema: {\n    cursor: { type: \"selector\" },\n    camera: { type: \"selector\" },\n    far: { default: 25 },\n    near: { default: 0.01 },\n    defaultDistance: { default: 4 },\n    minDistance: { default: 0.18 }\n  },\n\n  init: function() {\n    this.enabled = true;\n\n    this.data.cursor.addEventListener(\n      \"loaded\",\n      () => {\n        this.data.cursor.object3DMap.mesh.renderOrder = window.APP.RENDER_ORDER.CURSOR;\n      },\n      { once: true }\n    );\n\n    this.raycaster = new THREE.Raycaster();\n    this.raycaster.firstHitOnly = true; // flag specific to three-mesh-bvh\n    this.distance = this.data.far;\n    this.color = new THREE.Color(0, 0, 0);\n\n    const lineGeometry = new THREE.BufferGeometry();\n    lineGeometry.addAttribute(\"position\", new THREE.BufferAttribute(new Float32Array(2 * 3), 3));\n\n    this.line = new THREE.Line(\n      lineGeometry,\n      new THREE.LineBasicMaterial({\n        color: \"white\",\n        opacity: 0.2,\n        transparent: true,\n        visible: false\n      })\n    );\n    this.el.setObject3D(\"line\", this.line);\n  },\n\n  update: function() {\n    this.raycaster.far = this.data.far;\n    this.raycaster.near = this.data.near;\n  },\n\n  tick2: (() => {\n    const rawIntersections = [];\n    const cameraPos = new THREE.Vector3();\n\n    return function(t) {\n      const userinput = AFRAME.scenes[0].systems.userinput;\n      const cursorPose = userinput.get(paths.actions.cursor.pose);\n      const hideLine = userinput.get(paths.actions.cursor.hideLine);\n\n      this.data.cursor.object3D.visible = this.enabled && !!cursorPose;\n      this.line.material.visible = !!(this.enabled && !hideLine);\n\n      if (!this.enabled || !cursorPose) {\n        return;\n      }\n\n      const interaction = AFRAME.scenes[0].systems.interaction;\n      let intersection;\n      const isGrabbing = !!interaction.state.rightRemote.held;\n      if (!isGrabbing) {\n        rawIntersections.length = 0;\n        this.raycaster.ray.origin = cursorPose.position;\n        this.raycaster.ray.direction = cursorPose.direction;\n        this.raycaster.intersectObjects(\n          AFRAME.scenes[0].systems[\"hubs-systems\"].cursorTargettingSystem.targets,\n          true,\n          rawIntersections\n        );\n        intersection = rawIntersections[0];\n        interaction.updateCursorIntersection(intersection);\n        this.distance = intersection ? intersection.distance : this.data.defaultDistance;\n      }\n\n      const { cursor, minDistance, far, camera } = this.data;\n\n      const cursorModDelta = userinput.get(paths.actions.cursor.modDelta) || 0;\n      if (isGrabbing && !userinput.activeSets.includes(sets.cursorHoldingUI)) {\n        this.distance = THREE.Math.clamp(this.distance - cursorModDelta, minDistance, far);\n      }\n      cursor.object3D.position.copy(cursorPose.position).addScaledVector(cursorPose.direction, this.distance);\n      // The cursor will always be oriented towards the player about its Y axis, so objects held by the cursor will rotate towards the player.\n      getLastWorldPosition(camera.object3D, cameraPos);\n      cameraPos.y = cursor.object3D.position.y;\n      cursor.object3D.lookAt(cameraPos);\n      cursor.object3D.scale.setScalar(Math.pow(this.distance, 0.315) * 0.75);\n      cursor.object3D.matrixNeedsUpdate = true;\n\n      if (AFRAME.scenes[0].systems[\"transform-selected-object\"].transforming) {\n        this.color.copy(TRANSFORM_COLOR_1).lerpHSL(TRANSFORM_COLOR_2, 0.5 + 0.5 * Math.sin(t / 1000.0));\n      } else if (intersection || isGrabbing) {\n        this.color.copy(HIGHLIGHT);\n      } else {\n        this.color.copy(NO_HIGHLIGHT);\n      }\n\n      if (!this.data.cursor.object3DMap.mesh.material.color.equals(this.color)) {\n        this.data.cursor.object3DMap.mesh.material.color.copy(this.color);\n        this.data.cursor.object3DMap.mesh.material.needsUpdate = true;\n      }\n\n      if (this.line.material.visible) {\n        const posePosition = cursorPose.position;\n        const cursorPosition = cursor.object3D.position;\n        const positionArray = this.line.geometry.attributes.position.array;\n\n        positionArray[0] = posePosition.x;\n        positionArray[1] = posePosition.y;\n        positionArray[2] = posePosition.z;\n        positionArray[3] = cursorPosition.x;\n        positionArray[4] = cursorPosition.y;\n        positionArray[5] = cursorPosition.z;\n\n        this.line.geometry.attributes.position.needsUpdate = true;\n        this.line.geometry.computeBoundingSphere();\n      }\n    };\n  })()\n});\n","import { paths } from \"../../systems/userinput/paths\";\nimport { getLastWorldPosition, getLastWorldQuaternion } from \"../../utils/three-utils\";\nimport {\n  SOUND_PEN_START_DRAW,\n  SOUND_PEN_STOP_DRAW,\n  SOUND_PEN_UNDO_DRAW,\n  SOUND_PEN_CHANGE_COLOR\n} from \"../../systems/sound-effects-system\";\nimport { waitForDOMContentLoaded } from \"../../utils/async-utils\";\nimport MobileStandardMaterial from \"../../materials/MobileStandardMaterial\";\n\nconst pathsMap = {\n  \"player-right-controller\": {\n    startDrawing: paths.actions.rightHand.startDrawing,\n    stopDrawing: paths.actions.rightHand.stopDrawing,\n    undoDrawing: paths.actions.rightHand.undoDrawing,\n    switchDrawMode: paths.actions.rightHand.switchDrawMode,\n    penNextColor: paths.actions.rightHand.penNextColor,\n    penPrevColor: paths.actions.rightHand.penPrevColor,\n    scalePenTip: paths.actions.rightHand.scalePenTip\n  },\n  \"player-left-controller\": {\n    startDrawing: paths.actions.leftHand.startDrawing,\n    stopDrawing: paths.actions.leftHand.stopDrawing,\n    undoDrawing: paths.actions.leftHand.undoDrawing,\n    switchDrawMode: paths.actions.leftHand.switchDrawMode,\n    penNextColor: paths.actions.leftHand.penNextColor,\n    penPrevColor: paths.actions.leftHand.penPrevColor,\n    scalePenTip: paths.actions.leftHand.scalePenTip\n  },\n  cursor: {\n    pose: paths.actions.cursor.pose,\n    startDrawing: paths.actions.cursor.startDrawing,\n    stopDrawing: paths.actions.cursor.stopDrawing,\n    undoDrawing: paths.actions.cursor.undoDrawing,\n    penNextColor: paths.actions.cursor.penNextColor,\n    penPrevColor: paths.actions.cursor.penPrevColor,\n    scalePenTip: paths.actions.cursor.scalePenTip\n  }\n};\n\nconst DRAW_MODE = {\n  DEFAULT_2D: 0,\n  PROJECTION: 1\n};\n\nconst MAX_DISTANCE_BETWEEN_SURFACES = 1;\n\n/**\n * Pen tool\n * A tool that allows drawing on networked-drawing components.\n * @namespace drawing\n * @component pen\n */\n\nfunction almostEquals(epsilon, u, v) {\n  return Math.abs(u.x - v.x) < epsilon && Math.abs(u.y - v.y) < epsilon && Math.abs(u.z - v.z) < epsilon;\n}\n\nAFRAME.registerComponent(\"pen\", {\n  schema: {\n    drawFrequency: { default: 5 }, //frequency of polling for drawing points\n    minDistanceBetweenPoints: { default: 0.01 }, //minimum distance to register new drawing point\n    camera: { type: \"selector\" },\n    drawingManager: { type: \"string\" },\n    color: { type: \"color\", default: \"#FF0033\" },\n    availableColors: {\n      default: [\n        \"#FF0033\",\n        \"#FFFF00\",\n        \"#0099FF\",\n        \"#00FF33\",\n        \"#9900FF\",\n        \"#FF6600\",\n        \"#8D5524\",\n        \"#C68642\",\n        \"#E0AC69\",\n        \"#F1C27D\",\n        \"#FFDBAC\",\n        \"#FFFFFF\",\n        \"#222222\",\n        \"#111111\",\n        \"#000000\"\n      ]\n    },\n    radius: { default: 0.01 }, //drawing geometry radius\n    minRadius: { default: 0.005 },\n    maxRadius: { default: 0.2 },\n    far: { default: 100 },\n    near: { default: 0.01 }\n  },\n\n  init() {\n    this.timeSinceLastDraw = 0;\n\n    this.lastPosition = new THREE.Vector3();\n    this.lastPosition.copy(this.el.object3D.position);\n\n    this.direction = new THREE.Vector3(1, 0, 0);\n\n    this.currentDrawing = null;\n\n    this.normal = new THREE.Vector3();\n\n    this.worldPosition = new THREE.Vector3();\n\n    this.colorIndex = 0;\n\n    this.grabbed = false;\n\n    this.raycaster = new THREE.Raycaster();\n    this.raycaster.firstHitOnly = true; // flag specific to three-mesh-bvh\n\n    this.originalPosition = this.el.object3D.position.clone();\n    this.intersection = null;\n    this.lastIntersectionDistance = 0;\n\n    const lineGeometry = new THREE.BufferGeometry();\n    lineGeometry.addAttribute(\"position\", new THREE.BufferAttribute(new Float32Array(2 * 3), 3));\n\n    this.line = new THREE.Line(\n      lineGeometry,\n      new THREE.LineBasicMaterial({\n        color: \"red\",\n        opacity: 0.2,\n        transparent: true,\n        visible: true\n      })\n    );\n\n    //prevents the line from being a raycast target for the cursor\n    this.line.raycast = function() {};\n\n    this.el.parentEl.setObject3D(\"penline\", this.line);\n\n    this.drawMode = DRAW_MODE.DEFAULT_2D;\n\n    this.targets = [];\n    this.setDirty = this.setDirty.bind(this);\n    this.dirty = true;\n\n    let material = new THREE.MeshStandardMaterial();\n    if (window.APP && window.APP.quality === \"low\") {\n      material = MobileStandardMaterial.fromStandardMaterial(material);\n    }\n    this.penTip = new THREE.Mesh(new THREE.SphereBufferGeometry(1, 16, 12), material);\n    this.penTip.scale.setScalar(this.data.radius / this.el.parentEl.object3D.scale.x);\n    this.penTip.matrixNeedsUpdate = true;\n\n    this.el.setObject3D(\"mesh\", this.penTip);\n\n    const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\n    if (environmentMapComponent) {\n      environmentMapComponent.applyEnvironmentMap(this.el.parentEl.object3D);\n    }\n\n    // TODO: Use the MutationRecords passed into the callback function to determine added/removed nodes!\n    this.observer = new MutationObserver(this.setDirty);\n\n    waitForDOMContentLoaded().then(() => {\n      const scene = document.querySelector(\"a-scene\");\n      this.rightRemote = document.querySelector(\"#cursor-controller\");\n      this.observer.observe(scene, { childList: true, attributes: true, subtree: true });\n      scene.addEventListener(\"object3dset\", this.setDirty);\n      scene.addEventListener(\"object3dremove\", this.setDirty);\n    });\n  },\n\n  play() {\n    this.drawingManager = document.querySelector(this.data.drawingManager).components[\"drawing-manager\"];\n    this.drawingManager.createDrawing();\n  },\n\n  update(prevData) {\n    if (prevData.color != this.data.color) {\n      this.penTip.material.color.set(this.data.color);\n      this.line.material.color.set(this.data.color);\n    }\n    if (prevData.radius != this.data.radius) {\n      this.el.setAttribute(\"radius\", this.data.radius);\n    }\n\n    this.raycaster.far = this.data.far;\n    this.raycaster.near = this.data.near;\n  },\n\n  tick: (() => {\n    const rawIntersections = [];\n    const lineStartPosition = new THREE.Vector3();\n    const lineEndPosition = new THREE.Vector3();\n    const worldQuaternion = new THREE.Quaternion();\n    return function(t, dt) {\n      const userinput = AFRAME.scenes[0].systems.userinput;\n      const interaction = AFRAME.scenes[0].systems.interaction;\n\n      if (interaction.state.rightHand.held === this.el.parentNode) {\n        this.grabberId = \"player-right-controller\";\n      } else if (interaction.state.leftHand.held === this.el.parentNode) {\n        this.grabberId = \"player-left-controller\";\n      } else if (interaction.state.rightRemote.held === this.el.parentNode) {\n        this.grabberId = \"cursor\";\n        this.drawMode = DRAW_MODE.PROJECTION;\n      } else {\n        this.grabberId = null;\n      }\n\n      if (this.grabberId && pathsMap[this.grabberId]) {\n        const sfx = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem;\n        const paths = pathsMap[this.grabberId];\n        if (userinput.get(paths.startDrawing)) {\n          this._startDraw();\n          sfx.playSoundOneShot(SOUND_PEN_START_DRAW);\n        }\n        if (userinput.get(paths.stopDrawing)) {\n          this._endDraw();\n          sfx.playSoundOneShot(SOUND_PEN_STOP_DRAW);\n        }\n        const penScaleMod = userinput.get(paths.scalePenTip);\n        if (penScaleMod) {\n          this._changeRadius(penScaleMod);\n        }\n        if (userinput.get(paths.penNextColor)) {\n          this._changeColor(1);\n          sfx.playSoundOneShot(SOUND_PEN_CHANGE_COLOR);\n        }\n        if (userinput.get(paths.penPrevColor)) {\n          this._changeColor(-1);\n          sfx.playSoundOneShot(SOUND_PEN_CHANGE_COLOR);\n        }\n        if (userinput.get(paths.undoDrawing)) {\n          this._undoDraw();\n          sfx.playSoundOneShot(SOUND_PEN_UNDO_DRAW);\n        }\n        if (paths.switchDrawMode && userinput.get(paths.switchDrawMode)) {\n          this.drawMode = this.drawMode === DRAW_MODE.DEFAULT_2D ? DRAW_MODE.PROJECTION : DRAW_MODE.DEFAULT_2D;\n        }\n      }\n\n      rawIntersections.length = 0;\n\n      this.intersection = null;\n      let cursorPose;\n      if (this.drawMode === DRAW_MODE.PROJECTION) {\n        if (this.grabberId === \"cursor\") {\n          cursorPose = userinput.get(pathsMap.cursor.pose);\n          if (cursorPose) {\n            this.raycaster.ray.origin.copy(cursorPose.position);\n            this.raycaster.ray.direction.copy(cursorPose.direction);\n          }\n        } else if (this.grabberId !== null) {\n          getLastWorldPosition(this.el.parentEl.object3D, this.raycaster.ray.origin);\n          getLastWorldQuaternion(this.el.parentEl.object3D, worldQuaternion);\n          this.raycaster.ray.direction.set(0, -1, 0);\n          this.raycaster.ray.direction.applyQuaternion(worldQuaternion);\n        }\n\n        if (this.grabberId !== null) {\n          this.raycaster.intersectObjects(this.targets, true, rawIntersections);\n          this.intersection = rawIntersections[0];\n\n          if (this.intersection) {\n            if (cursorPose) {\n              lineStartPosition.copy(cursorPose.position);\n              this.el.parentEl.object3D.worldToLocal(lineStartPosition);\n            } else {\n              lineStartPosition.set(0, 0, 0);\n            }\n            lineEndPosition.copy(this.intersection.point);\n            this.el.parentEl.object3D.worldToLocal(lineEndPosition);\n\n            const positionArray = this.line.geometry.attributes.position.array;\n            positionArray[0] = lineStartPosition.x;\n            positionArray[1] = lineStartPosition.y;\n            positionArray[2] = lineStartPosition.z;\n            positionArray[3] = lineEndPosition.x;\n            positionArray[4] = lineEndPosition.y;\n            positionArray[5] = lineEndPosition.z;\n\n            this.line.geometry.attributes.position.needsUpdate = true;\n          }\n\n          if (this.intersection) {\n            this.el.object3D.position.copy(this.intersection.point);\n\n            this.el.parentEl.object3D.worldToLocal(this.el.object3D.position);\n\n            this.el.object3D.matrixNeedsUpdate = true;\n            this.worldPosition.copy(this.intersection.point);\n          } else {\n            this.el.object3D.position.copy(this.originalPosition);\n            this.el.object3D.matrixNeedsUpdate = true;\n            getLastWorldPosition(this.el.object3D, this.worldPosition);\n          }\n        }\n      } else {\n        this.el.object3D.position.copy(this.originalPosition);\n        this.el.object3D.matrixNeedsUpdate = true;\n        getLastWorldPosition(this.el.object3D, this.worldPosition);\n      }\n\n      this._setPenVisible(this.grabberId !== \"cursor\" || !this.intersection);\n      this._setLineVisible(\n        this.el.sceneEl.is(\"vr-mode\") && this.drawMode === DRAW_MODE.PROJECTION && this.intersection\n      );\n\n      //Prevent drawings from \"jumping\" large distances\n      if (\n        this.currentDrawing &&\n        (this.lastIntersectedObject !== (this.intersection ? this.intersection.object : null) &&\n          (!this.intersection ||\n            Math.abs(this.intersection.distance - this.lastIntersectionDistance) > MAX_DISTANCE_BETWEEN_SURFACES))\n      ) {\n        this.worldPosition.copy(this.lastPosition);\n        this._endDraw();\n      }\n      this.lastIntersectionDistance = this.intersection ? this.intersection.distance : 0;\n      this.lastIntersectedObject = this.intersection ? this.intersection.object : null;\n\n      if (!almostEquals(0.005, this.worldPosition, this.lastPosition)) {\n        this.direction.subVectors(this.worldPosition, this.lastPosition).normalize();\n        this.lastPosition.copy(this.worldPosition);\n      }\n\n      if (this.currentDrawing) {\n        const time = this.timeSinceLastDraw + dt;\n        if (\n          time >= this.data.drawFrequency &&\n          this.currentDrawing.getLastPoint().distanceTo(this.worldPosition) >= this.data.minDistanceBetweenPoints\n        ) {\n          this._getNormal(this.normal, this.worldPosition, this.direction);\n          this.currentDrawing.draw(this.worldPosition, this.direction, this.normal, this.data.color, this.data.radius);\n        }\n\n        this.timeSinceLastDraw = time % this.data.drawFrequency;\n      }\n\n      if (this.currentDrawing && !this.grabberId) {\n        this._endDraw();\n      }\n\n      if (this.dirty) {\n        this.populateEntities(this.targets);\n        this.dirty = false;\n      }\n\n      this.el.object3D.matrixNeedsUpdate = true;\n    };\n  })(),\n\n  _setPenVisible(visible) {\n    if (this.el.parentEl.object3DMap.mesh && this.el.parentEl.object3DMap.mesh.visible !== visible) {\n      this.el.parentEl.object3DMap.mesh.visible = visible;\n    }\n  },\n\n  _setLineVisible(visible) {\n    if (this.line.material.visible !== visible) {\n      this.line.material.visible = visible;\n    }\n  },\n\n  //helper function to get normal of direction of drawing cross direction to camera\n  _getNormal: (() => {\n    const directionToCamera = new THREE.Vector3();\n    return function(normal, position, direction) {\n      directionToCamera.subVectors(position, this.data.camera.object3D.position).normalize();\n      normal.crossVectors(direction, directionToCamera);\n    };\n  })(),\n\n  _startDraw() {\n    this.currentDrawing = this.drawingManager.getDrawing(this);\n    if (this.currentDrawing) {\n      this._getNormal(this.normal, this.worldPosition, this.direction);\n      this.currentDrawing.startDraw(this.worldPosition, this.direction, this.normal, this.data.color, this.data.radius);\n    }\n  },\n\n  _endDraw() {\n    if (this.currentDrawing) {\n      this.timeSinceLastDraw = 0;\n      this._getNormal(this.normal, this.worldPosition, this.direction);\n      this.currentDrawing.endDraw(this.worldPosition, this.direction, this.normal);\n      this.drawingManager.returnDrawing(this);\n      this.currentDrawing = null;\n    }\n  },\n\n  _undoDraw() {\n    const drawing = this.drawingManager.getDrawing(this);\n    if (drawing) {\n      drawing.undoDraw();\n      this.drawingManager.returnDrawing(this);\n    }\n  },\n\n  _changeColor(mod) {\n    this.colorIndex = (this.colorIndex + mod + this.data.availableColors.length) % this.data.availableColors.length;\n    this.data.color = this.data.availableColors[this.colorIndex];\n    this.penTip.material.color.set(this.data.color);\n    this.line.material.color.set(this.data.color);\n  },\n\n  _changeRadius(mod) {\n    this.data.radius = Math.max(this.data.minRadius, Math.min(this.data.radius + mod, this.data.maxRadius));\n    this.penTip.scale.setScalar(this.data.radius / this.el.parentEl.object3D.scale.x);\n    this.penTip.matrixNeedsUpdate = true;\n  },\n\n  setDirty() {\n    this.dirty = true;\n  },\n\n  populateEntities(targets) {\n    targets.length = 0;\n    // TODO: Do not querySelectorAll on the entire scene every time anything changes!\n    const els = AFRAME.scenes[0].querySelectorAll(\".collidable, .interactable, #environment-root\");\n    for (let i = 0; i < els.length; i++) {\n      if (!els[i].classList.contains(\"pen\") && els[i].object3D) {\n        targets.push(els[i].object3D);\n      }\n    }\n  },\n\n  remove() {\n    this.observer.disconnect();\n    AFRAME.scenes[0].removeEventListener(\"object3dset\", this.setDirty);\n    AFRAME.scenes[0].removeEventListener(\"object3dremove\", this.setDirty);\n    this.el.parentEl.removeObject3D(\"penline\");\n  }\n});\n","export default class SharedBufferGeometry {\n  constructor(material, primitiveMode, maxBufferSize) {\n    this.material = material;\n    this.primitiveMode = primitiveMode;\n\n    this.maxBufferSize = maxBufferSize;\n    this.geometries = [];\n    this.current = null;\n    this.drawing = new THREE.Object3D();\n    this.addBuffer();\n  }\n\n  restartPrimitive() {\n    if (this.idx.position >= this.current.attributes.position.count) {\n      console.error(\"maxBufferSize limit exceeded\");\n    } else if (this.idx.position !== 0) {\n      let prev = (this.idx.position - 1) * 3;\n      const position = this.current.attributes.position.array;\n      this.addVertex(position[prev++], position[prev++], position[prev++]);\n\n      this.idx.color++;\n      this.idx.normal++;\n    }\n  }\n\n  remove(prevIdx, idx) {\n    // Loop through all the attributes: position, color, normal,...\n    if (this.idx.position > idx.position) {\n      for (const key in this.idx) {\n        const componentSize = 3;\n        let pos = prevIdx[key] * componentSize;\n        const start = (idx[key] + 1) * componentSize;\n        const end = this.idx[key] * componentSize;\n        for (let i = start; i < end; i++) {\n          this.current.attributes[key].array[pos++] = this.current.attributes[key].array[i];\n        }\n        const diff = idx[key] - prevIdx[key] + 1;\n        this.idx[key] -= diff;\n      }\n    } else {\n      for (const key in this.idx) {\n        const diff = idx[key] - prevIdx[key];\n        this.idx[key] -= diff;\n      }\n    }\n\n    this.update();\n  }\n\n  undo(prevIdx) {\n    this.idx = prevIdx;\n    this.update();\n  }\n\n  addBuffer() {\n    const geometry = new THREE.BufferGeometry();\n\n    const vertices = new Float32Array(this.maxBufferSize * 3);\n    const normals = new Float32Array(this.maxBufferSize * 3);\n    const colors = new Float32Array(this.maxBufferSize * 3);\n\n    const mesh = new THREE.Mesh(geometry, this.material);\n\n    mesh.drawMode = this.primitiveMode;\n\n    mesh.frustumCulled = false;\n    mesh.vertices = vertices;\n\n    const object3D = new THREE.Object3D();\n    this.drawing.add(object3D);\n    object3D.add(mesh);\n\n    geometry.setDrawRange(0, 0);\n    geometry.addAttribute(\"position\", new THREE.BufferAttribute(vertices, 3).setDynamic(true));\n    geometry.addAttribute(\"normal\", new THREE.BufferAttribute(normals, 3).setDynamic(true));\n    geometry.addAttribute(\"color\", new THREE.BufferAttribute(colors, 3).setDynamic(true));\n\n    this.previous = null;\n    if (this.geometries.length > 0) {\n      this.previous = this.current;\n    }\n\n    this.idx = {\n      position: 0,\n      normal: 0,\n      color: 0\n    };\n\n    this.geometries.push(geometry);\n    this.current = geometry;\n  }\n\n  addColor(r, g, b) {\n    this.current.attributes.color.setXYZ(this.idx.color++, r, g, b);\n  }\n\n  addNormal(x, y, z) {\n    this.current.attributes.normal.setXYZ(this.idx.normal++, x, y, z);\n  }\n\n  addVertex(x, y, z) {\n    const buffer = this.current.attributes.position;\n    if (this.idx.position === buffer.count) {\n      console.error(\"maxBufferSize limit exceeded\");\n    }\n    buffer.setXYZ(this.idx.position++, x, y, z);\n  }\n\n  update() {\n    this.current.setDrawRange(0, this.idx.position);\n\n    this.current.attributes.color.needsUpdate = true;\n    this.current.attributes.normal.needsUpdate = true;\n    this.current.attributes.position.needsUpdate = true;\n  }\n}\n","import SharedBufferGeometry from \"./sharedbuffergeometry\";\n\nexport default class SharedBufferGeometryManager {\n  constructor() {\n    this.sharedBuffers = {};\n  }\n\n  addSharedBuffer(name, material, primitiveMode, maxBufferSize) {\n    this.sharedBuffers[name] = new SharedBufferGeometry(material, primitiveMode, maxBufferSize);\n  }\n\n  getSharedBuffer(name) {\n    return this.sharedBuffers[name];\n  }\n}\n","/* global THREE */\n/**\n * Networked Drawing\n * Creates procedurally generated 'lines' (or tubes) that are networked.\n * @namespace drawing\n * @component networked-drawing\n */\n\nimport SharedBufferGeometryManager from \"../../utils/sharedbuffergeometrymanager\";\nimport MobileStandardMaterial from \"../../materials/MobileStandardMaterial\";\n\nconst MSG_CONFIRM_CONNECT = 0;\nconst MSG_BUFFER_DATA = 1;\nconst MSG_BUFFER_DATA_FULL = 2;\n\nfunction copyData(fromArray, toArray, fromIndex, toIndex) {\n  let i = fromIndex - 1;\n  let j = -1;\n  while (i + 1 <= toIndex) {\n    toArray[++j] = fromArray[++i];\n  }\n}\n\nAFRAME.registerComponent(\"networked-drawing\", {\n  schema: {\n    segments: { default: 8 }, //the number of \"sides\" the procedural tube should have\n    defaultRadius: { default: 0.01 }, //the radius of the procedural tube\n    maxDrawTimeout: { default: 600000 }, //the maximum time a drawn line will live\n    maxLines: { default: 50 }, //how many lines can persist before lines older than minDrawTime are removed\n    maxPointsPerLine: { default: 250 } //the max number of points a single line can have\n  },\n\n  init() {\n    this._receiveData = this._receiveData.bind(this);\n\n    this.networkBuffer = [];\n\n    this.sendNetworkBufferQueue = [];\n\n    this.drawStarted = false;\n    this.lineStarted = false;\n    this.remoteLineStarted = false;\n\n    this.receivedBufferParts = 0;\n    this.bufferIndex = 0;\n    this.connectedToOwner = false;\n    this.networkBufferInitialized = false;\n\n    const options = {\n      vertexColors: THREE.VertexColors\n    };\n\n    this.color = new THREE.Color();\n    this.radius = this.data.defaultRadius;\n    this.segments = this.data.segments;\n\n    let material = new THREE.MeshStandardMaterial(options);\n    if (window.APP && window.APP.quality === \"low\") {\n      material = MobileStandardMaterial.fromStandardMaterial(material);\n    }\n\n    this.sharedBufferGeometryManager = new SharedBufferGeometryManager();\n    // NOTE: 20 is approximate for how many floats per point are added.\n    // maxLines + 1 because a line can be currently drawing while at maxLines.\n    // Multiply by 1/3 (0.333) because 3 floats per vertex (x, y, z).\n    const maxBufferSize = Math.round(this.data.maxPointsPerLine * 20 * (this.data.maxLines + 1) * 0.333);\n    this.sharedBufferGeometryManager.addSharedBuffer(0, material, THREE.TriangleStripDrawMode, maxBufferSize);\n\n    this.lastPoint = new THREE.Vector3();\n\n    this.lastSegments = [];\n    this.currentSegments = [];\n    for (let x = 0; x < this.segments; x++) {\n      this.lastSegments[x] = {\n        position: new THREE.Vector3(),\n        normal: new THREE.Vector3()\n      };\n      this.currentSegments[x] = {\n        position: new THREE.Vector3(),\n        normal: new THREE.Vector3()\n      };\n    }\n\n    this.sharedBuffer = this.sharedBufferGeometryManager.getSharedBuffer(0);\n    this.drawing = this.sharedBuffer.drawing;\n    const sceneEl = document.querySelector(\"a-scene\");\n    this.scene = sceneEl.object3D;\n    this.scene.add(this.drawing);\n\n    const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\n    if (environmentMapComponent) {\n      environmentMapComponent.applyEnvironmentMap(this.drawing);\n    }\n\n    this.prevIdx = Object.assign({}, this.sharedBuffer.idx);\n    this.idx = Object.assign({}, this.sharedBuffer.idx);\n    this.vertexCount = 0; //number of vertices added for current line (used for line deletion).\n    this.networkBufferCount = 0; //number of items added to networkBuffer for current line (used for line deletion).\n    this.currentPointCount = 0; //number of points added for current line (used for maxPointsPerLine).\n    this.invalidPointRead = false; //flag flipped if we read a bad point anywhere during this line\n    this.lastReadPointCount = 0; //last read point count read off of the network, used for sanity checking\n    this.networkBufferHistory = []; //tracks vertexCount and networkBufferCount so that lines can be deleted.\n\n    NAF.connection.onConnect(() => {\n      NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n        this.networkedEl = networkedEl;\n        this.networkId = NAF.utils.getNetworkId(this.networkedEl);\n        this.drawingId = \"drawing-\" + this.networkId;\n        NAF.connection.subscribeToDataChannel(this.drawingId, this._receiveData);\n      });\n    });\n  },\n\n  remove() {\n    NAF.connection.unsubscribeToDataChannel(this.drawingId, this._receiveData);\n\n    this.scene.remove(this.drawing);\n  },\n\n  tick(t) {\n    const connected = NAF.connection.isConnected() && this.networkedEl;\n    const isMine = connected && NAF.utils.isMine(this.networkedEl);\n\n    if (!this.connectedToOwner && connected) {\n      const owner = NAF.utils.getNetworkOwner(this.networkedEl);\n      if (!isMine && NAF.connection.hasActiveDataChannel(owner)) {\n        NAF.connection.sendDataGuaranteed(owner, this.drawingId, {\n          type: MSG_CONFIRM_CONNECT,\n          clientId: NAF.clientId\n        });\n        this.connectedToOwner = true;\n      }\n    }\n\n    if (this.networkBuffer.length > 0 && connected) {\n      if (!isMine) {\n        this._drawFromNetwork();\n      } else if (this.bufferIndex < this.networkBuffer.length) {\n        this._broadcastDrawing();\n      }\n    }\n\n    //TODO: handle possibility that a clientId gets stuck in sendNetworkBufferQueue\n    //if that client disconnects before this executes and an activeDataChannel is opened.\n    if (isMine && this.sendNetworkBufferQueue.length > 0) {\n      const connected = [];\n      for (let i = 0; i < this.sendNetworkBufferQueue.length; i++) {\n        if (NAF.connection.hasActiveDataChannel(this.sendNetworkBufferQueue[i])) {\n          connected.push(this.sendNetworkBufferQueue[i]);\n        }\n      }\n      for (let j = 0; j < connected.length; j++) {\n        const pos = this.sendNetworkBufferQueue.indexOf(connected[j]);\n        this._sendNetworkBuffer(connected[j]);\n        this.sendNetworkBufferQueue.splice(pos, 1);\n      }\n    }\n\n    this._deleteExpiredLines(t);\n  },\n\n  _broadcastDrawing: (() => {\n    const copyArray = [];\n    return function() {\n      copyArray.length = 0;\n      copyData(this.networkBuffer, copyArray, this.bufferIndex, this.networkBuffer.length - 1);\n\n      //remove undo's from networkBuffer after they've been sent so that\n      //newly joining clients don't get them\n      let index = -1;\n      while ((index = this.networkBuffer.indexOf(\"-\")) != -1) {\n        this.networkBuffer.splice(index, 1);\n      }\n      this.bufferIndex = this.networkBuffer.length;\n      NAF.connection.broadcastDataGuaranteed(this.drawingId, { type: MSG_BUFFER_DATA, buffer: copyArray });\n    };\n  })(),\n\n  _drawFromNetwork: (() => {\n    const position = new THREE.Vector3();\n    const direction = new THREE.Vector3();\n    const normal = new THREE.Vector3();\n    return function() {\n      let head = this.networkBuffer[0];\n      if (head === \"-\") {\n        this._undoDraw();\n        this.networkBuffer.shift();\n        head = this.networkBuffer[0];\n      }\n      let didWork = false;\n      while (head != null && this.networkBuffer.length >= 11) {\n        const pointCount = this.networkBuffer[0];\n\n        // This is a sanity check against the sequence number to help uncover remaining bugs.\n        // If the point is out-of-order, report the error and stop drawing this line.\n        if (pointCount !== this.lastReadPointCount + 1) {\n          this.invalidPointRead = true;\n\n          console.error(\n            `Draw networking error: ID ${this.drawingId} expected point ${this.lastReadPointCount +\n              1} but received ${pointCount}`\n          );\n        }\n\n        this.lastReadPointCount = pointCount;\n        position.set(this.networkBuffer[1], this.networkBuffer[2], this.networkBuffer[3]);\n        direction.set(this.networkBuffer[4], this.networkBuffer[5], this.networkBuffer[6]);\n        this.radius = Math.round(direction.length() * 1000) / 1000; //radius is encoded as length of direction vector\n        direction.normalize();\n        normal.set(this.networkBuffer[7], this.networkBuffer[8], this.networkBuffer[9]);\n        this.color.setHex(Math.round(normal.length()) - 1); //color is encoded as length of normal vector\n        normal.normalize();\n\n        this.networkBuffer.splice(0, 10);\n\n        if (!this.remoteLineStarted) {\n          this.startDraw(position, direction, normal);\n          this.remoteLineStarted = true;\n        }\n\n        if (this.networkBuffer[0] === null) {\n          if (!this.invalidPointRead) {\n            this._endDraw(position, direction, normal);\n          }\n\n          this.remoteLineStarted = false;\n          this.networkBuffer.shift();\n          this.lastReadPointCount = 0;\n          this.invalidPointRead = false;\n        } else {\n          if (!this.invalidPointRead) {\n            this._draw(position, direction, normal);\n            didWork = true;\n          }\n        }\n      }\n      if (didWork) this._updateBuffer();\n    };\n  })(),\n\n  _deleteExpiredLines(time) {\n    const length = this.networkBufferHistory.length;\n    if (length > 0) {\n      const drawTime = this.networkBufferHistory[0].time;\n      if (length > this.data.maxLines || drawTime + this.data.maxDrawTimeout <= time) {\n        const datum = this.networkBufferHistory[0];\n        if (length > 1) {\n          datum.idxLength += 2 - (this.segments % 2); //account for extra verts added for degenerate triangles\n          this.networkBufferHistory[1].idxLength -= 2 - (this.segments % 2);\n        }\n        this.idx.position = datum.idxLength;\n        this.idx.uv = datum.idxLength;\n        this.idx.normal = datum.idxLength;\n        this.idx.color = datum.idxLength;\n        this.sharedBuffer.remove(this.prevIdx, this.idx);\n        this.networkBufferHistory.shift();\n        if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n          this.networkBuffer.splice(0, datum.networkBufferCount);\n          this.bufferIndex -= datum.networkBufferCount;\n        }\n      }\n    }\n  },\n\n  _sendNetworkBuffer: (() => {\n    const copyArray = [];\n    //This number needs to be approx. < ~6000 based on napkin math\n    //see: https://github.com/webrtc/adapter/blob/682e0f2439e139da6c0c406370eae820637b8sc1a/src/js/common_shim.js#L157\n    const chunkAmount = 3000;\n    return function(clientId) {\n      if (NAF.utils.isMine(this.networkedEl)) {\n        if (this.networkBuffer.length <= chunkAmount) {\n          NAF.connection.sendDataGuaranteed(clientId, this.drawingId, {\n            type: MSG_BUFFER_DATA_FULL,\n            parts: 1,\n            buffer: this.networkBuffer\n          });\n        } else {\n          let start = 0;\n          let end = 0;\n          while (end < this.networkBuffer.length) {\n            end = Math.min(end + chunkAmount, this.networkBuffer.length);\n            copyArray.length = 0;\n            copyData(this.networkBuffer, copyArray, start, end - 1);\n            start = end;\n            NAF.connection.sendDataGuaranteed(clientId, this.drawingId, {\n              type: MSG_BUFFER_DATA_FULL,\n              parts: Math.ceil(this.networkBuffer.length / chunkAmount),\n              buffer: copyArray\n            });\n          }\n        }\n      }\n    };\n  })(),\n\n  _receiveData(_, dataType, data) {\n    switch (data.type) {\n      case MSG_CONFIRM_CONNECT:\n        this.sendNetworkBufferQueue.push(data.clientId);\n        break;\n      case MSG_BUFFER_DATA:\n        if (this.networkBufferInitialized) {\n          this.networkBuffer.push.apply(this.networkBuffer, data.buffer);\n        }\n        break;\n      case MSG_BUFFER_DATA_FULL:\n        this.networkBuffer.push.apply(this.networkBuffer, data.buffer);\n        if (++this.receivedBufferParts >= data.parts) {\n          this.networkBufferInitialized = true;\n        }\n        break;\n    }\n  },\n\n  getLastPoint() {\n    return this.lastPoint;\n  },\n\n  startDraw(position, direction, normal, color, radius) {\n    if (!NAF.connection.isConnected()) {\n      return;\n    }\n\n    this.drawStarted = true;\n\n    if (color) {\n      this.color.set(color);\n    }\n    if (radius) this.radius = radius;\n\n    this.lastPoint.copy(position);\n    this._addToNetworkBuffer(position, direction, normal);\n  },\n\n  draw(position, direction, normal, color, radius) {\n    if (!NAF.connection.isConnected() || !this.drawStarted) {\n      return;\n    }\n\n    if (color && color != \"#\" + this.color.getHexString().toUpperCase()) {\n      this.color.set(color);\n    }\n    if (radius) this.radius = radius;\n\n    this._addToNetworkBuffer(position, direction, normal);\n    this._draw(position, direction, normal);\n\n    this._updateBuffer();\n  },\n\n  _draw: (() => {\n    const capNormal = new THREE.Vector3();\n    return function(position, direction, normal, radiusMultiplier = 1.0) {\n      if (!this.lineStarted) {\n        this._generateSegments(this.lastSegments, position, direction, normal, this.radius * radiusMultiplier);\n\n        if (this.networkBufferHistory.length === 0) {\n          //start with CW faceculling order\n          this._addDegenerateTriangle();\n        } else {\n          //only do the following if the sharedBuffer is not empty\n          this._restartPrimitive();\n          this._addDegenerateTriangle();\n          if (this.segments % 2 === 0) {\n            //flip faceculling order if even numbered segments\n            this._addDegenerateTriangle();\n          }\n        }\n\n        //get normal for tip of cap\n        capNormal.copy(direction).negate();\n        //get normals for rim of cap\n        for (let i = 0; i < this.segments; i++) {\n          this.lastSegments[i].normal.add(capNormal).multiplyScalar(0.5);\n        }\n\n        this._drawCap(this.lastPoint, this.lastSegments, capNormal);\n        if (this.segments % 2 !== 0) {\n          //flip faceculling order if odd numbered segments\n          this._addDegenerateTriangle();\n        }\n\n        this.lineStarted = true;\n      } else {\n        this._generateSegments(this.currentSegments, position, direction, normal, this.radius * radiusMultiplier);\n        this._drawCylinder();\n\n        if (this.currentPointCount > this.data.maxPointsPerLine) {\n          this._drawEndCap(position, direction);\n          this._endLine();\n        }\n      }\n      this.lastPoint.copy(position);\n    };\n  })(),\n\n  undoDraw() {\n    if (!NAF.connection.isConnected() || this.drawStarted) {\n      return;\n    }\n    this._undoDraw();\n    this._pushToNetworkBuffer(\"-\");\n  },\n\n  _undoDraw() {\n    const length = this.networkBufferHistory.length;\n    if (length > 0) {\n      const datum = this.networkBufferHistory.pop();\n      this.idx.position = 0;\n      this.idx.uv = 0;\n      this.idx.normal = 0;\n      this.idx.color = 0;\n      if (length > 1) {\n        datum.idxLength += 1 - (this.segments % 2); //account for extra verts added for degenerate triangles\n        this.idx.position = this.sharedBuffer.idx.position - datum.idxLength;\n        this.idx.uv = this.sharedBuffer.idx.uv - datum.idxLength;\n        this.idx.normal = this.sharedBuffer.idx.normal - datum.idxLength;\n        this.idx.color = this.sharedBuffer.idx.color - datum.idxLength;\n      }\n      this.sharedBuffer.remove(this.idx, this.sharedBuffer.idx);\n      if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n        this.networkBuffer.splice(this.networkBuffer.length - datum.networkBufferCount, datum.networkBufferCount);\n        this.bufferIndex -= datum.networkBufferCount;\n      }\n    }\n  },\n\n  endDraw(position, direction, normal) {\n    this._endDraw(position, direction, normal);\n    this._updateBuffer();\n  },\n\n  _endDraw(position, direction, normal) {\n    if (!this.lineStarted && this.drawStarted) {\n      this._drawPoint(position);\n    } else if (this.lineStarted && this.drawStarted) {\n      this._addToNetworkBuffer(position, direction, normal);\n      this._draw(position, direction, normal);\n      this._drawEndCap(position, direction);\n    }\n    this._endLine();\n  },\n\n  _drawEndCap: (() => {\n    const projectedDirection = new THREE.Vector3();\n    const projectedPoint = new THREE.Vector3();\n    return function(position, direction) {\n      if (this.lineStarted && this.drawStarted) {\n        projectedDirection.copy(direction).multiplyScalar(this.radius);\n        projectedPoint.copy(position).add(projectedDirection);\n        this._addDegenerateTriangle(); //flip faceculling order before drawing end-cap\n        this._drawCap(projectedPoint, this.lastSegments, direction);\n      }\n    };\n  })(),\n\n  _endLine() {\n    if (!this.drawStarted) return;\n\n    if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) this._pushToNetworkBuffer(null);\n\n    const datum = {\n      networkBufferCount: this.networkBufferCount,\n      idxLength: this.vertexCount - 1,\n      time: this.el.sceneEl.clock.elapsedTime * 1000\n    };\n    this.networkBufferHistory.push(datum);\n    this.vertexCount = 0;\n    this.networkBufferCount = 0;\n    this.currentPointCount = 0;\n    this.lineStarted = false;\n    this.drawStarted = false;\n  },\n\n  _addToNetworkBuffer: (() => {\n    const copyDirection = new THREE.Vector3();\n    const copyNormal = new THREE.Vector3();\n    return function(position, direction, normal) {\n      if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n        ++this.currentPointCount;\n        this._pushToNetworkBuffer(this.currentPointCount);\n        this._pushToNetworkBuffer(position.x);\n        this._pushToNetworkBuffer(position.y);\n        this._pushToNetworkBuffer(position.z);\n        copyDirection.copy(direction);\n        copyDirection.setLength(this.radius); //encode radius as length of direction vector\n        this._pushToNetworkBuffer(copyDirection.x);\n        this._pushToNetworkBuffer(copyDirection.y);\n        this._pushToNetworkBuffer(copyDirection.z);\n        copyNormal.copy(normal);\n        copyNormal.setLength(this.color.getHex() + 1); //encode color as length, add one in case color is black\n        this._pushToNetworkBuffer(copyNormal.x);\n        this._pushToNetworkBuffer(copyNormal.y);\n        this._pushToNetworkBuffer(copyNormal.z);\n      }\n    };\n  })(),\n\n  _pushToNetworkBuffer(val) {\n    //don't increment networkBufferCount if undo, because the undo character\n    //will be removed in tick() on the next frame\n    if (val !== \"-\") {\n      ++this.networkBufferCount;\n    }\n    this.networkBuffer.push(val);\n  },\n\n  //draw a cylinder from last to current segments\n  _drawCylinder() {\n    //average the normals with the normals from the lastSegment\n    //not a perfect normal calculation, but works well enough\n    for (let i = 0; i < this.segments; i++) {\n      this.currentSegments[i].normal.add(this.lastSegments[i].normal).multiplyScalar(0.5);\n    }\n\n    for (let i = 0; i != this.segments + 1; i++) {\n      this._addVertex(this.lastSegments[i % this.segments]);\n      this._addVertex(this.currentSegments[i % this.segments]);\n    }\n\n    for (let i = 0; i < this.segments; i++) {\n      this.lastSegments[i].position.copy(this.currentSegments[i].position);\n      this.lastSegments[i].normal.copy(this.currentSegments[i].normal);\n    }\n  },\n\n  //draw a standalone point in space\n  _drawPoint: (() => {\n    const up = new THREE.Vector3(0, 1, 0);\n    const down = new THREE.Vector3(0, -1, 0);\n    const left = new THREE.Vector3(1, 0, 0);\n    const projectedDirection = new THREE.Vector3();\n    const projectedPoint = new THREE.Vector3();\n    return function(position) {\n      projectedDirection.copy(up).multiplyScalar(this.radius * 0.75);\n      projectedPoint.copy(position).add(projectedDirection);\n      this.lastPoint.copy(projectedPoint);\n\n      projectedDirection.copy(up).multiplyScalar(this.radius * 0.5);\n      projectedPoint.copy(position).add(projectedDirection);\n      this._draw(projectedPoint, down, left, 0.75);\n\n      this._draw(position, down, left);\n\n      projectedDirection.copy(down).multiplyScalar(this.radius * 0.5);\n      projectedPoint.copy(position).add(projectedDirection);\n      this._draw(projectedPoint, down, left, 0.75);\n\n      projectedDirection.copy(down).multiplyScalar(this.radius * 0.75);\n      projectedPoint.copy(position).add(projectedDirection);\n\n      this._addDegenerateTriangle(); //discarded\n      this._drawCap(projectedPoint, this.lastSegments, down);\n    };\n  })(),\n\n  //draw a cap to start/end a line\n  _drawCap(point, segments, normal) {\n    let segmentIndex = 0;\n    for (let i = 0; i < this.segments * 2 - (this.segments % 2); i++) {\n      if ((i - 2) % 4 === 0) {\n        this._addVertex({ position: point, normal: normal });\n      } else {\n        this._addVertex(segments[segmentIndex % this.segments]);\n        if ((i + 1) % 5 !== 0) {\n          ++segmentIndex;\n        }\n      }\n    }\n  },\n\n  _restartPrimitive() {\n    this.sharedBuffer.restartPrimitive();\n    ++this.vertexCount;\n  },\n\n  _updateBuffer() {\n    this.sharedBuffer.update();\n  },\n\n  _addVertex(segment) {\n    const point = segment.position;\n    const normal = segment.normal;\n    this.sharedBuffer.addVertex(point.x, point.y, point.z);\n    this.sharedBuffer.addColor(this.color.r, this.color.g, this.color.b);\n\n    if (normal) {\n      this.sharedBuffer.addNormal(normal.x, normal.y, normal.z);\n    } else {\n      ++this.sharedBuffer.idx.normal;\n    }\n\n    ++this.sharedBuffer.idx.uv;\n    ++this.vertexCount;\n  },\n\n  _addDegenerateTriangle() {\n    this._addVertex(this.lastSegments[0]);\n  },\n\n  //calculate the segments for a given point\n  _generateSegments(segmentsList, point, forward, up, radius) {\n    const angleIncrement = (Math.PI * 2) / this.segments;\n    for (let i = 0; i < this.segments; i++) {\n      const segment = segmentsList[i].position;\n      this._rotatePointAroundAxis(segment, point, forward, up, angleIncrement * i, radius);\n      segmentsList[i].normal.subVectors(segment, point).normalize();\n    }\n  },\n\n  _rotatePointAroundAxis: (() => {\n    const calculatedDirection = new THREE.Vector3();\n    return function(out, point, axis, up, angle, radius) {\n      calculatedDirection.copy(up);\n      calculatedDirection.applyAxisAngle(axis, angle);\n      out.copy(point).add(calculatedDirection.normalize().multiplyScalar(radius));\n    };\n  })()\n});\n","function registerNetworkSchemas() {\n  const vectorRequiresUpdate = epsilon => {\n    return () => {\n      let prev = null;\n\n      return curr => {\n        if (prev === null) {\n          prev = new THREE.Vector3(curr.x, curr.y, curr.z);\n          return true;\n        } else if (!NAF.utils.almostEqualVec3(prev, curr, epsilon)) {\n          prev.copy(curr);\n          return true;\n        }\n\n        return false;\n      };\n    };\n  };\n\n  // Note: networked template ids are semantically important. We use the template suffix as a filter\n  // for allowing and authorizing messages in reticulum.\n  // See `spawn_permitted?` in https://github.com/mozilla/reticulum/blob/master/lib/ret_web/channels/hub_channel.ex\n\n  // NAF schemas have been extended with a custom nonAuthorizedComponents property that is used to skip authorization\n  // on certain components and properties regardless of hub or user permissions. See permissions-utils.js.\n\n  NAF.schemas.add({\n    template: \"#remote-avatar\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      \"scale\",\n      \"player-info\",\n      \"networked-avatar\",\n      {\n        selector: \".camera\",\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        selector: \".camera\",\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        selector: \".left-controller\",\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        selector: \".left-controller\",\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        selector: \".left-controller\",\n        component: \"visible\"\n      },\n      {\n        selector: \".right-controller\",\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        selector: \".right-controller\",\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        selector: \".right-controller\",\n        component: \"visible\"\n      }\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#interactable-media\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      \"scale\",\n      // TODO: Optimize checking mediaOptions with requiresNetworkUpdate.\n      \"media-loader\",\n      {\n        component: \"media-video\",\n        property: \"time\"\n      },\n      {\n        component: \"media-video\",\n        property: \"videoPaused\"\n      },\n      {\n        component: \"media-pdf\",\n        property: \"index\"\n      },\n      \"pinnable\"\n    ],\n    nonAuthorizedComponents: [\n      {\n        component: \"media-video\",\n        property: \"time\"\n      },\n      {\n        component: \"media-video\",\n        property: \"videoPaused\"\n      },\n      {\n        component: \"media-pager\",\n        property: \"index\"\n      }\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#static-media\",\n    components: [\n      // TODO: Optimize checking mediaOptions with requiresNetworkUpdate.\n      \"media-loader\",\n      {\n        component: \"media-video\",\n        property: \"time\"\n      }\n    ],\n    nonAuthorizedComponents: [\n      {\n        component: \"media-video\",\n        property: \"time\"\n      }\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#static-controlled-media\",\n    components: [\n      // TODO: Optimize checking mediaOptions with requiresNetworkUpdate.\n      \"media-loader\",\n      {\n        component: \"media-video\",\n        property: \"time\"\n      },\n      {\n        component: \"media-video\",\n        property: \"videoPaused\"\n      },\n      {\n        component: \"media-pdf\",\n        property: \"index\"\n      }\n    ],\n    nonAuthorizedComponents: [\n      {\n        component: \"media-video\",\n        property: \"time\"\n      },\n      {\n        component: \"media-video\",\n        property: \"videoPaused\"\n      },\n      {\n        component: \"media-pager\",\n        property: \"index\"\n      }\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#interactable-drawing\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      \"scale\",\n      \"networked-drawing\"\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#interactable-camera\",\n    components: [\n      \"position\",\n      \"rotation\",\n      {\n        component: \"camera-tool\",\n        property: \"isSnapping\"\n      },\n      {\n        component: \"camera-tool\",\n        property: \"isRecording\"\n      },\n      {\n        component: \"camera-tool\",\n        property: \"label\"\n      }\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#interactable-pen\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      \"scale\",\n      {\n        selector: \"#pen\",\n        component: \"pen\",\n        property: \"radius\"\n      },\n      {\n        selector: \"#pen\",\n        component: \"pen\",\n        property: \"color\"\n      }\n    ]\n  });\n}\n\nexport default registerNetworkSchemas;\n","import \"@babel/polyfill\";\nimport \"./utils/debug-log\";\n\nconsole.log(`Hubs version: ${process.env.BUILD_VERSION || \"?\"}`);\n\nimport \"./assets/stylesheets/hub.scss\";\n\nimport \"aframe\";\nimport \"./utils/logging\";\nimport { patchWebGLRenderingContext } from \"./utils/webgl\";\npatchWebGLRenderingContext();\n\nimport \"three/examples/js/loaders/GLTFLoader\";\nimport \"networked-aframe/src/index\";\nimport \"naf-janus-adapter\";\nimport \"aframe-rounded\";\nimport \"webrtc-adapter\";\nimport \"aframe-slice9-component\";\nimport \"./utils/audio-context-fix\";\nimport \"./utils/threejs-positional-audio-updatematrixworld\";\nimport \"./utils/threejs-world-update\";\nimport patchThreeAllocations from \"./utils/threejs-allocation-patches\";\nimport { detectOS, detect } from \"detect-browser\";\nimport {\n  getReticulumFetchUrl,\n  getReticulumMeta,\n  invalidateReticulumMeta,\n  migrateChannelToSocket\n} from \"./utils/phoenix-utils\";\n\nimport nextTick from \"./utils/next-tick\";\nimport { addAnimationComponents } from \"./utils/animation\";\nimport { authorizeOrSanitizeMessage } from \"./utils/permissions-utils\";\nimport Cookies from \"js-cookie\";\n\nimport \"./components/scene-components\";\nimport \"./components/mute-mic\";\nimport \"./components/toggle-megaphone\";\nimport \"./components/toggle-flying\";\nimport \"./components/bone-mute-state-indicator\";\nimport \"./components/bone-visibility\";\nimport \"./components/in-world-hud\";\nimport \"./components/virtual-gamepad-controls\";\nimport \"./components/ik-controller\";\nimport \"./components/hand-controls2\";\nimport \"./components/character-controller\";\nimport \"./components/hoverable-visuals\";\nimport \"./components/hover-visuals\";\nimport \"./components/offset-relative-to\";\nimport \"./components/player-info\";\nimport \"./components/debug\";\nimport \"./components/hand-poses\";\nimport \"./components/hud-controller\";\nimport \"./components/freeze-controller\";\nimport \"./components/icon-button\";\nimport \"./components/text-button\";\nimport \"./components/block-button\";\nimport \"./components/mute-button\";\nimport \"./components/kick-button\";\nimport \"./components/close-vr-notice-button\";\nimport \"./components/leave-room-button\";\nimport \"./components/visible-if-permitted\";\nimport \"./components/visibility-on-content-type\";\nimport \"./components/hide-when-pinned-and-forbidden\";\nimport \"./components/visibility-while-frozen\";\nimport \"./components/stats-plus\";\nimport \"./components/networked-avatar\";\nimport \"./components/media-views\";\nimport \"./components/avatar-volume-controls\";\nimport \"./components/pinch-to-move\";\nimport \"./components/pitch-yaw-rotator\";\nimport \"./components/position-at-box-shape-border\";\nimport \"./components/pinnable\";\nimport \"./components/pin-networked-object-button\";\nimport \"./components/drop-object-button\";\nimport \"./components/remove-networked-object-button\";\nimport \"./components/camera-focus-button\";\nimport \"./components/unmute-video-button\";\nimport \"./components/destroy-at-extreme-distances\";\nimport \"./components/visible-to-owner\";\nimport \"./components/camera-tool\";\nimport \"./components/emit-state-change\";\nimport \"./components/action-to-event\";\nimport \"./components/action-to-remove\";\nimport \"./components/emit-scene-event-on-remove\";\nimport \"./components/follow-in-fov\";\nimport \"./components/matrix-auto-update\";\nimport \"./components/clone-media-button\";\nimport \"./components/open-media-button\";\nimport \"./components/tweet-media-button\";\nimport \"./components/transform-object-button\";\nimport \"./components/hover-menu\";\nimport \"./components/disable-frustum-culling\";\nimport \"./components/teleporter\";\nimport \"./components/set-active-camera\";\nimport \"./components/track-pose\";\nimport \"./components/replay\";\nimport \"./components/visibility-by-path\";\nimport \"./components/tags\";\nimport \"./components/hubs-text\";\nimport \"./components/billboard\";\nimport \"./components/periodic-full-syncs\";\nimport { sets as userinputSets } from \"./systems/userinput/sets\";\n\nimport ReactDOM from \"react-dom\";\nimport React from \"react\";\nimport { Router, Route } from \"react-router-dom\";\nimport { createBrowserHistory } from \"history\";\nimport { pushHistoryState } from \"./utils/history\";\nimport UIRoot from \"./react-components/ui-root\";\nimport AuthChannel from \"./utils/auth-channel\";\nimport HubChannel from \"./utils/hub-channel\";\nimport LinkChannel from \"./utils/link-channel\";\nimport { connectToReticulum } from \"./utils/phoenix-utils\";\nimport { disableiOSZoom } from \"./utils/disable-ios-zoom\";\nimport { proxiedUrlFor } from \"./utils/media-url-utils\";\nimport { traverseMeshesAndAddShapes } from \"./utils/physics-utils\";\nimport { handleExitTo2DInterstitial, exit2DInterstitialAndEnterVR } from \"./utils/vr-interstitial\";\nimport { getAvatarSrc } from \"./utils/avatar-utils.js\";\nimport MessageDispatch from \"./message-dispatch\";\nimport SceneEntryManager from \"./scene-entry-manager\";\nimport Subscriptions from \"./subscriptions\";\nimport { createInWorldLogMessage } from \"./react-components/chat-message\";\n\nimport \"./systems/nav\";\nimport \"./systems/frame-scheduler\";\nimport \"./systems/personal-space-bubble\";\nimport \"./systems/app-mode\";\nimport \"./systems/permissions\";\nimport \"./systems/exit-on-blur\";\nimport \"./systems/camera-tools\";\nimport \"./systems/userinput/userinput\";\nimport \"./systems/userinput/userinput-debug\";\nimport \"./systems/ui-hotkeys\";\nimport \"./systems/tips\";\nimport \"./systems/interactions\";\nimport \"./systems/hubs-systems\";\nimport \"./systems/capture-system\";\nimport { SOUND_CHAT_MESSAGE } from \"./systems/sound-effects-system\";\n\nimport \"./gltf-component-mappings\";\n\nimport { App } from \"./App\";\n\nwindow.APP = new App();\nwindow.APP.RENDER_ORDER = {\n  HUD_BACKGROUND: 1,\n  HUD_ICONS: 2,\n  CURSOR: 3\n};\nconst store = window.APP.store;\nconst mediaSearchStore = window.APP.mediaSearchStore;\nconst OAUTH_FLOW_PERMS_TOKEN_KEY = \"ret-oauth-flow-perms-token\";\nconst NOISY_OCCUPANT_COUNT = 12; // Above this # of occupants, we stop posting join/leaves/renames\n\nconst qs = new URLSearchParams(location.search);\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\nconst isEmbed = window.self !== window.top;\nif (isEmbed && !qs.get(\"embed_token\")) {\n  // Should be covered by X-Frame-Options, but just in case.\n  throw new Error(\"no embed token\");\n}\n\nTHREE.Object3D.DefaultMatrixAutoUpdate = false;\nwindow.APP.quality = qs.get(\"quality\") || (isMobile || isMobileVR) ? \"low\" : \"high\";\n\nconst Ammo = require(\"ammo.js/builds/ammo.wasm.js\");\nconst AmmoWasm = require(\"ammo.js/builds/ammo.wasm.wasm\");\nwindow.Ammo = Ammo.bind(undefined, {\n  locateFile(path) {\n    if (path.endsWith(\".wasm\")) {\n      return AmmoWasm;\n    }\n    return path;\n  }\n});\nrequire(\"aframe-physics-system\");\n\nimport \"./systems/post-physics\";\n\nimport \"./components/owned-object-limiter\";\nimport \"./components/set-unowned-body-kinematic\";\nimport \"./components/scalable-when-grabbed\";\nimport \"./components/networked-counter\";\nimport \"./components/event-repeater\";\nimport \"./components/set-yxz-order\";\n\nimport \"./components/cursor-controller\";\n\nimport \"./components/nav-mesh-helper\";\n\nimport \"./components/tools/pen\";\nimport \"./components/tools/networked-drawing\";\nimport \"./components/tools/drawing-manager\";\n\nimport registerNetworkSchemas from \"./network-schemas\";\nimport registerTelemetry from \"./telemetry\";\nimport { warmSerializeElement } from \"./utils/serialize-element\";\n\nimport { getAvailableVREntryTypes, VR_DEVICE_AVAILABILITY } from \"./utils/vr-caps-detect.js\";\nimport detectConcurrentLoad from \"./utils/concurrent-load-detector.js\";\n\nimport qsTruthy from \"./utils/qs_truthy\";\n\nconst PHOENIX_RELIABLE_NAF = \"phx-reliable\";\nNAF.options.firstSyncSource = PHOENIX_RELIABLE_NAF;\nNAF.options.syncSource = PHOENIX_RELIABLE_NAF;\n\nconst isBotMode = qsTruthy(\"bot\");\nconst isTelemetryDisabled = qsTruthy(\"disable_telemetry\");\nconst isDebug = qsTruthy(\"debug\");\nconst loadingEnvironmentURL = proxiedUrlFor(\n  \"https://uploads-prod.reticulum.io/files/61d77151-7a74-40a6-b427-0c5a350c4502.glb\"\n);\n\nif (!isBotMode && !isTelemetryDisabled) {\n  registerTelemetry(\"/hub\", \"Room Landing Page\");\n}\n\ndisableiOSZoom();\ndetectConcurrentLoad();\n\nstore.init();\n\nfunction getPlatformUnsupportedReason() {\n  if (typeof RTCDataChannelEvent === \"undefined\") return \"no_data_channels\";\n  return null;\n}\n\nfunction setupLobbyCamera() {\n  const camera = document.querySelector(\"#player-camera\");\n  const previewCamera = document.querySelector(\"#environment-scene\").object3D.getObjectByName(\"scene-preview-camera\");\n\n  if (previewCamera) {\n    camera.object3D.position.copy(previewCamera.position);\n    camera.object3D.rotation.copy(previewCamera.rotation);\n    camera.object3D.rotation.reorder(\"YXZ\");\n  } else {\n    const cameraPos = camera.object3D.position;\n    camera.object3D.position.set(cameraPos.x, 2.5, cameraPos.z);\n  }\n\n  camera.object3D.matrixNeedsUpdate = true;\n\n  camera.setAttribute(\"scene-preview-camera\", \"positionOnly: true; duration: 60\");\n  camera.components[\"pitch-yaw-rotator\"].set(camera.object3D.rotation.x, camera.object3D.rotation.y);\n}\n\nlet uiProps = {};\n\n// Hub ID and slug are the basename\nlet routerBaseName = document.location.pathname\n  .split(\"/\")\n  .slice(0, 2)\n  .join(\"/\");\n\nif (document.location.pathname.includes(\"hub.html\")) {\n  routerBaseName = \"\";\n}\n\nconst history = createBrowserHistory({ basename: routerBaseName });\nwindow.APP.history = history;\n\nconst qsVREntryType = qs.get(\"vr_entry_type\");\n\nfunction mountUI(props = {}) {\n  const scene = document.querySelector(\"a-scene\");\n  const disableAutoExitOnConcurrentLoad = qsTruthy(\"allow_multi\");\n  const isCursorHoldingPen = scene && scene.systems.userinput.activeSets.includes(userinputSets.cursorHoldingPen);\n  const hasActiveCamera = scene && !!scene.systems[\"camera-tools\"].getMyCamera();\n  const forcedVREntryType = qsVREntryType;\n\n  ReactDOM.render(\n    <Router history={history}>\n      <Route\n        render={routeProps => (\n          <UIRoot\n            {...{\n              scene,\n              isBotMode,\n              disableAutoExitOnConcurrentLoad,\n              forcedVREntryType,\n              store,\n              mediaSearchStore,\n              isCursorHoldingPen,\n              hasActiveCamera,\n              ...props,\n              ...routeProps\n            }}\n          />\n        )}\n      />\n    </Router>,\n    document.getElementById(\"ui-root\")\n  );\n}\n\nfunction remountUI(props) {\n  uiProps = { ...uiProps, ...props };\n  mountUI(uiProps);\n}\n\nasync function updateUIForHub(hub) {\n  remountUI({\n    hubId: hub.hub_id,\n    hubName: hub.name,\n    hubMemberPermissions: hub.member_permissions,\n    hubScene: hub.scene,\n    hubEntryCode: hub.entry_code\n  });\n}\n\nasync function updateEnvironmentForHub(hub) {\n  let sceneUrl = 'https://www.dropbox.com/s/ayl3t33p2ymnxux/Axon%20Park_Cliffside.glb'\n  let isLegacyBundle; // Deprecated\n\n  const environmentScene = document.querySelector(\"#environment-scene\");\n  const sceneEl = document.querySelector(\"a-scene\");\n\n  if (hub.scene) {\n    isLegacyBundle = false;\n    sceneUrl = hub.scene.model_url;\n  } else if (hub.scene === null) {\n    // delisted/removed scene\n    sceneUrl = loadingEnvironmentURL;\n  } else {\n    const defaultSpaceTopic = hub.topics[0];\n    const glbAsset = defaultSpaceTopic.assets.find(a => a.asset_type === \"glb\");\n    const bundleAsset = defaultSpaceTopic.assets.find(a => a.asset_type === \"gltf_bundle\");\n    sceneUrl = (glbAsset || bundleAsset).src;\n    const hasExtension = /\\.gltf/i.test(sceneUrl) || /\\.glb/i.test(sceneUrl);\n    isLegacyBundle = !(glbAsset || hasExtension);\n  }\n\n  if (isLegacyBundle) {\n    // Deprecated\n    const res = await fetch(sceneUrl);\n    const data = await res.json();\n    const baseURL = new URL(THREE.LoaderUtils.extractUrlBase(sceneUrl), window.location.href);\n    sceneUrl = new URL(data.assets[0].src, baseURL).href;\n  } else {\n    sceneUrl = proxiedUrlFor(sceneUrl);\n  }\n\n  console.log(`Scene URL: ${sceneUrl}`);\n\n  let environmentEl = null;\n\n  if (environmentScene.childNodes.length === 0) {\n    const environmentEl = document.createElement(\"a-entity\");\n    environmentEl.setAttribute(\"gltf-model-plus\", { src: sceneUrl, useCache: false, inflate: true });\n\n    environmentScene.appendChild(environmentEl);\n\n    environmentEl.addEventListener(\n      \"model-loaded\",\n      () => {\n        // Show the canvas once the model has loaded\n        document.querySelector(\".a-canvas\").classList.remove(\"a-hidden\");\n\n        //TODO: check if the environment was made with spoke to determine if a shape should be added\n        traverseMeshesAndAddShapes(environmentEl);\n      },\n      { once: true }\n    );\n  } else {\n    // Change environment\n    environmentEl = environmentScene.childNodes[0];\n\n    // Clear the three.js image cache and load the loading environment before switching to the new one.\n    THREE.Cache.clear();\n\n    environmentEl.addEventListener(\n      \"model-loaded\",\n      () => {\n        environmentEl.addEventListener(\n          \"model-loaded\",\n          () => {\n            traverseMeshesAndAddShapes(environmentEl);\n\n            // We've already entered, so move to new spawn point once new environment is loaded\n            if (sceneEl.is(\"entered\")) {\n              document.querySelector(\"#player-rig\").components[\"spawn-controller\"].moveToSpawnPoint();\n            }\n          },\n          { once: true }\n        );\n\n        environmentEl.setAttribute(\"gltf-model-plus\", { src: sceneUrl });\n      },\n      { once: true }\n    );\n\n    environmentEl.setAttribute(\"gltf-model-plus\", { src: loadingEnvironmentURL });\n  }\n}\n\nfunction handleHubChannelJoined(entryManager, hubChannel, messageDispatch, data) {\n  const scene = document.querySelector(\"a-scene\");\n  const isRejoin = NAF.connection.isConnected();\n\n  if (isRejoin) {\n    // Slight hack, to ensure correct presence state we need to re-send the entry event\n    // on re-join. Ideally this would be updated into the channel socket state but this\n    // would require significant changes to the hub channel events and socket management.\n    if (scene.is(\"entered\")) {\n      hubChannel.sendEntryEvent();\n    }\n\n    // Send complete sync on phoenix re-join.\n    NAF.connection.entities.completeSync(null, true);\n    return;\n  }\n\n  // Turn off NAF for embeds as an optimization, so the user's browser isn't getting slammed\n  // with NAF traffic on load.\n  if (isEmbed) {\n    hubChannel.allowNAFTraffic(false);\n  }\n\n  const hub = data.hubs[0];\n\n  let embedToken = hub.embed_token;\n\n  if (!embedToken) {\n    const embedTokenEntry = store.state.embedTokens && store.state.embedTokens.find(t => t.hubId === hub.hub_id);\n\n    if (embedTokenEntry) {\n      embedToken = embedTokenEntry.embedToken;\n    }\n  }\n\n  console.log(`Janus host: ${hub.host}`);\n\n  remountUI({\n    onSendMessage: messageDispatch.dispatch,\n    onLoaded: () => store.executeOnLoadActions(scene),\n    onMediaSearchResultEntrySelected: entry => scene.emit(\"action_selected_media_result_entry\", entry),\n    onMediaSearchCancelled: entry => scene.emit(\"action_media_search_cancelled\", entry),\n    onAvatarSaved: entry => scene.emit(\"action_avatar_saved\", entry),\n    embedToken: embedToken\n  });\n\n  scene.addEventListener(\"action_selected_media_result_entry\", e => {\n    const entry = e.detail;\n    if (entry.type !== \"scene_listing\" && entry.type !== \"scene\") return;\n    if (!hubChannel.can(\"update_hub\")) return;\n\n    hubChannel.updateScene(entry.url);\n  });\n\n  // Handle request for user gesture\n  scene.addEventListener(\"2d-interstitial-gesture-required\", () => {\n    remountUI({\n      showInterstitialPrompt: true,\n      onInterstitialPromptClicked: () => {\n        scene.emit(\"2d-interstitial-gesture-complete\");\n        remountUI({ showInterstitialPrompt: false, onInterstitialPromptClicked: null });\n      }\n    });\n  });\n\n  const objectsScene = document.querySelector(\"#objects-scene\");\n  const objectsUrl = getReticulumFetchUrl(`/${hub.hub_id}/objects.gltf`);\n  const objectsEl = document.createElement(\"a-entity\");\n  objectsEl.setAttribute(\"gltf-model-plus\", { src: objectsUrl, useCache: false, inflate: true });\n\n  if (!isBotMode) {\n    objectsScene.appendChild(objectsEl);\n  }\n\n  // Wait for scene objects to load before connecting, so there is no race condition on network state.\n  const connectToScene = async () => {\n    scene.setAttribute(\"networked-scene\", {\n      room: hub.hub_id,\n      serverURL: `wss://${hub.host}`,\n      debug: !!isDebug\n    });\n\n    while (!scene.components[\"networked-scene\"] || !scene.components[\"networked-scene\"].data) await nextTick();\n\n    scene.addEventListener(\"adapter-ready\", ({ detail: adapter }) => {\n      let newHostPollInterval = null;\n\n      // When reconnecting, update the server URL if necessary\n      adapter.setReconnectionListeners(\n        () => {\n          if (newHostPollInterval) return;\n\n          newHostPollInterval = setInterval(async () => {\n            const currentServerURL = NAF.connection.adapter.serverUrl;\n            const newHubHost = await hubChannel.getHost();\n            const newServerURL = `wss://${newHubHost}`;\n\n            if (currentServerURL !== newServerURL) {\n              console.log(\"Connecting to new Janus server \" + newServerURL);\n              scene.setAttribute(\"networked-scene\", { serverURL: newServerURL });\n              adapter.serverUrl = newServerURL;\n            }\n          }, 1000);\n        },\n        () => {\n          clearInterval(newHostPollInterval);\n          newHostPollInterval = null;\n        },\n        null\n      );\n\n      const sendViaPhoenix = reliable => (clientId, dataType, data) => {\n        const payload = { dataType, data };\n\n        if (clientId) {\n          payload.clientId = clientId;\n        }\n\n        const isOpen = hubChannel.channel.socket.connectionState() === \"open\";\n\n        if (isOpen || reliable) {\n          if (isOpen) {\n            hubChannel.channel.push(\"naf\", payload);\n          } else {\n            // Memory is re-used, so make a copy\n            hubChannel.channel.push(\"naf\", AFRAME.utils.clone(payload));\n          }\n        }\n      };\n\n      adapter.reliableTransport = sendViaPhoenix(true);\n      adapter.unreliableTransport = sendViaPhoenix(false);\n    });\n\n    const loadEnvironmentAndConnect = () => {\n      updateEnvironmentForHub(hub);\n\n      scene.components[\"networked-scene\"]\n        .connect()\n        .then(() => scene.emit(\"didConnectToNetworkedScene\"))\n        .catch(connectError => {\n          // hacky until we get return codes\n          const isFull = connectError.error && connectError.error.msg.match(/\\bfull\\b/i);\n          console.error(connectError);\n          remountUI({ roomUnavailableReason: isFull ? \"full\" : \"connect_error\" });\n          entryManager.exitScene();\n\n          return;\n        });\n    };\n\n    updateUIForHub(hub);\n\n    if (!isEmbed) {\n      loadEnvironmentAndConnect();\n    } else {\n      remountUI({\n        onPreloadLoadClicked: () => {\n          hubChannel.allowNAFTraffic(true);\n          remountUI({ showPreload: false });\n          loadEnvironmentAndConnect();\n        }\n      });\n    }\n  };\n\n  if (!isBotMode) {\n    objectsEl.addEventListener(\"model-loaded\", async el => {\n      if (el.target !== objectsEl) return;\n      connectToScene();\n    });\n  } else {\n    connectToScene();\n  }\n}\n\nasync function runBotMode(scene, entryManager) {\n  const noop = () => {};\n  scene.renderer = { setAnimationLoop: noop, render: noop };\n\n  while (!NAF.connection.isConnected()) await nextTick();\n  entryManager.enterSceneWhenLoaded(new MediaStream(), false);\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", async () => {\n  const canvas = document.querySelector(\".a-canvas\");\n  canvas.classList.add(\"a-hidden\");\n\n  warmSerializeElement();\n\n  if (!window.WebAssembly) {\n    remountUI({ showWebAssemblyDialog: true });\n    return;\n  }\n\n  // If we are on iOS but we don't have the mediaDevices API, then we are likely in a Firefox or Chrome WebView,\n  // or a WebView preview used in apps like Twitter and Discord. So we show the dialog that tells users to open\n  // the room in the real Safari.\n  const detectedOS = detectOS(navigator.userAgent);\n  if (detectedOS === \"iOS\" && !navigator.mediaDevices) {\n    remountUI({ showSafariDialog: true });\n    return;\n  }\n\n  // HACK: On Safari for iOS & MacOS, if mic permission is not granted, subscriber webrtc negotiation fails.\n  // So we need to insist on microphone grants to continue.\n  const browser = detect();\n  if ([\"iOS\", \"Mac OS\"].includes(detectedOS) && [\"safari\", \"ios\"].includes(browser.name)) {\n    try {\n      await navigator.mediaDevices.getUserMedia({ audio: true });\n    } catch (e) {\n      remountUI({ showSafariMicDialog: true });\n      return;\n    }\n  }\n\n  const hubId = qs.get(\"hub_id\") || document.location.pathname.substring(1).split(\"/\")[0];\n  console.log(`Hub ID: ${hubId}`);\n\n  const subscriptions = new Subscriptions(hubId);\n\n  if (navigator.serviceWorker) {\n    try {\n      navigator.serviceWorker\n        .register(\"/hub.service.js\")\n        .then(() => {\n          navigator.serviceWorker.ready\n            .then(registration => subscriptions.setRegistration(registration))\n            .catch(() => subscriptions.setRegistrationFailed());\n        })\n        .catch(() => subscriptions.setRegistrationFailed());\n    } catch (e) {\n      subscriptions.setRegistrationFailed();\n    }\n  } else {\n    subscriptions.setRegistrationFailed();\n  }\n\n  const scene = document.querySelector(\"a-scene\");\n  scene.setAttribute(\"shadow\", { enabled: window.APP.quality !== \"low\" }); // Disable shadows on low quality\n\n  // Physics needs to be ready before spawning anything.\n  while (!scene.systems.physics.initialized) await nextTick();\n\n  const onSceneLoaded = () => {\n    const physicsSystem = scene.systems.physics;\n    physicsSystem.setDebug(isDebug || physicsSystem.data.debug);\n    patchThreeAllocations();\n  };\n\n  if (scene.hasLoaded) {\n    onSceneLoaded();\n  } else {\n    scene.addEventListener(\"loaded\", onSceneLoaded, { once: true });\n  }\n\n  // If the stored avatar doesn't have a valid src, reset to a legacy avatar.\n  const avatarSrc = await getAvatarSrc(store.state.profile.avatarId);\n  if (!avatarSrc) {\n    store.resetToRandomLegacyAvatar();\n  }\n\n  const authChannel = new AuthChannel(store);\n  const hubChannel = new HubChannel(store, hubId);\n  const availableVREntryTypes = await getAvailableVREntryTypes();\n  const entryManager = new SceneEntryManager(hubChannel, authChannel, availableVREntryTypes, history);\n  const performConditionalSignIn = async (predicate, action, messageId, onFailure) => {\n    if (predicate()) return action();\n\n    const signInContinueTextId = scene.is(\"vr-mode\") ? \"entry.return-to-vr\" : \"dialog.close\";\n\n    handleExitTo2DInterstitial(true, () => remountUI({ showSignInDialog: false }));\n\n    remountUI({\n      showSignInDialog: true,\n      signInMessageId: `sign-in.${messageId}`,\n      signInCompleteMessageId: `sign-in.${messageId}-complete`,\n      signInContinueTextId,\n      onContinueAfterSignIn: async () => {\n        remountUI({ showSignInDialog: false });\n        let actionError = null;\n        if (predicate()) {\n          try {\n            await action();\n          } catch (e) {\n            actionError = e;\n          }\n        } else {\n          actionError = new Error(\"Predicate failed post sign-in\");\n        }\n\n        if (actionError && onFailure) onFailure(actionError);\n        exit2DInterstitialAndEnterVR();\n      }\n    });\n  };\n\n  window.addEventListener(\"action_create_avatar\", () => {\n    performConditionalSignIn(\n      () => hubChannel.signedIn,\n      () => pushHistoryState(history, \"overlay\", \"avatar-editor\"),\n      \"create-avatar\"\n    );\n  });\n\n  scene.addEventListener(\"scene_media_selected\", e => {\n    const sceneInfo = e.detail;\n\n    performConditionalSignIn(\n      () => hubChannel.can(\"update_hub\"),\n      () => hubChannel.updateScene(sceneInfo),\n      \"change-scene\"\n    );\n  });\n\n  scene.addEventListener(\"action_media_tweet\", e => {\n    let isInModal = false;\n    let isInOAuth = false;\n\n    const exitOAuth = () => {\n      isInOAuth = false;\n      store.clearOnLoadActions();\n      remountUI({ showOAuthDialog: false, oauthInfo: null });\n    };\n\n    handleExitTo2DInterstitial(true, () => {\n      if (isInModal) history.goBack();\n      if (isInOAuth) exitOAuth();\n    });\n\n    performConditionalSignIn(\n      () => hubChannel.signedIn,\n      async () => {\n        // Strip el from stored payload because it won't serialize into the store.\n        const serializableDetail = {};\n        Object.assign(serializableDetail, e.detail);\n        delete serializableDetail.el;\n\n        if (hubChannel.can(\"tweet\")) {\n          isInModal = true;\n          pushHistoryState(history, \"modal\", \"tweet\", serializableDetail);\n        } else {\n          if (e.detail.el) {\n            // Pin the object if we have to go through OAuth, since the page will refresh and\n            // the object will otherwise be removed\n            e.detail.el.setAttribute(\"pinnable\", \"pinned\", true);\n          }\n\n          const url = await hubChannel.getTwitterOAuthURL();\n\n          isInOAuth = true;\n          store.enqueueOnLoadAction(\"emit_scene_event\", { event: \"action_media_tweet\", detail: serializableDetail });\n          remountUI({\n            showOAuthDialog: true,\n            oauthInfo: [{ type: \"twitter\", url: url }],\n            onCloseOAuthDialog: () => exitOAuth()\n          });\n        }\n      },\n      \"tweet\"\n    );\n  });\n\n  remountUI({ performConditionalSignIn, embed: isEmbed, showPreload: isEmbed });\n  entryManager.performConditionalSignIn = performConditionalSignIn;\n  entryManager.init();\n\n  const linkChannel = new LinkChannel(store);\n\n  window.APP.scene = scene;\n  window.APP.hubChannel = hubChannel;\n  window.dispatchEvent(new CustomEvent(\"hub_channel_ready\"));\n\n  const handleEarlyVRMode = () => {\n    // If VR headset is activated, refreshing page will fire vrdisplayactivate\n    // which puts A-Frame in VR mode, so exit VR mode whenever it is attempted\n    // to be entered and we haven't entered the room yet.\n    if (scene.is(\"vr-mode\") && !scene.is(\"vr-entered\")) {\n      console.log(\"Pre-emptively exiting VR mode.\");\n      scene.exitVR();\n      return true;\n    }\n\n    return false;\n  };\n\n  scene.addEventListener(\"enter-vr\", () => {\n    if (handleEarlyVRMode()) return true;\n\n    if (isMobileVR) {\n      // Optimization, stop drawing UI if not visible\n      remountUI({ hide: true });\n    }\n\n    document.body.classList.add(\"vr-mode\");\n\n    // Don't stretch canvas on cardboard, since that's drawing the actual VR view :)\n    if ((!isMobile && !isMobileVR) || availableVREntryTypes.cardboard !== VR_DEVICE_AVAILABILITY.yes) {\n      document.body.classList.add(\"vr-mode-stretch\");\n    }\n  });\n\n  handleEarlyVRMode();\n\n  // HACK A-Frame 0.9.0 seems to fail to wire up vrdisplaypresentchange early enough\n  // to catch presentation state changes and recognize that an HMD is presenting on startup.\n  window.addEventListener(\n    \"vrdisplaypresentchange\",\n    () => {\n      if (scene.is(\"vr-entered\")) return;\n      if (scene.is(\"vr-mode\")) return;\n\n      const device = AFRAME.utils.device.getVRDisplay();\n\n      if (device && device.isPresenting) {\n        if (!scene.is(\"vr-mode\")) {\n          console.warn(\"Hit A-Frame bug where VR display is presenting but A-Frame has not entered VR mode.\");\n          scene.enterVR();\n        }\n      }\n    },\n    { once: true }\n  );\n\n  scene.addEventListener(\"exit-vr\", () => {\n    document.body.classList.remove(\"vr-mode\");\n    document.body.classList.remove(\"vr-mode-stretch\");\n\n    remountUI({ hide: false });\n\n    // HACK: Oculus browser pauses videos when exiting VR mode, so we need to resume them after a timeout.\n    if (/OculusBrowser/i.test(window.navigator.userAgent)) {\n      document.querySelectorAll(\"[media-video]\").forEach(m => {\n        const videoComponent = m.components[\"media-video\"];\n\n        if (videoComponent) {\n          videoComponent._ignorePauseStateChanges = true;\n\n          setTimeout(() => {\n            const video = videoComponent.video;\n\n            if (video && video.paused && !videoComponent.data.videoPaused) {\n              video.play();\n            }\n\n            videoComponent._ignorePauseStateChanges = false;\n          }, 1000);\n        }\n      });\n    }\n  });\n\n  registerNetworkSchemas();\n\n  remountUI({\n    authChannel,\n    hubChannel,\n    linkChannel,\n    subscriptions,\n    enterScene: entryManager.enterScene,\n    exitScene: reason => {\n      entryManager.exitScene();\n\n      if (reason) {\n        remountUI({ roomUnavailableReason: reason });\n      }\n    },\n    initialIsSubscribed: subscriptions.isSubscribed(),\n    activeTips: scene.systems.tips.activeTips\n  });\n\n  scene.addEventListener(\"action_focus_chat\", () => {\n    const chatFocusTarget = document.querySelector(\".chat-focus-target\");\n    chatFocusTarget && chatFocusTarget.focus();\n  });\n\n  scene.addEventListener(\"tips_changed\", e => {\n    remountUI({ activeTips: e.detail });\n  });\n\n  scene.addEventListener(\"leave_room_requested\", () => {\n    scene.exitVR();\n    entryManager.exitScene(\"left\");\n    remountUI({ roomUnavailableReason: \"left\" });\n  });\n\n  scene.addEventListener(\"camera_toggled\", () => remountUI({}));\n\n  scene.addEventListener(\"camera_removed\", () => remountUI({}));\n\n  scene.addEventListener(\"hub_closed\", () => {\n    scene.exitVR();\n    entryManager.exitScene(\"closed\");\n    remountUI({ roomUnavailableReason: \"closed\" });\n  });\n\n  scene.addEventListener(\"action_camera_recording_started\", () => hubChannel.beginRecording());\n  scene.addEventListener(\"action_camera_recording_ended\", () => hubChannel.endRecording());\n\n  const platformUnsupportedReason = getPlatformUnsupportedReason();\n\n  if (platformUnsupportedReason) {\n    remountUI({ platformUnsupportedReason });\n    entryManager.exitScene();\n    return;\n  }\n\n  if (qs.get(\"required_version\") && process.env.BUILD_VERSION) {\n    const buildNumber = process.env.BUILD_VERSION.split(\" \", 1)[0]; // e.g. \"123 (abcd5678)\"\n\n    if (qs.get(\"required_version\") !== buildNumber) {\n      remountUI({ roomUnavailableReason: \"version_mismatch\" });\n      setTimeout(() => document.location.reload(), 5000);\n      entryManager.exitScene();\n      return;\n    }\n  }\n\n  getReticulumMeta().then(reticulumMeta => {\n    console.log(`Reticulum @ ${reticulumMeta.phx_host}: v${reticulumMeta.version} on ${reticulumMeta.pool}`);\n\n    if (\n      qs.get(\"required_ret_version\") &&\n      (qs.get(\"required_ret_version\") !== reticulumMeta.version || qs.get(\"required_ret_pool\") !== reticulumMeta.pool)\n    ) {\n      remountUI({ roomUnavailableReason: \"version_mismatch\" });\n      setTimeout(() => document.location.reload(), 5000);\n      entryManager.exitScene();\n      return;\n    }\n  });\n\n  if (isMobileVR) {\n    remountUI({ availableVREntryTypes, forcedVREntryType: \"vr\" });\n\n    if (/Oculus/.test(navigator.userAgent)) {\n      // HACK - The polyfill reports Cardboard as the primary VR display on startup out ahead of Oculus Go on Oculus Browser 5.5.0 beta. This display is cached by A-Frame,\n      // so we need to resolve that and get the real VRDisplay before entering as well.\n      const displays = await navigator.getVRDisplays();\n      const vrDisplay = displays.length && displays[0];\n      AFRAME.utils.device.getVRDisplay = () => vrDisplay;\n    }\n  } else {\n    const hasVREntryDevice =\n      availableVREntryTypes.cardboard !== VR_DEVICE_AVAILABILITY.no ||\n      availableVREntryTypes.generic !== VR_DEVICE_AVAILABILITY.no ||\n      availableVREntryTypes.daydream !== VR_DEVICE_AVAILABILITY.no;\n\n    remountUI({ availableVREntryTypes, forcedVREntryType: qsVREntryType || (!hasVREntryDevice ? \"2d\" : null) });\n  }\n\n  const environmentScene = document.querySelector(\"#environment-scene\");\n\n  const onFirstEnvironmentLoad = () => {\n    if (!scene.is(\"entered\")) {\n      setupLobbyCamera();\n    }\n\n    // Replace renderer with a noop renderer to reduce bot resource usage.\n    if (isBotMode) {\n      runBotMode(scene, entryManager);\n    }\n\n    environmentScene.removeEventListener(\"model-loaded\", onFirstEnvironmentLoad);\n  };\n\n  environmentScene.addEventListener(\"model-loaded\", onFirstEnvironmentLoad);\n\n  environmentScene.addEventListener(\"model-loaded\", () => {\n    // This will be run every time the environment is changed (including the first load.)\n    remountUI({ environmentSceneLoaded: true });\n    scene.emit(\"environment-scene-loaded\");\n\n    // Re-bind the teleporter controls collision meshes in case the scene changed.\n    document.querySelectorAll(\"a-entity[teleporter]\").forEach(x => x.components[\"teleporter\"].queryCollisionEntities());\n\n    for (const modelEl of environmentScene.children) {\n      addAnimationComponents(modelEl);\n    }\n  });\n\n  const socket = await connectToReticulum(isDebug);\n\n  socket.onClose(e => {\n    // We don't currently have an easy way to distinguish between being kicked (server closes socket)\n    // and a variety of other network issues that seem to produce the 1000 closure code, but the\n    // latter are probably more common. Either way, we just tell the user they got disconnected.\n    const NORMAL_CLOSURE = 1000;\n    if (e.code === NORMAL_CLOSURE) {\n      entryManager.exitScene();\n      remountUI({ roomUnavailableReason: \"disconnected\" });\n    }\n  });\n\n  let retDeployReconnectInterval;\n  const retReconnectMaxDelayMs = 15000;\n\n  // Reticulum global channel\n  let retPhxChannel = socket.channel(`ret`, { hub_id: hubId });\n  retPhxChannel\n    .join()\n    .receive(\"ok\", async data => subscriptions.setVapidPublicKey(data.vapid_public_key))\n    .receive(\"error\", res => {\n      subscriptions.setVapidPublicKey(null);\n      console.error(res);\n    });\n\n  const pushSubscriptionEndpoint = await subscriptions.getCurrentEndpoint();\n\n  const oauthFlowPermsToken = Cookies.get(OAUTH_FLOW_PERMS_TOKEN_KEY);\n\n  if (oauthFlowPermsToken) {\n    Cookies.remove(OAUTH_FLOW_PERMS_TOKEN_KEY);\n  }\n\n  const createHubChannelParams = permsToken => {\n    const params = {\n      profile: store.state.profile,\n      push_subscription_endpoint: pushSubscriptionEndpoint,\n      auth_token: null,\n      perms_token: null,\n      context: {\n        mobile: isMobile || isMobileVR,\n        hmd: availableVREntryTypes.isInHMD,\n        embed: isEmbed\n      }\n    };\n\n    if (permsToken) {\n      params.perms_token = permsToken;\n    }\n\n    const { token } = store.state.credentials;\n    if (token) {\n      console.log(`Logged into account ${store.credentialsAccountId}`);\n      params.auth_token = token;\n    }\n\n    return params;\n  };\n\n  const migrateToNewReticulumServer = async deployNotification => {\n    // On Reticulum deploys, reconnect after a random delay until pool + version match deployed version/pool\n    console.log(`Reticulum deploy detected v${deployNotification.ret_version} on ${deployNotification.ret_pool}`);\n    clearInterval(retDeployReconnectInterval);\n\n    setTimeout(() => {\n      const tryReconnect = async () => {\n        invalidateReticulumMeta();\n        const reticulumMeta = await getReticulumMeta();\n\n        if (\n          reticulumMeta.pool === deployNotification.ret_pool &&\n          reticulumMeta.version === deployNotification.ret_version\n        ) {\n          console.log(\"Reticulum reconnecting.\");\n          clearInterval(retDeployReconnectInterval);\n          const oldSocket = retPhxChannel.socket;\n          const socket = await connectToReticulum(isDebug, oldSocket.params());\n          retPhxChannel = await migrateChannelToSocket(retPhxChannel, socket);\n          await hubChannel.migrateToSocket(socket, createHubChannelParams());\n          authChannel.setSocket(socket);\n          linkChannel.setSocket(socket);\n\n          // Disconnect old socket after a delay to ensure this user is always registered in presence.\n          setTimeout(() => {\n            console.log(\"Reconnection complete. Disconnecting old reticulum socket.\");\n            oldSocket.teardown();\n          }, 10000);\n        }\n      };\n\n      retDeployReconnectInterval = setInterval(tryReconnect, 5000);\n      tryReconnect();\n    }, Math.floor(Math.random() * retReconnectMaxDelayMs));\n  };\n\n  retPhxChannel.on(\"notice\", async data => {\n    // On Reticulum deploys, reconnect after a random delay until pool + version match deployed version/pool\n    if (data.event === \"ret-deploy\") {\n      await migrateToNewReticulumServer(data);\n    }\n  });\n\n  const hubPhxChannel = socket.channel(`hub:${hubId}`, createHubChannelParams(oauthFlowPermsToken));\n\n  const presenceLogEntries = [];\n  const addToPresenceLog = entry => {\n    entry.key = Date.now().toString();\n\n    presenceLogEntries.push(entry);\n    remountUI({ presenceLogEntries });\n    if (entry.type === \"chat\") {\n      scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CHAT_MESSAGE);\n    }\n\n    // Fade out and then remove\n    setTimeout(() => {\n      entry.expired = true;\n      remountUI({ presenceLogEntries });\n\n      setTimeout(() => {\n        presenceLogEntries.splice(presenceLogEntries.indexOf(entry), 1);\n        remountUI({ presenceLogEntries });\n      }, 5000);\n    }, 20000);\n  };\n\n  const messageDispatch = new MessageDispatch(\n    scene,\n    entryManager,\n    hubChannel,\n    addToPresenceLog,\n    remountUI,\n    mediaSearchStore\n  );\n\n  let isInitialJoin = true;\n\n  // We need to be able to wait for initial presence syncs across reconnects and socket migrations,\n  // so we create this object in the outer scope and assign it a new promise on channel join.\n  const presenceSync = {\n    promise: null,\n    resolve: null\n  };\n\n  hubChannel.setPhoenixChannel(hubPhxChannel);\n\n  hubPhxChannel\n    .join()\n    .receive(\"ok\", async data => {\n      socket.params().session_id = data.session_id;\n      socket.params().session_token = data.session_token;\n\n      const vrHudPresenceCount = document.querySelector(\"#hud-presence-count\");\n\n      presenceSync.promise = new Promise(resolve => {\n        presenceSync.resolve = resolve;\n      });\n\n      if (isInitialJoin) {\n        store.addEventListener(\"profilechanged\", hubChannel.sendProfileUpdate.bind(hubChannel));\n\n        hubChannel.presence.onSync(() => {\n          const presence = hubChannel.presence;\n\n          remountUI({\n            sessionId: socket.params().session_id,\n            presences: presence.state\n          });\n\n          const occupantCount = Object.entries(presence.state).length;\n          vrHudPresenceCount.setAttribute(\"text\", \"value\", occupantCount.toString());\n\n          if (occupantCount > 1) {\n            scene.addState(\"copresent\");\n          } else {\n            scene.removeState(\"copresent\");\n          }\n\n          // HACK - Set a flag on the presence object indicating if the initial sync has completed,\n          // which is used to determine if we should fire join/leave messages into the presence log.\n          // This flag is required since we reuse these onJoin and onLeave handler functions on\n          // socket migrations.\n          presence.__hadInitialSync = true;\n\n          presenceSync.resolve();\n\n          presence.onJoin((sessionId, current, info) => {\n            // Ignore presence join/leaves if this Presence has not yet had its initial sync (o/w the user\n            // will see join messages for every user.)\n            if (!hubChannel.presence.__hadInitialSync) return;\n\n            const meta = info.metas[info.metas.length - 1];\n            const occupantCount = Object.entries(hubChannel.presence.state).length;\n\n            if (occupantCount <= NOISY_OCCUPANT_COUNT) {\n              if (current) {\n                // Change to existing presence\n                const isSelf = sessionId === socket.params().session_id;\n                const currentMeta = current.metas[0];\n\n                if (\n                  !isSelf &&\n                  currentMeta.presence !== meta.presence &&\n                  meta.presence === \"room\" &&\n                  meta.profile.displayName\n                ) {\n                  addToPresenceLog({\n                    type: \"entered\",\n                    presence: meta.presence,\n                    name: meta.profile.displayName\n                  });\n                }\n\n                if (\n                  currentMeta.profile &&\n                  meta.profile &&\n                  currentMeta.profile.displayName !== meta.profile.displayName\n                ) {\n                  addToPresenceLog({\n                    type: \"display_name_changed\",\n                    oldName: currentMeta.profile.displayName,\n                    newName: meta.profile.displayName\n                  });\n                }\n              } else if (info.metas.length === 1) {\n                // New presence\n                const meta = info.metas[0];\n\n                if (meta.presence && meta.profile.displayName) {\n                  addToPresenceLog({\n                    type: \"join\",\n                    presence: meta.presence,\n                    name: meta.profile.displayName\n                  });\n                }\n              }\n            }\n\n            scene.emit(\"presence_updated\", {\n              sessionId,\n              profile: meta.profile,\n              roles: meta.roles,\n              permissions: meta.permissions,\n              streaming: meta.streaming,\n              recording: meta.recording\n            });\n          });\n\n          presence.onLeave((sessionId, current, info) => {\n            // Ignore presence join/leaves if this Presence has not yet had its initial sync\n            if (!hubChannel.presence.__hadInitialSync) return;\n\n            if (current && current.metas.length > 0) return;\n            const occupantCount = Object.entries(hubChannel.presence.state).length;\n            if (occupantCount > NOISY_OCCUPANT_COUNT) return;\n\n            const meta = info.metas[0];\n\n            if (meta.profile.displayName) {\n              addToPresenceLog({\n                type: \"leave\",\n                name: meta.profile.displayName\n              });\n            }\n          });\n        });\n      }\n\n      isInitialJoin = false;\n\n      const permsToken = oauthFlowPermsToken || data.perms_token;\n      hubChannel.setPermissionsFromToken(permsToken);\n\n      scene.addEventListener(\"adapter-ready\", ({ detail: adapter }) => {\n        adapter.setClientId(socket.params().session_id);\n        adapter.setJoinToken(data.perms_token);\n        hubChannel.addEventListener(\"permissions-refreshed\", e => adapter.setJoinToken(e.detail.permsToken));\n      });\n      subscriptions.setHubChannel(hubChannel);\n\n      subscriptions.setSubscribed(data.subscriptions.web_push);\n\n      remountUI({\n        hubIsBound: data.hub_requires_oauth,\n        initialIsFavorited: data.subscriptions.favorites,\n        initialIsSubscribed: subscriptions.isSubscribed()\n      });\n\n      await presenceSync.promise;\n\n      handleHubChannelJoined(entryManager, hubChannel, messageDispatch, data);\n    })\n    .receive(\"error\", res => {\n      if (res.reason === \"closed\") {\n        entryManager.exitScene();\n        remountUI({ roomUnavailableReason: \"closed\" });\n      } else if (res.reason === \"oauth_required\") {\n        entryManager.exitScene();\n        remountUI({ oauthInfo: res.oauth_info, showOAuthDialog: true });\n      } else if (res.reason === \"join_denied\") {\n        entryManager.exitScene();\n        remountUI({ roomUnavailableReason: \"denied\" });\n      }\n\n      console.error(res);\n    });\n\n  hubPhxChannel.on(\"naf\", data => {\n    if (!NAF.connection.adapter) return;\n\n    NAF.connection.adapter.onData(authorizeOrSanitizeMessage(data), PHOENIX_RELIABLE_NAF);\n  });\n\n  hubPhxChannel.on(\"message\", ({ session_id, type, body, from }) => {\n    const getAuthor = () => {\n      const userInfo = hubChannel.presence.state[session_id];\n      if (from) {\n        return from;\n      } else if (userInfo) {\n        return userInfo.metas[0].profile.displayName;\n      } else {\n        return \"Mystery user\";\n      }\n    };\n\n    const name = getAuthor();\n    const maySpawn = scene.is(\"entered\");\n\n    const incomingMessage = { name, type, body, maySpawn, sessionId: session_id };\n\n    if (scene.is(\"vr-mode\")) {\n      createInWorldLogMessage(incomingMessage);\n    }\n\n    addToPresenceLog(incomingMessage);\n  });\n\n  hubPhxChannel.on(\"hub_refresh\", ({ session_id, hubs, stale_fields }) => {\n    const hub = hubs[0];\n    const userInfo = hubChannel.presence.state[session_id];\n\n    updateUIForHub(hub);\n\n    if (stale_fields.includes(\"scene\")) {\n      updateEnvironmentForHub(hub);\n\n      addToPresenceLog({\n        type: \"scene_changed\",\n        name: userInfo.metas[0].profile.displayName,\n        sceneName: hub.scene ? hub.scene.name : \"a custom URL\"\n      });\n    }\n\n    if (stale_fields.includes(\"member_permissions\")) {\n      hubChannel.fetchPermissions();\n    }\n\n    if (stale_fields.includes(\"name\")) {\n      const titleParts = document.title.split(\" | \"); // Assumes title has | trailing site name\n      titleParts[0] = hub.name;\n      document.title = titleParts.join(\" | \");\n\n      // Re-write the slug in the browser history\n      const pathParts = history.location.pathname.split(\"/\");\n      const oldSlug = pathParts[1];\n      const { search, state } = history.location;\n      const pathname = history.location.pathname.replace(`/${oldSlug}`, `/${hub.slug}`);\n\n      history.replace({ pathname, search, state });\n\n      addToPresenceLog({\n        type: \"hub_name_changed\",\n        name: userInfo.metas[0].profile.displayName,\n        hubName: hub.name\n      });\n    }\n\n    if (hub.entry_mode === \"deny\") {\n      scene.emit(\"hub_closed\");\n    }\n  });\n\n  hubPhxChannel.on(\"permissions_updated\", () => hubChannel.fetchPermissions());\n\n  hubPhxChannel.on(\"mute\", ({ session_id }) => {\n    if (session_id === NAF.clientId && !scene.is(\"muted\")) {\n      scene.emit(\"action_mute\");\n    }\n  });\n\n  authChannel.setSocket(socket);\n  linkChannel.setSocket(socket);\n});\n","// Stores a key in localStorage and registeres a listener for the same key being set (by another tab).\n// When detected, fire a \"concurrentload\" event.\nexport default function detectConcurrentLoad(instanceKey = \"global\") {\n  const key = `___concurrent_load_detector_${instanceKey}`;\n  localStorage.setItem(key, JSON.stringify({ started_at: new Date() }));\n  const onStorageEvent = e => {\n    if (e.key !== key) return;\n    window.dispatchEvent(new CustomEvent(\"concurrentload\"));\n    window.removeEventListener(\"storage\", onStorageEvent);\n  };\n  window.addEventListener(\"storage\", onStorageEvent);\n}\n","export default function patchThreeAllocations() {\n  const renderer = AFRAME.scenes[0].renderer;\n  const gl = renderer.context;\n\n  // These functions in three.js uses the arguments object, which allocates.\n  renderer.state.texImage2D = function(a, b, c, d, e, f, g, h, i) {\n    try {\n      if (g === undefined) {\n        gl.texImage2D(a, b, c, d, e, f);\n      } else {\n        gl.texImage2D(a, b, c, d, e, f, g, h, i);\n      }\n    } catch (error) {\n      console.error(\"THREE.WebGLState:\", error);\n    }\n  };\n\n  renderer.state.compressedTexImage2D = function(a, b, c, d, e, f, g, h, i, j) {\n    try {\n      if (h === undefined) {\n        gl.compressedTexImage2D(a, b, c, d, e, f, g);\n      } else if (i === undefined) {\n        gl.compressedTexImage2D(a, b, c, d, e, f, g, h);\n      } else if (j === undefined) {\n        gl.compressedTexImage2D(a, b, c, d, e, f, g, h, i);\n      } else {\n        gl.compressedTexImage2D(a, b, c, d, e, f, g, h, i, j);\n      }\n    } catch (error) {\n      console.error(\"THREE.WebGLState:\", error);\n    }\n  };\n}\n","import { forEachMaterial } from \"../utils/material-utils\";\nimport cubeMapPosX from \"../assets/images/cubemap/posx.jpg\";\nimport cubeMapNegX from \"../assets/images/cubemap/negx.jpg\";\nimport cubeMapPosY from \"../assets/images/cubemap/posy.jpg\";\nimport cubeMapNegY from \"../assets/images/cubemap/negy.jpg\";\nimport cubeMapPosZ from \"../assets/images/cubemap/posz.jpg\";\nimport cubeMapNegZ from \"../assets/images/cubemap/negz.jpg\";\n\nexport async function createDefaultEnvironmentMap() {\n  const urls = [cubeMapPosX, cubeMapNegX, cubeMapPosY, cubeMapNegY, cubeMapPosZ, cubeMapNegZ];\n  const texture = await new Promise((resolve, reject) =>\n    new THREE.CubeTextureLoader().load(urls, resolve, undefined, reject)\n  );\n  texture.format = THREE.RGBFormat;\n  return texture;\n}\n\nAFRAME.registerComponent(\"environment-map\", {\n  init() {\n    this.environmentMap = null;\n\n    this.updateEnvironmentMap = this.updateEnvironmentMap.bind(this);\n  },\n\n  updateEnvironmentMap(environmentMap) {\n    this.environmentMap = environmentMap;\n    this.applyEnvironmentMap(this.el.object3D);\n  },\n\n  applyEnvironmentMap(object3D) {\n    object3D.traverse(object => {\n      forEachMaterial(object, material => {\n        if (material.isMeshStandardMaterial) {\n          material.envMap = this.environmentMap;\n          material.needsUpdate = true;\n        }\n      });\n    });\n  }\n});\n","module.exports = \"if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\\n  float ratio = 0.0;\\n\\n  if (hubs_EnableSweepingEffect) {\\n    float size = hubs_SweepParams.t - hubs_SweepParams.s;\\n    float line = mod(hubs_Time / 500.0 * size, size * 3.0) + hubs_SweepParams.s - size / 3.0;\\n\\n    if (hubs_WorldPosition.y < line) {\\n      // Highlight with a sweeping gradient.\\n      ratio = max(0.0, 1.0 - (line - hubs_WorldPosition.y) / (size * 1.5));\\n    }\\n  }\\n\\n  // Highlight with a gradient falling off with distance.\\n  float pulse = 9.0 + 3.0 * (sin(hubs_Time / 1000.0) + 1.0);\\n\\n  if (hubs_HighlightInteractorOne) {\\n    float dist1 = distance(hubs_WorldPosition, hubs_InteractorOnePos);\\n    ratio += -min(1.0, pow(dist1 * pulse, 3.0)) + 1.0;\\n  } \\n\\n  if (hubs_HighlightInteractorTwo) {\\n    float dist2 = distance(hubs_WorldPosition, hubs_InteractorTwoPos);\\n    ratio += -min(1.0, pow(dist2 * pulse, 3.0)) + 1.0;\\n  }\\n\\n  ratio = min(1.0, ratio);\\n\\n  // Gamma corrected highlight color\\n  vec3 highlightColor = vec3(0.184, 0.499, 0.933);\\n\\n  gl_FragColor.rgb = (gl_FragColor.rgb * (1.0 - ratio)) + (highlightColor * ratio);\\n}\\n\"","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posx-d235fb97df77b607be04b84125f40e7c.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negx-35034574e114423babdea92b6a2eb97a.jpg\";","/* global fetch THREE */\nimport URL_TICK from \"../assets/sfx/tick.mp3\";\nimport URL_TELEPORT_LOOP from \"../assets/sfx/teleport-loop.mp3\";\nimport URL_QUICK_TURN from \"../assets/sfx/quickTurn.mp3\";\nimport URL_TAP_MELLOW from \"../assets/sfx/tap_mellow.mp3\";\nimport URL_PEN_SPAWN from \"../assets/sfx/PenSpawn.mp3\";\nimport URL_PEN_DRAW from \"../assets/sfx/PenDraw1.mp3\";\nimport URL_CAMERA_SNAPSHOT from \"../assets/sfx/PicSnapHey.mp3\";\nimport URL_WELCOME from \"../assets/sfx/welcome.mp3\";\nimport URL_QUACK from \"../assets/sfx/quack.mp3\";\nimport URL_SPECIAL_QUACK from \"../assets/sfx/specialquack.mp3\";\nimport URL_POP from \"../assets/sfx/pop.mp3\";\nimport URL_FREEZE from \"../assets/sfx/Eb_blip.mp3\";\nimport URL_TACK from \"../assets/sfx/tack.mp3\";\nimport URL_MEDIA_LOADED from \"../assets/sfx/A_bendUp.mp3\";\nimport URL_MEDIA_LOADING from \"../assets/sfx/suspense.mp3\";\n\nlet soundEnum = 0;\nexport const SOUND_HOVER_OR_GRAB = soundEnum++;\nexport const SOUND_THAW = soundEnum++;\nexport const SOUND_PEN_STOP_DRAW = soundEnum++;\nexport const SOUND_PEN_UNDO_DRAW = soundEnum++;\nexport const SOUND_PEN_CHANGE_COLOR = soundEnum++;\nexport const SOUND_TOGGLE_MIC = soundEnum++;\nexport const SOUND_TELEPORT_START = soundEnum++;\nexport const SOUND_TELEPORT_END = soundEnum++;\nexport const SOUND_SNAP_ROTATE = soundEnum++;\nexport const SOUND_SPAWN_PEN = soundEnum++;\nexport const SOUND_PEN_START_DRAW = soundEnum++;\nexport const SOUND_CAMERA_TOOL_TOOK_SNAPSHOT = soundEnum++;\nexport const SOUND_ENTER_SCENE = soundEnum++;\nexport const SOUND_QUACK = soundEnum++;\nexport const SOUND_SPECIAL_QUACK = soundEnum++;\nexport const SOUND_CHAT_MESSAGE = soundEnum++;\nexport const SOUND_FREEZE = soundEnum++;\nexport const SOUND_PIN = soundEnum++;\nexport const SOUND_MEDIA_LOADING = soundEnum++;\nexport const SOUND_MEDIA_LOADED = soundEnum++;\nexport const SOUND_CAMERA_TOOL_COUNTDOWN = soundEnum++;\n\n// Safari doesn't support the promise form of decodeAudioData, so we polyfill it.\nfunction decodeAudioData(audioContext, arrayBuffer) {\n  return new Promise((resolve, reject) => {\n    audioContext.decodeAudioData(arrayBuffer, resolve, reject);\n  });\n}\n\nexport class SoundEffectsSystem {\n  constructor() {\n    this.pendingEffects = [];\n    this.audioContext = THREE.AudioContext.getContext();\n    const soundsAndUrls = [\n      [SOUND_HOVER_OR_GRAB, URL_TICK],\n      [SOUND_THAW, URL_TICK],\n      [SOUND_PEN_STOP_DRAW, URL_TICK],\n      [SOUND_PEN_UNDO_DRAW, URL_TICK],\n      [SOUND_PEN_CHANGE_COLOR, URL_TICK],\n      [SOUND_TOGGLE_MIC, URL_TICK],\n      [SOUND_CAMERA_TOOL_COUNTDOWN, URL_TICK],\n      [SOUND_TELEPORT_START, URL_TELEPORT_LOOP],\n      [SOUND_TELEPORT_END, URL_QUICK_TURN],\n      [SOUND_SNAP_ROTATE, URL_TAP_MELLOW],\n      [SOUND_SPAWN_PEN, URL_PEN_SPAWN],\n      [SOUND_PEN_START_DRAW, URL_PEN_DRAW],\n      [SOUND_CAMERA_TOOL_TOOK_SNAPSHOT, URL_CAMERA_SNAPSHOT],\n      [SOUND_ENTER_SCENE, URL_WELCOME],\n      [SOUND_QUACK, URL_QUACK],\n      [SOUND_SPECIAL_QUACK, URL_SPECIAL_QUACK],\n      [SOUND_CHAT_MESSAGE, URL_POP],\n      [SOUND_FREEZE, URL_FREEZE],\n      [SOUND_PIN, URL_TACK],\n      [SOUND_MEDIA_LOADING, URL_MEDIA_LOADING],\n      [SOUND_MEDIA_LOADED, URL_MEDIA_LOADED]\n    ];\n    const loading = new Map();\n    const load = url => {\n      let audioBufferPromise = loading.get(url);\n      if (!audioBufferPromise) {\n        audioBufferPromise = fetch(url)\n          .then(r => r.arrayBuffer())\n          .then(arrayBuffer => decodeAudioData(this.audioContext, arrayBuffer));\n        loading.set(url, audioBufferPromise);\n      }\n      return audioBufferPromise;\n    };\n    this.sounds = new Map();\n    soundsAndUrls.map(([sound, url]) => {\n      load(url).then(audioBuffer => {\n        this.sounds.set(sound, audioBuffer);\n      });\n    });\n  }\n\n  enqueueSound(sound, loop) {\n    const audioBuffer = this.sounds.get(sound);\n    if (!audioBuffer) return null;\n    // The nodes are very inexpensive to create, according to\n    // https://developer.mozilla.org/en-US/docs/Web/API/AudioBufferSourceNode\n    const source = this.audioContext.createBufferSource();\n    source.buffer = audioBuffer;\n    source.connect(this.audioContext.destination);\n    source.loop = loop;\n    this.pendingEffects.push(source);\n    return source;\n  }\n\n  playSoundOneShot(sound) {\n    return this.enqueueSound(sound, false);\n  }\n\n  playSoundLooped(sound) {\n    return this.enqueueSound(sound, true);\n  }\n\n  playSoundLoopedWithGain(sound) {\n    const audioBuffer = this.sounds.get(sound);\n    if (!audioBuffer) return null;\n\n    const source = this.audioContext.createBufferSource();\n    const gain = this.audioContext.createGain();\n    source.buffer = audioBuffer;\n    source.connect(gain);\n    gain.connect(this.audioContext.destination);\n    source.loop = true;\n    this.pendingEffects.push(source);\n    return { gain, source };\n  }\n\n  stopSoundNode(node) {\n    const index = this.pendingEffects.indexOf(node);\n    if (index !== -1) {\n      this.pendingEffects.splice(index, 1);\n    } else {\n      node.stop();\n    }\n  }\n\n  tick() {\n    for (let i = 0; i < this.pendingEffects.length; i++) {\n      this.pendingEffects[i].start();\n    }\n    this.pendingEffects.length = 0;\n  }\n}\n","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posy-d0c4e1e7979d75923d4d8b49c191bc6e.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negy-35808d21d1d17ac1b84d3184e365093b.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posz-de29aa8396196e4b040cd5305e351dbe.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negz-d73d18a8b7994524dc39a6ea3fcf43fc.jpg\";","import { detectOS } from \"detect-browser\";\n\nexport function disableiOSZoom() {\n  if (detectOS(navigator.userAgent) !== \"iOS\") return;\n\n  let lastTouchAtMs = 0;\n\n  document.addEventListener(\"touchmove\", ev => {\n    if (ev.scale === 1) return;\n\n    ev.preventDefault();\n  });\n\n  document.addEventListener(\"touchend\", ev => {\n    const now = new Date().getTime();\n    const isDoubleTouch = now - lastTouchAtMs <= 300;\n    lastTouchAtMs = now;\n\n    if (isDoubleTouch) {\n      ev.preventDefault();\n    }\n  });\n}\n","import Store from \"./storage/store\";\nimport MediaSearchStore from \"./storage/media-search-store\";\n\nexport class App {\n  constructor() {\n    this.scene = null;\n    this.quality = \"low\";\n    this.store = new Store();\n    this.mediaSearchStore = new MediaSearchStore();\n  }\n\n  setQuality(quality) {\n    if (this.quality === quality) {\n      return false;\n    }\n\n    this.quality = quality;\n\n    if (this.scene) {\n      this.scene.dispatchEvent(new CustomEvent(\"quality-changed\", { detail: quality }));\n    }\n\n    return true;\n  }\n}\n","// Provides a global registry of running components\nexport function registerComponentInstance(component, name) {\n  window.APP.componentRegistry = window.APP.componentRegistry || {};\n  window.APP.componentRegistry[name] = window.APP.componentRegistry[name] || [];\n  window.APP.componentRegistry[name].push(component);\n}\n\nexport function deregisterComponentInstance(component, name) {\n  if (!window.APP.componentRegistry || !window.APP.componentRegistry[name]) return;\n  window.APP.componentRegistry[name].splice(window.APP.componentRegistry[name].indexOf(component), 1);\n}\n\nexport function getCurrentStreamer() {\n  if (!window.APP || !window.APP.componentRegistry || !window.APP.hubChannel || !window.APP.hubChannel.presence)\n    return null;\n  const playerInfos = window.APP.componentRegistry[\"player-info\"] || [];\n  const presences = window.APP.hubChannel.presence.state;\n\n  for (let i = 0; i < playerInfos.length; i++) {\n    const playerInfo = playerInfos[i];\n    const presence = presences[playerInfo.playerSessionId];\n\n    if (presence && presence.metas[0] && presence.metas[0].streaming) {\n      return playerInfo;\n    }\n  }\n\n  return null;\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"tip-root\":\"tip__tip-root__1s7D1\",\"tipRoot\":\"tip__tip-root__1s7D1\",\"tip-link\":\"tip__tip-link__3m4Iq\",\"tipLink\":\"tip__tip-link__3m4Iq\",\"tip-cancel\":\"tip__tip-cancel__1xPNP\",\"tipCancel\":\"tip__tip-cancel__1xPNP\",\"tip\":\"tip__tip__32KOl\",\"split-tip\":\"tip__split-tip__1xSCE\",\"splitTip\":\"tip__split-tip__1xSCE\",\"split-tip-icon\":\"tip__split-tip-icon__1ZXw0\",\"splitTipIcon\":\"tip__split-tip-icon__1ZXw0\",\"spawn_menu-icon\":\"tip__spawn_menu-icon__2en_9\",\"spawnMenuIcon\":\"tip__spawn_menu-icon__2en_9\",\"object_rotate_button-icon\":\"tip__object_rotate_button-icon__2tgeV\",\"objectRotateButtonIcon\":\"tip__object_rotate_button-icon__2tgeV\",\"object_scale_button-icon\":\"tip__object_scale_button-icon__pxKrw\",\"objectScaleButtonIcon\":\"tip__object_scale_button-icon__pxKrw\",\"object_recenter_button-icon\":\"tip__object_recenter_button-icon__38tNR\",\"objectRecenterButtonIcon\":\"tip__object_recenter_button-icon__38tNR\"};","function loadAsync(loader, url, onProgress) {\n  return new Promise((resolve, reject) => loader.load(url, resolve, onProgress, reject));\n}\n\nexport default class HubsTextureLoader {\n  static crossOrigin = \"anonymous\";\n\n  constructor(manager = THREE.DefaultLoadingManager) {\n    this.manager = manager;\n  }\n\n  load(url, onLoad, onProgress, onError) {\n    const texture = new THREE.Texture();\n\n    this.loadTextureAsync(texture, url, onProgress)\n      .then(onLoad)\n      .catch(onError);\n\n    return texture;\n  }\n\n  async loadTextureAsync(texture, src, onProgress) {\n    let imageLoader;\n\n    if (window.createImageBitmap !== undefined) {\n      imageLoader = new THREE.ImageBitmapLoader(this.manager);\n      texture.flipY = false;\n    } else {\n      imageLoader = new THREE.ImageLoader(this.manager);\n    }\n\n    imageLoader.setCrossOrigin(this.crossOrigin);\n    imageLoader.setPath(this.path);\n\n    const cacheKey = this.manager.resolveURL(src);\n\n    texture.image = await loadAsync(imageLoader, src, onProgress);\n\n    // Image was just added to cache before this function gets called, disable caching by immediatly removing it\n    THREE.Cache.remove(cacheKey);\n\n    texture.needsUpdate = true;\n\n    texture.onUpdate = function() {\n      // Delete texture data once it has been uploaded to the GPU\n      texture.image.close && texture.image.close();\n      delete texture.image;\n    };\n\n    return texture;\n  }\n\n  setCrossOrigin(value) {\n    this.crossOrigin = value;\n    return this;\n  }\n\n  setPath(value) {\n    this.path = value;\n    return this;\n  }\n}\n","import { objectTypeForOriginAndContentType } from \"../object-types\";\nimport { getReticulumFetchUrl } from \"./phoenix-utils\";\nimport mediaHighlightFrag from \"./media-highlight-frag.glsl\";\nimport { mapMaterials } from \"./material-utils\";\nimport HubsTextureLoader from \"../loaders/HubsTextureLoader\";\nimport { validMaterials } from \"../components/hoverable-visuals\";\nimport { proxiedUrlFor } from \"../utils/media-url-utils\";\n\nconst mediaAPIEndpoint = getReticulumFetchUrl(\"/api/v1/media\");\n\n// Map<String, Promise<Object>\nconst resolveUrlCache = new Map();\nexport const resolveUrl = async (url, index) => {\n  const cacheKey = `${url}|${index}`;\n  if (resolveUrlCache.has(cacheKey)) return resolveUrlCache.get(cacheKey);\n\n  const resultPromise = fetch(mediaAPIEndpoint, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({ media: { url, index } })\n  }).then(async response => {\n    if (!response.ok) {\n      const message = `Error resolving url \"${url}\":`;\n      try {\n        const body = await response.text();\n        throw new Error(message + \" \" + body);\n      } catch (e) {\n        throw new Error(message + \" \" + response.statusText);\n      }\n    }\n    return response.json();\n  });\n\n  resolveUrlCache.set(cacheKey, resultPromise);\n  return resultPromise;\n};\n\nexport const upload = (file, desiredContentType) => {\n  const formData = new FormData();\n  formData.append(\"media\", file);\n  formData.append(\"promotion_mode\", \"with_token\");\n\n  if (desiredContentType) {\n    formData.append(\"desired_content_type\", desiredContentType);\n  }\n\n  return fetch(mediaAPIEndpoint, {\n    method: \"POST\",\n    body: formData\n  }).then(r => r.json());\n};\n\n// https://stackoverflow.com/questions/7584794/accessing-jpeg-exif-rotation-data-in-javascript-on-the-client-side/32490603#32490603\nfunction getOrientation(file, callback) {\n  const reader = new FileReader();\n  reader.onload = function(e) {\n    const view = new DataView(e.target.result);\n    if (view.getUint16(0, false) != 0xffd8) {\n      return callback(-2);\n    }\n    const length = view.byteLength;\n    let offset = 2;\n    while (offset < length) {\n      if (view.getUint16(offset + 2, false) <= 8) return callback(-1);\n      const marker = view.getUint16(offset, false);\n      offset += 2;\n      if (marker == 0xffe1) {\n        if (view.getUint32((offset += 2), false) != 0x45786966) {\n          return callback(-1);\n        }\n\n        const little = view.getUint16((offset += 6), false) == 0x4949;\n        offset += view.getUint32(offset + 4, little);\n        const tags = view.getUint16(offset, little);\n        offset += 2;\n        for (let i = 0; i < tags; i++) {\n          if (view.getUint16(offset + i * 12, little) == 0x0112) {\n            return callback(view.getUint16(offset + i * 12 + 8, little));\n          }\n        }\n      } else if ((marker & 0xff00) != 0xff00) {\n        break;\n      } else {\n        offset += view.getUint16(offset, false);\n      }\n    }\n    return callback(-1);\n  };\n  reader.readAsArrayBuffer(file);\n}\n\nlet interactableId = 0;\nexport const addMedia = (\n  src,\n  template,\n  contentOrigin,\n  contentSubtype = null,\n  resolve = false,\n  resize = false,\n  animate = true\n) => {\n  const scene = AFRAME.scenes[0];\n\n  const entity = document.createElement(\"a-entity\");\n  entity.id = \"interactable-media-\" + interactableId++;\n  entity.setAttribute(\"networked\", { template: template });\n  const needsToBeUploaded = src instanceof File;\n  entity.setAttribute(\"media-loader\", {\n    resize,\n    resolve,\n    animate,\n    src: typeof src === \"string\" ? src : \"\",\n    contentSubtype,\n    fileIsOwned: !needsToBeUploaded\n  });\n\n  entity.object3D.matrixNeedsUpdate = true;\n\n  scene.appendChild(entity);\n\n  const fireLoadingTimeout = setTimeout(() => {\n    scene.emit(\"media-loading\", { src: src });\n  }, 100);\n\n  [\"model-loaded\", \"video-loaded\", \"image-loaded\", \"pdf-loaded\"].forEach(eventName => {\n    entity.addEventListener(\n      eventName,\n      async () => {\n        clearTimeout(fireLoadingTimeout);\n        scene.emit(\"media-loaded\", { src: src });\n      },\n      { once: true }\n    );\n  });\n\n  const orientation = new Promise(function(resolve) {\n    if (needsToBeUploaded) {\n      getOrientation(src, x => {\n        resolve(x);\n      });\n    } else {\n      resolve(1);\n    }\n  });\n  if (needsToBeUploaded) {\n    // Video camera videos are converted to mp4 for compatibility\n    const desiredContentType = contentSubtype === \"video-camera\" ? \"video/mp4\" : null;\n\n    upload(src, desiredContentType)\n      .then(response => {\n        const srcUrl = new URL(proxiedUrlFor(response.origin));\n        srcUrl.searchParams.set(\"token\", response.meta.access_token);\n        entity.setAttribute(\"media-loader\", { resolve: false, src: srcUrl.href, fileId: response.file_id });\n        window.APP.store.update({\n          uploadPromotionTokens: [{ fileId: response.file_id, promotionToken: response.meta.promotion_token }]\n        });\n      })\n      .catch(e => {\n        console.error(\"Media upload failed\", e);\n        entity.setAttribute(\"media-loader\", { src: \"error\" });\n      });\n  } else if (src instanceof MediaStream) {\n    entity.setAttribute(\"media-loader\", { src: `hubs://clients/${NAF.clientId}/video` });\n  }\n\n  if (contentOrigin) {\n    entity.addEventListener(\"media_resolved\", ({ detail }) => {\n      const objectType = objectTypeForOriginAndContentType(contentOrigin, detail.contentType, detail.src);\n      scene.emit(\"object_spawned\", { objectType });\n    });\n  }\n\n  return { entity, orientation };\n};\n\nexport function injectCustomShaderChunks(obj) {\n  const vertexRegex = /\\bskinning_vertex\\b/;\n  const fragRegex = /\\bgl_FragColor\\b/;\n\n  const shaderUniforms = [];\n  const batchManagerSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].batchManagerSystem;\n\n  obj.traverse(object => {\n    if (!object.material) return;\n\n    object.material = mapMaterials(object, material => {\n      if (!validMaterials.includes(material.type)) {\n        return material;\n      }\n\n      // HACK, this routine inadvertently leaves the A-Frame shaders wired to the old, dark\n      // material, so maps cannot be updated at runtime. This breaks UI elements who have\n      // hover/toggle state, so for now just skip these while we figure out a more correct\n      // solution.\n      if (\n        object.el.classList.contains(\"ui\") ||\n        object.el.classList.contains(\"hud\") ||\n        object.el.getAttribute(\"text-button\")\n      )\n        return material;\n\n      // Used when the object is batched\n      batchManagerSystem.meshToEl.set(object, obj.el);\n\n      const newMaterial = material.clone();\n      // This will not run if the object is never rendered unbatched, since its unbatched shader will never be compiled\n      newMaterial.onBeforeCompile = shader => {\n        if (!vertexRegex.test(shader.vertexShader)) return;\n\n        shader.uniforms.hubs_IsFrozen = { value: false };\n        shader.uniforms.hubs_EnableSweepingEffect = { value: false };\n        shader.uniforms.hubs_SweepParams = { value: [0, 0] };\n        shader.uniforms.hubs_InteractorOnePos = { value: [0, 0, 0] };\n        shader.uniforms.hubs_InteractorTwoPos = { value: [0, 0, 0] };\n        shader.uniforms.hubs_HighlightInteractorOne = { value: false };\n        shader.uniforms.hubs_HighlightInteractorTwo = { value: false };\n        shader.uniforms.hubs_Time = { value: 0 };\n\n        const vchunk = `\n        if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\n          vec4 wt = modelMatrix * vec4(transformed, 1);\n\n          // Used in the fragment shader below.\n          hubs_WorldPosition = wt.xyz;\n        }\n      `;\n\n        const vlines = shader.vertexShader.split(\"\\n\");\n        const vindex = vlines.findIndex(line => vertexRegex.test(line));\n        vlines.splice(vindex + 1, 0, vchunk);\n        vlines.unshift(\"varying vec3 hubs_WorldPosition;\");\n        vlines.unshift(\"uniform bool hubs_IsFrozen;\");\n        vlines.unshift(\"uniform bool hubs_HighlightInteractorOne;\");\n        vlines.unshift(\"uniform bool hubs_HighlightInteractorTwo;\");\n        shader.vertexShader = vlines.join(\"\\n\");\n\n        const flines = shader.fragmentShader.split(\"\\n\");\n        const findex = flines.findIndex(line => fragRegex.test(line));\n        flines.splice(findex + 1, 0, mediaHighlightFrag);\n        flines.unshift(\"varying vec3 hubs_WorldPosition;\");\n        flines.unshift(\"uniform bool hubs_IsFrozen;\");\n        flines.unshift(\"uniform bool hubs_EnableSweepingEffect;\");\n        flines.unshift(\"uniform vec2 hubs_SweepParams;\");\n        flines.unshift(\"uniform bool hubs_HighlightInteractorOne;\");\n        flines.unshift(\"uniform vec3 hubs_InteractorOnePos;\");\n        flines.unshift(\"uniform bool hubs_HighlightInteractorTwo;\");\n        flines.unshift(\"uniform vec3 hubs_InteractorTwoPos;\");\n        flines.unshift(\"uniform float hubs_Time;\");\n        shader.fragmentShader = flines.join(\"\\n\");\n\n        shaderUniforms.push(shader.uniforms);\n      };\n      newMaterial.needsUpdate = true;\n      return newMaterial;\n    });\n  });\n\n  return shaderUniforms;\n}\n\nexport function getPromotionTokenForFile(fileId) {\n  return window.APP.store.state.uploadPromotionTokens.find(upload => upload.fileId === fileId);\n}\n\nconst mediaPos = new THREE.Vector3();\n\nexport function addAndArrangeMedia(el, media, contentSubtype, snapCount, mirrorOrientation = false) {\n  const { entity, orientation } = addMedia(media, \"#interactable-media\", undefined, contentSubtype, false);\n\n  const pos = el.object3D.position;\n\n  entity.object3D.position.set(pos.x, pos.y, pos.z);\n  entity.object3D.rotation.copy(el.object3D.rotation);\n\n  if (mirrorOrientation) {\n    entity.object3D.rotateY(Math.PI);\n  }\n\n  // Generate photos in a circle around camera, starting from the bottom.\n  // Prevent z-fighting but place behind viewfinder\n  const idx = (snapCount % 6) + 3;\n\n  mediaPos.set(\n    Math.cos(Math.PI * 2 * (idx / 6.0)) * 0.75,\n    Math.sin(Math.PI * 2 * (idx / 6.0)) * 0.75,\n    -0.05 + idx * 0.001\n  );\n\n  el.object3D.localToWorld(mediaPos);\n  entity.object3D.visible = false;\n\n  const handler = () => {\n    entity.object3D.visible = true;\n    entity.setAttribute(\"animation__photo_pos\", {\n      property: \"position\",\n      dur: 800,\n      from: { x: pos.x, y: pos.y, z: pos.z },\n      to: { x: mediaPos.x, y: mediaPos.y, z: mediaPos.z },\n      easing: \"easeOutElastic\"\n    });\n  };\n\n  let eventType = null;\n\n  if (contentSubtype.startsWith(\"photo\")) {\n    entity.addEventListener(\"image-loaded\", handler, { once: true });\n    eventType = \"photo\";\n  } else if (contentSubtype.startsWith(\"video\")) {\n    entity.addEventListener(\"video-loaded\", handler, { once: true });\n    eventType = \"video\";\n  } else {\n    console.error(\"invalid type \" + contentSubtype);\n    return;\n  }\n\n  entity.object3D.matrixNeedsUpdate = true;\n\n  entity.addEventListener(\n    \"media_resolved\",\n    () => {\n      el.emit(`${eventType}_taken`, entity.components[\"media-loader\"].data.src);\n    },\n    { once: true }\n  );\n\n  return { entity, orientation };\n}\n\nexport const textureLoader = new HubsTextureLoader().setCrossOrigin(\"anonymous\");\n\nexport async function createImageTexture(url) {\n  const texture = new THREE.Texture();\n\n  try {\n    await textureLoader.loadTextureAsync(texture, url);\n  } catch (e) {\n    throw new Error(`'${url}' could not be fetched (Error code: ${e.status}; Response: ${e.statusText})`);\n  }\n\n  texture.encoding = THREE.sRGBEncoding;\n  texture.anisotropy = 4;\n\n  return texture;\n}\n","module.exports = __webpack_public_path__ + \"assets/images/warning_icon-739d2a2ea906737505bcbc2cb51123a8.png\";","module.exports = __webpack_public_path__ + \"assets/images/warning_icon@2x-706e4a4db33f9456bac320e956b4120d.png\";","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { injectIntl, FormattedMessage } from \"react-intl\";\nimport classNames from \"classnames\";\nimport \"three/examples/js/controls/OrbitControls\";\n\nimport { createDefaultEnvironmentMap } from \"../components/environment-map\";\nimport { loadGLTF } from \"../components/gltf-model-plus\";\nimport { disposeNode } from \"../utils/three-utils\";\nimport { createImageBitmap, disposeImageBitmap } from \"../utils/image-bitmap-utils\";\nimport styles from \"../assets/stylesheets/avatar-preview.scss\";\n\nconst TEXTURE_PROPS = {\n  base_map: [\"map\"],\n  emissive_map: [\"emissiveMap\"],\n  normal_map: [\"normalMap\"],\n  orm_map: [\"aoMap\", \"roughnessMap\", \"metalnessMap\"]\n};\n\nconst ALL_MAPS = Object.keys(TEXTURE_PROPS);\n\n// This should match our aframe renderer=\"antialias: true; colorManagement: true; sortObjects: true;\n// physicallyCorrectLights: true; webgl2: true; multiview: false;\"\nfunction createRenderer(canvas, alpha = false, useDevicePixelRatio = true) {\n  const context = canvas.getContext(\"webgl2\", {\n    alpha,\n    depth: true,\n    antialias: true,\n    premultipliedAlpha: true,\n    preserveDrawingBuffer: false,\n    powerPreference: \"default\"\n  });\n\n  const renderer = new THREE.WebGLRenderer({ alpha, canvas, context });\n  renderer.gammaOutput = true;\n  renderer.gammaFactor = 2.2;\n  renderer.physicallyCorrectLights = true;\n  if (useDevicePixelRatio) {\n    renderer.setPixelRatio(window.devicePixelRatio);\n  }\n  return renderer;\n}\n\nconst createImageBitmapFromURL = url =>\n  fetch(url)\n    .then(r => r.blob())\n    .then(createImageBitmap);\n\nconst ORBIT_ANGLE = new THREE.Euler(-30 * THREE.Math.DEG2RAD, 30 * THREE.Math.DEG2RAD, 0);\nconst DEFAULT_MARGIN = 1;\n\nfunction fitBoxInFrustum(camera, box, center, margin = DEFAULT_MARGIN) {\n  const halfYExtents = Math.max(box.max.y - center.y, center.y - box.min.y);\n  const halfVertFOV = THREE.Math.degToRad(camera.fov / 2);\n  camera.position.set(0, 0, (halfYExtents / Math.tan(halfVertFOV) + box.max.z) * margin);\n  camera.position.applyEuler(ORBIT_ANGLE);\n  camera.position.add(center);\n  camera.lookAt(center);\n}\n\nclass AvatarPreview extends Component {\n  static propTypes = {\n    avatarGltfUrl: PropTypes.string,\n    className: PropTypes.string\n  };\n  constructor(props) {\n    super(props);\n    this.state = { loading: true, error: null };\n    this.avatar = null;\n    this.imageBitmaps = {};\n  }\n\n  componentDidMount = () => {\n    this.scene = new THREE.Scene();\n\n    this.camera = new THREE.PerspectiveCamera(55, this.canvas.clientWidth / this.canvas.clientHeight, 0.1, 1000);\n    this.controls = new THREE.OrbitControls(this.camera, this.canvas);\n    this.controls.enablePan = false;\n\n    const light = new THREE.DirectionalLight(0xf7f6ef, 1);\n    light.position.set(0, 10, 10);\n    this.scene.add(light);\n    this.scene.add(new THREE.HemisphereLight(0xb1e3ff, 0xb1e3ff, 2.5));\n\n    this.camera.position.set(-0.2, 0.5, 0.5);\n    this.camera.matrixAutoUpdate = true;\n\n    this.controls.target.set(0, 0.45, 0);\n    this.controls.update();\n\n    if (this.props.avatarGltfUrl) {\n      this.loadPreviewAvatar(this.props.avatarGltfUrl).then(this.setAvatar);\n    }\n\n    const clock = new THREE.Clock();\n\n    this.snapshotCanvas = document.createElement(\"canvas\");\n    this.snapshotCanvas.width = 720;\n    this.snapshotCanvas.height = 1280;\n    this.snapshotCamera = new THREE.PerspectiveCamera(55, 720 / 1280, 0.1, 1000);\n    this.snapshotCamera.matrixAutoUpdate = true;\n    this.snapshotRenderer = createRenderer(this.snapshotCanvas, true, false);\n    this.snapshotRenderer.setClearAlpha(0);\n\n    this.previewRenderer = createRenderer(this.canvas);\n    this.previewRenderer.setClearColor(0xeaeaea);\n    this.previewRenderer.setAnimationLoop(() => {\n      const dt = clock.getDelta();\n      this.mixer && this.mixer.update(dt);\n      this.previewRenderer.render(this.scene, this.camera);\n    });\n    window.addEventListener(\"resize\", this.resize);\n    this.resize();\n  };\n\n  resize = () => {\n    const width = this.canvas.parentElement.offsetWidth;\n    const height = this.canvas.parentElement.offsetHeight;\n    this.previewRenderer.setSize(width, height);\n    this.camera.aspect = width / height;\n    this.camera.updateProjectionMatrix();\n  };\n\n  setAvatar = avatar => {\n    if (!avatar) return;\n    this.avatar = avatar;\n    this.scene.add(avatar);\n    this.resetCamera();\n    this.setState({ error: null, loading: false });\n  };\n\n  resetCamera = (() => {\n    const box = new THREE.Box3();\n    const center = new THREE.Vector3();\n    return () => {\n      box.setFromObject(this.avatar);\n      box.getCenter(center);\n\n      // Shift the center vertically in order to frame the avatar nicely.\n      center.y = (box.max.y - box.min.y) * 0.6 + box.min.y;\n\n      fitBoxInFrustum(this.camera, box, center);\n      fitBoxInFrustum(this.snapshotCamera, box, center, 0.7);\n\n      this.controls.target.copy(center);\n      this.controls.update();\n    };\n  })();\n\n  componentWillUnmount = () => {\n    // Gotta be particularly careful about disposing things here since we will likely create many avatar\n    // previews during a session and Chrome will eventually discard the oldest webgl context if we leak\n    // contexts by holding on to them directly or indirectly.\n\n    this.scene && this.scene.traverse(disposeNode);\n    if (this.previewRenderer) {\n      this.previewRenderer.dispose();\n      this.previewRenderer.context = null;\n    }\n    if (this.snapshotRenderer) {\n      this.snapshotRenderer.dispose();\n      this.snapshotRenderer.context = null;\n    }\n    if (this.controls) {\n      this.controls.dispose();\n      this.controls.domElement = null;\n    }\n\n    Object.values(this.imageBitmaps).forEach(img => disposeImageBitmap(img));\n    window.removeEventListener(\"resize\", this.resize);\n  };\n\n  componentDidUpdate = async oldProps => {\n    if (oldProps.avatarGltfUrl !== this.props.avatarGltfUrl) {\n      if (this.avatar) {\n        this.scene.remove(this.avatar);\n        this.avatar = null;\n      }\n      if (this.props.avatarGltfUrl) {\n        this.setState({ error: null, loading: true });\n        await this.loadPreviewAvatar(this.props.avatarGltfUrl).then(this.setAvatar);\n      }\n    }\n    this.applyMaps(oldProps, this.props);\n  };\n\n  applyMaps(oldProps, newProps) {\n    return Promise.all(\n      ALL_MAPS.map(mapName => {\n        const applyMap = this.applyMapToPreview.bind(this, mapName);\n        if (oldProps[mapName] != newProps[mapName]) {\n          if (newProps[mapName] instanceof File) {\n            return createImageBitmap(newProps[mapName]).then(applyMap);\n          } else if (newProps[mapName]) {\n            return createImageBitmapFromURL(newProps[mapName]).then(applyMap);\n          } else {\n            return this.revertMap(mapName);\n          }\n        }\n      })\n    );\n  }\n\n  loadPreviewAvatar = async avatarGltfUrl => {\n    let gltf;\n    try {\n      gltf = await loadGLTF(avatarGltfUrl, \"model/gltf\");\n    } catch (e) {\n      this.setState({ loading: false, error: true });\n      return;\n    }\n\n    // On the backend we look for a material called Bot_PBS, here we are looking for a mesh called Avatar.\n    // When we \"officially\" support uploading custom GLTFs we need to decide what we are going to key things on\n    this.previewMesh =\n      gltf.scene.getObjectByName(\"AvatarMesh\") ||\n      gltf.scene.getObjectByName(\"Avatar\") ||\n      gltf.scene.getObjectByName(\"Bot_Skinned\") ||\n      gltf.scene;\n\n    const idleAnimation = gltf.animations && gltf.animations.find(({ name }) => name === \"idle_eyes\");\n    if (idleAnimation) {\n      this.mixer = new THREE.AnimationMixer(this.previewMesh);\n      const action = this.mixer.clipAction(idleAnimation);\n      action.enabled = true;\n      action.setLoop(THREE.LoopRepeat, Infinity).play();\n      this.idleAnimationAction = action;\n    }\n\n    const { material } = this.previewMesh;\n    if (material) {\n      // We delete onUpdate here to opt out of the auto texture cleanup after GPU upload.\n      const getImage = p => delete material[p].onUpdate && material[p].image;\n      this.originalMaps = {\n        base_map: TEXTURE_PROPS[\"base_map\"].map(getImage),\n        emissive_map: TEXTURE_PROPS[\"emissive_map\"].map(getImage),\n        normal_map: TEXTURE_PROPS[\"normal_map\"].map(getImage),\n        orm_map: TEXTURE_PROPS[\"orm_map\"].map(getImage)\n      };\n\n      await Promise.all([\n        this.applyMaps({}, this.props), // Apply initial maps\n        createDefaultEnvironmentMap().then(t => {\n          this.previewMesh.material.envMap = t;\n          this.previewMesh.material.needsUpdate = true;\n        })\n      ]);\n    } else {\n      this.originalMaps = {};\n    }\n\n    return gltf.scene;\n  };\n\n  applyMapToPreview = (name, image) => {\n    if (this.imageBitmaps[name]) {\n      disposeImageBitmap(this.imageBitmaps[name]);\n    }\n    this.imageBitmaps[name] = image;\n    TEXTURE_PROPS[name].forEach(prop => {\n      const texture = this.previewMesh.material[prop];\n      texture.image = image;\n      texture.needsUpdate = true;\n    });\n  };\n\n  revertMap = name => {\n    if (this.imageBitmaps[name]) {\n      disposeImageBitmap(this.imageBitmaps[name]);\n    }\n    delete this.imageBitmaps[name];\n    this.originalMaps[name].forEach((bm, i) => {\n      const texture = this.previewMesh.material[TEXTURE_PROPS[name][i]];\n      texture.image = bm;\n      texture.needsUpdate = true;\n    });\n  };\n\n  snapshot = () => {\n    return new Promise(resolve => {\n      if (this.idleAnimationAction) this.idleAnimationAction.stop();\n      this.snapshotRenderer.render(this.scene, this.snapshotCamera);\n      this.snapshotCanvas.toBlob(blob => {\n        if (this.idleAnimationAction) this.idleAnimationAction.play();\n        resolve(blob);\n      });\n    });\n  };\n\n  render() {\n    return (\n      <div className={classNames(styles.preview, this.props.className)}>\n        {this.state.loading &&\n          !this.state.error && (\n            <div className=\"loader\">\n              <div className=\"loader-center\" />\n            </div>\n          )}\n        {this.state.error &&\n          !this.state.loading && (\n            <div className=\"error\">\n              <img\n                src=\"../assets/images/warning_icon.png\"\n                srcSet=\"../assets/images/warning_icon@2x.png 2x\"\n                className=\"error-icon\"\n              />\n              <FormattedMessage id=\"avatar-preview.loading-failed\" />\n            </div>\n          )}\n        <canvas ref={c => (this.canvas = c)} />\n      </div>\n    );\n  }\n}\n\nexport default injectIntl(AvatarPreview, { withRef: true });\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\nimport { getAirtableAssets, airtableAssetsInitialState } from '../everyspace/airtable'\n\nimport styles from \"../assets/stylesheets/sign-in-dialog.scss\";\nimport DialogContainer from \"./dialog-container\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\n\nexport default class SignInDialog extends Component {\n  static propTypes = {\n    authStarted: PropTypes.bool,\n    authComplete: PropTypes.bool,\n    onSignIn: PropTypes.func,\n    onContinue: PropTypes.func,\n    message: PropTypes.string,\n    continueText: PropTypes.string,\n    privacyLink: PropTypes.string,\n    termsLink: PropTypes.string\n  };\n\n  state = {\n    email: \"\",\n    airtableAssets: airtableAssetsInitialState\n  };\n\n  componentWillMount(){\n    this.fetchAirtableAssets()\n  }\n\n  fetchAirtableAssets = async () => {\n    const airtableAssets = await getAirtableAssets()\n    if (airtableAssets) this.setState({ airtableAssets })\n  }\n\n  onSubmit = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    this.props.onSignIn(this.state.email);\n  };\n\n  render() {\n    let contents;\n    if (this.props.authStarted) {\n      contents = (\n        <p>\n          <FormattedMessage className=\"preformatted\" id=\"sign-in.auth-started\" />\n        </p>\n      );\n    } else if (this.props.authComplete) {\n      contents = (\n        <div className={styles.signInComplete}>\n          <p>{this.props.message}</p>\n          <button onClick={this.props.onContinue} className={styles.continueButton}>\n            {this.props.continueText}\n          </button>\n        </div>\n      );\n    } else {\n      contents = (\n        <form onSubmit={this.onSubmit} className={styles.signInForm}>\n          <span>{this.state.airtableAssets.Sign_In_Message}</span>\n          <input\n            name=\"email\"\n            type=\"email\"\n            required\n            placeholder=\"Your email address\"\n            value={this.state.email}\n            onFocus={e => handleTextFieldFocus(e.target)}\n            onBlur={() => handleTextFieldBlur()}\n            onChange={e => this.setState({ email: e.target.value })}\n            className={styles.emailField}\n          />\n          <p className={styles.terms}>\n            By proceeding, you agree to the{\" \"}\n            <a rel=\"noopener noreferrer\" target=\"_blank\" href={this.state.airtableAssets.Terms_Link || \"https://github.com/mozilla/hubs/blob/master/TERMS.md\"}>\n              terms of use\n            </a>{\" \"}\n            and{\" \"}\n            <a rel=\"noopener noreferrer\" target=\"_blank\" href={this.state.airtableAssets.Privacy_Link || \"https://github.com/mozilla/hubs/blob/master/PRIVACY.md\"}>\n              privacy notice\n            </a>.\n          </p>\n          <button type=\"submit\" className={styles.nextButton}>\n            next\n          </button>\n        </form>\n      );\n    }\n\n    return (\n      <DialogContainer title=\"Sign In\" {...this.props}>\n        {contents}\n      </DialogContainer>\n    );\n  }\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"client-action-buttons\":\"client-info-dialog__client-action-buttons__3u-6v\",\"clientActionButtons\":\"client-info-dialog__client-action-buttons__3u-6v\",\"cancel\":\"client-info-dialog__cancel__2BguV\",\"client-info-dialog\":\"client-info-dialog__client-info-dialog__2e1dc\",\"clientInfoDialog\":\"client-info-dialog__client-info-dialog__2e1dc\",\"title\":\"client-info-dialog__title__3FGPe\",\"community-identifier\":\"client-info-dialog__community-identifier__g3lbP\",\"communityIdentifier\":\"client-info-dialog__community-identifier__g3lbP\",\"client-info\":\"client-info-dialog__client-info__1MUSa\",\"clientInfo\":\"client-info-dialog__client-info__1MUSa\",\"client-profile-image\":\"client-info-dialog__client-profile-image__zt1EA\",\"clientProfileImage\":\"client-info-dialog__client-profile-image__zt1EA\",\"client-details\":\"client-info-dialog__client-details__1F5zy\",\"clientDetails\":\"client-info-dialog__client-details__1F5zy\",\"client-main\":\"client-info-dialog__client-main__2BC1s\",\"clientMain\":\"client-info-dialog__client-main__2BC1s\",\"button-icon\":\"client-info-dialog__button-icon__1vKfx\",\"buttonIcon\":\"client-info-dialog__button-icon__1vKfx\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"name-field\":\"room-settings-dialog__name-field___yGhb\",\"nameField\":\"room-settings-dialog__name-field___yGhb\",\"next-button\":\"room-settings-dialog__next-button__2F9Jd\",\"nextButton\":\"room-settings-dialog__next-button__2F9Jd\",\"continue-button\":\"room-settings-dialog__continue-button__2Ltsg\",\"continueButton\":\"room-settings-dialog__continue-button__2Ltsg\",\"room-settings-form\":\"room-settings-dialog__room-settings-form__yNism\",\"roomSettingsForm\":\"room-settings-dialog__room-settings-form__yNism\",\"permission\":\"room-settings-dialog__permission__3W-cW\",\"subtitle\":\"room-settings-dialog__subtitle__2ddy2\",\"permissions\":\"room-settings-dialog__permissions__1sHPN\",\"permissions-group\":\"room-settings-dialog__permissions-group__1oRYA\",\"permissionsGroup\":\"room-settings-dialog__permissions-group__1oRYA\",\"permission-disabled\":\"room-settings-dialog__permission-disabled__3NH-j\",\"permissionDisabled\":\"room-settings-dialog__permission-disabled__3NH-j\"};","const qs = new URLSearchParams(location.search);\n\nexport default function qsTruthy(param) {\n  const val = qs.get(param);\n  // if the param exists but is not set (e.g. \"?foo&bar\"), its value is the empty string.\n  return val === \"\" || /1|on|true|yes/i.test(val);\n}\n","export function findAncestorWithComponent(entity, componentName) {\n  while (entity && !(entity.components && entity.components[componentName])) {\n    entity = entity.parentNode;\n  }\n  return entity;\n}\n","// Computes an AABB that surrounds the object in question and all of its children.\n// Note that if the children have rotations, this probably won't return the tightest\n// possible AABB -- we could return a tighter one if we examined all of the vertices\n// of the geometry for ourselves, but we don't care enough for what we're using this\n// for to do so much work.\nconst computeObjectAABB = (function() {\n  const bounds = new THREE.Box3();\n  return function(root, target) {\n    target.makeEmpty();\n    root.traverse(node => {\n      const geometry = node.geometry;\n      if (geometry != null) {\n        if (geometry.boundingBox == null) {\n          geometry.computeBoundingBox();\n        }\n        target.union(bounds.copy(geometry.boundingBox).applyMatrix4(node.matrixWorld));\n      }\n    });\n    return target;\n  };\n})();\n\nconst rotation = new THREE.Euler();\nexport function getBox(entity, boxRoot) {\n  const box = new THREE.Box3();\n\n  rotation.copy(entity.object3D.rotation);\n  entity.object3D.rotation.set(0, 0, 0);\n\n  entity.object3D.updateMatrices(true, true);\n  boxRoot.updateMatrices(true, true);\n  boxRoot.updateMatrixWorld(true);\n\n  computeObjectAABB(boxRoot, box);\n\n  if (!box.isEmpty()) {\n    entity.object3D.worldToLocal(box.min);\n    entity.object3D.worldToLocal(box.max);\n    entity.object3D.rotation.copy(rotation);\n    entity.object3D.matrixNeedsUpdate = true;\n  }\n\n  boxRoot.matrixWorldNeedsUpdate = true;\n  boxRoot.updateMatrices();\n\n  return box;\n}\n\nexport function getScaleCoefficient(length, box) {\n  if (box.isEmpty()) return 1.0;\n\n  const { max, min } = box;\n  const dX = Math.abs(max.x - min.x);\n  const dY = Math.abs(max.y - min.y);\n  const dZ = Math.abs(max.z - min.z);\n  const lengthOfLongestComponent = Math.max(dX, dY, dZ);\n  return length / lengthOfLongestComponent;\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"load-button\":\"preload-overlay__load-button__ba1d4\",\"loadButton\":\"preload-overlay__load-button__ba1d4\",\"treatment\":\"preload-overlay__treatment__1L4r0\",\"screenshot\":\"preload-overlay__screenshot__3TZYm\",\"hub-name\":\"preload-overlay__hub-name__2txaT\",\"hubName\":\"preload-overlay__hub-name__2txaT\",\"main-panel\":\"preload-overlay__main-panel__2EX4k\",\"mainPanel\":\"preload-overlay__main-panel__2EX4k\",\"logo\":\"preload-overlay__logo__1IJJc\"};","import {Helmet} from 'react-helmet'\nimport React from \"react\";\n\nexport const HelmetComponent = ({assets, page}) => {\n\tlet pageTitle = page;\n\tconst titleRoot = assets.Page_Title_Root;\n\tif (titleRoot) pageTitle = `${titleRoot} | ${page}`;\n\treturn <Helmet>\n        <title>{pageTitle}</title>\n        <link rel=\"icon\" sizes=\"16x16 24x24 32x32 48x48 64x64\" href={assets.Favicon} />\n\t    <meta property=\"og:title\" content={assets.Name} />\n\t    <meta property=\"og:description\" content={assets.Social_Description} />\n\t    <meta property=\"og:image\" content={assets.Social_Image} />\n\t    <meta name=\"twitter:site\" content={assets.Twitter_Handle} />\n\t    <meta name=\"twitter:title\" content={assets.Name} />\n\t    <meta name=\"twitter:image\" content={assets.Social_Image} />\n\t    <meta name=\"twitter:description\" content={assets.Social_Description} />\n\t    <meta name=\"application-name\" content={assets.Name} />\n    </Helmet>\n}","// extracted by mini-css-extract-plugin\nmodule.exports = {\"preview\":\"avatar-preview__preview__2I8qx\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"action-button\":\"change-scene-dialog__action-button__1xtdK\",\"actionButton\":\"change-scene-dialog__action-button__1xtdK\",\"buttons\":\"change-scene-dialog__buttons__2QE34\",\"spoke-launch\":\"change-scene-dialog__spoke-launch__YObDn\",\"spokeLaunch\":\"change-scene-dialog__spoke-launch__YObDn\",\"input-border\":\"change-scene-dialog__input-border__30jd6\",\"inputBorder\":\"change-scene-dialog__input-border__30jd6\",\"left-side-of-input\":\"change-scene-dialog__left-side-of-input__14WKu\",\"leftSideOfInput\":\"change-scene-dialog__left-side-of-input__14WKu\",\"change-scene-button\":\"change-scene-dialog__change-scene-button__ckfZW\",\"changeSceneButton\":\"change-scene-dialog__change-scene-button__ckfZW\",\"spoke-create\":\"change-scene-dialog__spoke-create__2krL-\",\"spokeCreate\":\"change-scene-dialog__spoke-create__2krL-\"};","import Airtable from 'airtable';\nAirtable.configure({\n    endpointUrl: 'https://api.airtable.com',\n    apiKey: 'keyOHSVeLr3ryLrL5'\n});\nconst base = Airtable.base('appIR0AlHDFG5WR8z');\n\nexport const airtableAssetsInitialState = { DarkLogo: null, Name: null, Icon: null }\n\nlet assets;\n\nconst airtableAssets = base('Assets');\n// export const getAirtableAssets = () => airtableAssets.find('recHqITRS7cBMwn9i');\nexport const getAirtableAssets = async () => {\n    if (assets) return assets;\n    const result = await airtableAssets.select({\n        view: 'Grid view'\n    }).firstPage()\n    assets = result[0].fields;\n    return result[0].fields\n}\n\nexport const airtableMessages = base('Messages').select({\n    view: 'Grid view'\n}).firstPage(async (err, records) => {\n    if (err) { console.error(err); return; }\n    const record = records[0];\n    return record;\n});;","// extracted by mini-css-extract-plugin\nmodule.exports = {\"oauth-discord-button\":\"oauth-dialog__oauth-discord-button__A_Zra\",\"oauthDiscordButton\":\"oauth-dialog__oauth-discord-button__A_Zra\",\"oauth-twitter-button\":\"oauth-dialog__oauth-twitter-button__Vh4oX\",\"oauthTwitterButton\":\"oauth-dialog__oauth-twitter-button__Vh4oX\",\"oauth-button\":\"oauth-dialog__oauth-button__25RiO\",\"oauthButton\":\"oauth-dialog__oauth-button__25RiO\",\"oauth-type-name\":\"oauth-dialog__oauth-type-name__jPyhW\",\"oauthTypeName\":\"oauth-dialog__oauth-type-name__jPyhW\",\"oauth-icon\":\"oauth-dialog__oauth-icon__v1G6W\",\"oauthIcon\":\"oauth-dialog__oauth-icon__v1G6W\",\"privacy-notice\":\"oauth-dialog__privacy-notice__2R9ZT\",\"privacyNotice\":\"oauth-dialog__privacy-notice__2R9ZT\",\"oauth-buttons\":\"oauth-dialog__oauth-buttons__1U1Ni\",\"oauthButtons\":\"oauth-dialog__oauth-buttons__1U1Ni\",\"twitter-message\":\"oauth-dialog__twitter-message__cWCES\",\"twitterMessage\":\"oauth-dialog__twitter-message__cWCES\"};","import { airtableMessages } from './airtable'\nimport { Name, Hero_Blurb } from './customization'\nimport translations from '../assets/translations.data.json';\nlet modifiedTranslations = translations;\nconst name = Name;\n// const name = airtableMessages && airtableMessages.get('Name') || \"Axon Park\";\n\n// modifiedTranslations.en[\"home.hero_blurb\"] = airtableMessages && airtableMessages.get('Motto') || 'Learn together, from anywhere.\\nThe future of learning is virtual.\\nEqualizing access to premier quality education.';\nmodifiedTranslations.en[\"home.hero_blurb\"] = Hero_Blurb;\nmodifiedTranslations.en[\"sign-in.rename-room\"] = `You'll need to sign in to rename ${name}.`;\nmodifiedTranslations.en[\"sign-in.close-room\"] = `You'll need to sign in to close ${name}.`;\nmodifiedTranslations.en[\"rename-room.message\"] = `Enter the new name for ${name}.`;\nmodifiedTranslations.en[\"rename-room.rename\"] = `Rename ${name}`;\nmodifiedTranslations.en[\"close-room.message\"] =\n  `Closing this room will remove yourself and others from ${name}, shutting it down permanently.\\n\\nAre you sure? This action cannot be undone.`;\nmodifiedTranslations.en[\"close-room.confirm\"] = `Yes, Close ${name}`;\nmodifiedTranslations.en[\"entry.enter-room\"] = `Enter ${name}`;\nmodifiedTranslations.en[\"entry.leave-room\"] = `Leave ${name}`;\nmodifiedTranslations.en[\"entry.in-lobby-notice\"] = `You are viewing ${name} from the lobby.`;\nmodifiedTranslations.en[\"exit.subtitle.kicked\"] = `You have been kicked from ${name}.`;\nmodifiedTranslations.en[\"exit.subtitle.left\"] = `You have left ${name}.`;\nmodifiedTranslations.en[\"exit.subtitle.disconnected\"] = `You have disconnected from ${name}. Refresh the page to try to reconnect.`;\nmodifiedTranslations.en[\"presence.entered_room\"] = `entered ${name}.`;\nmodifiedTranslations.en[\"presence.entered_lobby\"] = `entered ${name}'s lobby.`;\nmodifiedTranslations.en[\"presence.join_lobby\"] = `joined the ${name} lobby.`;\nmodifiedTranslations.en[\"presence.join_room\"] = `joined ${name}.`;\nmodifiedTranslations.en[\"presence.in_lobby\"] = `${name} Lobby`;\nmodifiedTranslations.en[\"presence.in_room\"] = `In ${name}`;\nmodifiedTranslations.en[\"home.create_a_room\"] = `Initialize ${name}`;\nmodifiedTranslations.en[\"home.room_create_button\"] = `Initialize ${name}`;\nmodifiedTranslations.en[\"home.have_code\"] = `Have an ${name} code?`;\nmodifiedTranslations.en[\"commands.leave\"] = `Disconnect from ${name}.`;\nmodifiedTranslations.en[\"settings.rename-room\"] = `Set ${name} Name...`;\nmodifiedTranslations.en[\"settings.close-room\"] = `Close ${name}...`;\nmodifiedTranslations.en[\"settings.leave-room\"] = `Leave ${name}`;\nmodifiedTranslations.en[\"settings.room-info\"] = `${name} Info`;\nmodifiedTranslations.en[\"settings.create-room\"] = `New ${name}...`;\nmodifiedTranslations.en[\"settings.row-room\"] = `${name}`;\nmodifiedTranslations.en[\"settings.room-settings\"] = `${name} Settings`;\nmodifiedTranslations.en[\"tips.mobile.object_pin\"] = `Pin an object to save it to ${name}.`;\nmodifiedTranslations.en[\"tips.mobile.object_pin\"] = `Pin an object to save it to ${name}.`;\nmodifiedTranslations.en[\"tips.mobile.invite\"] = `Use the Invite button to share ${name}.`;\nmodifiedTranslations.en[\"tips.desktop.object_pin\"] = `Pin an object to save it to ${name}.`;\nmodifiedTranslations.en[\"tips.watching.back\"] = `Enter ${name}`;\nmodifiedTranslations.en[\"leave-room-dialog.create-room.confirm\"] = `Leave ${name}.`;\n\nexport default modifiedTranslations;","export const Name = \"Axon Park\";\nexport const Hero_Blurb = 'Learn together, from anywhere.\\nThe future of learning is virtual.\\nEqualizing access to premier quality education.';","import localeData from \"../everyspace/messages.js\";\n// import localeData from \"../assets/translations.data.json\";\nconst navigatorLang = ((navigator.languages && navigator.languages[0]) || navigator.language || navigator.userLanguage)\n  .toLowerCase()\n  .split(/[_-]+/)[0];\nexport const lang = (localeData[navigatorLang] && navigatorLang) || \"en\";\nexport const messages = localeData[lang] || localeData.en;\n","// A-Frame blows away any npm debug log filters so this allow the user to set the log filter\n// via the query string.\nimport debug from \"debug\";\nimport qsTruthy from \"./qs_truthy\";\n\nconst qs = new URLSearchParams(location.search);\nconst isDebug = qsTruthy(\"debug\");\nconst logFilter = qs.get(\"log_filter\") || (isDebug && \"naf-janus-adapter:*\");\n\nif (logFilter) {\n  debug.enable(logFilter);\n}\n","// This computation is expensive, so we run on at most one avatar per frame, including quiet avatars.\n// However if we detect an avatar is seen speaking (its volume is above DISABLE_AT_VOLUME_THRESHOLD)\n// then we continue analysis for at least DISABLE_GRACE_PERIOD_MS and disable doing it every frame if\n// the avatar is quiet during that entire duration (eg they are muted)\nconst DISABLE_AT_VOLUME_THRESHOLD = 0.00001;\nconst DISABLE_GRACE_PERIOD_MS = 10000;\nconst MIN_VOLUME_THRESHOLD = 0.01;\n\nconst calculateVolume = (analyser, levels) => {\n  // take care with compatibility, e.g. safari doesn't support getFloatTimeDomainData\n  analyser.getByteTimeDomainData(levels);\n  let sum = 0;\n  for (let i = 0; i < levels.length; i++) {\n    const amplitude = (levels[i] - 128) / 128;\n    sum += amplitude * amplitude;\n  }\n  const currVolume = Math.sqrt(sum / levels.length);\n  return currVolume < MIN_VOLUME_THRESHOLD ? 0 : currVolume;\n};\n\nconst tempScaleFromPosition = new THREE.Vector3();\nconst tempScaleToPosition = new THREE.Vector3();\n\nexport function getAudioFeedbackScale(fromObject, toObject, minScale, maxScale, volume) {\n  tempScaleToPosition.setFromMatrixPosition(toObject.matrixWorld);\n  tempScaleFromPosition.setFromMatrixPosition(fromObject.matrixWorld);\n  const distance = tempScaleFromPosition.distanceTo(tempScaleToPosition) / 10;\n  return Math.min(maxScale, minScale + (maxScale - minScale) * volume * 8 * distance);\n}\n\n/**\n * Emits audioFrequencyChange events based on a networked audio source\n * @namespace avatar\n * @component networked-audio-analyser\n */\nAFRAME.registerComponent(\"networked-audio-analyser\", {\n  async init() {\n    this.volume = 0;\n    this.prevVolume = 0;\n    this._updateAnalysis = this._updateAnalysis.bind(this);\n    this._runScheduledWork = this._runScheduledWork.bind(this);\n    this.el.sceneEl.systems[\"frame-scheduler\"].schedule(this._updateAnalysis, \"audio-analyser\");\n    this.el.addEventListener(\"sound-source-set\", event => {\n      const ctx = THREE.AudioContext.getContext();\n      this.analyser = ctx.createAnalyser();\n      this.analyser.fftSize = 32;\n      this.levels = new Uint8Array(this.analyser.frequencyBinCount);\n      event.detail.soundSource.connect(this.analyser);\n    });\n  },\n\n  remove: function() {\n    this.el.sceneEl.systems[\"frame-scheduler\"].unschedule(this._runScheduledWork, \"audio-analyser\");\n  },\n\n  tick: function(t) {\n    if (!this.avatarIsQuiet) {\n      this._updateAnalysis(t);\n    }\n  },\n\n  _runScheduledWork: function() {\n    if (this.avatarIsQuiet) {\n      this._updateAnalysis();\n    }\n  },\n\n  // Updates the analysis/volume. If t is passed, that implies this is called via tick\n  // and so as a performance optimization will check to see if it's been at least DISABLE_GRACE_PERIOD_MS\n  // since the last volume was seen above DISABLE_AT_VOLUME_THRESHOLD, and if so, will disable\n  // tick updates until the volume exceeds the level again.\n  _updateAnalysis: function(t) {\n    if (!this.analyser) return;\n\n    const currentVolume = calculateVolume(this.analyser, this.levels);\n    const s = 0.3;\n    this.volume = s * currentVolume + (1 - s) * this.prevVolume;\n    this.prevVolume = this.volume;\n\n    if (this.volume < DISABLE_AT_VOLUME_THRESHOLD) {\n      if (t && this.lastSeenVolume && this.lastSeenVolume < t - DISABLE_GRACE_PERIOD_MS) {\n        this.avatarIsQuiet = true;\n      }\n    } else {\n      if (t) {\n        this.lastSeenVolume = t;\n      }\n\n      this.avatarIsQuiet = false;\n    }\n  }\n});\n\nfunction connectAnalyser(mediaStream) {\n  const ctx = THREE.AudioContext.getContext();\n  const source = ctx.createMediaStreamSource(mediaStream);\n  const analyser = ctx.createAnalyser();\n  analyser.fftSize = 32;\n  const levels = new Uint8Array(analyser.frequencyBinCount);\n  source.connect(analyser);\n  return { analyser, levels };\n}\n\n/**\n * Calculates volume of the local audio stream.\n */\nAFRAME.registerSystem(\"local-audio-analyser\", {\n  init() {\n    this.volume = 0;\n\n    this.el.addEventListener(\"local-media-stream-created\", e => {\n      const mediaStream = e.detail.mediaStream;\n      if (this.stream) {\n        console.warn(\"media stream changed\", this.stream, mediaStream);\n        // TODO: cleanup?\n      }\n      this.stream = mediaStream;\n      const { analyser, levels } = connectAnalyser(mediaStream);\n      this.analyser = analyser;\n      this.levels = levels;\n    });\n  },\n\n  tick: function() {\n    if (!this.analyser) return;\n    this.volume = calculateVolume(this.analyser, this.levels);\n  }\n});\n\n/**\n * Sets an entity's scale base on audioFrequencyChange events.\n * @namespace avatar\n * @component scale-audio-feedback\n */\nAFRAME.registerComponent(\"scale-audio-feedback\", {\n  schema: {\n    minScale: { default: 1 },\n    maxScale: { default: 2 }\n  },\n\n  init() {\n    this._playerCamera = document.getElementById(\"player-camera\").object3D;\n  },\n\n  tick() {\n    // TODO: come up with a cleaner way to handle this.\n    // bone's are \"hidden\" by scaling them with bone-visibility, without this we would overwrite that.\n    if (!this.el.object3D.visible) return;\n\n    const { minScale, maxScale } = this.data;\n\n    const audioAnalyser = this.el.components[\"networked-audio-analyser\"];\n\n    if (!audioAnalyser) return;\n\n    const { object3D } = this.el;\n\n    const scale = getAudioFeedbackScale(this.el.object3D, this._playerCamera, minScale, maxScale, audioAnalyser.volume);\n\n    object3D.scale.setScalar(scale);\n    object3D.matrixNeedsUpdate = true;\n  }\n});\n\nconst SPRITE_NAMES = {\n  MIC: [\"mic-0.png\", \"mic-1.png\", \"mic-2.png\", \"mic-3.png\", \"mic-4.png\", \"mic-5.png\", \"mic-6.png\", \"mic-7.png\"],\n  MIC_HOVER: [\n    \"mic-0_hover.png\",\n    \"mic-1_hover.png\",\n    \"mic-2_hover.png\",\n    \"mic-3_hover.png\",\n    \"mic-4_hover.png\",\n    \"mic-5_hover.png\",\n    \"mic-6_hover.png\",\n    \"mic-7_hover.png\"\n  ],\n  MIC_OFF: [\n    \"mic-off-0.png\",\n    \"mic-off-1.png\",\n    \"mic-off-2.png\",\n    \"mic-off-3.png\",\n    \"mic-off-4.png\",\n    \"mic-off-5.png\",\n    \"mic-off-6.png\",\n    \"mic-off-7.png\"\n  ],\n  MIC_OFF_HOVER: [\n    \"mic-off-0_hover.png\",\n    \"mic-off-1_hover.png\",\n    \"mic-off-2_hover.png\",\n    \"mic-off-3_hover.png\",\n    \"mic-off-4_hover.png\",\n    \"mic-off-5_hover.png\",\n    \"mic-off-6_hover.png\",\n    \"mic-off-7_hover.png\"\n  ]\n};\n\nexport function micLevelForVolume(volume, max) {\n  return max === 0\n    ? 0\n    : volume < max * 0.02\n      ? 0\n      : volume < max * 0.03\n        ? 1\n        : volume < max * 0.06\n          ? 2\n          : volume < max * 0.08\n            ? 3\n            : volume < max * 0.16\n              ? 4\n              : volume < max * 0.32\n                ? 5\n                : volume < max * 0.5\n                  ? 6\n                  : 7;\n}\n\nAFRAME.registerComponent(\"mic-button\", {\n  schema: {\n    active: { type: \"boolean\" },\n    tooltip: { type: \"selector\" },\n    tooltipText: { type: \"string\" },\n    activeTooltipText: { type: \"string\" }\n  },\n\n  init() {\n    this.loudest = 0;\n    this.prevSpriteName = \"\";\n    this.decayingVolume = 0;\n    this.el.object3D.matrixNeedsUpdate = true;\n    this.hovering = false;\n    this.onHover = () => {\n      this.hovering = true;\n      this.data.tooltip.setAttribute(\"visible\", true);\n    };\n    this.onHoverOut = () => {\n      this.hovering = false;\n      this.data.tooltip.setAttribute(\"visible\", false);\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"hovered\", this.onHover);\n    this.el.object3D.addEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"hovered\", this.onHover);\n    this.el.object3D.removeEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  update() {\n    if (this.data.tooltip) {\n      this.textEl = this.data.tooltip.querySelector(\"[text]\");\n    }\n  },\n\n  tick() {\n    const audioAnalyser = this.el.sceneEl.systems[\"local-audio-analyser\"];\n    let volume;\n    if (audioAnalyser.volume > this.decayingVolume) {\n      this.decayingVolume = audioAnalyser.volume;\n      volume = audioAnalyser.volume;\n      this.loudest = Math.max(this.loudest, volume);\n    } else {\n      const s = 0.8;\n      volume = this.decayingVolume * s > 0.001 ? this.decayingVolume * s : 0;\n      this.decayingVolume = volume;\n    }\n\n    const active = this.data.active;\n    const hovering = this.hovering;\n    const spriteNames =\n      SPRITE_NAMES[!active ? (hovering ? \"MIC_HOVER\" : \"MIC\") : hovering ? \"MIC_OFF_HOVER\" : \"MIC_OFF\"];\n    const level = micLevelForVolume(volume, this.loudest);\n    const spriteName = spriteNames[level];\n    if (spriteName !== this.prevSpriteName) {\n      this.prevSpriteName = spriteName;\n      this.el.setAttribute(\"sprite\", \"name\", spriteName);\n    }\n\n    if (this.data.tooltip && hovering) {\n      this.textEl = this.textEl || this.data.tooltip.querySelector(\"[text]\");\n      this.textEl.setAttribute(\"text\", \"value\", active ? this.data.activeTooltipText : this.data.tooltipText);\n    }\n  }\n});\n","import uuid from \"uuid/v4\";\n\nexport default class AuthChannel {\n  constructor(store) {\n    this.store = store;\n    this.socket = null;\n    this._signedIn = !!this.store.state.credentials.token;\n  }\n\n  setSocket = socket => {\n    this.socket = socket;\n  };\n\n  get email() {\n    return this.store.state.credentials.email;\n  }\n\n  get signedIn() {\n    return this._signedIn;\n  }\n\n  signOut = async hubChannel => {\n    if (hubChannel) {\n      await hubChannel.signOut();\n    }\n    this.store.update({ credentials: { token: null, email: null } });\n    this.store.resetToRandomLegacyAvatar();\n    this._signedIn = false;\n  };\n\n  verifyAuthentication(authTopic, authToken, authPayload) {\n    const channel = this.socket.channel(authTopic);\n    return new Promise((resolve, reject) =>\n      channel\n        .join()\n        .receive(\"ok\", () => {\n          channel.on(\"auth_credentials\", async ({ credentials: token, payload: payload }) => {\n            await this.handleAuthCredentials(payload.email, token);\n            resolve();\n          });\n\n          channel.push(\"auth_verified\", { token: authToken, payload: authPayload });\n        })\n        .receive(\"error\", reject)\n    );\n  }\n\n  async startAuthentication(email, hubChannel) {\n    const channel = this.socket.channel(`auth:${uuid()}`);\n    await new Promise((resolve, reject) =>\n      channel\n        .join()\n        .receive(\"ok\", resolve)\n        .receive(\"error\", reject)\n    );\n\n    const authComplete = new Promise(resolve =>\n      channel.on(\"auth_credentials\", async ({ credentials: token }) => {\n        await this.handleAuthCredentials(email, token, hubChannel);\n        resolve();\n      })\n    );\n\n    channel.push(\"auth_request\", { email, origin: \"hubs\" });\n\n    // Returning an object with the authComplete promise since we want the caller to wait for the above await but not\n    // for authComplete.\n    return { authComplete };\n  }\n\n  async handleAuthCredentials(email, token, hubChannel) {\n    this.store.update({ credentials: { email, token } });\n\n    if (hubChannel) {\n      await hubChannel.signIn(token);\n    }\n\n    this._signedIn = true;\n  }\n}\n","export function addAnimationComponents(modelEl) {\n  if (!modelEl.components[\"animation-mixer\"]) {\n    return;\n  }\n\n  if (!modelEl.querySelector(\"[loop-animation]\")) {\n    modelEl.setAttribute(\"loop-animation\", \"\");\n  }\n}\n","const tempVector3 = new THREE.Vector3();\nconst tempQuaternion = new THREE.Quaternion();\n\nexport function getLastWorldPosition(src, target) {\n  src.updateMatrices();\n  target.setFromMatrixPosition(src.matrixWorld);\n  return target;\n}\n\nexport function getLastWorldQuaternion(src, target) {\n  src.updateMatrices();\n  src.matrixWorld.decompose(tempVector3, target, tempVector3);\n  return target;\n}\n\nexport function getLastWorldScale(src, target) {\n  src.updateMatrices();\n  src.matrixWorld.decompose(tempVector3, tempQuaternion, target);\n  return target;\n}\n\nexport function disposeMaterial(mtrl) {\n  if (mtrl.map) mtrl.map.dispose();\n  if (mtrl.lightMap) mtrl.lightMap.dispose();\n  if (mtrl.bumpMap) mtrl.bumpMap.dispose();\n  if (mtrl.normalMap) mtrl.normalMap.dispose();\n  if (mtrl.specularMap) mtrl.specularMap.dispose();\n  if (mtrl.envMap) mtrl.envMap.dispose();\n  mtrl.dispose();\n}\n\nexport function disposeNode(node) {\n  if (!(node instanceof THREE.Mesh)) return;\n\n  if (node.geometry) {\n    node.geometry.dispose();\n  }\n\n  if (node.material) {\n    let materialArray;\n    if (node.material instanceof THREE.MeshFaceMaterial || node.material instanceof THREE.MultiMaterial) {\n      materialArray = node.material.materials;\n    } else if (node.material instanceof Array) {\n      materialArray = node.material;\n    }\n    if (materialArray) {\n      materialArray.forEach(disposeMaterial);\n    } else {\n      disposeMaterial(node.material);\n    }\n  }\n}\n\nexport function setMatrixWorld(object3D, m) {\n  object3D.matrixWorld.copy(m);\n  object3D.matrix = object3D.matrix.getInverse(object3D.parent.matrixWorld).multiply(object3D.matrixWorld);\n  object3D.matrix.decompose(object3D.position, object3D.quaternion, object3D.scale);\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"presence-log\":\"presence-log__presence-log__10oFj\",\"presenceLog\":\"presence-log__presence-log__10oFj\",\"presence-log-entry\":\"presence-log__presence-log-entry__dt0t4\",\"presenceLogEntry\":\"presence-log__presence-log-entry__dt0t4\",\"message-body\":\"presence-log__message-body__2L9jA\",\"messageBody\":\"presence-log__message-body__2L9jA\",\"message-body-multi\":\"presence-log__message-body-multi__2e-Sx\",\"messageBodyMulti\":\"presence-log__message-body-multi__2e-Sx\",\"message-body-mono\":\"presence-log__message-body-mono__3zuQE\",\"messageBodyMono\":\"presence-log__message-body-mono__3zuQE\",\"message-wrap\":\"presence-log__message-wrap__2aWCa\",\"messageWrap\":\"presence-log__message-wrap__2aWCa\",\"message-wrap-multi\":\"presence-log__message-wrap-multi__1eA6v\",\"messageWrapMulti\":\"presence-log__message-wrap-multi__1eA6v\",\"message-source\":\"presence-log__message-source__3CI4d\",\"messageSource\":\"presence-log__message-source__3CI4d\",\"message-source-link\":\"presence-log__message-source-link__1evTZ\",\"messageSourceLink\":\"presence-log__message-source-link__1evTZ\",\"icon-button\":\"presence-log__icon-button__2Shbm\",\"iconButton\":\"presence-log__icon-button__2Shbm\",\"spawn-message\":\"presence-log__spawn-message__14Ne8\",\"spawnMessage\":\"presence-log__spawn-message__14Ne8\",\"share\":\"presence-log__share__37U7E\",\"media\":\"presence-log__media__2qG_d\",\"mediaBody\":\"presence-log__mediaBody__1rByA\",\"expired\":\"presence-log__expired__2wMJc\",\"presence-log-entry-with-button\":\"presence-log__presence-log-entry-with-button__1PxTw\",\"presenceLogEntryWithButton\":\"presence-log__presence-log-entry-with-button__1PxTw\",\"presence-log-in-room\":\"presence-log__presence-log-in-room__17h3n\",\"presenceLogInRoom\":\"presence-log__presence-log-in-room__17h3n\",\"presence-log-spawn\":\"presence-log__presence-log-spawn__3jlmT\",\"presenceLogSpawn\":\"presence-log__presence-log-spawn__3jlmT\",\"presence-log-entry-one-line\":\"presence-log__presence-log-entry-one-line__bRXfp\",\"presenceLogEntryOneLine\":\"presence-log__presence-log-entry-one-line__bRXfp\",\"presence-log-emoji\":\"presence-log__presence-log-emoji__1_3Yn\",\"presenceLogEmoji\":\"presence-log__presence-log-emoji__1_3Yn\",\"emoji\":\"presence-log__emoji__10b18\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"panel\":\"_2d-hud__panel__2oM_T\",\"tip-cancel-text\":\"_2d-hud__tip-cancel-text__12KQ2\",\"tipCancelText\":\"_2d-hud__tip-cancel-text__12KQ2\",\"top-tip\":\"_2d-hud__top-tip__E5uti\",\"topTip\":\"_2d-hud__top-tip__E5uti\",\"container\":\"_2d-hud__container__66GRt\",\"top\":\"_2d-hud__top__3PiNe\",\"column\":\"_2d-hud__column__1y7XY\",\"bottom\":\"_2d-hud__bottom__2jUcT\",\"hide\":\"_2d-hud__hide__3HJO8\",\"attach-point\":\"_2d-hud__attach-point__17FSc\",\"attachPoint\":\"_2d-hud__attach-point__17FSc\",\"attach_video_share_mode\":\"_2d-hud__attach_video_share_mode__21PhM\",\"attachVideoShareMode\":\"_2d-hud__attach_video_share_mode__21PhM\",\"attach_video_share_failed\":\"_2d-hud__attach_video_share_failed__2tfqf\",\"attachVideoShareFailed\":\"_2d-hud__attach_video_share_failed__2tfqf\",\"attach_pen_mode\":\"_2d-hud__attach_pen_mode__cI1AW\",\"attachPenMode\":\"_2d-hud__attach_pen_mode__cI1AW\",\"attach_mute_mode\":\"_2d-hud__attach_mute_mode__153iB\",\"attachMuteMode\":\"_2d-hud__attach_mute_mode__153iB\",\"attach_freeze_mode\":\"_2d-hud__attach_freeze_mode__3UIHP\",\"attachFreezeMode\":\"_2d-hud__attach_freeze_mode__3UIHP\",\"top-tip-no-hud\":\"_2d-hud__top-tip-no-hud__16RXh\",\"topTipNoHud\":\"_2d-hud__top-tip-no-hud__16RXh\",\"tip-cancel\":\"_2d-hud__tip-cancel__JaFV-\",\"tipCancel\":\"_2d-hud__tip-cancel__JaFV-\",\"video-share-extra-options\":\"_2d-hud__video-share-extra-options__31VMr\",\"videoShareExtraOptions\":\"_2d-hud__video-share-extra-options__31VMr\",\"iconButton\":\"_2d-hud__iconButton__3faJz\",\"up\":\"_2d-hud__up__1lyhr\",\"small\":\"_2d-hud__small__2rqgF\",\"large\":\"_2d-hud__large__2bHqH\",\"disabled\":\"_2d-hud__disabled__3ylbZ\",\"video-share\":\"_2d-hud__video-share__38X7W\",\"videoShare\":\"_2d-hud__video-share__38X7W\",\"fly\":\"_2d-hud__fly__kDxPK\",\"active\":\"_2d-hud__active__1TMB8\",\"megaphone\":\"_2d-hud__megaphone__xiTTg\",\"mute\":\"_2d-hud__mute__25kHI\",\"pen\":\"_2d-hud__pen__3uTC7\",\"camera\":\"_2d-hud__camera__84ksg\",\"freeze\":\"_2d-hud__freeze__26rlJ\",\"spawn\":\"_2d-hud__spawn__1FoBz\",\"mobile-media-picker\":\"_2d-hud__mobile-media-picker__3ZXHc\",\"mobileMediaPicker\":\"_2d-hud__mobile-media-picker__3ZXHc\",\"share_camera\":\"_2d-hud__share_camera__v67Il\",\"shareCamera\":\"_2d-hud__share_camera__v67Il\",\"share_screen\":\"_2d-hud__share_screen__1HQ8E\",\"shareScreen\":\"_2d-hud__share_screen__1HQ8E\",\"share_window\":\"_2d-hud__share_window__stsD3\",\"shareWindow\":\"_2d-hud__share_window__stsD3\"};","export function forEachMaterial(object3D, fn) {\n  if (!object3D.material) return;\n\n  if (Array.isArray(object3D.material)) {\n    object3D.material.forEach(fn);\n  } else {\n    fn(object3D.material);\n  }\n}\n\nexport function mapMaterials(object3D, fn) {\n  if (!object3D.material) return;\n\n  if (Array.isArray(object3D.material)) {\n    return object3D.material.map(fn);\n  } else {\n    return fn(object3D.material);\n  }\n}\n","export default function maskEmail(email) {\n  if (!email) return \"\";\n  const emailParts = email.split(\"@\");\n  const emailIdentity = emailParts[0];\n  const emailDomain = emailParts[1];\n  const truncatedIdentity = emailIdentity.substring(0, Math.min(emailIdentity.length, 3));\n  return `${truncatedIdentity}...@${emailDomain}`;\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport dayjs from \"dayjs-ext\";\nimport relativeTime from \"dayjs-ext/plugin/relativeTime\";\nimport { FormattedMessage } from \"react-intl\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faAngleLeft } from \"@fortawesome/free-solid-svg-icons/faAngleLeft\";\nimport { faAngleRight } from \"@fortawesome/free-solid-svg-icons/faAngleRight\";\nimport { faExternalLinkAlt } from \"@fortawesome/free-solid-svg-icons/faExternalLinkAlt\";\nimport { faPencilAlt } from \"@fortawesome/free-solid-svg-icons/faPencilAlt\";\nimport { faPlus } from \"@fortawesome/free-solid-svg-icons/faPlus\";\n\nimport styles from \"../assets/stylesheets/media-browser.scss\";\nimport { scaledThumbnailUrlFor } from \"../utils/media-url-utils\";\nimport StateLink from \"./state-link\";\n\ndayjs.extend(relativeTime);\n\nconst PUBLISHER_FOR_ENTRY_TYPE = {\n  sketchfab_model: \"Sketchfab\",\n  poly_model: \"Google Poly\",\n  twitch_stream: \"Twitch\"\n};\n\nclass MediaTiles extends Component {\n  static propTypes = {\n    result: PropTypes.object,\n    history: PropTypes.object,\n    urlSource: PropTypes.string,\n    handleEntryClicked: PropTypes.func,\n    handlePager: PropTypes.func\n  };\n\n  render() {\n    const { urlSource, result } = this.props;\n    const entries = (result && result.entries) || [];\n    const [createTileWidth, createTileHeight] = this.getTileDimensions(false, urlSource === \"avatars\");\n    const searchParams = new URLSearchParams((this.props.history ? this.props.history.location : location).search);\n    const hasMeta = !!(result && result.meta);\n    const apiSource = (hasMeta && result.meta.source) || null;\n    const isVariableWidth = result && [\"bing_images\", \"tenor\"].includes(apiSource);\n    const hasNext = !!(hasMeta && result.meta.next_cursor) || false;\n    const hasPrevious = searchParams.get(\"cursor\");\n\n    return (\n      <div className={styles.body}>\n        <div className={classNames({ [styles.tiles]: true, [styles.tilesVariable]: isVariableWidth })}>\n          {(urlSource === \"avatars\" || urlSource === \"scenes\") && (\n            <div\n              style={{ width: `${createTileWidth}px`, height: `${createTileHeight}px` }}\n              className={classNames(styles.tile, styles.createTile)}\n            >\n              {urlSource === \"scenes\" ? (\n                <a href=\"/spoke/new\" rel=\"noopener noreferrer\" target=\"_blank\" className={styles.tileLink}>\n                  <div className={styles.tileContent}>\n                    <FontAwesomeIcon icon={faPlus} />\n                    <FormattedMessage id=\"media-browser.create-scene\" />\n                  </div>\n                </a>\n              ) : (\n                <a\n                  onClick={e => {\n                    e.preventDefault();\n                    window.dispatchEvent(new CustomEvent(\"action_create_avatar\"));\n                  }}\n                  className={styles.tileLink}\n                >\n                  <div className={styles.tileContent}>\n                    <FontAwesomeIcon icon={faPlus} />\n                    <FormattedMessage id=\"media-browser.create-avatar\" />\n                  </div>\n                </a>\n              )}\n            </div>\n          )}\n\n          {entries.map(this.entryToTile)}\n        </div>\n\n        {result &&\n          (hasNext || hasPrevious) &&\n          this.props.handlePager && (\n            <div className={styles.pager}>\n              <a\n                className={classNames({ [styles.previousPage]: true, [styles.pagerButtonDisabled]: !hasPrevious })}\n                onClick={() => this.props.handlePager(-1)}\n              >\n                <FontAwesomeIcon icon={faAngleLeft} />\n              </a>\n              <div className={styles.pageNumber}>{result.meta.page}</div>\n              <a\n                className={classNames({ [styles.nextPage]: true, [styles.pagerButtonDisabled]: !hasNext })}\n                onClick={() => this.props.handlePager(1)}\n              >\n                <FontAwesomeIcon icon={faAngleRight} />\n              </a>\n            </div>\n          )}\n      </div>\n    );\n  }\n\n  getTileDimensions = (isImage, isAvatar, imageAspect) => {\n    // Doing breakpointing here, so we can have proper image placeholder based upon dynamic aspect ratio\n    const clientWidth = window.innerWidth;\n    let imageHeight = clientWidth < 1079 ? (clientWidth < 768 ? (clientWidth < 400 ? 85 : 100) : 150) : 200;\n    if (isAvatar) imageHeight = Math.floor(imageHeight * 1.5);\n\n    // Aspect ratio can vary per image if its an image result. Avatars are a taller portrait aspect, o/w assume 720p\n    let imageWidth;\n    if (isImage) {\n      imageWidth = Math.floor(Math.max(imageAspect * imageHeight, imageHeight * 0.85));\n    } else if (isAvatar) {\n      imageWidth = Math.floor((9 / 16) * imageHeight);\n    } else {\n      imageWidth = Math.floor(Math.max((16 / 9) * imageHeight, imageHeight * 0.85));\n    }\n\n    return [imageWidth, imageHeight];\n  };\n\n  entryToTile = (entry, idx) => {\n    const imageSrc = entry.images.preview.url;\n    const creator = entry.attributions && entry.attributions.creator;\n    const isImage = entry.type.endsWith(\"_image\");\n    const isAvatar = [\"avatar\", \"avatar_listing\"].includes(entry.type);\n    const isHub = [\"hub\"].includes(entry.type);\n    const imageAspect = entry.images.preview.width / entry.images.preview.height;\n\n    const [imageWidth, imageHeight] = this.getTileDimensions(isImage, isAvatar, imageAspect);\n\n    const publisherName =\n      (entry.attributions && entry.attributions.publisher && entry.attributions.publisher.name) ||\n      PUBLISHER_FOR_ENTRY_TYPE[entry.type];\n\n    return (\n      <div style={{ width: `${imageWidth}px` }} className={styles.tile} key={`${entry.id}_${idx}`}>\n        <a\n          href={entry.url}\n          rel=\"noreferrer noopener\"\n          onClick={e => this.props.handleEntryClicked && this.props.handleEntryClicked(e, entry)}\n          className={styles.tileLink}\n          style={{ width: `${imageWidth}px`, height: `${imageHeight}px` }}\n        >\n          <img\n            className={classNames(styles.tileContent, styles.avatarTile)}\n            src={scaledThumbnailUrlFor(imageSrc, imageWidth, imageHeight)}\n          />\n        </a>\n        {entry.type === \"avatar\" && (\n          <StateLink\n            className={styles.editAvatar}\n            stateKey=\"overlay\"\n            stateValue=\"avatar-editor\"\n            stateDetail={{ avatarId: entry.id }}\n            history={this.props.history}\n          >\n            <FontAwesomeIcon icon={faPencilAlt} />\n          </StateLink>\n        )}\n        {!entry.type.endsWith(\"_image\") && (\n          <div className={styles.info}>\n            <a\n              href={entry.url}\n              rel=\"noreferrer noopener\"\n              className={styles.name}\n              onClick={e => this.props.handleEntryClicked && this.props.handleEntryClicked(e, entry)}\n            >\n              {entry.name || \"\\u00A0\"}\n            </a>\n            {!isAvatar &&\n              !isHub && (\n                <div className={styles.attribution}>\n                  <div className={styles.creator}>\n                    {creator && creator.name === undefined && <span>{creator}</span>}\n                    {creator && creator.name && !creator.url && <span>{creator.name}</span>}\n                    {creator &&\n                      creator.name &&\n                      creator.url && (\n                        <a href={creator.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                          {creator.name}\n                        </a>\n                      )}\n                  </div>\n                  {publisherName && (\n                    <div className={styles.publisher}>\n                      <i>\n                        <FontAwesomeIcon icon={faExternalLinkAlt} />\n                      </i>\n                      &nbsp;<a href={entry.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                        {publisherName}\n                      </a>\n                    </div>\n                  )}\n                </div>\n              )}\n            {isHub && (\n              <div className={styles.attribution}>\n                <div className={styles.lastJoined}>\n                  <FormattedMessage id=\"media-browser.hub.joined-prefix\" />\n                  {dayjs(entry.last_activated_at).fromNow()}\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    );\n  };\n}\nexport default MediaTiles;\n","const THREE = AFRAME.THREE;\n\nfunction checkFloatTextureSupport() {\n  const renderer = new THREE.WebGLRenderer();\n\n  const scene = new THREE.Scene();\n  const size = 2;\n  const data = new Float32Array(size * size * 4);\n  const dataTexture = new THREE.DataTexture(data, size, size, THREE.RGBAFormat, THREE.FloatType);\n  const box = new THREE.Mesh(new THREE.PlaneBufferGeometry(1, 1), new THREE.MeshBasicMaterial({ map: dataTexture }));\n  box.material.map.needsUpdate = true;\n  scene.add(box);\n\n  renderer.render(scene, new THREE.Camera());\n  const result = renderer.context.getError() === 0;\n  renderer.dispose();\n  return result;\n}\n\nexport function patchWebGLRenderingContext() {\n  if (/Android.+Firefox/.test(navigator.userAgent)) {\n    // It appears that Galaxy S6 devices falsely report that they support\n    // OES_texture_float in Firefox. This workaround disables float textures\n    // for those devices.\n    // See https://github.com/mozilla/hubs/issues/32 and\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1338656\n    const originalGetExtension = WebGLRenderingContext.prototype.getExtension;\n    const supportsFloatTextures = checkFloatTextureSupport();\n    WebGLRenderingContext.prototype.getExtension = function patchedGetExtension(name) {\n      if (name === \"OES_texture_float\" && !supportsFloatTextures) {\n        return null;\n      }\n      return originalGetExtension.call(this, name);\n    };\n  }\n}\n","module.exports = __webpack_public_path__ + \"assets/LoadingObject_Atom-7dcc3b81897e68b740c1cf12b6cf4c3f.glb\";","module.exports = __webpack_public_path__ + \"assets/sfx/teleport-loop-84e2caa4f62e5c6d6ce339b0c715c06d.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/quickTurn-cda89edb1a7a32e4442cac70cd2694be.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/tap_mellow-673398d6e97818ec4b675708d460bd0f.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/PenSpawn-aac1f534773040f0fafa41e9db76017b.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/PenDraw1-ddbdc17a6beefecbca2685c8c9d0d2d5.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/PicSnapHey-0228ddd197e5a6d88f7bcd2ceb340f8e.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/welcome-0083300978d5dd05eaa376f65761da47.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/quack-1f18502834f8f1db43990b769c2ab193.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/specialquack-6d1a192a6092e8dfed5d3de063755ee2.mp3\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"ui\":\"ui-root__ui__33CMU\",\"ui-dialog\":\"ui-root__ui-dialog__2TY9Y\",\"uiDialog\":\"ui-root__ui-dialog__2TY9Y\",\"ui-interactive\":\"ui-root__ui-interactive__2mtC4\",\"uiInteractive\":\"ui-root__ui-interactive__2mtC4\",\"presence-info\":\"ui-root__presence-info__3cieq\",\"presenceInfo\":\"ui-root__presence-info__3cieq\",\"corner-button\":\"ui-root__corner-button__2rfQ5\",\"cornerButton\":\"ui-root__corner-button__2rfQ5\",\"nag-corner-button\":\"ui-root__nag-corner-button__3TFW5\",\"nagCornerButton\":\"ui-root__nag-corner-button__3TFW5\",\"choose-scene-button\":\"ui-root__choose-scene-button__3VNdD\",\"chooseSceneButton\":\"ui-root__choose-scene-button__3VNdD\",\"leave-button\":\"ui-root__leave-button__29u2_\",\"leaveButton\":\"ui-root__leave-button__29u2_\",\"interstitial\":\"ui-root__interstitial__1cotl\",\"invite-tip\":\"ui-root__invite-tip__20NJ6\",\"inviteTip\":\"ui-root__invite-tip__20NJ6\",\"streaming-tip\":\"ui-root__streaming-tip__17WYl\",\"streamingTip\":\"ui-root__streaming-tip__17WYl\",\"streaming-tip-attach-point\":\"ui-root__streaming-tip-attach-point__3XSH-\",\"streamingTipAttachPoint\":\"ui-root__streaming-tip-attach-point__3XSH-\",\"streaming-tip-close\":\"ui-root__streaming-tip-close__1OHPc\",\"streamingTipClose\":\"ui-root__streaming-tip-close__1OHPc\",\"streaming-tip-message\":\"ui-root__streaming-tip-message__2XOUD\",\"streamingTipMessage\":\"ui-root__streaming-tip-message__2XOUD\",\"ui-dialog-box-contents\":\"ui-root__ui-dialog-box-contents__3XWtl\",\"uiDialogBoxContents\":\"ui-root__ui-dialog-box-contents__3XWtl\",\"backgrounded\":\"ui-root__backgrounded__34j0m\",\"in-room-favorite-button\":\"ui-root__in-room-favorite-button__2I0Kj\",\"inRoomFavoriteButton\":\"ui-root__in-room-favorite-button__2I0Kj\",\"occupant-count\":\"ui-root__occupant-count__34rGX\",\"occupantCount\":\"ui-root__occupant-count__34rGX\",\"presence-info-selected\":\"ui-root__presence-info-selected__1Jhbw\",\"presenceInfoSelected\":\"ui-root__presence-info-selected__1Jhbw\",\"camera-mode-exit-button\":\"ui-root__camera-mode-exit-button__2mpbz\",\"cameraModeExitButton\":\"ui-root__camera-mode-exit-button__2mpbz\",\"corner-button-selected\":\"ui-root__corner-button-selected__qRY5R\",\"cornerButtonSelected\":\"ui-root__corner-button-selected__qRY5R\",\"invite-tip-attach-point\":\"ui-root__invite-tip-attach-point__3rQJ6\",\"inviteTipAttachPoint\":\"ui-root__invite-tip-attach-point__3rQJ6\",\"avatar-editor\":\"ui-root__avatar-editor__2mO8z\",\"avatarEditor\":\"ui-root__avatar-editor__2mO8z\"};","module.exports = __webpack_public_path__ + \"assets/sfx/pop-5784f3bcfaf98637147737448d6df8df.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/Eb_blip-8d7302990e83d6798400a6027dce3936.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/tack-0d55b064794faaa1733fcf6bc89cad0c.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/A_bendUp-de32e556413bb2a527fb514984738c70.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/suspense-f27c64840e5ede36ec694c22a030615c.mp3\";","module.exports = __webpack_public_path__ + \"assets/waternormals-4418dde3f6abc21dc32506acf5f5b093.jpg\";","// NOTE: We do not use an IV since we generate a new keypair each time we use these routines.\n\nasync function deriveKey(privateKey, publicKey) {\n  return crypto.subtle.deriveKey(\n    { name: \"ECDH\", public: publicKey },\n    privateKey,\n    { name: \"AES-CBC\", length: 256 },\n    true,\n    [\"encrypt\", \"decrypt\"]\n  );\n}\n\nasync function publicKeyToString(key) {\n  return JSON.stringify(await crypto.subtle.exportKey(\"jwk\", key));\n}\n\nasync function stringToPublicKey(s) {\n  return await crypto.subtle.importKey(\"jwk\", JSON.parse(s), { name: \"ECDH\", namedCurve: \"P-256\" }, true, []);\n}\n\nfunction stringToArrayBuffer(s) {\n  const buf = new Uint8Array(s.length);\n\n  for (let i = 0; i < s.length; i++) {\n    buf[i] = s.charCodeAt(i);\n  }\n\n  return buf;\n}\n\nfunction arrayBufferToString(b) {\n  const buf = new Uint8Array(b);\n  let s = \"\";\n\n  for (let i = 0; i < buf.byteLength; i++) {\n    s += String.fromCharCode(buf[i]);\n  }\n\n  return s;\n}\n\n// This allows a single object to be passed encrypted from a receiver in a req -> response flow\n\n// Requestor generates a public key and private key, and should send the public key to receiver.\nexport async function generateKeys() {\n  const keyPair = await crypto.subtle.generateKey({ name: \"ECDH\", namedCurve: \"P-256\" }, true, [\"deriveKey\"]);\n  const publicKeyString = await publicKeyToString(keyPair.publicKey);\n  return { publicKeyString, privateKey: keyPair.privateKey };\n}\n\n// Receiver takes the public key from requestor and passes obj to get a response public key and the encrypted data to return.\nexport async function generatePublicKeyAndEncryptedObject(incomingPublicKeyString, obj) {\n  const iv = new Uint8Array(16);\n  const incomingPublicKey = await stringToPublicKey(incomingPublicKeyString);\n  const keyPair = await crypto.subtle.generateKey({ name: \"ECDH\", namedCurve: \"P-256\" }, true, [\"deriveKey\"]);\n  const publicKeyString = await publicKeyToString(keyPair.publicKey);\n  const secret = await deriveKey(keyPair.privateKey, incomingPublicKey);\n\n  const encryptedData = btoa(\n    arrayBufferToString(\n      await crypto.subtle.encrypt({ name: \"AES-CBC\", iv }, secret, stringToArrayBuffer(JSON.stringify(obj)))\n    )\n  );\n\n  return { publicKeyString, encryptedData };\n}\n\n// Requestor then takes the receiver's public key, the private key (returned from generateKeys()), and the data from the receiver.\nexport async function decryptObject(publicKeyString, privateKey, base64value) {\n  const iv = new Uint8Array(16);\n  const publicKey = await stringToPublicKey(publicKeyString);\n  const secret = await deriveKey(privateKey, publicKey);\n  const ciphertext = stringToArrayBuffer(atob(base64value));\n  const data = await crypto.subtle.decrypt({ name: \"AES-CBC\", iv }, secret, ciphertext);\n  return JSON.parse(arrayBufferToString(data));\n}\n","import { generatePublicKeyAndEncryptedObject, generateKeys, decryptObject } from \"./crypto\";\n\nconst LINK_ACTION_TIMEOUT = 10000;\n\nexport default class LinkChannel {\n  constructor(store) {\n    this.store = store;\n  }\n\n  setSocket = socket => {\n    this.socket = socket;\n  };\n\n  // Returns a promise that, when resolved, will forward an object with three keys:\n  //\n  // code: The code that was made available to use for link.\n  //\n  // cancel: A function that the caller can call to cancel the use of the code.\n  //\n  // onFinished: A promise that, when resolved, indicates the code is no longer usable,\n  // because it was either successfully used by the remote device or it has expired\n  // (\"used\" or \"expired\" is passed to the callback).\n  generateCode = () => {\n    return new Promise(resolve => {\n      const onFinished = new Promise(finished => {\n        const step = () => {\n          const getLetter = () => \"ABCDEFGHI\"[Math.floor(Math.random() * 9)];\n          const code = `${getLetter()}${getLetter()}${getLetter()}${getLetter()}`;\n\n          // Only respond to one link_request in this channel.\n          let readyToSend = false;\n          let leftChannel = false;\n\n          const channel = this.socket.channel(`link:${code}`, { timeout: LINK_ACTION_TIMEOUT });\n\n          const leave = () => {\n            if (!leftChannel) channel.leave();\n            leftChannel = true;\n          };\n\n          const cancel = () => leave();\n\n          channel.on(\"link_expired\", () => finished(\"expired\"));\n\n          channel.on(\"presence_state\", state => {\n            if (readyToSend) return;\n\n            if (Object.keys(state).length > 0) {\n              // Code is in use by someone else, try a new one\n              step();\n            } else {\n              readyToSend = true;\n              resolve({ code, cancel, onFinished });\n            }\n          });\n\n          channel.on(\"link_request\", incoming => {\n            if (readyToSend) {\n              const data = { path: location.pathname };\n\n              // Copy profile data to link'ed device if it's been set.\n              if (this.store.state.activity.hasChangedName) {\n                data.profile = { ...this.store.state.profile };\n              }\n              data.credentials = { ...this.store.state.credentials };\n\n              generatePublicKeyAndEncryptedObject(incoming.public_key, data).then(\n                ({ publicKeyString, encryptedData }) => {\n                  const payload = {\n                    target_session_id: incoming.reply_to_session_id,\n                    public_key: publicKeyString,\n                    data: encryptedData\n                  };\n\n                  if (!leftChannel) {\n                    channel.push(\"link_response\", payload);\n                  }\n\n                  leave();\n\n                  finished(\"used\");\n                  readyToSend = false;\n                }\n              );\n            }\n          });\n\n          channel.join().receive(\"error\", r => console.error(r));\n        };\n\n        step();\n      });\n    });\n  };\n\n  // Attempts to receive a link payload from a remote device using the given code.\n  //\n  // Promise rejects if the code is invalid or there is a problem with the channel.\n  // Promise resolves and passes payload of link source on successful link.\n  attemptLink = code => {\n    return new Promise((resolve, reject) => {\n      const channel = this.socket.channel(`link:${code}`, { timeout: LINK_ACTION_TIMEOUT });\n      let finished = false;\n\n      generateKeys().then(({ publicKeyString, privateKey }) => {\n        channel.on(\"presence_state\", state => {\n          const numOccupants = Object.keys(state).length;\n\n          if (numOccupants === 1) {\n            // Great, only sender is in topic, request link\n            channel.push(\"link_request\", {\n              reply_to_session_id: this.socket.params().session_id,\n              public_key: publicKeyString\n            });\n\n            setTimeout(() => {\n              if (finished) return;\n              channel.leave();\n              reject(new Error(\"no_response\"));\n            }, LINK_ACTION_TIMEOUT);\n          } else if (numOccupants === 0) {\n            // Nobody in this channel, probably a bad code.\n            channel.leave();\n            reject(new Error(\"failed\"));\n          } else {\n            console.warn(\"link code channel already has 2 or more occupants, something fishy is going on.\");\n            channel.leave();\n            reject(new Error(\"in_use\"));\n          }\n        });\n\n        channel.on(\"link_response\", payload => {\n          finished = true;\n          channel.leave();\n\n          decryptObject(payload.public_key, privateKey, payload.data).then(resolve);\n        });\n\n        channel\n          .join()\n          .receive(\"ok\", data => (this.socket.params().session_id = data.session_id))\n          .receive(\"error\", r => console.error(r));\n      });\n    });\n  };\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"command-help\":\"chat-command-help__command-help__q0Wb8\",\"commandHelp\":\"chat-command-help__command-help__q0Wb8\",\"entry\":\"chat-command-help__entry__1E1un\",\"command\":\"chat-command-help__command__2GMyn\"};","import { avatars } from \"../assets/avatars/avatars.js\";\n\nconst names = [\n  \"Baers-Pochard\",\n  \"Baikal-Teal\",\n  \"Barrows-Goldeneye\",\n  \"Blue-Billed\",\n  \"Blue-Duck\",\n  \"Blue-Winged\",\n  \"Brown-Teal\",\n  \"Bufflehead\",\n  \"Canvasback\",\n  \"Cape-Shoveler\",\n  \"Chestnut-Teal\",\n  \"Chiloe-Wigeon\",\n  \"Cinnamon-Teal\",\n  \"Comb-Duck\",\n  \"Common-Eider\",\n  \"Common-Goldeneye\",\n  \"Common-Merganser\",\n  \"Common-Pochard\",\n  \"Common-Scoter\",\n  \"Common-Shelduck\",\n  \"Cotton-Pygmy\",\n  \"Crested-Duck\",\n  \"Crested-Shelduck\",\n  \"Eatons-Pintail\",\n  \"Falcated\",\n  \"Ferruginous\",\n  \"Freckled-Duck\",\n  \"Gadwall\",\n  \"Garganey\",\n  \"Greater-Scaup\",\n  \"Green-Pygmy\",\n  \"Grey-Teal\",\n  \"Hardhead\",\n  \"Harlequin\",\n  \"Hartlaubs\",\n  \"Hooded-Merganser\",\n  \"Hottentot-Teal\",\n  \"Kelp-Goose\",\n  \"King-Eider\",\n  \"Lake-Duck\",\n  \"Laysan-Duck\",\n  \"Lesser-Scaup\",\n  \"Long-Tailed\",\n  \"Maccoa-Duck\",\n  \"Mallard\",\n  \"Mandarin\",\n  \"Marbled-Teal\",\n  \"Mellers-Duck\",\n  \"Merganser\",\n  \"Northern-Pintail\",\n  \"Orinoco-Goose\",\n  \"Paradise-Shelduck\",\n  \"Plumed-Whistler\",\n  \"Puna-Teal\",\n  \"Pygmy-Goose\",\n  \"Radjah-Shelduck\",\n  \"Red-Billed\",\n  \"Red-Crested\",\n  \"Red-Shoveler\",\n  \"Ring-Necked\",\n  \"Ringed-Teal\",\n  \"Rosy-Billed\",\n  \"Ruddy-Shelduck\",\n  \"Salvadoris-Teal\",\n  \"Scaly-Sided\",\n  \"Shelduck\",\n  \"Shoveler\",\n  \"Silver-Teal\",\n  \"Smew\",\n  \"Spectacled-Eider\",\n  \"Spot-Billed\",\n  \"Spotted-Whistler\",\n  \"Steamerduck\",\n  \"Stellers-Eider\",\n  \"Sunda-Teal\",\n  \"Surf-Scoter\",\n  \"Tufted-Duck\",\n  \"Velvet-Scoter\",\n  \"Wandering-Whistler\",\n  \"Whistling-duck\",\n  \"White-Backed\",\n  \"White-Cheeked\",\n  \"White-Winged\",\n  \"Wigeon\",\n  \"Wood-Duck\",\n  \"Yellow-Billed\"\n];\n\nfunction selectRandom(arr) {\n  return arr[Math.floor(Math.random() * arr.length)];\n}\n\nexport function generateRandomName() {\n  return `${selectRandom(names)}-${Math.floor(10000 + Math.random() * 10000)}`;\n}\n\nexport const avatarIds = avatars.map(av => av.id);\n\nexport function generateDefaultProfile() {\n  return {\n    avatarId: selectRandom(avatarIds)\n  };\n}\n","import { Validator } from \"jsonschema\";\nimport merge from \"deepmerge\";\nimport Cookies from \"js-cookie\";\nimport jwtDecode from \"jwt-decode\";\n\nconst LOCAL_STORE_KEY = \"___hubs_store\";\nconst STORE_STATE_CACHE_KEY = Symbol();\nconst OAUTH_FLOW_CREDENTIALS_KEY = \"ret-oauth-flow-account-credentials\";\nconst validator = new Validator();\nimport { EventTarget } from \"event-target-shim\";\nimport { generateDefaultProfile, generateRandomName } from \"../utils/identity.js\";\n\n// Durable (via local-storage) schema-enforced state that is meant to be consumed via forward data flow.\n// (Think flux but with way less incidental complexity, at least for now :))\nexport const SCHEMA = {\n  id: \"/HubsStore\",\n\n  definitions: {\n    profile: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        displayName: { type: \"string\", pattern: \"^[A-Za-z0-9-]{3,32}$\" },\n        avatarId: { type: \"string\" },\n        personalAvatarId: { type: \"string\" }\n      }\n    },\n\n    credentials: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        token: { type: [\"null\", \"string\"] },\n        email: { type: [\"null\", \"string\"] }\n      }\n    },\n\n    activity: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        hasFoundFreeze: { type: \"boolean\" },\n        hasChangedName: { type: \"boolean\" },\n        hasAcceptedProfile: { type: \"boolean\" },\n        lastEnteredAt: { type: \"string\" },\n        hasPinned: { type: \"boolean\" },\n        hasRotated: { type: \"boolean\" },\n        hasRecentered: { type: \"boolean\" },\n        hasScaled: { type: \"boolean\" },\n        hasHoveredInWorldHud: { type: \"boolean\" },\n        hasOpenedShare: { type: \"boolean\" },\n        entryCount: { type: \"number\" }\n      }\n    },\n\n    settings: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        lastUsedMicDeviceId: { type: \"string\" }\n      }\n    },\n\n    // Legacy\n    confirmedDiscordRooms: {\n      type: \"array\",\n      items: { type: \"string\" }\n    },\n\n    confirmedBroadcastedRooms: {\n      type: \"array\",\n      items: { type: \"string\" }\n    },\n\n    uploadPromotionTokens: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          fileId: { type: \"string\" },\n          promotionToken: { type: \"string\" }\n        }\n      }\n    },\n\n    creatorAssignmentTokens: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          hubId: { type: \"string\" },\n          creatorAssignmentToken: { type: \"string\" }\n        }\n      }\n    },\n\n    embedTokens: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          hubId: { type: \"string\" },\n          embedToken: { type: \"string\" }\n        }\n      }\n    },\n\n    onLoadActions: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          action: { type: \"string\" },\n          args: { type: \"object\" }\n        }\n      }\n    }\n  },\n\n  type: \"object\",\n\n  properties: {\n    profile: { $ref: \"#/definitions/profile\" },\n    credentials: { $ref: \"#/definitions/credentials\" },\n    activity: { $ref: \"#/definitions/activity\" },\n    settings: { $ref: \"#/definitions/settings\" },\n    confirmedDiscordRooms: { $ref: \"#/definitions/confirmedDiscordRooms\" }, // Legacy\n    confirmedBroadcastedRooms: { $ref: \"#/definitions/confirmedBroadcastedRooms\" },\n    uploadPromotionTokens: { $ref: \"#/definitions/uploadPromotionTokens\" },\n    creatorAssignmentTokens: { $ref: \"#/definitions/creatorAssignmentTokens\" },\n    embedTokens: { $ref: \"#/definitions/embedTokens\" },\n    onLoadActions: { $ref: \"#/definitions/onLoadActions\" }\n  },\n\n  additionalProperties: false\n};\n\nexport default class Store extends EventTarget {\n  constructor() {\n    super();\n\n    if (localStorage.getItem(LOCAL_STORE_KEY) === null) {\n      localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify({}));\n    }\n\n    // When storage is updated in another window\n    window.addEventListener(\"storage\", e => {\n      if (e.key !== LOCAL_STORE_KEY) return;\n      delete this[STORE_STATE_CACHE_KEY];\n      this.dispatchEvent(new CustomEvent(\"statechanged\"));\n    });\n\n    this.update({\n      activity: {},\n      settings: {},\n      credentials: {},\n      profile: {},\n      confirmedDiscordRooms: [],\n      confirmedBroadcastedRooms: [],\n      uploadPromotionTokens: [],\n      creatorAssignmentTokens: [],\n      embedTokens: [],\n      onLoadActions: []\n    });\n\n    const oauthFlowCredentials = Cookies.getJSON(OAUTH_FLOW_CREDENTIALS_KEY);\n    if (oauthFlowCredentials) {\n      this.update({ credentials: oauthFlowCredentials });\n      this.resetToRandomLegacyAvatar();\n      Cookies.remove(OAUTH_FLOW_CREDENTIALS_KEY);\n    }\n  }\n\n  // Initializes store with any default bits\n  init = () => {\n    this.update({\n      profile: { ...generateDefaultProfile(), ...(this.state.profile || {}) }\n    });\n\n    // Regenerate name to encourage users to change it.\n    if (!this.state.activity.hasChangedName) {\n      this.update({ profile: { displayName: generateRandomName() } });\n    }\n  };\n\n  resetToRandomLegacyAvatar = () => {\n    this.update({\n      profile: { ...(this.state.profile || {}), ...generateDefaultProfile() }\n    });\n  };\n\n  get state() {\n    if (!this.hasOwnProperty(STORE_STATE_CACHE_KEY)) {\n      this[STORE_STATE_CACHE_KEY] = JSON.parse(localStorage.getItem(LOCAL_STORE_KEY));\n    }\n\n    return this[STORE_STATE_CACHE_KEY];\n  }\n\n  get credentialsAccountId() {\n    if (this.state.credentials.token) {\n      return jwtDecode(this.state.credentials.token).sub;\n    } else {\n      return null;\n    }\n  }\n\n  resetConfirmedBroadcastedRooms() {\n    this.clearStoredArray(\"confirmedBroadcastedRooms\");\n  }\n\n  resetTipActivityFlags() {\n    this.update({\n      activity: { hasRotated: false, hasPinned: false, hasRecentered: false, hasScaled: false, entryCount: 0 }\n    });\n  }\n\n  bumpEntryCount() {\n    const currentEntryCount = this.state.activity.entryCount || 0;\n    this.update({ activity: { entryCount: currentEntryCount + 1 } });\n  }\n\n  // Sets a one-time action to perform the next time the page loads\n  enqueueOnLoadAction(action, args) {\n    this.update({ onLoadActions: [{ action, args }] });\n  }\n\n  executeOnLoadActions(sceneEl) {\n    for (let i = 0; i < this.state.onLoadActions.length; i++) {\n      const { action, args } = this.state.onLoadActions[i];\n\n      if (action === \"emit_scene_event\") {\n        sceneEl.emit(args.event, args.detail);\n      }\n    }\n\n    this.clearOnLoadActions();\n  }\n\n  clearOnLoadActions() {\n    this.clearStoredArray(\"onLoadActions\");\n  }\n\n  clearStoredArray(key) {\n    const overwriteMerge = (destinationArray, sourceArray) => sourceArray;\n    const update = {};\n    update[key] = [];\n\n    this.update(update, { arrayMerge: overwriteMerge });\n  }\n\n  update(newState, mergeOpts) {\n    const finalState = merge(this.state, newState, mergeOpts);\n    const { valid } = validator.validate(finalState, SCHEMA);\n\n    if (!valid) {\n      // Intentionally not including details about the state or validation result here, since we don't want to leak\n      // sensitive data in the error message.\n      throw new Error(`Write to store failed schema validation.`);\n    }\n\n    localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify(finalState));\n    delete this[STORE_STATE_CACHE_KEY];\n\n    if (newState.profile !== undefined) {\n      this.dispatchEvent(new CustomEvent(\"profilechanged\"));\n    }\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n\n    return finalState;\n  }\n}\n","import screenfull from \"screenfull\";\nimport { showFullScreenIfWasFullScreen } from \"./fullscreen\";\nconst { detect } = require(\"detect-browser\");\n\nconst browser = detect();\nlet isExitingFullscreenDueToFocus = false;\n\n// Utility function that handles a bunch of incidental stuff related to text fields:\n//\n// - On non-mobile platforms, selects the value on focus\n// - If full screen, exits/enters full screen because of firefox full screen issues\nexport function handleTextFieldFocus(target) {\n  if (!window.AFRAME) return;\n  const isMobile = AFRAME.utils.device.isMobile();\n\n  if (screenfull.isFullscreen && !AFRAME.utils.device.isMobileVR() && browser.name === \"firefox\") {\n    // This will prevent focus, but its the only way to avoid getting into a\n    // weird \"firefox reports full screen but actually not\". You end up having to tap\n    // twice to ultimately get the focus.\n    //\n    // We need to keep track of a bit here so that we don't re-full screen when\n    // the text box is blurred by the browser.\n\n    isExitingFullscreenDueToFocus = true;\n    screenfull.exit().then(() => {\n      target.focus();\n    });\n  }\n\n  if (!isMobile) target.select();\n}\n\nexport function handleTextFieldBlur() {\n  // This is the incidental blur event when exiting fullscreen mode on mobile\n  if (isExitingFullscreenDueToFocus) {\n    isExitingFullscreenDueToFocus = false;\n    return;\n  }\n\n  showFullScreenIfWasFullScreen();\n}\n","module.exports = __webpack_public_path__ + \"assets/images/mic_denied-5ce12e4dc9b5eb42ce69b753c46c2174.png\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"entry-button-secondary\":\"entry__entry-button-secondary__1Fr_E\",\"entryButtonSecondary\":\"entry__entry-button-secondary__1Fr_E\",\"entry-panel\":\"entry__entry-panel__34CD9\",\"entryPanel\":\"entry__entry-panel__34CD9\",\"button-container\":\"entry__button-container__3Blog\",\"buttonContainer\":\"entry__button-container__3Blog\",\"secondary-action-button\":\"entry__secondary-action-button__3FCMj\",\"secondaryActionButton\":\"entry__secondary-action-button__3FCMj\",\"entry-button\":\"entry__entry-button__G7PQF\",\"entryButton\":\"entry__entry-button__G7PQF\",\"action-button\":\"entry__action-button__3Vnab\",\"actionButton\":\"entry__action-button__3Vnab\",\"collapse-button\":\"entry__collapse-button__3_PLp\",\"collapseButton\":\"entry__collapse-button__3_PLp\",\"favorite-button\":\"entry__favorite-button__2CVuk\",\"favoriteButton\":\"entry__favorite-button__2CVuk\",\"back\":\"entry__back__J4Sgl\",\"lobby-label\":\"entry__lobby-label__2Nj9w\",\"lobbyLabel\":\"entry__lobby-label__2Nj9w\",\"label\":\"entry__label__fUhpb\",\"title\":\"entry__title__1GITj\",\"name\":\"entry__name__sYOeV\",\"rename-button\":\"entry__rename-button__KFW9R\",\"renameButton\":\"entry__rename-button__KFW9R\",\"center\":\"entry__center__1105W\",\"wide-button\":\"entry__wide-button__2tfMM\",\"wideButton\":\"entry__wide-button__2tfMM\",\"screen-sharing\":\"entry__screen-sharing__NBXQu\",\"screenSharing\":\"entry__screen-sharing__NBXQu\",\"checkbox\":\"entry__checkbox__3SoPk\",\"entry-dialog\":\"entry__entry-dialog__30kMs\",\"entryDialog\":\"entry__entry-dialog__30kMs\",\"favorited\":\"entry__favorited__2IHpj\",\"icon\":\"entry__icon__3JiUl\",\"bolded\":\"entry__bolded__13B4f\",\"subtitle\":\"entry__subtitle__1BC2y\",\"room-subtitle\":\"entry__room-subtitle__7MSMo\",\"roomSubtitle\":\"entry__room-subtitle__7MSMo\",\"lobby\":\"entry__lobby__3AxfL\",\"profile-icon\":\"entry__profile-icon__3BAWG\",\"profileIcon\":\"entry__profile-icon__3BAWG\",\"button-subtitle\":\"entry__button-subtitle__3zrEo\",\"buttonSubtitle\":\"entry__button-subtitle__3zrEo\",\"audio-loader\":\"entry__audio-loader__1YCJd\",\"audioLoader\":\"entry__audio-loader__1YCJd\",\"webvr-link-container\":\"entry__webvr-link-container__3scWP\",\"webvrLinkContainer\":\"entry__webvr-link-container__3scWP\",\"webvr-link\":\"entry__webvr-link__3eWuZ\",\"webvrLink\":\"entry__webvr-link__3eWuZ\",\"secondary\":\"entry__secondary__3uhYE\"};","module.exports = __webpack_public_path__ + \"assets/images/mic_denied@2x-127a94ff73b93a0b4ac89682ce836b91.png\";","// extracted by mini-css-extract-plugin\nmodule.exports = {\"cancel-button\":\"promote-client-dialog__cancel-button__3YZLa\",\"cancelButton\":\"promote-client-dialog__cancel-button__3YZLa\",\"confirm-button\":\"promote-client-dialog__confirm-button__3LXvQ\",\"confirmButton\":\"promote-client-dialog__confirm-button__3LXvQ\",\"message\":\"promote-client-dialog__message__1LA_N\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"cancel-button\":\"close-room-dialog__cancel-button__MmtAo\",\"cancelButton\":\"close-room-dialog__cancel-button__MmtAo\",\"confirm-button\":\"close-room-dialog__confirm-button__Bs9y3\",\"confirmButton\":\"close-room-dialog__confirm-button__Bs9y3\",\"message\":\"close-room-dialog__message__1Rvh3\"};","// Enumeration of spawned object content origins. URL means the content is\n// fetched from a URL, FILE means it was an uploaded/dropped file, and\n// CLIPBOARD means it was raw data pasted in from the clipboard, SPAWNER means\n// it was copied over from a spawner.\nexport const ObjectContentOrigins = {\n  URL: 1,\n  FILE: 2,\n  CLIPBOARD: 3,\n  SPAWNER: 4\n};\n\n// Enumeration of spawnable object types, used for telemetry, which encapsulates\n// both the origin of the content for the object and also the type of content\n// contained in the object.\nexport const ObjectTypes = {\n  URL_IMAGE: 0,\n  URL_VIDEO: 1,\n  URL_MODEL: 2,\n  URL_PDF: 3,\n  URL_AUDIO: 4,\n  //URL_TEXT: 5,\n  //URL_TELEPORTER: 6,\n  FILE_IMAGE: 8,\n  FILE_VIDEO: 9,\n  FILE_MODEL: 10,\n  FILE_PDF: 11,\n  FILE_AUDIO: 12,\n  //FILE_TEXT: 13,\n  CLIPBOARD_IMAGE: 16,\n  CLIPBOARD_VIDEO: 17,\n  CLIPBOARD_MODEL: 18,\n  CLIPBOARD_PDF: 19,\n  CLIPBOARD_AUDIO: 20,\n  //CLIPBOARD_TEXT: 21,\n  SPAWNER_IMAGE: 24,\n  SPAWNER_VIDEO: 25,\n  SPAWNER_MODEL: 26,\n  SPAWNER_PDF: 27,\n  SPAWNER_AUDIO: 28,\n  //SPAWNER_TEXT: 29,\n  CAMERA: 30,\n  UNKNOWN: 31\n};\n\n// Given an origin and three object type values for URL, FILE, and CLIPBOARD\n// origins respectively, return the appropriate one\nfunction objectTypeForOrigin(contentOrigin, urlType, fileType, clipboardType, spawnerType) {\n  if (contentOrigin === ObjectContentOrigins.URL) {\n    return urlType;\n  } else if (contentOrigin === ObjectContentOrigins.FILE) {\n    return fileType;\n  } else if (contentOrigin === ObjectContentOrigins.CLIPBOARD) {\n    return clipboardType;\n  } else {\n    return spawnerType;\n  }\n}\n\n// Lookup table of mime-type prefixes to the set of object types that we should use\n// for objects spawned matching their underlying Content-Type.\nconst objectTypeMimePrefixLookupMap = {\n  \"image/\": [ObjectTypes.URL_IMAGE, ObjectTypes.FILE_IMAGE, ObjectTypes.CLIPBOARD_IMAGE, ObjectTypes.SPAWNER_IMAGE],\n  \"model/\": [ObjectTypes.URL_MODEL, ObjectTypes.FILE_MODEL, ObjectTypes.CLIPBOARD_MODEL, ObjectTypes.SPAWNER_MODEL],\n  \"application/x-zip-compressed\": [\n    ObjectTypes.URL_MODEL,\n    ObjectTypes.FILE_MODEL,\n    ObjectTypes.CLIPBOARD_MODEL,\n    ObjectTypes.SPAWNER_MODEL\n  ],\n  \"video/\": [ObjectTypes.URL_VIDEO, ObjectTypes.FILE_VIDEO, ObjectTypes.CLIPBOARD_VIDEO, ObjectTypes.SPAWNER_VIDEO],\n  \"application/vnd.apple.mpegurl\": [\n    ObjectTypes.URL_VIDEO,\n    ObjectTypes.FILE_VIDEO,\n    ObjectTypes.CLIPBOARD_VIDEO,\n    ObjectTypes.SPAWNER_VIDEO\n  ],\n  \"application/x-mpegurl\": [\n    ObjectTypes.URL_VIDEO,\n    ObjectTypes.FILE_VIDEO,\n    ObjectTypes.CLIPBOARD_VIDEO,\n    ObjectTypes.SPAWNER_VIDEO\n  ],\n  \"audio/\": [ObjectTypes.URL_AUDIO, ObjectTypes.FILE_AUDIO, ObjectTypes.CLIPBOARD_AUDIO, ObjectTypes.SPAWNER_AUDIO],\n  \"application/pdf\": [ObjectTypes.URL_PDF, ObjectTypes.FILE_PDF, ObjectTypes.CLIPBOARD_PDF, ObjectTypes.SPAWNER_PDF]\n};\n\nconst srcSuffixLookupMap = {\n  \".m3u8\": [ObjectTypes.URL_VIDEO, ObjectTypes.FILE_VIDEO, ObjectTypes.CLIPBOARD_VIDEO, ObjectTypes.SPAWNER_VIDEO]\n};\n\n// Given an content origin and the resolved mime type of a piece of content, return\n// the ObjectType, if any, for that content.\nexport function objectTypeForOriginAndContentType(contentOrigin, contentType, src) {\n  for (const prefix in objectTypeMimePrefixLookupMap) {\n    if (contentType.toLowerCase().startsWith(prefix)) {\n      const types = objectTypeMimePrefixLookupMap[prefix];\n      return objectTypeForOrigin(contentOrigin, ...types);\n    }\n  }\n\n  if (src) {\n    for (const suffix in srcSuffixLookupMap) {\n      if (src.toLowerCase().endsWith(suffix)) {\n        const types = srcSuffixLookupMap[suffix];\n        return objectTypeForOrigin(contentOrigin, ...types);\n      }\n    }\n  }\n\n  return ObjectTypes.UNKNOWN;\n}\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"invite-container\":\"invite-dialog__invite-container__1c0Jw\",\"inviteContainer\":\"invite-dialog__invite-container__1c0Jw\",\"dialog\":\"invite-dialog__dialog__1XbxO\",\"link-button\":\"invite-dialog__link-button__S_o-t\",\"linkButton\":\"invite-dialog__link-button__S_o-t\",\"enter-vr-button\":\"invite-dialog__enter-vr-button__3y1BF\",\"enterVrButton\":\"invite-dialog__enter-vr-button__3y1BF\",\"invite-button\":\"invite-dialog__invite-button__3cjFw\",\"inviteButton\":\"invite-dialog__invite-button__3cjFw\",\"enter-button\":\"invite-dialog__enter-button__2Z5EY\",\"enterButton\":\"invite-dialog__enter-button__2Z5EY\",\"invite-mini-button\":\"invite-dialog__invite-mini-button__2zWJj\",\"inviteMiniButton\":\"invite-dialog__invite-mini-button__2zWJj\",\"domain\":\"invite-dialog__domain__2Q8Wr\",\"embed-text\":\"invite-dialog__embed-text__3-Boo\",\"embedText\":\"invite-dialog__embed-text__3-Boo\",\"invite-container-inverted\":\"invite-dialog__invite-container-inverted__1E3hR\",\"inviteContainerInverted\":\"invite-dialog__invite-container-inverted__1E3hR\",\"subscribe\":\"invite-dialog__subscribe__qlJL4\",\"embed-tip-wrap\":\"invite-dialog__embed-tip-wrap__2CQRc\",\"embedTipWrap\":\"invite-dialog__embed-tip-wrap__2CQRc\",\"embed-tip\":\"invite-dialog__embed-tip__12p0o\",\"embedTip\":\"invite-dialog__embed-tip__12p0o\",\"modal\":\"invite-dialog__modal__1hbVP\",\"hide-small-screens\":\"invite-dialog__hide-small-screens__3UCeH\",\"hideSmallScreens\":\"invite-dialog__hide-small-screens__3UCeH\",\"invite-container-below-hud\":\"invite-dialog__invite-container-below-hud__30RHX\",\"inviteContainerBelowHud\":\"invite-dialog__invite-container-below-hud__30RHX\",\"attach-point\":\"invite-dialog__attach-point__otyII\",\"attachPoint\":\"invite-dialog__attach-point__otyII\",\"code\":\"invite-dialog__code__13AIx\",\"keep-open\":\"invite-dialog__keep-open__229sO\",\"keepOpen\":\"invite-dialog__keep-open__229sO\",\"digit\":\"invite-dialog__digit__2w64P\",\"digit_2\":\"invite-dialog__digit_2__pQCJ3\",\"digit2\":\"invite-dialog__digit_2__pQCJ3\",\"digit_3\":\"invite-dialog__digit_3__1bWtt\",\"digit3\":\"invite-dialog__digit_3__1bWtt\",\"code-loading-panel\":\"invite-dialog__code-loading-panel__1gghm\",\"codeLoadingPanel\":\"invite-dialog__code-loading-panel__1gghm\",\"hub-link-link\":\"invite-dialog__hub-link-link__2guVF\",\"hubLinkLink\":\"invite-dialog__hub-link-link__2guVF\",\"buttons\":\"invite-dialog__buttons__1yN_j\",\"embed\":\"invite-dialog__embed__2zy_A\",\"close\":\"invite-dialog__close__3PAxl\",\"embed-tip-attach-point\":\"invite-dialog__embed-tip-attach-point__2UAZp\",\"embedTipAttachPoint\":\"invite-dialog__embed-tip-attach-point__2UAZp\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"bottom-links-main\":\"settings-menu__bottom-links-main__Vtlje\",\"bottomLinksMain\":\"settings-menu__bottom-links-main__Vtlje\",\"bottom-links\":\"settings-menu__bottom-links__b1tDE\",\"bottomLinks\":\"settings-menu__bottom-links__b1tDE\",\"settings-menu\":\"settings-menu__settings-menu__3x1Pv\",\"settingsMenu\":\"settings-menu__settings-menu__3x1Pv\",\"attach-point\":\"settings-menu__attach-point__2gV3g\",\"attachPoint\":\"settings-menu__attach-point__2gV3g\",\"contents\":\"settings-menu__contents__3GQlW\",\"rows\":\"settings-menu__rows__2OtlS\",\"row\":\"settings-menu__row__3w7fz\",\"row-header\":\"settings-menu__row-header__2oCqk\",\"rowHeader\":\"settings-menu__row-header__2oCqk\",\"list-item\":\"settings-menu__list-item__1__z6\",\"listItem\":\"settings-menu__list-item__1__z6\",\"list-item-link\":\"settings-menu__list-item-link__2ovr3\",\"listItemLink\":\"settings-menu__list-item-link__2ovr3\",\"settings-row\":\"settings-menu__settings-row__1sDDk\",\"settingsRow\":\"settings-menu__settings-row__1sDDk\",\"icon\":\"settings-menu__icon__3KMMz\"};","export const avatars = [\n  {\n    id: \"botdefault\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotDefault_Avatar-9f71f8ff22.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botdefault-thumb-42C4C7D3C01D085EAFDAC8BACE591CE6.png\"\n  },\n  {\n    id: \"botbobo\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotBobo_Avatar-f9740a010b.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botbobo-thumb-261278FD5831E9CD89610D15948F23E4.png\"\n  },\n  {\n    id: \"botdom\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotDom_Avatar-0c48bf15a5.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botdom-thumb-1160EB5E81D24F12CE643C520CE1E99E.png\"\n  },\n  {\n    id: \"botgreg\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotGreg_Avatar-98d39797bb.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botgreg-thumb-F2A37F14F9C342EE44DDE9B24DD9B9FC.png\"\n  },\n  {\n    id: \"botguest\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotGuest_Avatar-78cd857332.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botguest-thumb-F7A471250E2C10C2709325C3B02A8BBB.png\"\n  },\n  {\n    id: \"botjim\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotJim_Avatar-d28005a687.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botjim-thumb-A2D195C1A51A082BCED58BD172481B39.png\"\n  },\n  {\n    id: \"botkev\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotKev_Avatar-a95787bb51.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botkev-thumb-90746A7349E3F964C913EA612EE9A53F.png\"\n  },\n  {\n    id: \"botpinky\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotPinky_Avatar-b0b93f8675.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botpinky-thumb-C2E69D4479077766B988DC3EE4F30BE5.png\"\n  },\n  {\n    id: \"botrobert\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotRobert_Avatar-e9554880f3.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botrobert-thumb-9C33F2C752326E2CF4321EAA7BDB4E47.png\"\n  },\n  {\n    id: \"botwoody\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotWoody_Avatar-0140485a23.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botwoody-thumb-F1F1FA7E21301B5AC1D8872B4ED0CC56.png\"\n  }\n];\n","import qsTruthy from \"./qs_truthy\";\n\nconst showLog = qsTruthy(\"debug_log\");\n\nif (showLog) {\n  const template = document.createElement(\"template\");\n  template.innerHTML = `\n    <style>\n      #debug-log {\n        position: absolute;\n        top: 13em;\n        background: white;\n        opacity: 0.7;\n        z-index: 1000;\n      }\n      #debug-log, #debug-log-input {\n        font-family: monospace;\n        font-size: 11px;\n        width: 100%;\n      }\n\n      #debug-log-controls {\n        display: flex;\n        padding: 0.2em;\n      }\n\n      #debug-log-eval {\n        display: flex;\n        flex: 1;\n      }\n\n      #debug-log-log {\n        overflow: auto;\n        height: 30vh;\n      }\n      #debug-log-log.minimized {\n        height: auto;\n      }\n      #debug-log-log.minimized .entry {\n        display: none;\n      }\n      #debug-log-log.minimized .entry:last-child {\n        display: block;\n      }\n      #debug-log-log .entry {\n        border: 1px solid grey;\n        margin: 0.2em;\n        padding: 0.2em;\n      }\n      #debug-log-log .entry.error { background-color: pink; }\n      #debug-log-log .entry.warn { background-color: orange; }\n    </style>\n    <div id=\"debug-log\">\n        <div id=\"debug-log-controls\">\n          <form id=\"debug-log-eval\">\n            <input id=\"debug-log-input\" placeholder=\"&gt;&gt;\" autocorrect=\"off\" autocapitalize=\"none\" />\n            <button>&gt;</button>\n          </form>\n          <button id=\"debug-log-minimize\">_</button>\n        </div>\n        <div id=\"debug-log-log\"></div>\n    </div>\n  `;\n\n  document.addEventListener(\"DOMContentLoaded\", () => {\n    document.body.appendChild(template.content);\n  });\n\n  const debugLog = template.content.querySelector(\"#debug-log-log\");\n  debugLog.addEventListener(\"wheel\", e => e.stopPropagation());\n\n  const debugLogInput = template.content.querySelector(\"#debug-log-input\");\n  const debugLogEval = template.content.querySelector(\"#debug-log-eval\");\n  debugLogEval.onsubmit = e => {\n    e.preventDefault();\n    console.log(eval(`(${debugLogInput.value})`));\n  };\n\n  let minimized = false;\n  const debugLogMinimize = template.content.querySelector(\"#debug-log-minimize\");\n  debugLogMinimize.onclick = () => {\n    minimized = !minimized;\n    debugLog.className = minimized ? \"minimized\" : \"\";\n    debugLog.scrollTop = debugLog.scrollHeight - debugLog.clientHeight;\n  };\n\n  const origConsoleLog = console.log;\n  const origConsoleError = console.error;\n  const origConsoleWarn = console.warn;\n\n  const log = function(className, objs) {\n    let entry;\n    if (debugLog.childNodes.length > 1000) {\n      entry = debugLog.firstChild;\n    } else {\n      entry = document.createElement(\"div\");\n      entry.classList.add(\"entry\");\n    }\n    entry.classList.remove(\"warn\", \"error\");\n    entry.classList.add(className);\n\n    const arr = Array.from(objs);\n    const firstObj = arr[0];\n    let content;\n    if (typeof firstObj === \"string\" && firstObj.includes(\"%c\")) {\n      content = firstObj.replace(/%c/g, \"\");\n    } else if (firstObj instanceof Error) {\n      content = `${firstObj.message}\\n${firstObj.stack}`;\n    } else {\n      content = arr\n        .map(obj => {\n          if (typeof obj === \"string\") return obj;\n          return JSON.stringify(obj);\n        })\n        .join(\" \");\n    }\n\n    const time = new Date().toISOString().substring(11, 23);\n    entry.textContent = `[${time}] ${content}`;\n\n    const shouldScroll = debugLog.scrollTop === debugLog.scrollHeight - debugLog.clientHeight;\n    debugLog.append(entry);\n    if (shouldScroll) debugLog.scrollTop = debugLog.scrollHeight - debugLog.clientHeight;\n  };\n\n  console.warn = function() {\n    origConsoleWarn.apply(null, arguments);\n    log(\"warn\", arguments);\n  };\n\n  console.error = function() {\n    origConsoleError.apply(null, arguments);\n    log(\"error\", arguments);\n  };\n\n  console.log = function() {\n    origConsoleLog.apply(null, arguments);\n    log(\"log\", arguments);\n  };\n\n  window.onunhandledrejection = e => log(\"error\", [e.reason.message, e.reason.code, e.reason.name]);\n  window.onerror = e => log(\"error\", [e]);\n}\n","const zeroPos = new THREE.Vector3(0, 0, 0);\nconst zeroQuat = new THREE.Quaternion();\nconst oneScale = new THREE.Vector3(1, 1, 1);\nconst identity = new THREE.Matrix4();\nidentity.identity();\n\n// Patch animation system\nconst bindingSetters = THREE.PropertyBinding.prototype.SetterByBindingTypeAndVersioning;\nconst Versioning = THREE.PropertyBinding.prototype.Versioning;\n\n// For all binding types, monkey patch the setters that require world matrix\n// updates to also flip matrixNeedsUpdate\nfor (let i = 0; i < bindingSetters.length; i++) {\n  const setter = bindingSetters[i][Versioning.MatrixWorldNeedsUpdate];\n  if (!setter) continue;\n\n  bindingSetters[i][Versioning.MatrixWorldNeedsUpdate] = function() {\n    const v = setter.apply(this, arguments);\n    this.targetObject.matrixNeedsUpdate = true;\n    return v;\n  };\n}\n\nTHREE.Object3D.prototype.getWorldPosition = function(target) {\n  if (target === undefined) {\n    console.warn(\"THREE.Object3D: .getWorldPosition() target is now required\");\n    target = new THREE.Vector3();\n  }\n\n  // New function, defined below (used instead of updateMatrixWorld)\n  this.updateMatrices();\n\n  return target.setFromMatrixPosition(this.matrixWorld);\n};\n\nTHREE.Object3D.prototype.getWorldQuaternion = (function() {\n  const position = new THREE.Vector3();\n  const scale = new THREE.Vector3();\n\n  return function getWorldQuaternion(target) {\n    if (target === undefined) {\n      console.warn(\"THREE.Object3D: .getWorldQuaternion() target is now required\");\n      target = new THREE.Quaternion();\n    }\n\n    // New function, defined below (used instead of updateMatrixWorld)\n    this.updateMatrices();\n    this.matrixWorld.decompose(position, target, scale);\n\n    return target;\n  };\n})();\n\nTHREE.Object3D.getWorldScale = (function() {\n  const position = new THREE.Vector3();\n  const quaternion = new THREE.Quaternion();\n\n  return function getWorldScale(target) {\n    if (target === undefined) {\n      console.warn(\"THREE.Object3D: .getWorldScale() target is now required\");\n      target = new THREE.Vector3();\n    }\n\n    // New function, defined below (used instead of updateMatrixWorld)\n    this.updateMatrices();\n    this.matrixWorld.decompose(position, quaternion, target);\n\n    return target;\n  };\n})();\n\nconst handleMatrixModification = o => {\n  if (!o.matrixIsModified) {\n    o.matrixIsModified = true;\n\n    if (o.cachedMatrixWorld) {\n      o.cachedMatrixWorld.copy(o.matrixWorld);\n      o.matrixWorld = o.cachedMatrixWorld;\n    }\n  }\n};\n\nconst updateMatrix = THREE.Object3D.prototype.updateMatrix;\nTHREE.Object3D.prototype.updateMatrix = function() {\n  updateMatrix.apply(this, arguments);\n  handleMatrixModification(this);\n};\n\nconst applyMatrix = THREE.Object3D.prototype.applyMatrix;\nTHREE.Object3D.prototype.applyMatrix = function() {\n  applyMatrix.apply(this, arguments);\n  handleMatrixModification(this);\n};\n\n// By the end of this function this.matrix reflects the updated local matrix\n// and this.matrixWorld reflects the updated world matrix, taking into account\n// parent matrices.\n//\n// forceLocalUpdate - Forces the local matrix to be updated regardless of if it has not\n// been marked dirty.\n//\n// forceWorldUpdate - Forces the world matrix to be updated regardless of if the local matrix\n// has been updated since the last update.\n//\n// skipParents - unless true, all parent matricies are updated before updating this object's\n// local and world matrix.\n//\nTHREE.Object3D.prototype.updateMatrices = function(forceLocalUpdate, forceWorldUpdate, skipParents) {\n  if (!this.hasHadFirstMatrixUpdate) {\n    if (\n      !this.position.equals(zeroPos) ||\n      !this.quaternion.equals(zeroQuat) ||\n      !this.scale.equals(oneScale) ||\n      !this.matrix.equals(identity)\n    ) {\n      // Only update the matrix the first time if its non-identity, this way\n      // this.matrixIsModified will remain false until the default\n      // identity matrix is updated.\n      this.updateMatrix();\n    }\n\n    this.hasHadFirstMatrixUpdate = true;\n    this.matrixWorldNeedsUpdate = true;\n    this.cachedMatrixWorld = this.matrixWorld;\n  } else if (this.matrixNeedsUpdate || this.matrixAutoUpdate || forceLocalUpdate) {\n    this.updateMatrix();\n    if (this.matrixNeedsUpdate) this.matrixNeedsUpdate = false;\n  }\n\n  if (!skipParents && this.parent) {\n    this.parent.updateMatrices(false, forceWorldUpdate, false);\n    this.matrixWorldNeedsUpdate = this.matrixWorldNeedsUpdate || this.parent.childrenNeedMatrixWorldUpdate;\n  }\n\n  if (this.matrixWorldNeedsUpdate || forceWorldUpdate) {\n    if (this.parent === null) {\n      this.matrixWorld.copy(this.matrix);\n    } else {\n      // If the matrix is unmodified, it is the identity matrix,\n      // and hence we can use the parent's world matrix directly.\n      //\n      // Note this assumes all callers will either not pass skipParents=true\n      // *or* will update the parent themselves beforehand as is done in\n      // updateMatrixWorld.\n      if (!this.matrixIsModified) {\n        this.matrixWorld = this.parent.matrixWorld;\n      } else {\n        // Once matrixIsModified === true, this.matrixWorld has been updated to be a local\n        // copy, not a reference to this.parent.matrixWorld (see updateMatrix/applyMatrix)\n        this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix);\n      }\n    }\n\n    this.childrenNeedMatrixWorldUpdate = true;\n    this.matrixWorldNeedsUpdate = false;\n  }\n};\n\n// Computes this object's matrices and then the recursively computes the matrices of all the children.\n//\n// forceWorldUpdate - If true and the object is visible, will force the world matrix to be updated for\n// this node and all of its children.\n//\n// includeInvisible - If true, does not ignore non-visible objects.\nTHREE.Object3D.prototype.updateMatrixWorld = function(forceWorldUpdate, includeInvisible) {\n  if (!this.visible && !includeInvisible) return;\n\n  // Do not recurse upwards, since this is recursing downwards\n  this.updateMatrices(false, forceWorldUpdate, true);\n\n  const children = this.children;\n  const forceChildrenWorldUpdate = this.childrenNeedMatrixWorldUpdate || forceWorldUpdate;\n\n  for (let i = 0, l = children.length; i < l; i++) {\n    children[i].updateMatrixWorld(forceChildrenWorldUpdate, includeInvisible);\n  }\n\n  if (this.childrenNeedMatrixWorldUpdate) this.childrenNeedMatrixWorldUpdate = false;\n};\n\n// Updates this function to use updateMatrices() to avoid extra matrix computations\nTHREE.Object3D.prototype.lookAt = (function() {\n  // This method does not support objects having non-uniformly-scaled parent(s)\n\n  const q1 = new THREE.Quaternion();\n  const m1 = new THREE.Matrix4();\n  const target = new THREE.Vector3();\n  const position = new THREE.Vector3();\n\n  return function lookAt(x, y, z) {\n    if (x.isVector3) {\n      target.copy(x);\n    } else {\n      target.set(x, y, z);\n    }\n\n    const parent = this.parent;\n\n    this.updateMatrices(); // hubs change\n\n    position.setFromMatrixPosition(this.matrixWorld);\n\n    if (this.isCamera || this.isLight) {\n      m1.lookAt(position, target, this.up);\n    } else {\n      m1.lookAt(target, position, this.up);\n    }\n\n    this.quaternion.setFromRotationMatrix(m1);\n\n    if (parent) {\n      m1.extractRotation(parent.matrixWorld);\n      q1.setFromRotationMatrix(m1);\n      this.quaternion.premultiply(q1.inverse());\n    }\n  };\n})();\n","/* eslint-disable */\n\n// Modified version of A-Frame's animation component to set matrixNeedsUpdate = true in the\n// scenario where the transform changes on an object during an animation.\n//\n// Changes are identified w comment // hubs\n//\n// Bugfix added 3/1/19 - If an animation component is removed before its delay setting, then\n// it erroneously restarts.\n\nvar anime = require(\"animejs\").default;\nvar components = AFRAME.components; // hubs\nvar registerComponent = AFRAME.registerComponent; // hubs\n//var THREE = require('../lib/three'); // hubs\nvar utils = AFRAME.utils; // hubs\n\ndelete AFRAME.components.animation; // hubs\n\nvar colorHelperFrom = new THREE.Color();\nvar colorHelperTo = new THREE.Color();\n\nvar getComponentProperty = utils.entity.getComponentProperty;\nvar setComponentProperty = utils.entity.setComponentProperty;\nvar splitCache = {};\n\nvar TYPE_COLOR = \"color\";\nvar PROP_POSITION = \"position\";\nvar PROP_ROTATION = \"rotation\";\nvar PROP_SCALE = \"scale\";\nvar STRING_COMPONENTS = \"components\";\nvar STRING_OBJECT3D = \"object3D\";\n\n/**\n * Animation component for A-Frame using anime.js.\n *\n * The component manually controls the tick by setting `autoplay: false` on anime.js and\n * manually * calling `animation.tick()` in the tick handler. To pause or resume, we toggle a\n * boolean * flag * `isAnimationPlaying`.\n *\n * anime.js animation config for tweenining Javascript objects and values works as:\n *\n *  config = {\n *    targets: {foo: 0.0, bar: '#000'},\n *    foo: 1.0,\n *    bar: '#FFF'\n *  }\n *\n * The above will tween each property in `targets`. The `to` values are set in the root of\n * the config.\n *\n * @member {object} animation - anime.js instance.\n * @member {boolean} animationIsPlaying - Control if animation is playing.\n */\nmodule.exports.Component = registerComponent(\"animation\", {\n  schema: {\n    autoplay: { default: true },\n    delay: { default: 0 },\n    dir: { default: \"\" },\n    dur: { default: 1000 },\n    easing: { default: \"easeInQuad\" },\n    elasticity: { default: 400 },\n    enabled: { default: true },\n    from: { default: \"\" },\n    loop: {\n      default: 0,\n      parse: function(value) {\n        // Boolean or integer.\n        if (value === true || value === \"true\") {\n          return true;\n        }\n        if (value === false || value === \"false\") {\n          return false;\n        }\n        return parseInt(value, 10);\n      }\n    },\n    property: { default: \"\" },\n    startEvents: { type: \"array\" },\n    pauseEvents: { type: \"array\" },\n    resumeEvents: { type: \"array\" },\n    round: { default: false },\n    to: { default: \"\" },\n    type: { default: \"\" },\n    isRawProperty: { default: false }\n  },\n\n  multiple: true,\n\n  init: function() {\n    var self = this;\n\n    this.eventDetail = { name: this.attrName };\n    this.time = 0;\n\n    this.animation = null;\n    this.animationIsPlaying = false;\n    this.onStartEvent = this.onStartEvent.bind(this);\n    this.beginAnimation = this.beginAnimation.bind(this);\n    this.pauseAnimation = this.pauseAnimation.bind(this);\n    this.resumeAnimation = this.resumeAnimation.bind(this);\n\n    this.fromColor = {};\n    this.toColor = {};\n    this.targets = {};\n    this.targetsArray = [];\n\n    this.updateConfigForDefault = this.updateConfigForDefault.bind(this);\n    this.updateConfigForRawColor = this.updateConfigForRawColor.bind(this);\n\n    this.config = {\n      complete: function() {\n        self.animationIsPlaying = false;\n        self.el.emit(\"animationcomplete\", self.eventDetail, false);\n        if (self.id) {\n          self.el.emit(\"animationcomplete__\" + self.id, self.eventDetail, false);\n        }\n      }\n    };\n  },\n\n  update: function(oldData) {\n    var config = this.config;\n    var data = this.data;\n\n    this.animationIsPlaying = false;\n\n    if (!this.data.enabled) {\n      return;\n    }\n\n    if (!data.property) {\n      return;\n    }\n\n    // Base config.\n    config.autoplay = false;\n    config.direction = data.dir;\n    config.duration = data.dur;\n    config.easing = data.easing;\n    config.elasticity = data.elasticity;\n    config.loop = data.loop;\n    config.round = data.round;\n\n    // Start new animation.\n    this.createAndStartAnimation();\n  },\n\n  tick: function(t, dt) {\n    if (!this.animationIsPlaying) {\n      return;\n    }\n    this.time += dt;\n    this.animation.tick(this.time);\n  },\n\n  remove: function() {\n    this.pauseAnimation();\n    this.removeEventListeners();\n    this.cancelDelayedStart(); // hubs\n  },\n\n  pause: function() {\n    this.paused = true;\n    this.pausedWasPlaying = this.animationIsPlaying;\n    this.pauseAnimation();\n    this.removeEventListeners();\n    this.cancelDelayedStart(); // hubs\n  },\n\n  /**\n   * `play` handler only for resuming scene.\n   */\n  play: function() {\n    if (!this.paused) {\n      return;\n    }\n    this.paused = false;\n    this.addEventListeners();\n    if (this.pausedWasPlaying) {\n      this.resumeAnimation();\n      this.pausedWasPlaying = false;\n    }\n  },\n\n  /**\n   * Start animation from scratch.\n   */\n  createAndStartAnimation: function() {\n    var data = this.data;\n\n    this.updateConfig();\n    this.animationIsPlaying = false;\n    this.animation = anime(this.config);\n\n    this.removeEventListeners();\n    this.cancelDelayedStart(); // hubs\n    this.addEventListeners();\n\n    // Wait for start events for animation.\n    if (!data.autoplay || (data.startEvents && data.startEvents.length)) {\n      return;\n    }\n\n    // Delay animation.\n    if (data.delay) {\n      // hubs\n      this.delayTimeout = setTimeout(this.beginAnimation, data.delay);\n      return;\n    }\n\n    // Play animation.\n    this.beginAnimation();\n  },\n\n  /**\n   * This is before animation start (including from startEvents).\n   * Set to initial state (config.from, time = 0, seekTime = 0).\n   */\n  beginAnimation: function() {\n    this.updateConfig();\n    this.time = 0;\n    this.animationIsPlaying = true;\n    this.stopRelatedAnimations();\n    this.el.emit(\"animationbegin\", this.eventDetail, false);\n  },\n\n  pauseAnimation: function() {\n    this.animationIsPlaying = false;\n  },\n\n  resumeAnimation: function() {\n    this.animationIsPlaying = true;\n  },\n\n  /**\n   * startEvents callback.\n   */\n  onStartEvent: function() {\n    if (!this.data.enabled) {\n      return;\n    }\n\n    this.updateConfig();\n    if (this.animation) {\n      this.animation.pause();\n    }\n    this.animation = anime(this.config);\n\n    // Include the delay before each start event.\n    if (this.data.delay) {\n      setTimeout(this.beginAnimation, this.data.delay);\n      return;\n    }\n    this.beginAnimation();\n  },\n\n  /**\n   * rawProperty: true and type: color;\n   */\n  updateConfigForRawColor: function() {\n    var config = this.config;\n    var data = this.data;\n    var el = this.el;\n    var from;\n    var key;\n    var to;\n\n    if (this.waitComponentInitRawProperty(this.updateConfigForRawColor)) {\n      return;\n    }\n\n    from = data.from === \"\" ? getRawProperty(el, data.property) : data.from;\n    to = data.to;\n\n    // Use r/g/b vector for color type.\n    this.setColorConfig(from, to);\n    from = this.fromColor;\n    to = this.toColor;\n\n    this.targetsArray.length = 0;\n    this.targetsArray.push(from);\n    config.targets = this.targetsArray;\n    for (key in to) {\n      config[key] = to[key];\n    }\n\n    config.update = (function() {\n      var lastValue = {};\n      return function(anim) {\n        var value;\n        value = anim.animatables[0].target;\n        // For animation timeline.\n        if (value.r === lastValue.r && value.g === lastValue.g && value.b === lastValue.b) {\n          return;\n        }\n\n        setRawProperty(el, data.property, value, data.type);\n      };\n    })();\n  },\n\n  /**\n   * Stuff property into generic `property` key.\n   */\n  updateConfigForDefault: function() {\n    var config = this.config;\n    var data = this.data;\n    var el = this.el;\n    var from;\n    var isBoolean;\n    var isNumber;\n    var to;\n\n    if (this.waitComponentInitRawProperty(this.updateConfigForDefault)) {\n      return;\n    }\n\n    if (data.from === \"\") {\n      // Infer from.\n      from = isRawProperty(data) ? getRawProperty(el, data.property) : getComponentProperty(el, data.property);\n    } else {\n      // Explicit from.\n      from = data.from;\n    }\n\n    to = data.to;\n\n    isNumber = !isNaN(from || to);\n    if (isNumber) {\n      from = parseFloat(from);\n      to = parseFloat(to);\n    } else {\n      from = from ? from.toString() : from;\n      to = to ? to.toString() : to;\n    }\n\n    // Convert booleans to integer to allow boolean flipping.\n    isBoolean = data.to === \"true\" || data.to === \"false\" || data.to === true || data.to === false;\n    if (isBoolean) {\n      from = data.from === \"true\" || data.from === true ? 1 : 0;\n      to = data.to === \"true\" || data.to === true ? 1 : 0;\n    }\n\n    this.targets.aframeProperty = from;\n    config.targets = this.targets;\n    config.aframeProperty = to;\n    config.update = (function() {\n      var lastValue;\n\n      return function(anim) {\n        var value;\n        value = anim.animatables[0].target.aframeProperty;\n\n        // Need to do a last value check for animation timeline since all the tweening\n        // begins simultaenously even if the value has not changed. Also better for perf\n        // anyways.\n        if (value === lastValue) {\n          return;\n        }\n        lastValue = value;\n\n        if (isBoolean) {\n          value = value >= 1;\n        }\n\n        if (isRawProperty(data)) {\n          setRawProperty(el, data.property, value, data.type);\n        } else {\n          setComponentProperty(el, data.property, value);\n        }\n      };\n    })();\n  },\n\n  /**\n   * Extend x/y/z/w onto the config.\n   * Update vector by modifying object3D.\n   */\n  updateConfigForVector: function() {\n    var config = this.config;\n    var data = this.data;\n    var el = this.el;\n    var key;\n    var from;\n    var to;\n\n    // Parse coordinates.\n    from =\n      data.from !== \"\"\n        ? utils.coordinates.parse(data.from) // If data.from defined, use that.\n        : getComponentProperty(el, data.property); // If data.from not defined, get on the fly.\n    to = utils.coordinates.parse(data.to);\n\n    if (data.property === PROP_ROTATION) {\n      toRadians(from);\n      toRadians(to);\n    }\n\n    // Set to and from.\n    this.targetsArray.length = 0;\n    this.targetsArray.push(from);\n    config.targets = this.targetsArray;\n    for (key in to) {\n      config[key] = to[key];\n    }\n\n    // If animating object3D transformation, run more optimized updater.\n    if (data.property === PROP_POSITION || data.property === PROP_ROTATION || data.property === PROP_SCALE) {\n      config.update = (function() {\n        var lastValue = {};\n        return function(anim) {\n          var value = anim.animatables[0].target;\n\n          if (data.property === PROP_SCALE) {\n            value.x = Math.max(0.0001, value.x);\n            value.y = Math.max(0.0001, value.y);\n            value.z = Math.max(0.0001, value.z);\n          }\n\n          // For animation timeline.\n          if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\n            return;\n          }\n\n          lastValue.x = value.x;\n          lastValue.y = value.y;\n          lastValue.z = value.z;\n\n          el.object3D[data.property].set(value.x, value.y, value.z);\n          el.object3D.matrixNeedsUpdate = true; // hubs\n        };\n      })();\n      return;\n    }\n\n    // Animating some vector.\n    config.update = (function() {\n      var lastValue = {};\n      return function(anim) {\n        var value = anim.animations[0].target;\n\n        // Animate rotation through radians.\n        // For animation timeline.\n        if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\n          return;\n        }\n        lastValue.x = value.x;\n        lastValue.y = value.y;\n        lastValue.z = value.z;\n        setComponentProperty(el, data.property, value);\n      };\n    })();\n  },\n\n  /**\n   * Update the config before each run.\n   */\n  updateConfig: function() {\n    var propType;\n\n    // Route config type.\n    propType = getPropertyType(this.el, this.data.property);\n    if (isRawProperty(this.data) && this.data.type === TYPE_COLOR) {\n      this.updateConfigForRawColor();\n    } else if (propType === \"vec2\" || propType === \"vec3\" || propType === \"vec4\") {\n      this.updateConfigForVector();\n    } else {\n      this.updateConfigForDefault();\n    }\n  },\n\n  /**\n   * Wait for component to initialize.\n   */\n  waitComponentInitRawProperty: function(cb) {\n    var componentName;\n    var data = this.data;\n    var el = this.el;\n    var self = this;\n\n    if (data.from !== \"\") {\n      return false;\n    }\n\n    if (!data.property.startsWith(STRING_COMPONENTS)) {\n      return false;\n    }\n\n    componentName = splitDot(data.property)[1];\n    if (el.components[componentName]) {\n      return false;\n    }\n\n    el.addEventListener(\"componentinitialized\", function wait(evt) {\n      if (evt.detail.name !== componentName) {\n        return;\n      }\n      cb();\n      // Since the config was created async, create the animation now since we missed it\n      // earlier.\n      self.animation = anime(self.config);\n      el.removeEventListener(\"componentinitialized\", wait);\n    });\n    return true;\n  },\n\n  /**\n   * Make sure two animations on the same property don't fight each other.\n   * e.g., animation__mouseenter=\"property: material.opacity\"\n   *       animation__mouseleave=\"property: material.opacity\"\n   */\n  stopRelatedAnimations: function() {\n    var component;\n    var componentName;\n    for (componentName in this.el.components) {\n      component = this.el.components[componentName];\n      if (componentName === this.attrName) {\n        continue;\n      }\n      if (component.name !== \"animation\") {\n        continue;\n      }\n      if (!component.animationIsPlaying) {\n        continue;\n      }\n      if (component.data.property !== this.data.property) {\n        continue;\n      }\n      component.animationIsPlaying = false;\n    }\n  },\n\n  addEventListeners: function() {\n    var data = this.data;\n    var el = this.el;\n    addEventListeners(el, data.startEvents, this.onStartEvent);\n    addEventListeners(el, data.pauseEvents, this.pauseAnimation);\n    addEventListeners(el, data.resumeEvents, this.resumeAnimation);\n  },\n\n  removeEventListeners: function() {\n    var data = this.data;\n    var el = this.el;\n    removeEventListeners(el, data.startEvents, this.onStartEvent);\n    removeEventListeners(el, data.pauseEvents, this.pauseAnimation);\n    removeEventListeners(el, data.resumeEvents, this.resumeAnimation);\n  },\n\n  // hubs\n  cancelDelayedStart: function() {\n    if (this.delayTimeout) {\n      clearTimeout(this.delayTimeout);\n      this.delayTimeout = null;\n    }\n  },\n\n  setColorConfig: function(from, to) {\n    colorHelperFrom.set(from);\n    colorHelperTo.set(to);\n    from = this.fromColor;\n    to = this.toColor;\n    from.r = colorHelperFrom.r;\n    from.g = colorHelperFrom.g;\n    from.b = colorHelperFrom.b;\n    to.r = colorHelperTo.r;\n    to.g = colorHelperTo.g;\n    to.b = colorHelperTo.b;\n  }\n});\n\n/**\n * Given property name, check schema to see what type we are animating.\n * We just care whether the property is a vector.\n */\nfunction getPropertyType(el, property) {\n  var component;\n  var componentName;\n  var split;\n  var propertyName;\n\n  split = property.split(\".\");\n  componentName = split[0];\n  propertyName = split[1];\n  component = el.components[componentName] || components[componentName];\n\n  // Primitives.\n  if (!component) {\n    return null;\n  }\n\n  // Dynamic schema. We only care about vectors anyways.\n  if (propertyName && !component.schema[propertyName]) {\n    return null;\n  }\n\n  // Multi-prop.\n  if (propertyName) {\n    return component.schema[propertyName].type;\n  }\n\n  // Single-prop.\n  return component.schema.type;\n}\n\n/**\n * Convert object to radians.\n */\nfunction toRadians(obj) {\n  obj.x = THREE.Math.degToRad(obj.x);\n  obj.y = THREE.Math.degToRad(obj.y);\n  obj.z = THREE.Math.degToRad(obj.z);\n}\n\nfunction addEventListeners(el, eventNames, handler) {\n  var i;\n  for (i = 0; i < eventNames.length; i++) {\n    el.addEventListener(eventNames[i], handler);\n  }\n}\n\nfunction removeEventListeners(el, eventNames, handler) {\n  var i;\n  for (i = 0; i < eventNames.length; i++) {\n    el.removeEventListener(eventNames[i], handler);\n  }\n}\n\nfunction getRawProperty(el, path) {\n  var i;\n  var split;\n  var value;\n  split = splitDot(path);\n  value = el;\n  for (i = 0; i < split.length; i++) {\n    value = value[split[i]];\n  }\n  return value;\n}\n\nfunction setRawProperty(el, path, value, type) {\n  var i;\n  var split;\n  var propertyName;\n  var targetValue;\n\n  if (path.startsWith(\"object3D.rotation\")) {\n    value = THREE.Math.degToRad(value);\n  }\n\n  // Walk.\n  split = splitDot(path);\n  targetValue = el;\n  for (i = 0; i < split.length - 1; i++) {\n    targetValue = targetValue[split[i]];\n  }\n  propertyName = split[split.length - 1];\n\n  // Raw color.\n  if (type === TYPE_COLOR) {\n    if (\"r\" in targetValue[propertyName]) {\n      targetValue[propertyName].r = value.r;\n      targetValue[propertyName].g = value.g;\n      targetValue[propertyName].b = value.b;\n    } else {\n      targetValue[propertyName].x = value.r;\n      targetValue[propertyName].y = value.g;\n      targetValue[propertyName].z = value.b;\n    }\n    return;\n  }\n\n  targetValue[propertyName] = value;\n}\n\nfunction splitDot(path) {\n  if (path in splitCache) {\n    return splitCache[path];\n  }\n  splitCache[path] = path.split(\".\");\n  return splitCache[path];\n}\n\nfunction isRawProperty(data) {\n  return data.isRawProperty || data.property.startsWith(STRING_COMPONENTS) || data.property.startsWith(STRING_OBJECT3D);\n}\n","AFRAME.registerComponent(\"ambient-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 }\n  },\n\n  init() {\n    const el = this.el;\n    this.light = new THREE.AmbientLight();\n    this.el.setObject3D(\"ambient-light\", this.light);\n    this.el.sceneEl.systems.light.registerLight(el);\n    this.rendererSystem = this.el.sceneEl.systems.renderer;\n  },\n\n  update(prevData) {\n    if (this.data.color !== prevData.color) {\n      this.light.color.set(this.data.color);\n      this.rendererSystem.applyColorCorrection(this.light.color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      this.light.intensity = this.data.intensity;\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"ambient-light\");\n  }\n});\n","/**\n * Instantiates and updates a THREE.AnimationMixer on an entity.\n * @component animation-mixer\n */\nAFRAME.registerComponent(\"animation-mixer\", {\n  initMixer(animations) {\n    this.mixer = new THREE.AnimationMixer(this.el.object3D);\n    this.el.object3D.animations = animations;\n    this.animations = animations;\n  },\n\n  tick: function(t, dt) {\n    if (this.mixer) {\n      this.mixer.update(dt / 1000);\n    }\n  }\n});\n","/**\n * Sets the CSS class on an entity.\n * @component css-class\n */\nAFRAME.registerComponent(\"css-class\", {\n  schema: {\n    type: \"string\"\n  },\n  multiple: true,\n  init() {\n    this.el.classList.add(this.data);\n  },\n  update(oldData) {\n    if (this.data !== oldData) {\n      this.el.classList.remove(oldData);\n      this.el.classList.add(this.data);\n    }\n  },\n  remove() {\n    this.el.classList.remove(this.data);\n  }\n});\n","import Raven from \"raven-js\";\n\nconst ga = window.ga;\n\nexport default function registerTelemetry(trackedPage, trackedTitle) {\n  const sentryDsn = process.env.SENTRY_DSN;\n  const gaTrackingId = process.env.GA_TRACKING_ID;\n\n  if (sentryDsn) {\n    console.log(\"Tracking: Sentry DSN: \" + sentryDsn);\n    Raven.config(sentryDsn).install();\n  }\n\n  if (ga && gaTrackingId) {\n    console.log(\"Tracking: Google Analytics ID: \" + gaTrackingId);\n\n    ga(\"create\", gaTrackingId, \"auto\");\n\n    if (trackedPage) {\n      ga(\"set\", \"page\", trackedPage);\n    }\n\n    if (trackedTitle) {\n      ga(\"set\", \"title\", trackedTitle);\n    }\n\n    ga(\"send\", \"pageview\");\n  }\n}\n","/* global CANNON */\n/**\n * Floats a duck based on its scale.\n * @component duck\n */\nAFRAME.registerComponent(\"duck\", {\n  schema: {\n    initialForce: { default: 0 },\n    maxForce: { default: 6.5 },\n    maxScale: { default: 5 }\n  },\n\n  init: function() {\n    this.physicsSystem = this.el.sceneEl.systems.physics;\n    this.hasBody = false;\n    this.position = new CANNON.Vec3();\n    this.force = new CANNON.Vec3(0, this.data.initialForce, 0);\n    this.initialScale = this.el.object3D.scale.x;\n    this.maxScale = this.data.maxScale * this.initialScale;\n  },\n\n  play: function() {\n    this.physicsSystem.addComponent(this);\n  },\n\n  pause: function() {\n    this.physicsSystem.removeComponent(this);\n  },\n\n  beforeStep: function() {\n    if (this.el.body && NAF.utils.isMine(this.el)) {\n      const currentScale = this.el.object3D.scale.x;\n      const ratio = Math.min(1, (currentScale - this.initialScale) / (this.maxScale - this.initialScale));\n      const force = ratio * this.data.maxForce;\n      if (force > 0) {\n        const angle = Math.random() * Math.PI * 2;\n        const x = Math.cos(angle);\n        const z = Math.sin(angle);\n        this.force.set(x, force, z);\n        this.position.set(x * 0.01, 0, z * 0.01);\n        this.el.object3D.matrixNeedsUpdate = true;\n        this.el.body.applyForce(this.force, this.position);\n      }\n    }\n  }\n});\n","/* global CANNON */\nAFRAME.registerComponent(\"heightfield\", {\n  init() {\n    this.el.addEventListener(\"componentinitialized\", e => {\n      if (e.detail.name === \"static-body\") {\n        this.generateAndAddHeightfield(this.el.components[\"static-body\"]);\n      }\n    });\n    this.el.setAttribute(\"static-body\", { shape: \"none\", mass: 0 });\n  },\n  generateAndAddHeightfield(body) {\n    const { offset, distance, data } = this.data;\n\n    const orientation = new CANNON.Quaternion();\n    orientation.setFromAxisAngle(new CANNON.Vec3(1, 0, 0), -Math.PI / 2);\n\n    const rotation = new CANNON.Quaternion();\n    rotation.setFromAxisAngle(new CANNON.Vec3(0, 1, 0), -Math.PI / 2);\n    rotation.mult(orientation, orientation);\n\n    const cannonOffset = new CANNON.Vec3(offset.x, offset.y, offset.z);\n\n    const shape = new CANNON.Heightfield(data, { elementSize: distance });\n\n    body.addShape(shape, cannonOffset, orientation);\n  }\n});\n","AFRAME.registerComponent(\"hemisphere-light\", {\n  schema: {\n    skyColor: { type: \"color\" },\n    groundColor: { type: \"color\" },\n    intensity: { default: 1.0 }\n  },\n\n  init() {\n    const el = this.el;\n    this.light = new THREE.HemisphereLight();\n    this.light.position.set(0, 0, 0);\n    this.light.matrixNeedsUpdate = true;\n    this.el.setObject3D(\"hemisphere-light\", this.light);\n    this.el.sceneEl.systems.light.registerLight(el);\n  },\n\n  update(prevData) {\n    if (this.data.skyColor !== prevData.skyColor) {\n      this.light.color.set(this.data.skyColor);\n    }\n\n    if (this.data.groundColor !== prevData.groundColor) {\n      this.light.groundColor.set(this.data.groundColor);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      this.light.intensity = this.data.intensity;\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"hemisphere-light\");\n  }\n});\n","/**\n * Hides entities based on the scene's quality mode\n * @namespace environment\n * @component hide-when-quality\n */\nAFRAME.registerComponent(\"hide-when-quality\", {\n  schema: { type: \"string\", default: \"low\" },\n\n  init() {\n    this.onQualityChanged = this.onQualityChanged.bind(this);\n    this.el.sceneEl.addEventListener(\"quality-changed\", this.onQualityChanged);\n  },\n\n  onQualityChanged(event) {\n    this.updateComponentState(event.detail);\n  },\n\n  update(oldData) {\n    if (this.data !== oldData) {\n      this.updateComponentState(window.APP.quality);\n    }\n  },\n\n  updateComponentState(quality) {\n    this.el.setAttribute(\"visible\", quality !== this.data);\n  }\n});\n","AFRAME.registerComponent(\"point-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 },\n    range: { default: 0 },\n    decay: { default: 2 },\n    castShadow: { default: true },\n    shadowMapResolution: { default: [512, 512] },\n    shadowBias: { default: 0 },\n    shadowRadius: { default: 1 }\n  },\n\n  init() {\n    const el = this.el;\n    this.light = new THREE.PointLight();\n    this.light.shadow.camera.matrixAutoUpdate = true;\n    this.el.setObject3D(\"point-light\", this.light);\n    this.el.sceneEl.systems.light.registerLight(el);\n    this.rendererSystem = this.el.sceneEl.systems.renderer;\n  },\n\n  update(prevData) {\n    const light = this.light;\n\n    if (this.data.color !== prevData.color) {\n      const color = new THREE.Color(this.data.color);\n      this.rendererSystem.applyColorCorrection(color);\n      light.color.copy(color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      light.intensity = this.data.intensity;\n    }\n\n    if (this.data.range !== prevData.range) {\n      light.distance = this.data.range;\n    }\n\n    if (this.data.decay !== prevData.decay) {\n      light.decay = this.data.decay;\n    }\n\n    if (this.data.castShadow !== prevData.castShadow) {\n      light.castShadow = this.data.castShadow;\n    }\n\n    if (this.data.shadowBias !== prevData.shadowBias) {\n      light.shadow.bias = this.data.shadowBias;\n    }\n\n    if (this.data.shadowRadius !== prevData.shadowRadius) {\n      light.shadow.radius = this.data.shadowRadius;\n    }\n\n    const [width, height] = this.data.shadowMapResolution;\n    const [prevWidth, prevHeight] = prevData.shadowMapResolution ? prevData.shadowMapResolution : [512, 512];\n\n    if (width !== prevWidth || height !== prevHeight) {\n      light.shadow.mapSize.set(width, height);\n\n      if (light.shadow.map) {\n        light.shadow.map.dispose();\n        light.shadow.map = null;\n      }\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"point-light\");\n  }\n});\n","AFRAME.registerComponent(\"spot-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 },\n    range: { default: 0 },\n    decay: { default: 2 },\n    innerConeAngle: { default: 0 },\n    outerConeAngle: { default: Math.PI / 4.0 },\n    castShadow: { default: true },\n    shadowMapResolution: { default: [512, 512] },\n    shadowBias: { default: 0 },\n    shadowRadius: { default: 1 }\n  },\n\n  init() {\n    const el = this.el;\n    this.light = new THREE.SpotLight();\n    this.light.position.set(0, 0, 0);\n    this.light.target.position.set(0, 0, 1);\n    this.light.add(this.light.target);\n    this.light.matrixNeedsUpdate = true;\n    this.light.target.matrixNeedsUpdate = true;\n    this.el.setObject3D(\"spot-light\", this.light);\n    this.el.sceneEl.systems.light.registerLight(el);\n  },\n\n  update(prevData) {\n    const light = this.light;\n\n    if (this.data.color !== prevData.color) {\n      light.color.set(this.data.color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      light.intensity = this.data.intensity;\n    }\n\n    if (this.data.range !== prevData.range) {\n      light.distance = this.data.range;\n    }\n\n    if (this.data.decay !== prevData.decay) {\n      light.decay = this.data.decay;\n    }\n\n    if (this.data.innerConeAngle !== prevData.innerConeAngle || this.data.outerConeAngle !== prevData.outerConeAngle) {\n      light.angle = this.data.outerConeAngle;\n      light.penumbra = 1.0 - this.data.innerConeAngle / this.data.outerConeAngle;\n    }\n\n    if (this.data.castShadow !== prevData.castShadow) {\n      light.castShadow = this.data.castShadow;\n    }\n\n    if (this.data.shadowBias !== prevData.shadowBias) {\n      light.shadow.bias = this.data.shadowBias;\n    }\n\n    if (this.data.shadowRadius !== prevData.shadowRadius) {\n      light.shadow.radius = this.data.shadowRadius;\n    }\n\n    const [width, height] = this.data.shadowMapResolution;\n    const [prevWidth, prevHeight] = prevData.shadowMapResolution ? prevData.shadowMapResolution : [512, 512];\n\n    if (width !== prevWidth || height !== prevHeight) {\n      light.shadow.mapSize.set(width, height);\n\n      if (light.shadow.map) {\n        light.shadow.map.dispose();\n        light.shadow.map = null;\n      }\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"spot-light\");\n  }\n});\n","/* global AFRAME */\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\n\nAFRAME.registerComponent(\"floaty-object\", {\n  schema: {\n    // Make the object locked/kinematic upon load\n    autoLockOnLoad: { default: false },\n\n    // Make the object kinematic immediately upon release\n    autoLockOnRelease: { default: false },\n\n    // On release, modify the gravity based upon gravitySpeedLimit. If less than this, let the object float\n    // otherwise apply releaseGravity.\n    modifyGravityOnRelease: { default: false },\n\n    // Gravity to apply if object is thrown at a speed greated than speed limit.\n    releaseGravity: { default: -2 },\n\n    // If true, the degree to which angular rotation is allowed when floating is reduced (useful for 2d media)\n    reduceAngularFloat: { default: false },\n\n    // Velocity speed limit under which gravity will not be added if modifyGravityOnRelease is true\n    gravitySpeedLimit: { default: 1.85 } // Set to 0 to never apply gravity\n  },\n\n  init() {\n    this.onGrab = this.onGrab.bind(this);\n    this.onRelease = this.onRelease.bind(this);\n  },\n\n  tick() {\n    if (!this.ammoBody) {\n      this.ammoBody = this.el.components[\"ammo-body\"];\n    }\n\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const isHeld = interaction.isHeld(this.el);\n    if (isHeld && !this.wasHeld) {\n      this.onGrab();\n    }\n    if (this.wasHeld && !isHeld) {\n      this.onRelease();\n    }\n\n    if (!isHeld && this._makeStaticWhenAtRest) {\n      const isMine = this.el.components.networked && NAF.utils.isMine(this.el);\n      const linearThreshold = this.ammoBody.data.linearSleepingThreshold;\n      const angularThreshold = this.ammoBody.data.angularSleepingThreshold;\n      const isAtRest =\n        this.ammoBody.body.getLinearVelocity().length2() < linearThreshold * linearThreshold &&\n        this.ammoBody.body.getAngularVelocity().length2() < angularThreshold * angularThreshold;\n\n      if (isAtRest && isMine) {\n        this.el.setAttribute(\"ammo-body\", { type: \"static\" });\n      }\n\n      if (isAtRest || !isMine) {\n        this._makeStaticWhenAtRest = false;\n      }\n    }\n\n    this.wasHeld = isHeld;\n  },\n\n  play() {\n    // We do this in play instead of in init because otherwise NAF.utils.isMine fails\n    if (this.hasBeenHereBefore) return;\n    this.hasBeenHereBefore = true;\n    if (this.el.body) {\n      this._onBodyLoaded();\n    } else {\n      this._onBodyLoaded = this._onBodyLoaded.bind(this);\n      this.el.addEventListener(\"body-loaded\", this._onBodyLoaded, { once: true });\n    }\n  },\n\n  setLocked(locked) {\n    if (this.el.components.networked && !NAF.utils.isMine(this.el)) return;\n\n    this.locked = locked;\n    this.el.setAttribute(\"ammo-body\", { type: locked ? \"kinematic\" : \"dynamic\" });\n  },\n\n  _onBodyLoaded() {\n    if (this.data.autoLockOnLoad) {\n      this.setLocked(true);\n    }\n  },\n\n  onRelease() {\n    if (this.data.modifyGravityOnRelease) {\n      if (\n        this.data.gravitySpeedLimit === 0 ||\n        this.ammoBody.getVelocity().length2() < this.data.gravitySpeedLimit * this.data.gravitySpeedLimit\n      ) {\n        this.el.setAttribute(\"ammo-body\", {\n          gravity: { x: 0, y: 0, z: 0 },\n          angularDamping: this.data.reduceAngularFloat ? 0.98 : 0.5,\n          linearDamping: 0.95,\n          linearSleepingThreshold: 0.1,\n          angularSleepingThreshold: 0.1,\n          collisionFilterMask: COLLISION_LAYERS.HANDS\n        });\n\n        this._makeStaticWhenAtRest = true;\n      } else {\n        this.el.setAttribute(\"ammo-body\", {\n          gravity: { x: 0, y: this.data.releaseGravity, z: 0 },\n          angularDamping: 0.01,\n          linearDamping: 0.01,\n          linearSleepingThreshold: 1.6,\n          angularSleepingThreshold: 2.5,\n          collisionFilterMask: COLLISION_LAYERS.DEFAULT_INTERACTABLE\n        });\n      }\n    } else {\n      this.el.setAttribute(\"ammo-body\", { collisionFilterMask: COLLISION_LAYERS.DEFAULT_INTERACTABLE });\n    }\n\n    if (this.data.autoLockOnRelease) {\n      this.setLocked(true);\n    }\n  },\n\n  onGrab() {\n    this.el.setAttribute(\"ammo-body\", {\n      collisionFilterMask: COLLISION_LAYERS.HANDS\n    });\n    this.setLocked(false);\n  },\n\n  remove() {\n    this.el.removeEventListener(\"body-loaded\", this._onBodyLoaded);\n    if (this.stuckTo) {\n      const stuckTo = this.stuckTo;\n      delete this.stuckTo;\n      stuckTo._unstickObject();\n    }\n  }\n});\n","const sizeVec = new THREE.Vector3();\nconst boundingBoxWorldPositionVec = new THREE.Vector3();\nconst colliderWorldPositionVec = new THREE.Vector3();\n\nAFRAME.registerComponent(\"trigger-volume\", {\n  schema: {\n    colliders: { type: \"selectorAll\" },\n    size: { type: \"vec3\", default: { x: 1, y: 1, z: 1 } },\n    target: { type: \"selector\" },\n    enterComponent: { type: \"string\" },\n    enterProperty: { type: \"string\" },\n    enterValue: {\n      default: \"\",\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\n      stringify: JSON.stringify\n    },\n    leaveComponent: { type: \"string\" },\n    leaveProperty: { type: \"string\" },\n    leaveValue: {\n      default: \"\",\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\n      stringify: JSON.stringify\n    }\n  },\n  init() {\n    this.boundingBox = new THREE.Box3();\n    this.collidingLastFrame = {};\n  },\n  update() {\n    this.el.object3D.getWorldPosition(boundingBoxWorldPositionVec);\n    sizeVec.copy(this.data.size);\n    this.boundingBox.setFromCenterAndSize(boundingBoxWorldPositionVec, sizeVec);\n  },\n  tick() {\n    const colliders = this.data.colliders;\n\n    for (let i = 0; i < colliders.length; i++) {\n      const collider = colliders[i];\n      const object3D = collider.object3D;\n\n      object3D.getWorldPosition(colliderWorldPositionVec);\n      const isColliding = this.boundingBox.containsPoint(colliderWorldPositionVec);\n      const collidingLastFrame = this.collidingLastFrame[object3D.id];\n\n      if (isColliding && !collidingLastFrame) {\n        this.data.target.setAttribute(this.data.enterComponent, this.data.enterProperty, this.data.enterValue);\n      } else if (!isColliding && collidingLastFrame) {\n        this.data.target.setAttribute(this.data.leaveComponent, this.data.leaveProperty, this.data.leaveValue);\n      }\n\n      this.collidingLastFrame[object3D.id] = isColliding;\n    }\n  }\n});\n","// HACK: Setting videoPaused on media-video doesn't work if you are the owner.\n// This component gets around that by calling .togglePlaying() to play/pause the video based on a property change.\nAFRAME.registerComponent(\"video-pause-state\", {\n  schema: {\n    paused: { default: false }\n  },\n\n  init() {\n    this.onPauseStateChange = this.onPauseStateChange.bind(this);\n    this.videoComponent = this.el.components[\"media-video\"];\n\n    if (this.videoComponent) {\n      this.onVideoLoaded();\n    } else {\n      this.onVideoLoaded = this.onVideoLoaded.bind(this);\n      this.el.addEventListener(\"video-loaded\", this.onVideoLoaded);\n    }\n  },\n\n  onVideoLoaded() {\n    this.videoComponent = this.el.components[\"media-video\"];\n    this.video = this.videoComponent.video;\n    this.video.addEventListener(\"pause\", this.onPauseStateChange);\n  },\n\n  onPauseStateChange() {\n    this.el.setAttribute(\"paused\", this.video.paused);\n  },\n\n  update() {\n    if (this.video && this.data.paused !== this.video.paused) {\n      this.videoComponent.togglePlaying();\n    }\n  },\n\n  remove() {\n    this.video.removeEventListener(\"pause\", this.onPauseStateChange);\n    this.el.removeEventListener(\"video-loaded\", this.onVideoLoaded);\n  }\n});\n","/**\n * Logs all events dispatched on an entity\n * @namespace debug\n * @component log-events\n */\nAFRAME.registerComponent(\"log-events\", {\n  init: function() {\n    const el = this.el;\n    const log = this.log.bind(this);\n    const origDispatch = this.el.dispatchEvent;\n    this.el.dispatchEvent = function() {\n      log(Array.from(arguments));\n      return origDispatch.apply(el, arguments);\n    };\n  },\n  log: function([e]) {\n    if ([\"componentchanged\"].includes(e.type)) return;\n    let firstObject = true;\n    const replacer = (k, x) => {\n      if (!x) return x;\n      if (typeof x === \"object\" && x.length === undefined) {\n        if (firstObject) {\n          firstObject = false;\n          return x;\n        }\n        return \"[object]\";\n      }\n      return x;\n    };\n    console.info(`log-events: ${this.el.id} ${e.type} ${JSON.stringify(e.detail, replacer)}`);\n  }\n});\n\n/**\n * Logs all life cycle phases on an entity.\n * @namespace debug\n * @component lifecycle-checker\n */\nAFRAME.registerComponent(\"lifecycle-checker\", {\n  schema: {\n    name: { type: \"string\" },\n    tick: { default: false }\n  },\n  init: function() {\n    this.log(\"init\");\n  },\n  update: function() {\n    this.log(\"update\");\n  },\n  tick: function() {\n    if (this.data.tick) {\n      this.log(\"tick\");\n    }\n  },\n  remove: function() {\n    this.log(\"remove\");\n  },\n  pause: function() {\n    this.log(\"pause\");\n  },\n  play: function() {\n    this.log(\"play\");\n  },\n\n  log: function(method) {\n    console.info(`lifecycle-checker:${this.data.name} ${method}`);\n  }\n});\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nexport const ReactAudioContext = React.createContext({});\n\nexport const hudHoverSound = \"play_sound-hud_hover_start\";\n\nexport const WithHoverSound = ({ sound, children }) => {\n  return (\n    <ReactAudioContext.Consumer>\n      {context => {\n        return React.cloneElement(children, {\n          onMouseEnter: e => {\n            if (context && context.playSound) {\n              context.playSound(sound || hudHoverSound);\n            }\n            children.props.onMouseEnter && children.props.onMouseEnter(e);\n          }\n        });\n      }}\n    </ReactAudioContext.Consumer>\n  );\n};\n\nWithHoverSound.propTypes = {\n  children: PropTypes.object,\n  sound: PropTypes.string\n};\n","const { Pathfinding } = require(\"three-pathfinding\");\n\nAFRAME.registerSystem(\"nav\", {\n  init: function() {\n    this.pathfinder = new Pathfinding();\n  },\n\n  loadMesh: function(mesh, zone) {\n    this.el.object3D.updateMatrixWorld();\n\n    if (this.mesh && this.mesh.geometry && this.mesh.geometry.dispose) {\n      this.mesh.geometry.dispose();\n    }\n\n    this.mesh = mesh;\n    const geometry = new THREE.Geometry().fromBufferGeometry(mesh.geometry);\n    geometry.applyMatrix(mesh.matrixWorld);\n    this.pathfinder.setZoneData(zone, Pathfinding.createZone(geometry));\n    this.el.sceneEl.emit(\"nav-mesh-loaded\");\n  }\n});\n","/**\n * Listens to events from an event source and re-emits them on this entity\n * @component event-repeater\n */\nAFRAME.registerComponent(\"event-repeater\", {\n  schema: {\n    eventSource: { type: \"selector\" },\n    events: { type: \"array\" }\n  },\n\n  play: function() {\n    this.data.eventListeners = [];\n    const events = this.data.events;\n    for (let i = 0; i < events.length; i++) {\n      const event = events[i];\n      this.data.eventListeners[event] = this._handleEvent.bind(this, event);\n      this.data.eventSource.addEventListener(event, this.data.eventListeners[event]);\n    }\n  },\n\n  pause: function() {\n    const events = this.data.events;\n    for (let i = 0; i < events.length; i++) {\n      const event = events[i];\n      this.data.eventSource.removeEventListener(event, this.data.eventListeners[event]);\n    }\n    this.data.eventListeners = [];\n  },\n\n  _handleEvent: function(event, e) {\n    this.el.emit(event, e.detail);\n  }\n});\n","export function showHoverEffect(el) {\n  const isFrozen = el.sceneEl.is(\"frozen\");\n  const isPinned = el.components.pinnable && el.components.pinnable.data.pinned;\n  const isSpawner = !!el.components[\"super-spawner\"];\n  const canMove =\n    window.APP.hubChannel.can(\"spawn_and_move_media\") && (!isPinned || window.APP.hubChannel.can(\"pin_objects\"));\n  return (isSpawner || !isPinned || isFrozen) && canMove;\n}\n\nexport function canMove(entity) {\n  const isPinned = entity.components.pinnable && entity.components.pinnable.data.pinned;\n  const networkedTemplate = entity && entity.components.networked && entity.components.networked.data.template;\n  const isCamera = networkedTemplate === \"#interactable-camera\";\n  const isPen = networkedTemplate === \"#interactable-pen\";\n  return (\n    window.APP.hubChannel.can(\"spawn_and_move_media\") &&\n    (!isPinned || window.APP.hubChannel.can(\"pin_objects\")) &&\n    (!isCamera || window.APP.hubChannel.can(\"spawn_camera\")) &&\n    (!isPen || window.APP.hubChannel.can(\"spawn_drawing\"))\n  );\n}\n\nfunction indexForNonAuthorizedComponent(nonAuthorizedComponent, schema) {\n  const fullComponent = typeof nonAuthorizedComponent === \"string\";\n  const componentName = fullComponent ? nonAuthorizedComponent : nonAuthorizedComponent.component;\n\n  if (fullComponent) {\n    return schema.components.findIndex(schemaComponent => schemaComponent === componentName);\n  } else {\n    return schema.components.findIndex(\n      schemaComponent =>\n        schemaComponent.component === componentName && schemaComponent.property === nonAuthorizedComponent.property\n    );\n  }\n}\n\nlet nonAuthorizedSchemas = null;\nfunction initializeNonAuthorizedSchemas() {\n  /*\n  Takes the NAF schemas defined in network-schemas.js and produces a data structure of template name to non-authorized\n  component indices:\n  {\n    \"#interactable-media\": [\"4\", \"5\", \"6\"]\n  }\n  */\n  nonAuthorizedSchemas = {};\n  const { schemaDict } = NAF.schemas;\n  for (const template in schemaDict) {\n    if (!schemaDict.hasOwnProperty(template)) continue;\n    const schema = schemaDict[template];\n    nonAuthorizedSchemas[template] = (schema.nonAuthorizedComponents || [])\n      .map(nonAuthorizedComponent => indexForNonAuthorizedComponent(nonAuthorizedComponent, schema))\n      .map(index => index.toString());\n  }\n}\n\nfunction sanitizeMessageData(template, data) {\n  if (nonAuthorizedSchemas === null) {\n    initializeNonAuthorizedSchemas();\n  }\n  const nonAuthorizedIndices = nonAuthorizedSchemas[template];\n  for (const index in data.components) {\n    if (!data.components.hasOwnProperty(index)) continue;\n    if (!nonAuthorizedIndices.includes(index)) {\n      data.components[index] = null;\n    }\n  }\n  return data;\n}\n\nfunction authorizeEntityManipulation(entity, sender, senderPermissions) {\n  const { template, creator } = entity.components.networked.data;\n  const isPinned = entity.components.pinnable && entity.components.pinnable.data.pinned;\n  const isCreator = sender === creator;\n\n  if (template.endsWith(\"-avatar\")) {\n    return isCreator;\n  } else if (template.endsWith(\"-media\")) {\n    return (!isPinned || senderPermissions.pin_objects) && (isCreator || senderPermissions.spawn_and_move_media);\n  } else if (template.endsWith(\"-camera\")) {\n    return isCreator || senderPermissions.spawn_camera;\n  } else if (template.endsWith(\"-pen\")) {\n    return isCreator || senderPermissions.spawn_pen;\n  } else {\n    return false;\n  }\n}\n\nfunction authorizeOrSanitizeMessageData(data, sender, senderPermissions) {\n  const entity = NAF.entities.getEntity(data.networkId);\n  if (!entity) return false;\n\n  if (authorizeEntityManipulation(entity, sender, senderPermissions)) {\n    return true;\n  } else {\n    const { template } = entity.components.networked.data;\n    sanitizeMessageData(template, data);\n    return true;\n  }\n}\n\nconst emptyObject = {};\nexport function authorizeOrSanitizeMessage(message) {\n  const { dataType, from_session_id } = message;\n\n  if (dataType === \"u\" && message.data.isFirstSync && !message.data.persistent) {\n    // The server has already authorized first sync messages that result in an instantiation.\n    return message;\n  }\n\n  const senderPermissions = from_session_id\n    ? window.APP.hubChannel.presence.state[from_session_id].metas[0].permissions\n    : null;\n\n  if (dataType === \"um\") {\n    for (const index in message.data.d) {\n      if (!message.data.d.hasOwnProperty(index)) continue;\n      const authorizedOrSanitized = authorizeOrSanitizeMessageData(\n        message.data.d[index],\n        from_session_id,\n        senderPermissions\n      );\n      if (!authorizedOrSanitized) {\n        message.data.d[index] = emptyObject;\n      }\n    }\n    return message;\n  } else if (dataType === \"u\") {\n    const authorizedOrSanitized = authorizeOrSanitizeMessageData(message.data, from_session_id, senderPermissions);\n    if (authorizedOrSanitized) {\n      return message;\n    } else {\n      return emptyObject;\n    }\n  } else if (dataType === \"r\") {\n    const entity = NAF.entities.getEntity(message.data.networkId);\n    if (!entity) return emptyObject;\n    if (authorizeEntityManipulation(entity, from_session_id, senderPermissions)) {\n      return message;\n    } else {\n      return emptyObject;\n    }\n  } else {\n    // Fall through for other data types. Namely, \"drawing-<networkId>\" messages at the moment.\n    return message;\n  }\n}\n","export const createImageBitmap =\n  window.createImageBitmap ||\n  async function(data) {\n    return new Promise(resolve => {\n      // https://dev.to/nektro/createimagebitmap-polyfill-for-safari-and-edge-228\n      // https://gist.github.com/MonsieurV/fb640c29084c171b4444184858a91bc7\n\n      let srcUrl;\n      if (data instanceof Blob) {\n        srcUrl = URL.createObjectURL(data);\n      } else {\n        const canvas = document.createElement(\"canvas\");\n        const ctx = canvas.getContext(\"2d\");\n        canvas.width = data.width;\n        canvas.height = data.height;\n        ctx.putImageData(data, 0, 0);\n        srcUrl = canvas.toDataURL();\n      }\n      const img = document.createElement(\"img\");\n\n      img.addEventListener(\"load\", () => resolve(img));\n\n      img.src = srcUrl;\n    });\n  };\n\nexport function disposeImageBitmap(imageBitmap) {\n  if (imageBitmap instanceof HTMLImageElement && imageBitmap.src.startsWith(\"blob:\")) {\n    URL.revokeObjectURL(imageBitmap.src);\n  } else {\n    imageBitmap.close && imageBitmap.close();\n  }\n}\n"],"sourceRoot":""}