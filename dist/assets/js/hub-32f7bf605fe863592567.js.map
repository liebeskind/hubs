{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/utils/phoenix-utils.js","webpack:///./src/utils/resizeShadowCameraFrustum.js","webpack:///./src/components/directional-light.js","webpack:///./src/components/layers.js","webpack:///./src/components/loop-animation.js","webpack:///./src/components/media-loader.js","webpack:///./src/components/quack.js","webpack:///./src/components/scene-preview-camera.js","webpack:///./src/components/skybox.js","webpack:///./src/components/spawn-controller.js","webpack:///./src/components/super-spawner.js","webpack:///./src/components/water.js","webpack:///./src/components/particle-emitter.js","webpack:///./src/utils/component-mappings.js","webpack:///./src/gltf-component-mappings.js","webpack:///./src/assets/images/logo.svg","webpack:///./src/assets/images/giphy_logo.png","webpack:///./src/utils/history.js","webpack:///./src/assets/images/media-error.gif","webpack:///./src/assets/camera_tool.glb","webpack:///./src/assets/images/mic_granted.png","webpack:///./src/assets/images/mic_granted@2x.png","webpack:///./src/assets/images/mic_small.png","webpack:///./src/assets/images/mic_small@2x.png","webpack:///./src/assets/images/dropdown_arrow.png","webpack:///./src/assets/images/dropdown_arrow@2x.png","webpack:///./src/assets/images/add-owner.png","webpack:///./src/assets/images/remove-owner.png","webpack:///./src/assets/images/mobile_screen_entry.svg","webpack:///./src/assets/images/desktop_screen_entry.svg","webpack:///./src/assets/images/generic_vr_entry.svg","webpack:///./src/assets/sfx/tick.mp3","webpack:///./src/assets/images/gearvr_entry.svg","webpack:///./src/assets/images/daydream_entry.svg","webpack:///./src/assets/images/link_dialog_header.svg","webpack:///./src/assets/images/presence_phone.png","webpack:///./src/assets/images/presence_desktop.png","webpack:///./src/assets/images/presence_discord.png","webpack:///./src/assets/images/presence_camera.png","webpack:///./src/assets/images/presence_vr.png","webpack:///./src/assets/images/level_background.png","webpack:///./src/assets/images/level_background@2x.png","webpack:///./src/assets/images/level_fill.png","webpack:///./src/assets/images/level_fill@2x.png","webpack:///./src/assets/images/mic_level.png","webpack:///./src/assets/images/mic_level@2x.png","webpack:///./src/assets/images/level_action_background.png","webpack:///./src/assets/images/level_action_background@2x.png","webpack:///./src/assets/images/level_action_fill.png","webpack:///./src/assets/images/level_action_fill@2x.png","webpack:///./src/assets/images/speaker_level.png","webpack:///./src/assets/images/speaker_level@2x.png","webpack:///./src/assets/sfx/tone.webm","webpack:///./src/assets/sfx/tone.mp3","webpack:///./src/assets/sfx/tone.ogg","webpack:///./src/assets/sfx/tone.wav","webpack:///./src/assets/images/change_avatar.svg","webpack:///./src/utils/avatar-utils.js","webpack:///./src/systems/render-manager/unlit-batch.vert","webpack:///./src/systems/render-manager/unlit-batch.frag","webpack:///./src/assets/images/spritesheets/sprite-system-spritesheet.png","webpack:///./src/systems/sprites/sprite.vert","webpack:///./src/systems/sprites/sprite.frag","webpack:///./src/utils/media-url-utils.js","webpack:///./src/utils/fullscreen.js","webpack:///./src/materials/MobileStandardMaterial.js","webpack:///./src/storage/media-search-store.js","webpack:///./src/utils/async-utils.js","webpack:///./src/react-components/state-link.js","webpack:///./src/components/gltf-model-plus.js","webpack:///./src/utils/promisify-worker.js","webpack:///./src/utils/audio-context-fix.js","webpack:///./src/utils/threejs-positional-audio-updatematrixworld.js","webpack:///./src/components/bone-mute-state-indicator.js","webpack:///./src/components/bone-visibility.js","webpack:///./src/components/offset-relative-to.js","webpack:///./src/components/hud-controller.js","webpack:///./src/components/icon-button.js","webpack:///./src/components/text-button.js","webpack:///./src/components/block-button.js","webpack:///./src/components/mute-button.js","webpack:///./src/components/kick-button.js","webpack:///./src/components/close-vr-notice-button.js","webpack:///./src/components/leave-room-button.js","webpack:///./src/components/visible-if-permitted.js","webpack:///./src/components/visibility-on-content-type.js","webpack:///./src/components/hide-when-pinned-and-forbidden.js","webpack:///./src/components/networked-avatar.js","webpack:///./src/components/pinnable.js","webpack:///./src/components/drop-object-button.js","webpack:///./src/components/remove-networked-object-button.js","webpack:///./src/components/camera-focus-button.js","webpack:///./src/components/visible-to-owner.js","webpack:///./src/components/emit-state-change.js","webpack:///./src/components/action-to-event.js","webpack:///./src/components/action-to-remove.js","webpack:///./src/components/emit-scene-event-on-remove.js","webpack:///./src/components/follow-in-fov.js","webpack:///./src/components/matrix-auto-update.js","webpack:///./src/components/tweet-media-button.js","webpack:///./src/components/hover-menu.js","webpack:///./src/components/disable-frustum-culling.js","webpack:///./src/components/set-active-camera.js","webpack:///./src/components/track-pose.js","webpack:///./src/components/replay.js","webpack:///./src/components/visibility-by-path.js","webpack:///./src/components/tags.js","webpack:///./src/components/billboard.js","webpack:///./src/components/hoverable-visuals.js","webpack:///./src/systems/frame-scheduler.js","webpack:///./src/systems/app-mode.js","webpack:///./src/systems/permissions.js","webpack:///./src/systems/exit-on-blur.js","webpack:///./src/constants.js","webpack:///./src/components/owned-object-limiter.js","webpack:///./src/components/set-unowned-body-kinematic.js","webpack:///./src/components/networked-counter.js","webpack:///./src/components/set-yxz-order.js","webpack:///./src/components/nav-mesh-helper.js","webpack:///./src/components/tools/drawing-manager.js","webpack:///./src/systems/userinput/paths.js","webpack:///./src/components/environment-map.js","webpack:///./src/utils/media-highlight-frag.glsl","webpack:///./src/assets/images/cubemap/posx.jpg","webpack:///./src/assets/images/cubemap/negx.jpg","webpack:///./src/assets/images/cubemap/posy.jpg","webpack:///./src/assets/images/cubemap/negy.jpg","webpack:///./src/assets/images/cubemap/posz.jpg","webpack:///./src/assets/images/cubemap/negz.jpg","webpack:///./src/react-components/dialog-container.js","webpack:///./src/utils/disable-ios-zoom.js","webpack:///./src/App.js","webpack:///./src/utils/component-utils.js","webpack:///./src/components/mute-mic.js","webpack:///./src/components/toggle-flying.js","webpack:///./src/components/in-world-hud.js","webpack:///./src/components/virtual-gamepad-controls.js","webpack:///./src/components/ik-controller.js","webpack:///./src/components/hand-controls2.js","webpack:///./src/components/character-controller.js","webpack:///./src/components/hover-visuals.js","webpack:///./src/components/player-info.js","webpack:///./src/components/hand-poses.js","webpack:///./src/components/freeze-controller.js","webpack:///./src/components/visibility-while-frozen.js","webpack:///./src/components/stats-plus.js","webpack:///./src/components/media-views.js","webpack:///./src/components/avatar-volume-controls.js","webpack:///./src/components/pinch-to-move.js","webpack:///./src/components/pitch-yaw-rotator.js","webpack:///./src/components/position-at-box-shape-border.js","webpack:///./src/components/pin-networked-object-button.js","webpack:///./src/components/unmute-video-button.js","webpack:///./src/components/destroy-at-extreme-distances.js","webpack:///./src/components/camera-tool.js","webpack:///./src/components/clone-media-button.js","webpack:///./src/components/open-media-button.js","webpack:///./src/components/transform-object-button.js","webpack:///./src/components/teleporter.js","webpack:///./src/components/hubs-text.js","webpack:///./src/systems/userinput/sets.js","webpack:///./src/utils/vr-caps-detect.js","webpack:///./src/utils/share.js","webpack:///./src/react-components/state-route.js","webpack:///./src/react-components/promote-client-dialog.js","webpack:///./src/react-components/client-info-dialog.js","webpack:///./src/react-components/loader.js","webpack:///./src/react-components/auto-exit-warning.js","webpack:///./src/react-components/entry-buttons.js","webpack:///./src/react-components/profile-entry-panel.js","webpack:///./src/react-components/media-browser.js","webpack:///./src/react-components/create-object-dialog.js","webpack:///./src/react-components/change-scene-dialog.js","webpack:///./src/react-components/avatar-url-dialog.js","webpack:///./src/react-components/help-dialog.js","webpack:///./src/react-components/invite-dialog.js","webpack:///./src/react-components/invite-team-dialog.js","webpack:///./src/react-components/link-dialog.js","webpack:///./src/react-components/safari-dialog.js","webpack:///./src/react-components/safari-mic-dialog.js","webpack:///./src/react-components/room-settings-dialog.js","webpack:///./src/react-components/close-room-dialog.js","webpack:///./src/systems/tips.js","webpack:///./src/react-components/tip.js","webpack:///./src/react-components/webrtc-screenshare-unsupported-dialog.js","webpack:///./src/react-components/webassembly-unsupported-dialog.js","webpack:///./src/react-components/webvr-recommend-dialog.js","webpack:///./src/react-components/feedback-dialog.js","webpack:///./src/react-components/leave-room-dialog.js","webpack:///./src/react-components/room-info-dialog.js","webpack:///./src/react-components/oauth-dialog.js","webpack:///./src/react-components/tweet-dialog.js","webpack:///./src/react-components/lobby-chat-box.js","webpack:///./src/react-components/chat-command-help.js","webpack:///./src/utils/serialize-element.js","webpack:///./src/react-components/presence-list.js","webpack:///./src/react-components/chat-message.js","webpack:///./src/react-components/in-world-chat-box.js","webpack:///./src/react-components/avatar-editor.js","webpack:///./src/react-components/mic-level-widget.js","webpack:///./src/react-components/output-level-widget.js","webpack:///./src/react-components/photo-message.js","webpack:///./src/react-components/video-message.js","webpack:///./src/react-components/image-message.js","webpack:///./src/react-components/presence-log.js","webpack:///./src/react-components/settings-menu.js","webpack:///./src/react-components/preload-overlay.js","webpack:///./src/react-components/2d-hud.js","webpack:///./src/react-components/spectating-label.js","webpack:///./src/utils/vr-interstitial.js","webpack:///./src/react-components/ui-root.js","webpack:///./src/utils/hub-channel.js","webpack:///./src/utils/physics-utils.js","webpack:///./src/message-dispatch.js","webpack:///./src/scene-entry-manager.js","webpack:///./src/utils/pinned-entity-to-gltf.js","webpack:///./src/subscriptions.js","webpack:///./src/systems/personal-space-bubble.js","webpack:///./src/systems/camera-tools.js","webpack:///./src/systems/userinput/devices/mouse.js","webpack:///./src/systems/userinput/array-backed-set.js","webpack:///./src/systems/userinput/devices/keyboard.js","webpack:///./src/systems/userinput/devices/hud.js","webpack:///./src/systems/userinput/devices/xbox-controller.js","webpack:///./src/systems/userinput/pose.js","webpack:///./src/systems/userinput/arm-model.js","webpack:///./src/systems/userinput/devices/copy-sitting-to-standing-transform.js","webpack:///./src/systems/userinput/devices/oculus-go-controller.js","webpack:///./src/systems/userinput/devices/gear-vr-controller.js","webpack:///./src/systems/userinput/devices/oculus-touch-controller.js","webpack:///./src/systems/userinput/devices/daydream-controller.js","webpack:///./src/systems/userinput/devices/vive-controller.js","webpack:///./src/systems/userinput/devices/windows-mixed-reality-controller.js","webpack:///./src/systems/userinput/devices/gyro.js","webpack:///./src/systems/interactions.js","webpack:///./src/systems/userinput/devices/app-aware-mouse.js","webpack:///./src/systems/userinput/devices/touchscreen/assignments.js","webpack:///./src/systems/userinput/devices/app-aware-touchscreen.js","webpack:///./src/systems/userinput/bindings/xforms.js","webpack:///./src/utils/dpad.js","webpack:///./src/systems/userinput/bindings/utils.js","webpack:///./src/systems/userinput/bindings/keyboard-mouse-user.js","webpack:///./src/systems/userinput/bindings/touchscreen-user.js","webpack:///./src/systems/userinput/bindings/keyboard-debugging.js","webpack:///./src/systems/userinput/bindings/oculus-touch-user.js","webpack:///./src/systems/userinput/bindings/vive-user.js","webpack:///./src/systems/userinput/bindings/windows-mixed-reality-user.js","webpack:///./src/systems/userinput/bindings/xbox-controller-user.js","webpack:///./src/systems/userinput/bindings/daydream-user.js","webpack:///./src/systems/userinput/bindings/cardboard-user.js","webpack:///./src/systems/userinput/bindings/oculus-go-user.js","webpack:///./src/systems/userinput/resolve-action-sets.js","webpack:///./src/systems/userinput/devices/gamepad.js","webpack:///./src/systems/userinput/bindings/generic-gamepad.js","webpack:///./src/systems/userinput/userinput.js","webpack:///./src/systems/userinput/userinput-debug.js","webpack:///./src/systems/ui-hotkeys.js","webpack:///./src/systems/cursor-targetting-system.js","webpack:///./src/systems/constraints-system.js","webpack:///./src/systems/two-point-stretching-system.js","webpack:///./src/systems/button-systems.js","webpack:///./src/systems/hover-menu-system.js","webpack:///./src/systems/super-spawner-system.js","webpack:///./src/systems/haptic-feedback-system.js","webpack:///./src/systems/render-manager/hubs-batch-raw-uniform-group.js","webpack:///./src/systems/render-manager-system.js","webpack:///./src/systems/lobby-camera-system.js","webpack:///./src/systems/hubs-systems.js","webpack:///./src/systems/capture-system.js","webpack:///./src/systems/sprites.js","webpack:///./src/systems/post-physics.js","webpack:///./src/components/scalable-when-grabbed.js","webpack:///./src/components/cursor-controller.js","webpack:///./src/components/tools/pen.js","webpack:///./src/utils/sharedbuffergeometry.js","webpack:///./src/utils/sharedbuffergeometrymanager.js","webpack:///./src/components/tools/networked-drawing.js","webpack:///./src/network-schemas.js","webpack:///./src/hub.js","webpack:///./src/utils/concurrent-load-detector.js","webpack:///./src/utils/threejs-allocation-patches.js","webpack:///./src/systems/sound-effects-system.js","webpack:///./src/assets/images/warning_icon.png","webpack:///./src/assets/images/warning_icon@2x.png","webpack:///./src/react-components/avatar-preview.js","webpack:///./src/react-components/sign-in-dialog.js","webpack:///./src/assets/stylesheets/media-browser.scss","webpack:///./src/assets/stylesheets/sign-in-dialog.scss","webpack:///./src/assets/stylesheets/hub.scss","webpack:///./src/components/virtual-gamepad-controls.css","webpack:///./src/assets/stylesheets/ui-root.scss","webpack:///./src/assets/stylesheets/entry.scss","webpack:///./src/assets/stylesheets/invite-dialog.scss","webpack:///./src/loaders/HubsTextureLoader.js","webpack:///./src/utils/media-utils.js","webpack:///./src/assets/stylesheets/promote-client-dialog.scss","webpack:///./src/assets/stylesheets/client-info-dialog.scss","webpack:///./src/assets/stylesheets/loader.scss","webpack:///./src/assets/stylesheets/profile.scss","webpack:///./src/assets/stylesheets/avatar-preview.scss","webpack:///./src/assets/stylesheets/create-object-dialog.scss","webpack:///./src/assets/stylesheets/change-scene-dialog.scss","webpack:///./src/assets/stylesheets/avatar-url-dialog.scss","webpack:///./src/assets/stylesheets/link-dialog.scss","webpack:///./src/assets/stylesheets/room-settings-dialog.scss","webpack:///./src/assets/stylesheets/close-room-dialog.scss","webpack:///./src/assets/stylesheets/tip.scss","webpack:///./src/assets/stylesheets/feedback-dialog.scss","webpack:///./src/assets/stylesheets/leave-room-dialog.scss","webpack:///./src/assets/stylesheets/room-info-dialog.scss","webpack:///./src/assets/stylesheets/oauth-dialog.scss","webpack:///./src/assets/stylesheets/tweet-dialog.scss","webpack:///./src/assets/stylesheets/message-entry.scss","webpack:///./src/assets/stylesheets/chat-command-help.scss","webpack:///./src/assets/stylesheets/presence-log.scss","webpack:///./src/assets/stylesheets/presence-list.scss","webpack:///./src/assets/stylesheets/avatar-editor.scss","webpack:///./src/assets/stylesheets/settings-menu.scss","webpack:///./src/assets/stylesheets/preload-overlay.scss","webpack:///./src/assets/stylesheets/2d-hud.scss","webpack:///./src/assets/images/spritesheets/css-spritesheet.css","webpack:///./src/assets/stylesheets/spectating-label.scss","webpack:///./src/utils/qs_truthy.js","webpack:///./src/utils/scene-graph.js","webpack:///./src/utils/auto-box-collider.js","webpack:///./src/everyspace/helmet.js","webpack:///./src/everyspace/airtable.js","webpack:///./src/everyspace/messages.js","webpack:///./src/everyspace/customization.js","webpack:///./src/utils/i18n.js","webpack:///./src/utils/logging.js","webpack:///./src/components/audio-feedback.js","webpack:///./src/utils/auth-channel.js","webpack:///./src/utils/animation.js","webpack:///./src/utils/three-utils.js","webpack:///./src/utils/material-utils.js","webpack:///./src/utils/mask-email.js","webpack:///./src/react-components/media-tiles.js","webpack:///./src/utils/webgl.js","webpack:///./src/assets/LoadingObject_Atom.glb","webpack:///./src/assets/sfx/teleport-loop.mp3","webpack:///./src/assets/sfx/quickTurn.mp3","webpack:///./src/assets/sfx/tap_mellow.mp3","webpack:///./src/assets/sfx/PenSpawn.mp3","webpack:///./src/assets/sfx/PenDraw1.mp3","webpack:///./src/assets/sfx/PicSnapHey.mp3","webpack:///./src/assets/sfx/welcome.mp3","webpack:///./src/assets/sfx/quack.mp3","webpack:///./src/assets/sfx/specialquack.mp3","webpack:///./src/assets/sfx/pop.mp3","webpack:///./src/assets/sfx/Eb_blip.mp3","webpack:///./src/assets/sfx/tack.mp3","webpack:///./src/assets/sfx/A_bendUp.mp3","webpack:///./src/assets/sfx/suspense.mp3","webpack:///./src/assets/waternormals.jpg","webpack:///./src/utils/identity.js","webpack:///./src/storage/store.js","webpack:///./src/utils/crypto.js","webpack:///./src/utils/link-channel.js","webpack:///./src/utils/focus-utils.js","webpack:///./src/assets/images/mic_denied.png","webpack:///./src/assets/images/mic_denied@2x.png","webpack:///./src/object-types.js","webpack:///./src/assets/avatars/avatars.js","webpack:///./src/telemetry.js","webpack:///./src/utils/debug-log.js","webpack:///./src/utils/threejs-world-update.js","webpack:///./src/components/animation.js","webpack:///./src/components/ambient-light.js","webpack:///./src/components/animation-mixer.js","webpack:///./src/components/css-class.js","webpack:///./src/components/duck.js","webpack:///./src/components/heightfield.js","webpack:///./src/components/hemisphere-light.js","webpack:///./src/components/hide-when-quality.js","webpack:///./src/components/point-light.js","webpack:///./src/components/spot-light.js","webpack:///./src/components/floaty-object.js","webpack:///./src/components/trigger-volume.js","webpack:///./src/components/video-pause-state.js","webpack:///./src/components/debug.js","webpack:///./src/utils/image-bitmap-utils.js","webpack:///./src/systems/nav.js","webpack:///./src/components/event-repeater.js","webpack:///./src/react-components/wrap-with-audio.js","webpack:///./src/utils/next-tick.js","webpack:///./src/utils/permissions-utils.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","installedChunks","push","Object","prototype","hasOwnProperty","call","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","6","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","document","createElement","getReticulumFetchUrl","path","absolute","reticulumMeta","invalidatedReticulumMetaThisSession","invalidateReticulumMeta","_invalidateReticulumMeta","this","arguments","getReticulumMeta","_getReticulumMeta","querySelector","version","getAttribute","pool","phx_host","fetch","then","_ref2","_asyncToGenerator","res","json","_x6","phxHostOverride","URLSearchParams","location","search","connectToReticulum","_connectToReticulum","debug","params","qs","getNewSocketUrl","_ref3","socketProtocol","protocol","socketHost","socketPort","process","RETICULUM_SOCKET_SERVER","URL","port","socketUrl","console","log","socketSettings","logger","kind","msg","socket","Socket","connect","onError","endPointPath","endPoint","pathname","newEndPoint","getLandingPageForPhoto","photoUrl","parsedUrl","replace","fetchReticulumAuthenticated","url","method","payload","token","APP","store","state","credentials","retUrl","headers","content-type","authorization","body","JSON","stringify","_ref","text","parse","e","_x","createAndRedirectToNewHub","_x2","_x3","_x4","_x5","_createAndRedirectToNewHub","sceneId","sceneUrl","createUrl","assets","Name","SceneUrl","hub","getAirtableAssets","default_environment_gltf_bundle_url","Store","error","update","email","creatorAssignmentToken","creator_assignment_token","creatorAssignmentTokens","hubId","hub_id","embedToken","embed_token","embedTokens","host","getPresenceEntryForSession","presences","sessionId","presence","entries","find","k","metas","getPresenceContextForSession","context","getPresenceProfileForSession","profile","migrateChannelToSocket","oldChannel","channel","topic","bindings","item","on","event","callback","pushBuffer","timeout","oldJoinPush","joinPush","join","recHooks","receive","status","Promise","resolve","discordBridgesForPresences","channels","values","discordBridges","Array","map","b","boundingBox","THREE","Box3","frustumBox","inverseLightMatrixWorld","Matrix4","tempBox","FRUSTUM_PADDING","NEAR_CLIPPING_PLANE","FAR_CLIPPING_PLANE","verts","Vector3","AFRAME","registerComponent","schema","color","type","intensity","default","castShadow","shadowMapResolution","shadowBias","shadowRadius","init","el","light","DirectionalLight","position","set","target","add","setObject3D","sceneEl","systems","registerLight","rendererSystem","renderer","prevData","Color","applyColorCorrection","copy","shadow","bias","radius","width","height","prevWidth","prevHeight","mapSize","dispose","camera","matrixNeedsUpdate","tick","quality","scene","makeEmpty","traverse","node","geometry","computeBoundingBox","applyMatrix4","matrixWorld","union","min","max","x","y","z","getInverse","expandByPoint","left","right","bottom","top","near","far","updateProjectionMatrix","resizeShadowCameraFrustum","object3D","remove","removeObject3D","Layers","reflection","inWorldHud","exclusive","addEventListener","oldData","obj","layers","mask","layer","oldValue","newValue","enable","disable","removeEventListener","paused","clip","mixerEl","findAncestorWithComponent","updateClip","warn","currentAction","mixer","animations","components","clipName","action","clipAction","enabled","setLoop","LoopRepeat","Infinity","play","destroy","stop","SHAPE","require","loadingObjectEnvMap","loadingObject","GLTFLoader","load","loadingObjectSrc","gltf","batchMeshes","qsTruthy","disableBatching","fileId","fileIsOwned","src","resize","contentType","contentSubtype","animate","mediaOptions","v","showLoader","clearLoadingTimeout","onMediaLoaded","animating","NAF","utils","getNetworkedEntity","networkedEl","updateScale","center","mesh","getObject3D","box","getBox","scaleCoefficient","getScaleCoefficient","scale","multiplyScalar","addVectors","sub","removeShape","id","removeAttribute","dt","loaderMixer","loadingSoundNode","soundEffectsSystem","stopSoundNode","setAttribute","object3DMap","useFancyLoader","clone","Mesh","BoxGeometry","MeshBasicMaterial","environmentMapComponent","currentEnivronmentMap","environmentMap","applyEnvironmentMap","AnimationMixer","loadingClip","loadingScaleClip","AnimationClip","VectorKeyframeTrack","setTimeout","BOX","is","isMine","playSoundLooped","SOUND_MEDIA_LOADING","showLoaderTimeout","clearTimeout","updateHoverableVisuals","hoverableVisuals","injectedCustomShaderChunks","uniforms","injectCustomShaderChunks","setFromObject","getBoundingSphere","boundingSphere","physicsShape","shouldUpdateScale","playSoundOneShot","SOUND_MEDIA_LOADED","finish","minHalfExtent","pager","repositionToolbar","addMeshScaleAnimation","initialScale","onComplete","step","lastValue","anim","animatables","Math","Number","MIN_VALUE","config","duration","easing","elasticity","loop","round","targets","complete","anime","_this","thumbnail","canonicalUrl","accessibleUrl","resolveUrl","origin","startsWith","meta","expected_content_type","proxiedUrlFor","guessContentType","fetchContentType","emit","raw","material","isHLS","qsTime","parseInt","searchParams","startTime","hash","substring","reduceAngularFloat","releaseGravity","detail","projection","once","assign","time","dirs","template","batch","includes","HULL","addAnimationComponents","inflate","modelToWorldScale","Error","mayChangeScene","permissions","can","isHubsAvatarUrl","isHubsRoomUrl","isHubsSceneUrl","index","_this2","toolbar","imageSrc","onNext","onPrev","_ensureUI","_this3","hasSetupUI","maxIndex","fetchMaxContentIndex","getElementById","appendChild","importNode","content","nextButton","prevButton","pageLabel","_this4","pageSrc","parentNode","removeChild","takeOwnership","quackPercentage","specialQuackPercentage","_handleGrabStart","pause","rand","random","SOUND_SPECIAL_QUACK","SOUND_QUACK","lerp","start","end","newRot","Quaternion","positionOnly","startPoint","startRotation","quaternion","targetPoint","targetRotDelta","Euler","targetRotation","setFromEuler","premultiply","performance","now","backwards","ranOnePass","tick2","streamerCamera","streamer","getCurrentStreamer","getStreamerCamera","setMatrixWorld","translateZ","from","to","fromRot","toRot","slerp","rotation","setFromQuaternion","isBotMode","Sky","shader","SkyShader","ShaderMaterial","fragmentShader","vertexShader","UniformsUtils","side","BackSide","BoxBufferGeometry","constructor","luminance","turbidity","rayleigh","mieCoefficient","mieDirectionalG","sunPosition","inclination","azimuth","distance","sky","skyScene","Scene","cubeCamera","CubeCamera","updateEnvironmentMap","requestAnimationFrame","theta","PI","phi","cos","sin","normalize","vrEnabled","vr","pmremGenerator","PMREMGenerator","renderTarget","texture","pmremCubeUVPacker","PMREMCubeUVPacker","cubeLods","CubeUVRenderTarget","playerHeight","loadedEvent","moveToSpawnPoint","spawnPoints","querySelectorAll","spawnPoint","getLastWorldPosition","visible","COLLISION_LAYERS","useCustomSpawnPosition","spawnPosition","useCustomSpawnRotation","spawnRotation","useCustomSpawnScale","spawnScale","spawnCooldown","centerSpawnedObject","spawnEvent","animateFromCursor","cooldownTimeout","handPosition","onSpawnEvent","tempSpawnHandPosition","classList","entity","addMedia","ObjectContentOrigins","SPAWNER","cursor","getWorldPosition","getWorldQuaternion","userinput","scenes","interaction","willAnimateFromCursor","paths","actions","rightHand","matrix","rightRemote","held","spawning","activateCooldown","waitForEvent","delay","dur","syncToPhysics","sx","sy","sz","collisionFilterMask","NONE","DEFAULT_SPAWNER","MobileWater","options","undefined","normalSampler","waterNormals","sunDirection","sunColor","waterColor","eye","distortionScale","FrontSide","fog","mirrorShader","merge","UniformsLib","size","ShaderChunk","transparent","lights","reject","TextureLoader","wrapS","wrapT","RepeatWrapping","needsUpdate","Water","speed","forceMobile","waterMesh","waterGeometry","loadWaterNormals","waterNormalMap","waterConfig","textureWidth","textureHeight","device","isMobile","isMobileVR","water","mirrorCamera","setStyle","startColor","middleColor","endColor","startOpacity","middleOpacity","endOpacity","colorCurve","sizeCurve","startSize","endSize","sizeRandomness","ageRandomness","lifetime","lifetimeRandomness","particleCount","startVelocity","endVelocity","velocityCurve","angularVelocity","particleEmitter","ParticleEmitter","updateParticles","setTexture","Texture","textureLoader","loadTextureAsync","catch","getSanitizedComponentMapping","inputComponent","inputProperty","publicComponents","publicComponent","publicProperty","publicProperties","mappedComponent","mappedProperty","getMappedValue","PHYSICS_CONSTANTS","TYPE","FIT","decayMigration","componentName","componentData","range","decay","mediaInflator","isControlled","networked","hasVolume","templateName","controls","isHubsDestinationUrl","href","owner","persistent","networkId","videoPaused","autoPlay","volume","audioType","hidePlaybackControls","distanceModel","rolloffFactor","refDistance","maxDistance","coneInnerAngle","coneOuterAngle","coneOuterGain","GLTFModelPlus","isHandCollisionTarget","cursorController","mass","STATIC","collisionFilterGroup","INTERACTABLES","euler","orientation","fit","MANUAL","offset","halfExtents","_componentName","nav","zone","found","isMesh","loadMesh","pageIndex","video","loop-animation","indexToEntityMap","enterComponent","enterProperty","enterValue","leaveComponent","leaveProperty","leaveValue","enterComponentMapping","leaveComponentMapping","targetEntity","message","colliders","HEIGHTFIELD","margin","heightfieldDistance","heightfieldData","MESH","ALL","includeInvisible","pushOrUpdateHistory","history","newPathname","newSearch","newLength","__historyLength","_objectSpread","__duplicate","isDuplicate","pushHistoryState","replaceHistoryState","pushHistoryPath","clearHistoryState","popToBeginningOfHubHistory","navigateToPriorPage","len","unsubscribe","listen","go","sluglessPath","split","withSlug","AVATAR_TYPES","LEGACY","SKINNABLE","legacyAvatarIds","avatars","a","getAvatarType","avatarId","indexOf","resp","fetchAvatar","_fetchAvatar","avatar_id","gltf_url","avatar","model","fetchSkinnableAvatar","getAvatarSrc","fetchAvatarGltfUrl","getAvatarThumbnailUrl","_getAvatarThumbnailUrl","files","__webpack_exports__","scaledThumbnailUrlFor","getCustomGLTFParserURLResolver","nonCorsProxyDomains","CORS_PROXY_SERVER","commonKnownContentTypes","glb","png","jpg","jpeg","pdf","mp4","mp3","farsparkEncodeUrl","str","btoa","encodeURIComponent","_","p1","String","fromCharCode","b64EncodeUnicode","farsparkUrl","urlHostname","hostname","hasIndex","domain","endsWith","gltfUrl","test","corsProxyPrefix","originalUrlParts","decodeURIComponent","dataUrlRegex","matches","match","extension","pop","hubsSceneRegex","hubsAvatarRegex","hubsRoomRegex","willRequireUserGesture","showFullScreenIfAvailable","showFullScreenIfWasFullScreen","screenfull__WEBPACK_IMPORTED_MODULE_0__","screenfull__WEBPACK_IMPORTED_MODULE_0___default","hasEnteredFullScreenThisSession","shouldShowFullScreen","isIOS","screenfull","isFullscreen","request","VERTEX_SHADER","FRAGMENT_SHADER","MobileStandardMaterial","[object Object]","args","super","_defineProperty","parameters","uvTransform","Matrix3","diffuse","opacity","aoMapIntensity","aoMap","emissive","emissiveMap","alphaTest","skinning","morphTargets","vertexColors","mobileMaterial","fromStandardMaterial","SOURCES","EMPTY_RESULT","URL_SOURCE_TO_TO_API_SOURCE","images","videos","youtube","gifs","sketchfab","poly","twitch","favorites","MEDIA_SOURCE_DEFAULT_FILTERS","SEARCH_CONTEXT_PARAMS","MediaSearchStore","EventTarget","dispatchEvent","CustomEvent","urlSource","getUrlMediaSource","previousSource","urlParams","requestIndex","currentRequestIndex","locationSearchParams","isMy","param","source","navigator","languages","singular","credentialsAccountId","toString","lastSavedUrl","isFetching","nextCursor","next_cursor","lastFetchedUrl","legacyAvatar","preview","gltfs","delta","goBack","filter","query","delete","keepSource","keepNav","_stashedParams","_stashedSource","q","_sourceNavigate","hideNav","useLastStashedParams","currentQuery","getSearchClearedSearchParams","useValue","hasAccountWithAvatars","_hasAccountWithAvatars","stashLastSearchParams","_stashLastSearchParams","hasMediaPath","setHistory","_update","waitForDOMContentLoaded","eventName","eventObj","readyState","StateLink","React","Component","handleClick","props","onClick","defaultPrevented","button","metaKey","altKey","ctrlKey","shiftKey","isModifiedEvent","preventDefault","stateKey","stateValue","stateDetail","render","innerRef","className","children","react__WEBPACK_IMPORTED_MODULE_0___default","ref","PropTypes","bool","string","func","raycast","acceleratedRaycast","gltfCache","Map","cache","count","retain","has","cacheItem","release","disposeNode","inflightGltfs","extractZipFile","promisifyWorker","SketchfabZipWorker","defaultInflator","multiple","isArray","cloneSkinnedMesh","cloneLookup","parallelTraverse","sourceNode","clonedNode","boundsTree","sourceMesh","isSkinnedMesh","sourceBones","skeleton","bones","clonedMesh","sourceBone","bindMatrix","cloneGltf","getHubsComponents","hubsComponents","userData","gltfExtensions","MOZ_hubs_components","HUBS_components","legacyComponents","componentKey","inflator","inflateEntities","templates","isRoot","childEntities","child","entityComponents","append","uuid","order","matrixAutoUpdate","identity","decompose","toLowerCase","parent","gltfIndex","attachTemplate","root","templateRoot","targetEls","cloneNode","attributes","loadGLTF","_loadGLTF","preferredTechnique","onProgress","jsonPreprocessor","fileMap","loadingManager","LoadingManager","setURLModifier","gltfLoader","parser","createParser","extensions","oldHeightfieldNode","nodes","heightfield","runMigration","materials","MOZ_alt_materials","altMaterialIndex","extras","Object3D","DefaultMatrixAutoUpdate","mapMaterials","isMeshStandardMaterial","keys","forEach","revokeObjectURL","useCache","loadTemplates","applySrc","batchManagerSystem","removeObject","templateEl","firstElementChild","loadModel","technique","promise","charAt","assetEl","lastSrc","inflatedEl","disposeLastInflatedEl","addObject","initMixer","hasBufferGeometry","isBufferGeometry","hasBoundsTree","geo","triCount","MeshBVH","strategy","maxDepth","object3DToSet","nextTick","inflatedEntity","prop","inflateComponents","rewires","f","format","worker","nextItemId","outstanding","onmessage","err","handlers","transfer","postMessage","ctx","AudioContext","getContext","resume","PositionalAudio","updateMatrixWorld","force","setInitial","_lastPosition","_lastOrientation","_lastListenerPosition","panner","listener","applyQuaternion","abs","EPSILON","positionX","positionY","positionZ","setPosition","setOrientation","unmutedBoneName","mutedBoneName","onPos","offPos","onStateToggled","unmutedBone","getObjectByName","mutedBone","modelLoaded","updateMuteState","muted","lastVisible","updateMatrices","selfDestruct","updateOffset","QUARTER_CIRCLE","offsetVector","localToWorld","worldToLocal","rotateOnAxis","TWOPI","head","lookCutoff","animRange","yawCutoff","onChildHovered","removeHoverEvents","isYLocked","lockedHeadPositionY","lookDir","lookEuler","hoverableChildren","hud","pitch","RAD2DEG","yawDif","deltaAngle","forceHudVisible","activity","hasHoveredInWorldHud","clamp","hudLocked","hudOutOfView","DEG2RAD","image","hoverImage","activeImage","activeHoverImage","disabledImage","active","disabled","tooltip","tooltipText","activeTooltipText","onHover","hovering","updateButtonState","onHoverOut","sprite","textHoverColor","textColor","backgroundHoverColor","backgroundColor","textEl","noop","dependencies","block","clientId","hubChannel","hide","mute","kick","updateVisibility","canOrWillIfCreator","mediaLoader","mediaImage","mediaVideo","currentContentType","matchesType","matchesSubtype","whenPinned","_updateUI","_updateUIOnStateChange","targetEl","isPinned","pinnable","pinned","pinnedAndForbidden","left_hand_pose","right_hand_pose","_fireEventsAndAnimate","pinStateChanged","currentScale","isHeld","leftHand","wasHeld","modifyGravityOnRelease","gravity","angularDamping","linearDamping","linearSleepingThreshold","angularSleepingThreshold","DEFAULT_INTERACTABLE","activate","track","selector","cameraSystem","myCamera","getMyCamera","focus","isVisible","shouldBeVisible","onStateChange","newOwner","transform","oneof","stateadded","stateremoved","withPermission","needsPermission","updatePermissions","hasPermission","onPermissionsUpdated","requireOwnership","angle","targetPos","snappedRot","snappedQ","snappedXForm","snappedXFormWorld","tempVector","_applyMaskedTargetRotation","started","compose","multiplyMatrices","_updateMatrixAutoUpdate","dim","onFrozenStateChange","getHoverMenu","applyHoverState","menuPromise","menu","allowed","setScalar","frustumCulled","currentActiveCamera","activeCameraEl","setActiveCamera","canvas","matrixIsModified","playhead","poseIndex","overflow","poses","timestamp","isHoldable","offersHandConstraint","offersRemoteConstraint","singleActionButton","holdableButton","isPen","isHoverMenuChild","didUpdateOnce","_updateBillboard","_updateIsInView","schedule","unschedule","isInView","frustum","Frustum","frustumMatrix","boxTemp","expandBox","playerCamera","screenCamera","projectionMatrix","matrixWorldInverse","setFromMatrix","intersectsBox","isInViewOfCamera","setFromMatrixPosition","lookAt","validMaterials","_utils_material_utils__WEBPACK_IMPORTED_MODULE_0__","_utils_permissions_utils__WEBPACK_IMPORTED_MODULE_1__","interactorOneTransform","interactorTwoTransform","enableSweepingEffect","Sphere","sweepParams","forEachMaterial","contains","meshToEl","isFrozen","showEffect","showHoverEffect","interactorOne","interactorTwo","hovered","toArray","worldY","elements","scaledRadius","uniform","hubs_EnableSweepingEffect","hubs_IsFrozen","hubs_SweepParams","hubs_HighlightInteractorOne","hubs_InteractorOnePos","hubs_HighlightInteractorTwo","hubs_InteractorTwoPos","hubs_Time","registerSystem","registry","queues","frameIndex","queue","idx","invert","updateComponentState","inVRMode","class","handler","permissionName","fetchPermissions","onBlur","onFocus","onTimeout","onEnterVR","isOculusBrowser","userAgent","enteredVR","lastTimeoutCheck","exitTimeout","ENVIRONMENT","AVATAR","HANDS","UNOWNED_INTERACTABLE","counter","_syncCounterRegistration","timestamps","deregister","register","setBodyKinematic","didThisOnce","locked","clear","_destroyOldest","oldestEl","minTs","MAX_VALUE","ts","_destroy","teleporters","queryCollisionEntities","_onComponentInitialized","drawingToPen","drawingEl","drawing","createDrawing","getDrawing","pen","returnDrawing","toggleScreenShare","snapRotateLeft","snapRotateRight","logDebugFrame","logInteractionState","cameraDelta","lobbyCameraDelta","characterAcceleration","boost","startGazeTeleport","stopGazeTeleport","spawnPen","ensureFrozen","toggleFreeze","thaw","muteMic","toggleFlying","focusChat","focusChatCommand","toggleCamera","takeSnapshot","mediaExit","mediaSearch1","mediaSearch2","mediaSearch3","mediaSearch4","mediaSearch5","mediaSearch6","mediaSearch7","mediaSearch8","transformModifier","rayObjectRotation","pose","hideLine","grab","drop","modDelta","startDrawing","stopDrawing","undoDrawing","penNextColor","penPrevColor","scalePenTip","scaleGrabbedGrabbable","mediaVolumeMod","switchDrawMode","startTeleport","stopTeleport","thumb","middleRingPinky","exitMirror","haptics","actuators","mouse","coords","movementXY","buttonLeft","buttonRight","wheel","smartMouse","cursorPose","touchscreen","touchCameraDelta","gyroCameraDelta","pinch","initialDistance","currentDistance","isTouching","isTouchingGrabbable","tap1","tap2","tap3","tap4","tap5","gyro","averageDeltaX","averageDeltaY","penButton","keyboard","gamepad","gamepadIndex","buttonIndex","pressed","touched","axis","axisIndex","xbox","buttonName","axisName","axesSum","oculusgo","trigger","touchpad","axisX","axisY","gearVRController","daydream","rightOculusTouch","leftOculusTouch","axes","wmrController","wmr","grip","joystick","vive","createDefaultEnvironmentMap","_createDefaultEnvironmentMap","urls","cubeMapPosX","cubeMapNegX","cubeMapPosY","cubeMapNegY","cubeMapPosZ","cubeMapNegZ","CubeTextureLoader","RGBFormat","envMap","DialogContainer","closable","currentTarget","onClose","onKeyDown","onContainerClicked","componentDidMount","componentWillUnmount","classNames","wide","allowOverflow","additionalClass","_wrap_with_audio__WEBPACK_IMPORTED_MODULE_3__","_fortawesome_react_fontawesome__WEBPACK_IMPORTED_MODULE_5__","icon","faTimes","title","isRequired","disableiOSZoom","detect_browser__WEBPACK_IMPORTED_MODULE_0__","detectOS","lastTouchAtMs","ev","Date","getTime","isDoubleTouch","App","_storage_store__WEBPACK_IMPORTED_MODULE_0__","_storage_media_search_store__WEBPACK_IMPORTED_MODULE_1__","mediaSearchStore","setQuality","registerComponentInstance","component","componentRegistry","deregisterComponentInstance","playerInfos","playerInfo","playerSessionId","streaming","bindAllEvents","events","unbindAllEvents","eventSrc","toggleEvents","muteEvents","unmuteEvents","onToggle","onMute","onUnmute","connection","adapter","SOUND_TOGGLE_MIC","enableMicrophone","removeState","addState","mic","spawn","cameraBtn","inviteBtn","background","flyBtn","updateButtonStates","evt","onMicClick","onSpawnClick","onPenClick","SOUND_SPAWN_PEN","onCameraClick","onFlyClick","playerRig","fly","onInviteClick","onEnterVr","onExitVr","onFirstInteraction","onMoveJoystickChanged","onMoveJoystickEnd","onLookJoystickChanged","onLookJoystickEnd","mockJoystickContainer","styles","leftMock","mockJoystick","leftMockSmall","inner","rightMock","rightMockSmall","leftTouchZone","touchZone","leftStick","nipplejs","fadeTime","rightTouchZone","rightStick","inVr","moving","rotating","moveEvent","rotateYEvent","rotateXEvent","off","radian","style","display","leftController","rightController","LEGACY_HAND_ROTATIONS","makeRotationFromEuler","HAND_ROTATIONS","leftEye","rightEye","neck","chest","hips","rotationSpeed","alwaysUpdate","_runScheduledWork","flipY","makeRotationY","cameraForward","headTransform","hipsPosition","invHipsToHeadVector","middleEyeMatrix","middleEyePosition","invMiddleEyeToHead","cameraYRotation","cameraYQuaternion","invHipsQuaternion","headQuaternion","rootToChest","invRootToChest","ikRoot","findIKRoot","hasConvergedHips","lastCameraTransform","divideScalar","makeTranslation","negate","updateMatrix","hasNewCameraTransform","equals","forceIkUpdate","setFromRotationMatrix","epsilon","u","w","inverse","handRotations","avatarType","updateHand","handRotation","handObject3D","controllerObject3D","isLeft","handMatrix","spaceInvader","handHiddenByPersonalSpace","invading","multiply","cameraWorld","pos","containsPoint","POSES","poseForFingers","hand","subpath","previous","current","groundAcc","pivot","snapRotationDegrees","navGroup","navNode","velocity","accelerationInput","pendingSnapRotationMatrix","_withinWarningLimit","_warningCount","setAccelerationInput","setAngularVelocity","leftRotationMatrix","rightRotationMatrix","reset","SOUND_SNAP_ROTATE","teleportTo","rig","deltaFromHeadToTargetForHead","targetForHead","targetForRig","targetWorldPosition","pathfinder","getGroup","_setNavNode","clampStep","move","trans","transInv","pivotPos","rotationAxis","yawMatrix","rotationMatrix","rotationInvMatrix","pivotRotationMatrix","pivotRotationInvMatrix","startPos","startScale","deltaSeconds","userinputAngularVelocity","rotationDelta","acc","makeRotationAxis","updateVelocity","lengthSq","setPositionOnNavMesh","_warnWithWarningLimit","getClosestNode","zones","dvx","dvz","handleLeftVisuals","handleRightVisuals","hadLeftVisualLastFrame","hadRightVisualLastFrame","interactingElement","hideVisual","ensureAvatarNodes","some","originalRoot","scale-audio-feedback","avatarSrc","displayName","communityIdentifier","isOwner","isRecording","applyProperties","updateDisplayName","applyDisplayName","handleModelError","isLocalPlayerInfo","networkedEntity","getCreator","playerPresence","updateDisplayNameFromPresenceMeta","presenceMeta","recording","roles","nametagEl","communityIdentifierEl","headEl","recordingBadgeEl","modBadgeEl","modelEl","resetToRandomLegacyAvatar","open","thumbDown","indexDown","mrpDown","thumbUp","point","fist","NETWORK_POSES","animatePose","suffix","networkField","getNetworkedAvatar","networkedAvatar","parentEl","prev","curr","fadeOut","fadeIn","setHandPose","toggleEvent","hasFoundFreeze","frozen","SOUND_FREEZE","SOUND_THAW","withinDistance","requireHoverOnNonMobile","camWorldPos","objWorldPos","cam","hoverableSearch","hoverable","shouldNotBeVisible","isWithinDistance","distanceToSquared","isTransforming","transforming","toggle","onExpand","onCollapse","stats","threeStats","aframeStats","plugins","rStats","css","fps","caption","below","batchdraws","batchinstances","batchatlassize","groups","createStats","statsEl","statsHeaderEl","statsTitleEl","innerHTML","collapseEl","insertBefore","firstChild","fpsEl","lastFpsUpdate","lastFps","frameCount","inVR","vrStatsEnabled","initVRStats","lastUpdate","vrPanel","whiteSpace","baseline","depthTest","toggleVRStats","physics","addComponent","removeComponent","beforeStep","afterStep","frame","batchingEnabled","batchManager","batches","instanceCount","atlas","arrayDepth","toFixed","info","calls","triangles","show","ONCE_TRUE","TYPE_IMG_PNG","parseGIF","GIFWorker","VOLUME_LABELS","GIFTexture","frames","delays","disposals","_ctx","generateMipmaps","isVideoTexture","minFilter","NearestFilter","frameStartTime","clearRect","drawImage","arrayBuffer","rawImageData","delayTimes","loadCnt","img","Image","onload","encoding","sRGBEncoding","LinearFilter","videoEl","autoplay","preload","crossOrigin","createVideoTexture","createVideoEl","VideoTexture","streamClientId","stream","getMediaStream","srcObject","MediaStream","getVideoTracks","HLS","isSupported","baseUrl","hls","xhrSetup","xhr","buildAbsoluteURL","loadSource","attachMedia","Events","ERROR","fatal","ErrorTypes","NETWORK_ERROR","startLoad","MEDIA_ERROR","recoverMediaError","canPlayType","onerror","hasResolved","resolveOnce","poll","videoHeight","videoWidth","scaleToAspectRatio","ratio","disposeTexture","HTMLVideoElement","textureCache","inflightTextures","errorImage","errorImageSrc","errorTexture","magFilter","errorCacheItem","timeFmt","floor","h","tickRate","syncTolerance","onPauseStateChange","tryUpdateVideoPlaybackState","updateSrc","seekForward","seekBack","volumeUp","volumeDown","snap","changeVolumeBy","togglePlaying","videoMutedAt","localSnapCount","isSnapping","onSnapImageLoaded","hoverMenu","playbackControls","playPauseButton","volumeUpButton","volumeDownButton","seekForwardButton","seekBackButton","snapButton","timeLabel","volumeLabel","updateVolumeLabel","updateHoverMenuBasedOnLiveState","updatePlaybackState","applyPersistentFirstSync","getNetworkOwner","audioListener","AudioListener","cameraEl","videoIsLive","currentTime","SOUND_CAMERA_TOOL_TOOK_SNAPSHOT","blob","toBlob","file","File","addAndArrangeMedia","_ignorePauseStateChanges","audio","gain","_playbackStateChangeTimeout","cleanUp","audioSource","createMediaElementSource","setDistanceModel","setRolloffFactor","setRefDistance","setMaxDistance","Audio","setNodeSource","updateLiveState","levels","currentLevel","details","live","LEVEL_SWITCHED","SphereBufferGeometry","PlaneBufferGeometry","DoubleSide","volumeMod","disconnect","_hasRetainedTexture","currentSrcIsRetained","createGIFTexture","createImageTexture","sound","pinchDelta","degToRad","radToDeg","minPitch","maxPitch","yaw","onRotateX","pendingXRotation","look","deltaPitch","deltaYaw","lookX","lookY","HALF_PI","THREE_HALF_PI","forward","back","zero","dir","halfExtent","_updateBox","_setupTarget","opening","wasVisible","scaleChanged","previousScaleX","previousScaleY","previousScaleZ","isAnimating","targetPosition","pointOnBoxFace","pointOnBoxFaceToCamera","boxCenter","tempParentWorldScale","boxFaceNormal","forceNewExtents","targetSquareDistance","targetDir","targetHalfExtentStr","targetHalfExtent","targetCameraDot","halfExtentStr","subVectors","cameraAngleDotBoxNormal","dot","squareDistance","setFromMatrixScale","sqrt","targetScale","finalScale","tipSelector","labelSelector","tipEl","labelEl","onHovered","onUnhovered","wasPinned","SOUND_PIN","_discordBridges","canPin","getPromotionTokenForFile","xMin","xMax","yMin","yMax","zMin","zMax","_checkForDestroy","cameraModelPromise","cameraModelSrc","pathsMap","player-right-controller","player-left-controller","videoCodec","codec","MediaRecorder","isTypeSupported","videoMimeType","hasWebGL2","allowVideo","CAPTURE_WIDTH","CAPTURE_HEIGHT","CAPTURE_DURATIONS","DEFAULT_CAPTURE_DURATION","snapCanvas","pixels","imageData","createImageData","bitmap","createImageBitmap","captureDuration","captureAudio","label","showCameraViewfinder","WebGLRenderTarget","RGBAFormat","depth","stencil","PerspectiveCamera","viewfinderInViewThisFrame","updateUI","aspect","screen","selfieScreen","labelActionBackground","labelBackground","durationLabel","snapIcon","recordIcon","recordAlphaIcon","snapMenu","cancelButton","nextDurationButton","prevDurationButton","snapClicked","cancelSnapping","changeDuration","stopButton","stopRecording","captureAudioButton","captureAudioIcon","updateRenderTargetNextTick","updateViewfinder","findIndex","newIdx","trackTarget","SOUND_CAMERA_TOOL_COUNTDOWN","snapCountdown","countdownInterval","setInterval","camera_tool_asyncToGenerator","clearInterval","takeSnapshotNextTick","beginRecording","hasDuration","isPhoto","isRecordingUnbound","videoRecorder","showActionLabelBackground","videoContext","videoCanvas","videoImageData","videoPixels","Uint8Array","captureStream","selfAudio","getAudioTracks","destination","createMediaStreamDestination","getInput","createMediaStreamSource","addTrack","mimeType","chunks","recordingStartTime","ondataavailable","videoCountdown","videoCountdownInterval","_free","onstop","recordingDuration","Blob","playerIsBehindCamera","MAX_DURATION_TO_LIMIT_LOOPS","objectType","ObjectTypes","CAMERA","cancel","heldLeftHand","heldRightHand","heldRightRemote","heldThisFrame","grabPath","isHolding","updateSnapMenuOrientation","isHoldingTrigger","isHoldingSnapshotTrigger","snapTriggerTimeout","releaseInterval","tock","tempHeadScale","playerHead","playerHud","hudEl","analyser","getAudioFeedbackScale","playerHudWasVisible","spriteSystem","tmpVRFlag","tmpOnAfterRender","onAfterRender","videoRenderTarget","setRenderTarget","srcX0","srcY0","srcX1","srcY1","dest","dstX0","dstY0","dstX1","dstY1","gl","srcFramebuffer","properties","__webglFramebuffer","destFramebuffer","bindFramebuffer","READ_FRAMEBUFFER","DRAW_FRAMEBUFFER","checkFramebufferStatus","FRAMEBUFFER_COMPLETE","blitFramebuffer","COLOR_BUFFER_BIT","LINEAR","readRenderTargetPixels","putImageData","snapPixels","RENDER_WIDTH","pixelsToPNG","grabberId","grabberPaths","playerWorld","playerToCamera","cameraForwardPoint","cameraForwardWorld","AMMO_BODY_ATTRIBUTES","TRANSFORM_MODE","AXIS","PUPPET","CURSOR","ALIGN","SCALE","STEP_LENGTH","CAMERA_WORLD_QUATERNION","CAMERA_WORLD_POSITION","TARGET_WORLD_QUATERNION","v2","q2","onGrabStart","transformSystem","startTransform","onGrabEnd","stopTransform","dxStore","dxApplied","dyAll","dyStore","dyApplied","puppet","initialControllerOrientation","initialControllerOrientation_inverse","initialObjectOrientation","currentControllerOrientation","controllerOrientationDelta","planarInfo","plane","wireframe","normal","intersections","previousPointOnPlane","currentPointOnPlane","deltaOnPlane","finalProjectedVec","startPlaneCasting","raycaster","sign","sign2","dxAll","hasScaled","hasRotated","hasRecentered","puppetingTick","cursorAxisOrScaleTick","cameraToPlaneDistance","intersection","projectOnPlane","modify","setFromAxisAngle","scaleFactor","newScale","FORWARD","TWO_PI","RayCurve","numPoints","BufferGeometry","vertices","Float32Array","uvs","addAttribute","BufferAttribute","setDynamic","drawMode","TriangleStripDrawMode","direction","parabolicCurve","p0","v0","out","setDirection","UP","cross","setWidth","setPoint","posA","posB","checkLineIntersection","meshes","referenceNormal","landingMaxAngle","hitPoint","intersects","intersectObjects","collisionNormal","angleNormals","angleTo","isValidNormalsAngle","face","LANDING_NORMAL","vecHelper","confirm","collisionEntities","hitCylinderColor","hitCylinderRadius","outerRadius","hitCylinderHeight","isTeleporting","rayCurve","teleportEntity","parabola","hit","Raycaster","rigWorldPosition","newRigWorldPosition","teleportOriginWorldPosition","teleportEventDetail","oldPosition","newPosition","prevHitHeight","hitEntity","createHitEntity","stopPlayingTeleportSound","teleportingSound","sfx","timeTeleporting","playSoundLoopedWithGain","SOUND_TELEPORT_START","characterController","SOUND_TELEPORT_END","collidedIndex","timeSegment","percentToDraw","segmentT","hitEntityOpacity","easeOutIn","dRadii","outerScale","easeIn","outerTorus","torus","cylinder","primitive","radiusTubular","segmentsRadial","segmentsTubular","segmentsHeight","openEnded","MAX_ANISOTROPY","computeWidth","wrapPixels","wrapCount","widthFactor","FONTS","roboto","font","ch","chars","yoffset","sum","digitsum","digits","xadvance","computeFontWidthFactor","ImageLoader","anisotropy","loadTexture","align","oneOf","anchor","letterSpacing","lineHeight","tabSize","xOffset","zOffset","shaderData","getShaderData","shaderObject","shaders","Shader","createTextGeometry","attrName","updateFont","currentFont","updateGeometry","updateLayout","parseSide","all","pages","layout","geometryComponent","textScale","descender","TypeError","ascender","geometryUpdateBase","geometryUpdateData","newLineRegex","tabRegex","isFinite","common","sets","detect","browser","VR_DEVICE_AVAILABILITY","yes","no","maybe","GENERIC_ENTRY_TYPE_DEVICE_BLACKLIST","getAvailableVREntryTypes","_getAvailableVREntryTypes","ua","isSamsungBrowser","isWebVRCapableBrowser","hasNativeWebVRImplementation","isDaydreamCapableBrowser","isIDevice","isFirefoxBrowser","isUIWebView","mediaDevices","safari","isCardboardCapableBrowser","displays","getVRDisplays","generic","cardboard","gearvr","isMaybeGearVRCompatibleDevice","isMaybeDaydreamCompatibleDevice","capabilities","canPresent","canShare","share","opts","tweetLink","StateRoute","_this$props","routeProps","_objectWithoutProperties","react_default","es_Route","_extends","PromoteClientDialog","dialog_container","promote_client_dialog_extends","index_es","confirmButton","onConfirm","ClientInfoDialog","client_info_dialog_defineProperty","avatarThumbnailUrl","performConditionalSignIn","client_info_dialog_asyncToGenerator","addOwner","getPresenceEntry","showNonHistoriedDialog","removeOwner","unhide","setState","mayKick","mayMute","targetIsOwner","targetIsCreator","creator","targetIsSignedIn","signed_in","mayAddOwner","mayRemoveOwner","isHidden","client_info_dialog_extends","clientInfoDialog","roomInfo","clientProfileImage","clientActionButtons","buttonIcon","add_owner_default","remove_owner_default","Loader","loader_defineProperty","loadingNum","loadedNum","doneWithInitialLoad","loadingTimeout","tryFinishLoading","environmentSceneLoaded","onLoaded","onObjectLoading","onObjectLoaded","nomore","loaderStyles","loadingText","progress","usual","locale","lang","messages","loadingIcon","finished","AutoExitWarning","secondsRemaining","wrap_with_audio","onCancel","propTypes","number","EntryButton","cx","entryButton","entryButtonSecondary","secondary","iconSrc","contents","prefixMessageId","bolded","mediumMessageId","subtitle","isInHMD","TwoDEntryButton","entryButtonProps","MobileScreenEntryImg","DesktopScreenEntryImg","GenericEntryButton","GenericVREntryImg","DaydreamEntryButton","DaydreamEntryImg","ProfileEntryPanel","profile_entry_panel_defineProperty","getStateFromProfile","hasChangedName","hasChangedNowOrPreviously","hasAcceptedProfile","stopPropagation","entry","profile_entry_panel_asyncToGenerator","storeUpdated","nameInput","setAvatarFromMediaResult","refetchAvatar","componentDidUpdate","_prevProps","prevState","formatMessage","intl","profileEntry","close","react_fontawesome_index_es","onSubmit","saveStateAndFinish","form","darkened","htmlFor","displayNameOverride","formFieldText","handleTextFieldFocus","handleTextFieldBlur","onChange","required","spellCheck","pattern","SCHEMA","definitions","inp","avatar_preview","avatarGltfUrl","account_id","state_link","hideDelete","returnToProfile","editAvatar","faPencilAlt","chooseAvatar","sourceNavigateWithNoNav","formSubmit","links","rel","termsLink","privacyLink","logo","injectIntl","PRIVACY_POLICY_LINKS","DEFAULT_FACETS","MediaBrowser","media_browser_defineProperty","facets","showNav","selectNextResult","clearStashedQueryOnClose","newState","getStoreAndHistoryState","selectEntry","inputRef","getUrlSource","suggestions","forceNow","_sendQueryTimeout","filterQueryNavigate","lucky_query","handleQueryUpdated","onMediaSearchResultEntrySelected","sourceNavigate","facet","pushExitMediaBrowserHistory","isSceneApiType","isAvatarApiType","dialog","clearStashedQuery","pageNavigate","browserDiv","scrollTop","sourceChanged","showCustomOption","hideSearch","showEmptyStringOnNoResult","handleCustomClicked","showCustomMediaDialog","mediaBrowser","header","noSearch","headerLeft","headerCenter","favoritesHeader","faStar","searchIcon","faSearch","autoFocus","placeholder","handleEntryClicked","trim","blur","searchClear","engineAttribution","engineAttributionContents","headerRight","createButton","faLink","faCloudUploadAlt","createLink","handleSourceClicked","navSource","navSourceSelected","navRightPad","navScrollArrow","faAngleRight","handleFacetClicked","media_tiles","handlePager","emptyString","attributionHostnames","giphy.com","giphyLogo","media.giphy.com","DEFAULT_OBJECT_URL","instructions","references","mobileInstructions","desktopInstructions","lastUrl","fileInputId","CreateObjectDialog","create_object_dialog_defineProperty","fileName","attributionImage","validity","valid","fileInput","onCreate","other","create_object_dialog_objectWithoutProperties","smallButton","cancelIcon","uploadButton","uploadIcon","faPaperclip","filenameLabel","leftSideOfInput","urlInput","onUrlChange","create_object_dialog_extends","onCreateClicked","addMediaForm","hideFileInput","onFileChange","inputBorder","buttons","actionButton","ChangeSceneDialog","change_scene_dialog_defineProperty","onChangeClicked","changeSceneForm","spokeCreate","spokeLaunch","AvatarUrlDialog","avatar_url_dialog_defineProperty","avatarUrlDialog","HelpDialog","help_dialog_extends","textAlign","InviteDialog","invite_dialog_defineProperty","copyButtonActive","shareButtonActive","link","entryCode","embedUrl","entryCodeString","num","pad","shortLinkText","shortLink","embedText","modal","isModal","attachPoint","hubLinkLink","code","digit","readOnly","select","linkButton","copyClicked","allowShare","shareClicked","embed","showEmbedTip","embedTipWrap","embedTip","embedTipAttachPoint","hasPush","subscribe","onSubscribeChanged","checked","isSubscribed","enterVrButton","InviteTeamDialog","invite_team_dialog_defineProperty","inviteButtonText","requestSupport","invite_team_dialog_extends","inviteClicked","LinkDialog","linkCode","codeLoadingPanel","imageHeader","LinkDialogHeader","keepOpen","closeButton","SafariDialog","safari_dialog_defineProperty","copyLinkButtonText","onCopyClicked","copyLinkClicked","safari_dialog_extends","SafariMicDialog","safari_mic_dialog_extends","reload","RoomSettingsDialog","room_settings_dialog_defineProperty","initialSettings","renderCheckbox","member_permission","permission","permissionDisabled","member_permissions","room_settings_dialog_objectSpread","room_settings_dialog_extends","roomSettingsForm","autoComplete","nameField","newMemberPermissions","spawn_and_move_media","spawn_camera","pin_objects","permissionsGroup","CloseRoomDialog","close_room_dialog_extends","LOCAL_CLOSE_TIPS","KEEP_ACTIVE_AFTER_GLOBAL_CLOSE","localStorageCache","finishedScopes","tipPlatform","platformTips","desktop","mobile","standalone","isTipFinished","tip","localStorage","getItem","markTipFinished","storeData","setItem","handleTipClose","fullTip","scope","tips","VALIDATORS","activeSets","cursorHoldingPen","locomotion","accel","turning","spawn_menu","mediaCounter","freeze_gesture","cursorHoldingInteractable","cursorHoveringOnInteractable","menu_hover","invite","cursorHoldingCamera","object_grab","object_rotate_button","object_scale_button","object_recenter_button","object_pin","hasPinned","object_zoom","object_scale","pen_color","pen_size","pen_mode","freeze_mode","video_share_mode","mute_mode","feedback","entryCount","activeTips","_finishedScopes","_performStep","_userinput","_mediaCounter","prevTop","prevBottom","chosenTip","finishCount","Tip","tipRegion","broadcastTarget","tipBody","splitTip","splitTipIcon","tipLink","tipRoot","tipCancel","WebRTCScreenshareUnsupportedDialog","webrtc_screenshare_unsupported_dialog_extends","flexDirection","alignItems","fontSize","WebAssemblyUnsupportedDialog","webassembly_unsupported_dialog_extends","WebVRRecommendDialog","webvr_recommend_dialog_extends","FeedbackDialog","feedback_dialog_extends","formFrame","frameBorder","marginHeight","marginWidth","LeaveRoomDialog","leave_room_dialog_extends","leaveRoom","messageType","destinationUrl","RoomInfoDialog","toAttributionDiv","attribution","attributionName","attributionAuthor","author","attributions","hubName","room_info_dialog_extends","sceneScreenshot","screenshot_url","sceneDetails","sceneMain","sceneName","sceneCreator","sceneAttributions","sceneButtons","OAuthDialog","renderSignInDisclaimer","oauthTypeName","privacyNotice","renderTweetDisclaimer","twitterMessage","oauthInfo","oauth_dialog_extends","oauthButtons","oauthButton","oauthTwitterButton","oauthDiscordButton","array","emojiPlugin","createEmojiPlugin","hashtagPlugin","createHashtagPlugin","linkifyPlugin","createLinkifyPlugin","counterPlugin","createCounterPlugin","addEmoji","emoji","editorState","contentState","getCurrentContent","entityKey","createEntity","emojiUnicode","getLastCreatedEntityKey","currentSelectionState","getSelection","emojiAddedContent","emojiEndPos","blockSize","afterRemovalContentState","Modifier","removeRange","targetSelection","getSelectionAfter","insertText","getAnchorOffset","blockKey","getAnchorKey","getBlockForKey","getLength","newEditorState","EditorState","forceSelection","TweetDialog","createEditorStateWithText","editorRef","sendTweet","media_stored_file_url","getPlainText","posting","posted","renderPostedDialog","tweet_dialog_extends","tweetButton","renderTweetDialog","EmojiSuggestions","EmojiSelect","CharCounter","dialogBackground","tweet","editor","editorInner","draft_js_plugins_editor_lib_default","emojiButton","emojiSuggestions","limit","media","tweetLoader","LobbyChatBox","lobby_chat_box_defineProperty","pendingMessage","onSendMessage","textRows","pendingMessageTextareaHeight","pendingMessageFieldHeight","discordSnippet","occupantSnippet","occupantCount","messageEntryPlaceholder","sendMessage","messageEntry","messageEntryDisabled","messageEntryInput","rows","messageEntryButton","messageEntrySubmit","faPaperPlane","ChatCommandHelp","commands","commandHelp","commandHelpOnTop","onTop","matchingPrefix","command","defaultStylesByTagName","noStyleTags","BASE","HEAD","HTML","META","NOFRAME","NOSCRIPT","PARAM","SCRIPT","STYLE","TITLE","tagNames","computeDefaultStyleByTagName","tagName","defaultStyle","element","computedStyle","getComputedStyle","warmSerializeElement","navigateToClientInfo","currentParams","PresenceList","presence_list_defineProperty","expanded","CameraImage","PhoneImage","hmd","HMDImage","discord","DiscordImage","DesktopImage","getPresenceImage","isBot","badge","moderatorBadge","row","listItem","self","clientLink","renderExpandedList","presenceList","domForPresence","signIn","signedIn","maskEmail","onSignOut","onSignIn","rootStyles","presenceInfo","presenceInfoSelected","faUsers","messageCanvas","emojiRegex","urlRegex","messageBodyDom","fromSessionId","includeFromLink","multiLine","wrapStyle","messageWrapMulti","messageWrap","mono","messageBodyClasses","messageBody","messageBodyMulti","messageBodyMono","includeClientLink","onFromClick","words","outWords","word","wordWrap","cleanedBody","messageSource","messageSourceLink","Linkify_default","toEmojis","renderChatMessage","allowEmojiRender","lowResolution","isOneLine","isEmoji","presenceLog","presenceLogSpawn","entryDom","presenceLogEntry","presenceLogEntryOneLine","presenceLogEmoji","ReactDOM","objectScale","offsetWidth","offsetHeight","xhtml","nodeType","Node","ELEMENT_NODE","cssTexts","toUpperCase","cssText","ii","cssPropName","outerHTML","serializeElement","chat_message_asyncToGenerator","unmountComponentAtNode","meshEntity","blobUrl","createObjectURL","isRawProperty","meshMaterial","spawnChatMessage","_spawnChatMessage","ChatMessage","maySpawn","iconButton","spawnMessage","InWorldChatBox","in_world_chat_box_defineProperty","messageEntryInRoom","messageEntryOnMobile","chat_command_help_ChatCommandHelp","accept","onObjectCreated","enableSpawning","messageEntryButtonInRoom","messageEntryUpload","faCamera","faPlus","messageEntryInputInRoom","messageEntryInputNoSpawn","messageEntrySpawn","AVATARS_API","AvatarEditor","avatar_editor_defineProperty","parent_avatar_listing_id","previewGltfUrl","avatar_editor_asyncToGenerator","creatorAttribution","inputFiles","base_gltf_url","KHR_binary_glTF","bin","getWrappedInstance","snapshot","filesToUpload","uploading","fileUploads","upload","avatar_editor_objectSpread","file_id","access_token","promotion_token","reduce","createOrUpdateAvatar","onSave","avatarEditor","uploadAvatar","textField","textarea","fileField","mapField","checkbox","avatar_editor_extends","confirmDelete","deleteAvatar","MicLevelWidget","mic_level_widget_defineProperty","startAnalyser","stopAnalyser","micUpdateInterval","micLevelMovingAverage","MovingAverage","average","movingAverage","micClip","level_background_default","srcSet","level_background_2x_default","muteOnEntry","level_fill_default","level_fill_2x_default","hasAudioTrack","mic_level_default","mic_level_2x_default","mic_denied_default","mic_denied_2x_default","OutputLevelWidget","output_level_widget_defineProperty","tonePlaying","playTestTone","toneClip","webmTone","mp3Tone","oggTone","wavTone","testToneTimeout","speakerClip","level_action_background_default","level_action_background_2x_default","level_action_fill_default","level_action_fill_2x_default","speaker_level_default","speaker_level_2x_default","PhotoMessage","landingPageUrl","onShareClicked","mediaBody","VideoMessage","ImageMessage","spawnImage","PresenceLog","presence_log_defineProperty","entryClasses","presenceLogEntryWithButton","presenceLogChat","expired","oldName","newName","inRoom","presenceClasses","presenceLogInRoom","domForEntry","SettingsMenu","settings_menu_defineProperty","renderExpandedMenu","rowClasses","settingsRow","rowHeader","showRoomSettings","showRoomInfo","hubScene","showStreamerMode","flyEnabled","settingsMenu","change_avatar_default","listItemLink","toggleFlyMode","faInfoCircle","faDoorClosed","faVideo","toggleStreamerMode","faBars","cornerButton","cornerButtonSelected","isStreaming","PreloadOverlay","treatment","screenshot","mainPanel","onLoadClicked","loadButton","SPRITESHEET_ICONS","MIC","spritesheet","mic0","mic1","mic2","mic3","mic4","mic5","mic6","mic7","MIC_OFF","micOff0","micOff1","micOff2","micOff3","micOff4","micOff5","micOff6","micOff7","TopHUD","_2d_hud_defineProperty","showVideoShareOptions","lastActiveMediaSource","micLevel","cameraDisabled","penDisabled","mediaDisabled","micLevelForVolume","videoShareMediaSource","onEndShareVideo","onShareVideo","onShareVideoNotCapable","videoShareExtraOptionTypes","primaryVideoShareType","showExtrasOnHover","hideVideoSharingButtonTimeout","capitalize","videoShare","handleVideoShareClicked","onMouseOver","videoShareExtraOptions","onMouseOut","videoSharingButtons","buildVideoSharingButtons","tipDivForType","cancelFunc","topTip","watching","topTipNoHud","onWatchEnded","tipCancelText","showVideoShareFailed","hideVideoShareFailedTip","activeTip","micIconClass","container","unselectable","uiStyles","uiInteractive","panel","onToggleMute","sourceNavigateToDefaultSource","hasActiveCamera","onSpawnCamera","flyingEnabled","onToggleFlying","isCursorHoldingPen","onToggleFreeze","onSpawnPen","showStreamingTip","hideStreamingTip","react_components_2d_hud","SpectatingLabel","_isIn2DInterstitial","_exitAction","afterUserGesturePrompt","handleExitTo2DInterstitial","isLower","exitAction","exitVR","vrNotice","exit2DInterstitialAndEnterVR","exit","enterVR","isIn2DInterstitial","avatarEditorDebug","addLocaleData","en","HMD_MIC_REGEXES","IN_ROOM_MODAL_ROUTER_PATHS","IN_ROOM_MODAL_QUERY_VARS","LOBBY_MODAL_ROUTER_PATHS","LOBBY_MODAL_QUERY_VARS","LOBBY_MODAL_QUERY_VALUES","enumerateDevices","isMobilePhoneOrVR","AUTO_EXIT_TIMER_SECONDS","UIRoot","ui_root_defineProperty","enterInVR","entered","showShareDialog","broadcastTipDismissed","linkCodeCancel","miniInviteActivated","didConnectToNetworkedScene","noMoreLoadingUpdates","hideLoader","waitingOnAudio","mediaStream","audioTrack","micDevices","autoExitTimerStartedAt","autoExitTimerInterval","secondsRemainingBeforeAutoExit","exited","ui_root_asyncToGenerator","airtableAssets","signInMessageId","authChannel","signInCompleteMessageId","signInContinueTextId","onContinueAfterSignIn","SignInDialog","authComplete","startAuthentication","authStarted","continueText","onContinue","subscriptions","isFavorited","initialIsFavorited","sceneLoaded","mediaSource","updateSubscribedState","forcedVREntryType","enterDaydream","enter2D","disableAutoExitOnConcurrentLoad","secondsSinceStart","checkForAutoExit","endAutoExitTimer","reason","exitScene","_ref4","grantedMicLabels","setMediaStreamToDefault","beginOrSkipAudioSetup","performDirectEntryFlow","availableVREntryTypes","_ref8","constraints","deviceId","exact","fetchAudioTrack","setupNewMediaStream","hasAudio","lastUsedMicDeviceId","settings","ideal","_ref10","getUserMedia","recreateAudioStream","_ref11","setLocalMediaStream","fetchMicDevices","micDeviceId","micDeviceIdForMicLabel","micLabelForMediaStream","mediaStreamForMicAnalysis","entry_step","onAudioReadyButton","hasHmdMicrophone","selectedMicLabel","enterScene","onFinished","linkChannel","generateCode","hasOpenedShare","updateScene","ui_root_objectSpread","DialogClass","closeDialog","beginStreaming","endStreaming","_ref16","signOut","broadcastedRoomConfirmed","confirmedBroadcastedRooms","interstitial","onInterstitialPromptClicked","roomUnavailableReason","platformUnsupportedReason","exitSubtitleId","logo_default","promptForNameAndAvatarBeforeEntry","hubIsBound","entryStyles","entryPanel","collapseButton","roomSubtitle","lobby_chat_box","buttonContainer","attemptLink","secondaryActionButton","wideButton","buttonSubtitle","handleForceEntry","faArrowLeft","audioLoader","granted","onMicGrantButton","mic_granted_default","mic_granted_2x_default","subtitleId","mic_level_widget_MicLevelWidget","output_level_widget_OutputLevelWidget","selectedMicDeviceId","micDeviceChanged","mic_small_default","mic_small_2x_default","dropdown_arrow_default","dropdown_arrow_2x_default","shouldShowHmdMicWarning","warning_icon_default","warning_icon_2x_default","overlay","showSafariMicDialog","safari_mic_dialog_SafariMicDialog","showSafariDialog","safari_dialog_SafariDialog","showWebAssemblyDialog","webassembly_unsupported_dialog_WebAssemblyUnsupportedDialog","exitEventHandler","airtableAssetsInitialState","prevProps","showSignInDialog","showContextualSignInDialog","willCompileAndUploadMaterials","compileAndUploadMaterials","onConcurrentLoad","onSceneLoaded","onAframeStateChanged","onShareVideoEnabled","onShareVideoDisabled","onShareVideoFailed","onStoreChanged","audioContext","playSound","onMouseLeave","fetchAirtableAssets","isExited","showPreload","isLoading","ui","ui-root","in-modal-or-overlay","isInModalOrOverlay","serviceWorker","showOAuthDialog","showInterstitialPrompt","oauth_dialog_OAuthDialog","onCloseOAuthDialog","Privacy_Link","Terms_Link","renderExitedPane","react_components_loader","Icon","onLoadingFinished","renderInterstitialPrompt","renderBotMode","enteredOrWatching","enteredOrWatchingOrPreload","inEntryFlow","entryDialog","isWaitingForAutoExit","auto_exit_warning","state_route","renderDevicePanel","renderMicPanel","renderAudioSetupPanel","renderEntryStartPanel","dialogBoxContentsClassNames","uiDialogBoxContents","backgrounded","showVREntryButton","presenceLogEntries","showMediaBrowser","hasTopTip","clientInfoClientId","getClientInfoClientId","showClientInfo","hasEmbedPresence","hasDiscordBridges","showBroadcastTip","showInviteTip","streamingTip","streamingTipAttachPoint","streamingTipClose","streamingTipMessage","streamerName","Provider","helmet","page","preload_overlay_PreloadOverlay","onPreloadLoadClicked","DarkLogo","profile_entry_panel","ui_root_extends","avatar_editor_AvatarEditor","onAvatarSaved","react_components_media_browser","renderDialog","hubMemberPermissions","updateHub","closeHub","help_dialog_HelpDialog","createObject","changeScene","setAvatarUrl","client_info_dialog_ClientInfoDialog","uiDialog","presence_log_PresenceLog","tip_Tip","confirmBroadcastedRoom","in_world_chat_box","leaveButton","inviteStyles","inviteContainer","inviteContainerBelowHud","inviteContainerInverted","inviteTip","inviteTipAttachPoint","onMiniInviteClicked","inviteMiniButton","enterButton","invite_dialog_InviteDialog","hubEntryCode","initialIsSubscribed","link_dialog_LinkDialog","cameraModeExitButton","presence_list_PresenceList","settings_menu_SettingsMenu","spectating_label_SpectatingLabel","topHud","toggleMute","shareVideo","endShareVideo","showWebRTCScreenshareUnsupportedDialog","nagCornerButton","isSupportAvailable","MS_PER_DAY","MS_PER_MONTH","isSameMonth","da","db","getFullYear","getMonth","HUB_CREATOR_PERMISSIONS","VALID_PERMISSIONS","HubChannel","hub_channel_defineProperty","Presence","_permissions","jwtDecode","nextRefresh","exp","hub_channel_asyncToGenerator","entryDisplayType","vrDisplay","isPresenting","initialOccupantCount","publisher","initialOccupants","entryEvent","hub_channel_objectSpread","getEntryTimingFlags","entryTimingFlags","isNewDaily","isNewMonthly","isNewDayWindow","isNewMonthWindow","storedLastEnteredAt","lastEnteredAt","lastEntered","msSinceLastEntered","getDate","isSameDay","object_type","update_hub","close_hub","subscription","allow","creatorAssignmentTokenEntry","_getCreatorAssignmentToken","perms_token","setPermissionsFromToken","_signedIn","oauth_url","gltfNode","fileAccessToken","promotionToken","gltf_node","file_access_token","permsToken","session_id","_blockedSessionIds","unblock","entities","completeSync","Set","migrateToSocket","presenceBindings","onJoin","caller","onLeave","onSync","endRecording","exceedsDensityThreshold","subtree","bounds","boundingData","isHighDensity","leftResult","rightResult","isGeometryHighDensity","roots","_roots","traverseMeshesAndAddShapes","shapes","meshRoot","group","__proto__","navMesh","shapePrefix","groupEnd","DUCK_URL","MessageDispatch","entryManager","addToPresenceLog","remountUI","message_dispatch_defineProperty","commandParts","dispatchCommand","activeElement","scales","curScale","physicsSystem","captureSystem","setDebug","rename","available","isDebug","SceneEntryManager","scene_entry_manager_defineProperty","whenSceneLoaded","_entered","scene_entry_manager_asyncToGenerator","session","verbose","_setupPlayerRig","_setupBlocking","_setupKicking","_setupMedia","_setupCamera","_spawnAvatar","SOUND_ENTER_SCENE","_runBot","sendEntryEvent","toISOString","bumpEntryCount","hasLoaded","localMediaStream","getTracks","setAnimationLoop","_setPlayerInfoFromProfile","avatarScale","kickedClientId","_unpinElement","removeEntity","removeEntitiesOfClient","storedPromotionToken","gltfComponents","equalArray","every","translation","mediaSrc","mediaContentSubtype","pinnedEntityToGltf","pin","_signInAndPinOrUnpinElement","_pinElement","_disableSignInOnPinAction","unpin","spawnMediaInfrontOfPlayer","contentOrigin","or","currentVideoShareEntity","FILE","sendObjectSpawnedEvent","contentEditable","uiRoot","clipboardData","getData","CLIPBOARD","dataTransfer","isHandlingVideoShare","shareVideoMediaStream","_ref7","newStream","frameRate","removeTrack","spawnDelay","audioEl","audioInput","dataInput","getAudio","crossorigin","onchange","getRecording","mozCaptureStream","INIT_TIMEOUT_MS","urlBase64ToUint8Array","base64String","base64","repeat","rawData","atob","outputArray","charCodeAt","Subscriptions","subscriptions_defineProperty","registration","vapidPublicKey","_isSubscribed","subscriptions_asyncToGenerator","startedAt","pushManager","convertedVapidKey","permissionState","userVisibleOnly","applicationServerKey","getSubscription","endpoint","pushSubscription","has_remaining_subscriptions","invaderPos","bubblePos","createSphereGizmo","WireframeGeometry","line","LineSegments","invaders","bubbles","tickCount","_updateInvaders","registerBubble","bubble","unregisterBubble","registerInvader","invader","unregisterInvader","updateDebug","setInvading","tempInvasionFlags","setInvaderFlag","distanceSquared","radiusSum","flushInvadingFlagsForIndex","meshName","targetMesh","useMaterial","invadingOpacity","findInvaderMesh","radiusSquared","system","cameraEls","cameraUpdateCount","ticks","playerModelEl","updatePlayerHead","_onOwnershipChange","modeMod","WheelEvent","DOM_DELTA_PIXEL","DOM_DELTA_LINE","DOM_DELTA_PAGE","isInModal","MouseDevice","queueEvent","deltaX","deltaY","deltaMode","clientX","innerWidth","clientY","innerHeight","movementX","movementY","mouseDownLeftThisFrame","mouseDownRightThisFrame","write","didStopProcessingEarly","setVector2","setValueType","ArrayBackedSet","initialItems","items","oncontextmenu","KeyboardDevice","seenKeys","nodeName","HudDevice","XboxControllerDevice","buttonMap","buttonId","axisMap","axisId","getGamepads","connected","xboxPaths","hapticActuators","Pose","fromOriginAndDirection","setFromUnitVectors","fromCameraProjection","normalizedX","normalizedY","unproject","EYES_TO_ELBOW","FOREARM","applyArmModel","controllerEuler","deltaControllerPosition","controllerQuaternion","controllerPosition","gamepadPose","headObject3D","userHeight","applyAxisAngle","up","fromArray","applyEuler","copySittingToStandingTransform","stageParameters","sittingToStandingTransform","ONES","TOUCHPAD","TRIGGER","OculusGoControllerDevice","sittingToStandingMatrix","rayObject","rayMatrixWorld","setPose","setMatrix4","TOUCHPAD_X","TOUCHPAD_Y","GearVRControllerDevice","leftOculusTouchButtonMap","rightOculusTouchButtonMap","LEFT_HAND_OFFSET","RIGHT_HAND_OFFSET","OculusTouchControllerDevice","buttonMaps","devicePaths","handOffset","HAND_OFFSET","POSE","MATRIX","DaydreamControllerDevice","RAY_ROTATION","ViveControllerDevice","isViveWand","gamepads","WindowsMixedRealityControllerDevice","CircularBuffer","fill","writePtr","difference","GyroDevice","hmdEuler","hmdQuaternion","prevX","prevY","dXBuffer","dYBuffer","hasPolyfill","webvrpolyfill","getPolyfillDisplays","frameData","VRFrameData","getFrameData","dX","dY","findHandCollisionTargetForHand","driver","numManifolds","dispatcher","getNumManifolds","handPtr","Ammo","getPointer","persistentManifold","getManifoldByIndexInternal","body0ptr","getBody0","body1ptr","getBody1","numContacts","getNumContacts","getContactPoint","getDistance","els","tags","remoteHoverTargets","findRemoteHoverTarget","updateCursorIntersection","rightRemoteHoverTarget","dropPath","hoverFn","getRightRemoteHoverTarget","previousState","tickInteractor","lostOwnership","canMove","rightHandTeleporter","gazeTeleporter","rightHandInteracting","rightHandTeleporting","rightRemotePenIntersectingInVR","enableRightRemote","SOUND_HOVER_OR_GRAB","calculateCursorPose","AppAwareMouseDevice","prevButtonLeft","clickedOnAnything","prevCursorPose","prevOrigin","prevDirection","rawIntersections","cursorTargettingSystem","remoteHoverTarget","isInteractable","touchIsAssigned","touch","assignments","assignment","identifier","jobIsAssigned","job","unassign","findByJob","findByTouch","MOVE_CURSOR_JOB","MOVE_CAMERA_JOB","FIRST_PINCHER_JOB","SECOND_PINCHER_JOB","TAP_PATHS","x1","y1","x2","y2","dx","dy","getPlayerCamera","AppAwareTouchscreenDevice","pendingTap","maxTouchCount","tapIndexToWriteNextFrame","framesUntilGrab","framesUntilUnassign","second","first","cameraMover","isFirstTouch","isSecondTouch","isThirdTouch","hasSecondPinch","setFromCamera","shouldMoveCursor","cursorJob","previousAssignment","changedTouches","touches","hasCursorJob","hasCameraJob","xforms","scalar","scaleExp","pow","deadzone","deadzoneSize","split_vec2","compose_vec2","copyIfFalse","copyIfTrue","zeroIfDefined","true","rising","risingWithFrameDelay","falling","vec2Zero","poseFromCameraProjection","vec2dpad","deadzoneRadius","invertX","invertY","deadzoneRadiusSquared","atan2","always","constValue","wasd_to_vec2","vec2","add_vec2","max_vec2","normalize_vec2","any","touch_axis_scroll","snap_to","touching","addSetsToBindings","mapping","setName","binding","togglePenWithP","togglePenWithHud","keyboardMouseUserBindings","global","xform","priority","cursorHoldingUI","cursorHoveringOnVideo","inputFocused","cursorHoveringOnUI","touchCamDelta","touchscreenUserBindings","cursorHoveringOnPen","keyboardDebuggingBindings","leftButton","leftAxis","leftPose","rightButton","rightAxis","rightPose","rightGripRisingGrab","lowerButtons","leftGripPressed1","leftGripPressed2","rightGripPressed1","rightGripPressed2","leftTriggerPressed1","leftTriggerPressed2","rightTriggerPressed1","rightTriggerPressed2","oculusTouchUserBindings","north","south","east","west","override","leftHandHoveringOnNothing","cursorHoveringOnNothing","leftHandHoveringOnInteractable","leftHandHoldingInteractable","leftHandHoveringOnPen","leftHandHoldingPen","rightHandHoveringOnInteractable","rightHandHoldingInteractable","rightHandHoveringOnPen","rightHandHoldingPen","cursorHoveringOnCamera","rightHandHoveringOnCamera","leftHandHoveringOnCamera","rightHandHoldingCamera","leftHandHoldingCamera","rightHandHoveringOnNothing","lButton","lAxis","lPose","lJoyScaled","lJoyXScaled","lJoyYScaled","lTouch","lTouchScaled","lTouchXScaled","lTouchYScaled","lDpadNorth","lDpadSouth","lDpadEast","lDpadWest","lDpadCenter","lTriggerFallingStopDrawing","lGripFallingStopDrawing","lTriggerRisingGrab","lGripRisingGrab","lTouchpadRising2","lTouchpadRising1","touchCharacterAcceleration","lCharacterAcceleration","leftBoost","rButton","rAxis","rPose","rTouch","rJoy","rDpadNorth1","rDpadSouth1","rDpadEast1","rDpadWest1","rDpadCenter1","rDpadNorth2","rDpadSouth2","rDpadEast2","rDpadWest2","rDpadCenter2","rDpadCenterStrip","rTouchpadRising","rTouchpadFalling","rightBoost","rTriggerRisingGrab","rGripRisingGrab","cursorDrop1","cursorDrop2","rTriggerStopTeleport","rTouchpadStopTeleport","ensureFrozenViaDpad","ensureFrozenViaKeyboard","thawViaDpad","thawViaKeyboard","rSnapRight1","rSnapLeft1","rSnapRight2","rSnapLeft2","keyboardSnapRight","keyboardSnapLeft","keyboardCharacterAcceleration","wasd_vec2","arrows_vec2","keyboardBoost","leftTouchpadPressed1","leftTouchpadPressed2","leftTouchpadFallingStopTeleport","leftTriggerFallingStopTeleport","leftGripFallingWhileHoldingPen","viveUserBindings","leftHandTeleporting","viveWandUserBindings","lGripPressed","rGripPressed","rTriggerPressed","rJoyNorth","rGripRising","rTriggerRising","rGripFalling","rTriggerFalling","dpadVariables","padWest","padEast","padNorth","padSouth","padCenter","padCenterStrip","dpadBindings","neverFrozenBinding","penBindings","forCursor","padY","triggerPressed","padPressed","padTouched","padRising","padCenterStripTouched","handPoseBindings","gripPressed","holdingCameraBindings","wmrUserBindings","leftPadPressed","rightPadPressed","leftPadFalling","rightPadFalling","keyboardSaceFalling","freezeBindings","rJoyWest","rJoyEast","rJoyWestRising","rJoyEastRising","keyboardQRising","keyboardERising","teleportationAndRotationBindings","lJoyXDeadzoned","lJoyYDeadzoned","characterAccelerationBindings","cursorMediaVolumeModBindings","rPadNorthOrSouth","rPadNorthOrSouthPressed","rPadNorthOrSouthPressedY","cursorModDeltaBindings","scaledRightJoystickVertical","scaledLeftJoystickCursorDelta","deadzonedRightJoystickHorizontal","deadzonedRightJoystickVertical","deadzonedLeftJoystickHorizontal","deadzonedLeftJoystickVertical","disableForwardOnTrigger","scaledLeftJoystickHorizontal","scaledLeftJoystickVertical","scaledLeftJoystickForwardAcceleration","xboxControllerUserBindings","cursorHoldingNothing","touchpadRising","touchpadFalling","touchpadPressed","dpadNorth","dpadSouth","dpadEast","dpadWest","dpadCenter","brushSizeDelta","cursorModDelta","dpadSouthDrop","dpadCenterDrop","grabBinding","dropOnCenterOrSouth","daydreamUserBindings","cardboardUserBindings","generate3DOFTriggerBindings","touchpadButton","triggerButton","touchpadX","touchpadXForPen","touchpadY","touchpadYForPen","triggerRising","triggerFalling","dpadCenterStrip","dpadBottomCenterStrip","togglePen","dropBinding","leftTeleporter","rightTeleporter","GamepadDevice","buttonPath","gamepadBindings","oculusGoUserBindings","gearVRControllerUserBindings","satisfiesPath","satisfyPath","satisfiedBy","canMask","masker","masked","maskerKey","maskerPath","maskedKey","isActive","toggleSet","pendingSetChanges","generation","generations","mat4","prevActiveSets","xformStates","activeDevices","registeredMappings","registeredMappingsChanged","vrGamepadMappings","nonVRGamepadMappings","updateBindingsForVRMode","activeDevice","gamepadConnected","gamepadDevice","maybeToggleXboxMapping","vrAxesSum","mouseMovement","nonXboxActivity","hasXboxMapping","prevSortedBindings","sortedBindings","mappings","unsorted","sorted","dependencySort","masks","masksRow","bindingsRow","col","computeMasks","teleporter","leftHandHoveringOnVideo","rightHandHoveringOnVideo","resolveActionSets","activeSetsChanged","il","elem","jl","arrayContentsDiffer","actives","prevActives","prevMasked","maskedRow","computeExecutionStrategy","bindingExistedLastFrame","PATHS_TO_SHOW","userinputFrameStatus","replacer","pathsOutput","val","textContent","sb","logBindings","MEDIA_SEARCH_PATHS","prefix","CursorTargettingSystem","setDirty","dirty","observer","MutationObserver","observe","childList","populateEntities","ACTIVATION_STATE","ConstraintsSystem","prevLeftHand","prevRightHand","prevRightRemote","constraintTag","entityId","hasAnotherConstraint","activationState","ACTIVE_TAG","DISABLE_DEACTIVATION","COLLISION_FILTER_MASK_HANDS","distanceBetweenStretchers","obj1","obj2","distanceTo","TwoPointStretchingSystem","leftStretcher","rightStretcher","previousLeftStretcher","previousRightStretcher","stretched","initialStretchDistance","SingleActionButtonSystem","didInteractThisFrame","HoldableButtonSystem","prevHeld","hasButtonComponent","BUTTON_COMPONENT_NAMES","dispatch","HOVERED","UNHOVERED","HoverButtonSystem","getHoverableButton","getSpecificHoverMenu","HoverMenuSystem","findHoverMenu","prevHoverMenu","SuperSpawnerSystem","maybeSpawn","superSpawner","performSpawn","spawnedEntity","copyState","STRENGTH","DROP","PICKUP","BUTTON_PRESSED","HOVER","STRETCH_BASE","STRETCH_DISTANCE","TELEPORTING","TELEPORTED","determineStrength","HapticFeedbackSystem","twoPointStretchingSystem","didClickButton","leftActuator","rightActuator","leftHandStrength","rightHandStrength","rightRemoteStrength","buttonPressedStrength","stretchingStrength","stretchSystem","stretcherLeft","stretcherRight","leftStrength","rightStrength","pulse","tempVec3","tempVec4","INSTANCE_DATA_BYTE_LENGTH","DEFAULT_COLOR","HIDE_MATRIX","makeScale","sizeofInstances","HubsBatchRawUniformGroup","BatchRawUniformGroup","maxInstances","ArrayBuffer","hubs_sweepParams","byteLength","hubs_interactorOnePos","hubs_isFrozen","Uint32Array","hubs_interactorTwoPos","hubs_time","instanceId","setInstanceTransform","setInstanceColor","isSpawner","hideDueToPinning","highlightInteractorOne","highlightInteractorTwo","MAX_INSTANCES","UBO_BYTE_LENGTH","BatchManagerSystem","WeakMap","WebGL2RenderingContext","getParameter","MAX_UNIFORM_BLOCK_SIZE","ubo","BatchManager","unlit","unlitBatchVert","unlitBatchFrag","rootObject","batchedCount","addMesh","removeMesh","LobbyCameraSystem","constraintsSystem","singleActionButtonSystem","holdableButtonSystem","hoverButtonSystem","hoverMenuSystem","superSpawnerSystem","hapticFeedbackSystem","SoundEffectsSystem","lobbyCameraSystem","_gotAudioTrack","_recorderTimeout","_initRecorder","_stream","_recorder","_tryAddingAudioTrack","multiviewVertPrefix","nonmultiviewVertPrefix","multiviewFragPrefix","nonmultiviewFragPrefix","didRegisterWithSystem","didFailToRegister","registered","updateUVs","normalizedFrame","memo","missingSprites","ret","raycastOnSprite","vA","vB","vC","vD","intersectionInfo","intersect","ray","intersectTriangle","getHoverableVisuals","comp","ZEROS","SpriteSystem","slots","indexWithSprite","maxSprites","spriteWithIndex","stack","concat","multiview","vert","frag","spritesheetPng","spritesheetTexture","RawShaderMaterial","u_spritesheet","mvCols","InterleavedBuffer","InterleavedBufferAttribute","indices","setIndex","createGeometry","renderOrder","RENDER_ORDER","HUD_ICONS","uniformsNeedUpdate","aEnableSweepingEffect","aSweepParams","enableSweepingEffectValue","setXY","aUvs","aVertices","setXYZ","hubsSystems","deltaScale","addScalar","clampScalar","HIGHLIGHT","NO_HIGHLIGHT","TRANSFORM_COLOR_1","TRANSFORM_COLOR_2","defaultDistance","minDistance","firstHitOnly","lineGeometry","Line","LineBasicMaterial","cameraPos","isGrabbing","addScaledVector","lerpHSL","posePosition","cursorPosition","positionArray","computeBoundingSphere","DRAW_MODE","drawFrequency","minDistanceBetweenPoints","drawingManager","availableColors","minRadius","maxRadius","timeSinceLastDraw","lastPosition","currentDrawing","worldPosition","colorIndex","grabbed","originalPosition","lastIntersectionDistance","MeshStandardMaterial","penTip","lineStartPosition","lineEndPosition","worldQuaternion","_startDraw","SOUND_PEN_START_DRAW","_endDraw","SOUND_PEN_STOP_DRAW","penScaleMod","_changeRadius","_changeColor","SOUND_PEN_CHANGE_COLOR","_undoDraw","SOUND_PEN_UNDO_DRAW","getLastWorldQuaternion","_setPenVisible","_setLineVisible","lastIntersectedObject","getLastPoint","_getNormal","draw","directionToCamera","crossVectors","startDraw","endDraw","undoDraw","mod","SharedBufferGeometry","primitiveMode","maxBufferSize","geometries","addBuffer","restartPrimitive","addVertex","prevIdx","componentSize","diff","undo","normals","colors","setDrawRange","addColor","g","addNormal","buffer","SharedBufferGeometryManager","sharedBuffers","addSharedBuffer","getSharedBuffer","copyData","fromIndex","toIndex","segments","defaultRadius","maxDrawTimeout","maxLines","maxPointsPerLine","_receiveData","networkBuffer","sendNetworkBufferQueue","drawStarted","lineStarted","remoteLineStarted","receivedBufferParts","bufferIndex","connectedToOwner","networkBufferInitialized","VertexColors","sharedBufferGeometryManager","lastPoint","lastSegments","currentSegments","sharedBuffer","vertexCount","networkBufferCount","currentPointCount","invalidPointRead","lastReadPointCount","networkBufferHistory","onConnect","getNetworkId","drawingId","subscribeToDataChannel","unsubscribeToDataChannel","isConnected","hasActiveDataChannel","sendDataGuaranteed","_broadcastDrawing","_drawFromNetwork","_sendNetworkBuffer","_deleteExpiredLines","copyArray","broadcastDataGuaranteed","didWork","pointCount","setHex","_draw","_updateBuffer","drawTime","datum","idxLength","uv","parts","ceil","dataType","_addToNetworkBuffer","getHexString","capNormal","radiusMultiplier","_generateSegments","_drawCylinder","_drawEndCap","_endLine","_addDegenerateTriangle","_restartPrimitive","_drawCap","_pushToNetworkBuffer","_drawPoint","projectedDirection","projectedPoint","clock","elapsedTime","copyDirection","copyNormal","setLength","getHex","_addVertex","down","segmentIndex","segment","segmentsList","angleIncrement","_rotatePointAroundAxis","calculatedDirection","registerNetworkSchemas","vectorRequiresUpdate","almostEqualVec3","schemas","requiresNetworkUpdate","BUILD_VERSION","patchWebGLRenderingContext","HUD_BACKGROUND","isEmbed","AmmoWasm","locateFile","firstSyncSource","syncSource","isTelemetryDisabled","loadingEnvironmentURL","registerTelemetry","instanceKey","started_at","onStorageEvent","detectConcurrentLoad","uiProps","routerBaseName","createBrowserHistory","basename","qsVREntryType","userinputSets","Router","Route","react_components_ui_root","hub_objectSpread","hub_isBotMode","hub_store","hub_mediaSearchStore","mountUI","updateUIForHub","entry_code","updateEnvironmentForHub","isLegacyBundle","environmentScene","model_url","defaultSpaceTopic","topics","glbAsset","asset_type","bundleAsset","hasExtension","baseURL","LoaderUtils","extractUrlBase","environmentEl","childNodes","Cache","messageDispatch","allowNAFTraffic","hubs","embedTokenEntry","executeOnLoadActions","onMediaSearchCancelled","objectsScene","objectsUrl","objectsEl","connectToScene","hub_asyncToGenerator","room","serverURL","newHostPollInterval","setReconnectionListeners","currentServerURL","serverUrl","newServerURL","getHost","sendViaPhoenix","reliable","isOpen","connectionState","reliableTransport","unreliableTransport","loadEnvironmentAndConnect","connectError","isFull","_ref12","_x17","enterSceneWhenLoaded","WebAssembly","detectedOS","ready","setRegistration","setRegistrationFailed","initialized","texImage2D","compressedTexImage2D","patchThreeAllocations","AuthChannel","predicate","messageId","onFailure","actionError","_x9","_x10","_x11","_x12","sceneInfo","isInOAuth","exitOAuth","clearOnLoadActions","serializableDetail","getTwitterOAuthURL","enqueueOnLoadAction","LinkChannel","handleEarlyVRMode","getVRDisplay","videoComponent","chatFocusTarget","RTCDataChannelEvent","buildNumber","hasVREntryDevice","onFirstEnvironmentLoad","previewCamera","reorder","setupLobbyCamera","runBotMode","retDeployReconnectInterval","retPhxChannel","_ref5","setVapidPublicKey","vapid_public_key","_x13","pushSubscriptionEndpoint","getCurrentEndpoint","oauthFlowPermsToken","Cookies","createHubChannelParams","push_subscription_endpoint","auth_token","migrateToNewReticulumServer","_ref6","deployNotification","ret_version","ret_pool","tryReconnect","oldSocket","setSocket","teardown","_x14","_x15","hubPhxChannel","SOUND_CHAT_MESSAGE","isInitialJoin","setPhoenixChannel","_ref9","session_token","vrHudPresenceCount","sendProfileUpdate","__hadInitialSync","isSelf","currentMeta","setClientId","setJoinToken","setHubChannel","setSubscribed","web_push","hub_requires_oauth","handleHubChannelJoined","_x16","oauth_info","onData","incomingMessage","userInfo","getAuthor","_createInWorldLogMessage","createInWorldLogMessage","stale_fields","titleParts","oldSlug","slug","entry_mode","_assets_sfx_tick_mp3__WEBPACK_IMPORTED_MODULE_0__","_assets_sfx_tick_mp3__WEBPACK_IMPORTED_MODULE_0___default","_assets_sfx_teleport_loop_mp3__WEBPACK_IMPORTED_MODULE_1__","_assets_sfx_teleport_loop_mp3__WEBPACK_IMPORTED_MODULE_1___default","_assets_sfx_quickTurn_mp3__WEBPACK_IMPORTED_MODULE_2__","_assets_sfx_quickTurn_mp3__WEBPACK_IMPORTED_MODULE_2___default","_assets_sfx_tap_mellow_mp3__WEBPACK_IMPORTED_MODULE_3__","_assets_sfx_tap_mellow_mp3__WEBPACK_IMPORTED_MODULE_3___default","_assets_sfx_PenSpawn_mp3__WEBPACK_IMPORTED_MODULE_4__","_assets_sfx_PenSpawn_mp3__WEBPACK_IMPORTED_MODULE_4___default","_assets_sfx_PenDraw1_mp3__WEBPACK_IMPORTED_MODULE_5__","_assets_sfx_PenDraw1_mp3__WEBPACK_IMPORTED_MODULE_5___default","_assets_sfx_PicSnapHey_mp3__WEBPACK_IMPORTED_MODULE_6__","_assets_sfx_PicSnapHey_mp3__WEBPACK_IMPORTED_MODULE_6___default","_assets_sfx_welcome_mp3__WEBPACK_IMPORTED_MODULE_7__","_assets_sfx_welcome_mp3__WEBPACK_IMPORTED_MODULE_7___default","_assets_sfx_quack_mp3__WEBPACK_IMPORTED_MODULE_8__","_assets_sfx_quack_mp3__WEBPACK_IMPORTED_MODULE_8___default","_assets_sfx_specialquack_mp3__WEBPACK_IMPORTED_MODULE_9__","_assets_sfx_specialquack_mp3__WEBPACK_IMPORTED_MODULE_9___default","_assets_sfx_pop_mp3__WEBPACK_IMPORTED_MODULE_10__","_assets_sfx_pop_mp3__WEBPACK_IMPORTED_MODULE_10___default","_assets_sfx_Eb_blip_mp3__WEBPACK_IMPORTED_MODULE_11__","_assets_sfx_Eb_blip_mp3__WEBPACK_IMPORTED_MODULE_11___default","_assets_sfx_tack_mp3__WEBPACK_IMPORTED_MODULE_12__","_assets_sfx_tack_mp3__WEBPACK_IMPORTED_MODULE_12___default","_assets_sfx_A_bendUp_mp3__WEBPACK_IMPORTED_MODULE_13__","_assets_sfx_A_bendUp_mp3__WEBPACK_IMPORTED_MODULE_13___default","_assets_sfx_suspense_mp3__WEBPACK_IMPORTED_MODULE_14__","_assets_sfx_suspense_mp3__WEBPACK_IMPORTED_MODULE_14___default","soundEnum","pendingEffects","soundsAndUrls","URL_TICK","URL_TELEPORT_LOOP","URL_QUICK_TURN","URL_TAP_MELLOW","URL_PEN_SPAWN","URL_PEN_DRAW","URL_CAMERA_SNAPSHOT","URL_WELCOME","URL_QUACK","URL_SPECIAL_QUACK","URL_POP","URL_FREEZE","URL_TACK","URL_MEDIA_LOADING","URL_MEDIA_LOADED","loading","audioBufferPromise","decodeAudioData","sounds","audioBuffer","enqueueSound","createBufferSource","createGain","TEXTURE_PROPS","base_map","emissive_map","normal_map","orm_map","ALL_MAPS","createRenderer","alpha","useDevicePixelRatio","antialias","premultipliedAlpha","preserveDrawingBuffer","powerPreference","WebGLRenderer","gammaOutput","gammaFactor","physicallyCorrectLights","setPixelRatio","devicePixelRatio","createImageBitmapFromURL","ORBIT_ANGLE","DEFAULT_MARGIN","fitBoxInFrustum","halfYExtents","halfVertFOV","fov","tan","AvatarPreview","clientWidth","clientHeight","OrbitControls","enablePan","HemisphereLight","loadPreviewAvatar","setAvatar","Clock","snapshotCanvas","snapshotCamera","snapshotRenderer","setClearAlpha","previewRenderer","setClearColor","getDelta","parentElement","setSize","resetCamera","getCenter","domElement","imageBitmaps","disposeImageBitmap","oldProps","applyMaps","previewMesh","idleAnimation","idleAnimationAction","getImage","onUpdate","originalMaps","bm","newProps","mapName","applyMap","applyMapToPreview","revertMap","react__WEBPACK_IMPORTED_MODULE_2___default","_assets_images_warning_icon_png__WEBPACK_IMPORTED_MODULE_0___default","_assets_images_warning_icon_2x_png__WEBPACK_IMPORTED_MODULE_1___default","react_intl__WEBPACK_IMPORTED_MODULE_4__","withRef","componentWillMount","react_intl__WEBPACK_IMPORTED_MODULE_2__","signInComplete","continueButton","signInForm","Sign_In_Message","emailField","terms","_dialog_container__WEBPACK_IMPORTED_MODULE_5__","media-browser","header-center","engine-attribution","engine-attribution-contents","favorites-header","search-clear","search-icon","no-search","nav-right-pad","nav-source","nav-source-selected","nav-scroll-arrow","tiles","tile","last-joined","lastJoined","tile-link","tileLink","tile-content","tileContent","avatar-tile","avatarTile","edit-avatar","create-tile","createTile","tiles-variable","tilesVariable","page-number","pageNumber","pager-button-disabled","pagerButtonDisabled","header-left","header-right","create-button","create-link","empty-string","media-browser-inline","mediaBrowserInline","email-field","next-button","continue-button","sign-in-form","sign-in-complete","ui-dialog","ui-interactive","presence-info","corner-button","profile-entry","form-submit","nag-corner-button","choose-scene-button","chooseSceneButton","choose-avatar","entry-button-secondary","entry-panel","button-container","secondary-action-button","leave-button","entry-button","action-button","collapse-button","favorite-button","favoriteButton","form-field-text","lobby-label","lobbyLabel","rename-button","renameButton","wide-button","screen-sharing","screenSharing","invite-tip","loading-text","streaming-tip","streaming-tip-attach-point","streaming-tip-close","streaming-tip-message","ui-dialog-box-contents","in-room-favorite-button","inRoomFavoriteButton","occupant-count","presence-info-selected","camera-mode-exit-button","corner-button-selected","invite-tip-attach-point","avatar-editor","display-name","entry-dialog","favorited","room-subtitle","lobby","profile-icon","profileIcon","button-subtitle","audio-loader","webvr-link-container","webvrLinkContainer","webvr-link","webvrLink","invite-container","link-button","enter-vr-button","invite-button","inviteButton","enter-button","invite-mini-button","embed-text","invite-container-inverted","embed-tip-wrap","embed-tip","hide-small-screens","hideSmallScreens","invite-container-below-hud","attach-point","keep-open","digit_2","digit2","digit_3","digit3","code-loading-panel","hub-link-link","embed-tip-attach-point","HubsTextureLoader","manager","DefaultLoadingManager","onLoad","imageLoader","ImageBitmapLoader","setCrossOrigin","setPath","cacheKey","resolveURL","loader","loadAsync","mediaAPIEndpoint","resolveUrlCache","media_utils_asyncToGenerator","resultPromise","Content-Type","response","ok","statusText","desiredContentType","formData","FormData","interactableId","needsToBeUploaded","fireLoadingTimeout","reader","FileReader","view","DataView","getUint16","marker","getUint32","little","readAsArrayBuffer","getOrientation","srcUrl","uploadPromotionTokens","objectTypeForOriginAndContentType","vertexRegex","fragRegex","shaderUniforms","newMaterial","onBeforeCompile","vlines","vindex","unshift","flines","findex","mediaHighlightFrag","mediaPos","snapCount","mirrorOrientation","rotateY","eventType","_createImageTexture","cancel-button","confirm-button","client-action-buttons","client-info-dialog","community-identifier","client-info","clientInfo","client-profile-image","client-details","clientDetails","client-main","clientMain","button-icon","small-button","input-border","left-side-of-input","add-media-form","cancel-icon","upload-icon","hide-file-input","spoke-launch","change-scene-button","changeSceneButton","spoke-create","avatar-url-dialog","close-button","name-field","room-settings-form","permissions-group","permission-disabled","tip-root","tip-link","tip-cancel","split-tip","split-tip-icon","spawn_menu-icon","spawnMenuIcon","object_rotate_button-icon","objectRotateButtonIcon","object_scale_button-icon","objectScaleButtonIcon","object_recenter_button-icon","objectRecenterButtonIcon","form-frame","leave-room","room-info","scene-screenshot","scene-details","scene-main","scene-name","scene-creator","scene-attributions","attribution-name","attribution-author","oauth-discord-button","oauth-twitter-button","oauth-button","oauth-type-name","oauth-icon","oauthIcon","privacy-notice","oauth-buttons","twitter-message","tweet-button","editor-inner","emoji-button","highlight","tweet-loader","dialog-background","message-entry-in-room","message-entry-spawn","message-entry-input","message-entry","message-entry-disabled","message-entry-button","message-entry-button-in-room","message-entry-upload","message-entry-input-in-room","message-entry-input-no-spawn","message-entry-on-mobile","command-help","presence-log","presence-log-entry","message-body","message-body-multi","message-body-mono","message-wrap","message-wrap-multi","message-source","message-source-link","icon-button","spawn-message","presence-log-entry-with-button","presence-log-in-room","presence-log-spawn","presence-log-entry-one-line","presence-log-emoji","client-link","presence-list","row-header","list-item","list-item-link","sign-in","moderator-badge","bottom-links-main","bottomLinksMain","bottom-links","bottomLinks","settings-menu","settings-row","load-button","hub-name","main-panel","tip-cancel-text","top-tip","column","attach_video_share_mode","attachVideoShareMode","attach_video_share_failed","attachVideoShareFailed","attach_pen_mode","attachPenMode","attach_mute_mode","attachMuteMode","attach_freeze_mode","attachFreezeMode","top-tip-no-hud","video-share-extra-options","small","large","video-share","freeze","mobile-media-picker","mobileMediaPicker","share_camera","shareCamera","share_screen","shareScreen","share_window","shareWindow","mic-0","mic-1","mic-2","mic-3","mic-4","mic-5","mic-6","mic-7","mic-off-0","mic-off-1","mic-off-2","mic-off-3","mic-off-4","mic-off-5","mic-off-6","mic-off-7","computeObjectAABB","boxRoot","isEmpty","matrixWorldNeedsUpdate","dZ","HelmetComponent","react_helmet__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_1__","react__WEBPACK_IMPORTED_MODULE_1___default","pageTitle","titleRoot","Page_Title_Root","sizes","Favicon","Social_Description","Social_Image","Twitter_Handle","Airtable","configure","endpointUrl","apiKey","base","firstPage","fields","records","modifiedTranslations","i18n_messages","navigatorLang","language","userLanguage","localeData","debug__WEBPACK_IMPORTED_MODULE_0__","debug__WEBPACK_IMPORTED_MODULE_0___default","_qs_truthy__WEBPACK_IMPORTED_MODULE_1__","logFilter","calculateVolume","getByteTimeDomainData","amplitude","currVolume","tempScaleFromPosition","tempScaleToPosition","fromObject","toObject","minScale","maxScale","prevVolume","_updateAnalysis","createAnalyser","fftSize","frequencyBinCount","soundSource","avatarIsQuiet","currentVolume","lastSeenVolume","connectAnalyser","_playerCamera","audioAnalyser","SPRITE_NAMES","MIC_HOVER","MIC_OFF_HOVER","loudest","prevSpriteName","decayingVolume","spriteName","verifyAuthentication","authTopic","authToken","authPayload","handleAuthCredentials","tempVector3","disposeMaterial","mtrl","lightMap","bumpMap","normalMap","specularMap","materialArray","MeshFaceMaterial","MultiMaterial","fn","emailParts","emailIdentity","emailDomain","dayjs","extend","relativeTime","PUBLISHER_FOR_ENTRY_TYPE","sketchfab_model","poly_model","twitch_stream","MediaTiles","isImage","isAvatar","imageAspect","imageWidth","imageHeight","isHub","getTileDimensions","publisherName","_state_link__WEBPACK_IMPORTED_MODULE_14__","_fortawesome_react_fontawesome__WEBPACK_IMPORTED_MODULE_6__","faExternalLinkAlt","react_intl__WEBPACK_IMPORTED_MODULE_5__","last_activated_at","fromNow","createTileWidth","createTileHeight","hasMeta","apiSource","isVariableWidth","hasNext","hasPrevious","entryToTile","previousPage","faAngleLeft","nextPage","originalGetExtension","WebGLRenderingContext","getExtension","supportsFloatTextures","dataTexture","DataTexture","FloatType","Camera","getError","checkFloatTextureSupport","names","selectRandom","arr","avatarIds","av","generateDefaultProfile","LOCAL_STORE_KEY","STORE_STATE_CACHE_KEY","OAUTH_FLOW_CREDENTIALS_KEY","validator","Validator","additionalProperties","personalAvatarId","confirmedDiscordRooms","onLoadActions","$ref","oauthFlowCredentials","getJSON","resetConfirmedBroadcastedRooms","clearStoredArray","resetTipActivityFlags","currentEntryCount","arrayMerge","destinationArray","sourceArray","mergeOpts","finalState","validate","deriveKey","privateKey","publicKey","crypto","subtle","public","publicKeyToString","exportKey","stringToPublicKey","importKey","namedCurve","stringToArrayBuffer","buf","arrayBufferToString","keyPair","generateKey","publicKeyString","incomingPublicKeyString","iv","incomingPublicKey","secret","encryptedData","encrypt","base64value","ciphertext","decrypt","LINK_ACTION_TIMEOUT","getLetter","readyToSend","leftChannel","leave","incoming","_generatePublicKeyAndEncryptedObject","generatePublicKeyAndEncryptedObject","public_key","target_session_id","reply_to_session_id","_generateKeys","generateKeys","numOccupants","_x7","_x8","_decryptObject","decryptObject","_fullscreen__WEBPACK_IMPORTED_MODULE_1__","isExitingFullscreenDueToFocus","URL_IMAGE","URL_VIDEO","URL_MODEL","URL_PDF","URL_AUDIO","FILE_IMAGE","FILE_VIDEO","FILE_MODEL","FILE_PDF","FILE_AUDIO","CLIPBOARD_IMAGE","CLIPBOARD_VIDEO","CLIPBOARD_MODEL","CLIPBOARD_PDF","CLIPBOARD_AUDIO","SPAWNER_IMAGE","SPAWNER_VIDEO","SPAWNER_MODEL","SPAWNER_PDF","SPAWNER_AUDIO","UNKNOWN","objectTypeForOrigin","urlType","fileType","clipboardType","spawnerType","objectTypeMimePrefixLookupMap","image/","model/","application/x-zip-compressed","video/","application/vnd.apple.mpegurl","application/x-mpegurl","audio/","application/pdf","srcSuffixLookupMap",".m3u8","raven_js__WEBPACK_IMPORTED_MODULE_0__","raven_js__WEBPACK_IMPORTED_MODULE_0___default","ga","trackedPage","trackedTitle","sentryDsn","SENTRY_DSN","gaTrackingId","GA_TRACKING_ID","Raven","install","_qs_truthy__WEBPACK_IMPORTED_MODULE_0__","showLog","debugLog","debugLogInput","debugLogEval","onsubmit","eval","minimized","debugLogMinimize","onclick","scrollHeight","origConsoleLog","origConsoleError","origConsoleWarn","objs","firstObj","shouldScroll","onunhandledrejection","zeroPos","zeroQuat","oneScale","bindingSetters","PropertyBinding","SetterByBindingTypeAndVersioning","Versioning","setter","MatrixWorldNeedsUpdate","targetObject","getWorldScale","handleMatrixModification","cachedMatrixWorld","applyMatrix","forceLocalUpdate","forceWorldUpdate","skipParents","hasHadFirstMatrixUpdate","childrenNeedMatrixWorldUpdate","forceChildrenWorldUpdate","q1","m1","isVector3","isCamera","isLight","extractRotation","animation","colorHelperFrom","colorHelperTo","getComponentProperty","setComponentProperty","splitCache","TYPE_COLOR","STRING_COMPONENTS","STRING_OBJECT3D","toRadians","addEventListeners","eventNames","removeEventListeners","getRawProperty","splitDot","setRawProperty","propertyName","targetValue","startEvents","pauseEvents","resumeEvents","eventDetail","animationIsPlaying","onStartEvent","beginAnimation","pauseAnimation","resumeAnimation","fromColor","toColor","targetsArray","updateConfigForDefault","updateConfigForRawColor","createAndStartAnimation","cancelDelayedStart","pausedWasPlaying","updateConfig","delayTimeout","stopRelatedAnimations","waitComponentInitRawProperty","setColorConfig","isBoolean","isNaN","parseFloat","aframeProperty","updateConfigForVector","coordinates","propType","getPropertyType","cb","wait","AmbientLight","initialForce","maxForce","hasBody","CANNON","Vec3","applyForce","generateAndAddHeightfield","shape","mult","cannonOffset","Heightfield","elementSize","addShape","skyColor","groundColor","onQualityChanged","PointLight","innerConeAngle","outerConeAngle","SpotLight","penumbra","autoLockOnLoad","autoLockOnRelease","gravitySpeedLimit","onGrab","onRelease","ammoBody","_makeStaticWhenAtRest","linearThreshold","angularThreshold","isAtRest","getLinearVelocity","length2","getAngularVelocity","hasBeenHereBefore","_onBodyLoaded","setLocked","getVelocity","stuckTo","_unstickObject","sizeVec","boundingBoxWorldPositionVec","colliderWorldPositionVec","collidingLastFrame","setFromCenterAndSize","isColliding","onVideoLoaded","origDispatch","firstObject","toDataURL","imageBitmap","HTMLImageElement","Pathfinding","Geometry","fromBufferGeometry","setZoneData","createZone","eventSource","eventListeners","_handleEvent","ReactAudioContext","WithHoverSound","react__WEBPACK_IMPORTED_MODULE_0__","prop_types__WEBPACK_IMPORTED_MODULE_1__","prop_types__WEBPACK_IMPORTED_MODULE_1___default","createContext","Consumer","cloneElement","onMouseEnter","networkedTemplate"],"mappings":"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E,GAAAroD,EAAAlvB,cAAA,OAAKm6B,UAAWqiB,KAAW,CAAE9oB,CAACstB,KAAO83C,cAAc,EAAMplE,CAACstB,KAAO+3C,kBAAmBv4F,KAAK44B,MAAM4/D,SAC5FH,EAAS1vF,IACR/K,IACiC,KAA9BoC,KAAK44B,MAAM6/D,gBACV76F,EAAEuwB,MAAM,KAAK,GAAGjX,WAAWlX,KAAK44B,MAAM6/D,eAAetqE,MAAM,KAAK,MAChE4oD,GAAAroD,EAAAlvB,cAAA,OAAKm6B,UAAW6mB,KAAOm8B,MAAO99E,IAAKjB,GACjCm5E,GAAAroD,EAAAlvB,cAAA,OAAKm6B,UAAW6mB,KAAOk4C,SAAvB,IAAkC96F,GAClCm5E,GAAAroD,EAAAlvB,cAAA,WACEu3E,GAAAroD,EAAAlvB,cAAC63E,GAAA,EAAD,CAAkB3kE,eAAgB9U,EAAEuwB,MAAM,KAAK,2HAhC5CiqE,eACA,CACjBK,eAAgB1+D,KAAUE,OAC1Bu+D,MAAOz+D,KAAUC,uFCPrB,MAAM2+D,GAAyB,GAGzBC,GAAc,CAClBC,MAAM,EACNC,MAAM,EACNC,MAAM,EACNC,MAAM,EACNC,SAAS,EACTC,UAAU,EACVC,OAAO,EACPC,QAAQ,EACRC,OAAO,EACPC,OAAO,GAKHC,GAAW,CACf,IACA,OACA,UACA,OACA,UACA,QACA,QACA,IACA,OACA,MACA,MACA,aACA,OACA,KACA,SACA,SACA,UACA,SACA,OACA,OACA,MACA,WACA,UACA,WACA,KACA,MACA,UACA,MACA,MACA,KACA,KACA,KACA,QACA,WACA,aACA,SACA,OACA,SACA,OACA,KACA,KACA,KACA,KACA,KACA,KACA,OACA,SACA,SACA,KACA,OACA,IACA,SACA,MACA,QACA,MACA,MACA,SACA,QACA,SACA,KACA,OACA,MACA,OACA,OACA,OACA,OACA,QACA,MACA,OACA,WACA,SACA,KACA,SACA,WACA,SACA,IACA,QACA,MACA,WACA,IACA,KACA,KACA,OACA,IACA,OACA,SACA,UACA,SACA,QACA,SACA,OACA,SACA,QACA,MACA,UACA,MACA,MACA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","file":"assets/js/hub-32f7bf605fe863592567.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t6: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([2157,1,0]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import { Socket } from \"phoenix\";\nimport { generateHubName } from \"../utils/name-generation\";\nimport { getAirtableAssets, airtableAssetsInitialState } from '../everyspace/airtable'\n\nimport Store from \"../storage/store\";\n\nconst resolverLink = document.createElement(\"a\");\nexport function getReticulumFetchUrl(path, absolute = false) {\n  if (process.env.RETICULUM_SERVER) {\n    return `https://${process.env.RETICULUM_SERVER}${path}`;\n  } else if (absolute) {\n    resolverLink.href = path;\n    return resolverLink.href;\n  } else {\n    return path;\n  }\n}\n\nlet reticulumMeta = null;\nlet invalidatedReticulumMetaThisSession = false;\n\nexport async function invalidateReticulumMeta() {\n  invalidatedReticulumMetaThisSession = true;\n  reticulumMeta = null;\n}\n\nexport async function getReticulumMeta() {\n  if (!reticulumMeta) {\n    // Initially look up version based upon page, avoiding round-trip, otherwise fetch.\n    if (!invalidatedReticulumMetaThisSession && document.querySelector(\"meta[name='ret:version']\")) {\n      reticulumMeta = {\n        version: document.querySelector(\"meta[name='ret:version']\").getAttribute(\"value\"),\n        pool: document.querySelector(\"meta[name='ret:pool']\").getAttribute(\"value\"),\n        phx_host: document.querySelector(\"meta[name='ret:phx_host']\").getAttribute(\"value\")\n      };\n    } else {\n      await fetch(getReticulumFetchUrl(\"/api/v1/meta\")).then(async res => {\n        reticulumMeta = await res.json();\n      });\n    }\n  }\n\n  const qs = new URLSearchParams(location.search);\n  const phxHostOverride = qs.get(\"phx_host\");\n\n  if (phxHostOverride) {\n    reticulumMeta.phx_host = phxHostOverride;\n  }\n\n  return reticulumMeta;\n}\n\nexport async function connectToReticulum(debug = false, params = null) {\n  const qs = new URLSearchParams(location.search);\n\n  const getNewSocketUrl = async () => {\n    const socketProtocol = qs.get(\"phx_protocol\") || (document.location.protocol === \"https:\" ? \"wss:\" : \"ws:\");\n    let socketHost = qs.get(\"phx_host\");\n    let socketPort = qs.get(\"phx_port\");\n\n    const reticulumMeta = await getReticulumMeta();\n    socketHost = socketHost || process.env.RETICULUM_SOCKET_SERVER || reticulumMeta.phx_host;\n    socketPort =\n      socketPort ||\n      (process.env.RETICULUM_SERVER ? new URL(`${socketProtocol}//${process.env.RETICULUM_SERVER}`).port : \"443\");\n    return `${socketProtocol}//${socketHost}${socketPort ? `:${socketPort}` : \"\"}`;\n  };\n\n  const socketUrl = await getNewSocketUrl();\n  console.log(`Phoenix Socket URL: ${socketUrl}`);\n\n  const socketSettings = {};\n\n  if (debug) {\n    socketSettings.logger = (kind, msg, data) => {\n      console.log(`${kind}: ${msg}`, data);\n    };\n  }\n\n  if (params) {\n    socketSettings.params = params;\n  }\n\n  const socket = new Socket(`${socketUrl}/socket`, socketSettings);\n  socket.connect();\n  socket.onError(async () => {\n    // On error, underlying reticulum node may have died, so rebalance by\n    // fetching a new healthy node to connect to.\n    invalidateReticulumMeta();\n\n    const endPointPath = new URL(socket.endPoint).pathname;\n    const newSocketUrl = await getNewSocketUrl();\n    const newEndPoint = `${newSocketUrl}${endPointPath}`;\n    console.log(`Socket error, changed endpoint to ${newEndPoint}`);\n    socket.endPoint = newEndPoint;\n  });\n\n  return socket;\n}\n\nexport function getLandingPageForPhoto(photoUrl) {\n  const parsedUrl = new URL(photoUrl);\n  return getReticulumFetchUrl(parsedUrl.pathname.replace(\".png\", \".html\") + parsedUrl.search, true);\n}\n\nexport function fetchReticulumAuthenticated(url, method = \"GET\", payload) {\n  const { token } = window.APP.store.state.credentials;\n  const retUrl = getReticulumFetchUrl(url);\n  const params = {\n    headers: { \"content-type\": \"application/json\" },\n    method\n  };\n  if (token) {\n    params.headers.authorization = `bearer ${token}`;\n  }\n  if (payload) {\n    params.body = JSON.stringify(payload);\n  }\n  return fetch(retUrl, params).then(async r => {\n    const result = await r.text();\n    try {\n      return JSON.parse(result);\n    } catch (e) {\n      // Some reticulum responses, particularly DELETE requests, don't return json.\n      return result;\n    }\n  });\n}\n\nexport async function createAndRedirectToNewHub(name, sceneId, sceneUrl, replace) {\n  const createUrl = getReticulumFetchUrl(\"/api/v1/hubs\");\n\n  let assets = {Name: \"Test\", SceneUrl: null};\n    \n  assets = await getAirtableAssets();\n  \n  // const record = await airtableAssets.find('recHqITRS7cBMwn9i')\n\n  // if (record) assets = record.fields;\n  \n  // const payload = { hub: { name: name || generateHubName() } };\n  const payload = { hub: { name: assets.Name } };\n  \n\n  // if (sceneId) {\n    // payload.hub.scene_id = sceneId;\n  // } else {\n    // payload.hub.default_environment_gltf_bundle_url = sceneUrl;\n  // }\n    \n  payload.hub.default_environment_gltf_bundle_url = assets.SceneUrl;\n    \n\n  const headers = { \"content-type\": \"application/json\" };\n  const store = new Store();\n  if (store.state && store.state.credentials.token) {\n    headers.authorization = `bearer ${store.state.credentials.token}`;\n  }\n\n  let res = await fetch(createUrl, {\n    body: JSON.stringify(payload),\n    headers,\n    method: \"POST\"\n  }).then(r => r.json());\n\n  if (res.error === \"invalid_token\") {\n    // Clear the invalid token from store.\n    store.update({ credentials: { token: null, email: null } });\n\n    // Create hub anonymously\n    delete headers.authorization;\n    res = await fetch(createUrl, {\n      body: JSON.stringify(payload),\n      headers,\n      method: \"POST\"\n    }).then(r => r.json());\n  }\n\n  const hub = res;\n  let url = hub.url;\n\n  const creatorAssignmentToken = hub.creator_assignment_token;\n  if (creatorAssignmentToken) {\n    store.update({ creatorAssignmentTokens: [{ hubId: hub.hub_id, creatorAssignmentToken: creatorAssignmentToken }] });\n\n    // Don't need to store the embed token if there's no creator assignment token, since that means\n    // we are the owner and will get the embed token on page load.\n    const embedToken = hub.embed_token;\n\n    if (embedToken) {\n      store.update({ embedTokens: [{ hubId: hub.hub_id, embedToken: embedToken }] });\n    }\n  }\n\n  if (process.env.RETICULUM_SERVER && document.location.host !== process.env.RETICULUM_SERVER) {\n    url = `/hub.html?hub_id=${hub.hub_id}`;\n  }\n\n  if (replace) {\n    document.location.replace(url);\n  } else {\n    document.location = url;\n  }\n}\n\nexport function getPresenceEntryForSession(presences, sessionId) {\n  const entry = Object.entries(presences || {}).find(([k]) => k === sessionId) || [];\n  const presence = entry[1];\n  return (presence && presence.metas && presence.metas[0]) || {};\n}\n\nexport function getPresenceContextForSession(presences, sessionId) {\n  return (getPresenceEntryForSession(presences, sessionId) || {}).context || {};\n}\n\nexport function getPresenceProfileForSession(presences, sessionId) {\n  return (getPresenceEntryForSession(presences, sessionId) || {}).profile || {};\n}\n\n// Takes the given channel, and creates a new channel with the same bindings\n// with the given socket, joins it, and leaves the old channel after joining.\n//\n// NOTE: This function relies upon phoenix channel object internals, so this\n// function will need to be reviewed if/when we ever update phoenix.js\nexport function migrateChannelToSocket(oldChannel, socket, params) {\n  const channel = socket.channel(oldChannel.topic, params || oldChannel.params);\n\n  for (let i = 0, l = oldChannel.bindings.length; i < l; i++) {\n    const item = oldChannel.bindings[i];\n    channel.on(item.event, item.callback);\n  }\n\n  for (let i = 0, l = oldChannel.pushBuffer.length; i < l; i++) {\n    const item = oldChannel.pushBuffer[i];\n    channel.push(item.event, item.payload, item.timeout);\n  }\n\n  const oldJoinPush = oldChannel.joinPush;\n  const joinPush = channel.join();\n\n  for (let i = 0, l = oldJoinPush.recHooks.length; i < l; i++) {\n    const item = oldJoinPush.recHooks[i];\n    joinPush.receive(item.status, item.callback);\n  }\n\n  return new Promise(resolve => {\n    joinPush.receive(\"ok\", () => {\n      // Clear all event handlers first so no duplicate messages come in.\n      oldChannel.bindings = [];\n      resolve(channel);\n    });\n  });\n}\n\nexport function discordBridgesForPresences(presences) {\n  const channels = [];\n  for (const p of Object.values(presences)) {\n    for (const m of p.metas) {\n      if (m.profile && m.profile.discordBridges) {\n        Array.prototype.push.apply(channels, m.profile.discordBridges.map(b => b.channel.name));\n      }\n    }\n  }\n  return channels;\n}\n","const boundingBox = new THREE.Box3();\nconst frustumBox = new THREE.Box3();\nconst inverseLightMatrixWorld = new THREE.Matrix4();\nconst tempBox = new THREE.Box3();\nconst FRUSTUM_PADDING = 1;\nconst NEAR_CLIPPING_PLANE = -500;\nconst FAR_CLIPPING_PLANE = 500;\nconst verts = [\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3(),\n  new THREE.Vector3()\n];\n\nexport default function resizeShadowCameraFrustum(light, scene) {\n  // Reset bounding box\n  frustumBox.makeEmpty();\n  boundingBox.makeEmpty();\n\n  // Grow the extents of boundingBox for every geometry in the scene that has castShadow set to true.\n  scene.traverse(node => {\n    const geometry = node.geometry;\n\n    if (geometry && node.castShadow) {\n      if (!geometry.boundingBox) {\n        geometry.computeBoundingBox();\n      }\n\n      tempBox.copy(geometry.boundingBox);\n\n      // Apply matrix transforming bounding box from model space to world space\n      tempBox.applyMatrix4(node.matrixWorld);\n\n      boundingBox.union(tempBox);\n    }\n  });\n\n  // Transform the resulting bounding box from world space to light space.\n  // Construct a new bounding box in light space that contains the corners of the bounding box in world space.\n  const min = boundingBox.min;\n  const max = boundingBox.max;\n\n  verts[0].set(min.x, min.y, min.z);\n  verts[1].set(min.x, min.y, max.z);\n  verts[2].set(min.x, max.y, min.z);\n  verts[3].set(min.x, max.y, max.z);\n  verts[4].set(max.x, min.y, min.z);\n  verts[5].set(max.x, min.y, max.z);\n  verts[6].set(max.x, max.y, min.z);\n  verts[7].set(max.x, max.y, max.z);\n\n  inverseLightMatrixWorld.getInverse(light.shadow.camera.matrixWorld);\n\n  for (let i = 0; i < verts.length; i++) {\n    verts[i].applyMatrix4(inverseLightMatrixWorld);\n    frustumBox.expandByPoint(verts[i]);\n  }\n\n  // Update the camera frustum to fit the resulting bounding box.\n  // Everything in the frustum that has castShadow set to true will cast a shadow.\n  // Everything in the frustum that has receiveShadow set to true will receive a shadow.\n  // FRUSTUM_PADDING is added to avoid clipping the edges of shadows.\n  // TODO: Determine why shadows flicker when light is moved fast. The light's matrixWorld is probably being updated a frame behind.\n  const camera = light.shadow.camera;\n  camera.left = frustumBox.min.x - FRUSTUM_PADDING;\n  camera.right = frustumBox.max.x + FRUSTUM_PADDING;\n  camera.bottom = frustumBox.min.y - FRUSTUM_PADDING;\n  camera.top = frustumBox.max.y + FRUSTUM_PADDING;\n  camera.near = frustumBox.min.z + NEAR_CLIPPING_PLANE;\n  camera.far = frustumBox.max.z + FAR_CLIPPING_PLANE;\n  camera.updateProjectionMatrix();\n}\n","import resizeShadowCameraFrustum from \"../utils/resizeShadowCameraFrustum\";\n\nAFRAME.registerComponent(\"directional-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 },\n    castShadow: { default: true },\n    shadowMapResolution: { default: [512, 512] },\n    shadowBias: { default: 0 },\n    shadowRadius: { default: 1 }\n  },\n\n  init() {\n    const el = this.el;\n    this.light = new THREE.DirectionalLight();\n    this.light.position.set(0, 0, 0);\n    this.light.target.position.set(0, 0, 1);\n    this.light.add(this.light.target);\n    this.el.setObject3D(\"directional-light\", this.light);\n    this.el.sceneEl.systems.light.registerLight(el);\n    this.rendererSystem = this.el.sceneEl.systems.renderer;\n  },\n\n  update(prevData) {\n    const light = this.light;\n\n    if (this.data.color !== prevData.color) {\n      const color = new THREE.Color(this.data.color);\n      this.rendererSystem.applyColorCorrection(color);\n      light.color.copy(color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      light.intensity = this.data.intensity;\n    }\n\n    if (this.data.castShadow !== prevData.castShadow) {\n      light.castShadow = this.data.castShadow;\n    }\n\n    if (this.data.shadowBias !== prevData.shadowBias) {\n      light.shadow.bias = this.data.shadowBias;\n    }\n\n    if (this.data.shadowRadius !== prevData.shadowRadius) {\n      light.shadow.radius = this.data.shadowRadius;\n    }\n\n    const [width, height] = this.data.shadowMapResolution;\n    const [prevWidth, prevHeight] = prevData.shadowMapResolution ? prevData.shadowMapResolution : [512, 512];\n\n    if (width !== prevWidth || height !== prevHeight) {\n      light.shadow.mapSize.set(width, height);\n\n      if (light.shadow.map) {\n        light.shadow.map.dispose();\n        light.shadow.map = null;\n      }\n    }\n\n    this.light.shadow.camera.matrixNeedsUpdate = true;\n  },\n\n  tick() {\n    if (window.APP && window.APP.quality === \"low\") {\n      return;\n    }\n\n    resizeShadowCameraFrustum(this.light, this.el.sceneEl.object3D);\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"directional-light\");\n  }\n});\n","export const Layers = {\n  // Layers 0 - 2 reserverd by ThreeJS and AFrame.\n  reflection: 3\n};\n\n/**\n * Sets layer flags on the underlying Object3D\n * @namespace environment\n * @component layers\n */\nAFRAME.registerComponent(\"layers\", {\n  schema: {\n    reflection: { type: \"boolean\", default: false },\n    inWorldHud: { type: \"boolean\", default: false },\n    exclusive: { type: \"boolean\", default: false } // if true, only these layers will be set\n  },\n  init() {\n    this.update = this.update.bind(this);\n    this.el.addEventListener(\"model-loaded\", this.update);\n  },\n  update(oldData) {\n    const obj = this.el.object3D;\n\n    if (this.data.exclusive) {\n      obj.traverse(o => (o.layers.mask = 0));\n    }\n\n    for (const [name, layer] of Object.entries(Layers)) {\n      const oldValue = oldData[name];\n      const newValue = this.data[name];\n\n      if (oldValue !== newValue) {\n        if (newValue) {\n          obj.traverse(o => o.layers.enable(layer));\n        } else {\n          obj.traverse(o => o.layers.disable(layer));\n        }\n      }\n    }\n  },\n  remove() {\n    this.el.removeEventListener(\"model-loaded\", this.update);\n  }\n});\n","import { findAncestorWithComponent } from \"../utils/scene-graph\";\n\n/**\n * Loops the given clip using this entity's animation mixer\n * @component loop-animation\n */\nAFRAME.registerComponent(\"loop-animation\", {\n  schema: {\n    paused: { type: \"boolean\", default: false },\n    clip: { type: \"string\" }\n  },\n\n  init() {\n    this.mixerEl = findAncestorWithComponent(this.el, \"animation-mixer\");\n\n    if (!this.mixerEl) {\n      console.warn(\"loop-animation component could not find an animation-mixer in its ancestors.\");\n      return;\n    }\n\n    this.updateClip();\n  },\n\n  update(oldData) {\n    if ((oldData.clip !== this.data.clip || oldData.paused !== this.data.paused) && this.mixerEl) {\n      if (oldData.clip !== this.data.clip) {\n        this.updateClip();\n      }\n\n      if (this.currentAction) {\n        this.currentAction.paused = this.data.paused;\n      }\n    }\n  },\n\n  updateClip() {\n    const { mixer, animations } = this.mixerEl.components[\"animation-mixer\"];\n    const clipName = this.data.clip;\n\n    if (animations.length === 0) {\n      return;\n    }\n\n    let clip;\n\n    if (!clipName) {\n      clip = animations[0];\n    } else {\n      clip = animations.find(({ name }) => name === clipName);\n    }\n\n    if (!clip) {\n      return;\n    }\n\n    const action = mixer.clipAction(clip, this.el.object3D);\n    action.enabled = true;\n    action.setLoop(THREE.LoopRepeat, Infinity).play();\n    this.currentAction = action;\n  },\n\n  destroy() {\n    if (this.currentAction) {\n      this.currentAction.enabled = false;\n      this.currentAction.stop();\n    }\n  }\n});\n","import { getBox, getScaleCoefficient } from \"../utils/auto-box-collider\";\nimport { resolveUrl, injectCustomShaderChunks } from \"../utils/media-utils\";\nimport {\n  guessContentType,\n  proxiedUrlFor,\n  isHubsRoomUrl,\n  isHubsSceneUrl,\n  isHubsAvatarUrl\n} from \"../utils/media-url-utils\";\nimport { addAnimationComponents } from \"../utils/animation\";\nimport qsTruthy from \"../utils/qs_truthy\";\n\nimport \"three/examples/js/loaders/GLTFLoader\";\nimport loadingObjectSrc from \"../assets/LoadingObject_Atom.glb\";\nimport { SOUND_MEDIA_LOADING, SOUND_MEDIA_LOADED } from \"../systems/sound-effects-system\";\n\nimport anime from \"animejs\";\n\nconst SHAPE = require(\"aframe-physics-system/src/constants\").SHAPE;\n\nconst gltfLoader = new THREE.GLTFLoader();\nlet loadingObjectEnvMap;\nlet loadingObject;\ngltfLoader.load(loadingObjectSrc, gltf => {\n  loadingObject = gltf;\n});\n\nconst fetchContentType = url => {\n  return fetch(url, { method: \"HEAD\" }).then(r => r.headers.get(\"content-type\"));\n};\n\nconst fetchMaxContentIndex = url => {\n  return fetch(url).then(r => parseInt(r.headers.get(\"x-max-content-index\")));\n};\n\nconst boundingBox = new THREE.Box3();\n\nconst batchMeshes = qsTruthy(\"batchMeshes\");\nconst disableBatching = qsTruthy(\"disableBatching\");\n\nAFRAME.registerComponent(\"media-loader\", {\n  schema: {\n    fileId: { type: \"string\" },\n    fileIsOwned: { type: \"boolean\" },\n    src: { type: \"string\" },\n    resize: { default: false },\n    resolve: { default: false },\n    contentType: { default: null },\n    contentSubtype: { default: null },\n    animate: { default: true },\n    mediaOptions: {\n      default: {},\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\n      stringify: JSON.stringify\n    }\n  },\n\n  init() {\n    this.onError = this.onError.bind(this);\n    this.showLoader = this.showLoader.bind(this);\n    this.clearLoadingTimeout = this.clearLoadingTimeout.bind(this);\n    this.onMediaLoaded = this.onMediaLoaded.bind(this);\n    this.animating = false;\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.networkedEl = networkedEl;\n    });\n  },\n\n  updateScale: (function() {\n    const center = new THREE.Vector3();\n    return function(resize) {\n      const mesh = this.el.getObject3D(\"mesh\");\n      const box = getBox(this.el, mesh);\n      const scaleCoefficient = resize ? getScaleCoefficient(0.5, box) : 1;\n      mesh.scale.multiplyScalar(scaleCoefficient);\n      const { min, max } = box;\n      center.addVectors(min, max).multiplyScalar(0.5 * scaleCoefficient);\n      mesh.position.sub(center);\n      mesh.matrixNeedsUpdate = true;\n    };\n  })(),\n\n  removeShape(id) {\n    if (this.el.getAttribute(\"ammo-shape__\" + id)) {\n      this.el.removeAttribute(\"ammo-shape__\" + id);\n    }\n  },\n\n  tick(t, dt) {\n    if (this.loaderMixer) {\n      this.loaderMixer.update(dt / 1000);\n    }\n  },\n\n  remove() {\n    if (this.loadingSoundNode) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.stopSoundNode(this.loadingSoundNode);\n      this.loadingSoundNode = null;\n    }\n  },\n\n  onError() {\n    this.el.removeAttribute(\"gltf-model-plus\");\n    this.el.removeAttribute(\"media-pager\");\n    this.el.removeAttribute(\"media-video\");\n    this.el.setAttribute(\"media-image\", { src: \"error\" });\n    this.clearLoadingTimeout();\n  },\n\n  showLoader() {\n    if (this.el.object3DMap.mesh) {\n      this.clearLoadingTimeout();\n      return;\n    }\n    const useFancyLoader = !!loadingObject;\n\n    const mesh = useFancyLoader\n      ? loadingObject.scene.clone()\n      : new THREE.Mesh(new THREE.BoxGeometry(), new THREE.MeshBasicMaterial());\n    this.el.setObject3D(\"mesh\", mesh);\n\n    this.updateScale(true);\n\n    if (useFancyLoader) {\n      const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\n      const currentEnivronmentMap = environmentMapComponent.environmentMap;\n      if (loadingObjectEnvMap !== currentEnivronmentMap) {\n        environmentMapComponent.applyEnvironmentMap(mesh);\n        loadingObjectEnvMap = currentEnivronmentMap;\n      }\n\n      this.loaderMixer = new THREE.AnimationMixer(mesh);\n\n      this.loadingClip = this.loaderMixer.clipAction(loadingObject.animations[0]);\n      this.loadingScaleClip = this.loaderMixer.clipAction(\n        new THREE.AnimationClip(null, 1000, [\n          new THREE.VectorKeyframeTrack(\".scale\", [0, 0.2], [0, 0, 0, mesh.scale.x, mesh.scale.y, mesh.scale.z])\n        ])\n      );\n      setTimeout(() => {\n        if (!this.loaderMixer) return; // Animation/loader was stopped early\n        this.el.setAttribute(\"ammo-shape__loader\", { type: SHAPE.BOX });\n      }, 200);\n\n      this.loadingClip.play();\n      this.loadingScaleClip.play();\n    }\n\n    if (this.el.sceneEl.is(\"entered\") && (!this.networkedEl || NAF.utils.isMine(this.networkedEl))) {\n      this.loadingSoundNode = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundLooped(\n        SOUND_MEDIA_LOADING\n      );\n    }\n\n    delete this.showLoaderTimeout;\n  },\n\n  clearLoadingTimeout() {\n    clearTimeout(this.showLoaderTimeout);\n    if (this.loadingSoundNode) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.stopSoundNode(this.loadingSoundNode);\n      this.loadingSoundNode = null;\n    }\n    if (this.loaderMixer) {\n      this.loadingClip.stop();\n      this.loadingScaleClip.stop();\n      delete this.loaderMixer;\n      delete this.loadingScaleClip;\n      delete this.loadingClip;\n    }\n    delete this.showLoaderTimeout;\n    this.removeShape(\"loader\");\n  },\n\n  updateHoverableVisuals() {\n    const hoverableVisuals = this.el.components[\"hoverable-visuals\"];\n\n    if (hoverableVisuals) {\n      if (!this.injectedCustomShaderChunks) {\n        this.injectedCustomShaderChunks = true;\n        hoverableVisuals.uniforms = injectCustomShaderChunks(this.el.object3D);\n      }\n\n      boundingBox.setFromObject(this.el.object3DMap.mesh);\n      boundingBox.getBoundingSphere(hoverableVisuals.boundingSphere);\n    }\n  },\n\n  onMediaLoaded(physicsShape = null, shouldUpdateScale) {\n    const el = this.el;\n    this.clearLoadingTimeout();\n\n    if (this.el.sceneEl.is(\"entered\")) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_MEDIA_LOADED);\n    }\n\n    const finish = () => {\n      this.animating = false;\n\n      if (physicsShape) {\n        el.setAttribute(\"ammo-shape\", {\n          type: physicsShape,\n          minHalfExtent: 0.04\n        });\n      }\n\n      this.updateHoverableVisuals();\n\n      const pager = el.components[\"media-pager\"];\n\n      if (pager) {\n        pager.repositionToolbar();\n      }\n    };\n\n    if (this.data.animate) {\n      if (!this.animating) {\n        this.animating = true;\n        if (shouldUpdateScale) this.updateScale(this.data.resize);\n        const mesh = this.el.getObject3D(\"mesh\");\n        const scale = { x: 0.001, y: 0.001, z: 0.001 };\n        scale.x = mesh.scale.x < scale.x ? mesh.scale.x * 0.001 : scale.x;\n        scale.y = mesh.scale.y < scale.y ? mesh.scale.x * 0.001 : scale.y;\n        scale.z = mesh.scale.z < scale.z ? mesh.scale.x * 0.001 : scale.z;\n        this.addMeshScaleAnimation(mesh, scale, finish);\n      }\n    } else {\n      if (shouldUpdateScale) this.updateScale(this.data.resize);\n      finish();\n    }\n  },\n\n  addMeshScaleAnimation(mesh, initialScale, onComplete) {\n    const step = (function() {\n      const lastValue = {};\n      return function(anim) {\n        const value = anim.animatables[0].target;\n\n        value.x = Math.max(Number.MIN_VALUE, value.x);\n        value.y = Math.max(Number.MIN_VALUE, value.y);\n        value.z = Math.max(Number.MIN_VALUE, value.z);\n\n        // For animation timeline.\n        if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\n          return;\n        }\n\n        lastValue.x = value.x;\n        lastValue.y = value.y;\n        lastValue.z = value.z;\n\n        mesh.scale.set(value.x, value.y, value.z);\n        mesh.matrixNeedsUpdate = true;\n      };\n    })();\n\n    const config = {\n      duration: 400,\n      easing: \"easeOutElastic\",\n      elasticity: 400,\n      loop: 0,\n      round: false,\n      x: mesh.scale.x,\n      y: mesh.scale.y,\n      z: mesh.scale.z,\n      targets: [initialScale],\n      update: anim => step(anim),\n      complete: anim => {\n        step(anim);\n        onComplete();\n      }\n    };\n\n    mesh.scale.copy(initialScale);\n    mesh.matrixNeedsUpdate = true;\n\n    return anime(config);\n  },\n\n  async update(oldData) {\n    try {\n      const { src, contentSubtype } = this.data;\n\n      if (src !== oldData.src && !this.showLoaderTimeout) {\n        this.showLoaderTimeout = setTimeout(this.showLoader, 100);\n      }\n\n      if (!src) return;\n\n      let canonicalUrl = src;\n      let accessibleUrl = src;\n      let contentType = this.data.contentType;\n      let thumbnail;\n\n      if (this.data.resolve) {\n        const result = await resolveUrl(src);\n        canonicalUrl = result.origin;\n        // handle protocol relative urls\n        if (canonicalUrl.startsWith(\"//\")) {\n          canonicalUrl = location.protocol + canonicalUrl;\n        }\n        contentType = (result.meta && result.meta.expected_content_type) || contentType;\n        thumbnail = result.meta && result.meta.thumbnail && proxiedUrlFor(result.meta.thumbnail);\n      }\n\n      // todo: we don't need to proxy for many things if the canonical URL has permissive CORS headers\n      accessibleUrl = proxiedUrlFor(canonicalUrl, null);\n\n      // if the component creator didn't know the content type, we didn't get it from reticulum, and\n      // we don't think we can infer it from the extension, we need to make a HEAD request to find it out\n      contentType = contentType || guessContentType(canonicalUrl) || (await fetchContentType(accessibleUrl));\n\n      // We don't want to emit media_resolved for index updates.\n      if (src !== oldData.src) {\n        this.el.emit(\"media_resolved\", { src, raw: accessibleUrl, contentType });\n      }\n\n      if (\n        contentType.startsWith(\"video/\") ||\n        contentType.startsWith(\"audio/\") ||\n        AFRAME.utils.material.isHLS(canonicalUrl, contentType)\n      ) {\n        const parsedUrl = new URL(src);\n        const qsTime = parseInt(parsedUrl.searchParams.get(\"t\"));\n        const hashTime = parseInt(new URLSearchParams(parsedUrl.hash.substring(1)).get(\"t\"));\n        const startTime = hashTime || qsTime || 0;\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-image\");\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\n        this.el.addEventListener(\n          \"video-loaded\",\n          e => {\n            this.onMediaLoaded(e.detail.projection === \"flat\" ? SHAPE.BOX : null);\n          },\n          { once: true }\n        );\n        this.el.setAttribute(\n          \"media-video\",\n          Object.assign({}, this.data.mediaOptions, { src: accessibleUrl, time: startTime, contentType })\n        );\n        if (this.el.components[\"position-at-box-shape-border__freeze\"]) {\n          this.el.setAttribute(\"position-at-box-shape-border__freeze\", { dirs: [\"forward\", \"back\"] });\n        }\n      } else if (contentType.startsWith(\"image/\")) {\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-video\");\n        this.el.removeAttribute(\"media-pager\");\n        this.el.addEventListener(\n          \"image-loaded\",\n          e => {\n            this.onMediaLoaded(e.detail.projection === \"flat\" ? SHAPE.BOX : null);\n\n            if (contentSubtype === \"photo-camera\") {\n              this.el.setAttribute(\"hover-menu__photo\", {\n                template: \"#photo-hover-menu\",\n                dirs: [\"forward\", \"back\"]\n              });\n            }\n          },\n          { once: true }\n        );\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\n        this.el.setAttribute(\n          \"media-image\",\n          // Object.assign({}, this.data.mediaOptions, { src: accessibleUrl, contentType, batch: !disableBatching })\n          Object.assign({}, this.data.mediaOptions, { src: accessibleUrl, contentType, batch: false })\n        );\n\n        if (this.el.components[\"position-at-box-shape-border__freeze\"]) {\n          this.el.setAttribute(\"position-at-box-shape-border__freeze\", { dirs: [\"forward\", \"back\"] });\n        }\n      } else if (contentType.startsWith(\"application/pdf\")) {\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-video\");\n        // two small differences:\n        // 1. we pass the canonical URL to the pager so it can easily make subresource URLs\n        // 2. we don't remove the media-image component -- media-pager uses that internally\n        this.el.setAttribute(\"media-pager\", Object.assign({}, this.data.mediaOptions, { src: canonicalUrl }));\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\n        this.el.addEventListener(\"image-loaded\", this.clearLoadingTimeout, { once: true });\n        this.el.addEventListener(\"preview-loaded\", () => this.onMediaLoaded(SHAPE.BOX), { once: true });\n\n        if (this.el.components[\"position-at-box-shape-border__freeze\"]) {\n          this.el.setAttribute(\"position-at-box-shape-border__freeze\", { dirs: [\"forward\", \"back\"] });\n        }\n      } else if (\n        contentType.includes(\"application/octet-stream\") ||\n        contentType.includes(\"x-zip-compressed\") ||\n        contentType.startsWith(\"model/gltf\")\n      ) {\n        this.el.removeAttribute(\"media-image\");\n        this.el.removeAttribute(\"media-video\");\n        this.el.removeAttribute(\"media-pager\");\n        this.el.addEventListener(\n          \"model-loaded\",\n          () => {\n            this.onMediaLoaded(SHAPE.HULL, true);\n            addAnimationComponents(this.el);\n          },\n          { once: true }\n        );\n        this.el.addEventListener(\"model-error\", this.onError, { once: true });\n        this.el.setAttribute(\n          \"gltf-model-plus\",\n          Object.assign({}, this.data.mediaOptions, {\n            src: accessibleUrl,\n            contentType: contentType,\n            inflate: true,\n            batch: !disableBatching && batchMeshes,\n            modelToWorldScale: this.data.resize ? 0.0001 : 1.0\n          })\n        );\n      } else if (contentType.startsWith(\"text/html\")) {\n        this.el.removeAttribute(\"gltf-model-plus\");\n        this.el.removeAttribute(\"media-video\");\n        this.el.removeAttribute(\"media-pager\");\n        this.el.addEventListener(\n          \"image-loaded\",\n          () => {\n            const mayChangeScene = this.el.sceneEl.systems.permissions.can(\"update_hub\");\n\n            if (isHubsAvatarUrl(src)) {\n              this.el.setAttribute(\"hover-menu__hubs-item\", {\n                template: \"#avatar-link-hover-menu\",\n                dirs: [\"forward\", \"back\"]\n              });\n            } else if (isHubsRoomUrl(src) || (isHubsSceneUrl(src) && mayChangeScene)) {\n              this.el.setAttribute(\"hover-menu__hubs-item\", {\n                template: \"#hubs-destination-hover-menu\",\n                dirs: [\"forward\", \"back\"]\n              });\n            } else {\n              this.el.setAttribute(\"hover-menu__link\", { template: \"#link-hover-menu\", dirs: [\"forward\", \"back\"] });\n            }\n            this.onMediaLoaded(SHAPE.BOX);\n          },\n          { once: true }\n        );\n        this.el.setAttribute(\"floaty-object\", { reduceAngularFloat: true, releaseGravity: -1 });\n        this.el.setAttribute(\n          \"media-image\",\n          Object.assign({}, this.data.mediaOptions, {\n            src: thumbnail,\n            contentType: guessContentType(thumbnail) || \"image/png\",\n            batch: !disableBatching\n          })\n        );\n        if (this.el.components[\"position-at-box-shape-border__freeze\"]) {\n          this.el.setAttribute(\"position-at-box-shape-border__freeze\", { dirs: [\"forward\", \"back\"] });\n        }\n      } else {\n        throw new Error(`Unsupported content type: ${contentType}`);\n      }\n    } catch (e) {\n      console.error(\"Error adding media\", e);\n      this.onError();\n    }\n  }\n});\n\nAFRAME.registerComponent(\"media-pager\", {\n  schema: {\n    src: { type: \"string\" },\n    index: { default: 0 }\n  },\n\n  init() {\n    this.toolbar = null;\n    this.imageSrc = null;\n    this.onNext = this.onNext.bind(this);\n    this.onPrev = this.onPrev.bind(this);\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.networkedEl = networkedEl;\n    });\n\n    this.el.addEventListener(\"image-loaded\", async e => {\n      this.imageSrc = e.detail.src;\n      await this._ensureUI();\n      this.update();\n    });\n  },\n\n  async _ensureUI() {\n    if (this.hasSetupUI || !this.imageSrc) return;\n    this.hasSetupUI = true;\n\n    // unfortunately, since we loaded the page image in an img tag inside media-image, we have to make a second\n    // request for the same page to read out the max-content-index header\n    this.maxIndex = await fetchMaxContentIndex(this.imageSrc);\n    const template = document.getElementById(\"paging-toolbar\");\n    this.el.querySelector(\".interactable-ui\").appendChild(document.importNode(template.content, true));\n    this.toolbar = this.el.querySelector(\".paging-toolbar\");\n    // we have to wait a tick for the attach callbacks to get fired for the elements in a template\n    setTimeout(() => {\n      this.nextButton = this.el.querySelector(\".next-button [text-button]\");\n      this.prevButton = this.el.querySelector(\".prev-button [text-button]\");\n      this.pageLabel = this.el.querySelector(\".page-label\");\n\n      this.nextButton.object3D.addEventListener(\"interact\", this.onNext);\n      this.prevButton.object3D.addEventListener(\"interact\", this.onPrev);\n\n      this.update();\n      this.el.emit(\"preview-loaded\");\n    }, 0);\n  },\n\n  async update() {\n    if (!this.data.src) return;\n\n    const pageSrc = proxiedUrlFor(this.data.src, this.data.index);\n    this.el.setAttribute(\"media-image\", { src: pageSrc, contentType: guessContentType(pageSrc) || \"image/png\" });\n\n    await this._ensureUI();\n\n    if (this.pageLabel) {\n      this.pageLabel.setAttribute(\"text\", \"value\", `${this.data.index + 1}/${this.maxIndex + 1}`);\n      this.repositionToolbar();\n    }\n  },\n\n  remove() {\n    if (this.toolbar) {\n      this.toolbar.parentNode.removeChild(this.toolbar);\n    }\n  },\n\n  onNext() {\n    if (!NAF.utils.isMine(this.networkedEl) && !NAF.utils.takeOwnership(this.networkedEl)) return;\n    this.el.setAttribute(\"media-pager\", \"index\", Math.min(this.data.index + 1, this.maxIndex));\n    this.el.emit(\"pager-page-changed\");\n  },\n\n  onPrev() {\n    if (!NAF.utils.isMine(this.networkedEl) && !NAF.utils.takeOwnership(this.networkedEl)) return;\n    this.el.setAttribute(\"media-pager\", \"index\", Math.max(this.data.index - 1, 0));\n    this.el.emit(\"pager-page-changed\");\n  },\n\n  repositionToolbar() {\n    const ammoShape = this.el.getAttribute(\"ammo-shape\");\n    if (!ammoShape) return;\n\n    this.toolbar.object3D.position.y = -0.7;\n    this.toolbar.object3D.matrixNeedsUpdate = true;\n  }\n});\n","import { SOUND_QUACK, SOUND_SPECIAL_QUACK } from \"../systems/sound-effects-system\";\n\nAFRAME.registerComponent(\"quack\", {\n  schema: {\n    quackPercentage: { default: 1 },\n    specialQuackPercentage: { default: 0.01 }\n  },\n\n  init: function() {\n    this._handleGrabStart = this._handleGrabStart.bind(this);\n  },\n\n  play: function() {\n    this.el.object3D.addEventListener(\"interact\", this._handleGrabStart);\n  },\n\n  pause: function() {\n    this.el.object3D.removeEventListener(\"interact\", this._handleGrabStart);\n  },\n\n  _handleGrabStart: function() {\n    const rand = Math.random();\n    if (rand < this.data.specialQuackPercentage) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SPECIAL_QUACK);\n    } else if (rand < this.data.quackPercentage) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_QUACK);\n    }\n  }\n});\n","import { setMatrixWorld } from \"../utils/three-utils\";\nimport { getCurrentStreamer } from \"../utils/component-utils\";\n\nfunction getStreamerCamera() {\n  const streamer = getCurrentStreamer();\n  if (streamer) {\n    return streamer.el.querySelector(\".camera\").object3D;\n  }\n  return null;\n}\n\nfunction lerp(start, end, t) {\n  return (1 - t) * start + t * end;\n}\n\nconst newRot = new THREE.Quaternion();\n\n/**\n * Nicely pans the camera for previewing a scene. There's some weirdness with this right now\n * since it ends up panning in a direction dependent upon the start camera orientation,\n * but it's good enough for now.\n */\nAFRAME.registerComponent(\"scene-preview-camera\", {\n  schema: {\n    duration: { default: 90, type: \"number\" },\n    positionOnly: { default: false, type: \"boolean\" }\n  },\n\n  init: function() {\n    this.startPoint = this.el.object3D.position.clone();\n    this.startRotation = this.el.object3D.quaternion.clone();\n\n    this.targetPoint = this.el.object3D.position.clone();\n    this.targetPoint.y = Math.max(this.targetPoint.y - 1.5, 1);\n    this.targetPoint.add(new THREE.Vector3(2, 0, -2));\n\n    const targetRotDelta = new THREE.Euler(-0.15, 0.0, 0.15);\n    this.targetRotation = new THREE.Quaternion();\n    this.targetRotation.setFromEuler(targetRotDelta);\n    this.targetRotation.premultiply(this.startRotation);\n\n    this.startTime = performance.now();\n    this.backwards = false;\n    this.ranOnePass = false;\n  },\n\n  tick2: function() {\n    const streamerCamera = getStreamerCamera();\n    if (streamerCamera) {\n      setMatrixWorld(this.el.object3D, streamerCamera.matrixWorld);\n      // Move camera forward just a bit so that we don't see the avatar's eye cylinders.\n      this.el.object3D.translateZ(-0.1);\n      this.el.object3D.matrixNeedsUpdate = true;\n    } else {\n      let t = (performance.now() - this.startTime) / (1000.0 * this.data.duration);\n      t = Math.min(1.0, Math.max(0.0, t));\n\n      if (!this.ranOnePass) {\n        t = t * (2 - t);\n      } else {\n        t = t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t;\n      }\n\n      const from = this.backwards ? this.targetPoint : this.startPoint;\n      const to = this.backwards ? this.startPoint : this.targetPoint;\n      const fromRot = this.backwards ? this.targetRotation : this.startRotation;\n      const toRot = this.backwards ? this.startRotation : this.targetRotation;\n\n      THREE.Quaternion.slerp(fromRot, toRot, newRot, t);\n\n      this.el.object3D.position.set(lerp(from.x, to.x, t), lerp(from.y, to.y, t), lerp(from.z, to.z, t));\n\n      if (!this.data.positionOnly) {\n        this.el.object3D.rotation.setFromQuaternion(newRot);\n      }\n\n      this.el.object3D.matrixNeedsUpdate = true;\n\n      if (t >= 0.9999) {\n        this.ranOnePass = true;\n        this.backwards = !this.backwards;\n        this.startTime = performance.now();\n      }\n    }\n  }\n});\n","import \"three/examples/js/pmrem/PMREMGenerator\";\nimport \"three/examples/js/pmrem/PMREMCubeUVPacker\";\nimport qsTruthy from \"../utils/qs_truthy\";\nconst isBotMode = qsTruthy(\"bot\");\n\n/**\n * @author zz85 / https://github.com/zz85\n *\n * Based on \"A Practical Analytic Model for Daylight\"\n * aka The Preetham Model, the de facto standard analytic skydome model\n * http://www.cs.utah.edu/~shirley/papers/sunsky/sunsky.pdf\n *\n * First implemented by Simon Wallner\n * http://www.simonwallner.at/projects/atmospheric-scattering\n *\n * Improved by Martin Upitis\n * http://blenderartists.org/forum/showthread.php?245954-preethams-sky-impementation-HDR\n *\n * Three.js integration by zz85 http://twitter.com/blurspline\n */\n\nTHREE.Sky = function() {\n  const shader = THREE.Sky.SkyShader;\n\n  const material = new THREE.ShaderMaterial({\n    fragmentShader: shader.fragmentShader,\n    vertexShader: shader.vertexShader,\n    uniforms: THREE.UniformsUtils.clone(shader.uniforms),\n    side: THREE.BackSide\n  });\n\n  THREE.Mesh.call(this, new THREE.BoxBufferGeometry(1, 1, 1), material);\n};\n\nTHREE.Sky.prototype = Object.create(THREE.Mesh.prototype);\nTHREE.Sky.prototype.constructor = THREE.Sky;\n\nTHREE.Sky.SkyShader = {\n  uniforms: {\n    luminance: { value: 1 },\n    turbidity: { value: 2 },\n    rayleigh: { value: 1 },\n    mieCoefficient: { value: 0.005 },\n    mieDirectionalG: { value: 0.8 },\n    sunPosition: { value: new THREE.Vector3() }\n  },\n\n  vertexShader: [\n    \"uniform vec3 sunPosition;\",\n    \"uniform float rayleigh;\",\n    \"uniform float turbidity;\",\n    \"uniform float mieCoefficient;\",\n\n    \"varying vec3 vWorldPosition;\",\n    \"varying vec3 vSunDirection;\",\n    \"varying float vSunfade;\",\n    \"varying vec3 vBetaR;\",\n    \"varying vec3 vBetaM;\",\n    \"varying float vSunE;\",\n\n    \"const vec3 up = vec3( 0.0, 1.0, 0.0 );\",\n\n    // constants for atmospheric scattering\n    \"const float e = 2.71828182845904523536028747135266249775724709369995957;\",\n    \"const float pi = 3.141592653589793238462643383279502884197169;\",\n\n    // wavelength of used primaries, according to preetham\n    \"const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );\",\n    // this pre-calcuation replaces older TotalRayleigh(vec3 lambda) function:\n    // (8.0 * pow(pi, 3.0) * pow(pow(n, 2.0) - 1.0, 2.0) * (6.0 + 3.0 * pn)) / (3.0 * N * pow(lambda, vec3(4.0)) * (6.0 - 7.0 * pn))\n    \"const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );\",\n\n    // mie stuff\n    // K coefficient for the primaries\n    \"const float v = 4.0;\",\n    \"const vec3 K = vec3( 0.686, 0.678, 0.666 );\",\n    // MieConst = pi * pow( ( 2.0 * pi ) / lambda, vec3( v - 2.0 ) ) * K\n    \"const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );\",\n\n    // earth shadow hack\n    // cutoffAngle = pi / 1.95;\n    \"const float cutoffAngle = 1.6110731556870734;\",\n    \"const float steepness = 1.5;\",\n    \"const float EE = 1000.0;\",\n\n    \"float sunIntensity( float zenithAngleCos ) {\",\n    \"\tzenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );\",\n    \"\treturn EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );\",\n    \"}\",\n\n    \"vec3 totalMie( float T ) {\",\n    \"\tfloat c = ( 0.2 * T ) * 10E-18;\",\n    \"\treturn 0.434 * c * MieConst;\",\n    \"}\",\n\n    \"void main() {\",\n\n    \"\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\",\n    \"\tvWorldPosition = worldPosition.xyz;\",\n\n    \"\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\",\n\n    \"\tvSunDirection = normalize( sunPosition );\",\n\n    \"\tvSunE = sunIntensity( dot( vSunDirection, up ) );\",\n\n    \"\tvSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );\",\n\n    \"\tfloat rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );\",\n\n    // extinction (absorbtion + out scattering)\n    // rayleigh coefficients\n    \"\tvBetaR = totalRayleigh * rayleighCoefficient;\",\n\n    // mie coefficients\n    \"\tvBetaM = totalMie( turbidity ) * mieCoefficient;\",\n\n    \"}\"\n  ].join(\"\\n\"),\n\n  fragmentShader: [\n    \"varying vec3 vWorldPosition;\",\n    \"varying vec3 vSunDirection;\",\n    \"varying float vSunfade;\",\n    \"varying vec3 vBetaR;\",\n    \"varying vec3 vBetaM;\",\n    \"varying float vSunE;\",\n\n    \"uniform float luminance;\",\n    \"uniform float mieDirectionalG;\",\n\n    \"const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );\",\n\n    // constants for atmospheric scattering\n    \"const float pi = 3.141592653589793238462643383279502884197169;\",\n\n    \"const float n = 1.0003;\", // refractive index of air\n    \"const float N = 2.545E25;\", // number of molecules per unit volume for air at\n    // 288.15K and 1013mb (sea level -45 celsius)\n\n    // optical length at zenith for molecules\n    \"const float rayleighZenithLength = 8.4E3;\",\n    \"const float mieZenithLength = 1.25E3;\",\n    \"const vec3 up = vec3( 0.0, 1.0, 0.0 );\",\n    // 66 arc seconds -> degrees, and the cosine of that\n    \"const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;\",\n\n    // 3.0 / ( 16.0 * pi )\n    \"const float THREE_OVER_SIXTEENPI = 0.05968310365946075;\",\n    // 1.0 / ( 4.0 * pi )\n    \"const float ONE_OVER_FOURPI = 0.07957747154594767;\",\n\n    \"float rayleighPhase( float cosTheta ) {\",\n    \"\treturn THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );\",\n    \"}\",\n\n    \"float hgPhase( float cosTheta, float g ) {\",\n    \"\tfloat g2 = pow( g, 2.0 );\",\n    \"\tfloat inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );\",\n    \"\treturn ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );\",\n    \"}\",\n\n    // Filmic ToneMapping http://filmicgames.com/archives/75\n    \"const float A = 0.15;\",\n    \"const float B = 0.50;\",\n    \"const float C = 0.10;\",\n    \"const float D = 0.20;\",\n    \"const float E = 0.02;\",\n    \"const float F = 0.30;\",\n\n    \"const float whiteScale = 1.0748724675633854;\", // 1.0 / Uncharted2Tonemap(1000.0)\n\n    \"vec3 Uncharted2Tonemap( vec3 x ) {\",\n    \"\treturn ( ( x * ( A * x + C * B ) + D * E ) / ( x * ( A * x + B ) + D * F ) ) - E / F;\",\n    \"}\",\n\n    \"void main() {\",\n    // optical length\n    // cutoff angle at 90 to avoid singularity in next formula.\n    \"\tfloat zenithAngle = acos( max( 0.0, dot( up, normalize( vWorldPosition - cameraPos ) ) ) );\",\n    \"\tfloat inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );\",\n    \"\tfloat sR = rayleighZenithLength * inverse;\",\n    \"\tfloat sM = mieZenithLength * inverse;\",\n\n    // combined extinction factor\n    \"\tvec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );\",\n\n    // in scattering\n    \"\tfloat cosTheta = dot( normalize( vWorldPosition - cameraPos ), vSunDirection );\",\n\n    \"\tfloat rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );\",\n    \"\tvec3 betaRTheta = vBetaR * rPhase;\",\n\n    \"\tfloat mPhase = hgPhase( cosTheta, mieDirectionalG );\",\n    \"\tvec3 betaMTheta = vBetaM * mPhase;\",\n\n    \"\tvec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );\",\n    \"\tLin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );\",\n\n    // nightsky\n    \"\tvec3 direction = normalize( vWorldPosition - cameraPos );\",\n    \"\tfloat theta = acos( direction.y ); // elevation --> y-axis, [-pi/2, pi/2]\",\n    \"\tfloat phi = atan( direction.z, direction.x ); // azimuth --> x-axis [-pi/2, pi/2]\",\n    \"\tvec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );\",\n    \"\tvec3 L0 = vec3( 0.1 ) * Fex;\",\n\n    // composition + solar disc\n    \"\tfloat sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );\",\n    \"\tL0 += ( vSunE * 19000.0 * Fex ) * sundisk;\",\n\n    \"\tvec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );\",\n\n    \"\tvec3 curr = Uncharted2Tonemap( ( log2( 2.0 / pow( luminance, 4.0 ) ) ) * texColor );\",\n    \"\tvec3 color = curr * whiteScale;\",\n\n    \"\tvec3 retColor = pow( color, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );\",\n\n    \"\tgl_FragColor = vec4( retColor, 1.0 );\",\n\n    \"}\"\n  ].join(\"\\n\")\n};\n\nAFRAME.registerComponent(\"skybox\", {\n  schema: {\n    turbidity: { type: \"number\", default: 10 },\n    rayleigh: { type: \"number\", default: 2 },\n    luminance: { type: \"number\", default: 1 },\n    mieCoefficient: { type: \"number\", default: 0.005 },\n    mieDirectionalG: { type: \"number\", default: 0.8 },\n    inclination: { type: \"number\", default: 0 },\n    azimuth: { type: \"number\", default: 0.15 },\n    distance: { type: \"number\", default: 8000 }\n  },\n\n  init() {\n    this.sky = new THREE.Sky();\n    this.el.setObject3D(\"mesh\", this.sky);\n    this.skyScene = new THREE.Scene();\n    this.cubeCamera = new THREE.CubeCamera(1, 100000, 512);\n    this.skyScene.add(this.cubeCamera);\n\n    this.updateEnvironmentMap = this.updateEnvironmentMap.bind(this);\n    // HACK: Render environment map on next frame to avoid bug where the render target texture is black.\n    // This is likely due to the custom elements attached callback being synchronous on Chrome but not Firefox.\n    // Added timeout due to additional case where texture is black in Firefox.\n    requestAnimationFrame(() => setTimeout(this.updateEnvironmentMap));\n  },\n\n  update(oldData) {\n    const uniforms = this.sky.material.uniforms;\n\n    if (this.data.turbidity !== oldData.turbidity) {\n      uniforms.turbidity.value = this.data.turbidity;\n    }\n\n    if (this.data.rayleigh !== oldData.rayleigh) {\n      uniforms.rayleigh.value = this.data.rayleigh;\n    }\n\n    if (this.data.luminance !== oldData.luminance) {\n      uniforms.luminance.value = this.data.luminance;\n    }\n\n    if (this.data.mieCoefficient !== oldData.mieCoefficient) {\n      uniforms.mieCoefficient.value = this.data.mieCoefficient;\n    }\n\n    if (this.data.mieDirectionalG !== oldData.mieDirectionalG) {\n      uniforms.mieDirectionalG.value = this.data.mieDirectionalG;\n    }\n\n    if (\n      this.data.inclination !== oldData.inclination ||\n      this.data.azimuth !== oldData.azimuth ||\n      this.data.distance !== oldData.distance\n    ) {\n      const theta = Math.PI * (this.data.inclination - 0.5);\n      const phi = 2 * Math.PI * (this.data.azimuth - 0.5);\n\n      const distance = this.data.distance;\n\n      const x = distance * Math.cos(phi);\n      const y = distance * Math.sin(phi) * Math.sin(theta);\n      const z = distance * Math.sin(phi) * Math.cos(theta);\n\n      uniforms.sunPosition.value.set(x, y, z).normalize();\n\n      // HACK Remove this if condition and always set the scale based on distance when the existing environments\n      // have their sky scales set to 1.\n      if (this.el.object3D.scale.x === 1) {\n        this.sky.scale.set(distance, distance, distance);\n      }\n\n      this.el.object3D.matrixNeedsUpdate = true;\n    }\n\n    this.updateEnvironmentMap();\n  },\n\n  updateEnvironmentMap() {\n    const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\n\n    if (environmentMapComponent && !isBotMode) {\n      const renderer = this.el.sceneEl.renderer;\n      this.skyScene.add(this.sky);\n      this.cubeCamera.update(renderer, this.skyScene);\n      this.el.setObject3D(\"mesh\", this.sky);\n      const vrEnabled = renderer.vr.enabled;\n      renderer.vr.enabled = false;\n      const pmremGenerator = new THREE.PMREMGenerator(this.cubeCamera.renderTarget.texture);\n      pmremGenerator.update(renderer);\n      const pmremCubeUVPacker = new THREE.PMREMCubeUVPacker(pmremGenerator.cubeLods);\n      pmremCubeUVPacker.update(renderer);\n      renderer.vr.enabled = vrEnabled;\n      environmentMapComponent.updateEnvironmentMap(pmremCubeUVPacker.CubeUVRenderTarget.texture);\n      pmremGenerator.dispose();\n      pmremCubeUVPacker.dispose();\n    }\n  },\n\n  remove() {\n    this.el.removeObject3D(\"mesh\");\n  }\n});\n","import { getLastWorldPosition } from \"../utils/three-utils\";\n\n/**\n * Used on a player-rig to move the player to a random spawn point on entry.\n * @namespace avatar\n * @component spawn-controller\n */\nAFRAME.registerComponent(\"spawn-controller\", {\n  schema: {\n    target: { type: \"selector\" },\n    camera: { type: \"selector\", default: \"#player-camera\" },\n    playerHeight: { default: 1.6 },\n    loadedEvent: { type: \"string\" }\n  },\n  init() {\n    this.moveToSpawnPoint = this.moveToSpawnPoint.bind(this);\n    this.data.target.addEventListener(this.data.loadedEvent, this.moveToSpawnPoint);\n  },\n  moveToSpawnPoint() {\n    const spawnPoints = document.querySelectorAll(\"[spawn-point]\");\n\n    if (spawnPoints.length === 0) {\n      // Keep default position\n      return;\n    }\n\n    const camera = this.data.camera;\n    const spawnPointIndex = Math.round((spawnPoints.length - 1) * Math.random());\n    const spawnPoint = spawnPoints[spawnPointIndex];\n\n    getLastWorldPosition(spawnPoint.object3D, this.el.object3D.position);\n    this.el.object3D.rotation.copy(spawnPoint.object3D.rotation);\n\n    if (this.el.sceneEl.is(\"vr-mode\")) {\n      // Rotate the player rig such that the vr-camera faces forward.\n      this.el.object3D.rotation.y -= this.data.camera.object3D.rotation.y;\n    } else {\n      // Reset the camera transform in 2D mode.\n      camera.object3D.position.set(0, this.data.playerHeight, 0);\n      camera.object3D.rotation.set(0, 0, 0);\n      camera.object3D.matrixNeedsUpdate = true;\n    }\n\n    // Camera faces -Z direction. Flip rotation on Y axis to face the correct direction.\n    this.el.object3D.rotation.y += Math.PI;\n    this.el.object3D.matrixNeedsUpdate = true;\n\n    // Reset pitch-yaw-rotator after any scene-preview-camera rotation.\n    if (camera.components[\"pitch-yaw-rotator\"]) {\n      camera.components[\"pitch-yaw-rotator\"].set(camera.object3D.rotation.x, camera.object3D.rotation.y);\n    }\n  }\n});\n\n/**\n * Marks an entity as a potential spawn point.\n * @namespace environment\n * @component spawn-point\n */\nAFRAME.registerComponent(\"spawn-point\", {\n  init() {\n    this.el.object3D.visible = false;\n  }\n});\n","/* global require AFRAME THREE setTimeout clearTimeout */\nimport { addMedia } from \"../utils/media-utils\";\nimport { waitForEvent } from \"../utils/async-utils\";\nimport { ObjectContentOrigins } from \"../object-types\";\nimport { paths } from \"../systems/userinput/paths\";\n\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\n\n/**\n * Spawns networked objects when grabbed or when a specified event is fired.\n * @namespace network\n * @component super-spawner\n */\nAFRAME.registerComponent(\"super-spawner\", {\n  schema: {\n    /**\n     * Source of the media asset the spawner will spawn when grabbed. This can be a gltf, video, or image, or a url that the reticiulm media API can resolve to a gltf, video, or image.\n     */\n    src: { default: \"\" },\n\n    /**\n     * Whether to use the Reticulum media resolution API to interpret the src URL (e.g. find a video URL for Youtube videos.)\n     */\n    resolve: { default: false },\n\n    /**\n     * Whether to resize the media on load.\n     */\n    resize: { default: false },\n\n    /**\n     * The template to use for this object\n     */\n    template: { default: \"\" },\n\n    /**\n     * Spawn the object at a custom position, rather than at the center of the spanwer.\n     */\n    useCustomSpawnPosition: { default: false },\n    spawnPosition: { type: \"vec3\" },\n\n    /**\n     * Spawn the object with a custom orientation, rather than copying that of the spawner.\n     */\n    useCustomSpawnRotation: { default: false },\n    spawnRotation: { type: \"vec4\" },\n\n    /**\n     * Spawn the object with a custom scale, rather than copying that of the spawner.\n     */\n    useCustomSpawnScale: { default: false },\n    spawnScale: { type: \"vec3\" },\n\n    /**\n     * The spawner will become invisible and ungrabbable for this ammount of time after being grabbed. This can prevent rapidly spawning objects.\n     */\n    spawnCooldown: { default: 1 },\n\n    /**\n     * Center the spawned object on the hand that grabbed it after it finishes loading. By default the object will be grabbed relative to where the spawner was grabbed\n     */\n    centerSpawnedObject: { default: false },\n\n    /**\n     * Optional event to listen for to spawn an object on the preferred superHand\n     */\n    spawnEvent: { type: \"string\" },\n\n    /**\n     * If true, will spawn the object at the cursor and animate it into the hand.\n     */\n    animateFromCursor: { type: \"boolean\" }\n  },\n\n  init() {\n    this.cooldownTimeout = null;\n    this.handPosition = new THREE.Vector3();\n\n    this.onSpawnEvent = this.onSpawnEvent.bind(this);\n\n    this.sceneEl = document.querySelector(\"a-scene\");\n\n    this.tempSpawnHandPosition = new THREE.Vector3();\n  },\n\n  play() {\n    if (this.data.spawnEvent) {\n      this.el.sceneEl.addEventListener(this.data.spawnEvent, this.onSpawnEvent);\n    }\n  },\n\n  pause() {\n    if (this.data.spawnEvent) {\n      this.el.sceneEl.removeEventListener(this.data.spawnEvent, this.onSpawnEvent);\n    }\n    if (this.cooldownTimeout) {\n      clearTimeout(this.cooldownTimeout);\n      this.cooldownTimeout = null;\n      this.el.setAttribute(\"visible\", true);\n      this.el.classList.add(\"interactable\");\n    }\n  },\n\n  async onSpawnEvent() {\n    if (this.cooldownTimeout || !this.el.sceneEl.is(\"entered\")) {\n      return;\n    }\n\n    const entity = addMedia(\n      this.data.src,\n      this.data.template,\n      ObjectContentOrigins.SPAWNER,\n      null,\n      this.data.resolve,\n      false\n    ).entity;\n\n    const cursor = document.querySelector(\"#cursor\");\n    cursor.object3D.getWorldPosition(entity.object3D.position);\n    cursor.object3D.getWorldQuaternion(entity.object3D.quaternion);\n    entity.object3D.matrixNeedsUpdate = true;\n\n    if (this.data.useCustomSpawnScale) {\n      entity.object3D.scale.copy(this.data.spawnScale);\n    }\n\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const willAnimateFromCursor = this.data.animateFromCursor && userinput.get(paths.actions.rightHand.matrix);\n    if (!willAnimateFromCursor) {\n      interaction.state.rightRemote.held = entity;\n      interaction.state.rightRemote.spawning = true;\n    }\n    this.activateCooldown();\n    await waitForEvent(\"body-loaded\", entity);\n\n    cursor.object3D.getWorldPosition(entity.object3D.position);\n    cursor.object3D.getWorldQuaternion(entity.object3D.quaternion);\n    entity.object3D.matrixNeedsUpdate = true;\n\n    if (willAnimateFromCursor) {\n      document.querySelector(\"#player-right-controller\").object3D.getWorldPosition(this.handPosition);\n      entity.setAttribute(\"animation__spawn-at-cursor\", {\n        property: \"position\",\n        delay: 500,\n        dur: 1500,\n        from: { x: entity.object3D.position.x, y: entity.object3D.position.y, z: entity.object3D.position.z },\n        to: { x: this.handPosition.x, y: this.handPosition.y, z: this.handPosition.z },\n        easing: \"easeInOutBack\"\n      });\n    } else {\n      interaction.state.rightRemote.spawning = false;\n    }\n    entity.components[\"ammo-body\"].syncToPhysics();\n  },\n\n  activateCooldown() {\n    if (this.data.spawnCooldown > 0) {\n      const [sx, sy, sz] = [this.el.object3D.scale.x, this.el.object3D.scale.y, this.el.object3D.scale.z];\n\n      this.el.setAttribute(\"visible\", false);\n      this.el.object3D.scale.set(0.001, 0.001, 0.001);\n      this.el.object3D.matrixNeedsUpdate = true;\n      this.el.classList.remove(\"interactable\");\n      this.el.setAttribute(\"ammo-body\", { collisionFilterMask: COLLISION_LAYERS.NONE });\n      this.cooldownTimeout = setTimeout(() => {\n        this.el.setAttribute(\"visible\", true);\n        this.el.classList.add(\"interactable\");\n        this.el.setAttribute(\"ammo-body\", { collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER });\n        this.el.removeAttribute(\"animation__spawner-cooldown\");\n        this.el.setAttribute(\"animation__spawner-cooldown\", {\n          property: \"scale\",\n          delay: 50,\n          dur: 350,\n          from: { x: 0.001, y: 0.001, z: 0.001 },\n          to: { x: sx, y: sy, z: sz },\n          easing: \"easeOutElastic\"\n        });\n\n        this.cooldownTimeout = null;\n      }, this.data.spawnCooldown * 1000);\n    }\n  }\n});\n","import { Layers } from \"./layers\";\nimport \"../vendor/Water\";\nimport waterNormalMap from \"../assets/waternormals.jpg\";\n\n/**\n * @author jbouny / https://github.com/jbouny\n *\n * Work based on :\n * @author Slayvin / http://slayvin.net : Flat mirror for three.js\n * @author Stemkoski / http://www.adelphi.edu/~stemkoski : An implementation of water shader based on the flat mirror\n * @author Jonas Wagner / http://29a.ch/ && http://29a.ch/slides/2012/webglwater/ : Water shader explanations in WebGL\n */\n\nfunction MobileWater(geometry, options) {\n  THREE.Mesh.call(this, geometry);\n\n  const scope = this;\n\n  options = options || {};\n\n  const time = options.time !== undefined ? options.time : 0.0;\n  const normalSampler = options.waterNormals !== undefined ? options.waterNormals : null;\n  const sunDirection =\n    options.sunDirection !== undefined ? options.sunDirection : new THREE.Vector3(0.70707, 0.70707, 0.0);\n  const sunColor = new THREE.Color(options.sunColor !== undefined ? options.sunColor : 0xffffff);\n  const waterColor = new THREE.Color(options.waterColor !== undefined ? options.waterColor : 0x7f7f7f);\n  const eye = options.eye !== undefined ? options.eye : new THREE.Vector3(0, 0, 0);\n  const distortionScale = options.distortionScale !== undefined ? options.distortionScale : 20.0;\n  const side = options.side !== undefined ? options.side : THREE.FrontSide;\n  const fog = options.fog !== undefined ? options.fog : false;\n\n  const mirrorShader = {\n    uniforms: THREE.UniformsUtils.merge([\n      THREE.UniformsLib[\"lights\"],\n      {\n        normalSampler: { value: null },\n        time: { value: 0.0 },\n        size: { value: 1.0 },\n        distortionScale: { value: 20.0 },\n        sunColor: { value: new THREE.Color(0x7f7f7f) },\n        sunDirection: { value: new THREE.Vector3(0.70707, 0.70707, 0) },\n        eye: { value: new THREE.Vector3() },\n        waterColor: { value: new THREE.Color(0x555555) }\n      }\n    ]),\n\n    vertexShader: `\n      uniform float time;\n      varying vec4 worldPosition;\n\n      void main() {\n      \tworldPosition = modelMatrix * vec4( position, 1.0 );\n      \tvec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );\n      \tgl_Position = projectionMatrix * mvPosition;\n\n      }\n    `,\n\n    fragmentShader: `\n      uniform float time;\n      uniform float size;\n      uniform float distortionScale;\n      uniform sampler2D normalSampler;\n      uniform vec3 sunColor;\n      uniform vec3 sunDirection;\n      uniform vec3 eye;\n      uniform vec3 waterColor;\n\n      varying vec4 worldPosition;\n\n      vec4 getNoise( vec2 uv ) {\n      \tvec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);\n      \tvec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );\n      \tvec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );\n      \tvec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );\n      \tvec4 noise = texture2D( normalSampler, uv0 ) +\n      \t\ttexture2D( normalSampler, uv1 ) +\n      \t\ttexture2D( normalSampler, uv2 ) +\n      \t\ttexture2D( normalSampler, uv3 );\n      \treturn noise * 0.5 - 1.0;\n      }\n\n      void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {\n      \tvec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );\n      \tfloat direction = max( 0.0, dot( eyeDirection, reflection ) );\n      \tspecularColor += pow( direction, shiny ) * sunColor * spec;\n      \tdiffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;\n      }\n\n      ${THREE.ShaderChunk[\"common\"]}\n      ${THREE.ShaderChunk[\"packing\"]}\n      ${THREE.ShaderChunk[\"bsdfs\"]}\n      ${THREE.ShaderChunk[\"lights_pars_begin\"]}\n\n      void main() {\n      \tvec4 noise = getNoise( worldPosition.xz * size );\n      \tvec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );\n\n      \tvec3 diffuseLight = vec3(0.0);\n      \tvec3 specularLight = vec3(0.0);\n\n      \tvec3 worldToEye = eye-worldPosition.xyz;\n      \tvec3 eyeDirection = normalize( worldToEye );\n      \tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );\n\n      \tfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );\n      \tfloat rf0 = 0.3;\n      \tfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );\n      \tvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;\n      \tvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ), ( 0.5 + specularLight ), reflectance);\n      \tvec3 outgoingLight = albedo;\n      \tgl_FragColor = vec4( outgoingLight, 1 );\n      }\n    `\n  };\n\n  const material = new THREE.ShaderMaterial({\n    fragmentShader: mirrorShader.fragmentShader,\n    vertexShader: mirrorShader.vertexShader,\n    uniforms: THREE.UniformsUtils.clone(mirrorShader.uniforms),\n    transparent: false,\n    lights: true,\n    side: side,\n    fog: fog\n  });\n\n  material.uniforms.time.value = time;\n  material.uniforms.normalSampler.value = normalSampler;\n  material.uniforms.sunColor.value = sunColor;\n  material.uniforms.waterColor.value = waterColor;\n  material.uniforms.sunDirection.value = sunDirection;\n  material.uniforms.distortionScale.value = distortionScale;\n\n  material.uniforms.eye.value = eye;\n\n  scope.material = material;\n}\n\nMobileWater.prototype = Object.create(THREE.Mesh.prototype);\nMobileWater.prototype.constructor = THREE.Water;\n\nasync function loadWaterNormals(url) {\n  const texture = await new Promise((resolve, reject) =>\n    new THREE.TextureLoader().load(url, resolve, undefined, reject)\n  );\n  texture.wrapS = texture.wrapT = THREE.RepeatWrapping;\n  texture.needsUpdate = true;\n  return texture;\n}\n\nAFRAME.registerComponent(\"water\", {\n  schema: {\n    waterColor: { type: \"color\", default: \"#001e0f\" },\n    distortionScale: { type: \"number\", default: 3.7 },\n    sunColor: { type: \"color\", default: \"#ffffff\" },\n    inclination: { type: \"number\", default: 0 },\n    azimuth: { type: \"number\", default: 0 },\n    distance: { type: \"number\", default: 1 },\n    speed: { type: \"number\", default: 0.1 },\n    forceMobile: { type: \"boolean\", default: false }\n  },\n  init() {\n    const waterMesh = this.el.getObject3D(\"mesh\");\n    const waterGeometry = waterMesh.geometry;\n\n    // Render THREE.Water shader instead of THREE.Mesh\n    waterMesh.visible = false;\n\n    loadWaterNormals(waterNormalMap).then(waterNormals => {\n      const waterConfig = {\n        textureWidth: 512,\n        textureHeight: 512,\n        waterNormals: waterNormals,\n        sunDirection: this.data.sunDirection,\n        sunColor: new THREE.Color(this.data.sunColor),\n        waterColor: new THREE.Color(this.data.waterColor),\n        distortionScale: this.data.distortionScale,\n        fog: false\n      };\n\n      if (AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR() || this.data.forceMobile) {\n        this.water = new MobileWater(waterGeometry, waterConfig);\n      } else {\n        this.water = new THREE.Water(waterGeometry, waterConfig);\n        this.water.mirrorCamera.layers.set(Layers.reflection);\n      }\n\n      this.el.setObject3D(\"water\", this.water);\n    });\n  },\n\n  update(oldData) {\n    if (this.data.forceMobile !== oldData.forceMobile) {\n      this.el.removeObject3D(\"water\");\n      this.init();\n      return;\n    }\n\n    if (!this.water) {\n      return;\n    }\n\n    const uniforms = this.water.material.uniforms;\n\n    if (this.data.waterColor !== oldData.waterColor) {\n      uniforms.waterColor.value.setStyle(this.data.waterColor);\n    }\n\n    if (this.data.distortionScale !== oldData.distortionScale) {\n      uniforms.distortionScale.value = this.data.distortionScale;\n    }\n\n    if (this.data.sunColor !== oldData.sunColor) {\n      uniforms.sunColor.value.setStyle(this.data.sunColor);\n    }\n\n    if (\n      this.data.inclination !== oldData.inclination ||\n      this.data.azimuth !== oldData.azimuth ||\n      this.data.distance !== oldData.distance\n    ) {\n      const theta = Math.PI * (this.data.inclination - 0.5);\n      const phi = 2 * Math.PI * (this.data.azimuth - 0.5);\n\n      const distance = this.data.distance;\n\n      const x = distance * Math.cos(phi);\n      const y = distance * Math.sin(phi) * Math.sin(theta);\n      const z = distance * Math.sin(phi) * Math.cos(theta);\n\n      uniforms.sunDirection.value.set(x, y, z);\n    }\n  },\n\n  tick(time) {\n    if (this.water) {\n      this.water.material.uniforms.time.value = (time / 1000) * this.data.speed;\n    }\n  },\n\n  remove() {\n    this.el.removeObject3D(\"water\");\n    const waterMesh = this.el.getObject3D(\"mesh\");\n    waterMesh.visible = true;\n  }\n});\n","import { ParticleEmitter } from \"@mozillareality/three-particle-emitter\";\nimport { textureLoader } from \"../utils/media-utils\";\nimport { resolveUrl } from \"../utils/media-utils\";\nimport { proxiedUrlFor } from \"../utils/media-url-utils\";\n\nAFRAME.registerComponent(\"particle-emitter\", {\n  schema: {\n    resolve: { type: \"boolean\", default: true },\n    src: { type: \"string\" },\n    startColor: { type: \"color\" },\n    middleColor: { type: \"color\" },\n    endColor: { type: \"color\" },\n    startOpacity: { type: \"number\" },\n    middleOpacity: { type: \"number\" },\n    endOpacity: { type: \"number\" },\n    colorCurve: { type: \"string\" },\n    sizeCurve: { type: \"string\" },\n    startSize: { type: \"number\" },\n    endSize: { type: \"number\" },\n    sizeRandomness: { type: \"number\" },\n    ageRandomness: { type: \"number\" },\n    lifetime: { type: \"number\" },\n    lifetimeRandomness: { type: \"number\" },\n    particleCount: { type: \"number\" },\n    startVelocity: { type: \"vec3\" },\n    endVelocity: { type: \"vec3\" },\n    velocityCurve: { type: \"string\" },\n    angularVelocity: { type: \"number\" }\n  },\n\n  init() {\n    this.particleEmitter = new ParticleEmitter(null);\n    this.particleEmitter.visible = false;\n    this.el.setObject3D(\"particle-emitter\", this.particleEmitter);\n    this.updateParticles = false;\n  },\n\n  async setTexture(src, resolve) {\n    let accessibleUrl = src;\n\n    if (resolve) {\n      const result = await resolveUrl(src);\n      let canonicalUrl = result.origin;\n\n      // handle protocol relative urls\n      if (canonicalUrl.startsWith(\"//\")) {\n        canonicalUrl = location.protocol + canonicalUrl;\n      }\n\n      // todo: we don't need to proxy for many things if the canonical URL has permissive CORS headers\n      accessibleUrl = proxiedUrlFor(canonicalUrl, null);\n    }\n\n    const texture = new THREE.Texture();\n\n    await textureLoader.loadTextureAsync(texture, accessibleUrl);\n\n    // Guard against src changing while request was in flight\n    if (this.data.src !== src) {\n      return;\n    }\n\n    this.particleEmitter.material.uniforms.map.value = texture;\n    this.particleEmitter.visible = true;\n    this.updateParticles = true;\n  },\n\n  update(prevData) {\n    const data = this.data;\n    const particleEmitter = this.particleEmitter;\n\n    if (prevData.src !== data.src) {\n      this.setTexture(data.src, data.resolve).catch(console.error);\n    }\n\n    if (\n      prevData.startColor !== data.startColor ||\n      prevData.startSize !== data.startSize ||\n      prevData.sizeRandomness !== data.sizeRandomness ||\n      prevData.ageRandomness !== data.ageRandomness ||\n      prevData.lifetime !== data.lifetime ||\n      prevData.lifetimeRandomness !== data.lifetimeRandomness ||\n      prevData.particleCount !== data.particleCount\n    ) {\n      this.updateParticles = true;\n    }\n\n    particleEmitter.startColor.set(data.startColor);\n    particleEmitter.middleColor.set(data.middleColor);\n    particleEmitter.endColor.set(data.endColor);\n    particleEmitter.startOpacity = data.startOpacity;\n    particleEmitter.middleOpacity = data.middleOpacity;\n    particleEmitter.endOpacity = data.endOpacity;\n    particleEmitter.colorCurve = data.colorCurve;\n    particleEmitter.sizeCurve = data.sizeCurve;\n    particleEmitter.startSize = data.startSize;\n    particleEmitter.endSize = data.endSize;\n    particleEmitter.sizeRandomness = data.sizeRandomness;\n    particleEmitter.ageRandomness = data.ageRandomness;\n    particleEmitter.lifetime = data.lifetime;\n    particleEmitter.lifetimeRandomness = data.lifetimeRandomness;\n    particleEmitter.particleCount = data.particleCount;\n    particleEmitter.startVelocity.copy(data.startVelocity);\n    particleEmitter.endVelocity.copy(data.endVelocity);\n    particleEmitter.velocityCurve = data.velocityCurve;\n    particleEmitter.angularVelocity = data.angularVelocity;\n  },\n\n  tick(time, dt) {\n    if (this.updateParticles) {\n      this.particleEmitter.updateParticles();\n      this.updateParticles = false;\n    }\n\n    if (this.particleEmitter.visible) {\n      this.particleEmitter.update(dt / 1000);\n    }\n  }\n});\n","export function getSanitizedComponentMapping(inputComponent, inputProperty, publicComponents) {\n  const publicComponent = publicComponents[inputComponent];\n\n  if (!publicComponent) {\n    throw new Error(`Component \"${inputComponent}\" is not public.`);\n  }\n\n  const publicProperty = publicComponent.publicProperties[inputProperty];\n\n  if (!publicProperty) {\n    throw new Error(`Component \"${inputComponent}\"'s property \"${inputProperty}\" is not public.`);\n  }\n\n  return {\n    mappedComponent: publicComponent.mappedComponent,\n    mappedProperty: publicProperty.mappedProperty,\n    getMappedValue: publicProperty.getMappedValue\n  };\n}\n","import \"./components/gltf-model-plus\";\nimport { getSanitizedComponentMapping } from \"./utils/component-mappings\";\nimport { isHubsDestinationUrl } from \"./utils/media-url-utils\";\nconst PHYSICS_CONSTANTS = require(\"aframe-physics-system/src/constants\"),\n  TYPE = PHYSICS_CONSTANTS.TYPE,\n  SHAPE = PHYSICS_CONSTANTS.SHAPE,\n  FIT = PHYSICS_CONSTANTS.FIT;\nconst COLLISION_LAYERS = require(\"./constants\").COLLISION_LAYERS;\n\nAFRAME.GLTFModelPlus.registerComponent(\"duck\", \"duck\");\nAFRAME.GLTFModelPlus.registerComponent(\"quack\", \"quack\");\nAFRAME.GLTFModelPlus.registerComponent(\"sound\", \"sound\");\nAFRAME.GLTFModelPlus.registerComponent(\"css-class\", \"css-class\");\nAFRAME.GLTFModelPlus.registerComponent(\"interactable\", \"css-class\", (el, componentName) => {\n  el.setAttribute(componentName, \"interactable\");\n});\nAFRAME.GLTFModelPlus.registerComponent(\"super-spawner\", \"super-spawner\", (el, componentName, componentData) => {\n  //TODO: Do not automatically add these components\n  el.setAttribute(\"is-remote-hover-target\", \"\");\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\n  el.setAttribute(\"hoverable-visuals\", {\n    cursorController: \"#cursor-controller\"\n  });\n  el.setAttribute(componentName, componentData);\n});\nAFRAME.GLTFModelPlus.registerComponent(\"gltf-model-plus\", \"gltf-model-plus\");\nAFRAME.GLTFModelPlus.registerComponent(\"media-loader\", \"media-loader\");\nAFRAME.GLTFModelPlus.registerComponent(\"body\", \"ammo-body\", el => {\n  //This is only required for migration of old environments with super-spawners\n  //will no longer be needed when spawners are added via Spoke instead.\n  el.setAttribute(\"ammo-body\", {\n    mass: 0,\n    type: TYPE.STATIC,\n    collisionFilterGroup: COLLISION_LAYERS.INTERACTABLES,\n    collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER\n  });\n});\nAFRAME.GLTFModelPlus.registerComponent(\"ammo-shape\", \"ammo-shape\");\nAFRAME.GLTFModelPlus.registerComponent(\"hide-when-quality\", \"hide-when-quality\");\nAFRAME.GLTFModelPlus.registerComponent(\"light\", \"light\", (el, componentName, componentData) => {\n  if (componentData.distance === 0) {\n    componentData.decay = 0;\n  }\n  el.setAttribute(componentName, componentData);\n  if (componentData.castShadow) {\n    // HACK: component.light isn't set until one frame after setArrtibute\n    setTimeout(() => {\n      el.components.light.light.shadow.camera.matrixNeedsUpdate = true;\n    }, 0);\n  }\n});\nAFRAME.GLTFModelPlus.registerComponent(\"ambient-light\", \"ambient-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"directional-light\", \"directional-light\");\nAFRAME.GLTFModelPlus.registerComponent(\"hemisphere-light\", \"hemisphere-light\");\nfunction decayMigration(el, componentName, componentData) {\n  if (componentData.range === 0) {\n    componentData.decay = 0;\n  }\n  el.setAttribute(componentName, componentData);\n}\nAFRAME.GLTFModelPlus.registerComponent(\"point-light\", \"point-light\", decayMigration);\nAFRAME.GLTFModelPlus.registerComponent(\"spot-light\", \"spot-light\", decayMigration);\n\nAFRAME.GLTFModelPlus.registerComponent(\"skybox\", \"skybox\");\nAFRAME.GLTFModelPlus.registerComponent(\"layers\", \"layers\");\nAFRAME.GLTFModelPlus.registerComponent(\"shadow\", \"shadow\");\nAFRAME.GLTFModelPlus.registerComponent(\"water\", \"water\");\nAFRAME.GLTFModelPlus.registerComponent(\"scale-audio-feedback\", \"scale-audio-feedback\");\nAFRAME.GLTFModelPlus.registerComponent(\"animation-mixer\", \"animation-mixer\");\nAFRAME.GLTFModelPlus.registerComponent(\"loop-animation\", \"loop-animation\");\nAFRAME.GLTFModelPlus.registerComponent(\n  \"box-collider\",\n  \"ammo-shape\",\n  (() => {\n    const euler = new THREE.Euler();\n    return (el, componentName, componentData) => {\n      const { scale, rotation } = componentData;\n      euler.set(rotation.x, rotation.y, rotation.z);\n      const orientation = new THREE.Quaternion().setFromEuler(euler);\n      el.setAttribute(componentName, {\n        type: SHAPE.BOX,\n        fit: FIT.MANUAL,\n        offset: componentData.position,\n        halfExtents: { x: scale.x / 2, y: scale.y / 2, z: scale.z / 2 },\n        orientation\n      });\n    };\n  })()\n);\nAFRAME.GLTFModelPlus.registerComponent(\"visible\", \"visible\", (el, componentName, componentData) => {\n  if (typeof componentData === \"object\") {\n    el.setAttribute(componentName, componentData.visible);\n  } else {\n    el.setAttribute(componentName, componentData);\n  }\n});\nAFRAME.GLTFModelPlus.registerComponent(\"spawn-point\", \"spawn-point\");\nAFRAME.GLTFModelPlus.registerComponent(\"sticky-zone\", \"sticky-zone\");\nAFRAME.GLTFModelPlus.registerComponent(\"nav-mesh\", \"nav-mesh\", (el, _componentName, componentData) => {\n  const nav = AFRAME.scenes[0].systems.nav;\n  const zone = componentData.zone || \"character\";\n  let found = false;\n  el.object3D.traverse(node => {\n    if (node.isMesh && !found) {\n      found = true;\n      nav.loadMesh(node, zone);\n    }\n  });\n  // There isn't actually an a-frame nav-mesh component, but we want to tag this el as a nav-mesh since\n  // nav-mesh-helper will query for it later.\n  el.setAttribute(\"nav-mesh\");\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"pinnable\", \"pinnable\");\n\nAFRAME.GLTFModelPlus.registerComponent(\"media\", \"media\", (el, componentName, componentData) => {\n  if (componentData.id) {\n    el.setAttribute(\"networked\", {\n      template: \"#interactable-media\",\n      owner: \"scene\",\n      persistent: true,\n      networkId: componentData.id\n    });\n  }\n\n  el.setAttribute(\"media-loader\", {\n    src: componentData.src,\n    resize: true,\n    resolve: true,\n    fileIsOwned: true,\n    animate: false,\n    contentSubtype: componentData.contentSubtype\n  });\n\n  if (componentData.pageIndex) {\n    el.setAttribute(\"media-pager\", { index: componentData.pageIndex });\n  }\n\n  if (componentData.paused !== undefined) {\n    el.setAttribute(\"media-video\", { videoPaused: componentData.paused });\n  }\n\n  if (componentData.time) {\n    el.setAttribute(\"media-video\", { time: componentData.time });\n  }\n});\n\nfunction mediaInflator(el, componentName, componentData, components) {\n  let isControlled = true;\n\n  if (components.networked) {\n    // TODO: When non-hubs links can be traversed, make all link components controlled so you can open them.\n    isControlled =\n      componentData.controls || isHubsDestinationUrl(componentData.src) || isHubsDestinationUrl(componentData.href);\n\n    const hasVolume = componentName === \"video\";\n    const templateName = isControlled || hasVolume ? \"#static-controlled-media\" : \"#static-media\";\n\n    el.setAttribute(\"networked\", {\n      template: templateName,\n      owner: \"scene\",\n      persistent: true,\n      networkId: components.networked.id\n    });\n  }\n\n  const mediaOptions = {};\n\n  if (componentName === \"video\" || componentName === \"image\") {\n    mediaOptions.projection = componentData.projection;\n  }\n\n  if (componentName === \"video\") {\n    mediaOptions.videoPaused = !componentData.autoPlay;\n    mediaOptions.volume = componentData.volume;\n    mediaOptions.loop = componentData.loop;\n    mediaOptions.audioType = componentData.audioType;\n    mediaOptions.hidePlaybackControls = !isControlled;\n\n    if (componentData.audioType === \"pannernode\") {\n      mediaOptions.distanceModel = componentData.distanceModel;\n      mediaOptions.rolloffFactor = componentData.rolloffFactor;\n      mediaOptions.refDistance = componentData.refDistance;\n      mediaOptions.maxDistance = componentData.maxDistance;\n      mediaOptions.coneInnerAngle = componentData.coneInnerAngle;\n      mediaOptions.coneOuterAngle = componentData.coneOuterAngle;\n      mediaOptions.coneOuterGain = componentData.coneOuterGain;\n    }\n\n    el.setAttribute(\"video-pause-state\", { paused: mediaOptions.videoPaused });\n  }\n\n  const src = componentName === \"link\" ? componentData.href : componentData.src;\n\n  el.setAttribute(\"media-loader\", {\n    src,\n    resize: true,\n    resolve: true,\n    fileIsOwned: true,\n    animate: false,\n    mediaOptions\n  });\n}\n\nAFRAME.GLTFModelPlus.registerComponent(\"image\", \"image\", mediaInflator);\nAFRAME.GLTFModelPlus.registerComponent(\"video\", \"video\", mediaInflator, (name, property, value) => {\n  if (property === \"paused\") {\n    return { name: \"video-pause-state\", property, value };\n  } else {\n    return null;\n  }\n});\nAFRAME.GLTFModelPlus.registerComponent(\"link\", \"link\", mediaInflator);\n\nAFRAME.GLTFModelPlus.registerComponent(\"hoverable\", \"is-remote-hover-target\", el => {\n  el.setAttribute(\"is-remote-hover-target\", \"\");\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"spawner\", \"spawner\", (el, componentName, componentData) => {\n  el.setAttribute(\"media-loader\", {\n    src: componentData.src,\n    resolve: true,\n    fileIsOwned: true,\n    animate: false\n  });\n  el.setAttribute(\"css-class\", \"interactable\");\n  el.setAttribute(\"super-spawner\", {\n    src: componentData.src,\n    resolve: true,\n    template: \"#interactable-media\"\n  });\n  el.setAttribute(\"hoverable-visuals\", {\n    cursorController: \"#cursor-controller\"\n  });\n  el.setAttribute(\"ammo-body\", {\n    mass: 0,\n    type: TYPE.STATIC,\n    collisionFilterGroup: COLLISION_LAYERS.INTERACTABLES,\n    collisionFilterMask: COLLISION_LAYERS.DEFAULT_SPAWNER\n  });\n  el.setAttribute(\"is-remote-hover-target\", \"\");\n  el.setAttribute(\"tags\", { isHandCollisionTarget: true });\n});\n\nconst publicComponents = {\n  video: {\n    mappedComponent: \"video-pause-state\",\n    publicProperties: {\n      paused: {\n        mappedProperty: \"paused\",\n        getMappedValue(value) {\n          return !!value;\n        }\n      }\n    }\n  },\n  \"loop-animation\": {\n    mappedComponent: \"loop-animation\",\n    publicProperties: {\n      paused: {\n        mappedProperty: \"paused\",\n        getMappedValue(value) {\n          return !!value;\n        }\n      }\n    }\n  }\n};\n\nAFRAME.GLTFModelPlus.registerComponent(\n  \"trigger-volume\",\n  \"trigger-volume\",\n  (el, componentName, componentData, components, indexToEntityMap) => {\n    const {\n      size,\n      target,\n      enterComponent,\n      enterProperty,\n      enterValue,\n      leaveComponent,\n      leaveProperty,\n      leaveValue\n    } = componentData;\n\n    let enterComponentMapping, leaveComponentMapping, targetEntity;\n\n    try {\n      enterComponentMapping = getSanitizedComponentMapping(enterComponent, enterProperty, publicComponents);\n      leaveComponentMapping = getSanitizedComponentMapping(leaveComponent, leaveProperty, publicComponents);\n\n      targetEntity = indexToEntityMap[target];\n\n      if (!targetEntity) {\n        throw new Error(`Couldn't find target entity with index: ${target}.`);\n      }\n    } catch (e) {\n      console.warn(`Error inflating gltf component \"trigger-volume\": ${e.message}`);\n      return;\n    }\n\n    // Filter out scope and colliders properties.\n    el.setAttribute(\"trigger-volume\", {\n      colliders: \"#player-camera\",\n      size,\n      target: targetEntity,\n      enterComponent: enterComponentMapping.mappedComponent,\n      enterProperty: enterComponentMapping.mappedProperty,\n      enterValue: enterComponentMapping.getMappedValue(enterValue),\n      leaveComponent: leaveComponentMapping.mappedComponent,\n      leaveProperty: leaveComponentMapping.mappedProperty,\n      leaveValue: leaveComponentMapping.getMappedValue(leaveValue)\n    });\n  }\n);\n\nAFRAME.GLTFModelPlus.registerComponent(\"heightfield\", \"heightfield\", (el, componentName, componentData) => {\n  el.setAttribute(\"ammo-shape__heightfield\", {\n    type: SHAPE.HEIGHTFIELD,\n    margin: 0.01,\n    fit: FIT.MANUAL,\n    heightfieldDistance: componentData.distance,\n    offset: componentData.offset,\n    heightfieldData: componentData.data\n  });\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"trimesh\", \"trimesh\", el => {\n  el.setAttribute(\"ammo-shape__trimesh\", {\n    type: SHAPE.MESH,\n    margin: 0.01,\n    fit: FIT.ALL,\n    includeInvisible: true\n  });\n});\n\nAFRAME.GLTFModelPlus.registerComponent(\"particle-emitter\", \"particle-emitter\");\n","module.exports = __webpack_public_path__ + \"assets/images/logo-8f1dfd234d060073524bc29912a24f75.svg\";","module.exports = __webpack_public_path__ + \"assets/images/giphy_logo-1dcbee43e18919c0bd0c999be8602628.png\";","// Utilities for manipulating state history. This provides a number of functions which\n// need to be used to manipulate history state so we can deal with edge cases around\n// entry back button and refreshes once entered.\n//\n// These functions also transparently deal with the room slug, so incoming calls can ignore\n// dealing with it, and provides APIs for getting the non-slug part of the path.\n//\n// The slug cannot be part of the basename for history, because the slug changes intra-session\n// if the room is renamed.\n\n// This pushes/replaces a new k, v pair into the history, while maintaining all the other\n// keys, or clears state if k if null.\n//\n// Also maintains a length key that can be used to find the length of the history chain\n// (across refreshes) for the current room.\nfunction pushOrUpdateHistory(history, replace, k, v, detail, newPathname, newSearch) {\n  let state = {};\n  const newLength = ((history.location.state && history.location.state.__historyLength) || 0) + (replace ? 0 : 1);\n\n  if (k || newPathname || newSearch) {\n    state = history.location.state ? { ...history.location.state } : {};\n    delete state.__duplicate;\n\n    if (k) {\n      state[k] = v;\n      state.key = k;\n      state.value = v;\n      state.detail = detail;\n    }\n  }\n\n  const pathname =\n    newPathname !== undefined ? newPathname : history.location.pathname === \"/\" ? \"\" : history.location.pathname;\n\n  const search = newSearch !== undefined ? newSearch : history.location.search;\n\n  // If popToBeginningOfHubHistory was previously used, there is a duplicate entry\n  // at the top of the history stack (which was needed to wipe out forward history)\n  // so we use this opportunity to replace it.\n  const isDuplicate = history.location.state && history.location.state.__duplicate;\n  const method = replace || isDuplicate ? history.replace : history.push;\n  state.__historyLength = newLength;\n\n  method({ pathname, search, state });\n}\n\nexport function pushHistoryState(history, k, v, detail) {\n  pushOrUpdateHistory(history, false, k, v, detail);\n}\n\nexport function replaceHistoryState(history, k, v, detail) {\n  pushOrUpdateHistory(history, true, k, v, detail);\n}\n\nexport function pushHistoryPath(history, path, search) {\n  pushOrUpdateHistory(history, false, null, null, null, path, search);\n}\n\nexport function clearHistoryState(history) {\n  pushOrUpdateHistory(history, false);\n}\n\n// This will pop the browser history to the first entry that was for this hubs room,\n// and then push a duplicate entry onto the history stack in order to wipe out forward\n// history.\nexport function popToBeginningOfHubHistory(history, navigateToPriorPage) {\n  if (!history.location.state || history.location.state.__historyLength === undefined) return;\n\n  const len = history.location.state.__historyLength;\n  if (len === 0) return;\n\n  return new Promise(resolve => {\n    // After the go() completes, we push a duplicate history entry onto the stack\n    // in order to wipe out forward history. We also optionally go back -2 if we wanted\n    // to go back to the prior page.\n    const unsubscribe = history.listen(() => {\n      unsubscribe();\n      history.push({\n        pathname: history.location.pathname,\n        search: history.location.search,\n        state: { __historyLength: 0, __duplicate: true }\n      });\n      if (navigateToPriorPage) history.go(-2); // Go back to history entry before beginning.\n      resolve();\n    });\n\n    history.go(-len);\n  });\n}\n\n// This will pop the browser history to the entry before the first entry for this hubs room.\nexport function navigateToPriorPage(history) {\n  popToBeginningOfHubHistory(history, true);\n}\n\n// Returns the part of the pathname that does not include the slug\nexport function sluglessPath(location) {\n  const parts = location.pathname.split(\"/\");\n  return `/${parts.slice(2).join(\"/\")}`;\n}\n\n// Returns a new path that includes the current slug as a prefix to the\n// provided path.\nexport function withSlug(location, path) {\n  const parts = location.pathname.split(\"/\");\n  return `/${parts[1]}${path}`;\n}\n","module.exports = \"data:image/gif;base64,R0lGODlhEAAQAIQaAAAAAAEBAQABBQEBAgEBBQMDAwAykwBk+wFk+/85Af47AwCIHgCJHgGJHgCKHgOJIPc63vc64Pc64YeHhwDySLu7wru8wru8w7y8wwD6/v///////////////////////yH+EUNyZWF0ZWQgd2l0aCBHSU1QACH5BAEKAB8ALAAAAAAQABAAAAVl4AeMZDl9KAqkLDqd6YrN9HzC4jdbTUPDMBnGQWEAKphBYKTSYR6LRQE5y+VmlUAAc+lWrMIa4nBYxXQJcabMkkUUtLGhJZNA4BiC4HyVSCJpKRhgOktmgoRVLDSELY5mTHQlKyEAOw==\"","module.exports = __webpack_public_path__ + \"assets/camera_tool-a25d0894a6b635779bd4ed41f2de0411.glb\";","module.exports = __webpack_public_path__ + \"assets/images/mic_granted-5d41c8098b2c1a084f07dd3a2473983f.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_granted@2x-f84d9eb002832eeeb768529e6cb1e93e.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_small-b81b3397cc985eb8d3d67a4f007158cc.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_small@2x-d04ff548fa26495f69249f0c34f44b72.png\";","module.exports = __webpack_public_path__ + \"assets/images/dropdown_arrow-601450f494125f8caccec2271aebd4cb.png\";","module.exports = __webpack_public_path__ + \"assets/images/dropdown_arrow@2x-1023ab0bd743b3525d99986de89f0c3b.png\";","module.exports = __webpack_public_path__ + \"assets/images/add-owner-c3f352da151b4a5be71defd565720235.png\";","module.exports = __webpack_public_path__ + \"assets/images/remove-owner-02b96ad3a84badda798fde00ac4c2243.png\";","module.exports = __webpack_public_path__ + \"assets/images/mobile_screen_entry-b29fcd32c8f70bb828c1abceb62f93e2.svg\";","module.exports = __webpack_public_path__ + \"assets/images/desktop_screen_entry-e5ff9b5e64caa694e9b4183e532fcb17.svg\";","module.exports = __webpack_public_path__ + \"assets/images/generic_vr_entry-c648c26ce1388450df7edbd92ec00f5e.svg\";","module.exports = __webpack_public_path__ + \"assets/sfx/tick-b0fcbf1d9b6f92a24bec12f9bae1e42a.mp3\";","module.exports = __webpack_public_path__ + \"assets/images/gearvr_entry-dcea59d35d7fae4c8b9c4985c1743851.svg\";","module.exports = __webpack_public_path__ + \"assets/images/daydream_entry-6e2716960046992dbd6b0e87bf8c2c3a.svg\";","module.exports = __webpack_public_path__ + \"assets/images/link_dialog_header-b15568ca2056d8be7a58c359e6a9ca51.svg\";","module.exports = __webpack_public_path__ + \"assets/images/presence_phone-fd7ea0e8be441172a758704055604e5f.png\";","module.exports = __webpack_public_path__ + \"assets/images/presence_desktop-be24a9f21df60cd831ad66b67282d6f2.png\";","module.exports = __webpack_public_path__ + \"assets/images/presence_discord-e05ead6e6ebc08df9291738d0aa6986d.png\";","module.exports = __webpack_public_path__ + \"assets/images/presence_camera-aaa719190a30677416c33e3dda33d7ef.png\";","module.exports = __webpack_public_path__ + \"assets/images/presence_vr-563f3bd1c0f37473a3303f4a6049288c.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_background-9744d0690bba7838e4a75949d9645c09.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_background@2x-bf55b6a808963d89ff7ce04c516c232c.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_fill-35626a008836cbdc34ec624e16f5b723.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_fill@2x-b3e3675f8281c84660fb5b47eb66126e.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_level-d197b930a4350dc80adb2446babb05e1.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_level@2x-9d49309c2f0e55e5c54193237658768b.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_action_background-5aeb2dca8113545a2bc3e56dc702001b.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_action_background@2x-3a7ab65c95a1b4037d701c8fa16c3cd6.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_action_fill-4e639ed717b8a9a7da4426665ec2dcf4.png\";","module.exports = __webpack_public_path__ + \"assets/images/level_action_fill@2x-eb547f6337c0ea74b35da9812ee3e04b.png\";","module.exports = __webpack_public_path__ + \"assets/images/speaker_level-9567a1a6f33d4d0e59e57903b08369c9.png\";","module.exports = __webpack_public_path__ + \"assets/images/speaker_level@2x-b5e6a12f613576cf5c1a1b96e8c9d8d0.png\";","module.exports = __webpack_public_path__ + \"assets/sfx/tone-624e72d19fe0cea1b85ca174cb6be256.webm\";","module.exports = __webpack_public_path__ + \"assets/sfx/tone-3fa0defb5172b2533fedcc1929605799.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/tone-78ae5a60f0e336f384919eee9f5a2e18.ogg\";","module.exports = __webpack_public_path__ + \"assets/sfx/tone-4604a4c98f36f3e0c6980295bc5c7ffe.wav\";","module.exports = __webpack_public_path__ + \"assets/images/change_avatar-a426739806600c28e20a614cbade29f2.svg\";","import { fetchReticulumAuthenticated } from \"./phoenix-utils\";\nimport { proxiedUrlFor } from \"./media-url-utils\";\nimport { avatars } from \"../assets/avatars/avatars\";\n\nexport const AVATAR_TYPES = {\n  LEGACY: \"legacy\",\n  SKINNABLE: \"skinnable\",\n  URL: \"url\"\n};\n\nconst legacyAvatarIds = avatars.map(a => a.id);\nexport function getAvatarType(avatarId) {\n  if (!avatarId || legacyAvatarIds.indexOf(avatarId) !== -1) return AVATAR_TYPES.LEGACY;\n  if (avatarId.startsWith(\"http\")) return AVATAR_TYPES.URL;\n  return AVATAR_TYPES.SKINNABLE;\n}\n\nasync function fetchSkinnableAvatar(avatarId) {\n  const resp = await fetchReticulumAuthenticated(`/api/v1/avatars/${avatarId}`);\n  return resp && resp.avatars && resp.avatars[0];\n}\n\nexport async function fetchAvatar(avatarId) {\n  switch (getAvatarType(avatarId)) {\n    case AVATAR_TYPES.LEGACY:\n      return {\n        avatar_id: avatarId,\n        gltf_url: avatars.find(avatar => avatar.id === avatarId).model\n      };\n    case AVATAR_TYPES.SKINNABLE:\n      return fetchSkinnableAvatar(avatarId);\n    case AVATAR_TYPES.URL:\n      return {\n        avatar_id: avatarId,\n        gltf_url: proxiedUrlFor(avatarId)\n      };\n  }\n}\n\nasync function fetchAvatarGltfUrl(avatarId) {\n  return fetchAvatar(avatarId).then(avatar => avatar && avatar.gltf_url);\n}\n\nexport function getAvatarSrc(avatarId) {\n  switch (getAvatarType(avatarId)) {\n    case AVATAR_TYPES.LEGACY:\n      return `#${avatarId}`;\n    case AVATAR_TYPES.SKINNABLE:\n      return fetchAvatarGltfUrl(avatarId);\n    case AVATAR_TYPES.URL:\n      return proxiedUrlFor(avatarId);\n    default:\n      return avatarId;\n  }\n}\n\nexport async function getAvatarThumbnailUrl(avatarId) {\n  switch (getAvatarType(avatarId)) {\n    case AVATAR_TYPES.LEGACY:\n      return avatars.find(avatar => avatar.id === avatarId).thumbnail;\n    case AVATAR_TYPES.SKINNABLE:\n      return fetchAvatar(avatarId).then(avatar => avatar.files.thumbnail);\n    default:\n      return \"https://asset-bundles-prod.reticulum.io/bots/avatar_unavailable.png\";\n  }\n}\n","module.exports = \"#version 300 es\\nprecision highp float;\\nprecision highp int;\\n\\n// Keep these separate so three only sets them once\\nuniform mat4 viewMatrix;\\nuniform mat4 projectionMatrix;\\n\\nlayout(std140) uniform InstanceData {\\n  mat4 transforms[MAX_INSTANCES];\\n  vec4 colors[MAX_INSTANCES];\\n  vec4 uvTransforms[MAX_INSTANCES];\\n  vec4 mapSettings[MAX_INSTANCES];\\n\\n  vec4 hubs_SweepParams[MAX_INSTANCES];\\n\\n  vec3 hubs_InteractorOnePos;\\n  bool hubs_IsFrozen;\\n\\n  vec3 hubs_InteractorTwoPos;\\n  float hubs_Time;\\n\\n} instanceData;\\n\\nout vec3 hubs_WorldPosition;\\n\\nin vec3 position;\\nin vec2 uv;\\n\\n#ifdef PSEUDO_INSTANCING\\nin float instance;\\nflat out uint vInstance;\\n#endif\\n\\n#ifdef VERTEX_COLORS\\nin vec3 color;\\n#endif\\n\\nout vec2 vUv;\\nout vec4 vColor;\\n\\nflat out vec4 vUVTransform;\\nflat out vec4 vMapSettings;\\n\\nvoid main() {\\n  #ifdef PSEUDO_INSTANCING\\n  uint instanceIndex = uint(instance);\\n  #elif\\n  uint instanceIndex = gl_InstanceID;\\n  #endif\\n\\n  vColor = instanceData.colors[instanceIndex];\\n\\n  #ifdef VERTEX_COLORS\\n  vColor *= vec4(color, 1.0);\\n  #endif\\n\\n  vUv = uv;\\n  vUVTransform = instanceData.uvTransforms[instanceIndex];\\n  vMapSettings = instanceData.mapSettings[instanceIndex];\\n\\n  gl_Position = projectionMatrix * viewMatrix * instanceData.transforms[instanceIndex] * vec4(position, 1.0);\\n\\n  hubs_WorldPosition = (instanceData.transforms[instanceIndex] * vec4(position, 1.0)).xyz;\\n  vInstance = instanceIndex;\\n}\\n\"","module.exports = \"#version 300 es\\nprecision highp float;\\nprecision highp int;\\nprecision highp sampler2DArray;\\n\\n\\nlayout(std140) uniform InstanceData {\\n  mat4 transforms[MAX_INSTANCES];\\n  vec4 colors[MAX_INSTANCES];\\n  vec4 uvTransforms[MAX_INSTANCES];\\n  vec4 mapSettings[MAX_INSTANCES];\\n\\n  vec4 hubs_SweepParams[MAX_INSTANCES];\\n\\n  vec3 hubs_InteractorOnePos;\\n  bool hubs_IsFrozen;\\n\\n  vec3 hubs_InteractorTwoPos;\\n  float hubs_Time;\\n\\n} instanceData;\\nin vec3 hubs_WorldPosition;\\n#ifdef PSEUDO_INSTANCING\\nflat in uint vInstance;\\n#endif\\n\\n\\nuniform sampler2DArray map;\\n\\nin vec2 vUv;\\nin vec4 vColor;\\nflat in vec4 vUVTransform;\\nflat in vec4 vMapSettings;\\n\\nout vec4 outColor;\\n\\nfloat applyWrapping(float value, int mode) {\\n  if (mode == 0) {\\n    // CLAMP_TO_EDGE - default\\n    return clamp(value, 0.0, 1.0);\\n  } else if (mode == 1) {\\n    // REPEAT\\n    return fract(value);\\n  } else {\\n    // MIRRORED_REPEAT\\n    float n = mod(value, 2.0);\\n    return mix(n, 2.0 - n, step(1.0, n));\\n  }\\n}\\n\\nvoid main() {\\n  vec2 uv = vUv;\\n\\n  int wrapS = int(vMapSettings.y);\\n  int wrapT = int(vMapSettings.z);\\n  uv.s = applyWrapping(uv.s, wrapS);\\n  uv.t = applyWrapping(uv.t, wrapT);\\n\\n  vec2 uvMin = vUVTransform.xy;\\n  vec2 uvScale = vUVTransform.zw;\\n  uv = uvMin + uv * uvScale;\\n\\n  int mapIdx = int(vMapSettings.x);\\n  outColor = texture(map, vec3(uv, mapIdx)) * vColor;\\n  if(outColor.a == 0.0) {\\n      discard;\\n  }\\n\\n  bool hubs_HighlightInteractorOne = instanceData.hubs_SweepParams[vInstance].z > 0.0;\\n  bool hubs_HighlightInteractorTwo = instanceData.hubs_SweepParams[vInstance].w > 0.0;\\n  bool hubs_IsFrozen = instanceData.hubs_IsFrozen;\\n\\n  if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\\n\\n      bool hubs_EnableSweepingEffect = true;\\n      vec2 hubs_SweepParams = instanceData.hubs_SweepParams[vInstance].xy;\\n      float hubs_Time = instanceData.hubs_Time;\\n\\n      float ratio = 0.0;\\n\\n      if (hubs_EnableSweepingEffect) {\\n          float size = hubs_SweepParams.t - hubs_SweepParams.s;\\n          float line = mod(hubs_Time / 500.0 * size, size * 3.0) + hubs_SweepParams.s - size / 3.0;\\n\\n          if (hubs_WorldPosition.y < line) {\\n              // Highlight with a sweeping gradient.\\n              ratio = max(0.0, 1.0 - (line - hubs_WorldPosition.y) / (size * 1.5));\\n          }\\n      }\\n\\n      // Highlight with a gradient falling off with distance.\\n      float pulse = 9.0 + 3.0 * (sin(hubs_Time / 1000.0) + 1.0);\\n\\n      if (hubs_HighlightInteractorOne) {\\n          float dist1 = distance(hubs_WorldPosition, instanceData.hubs_InteractorOnePos);\\n          ratio += -min(1.0, pow(dist1 * pulse, 3.0)) + 1.0;\\n      }\\n\\n      if (hubs_HighlightInteractorTwo) {\\n          float dist2 = distance(hubs_WorldPosition, instanceData.hubs_InteractorTwoPos);\\n          ratio += -min(1.0, pow(dist2 * pulse, 3.0)) + 1.0;\\n      }\\n\\n      ratio = min(1.0, ratio);\\n\\n      // Gamma corrected highlight color\\n      vec3 highlightColor = vec3(0.184, 0.499, 0.933);\\n\\n      outColor = vec4((outColor.rgb * (1.0 - ratio)) + (highlightColor * ratio), outColor.a);\\n  }\\n\\n}\\n\"","module.exports = __webpack_public_path__ + \"assets/images/spritesheets/sprite-system-spritesheet-130dcf3207a49678c64825cb92d8cb8f.png\";","module.exports = \"attribute vec4 mvCol0;\\nattribute vec4 mvCol1;\\nattribute vec4 mvCol2;\\nattribute vec4 mvCol3;\\nattribute vec3 a_vertices;\\nattribute vec2 a_uvs;\\nvarying vec2 v_uvs;\\nattribute float a_hubs_EnableSweepingEffect;\\nvarying float v_hubs_EnableSweepingEffect;\\nattribute vec2 a_hubs_SweepParams;\\nvarying vec2 v_hubs_SweepParams;\\nvarying vec3 hubs_WorldPosition;\\n\\nvoid main() {\\n  mat4 mv = mat4(mvCol0, mvCol1, mvCol2, mvCol3);\\n  gl_Position = projectionMatrix * modelViewMatrix * mv * vec4(a_vertices, 1.0);\\n  v_uvs = a_uvs;\\n  v_hubs_EnableSweepingEffect = a_hubs_EnableSweepingEffect;\\n  v_hubs_SweepParams = a_hubs_SweepParams;\\n\\n  vec4 wt = vec4(a_vertices, 1.0);\\n  hubs_WorldPosition = (mv * wt).xyz;\\n}\\n\"","module.exports = \"precision mediump float;\\n\\nuniform sampler2D u_spritesheet;\\n\\nvarying vec2 v_uvs;\\n\\nvarying float v_hubs_EnableSweepingEffect;\\nvarying vec2 v_hubs_SweepParams;\\nvarying vec3 hubs_WorldPosition;\\nuniform bool hubs_HighlightInteractorOne;\\nuniform vec3 hubs_InteractorOnePos;\\nuniform bool hubs_HighlightInteractorTwo;\\nuniform vec3 hubs_InteractorTwoPos;\\nuniform float hubs_Time;\\n\\n#define GAMMA_FACTOR 2.2\\n\\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\\n  return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\\n}\\n\\nvec4 linearToOutputTexel( vec4 value ) {\\n  return LinearToGamma( value, float( GAMMA_FACTOR ) );\\n}\\n\\nvoid main() {\\n    vec4 texColor = texture2D(u_spritesheet, v_uvs);\\n\\n    float ratio = 0.0;\\n    if (v_hubs_EnableSweepingEffect > 0.9 ) {\\n        float size = v_hubs_SweepParams.t - v_hubs_SweepParams.s * 1.0;\\n        float line = mod(hubs_Time / 500.0 * size, size * 3.0) + v_hubs_SweepParams.s - size / 3.0;\\n        if (hubs_WorldPosition.y < line) {\\n            ratio = max(0.0, 1.0 - (line - hubs_WorldPosition.y) / (size * 1.5));\\n        }\\n\\n    }\\n    ratio = min(1.0, ratio);\\n\\n    vec4 highlightColor = linearToOutputTexel(vec4(0.184, 0.499, 0.933, 1.0));\\n    gl_FragColor = vec4((texColor.rgb * (1.0 - ratio)) + (highlightColor.rgb * ratio), texColor.a);\\n}\\n\"","const nonCorsProxyDomains = (process.env.NON_CORS_PROXY_DOMAINS || \"\").split(\",\");\nif (process.env.CORS_PROXY_SERVER) {\n  nonCorsProxyDomains.push(process.env.CORS_PROXY_SERVER);\n}\n\nconst commonKnownContentTypes = {\n  gltf: \"model/gltf\",\n  glb: \"model/gltf-binary\",\n  png: \"image/png\",\n  jpg: \"image/jpeg\",\n  jpeg: \"image/jpeg\",\n  pdf: \"application/pdf\",\n  mp4: \"video/mp4\",\n  mp3: \"audio/mpeg\"\n};\n\n// thanks to https://developer.mozilla.org/en-US/docs/Web/API/WindowBase64/Base64_encoding_and_decoding\nfunction b64EncodeUnicode(str) {\n  // first we use encodeURIComponent to get percent-encoded UTF-8, then we convert the percent-encodings\n  // into raw bytes which can be fed into btoa.\n  const CHAR_RE = /%([0-9A-F]{2})/g;\n  return btoa(encodeURIComponent(str).replace(CHAR_RE, (_, p1) => String.fromCharCode(\"0x\" + p1)));\n}\n\nconst farsparkEncodeUrl = url => {\n  // farspark doesn't know how to read '=' base64 padding characters\n  // translate base64 + to - and / to _ for URL safety\n  return b64EncodeUnicode(url)\n    .replace(/=+$/g, \"\")\n    .replace(/\\+/g, \"-\")\n    .replace(/\\//g, \"_\");\n};\n\nexport const scaledThumbnailUrlFor = (url, width, height) => {\n  const farsparkUrl = `https://${process.env.FARSPARK_SERVER}/thumbnail/${farsparkEncodeUrl(\n    url\n  )}?w=${width}&h=${height}`;\n\n  try {\n    const urlHostname = new URL(url).hostname;\n\n    if (process.env.RETICULUM_SERVER) {\n      const retHostname = new URL(`https://${process.env.RETICULUM_SERVER}`).hostname;\n      if (retHostname === urlHostname) return url;\n    }\n  } catch (e) {\n    return farsparkUrl;\n  }\n\n  return farsparkUrl;\n};\n\nexport const proxiedUrlFor = (url, index = null) => {\n  if (!(url.startsWith(\"http:\") || url.startsWith(\"https:\"))) return url;\n\n  const hasIndex = index !== null;\n\n  if (!hasIndex) {\n    // Skip known domains that do not require CORS proxying.\n    try {\n      const parsedUrl = new URL(url);\n      if (nonCorsProxyDomains.find(domain => parsedUrl.hostname.endsWith(domain))) return url;\n    } catch (e) {\n      // Ignore\n    }\n  }\n\n  if (hasIndex || !process.env.CORS_PROXY_SERVER) {\n    const method = hasIndex ? \"extract\" : \"raw\";\n    return `https://${process.env.FARSPARK_SERVER}/0/${method}/0/0/0/${index || 0}/${farsparkEncodeUrl(url)}`;\n  } else {\n    return `https://${process.env.CORS_PROXY_SERVER}/${url}`;\n  }\n};\n\nexport const getCustomGLTFParserURLResolver = gltfUrl => url => {\n  if (typeof url !== \"string\" || url === \"\") return \"\";\n  if (/^(https?:)?\\/\\//i.test(url)) return url;\n  if (/^data:.*,.*$/i.test(url)) return url;\n  if (/^blob:.*$/i.test(url)) return url;\n\n  if (process.env.CORS_PROXY_SERVER) {\n    // For absolute paths with a CORS proxied gltf URL, re-write the url properly to be proxied\n    const corsProxyPrefix = `https://${process.env.CORS_PROXY_SERVER}/`;\n\n    if (gltfUrl.startsWith(corsProxyPrefix)) {\n      const originalUrl = decodeURIComponent(gltfUrl.substring(corsProxyPrefix.length));\n      const originalUrlParts = originalUrl.split(\"/\");\n\n      // Drop the .gltf filename\n      const path = new URL(url).pathname;\n      const assetUrl = originalUrlParts.slice(0, originalUrlParts.length - 1).join(\"/\") + \"/\" + path;\n      return corsProxyPrefix + assetUrl;\n    }\n  }\n\n  return url;\n};\n\nconst dataUrlRegex = /data:([a-zA-Z0-9]+\\/[a-zA-Z0-9-.+]+).*,.*/;\n\nexport const guessContentType = url => {\n  if (url.startsWith(\"hubs://\") && url.endsWith(\"/video\")) return \"video/vnd.hubs-webrtc\";\n  if (url.startsWith(\"data:\")) {\n    const matches = dataUrlRegex.match(url);\n    if (matches.length > 0) {\n      matches[1];\n    }\n  }\n  const extension = new URL(url, window.location).pathname.split(\".\").pop();\n  return commonKnownContentTypes[extension];\n};\nconst hubsSceneRegex = /https?:\\/\\/(hubs.local(:\\d+)?|(smoke-)?hubs.mozilla.com|(dev\\.)?reticulum.io)\\/scenes\\/(\\w+)\\/?\\S*/;\nconst hubsAvatarRegex = /https?:\\/\\/(hubs.local(:\\d+)?|(smoke-)?hubs.mozilla.com|(dev\\.)?reticulum.io)\\/avatars\\/(\\w+)\\/?\\S*/;\nconst hubsRoomRegex = /https?:\\/\\/(hubs.local(:\\d+)?|(smoke-)?hubs.mozilla.com|(dev\\.)?reticulum.io)\\/(\\w+)\\/?\\S*/;\nexport const isHubsSceneUrl = hubsSceneRegex.test.bind(hubsSceneRegex);\nexport const isHubsRoomUrl = url => !isHubsSceneUrl(url) && hubsRoomRegex.test(url);\nexport const isHubsDestinationUrl = url => isHubsSceneUrl(url) || isHubsRoomUrl(url);\nexport const isHubsAvatarUrl = hubsAvatarRegex.test.bind(hubsAvatarRegex);\n","import screenfull from \"screenfull\";\n\nlet hasEnteredFullScreenThisSession = false;\n\nfunction shouldShowFullScreen() {\n  // Disable full screen on iOS, since Safari's fullscreen mode does not let you prevent native pinch-to-zoom gestures.\n  return (\n    (AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR()) &&\n    !AFRAME.utils.device.isIOS() &&\n    screenfull.enabled\n  );\n}\n\nexport function willRequireUserGesture() {\n  return !screenfull.isFullscreen && shouldShowFullScreen();\n}\n\nexport function showFullScreenIfAvailable() {\n  if (shouldShowFullScreen()) {\n    screenfull.request();\n    hasEnteredFullScreenThisSession = true;\n  }\n}\n\nexport function showFullScreenIfWasFullScreen() {\n  if (hasEnteredFullScreenThisSession && !screenfull.isFullscreen) {\n    screenfull.request();\n  }\n}\n","const VERTEX_SHADER = `\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n  #include <uv_vertex>\n  #include <uv2_vertex>\n  #include <color_vertex>\n  #include <skinbase_vertex>\n\n  #include <begin_vertex>\n  #include <morphtarget_vertex>\n  #include <skinning_vertex>\n  #include <project_vertex>\n  #include <logdepthbuf_vertex>\n\n  #include <worldpos_vertex>\n  #include <clipping_planes_vertex>\n  #include <fog_vertex>\n}\n`;\n\nconst FRAGMENT_SHADER = `\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <aomap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n  #include <clipping_planes_fragment>\n\n  vec4 diffuseColor = vec4(diffuse, opacity);\n  ReflectedLight reflectedLight = ReflectedLight(vec3(0.0), vec3(0.0), vec3(0.0), vec3(0.0));\n  vec3 totalEmissiveRadiance = emissive;\n\n  #include <logdepthbuf_fragment>\n  #include <map_fragment>\n  #include <color_fragment>\n  #include <alphatest_fragment>\n  #include <emissivemap_fragment>\n\n  reflectedLight.indirectDiffuse += vec3(1.0);\n\n  #include <aomap_fragment>\n\n  reflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\n  vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n  gl_FragColor = vec4(outgoingLight, diffuseColor.a);\n\n  #include <premultiplied_alpha_fragment>\n  #include <tonemapping_fragment>\n  #include <encodings_fragment>\n  #include <fog_fragment>\n}\n`;\n\nexport default class MobileStandardMaterial extends THREE.ShaderMaterial {\n  type = \"MobileStandardMaterial\";\n  isMobileStandardMaterial = true;\n  static fromStandardMaterial(material) {\n    const parameters = {\n      vertexShader: VERTEX_SHADER,\n      fragmentShader: FRAGMENT_SHADER,\n      uniforms: {\n        uvTransform: { value: new THREE.Matrix3() },\n        diffuse: { value: material.color },\n        opacity: { value: material.opacity },\n        map: { value: material.map },\n        aoMapIntensity: { value: material.aoMapIntensity },\n        aoMap: { value: material.aoMap },\n        emissive: { value: material.emissive },\n        emissiveMap: { value: material.emissiveMap }\n      },\n      fog: true,\n      lights: false,\n      opacity: material.opacity,\n      transparent: material.transparent,\n      alphaTest: material.alphaTest,\n      skinning: material.skinning,\n      morphTargets: material.morphTargets,\n      vertexColors: material.vertexColors\n    };\n\n    const mobileMaterial = new MobileStandardMaterial(parameters);\n\n    mobileMaterial.color = material.color;\n    mobileMaterial.map = material.map;\n    mobileMaterial.aoMap = material.aoMap;\n    mobileMaterial.aoMapIntensity = material.aoMapIntensity;\n    mobileMaterial.emissive = material.emissive;\n    mobileMaterial.emissiveMap = material.emissiveMap;\n\n    return mobileMaterial;\n  }\n  clone() {\n    return MobileStandardMaterial.fromStandardMaterial(this);\n  }\n}\n","import { EventTarget } from \"event-target-shim\";\nimport { getReticulumFetchUrl, fetchReticulumAuthenticated } from \"../utils/phoenix-utils\";\nimport { pushHistoryPath, sluglessPath, withSlug } from \"../utils/history\";\n\nexport const SOURCES = [\"poly\", \"sketchfab\", \"videos\", \"scenes\", \"gifs\", \"images\", \"twitch\"];\n\nconst EMPTY_RESULT = { entries: [], meta: {} };\n\nconst URL_SOURCE_TO_TO_API_SOURCE = {\n  scenes: \"scene_listings\",\n  images: \"bing_images\",\n  videos: \"bing_videos\",\n  youtube: \"youtube_videos\",\n  gifs: \"tenor\",\n  sketchfab: \"sketchfab\",\n  poly: \"poly\",\n  twitch: \"twitch\",\n  favorites: \"favorites\"\n};\n\nexport const MEDIA_SOURCE_DEFAULT_FILTERS = {\n  gifs: \"trending\",\n  sketchfab: \"featured\",\n  scenes: \"featured\",\n  favorites: \"my-favorites\"\n};\n\nconst SEARCH_CONTEXT_PARAMS = [\"q\", \"filter\", \"cursor\"];\n\n// This class is responsible for fetching and storing media search results and provides a\n// convenience API for performing history updates relevant to search navigation.\nexport default class MediaSearchStore extends EventTarget {\n  constructor() {\n    super();\n\n    this.requestIndex = 0;\n  }\n\n  setHistory(history) {\n    this.history = history;\n\n    this._update(this.history.location);\n\n    this.history.listen(location => {\n      this._update(location);\n    });\n  }\n\n  _update = async location => {\n    this.result = null;\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n\n    const urlSource = this.getUrlMediaSource(location);\n    if (!urlSource) return;\n\n    if (!this.previousSource || this.previousSource !== urlSource) {\n      this.dispatchEvent(new CustomEvent(\"sourcechanged\"));\n      this.previousSource = urlSource;\n    }\n\n    const urlParams = new URLSearchParams(location.search);\n\n    this.requestIndex++;\n    const currentRequestIndex = this.requestIndex;\n    const searchParams = new URLSearchParams();\n    const locationSearchParams = new URLSearchParams(location.search);\n    const isMy = locationSearchParams.get(\"filter\") && locationSearchParams.get(\"filter\").startsWith(\"my-\");\n\n    for (const param of SEARCH_CONTEXT_PARAMS) {\n      if (!urlParams.get(param)) continue;\n      searchParams.set(param, urlParams.get(param));\n    }\n\n    searchParams.get(\"locale\", navigator.languages[0]);\n\n    let source;\n    if (urlSource === \"avatars\" || urlSource === \"scenes\") {\n      // Avatars + scenes are special since we request them from a different source based on the facet.\n      const singular = urlSource === \"avatars\" ? \"avatar\" : \"scene\";\n      source = isMy ? `${singular}s` : `${singular}_listings`;\n    } else {\n      source = URL_SOURCE_TO_TO_API_SOURCE[urlSource];\n    }\n    searchParams.set(\"source\", source);\n\n    let fetch = true;\n\n    if (source === \"avatars\" || source === \"scenes\" || source === \"favorites\") {\n      if (isMy) {\n        if (window.APP.store.credentialsAccountId) {\n          searchParams.set(\"user\", window.APP.store.credentialsAccountId);\n        } else {\n          fetch = false; // Don't fetch my-* if not signed in\n        }\n      }\n    }\n\n    const path = `/api/v1/media/search?${searchParams.toString()}`;\n    const url = getReticulumFetchUrl(path);\n    if (this.lastSavedUrl === url) return;\n\n    this.isFetching = true;\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n    const result = fetch ? await fetchReticulumAuthenticated(path) : EMPTY_RESULT;\n\n    if (this.requestIndex != currentRequestIndex) return;\n\n    this.result = result;\n    this.nextCursor = this.result && this.result.meta && this.result.meta.next_cursor;\n    this.lastFetchedUrl = url;\n    this.isFetching = false;\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n  };\n\n  _legacyAvatarToSearchEntry = legacyAvatar => {\n    return {\n      id: legacyAvatar.id,\n      type: \"avatar_listing\",\n      url: legacyAvatar.url,\n      images: { preview: { url: legacyAvatar.thumbnail, width: 720, height: 1280 } },\n      gltfs: { avatar: legacyAvatar.model }\n    };\n  };\n\n  pageNavigate = delta => {\n    if (delta === -1) {\n      this.history.goBack();\n    } else {\n      const location = this.history.location;\n      const searchParams = new URLSearchParams(location.search);\n      searchParams.set(\"cursor\", this.nextCursor);\n      pushHistoryPath(this.history, location.pathname, searchParams.toString());\n    }\n  };\n\n  filterQueryNavigate = (filter, query) => {\n    const location = this.history.location;\n    const searchParams = new URLSearchParams(location.search);\n\n    if (query) {\n      searchParams.set(\"q\", query);\n    } else {\n      searchParams.delete(\"q\");\n    }\n\n    if (filter) {\n      searchParams.set(\"filter\", filter);\n    } else {\n      searchParams.delete(\"filter\");\n    }\n\n    if (filter) {\n      searchParams.set(\"cursor\", filter);\n    } else {\n      searchParams.delete(\"cursor\");\n    }\n\n    pushHistoryPath(this.history, location.pathname, searchParams.toString());\n  };\n\n  getSearchClearedSearchParams = (location, keepSource, keepNav) => {\n    const searchParams = new URLSearchParams(location.search);\n\n    // Strip browsing query params\n    searchParams.delete(\"q\");\n    searchParams.delete(\"filter\");\n    searchParams.delete(\"cursor\");\n\n    if (!keepNav) {\n      searchParams.delete(\"media_nav\");\n    }\n\n    if (!keepSource) {\n      searchParams.delete(\"media_source\");\n    }\n\n    return searchParams;\n  };\n\n  _stashLastSearchParams = location => {\n    const searchParams = new URLSearchParams(location.search);\n\n    this._stashedParams = {};\n    this._stashedSource = null;\n\n    const source = this.getUrlMediaSource(location);\n\n    // HACK for now do not stash favorite search, since that ends up being a source\n    // we do not reveal in the media browser UX. Revisit the rules here when we have a\n    // proper favorites browser. Then, we should have two separate stashes.\n    if (source === \"favorites\") return;\n    this._stashedSource = source;\n\n    for (const param of SEARCH_CONTEXT_PARAMS) {\n      const value = searchParams.get(param);\n\n      if (value) {\n        this._stashedParams[param] = value;\n      }\n    }\n  };\n\n  clearStashedQuery = () => {\n    if (!this._stashedParams) return;\n    delete this._stashedParams.q;\n  };\n\n  sourceNavigate = source => {\n    this._sourceNavigate(source, false, true);\n  };\n\n  sourceNavigateToDefaultSource = () => {\n    this._sourceNavigate(this._stashedSource ? this._stashedSource : SOURCES[0], false, true);\n  };\n\n  sourceNavigateWithNoNav = source => {\n    this._sourceNavigate(source, true, false);\n  };\n\n  _sourceNavigate = async (source, hideNav, useLastStashedParams) => {\n    const currentQuery = new URLSearchParams(this.history.location.search).get(\"q\");\n    const searchParams = this.getSearchClearedSearchParams(this.history.location);\n\n    if (currentQuery) {\n      searchParams.set(\"q\", currentQuery);\n    } else {\n      if (useLastStashedParams && this._stashedParams) {\n        for (const param of SEARCH_CONTEXT_PARAMS) {\n          const value = this._stashedParams[param];\n\n          // Only q param is compatible across sources, so keep it if is stashed.\n          const useValue = param === \"q\" || this._stashedSource === source;\n\n          if (value && useValue) {\n            searchParams.set(param, value);\n          }\n        }\n      } else {\n        if (source === \"avatars\") {\n          const hasAccountWithAvatars = await this._hasAccountWithAvatars();\n          searchParams.set(\"filter\", hasAccountWithAvatars ? \"my-avatars\" : \"featured\");\n        } else if (MEDIA_SOURCE_DEFAULT_FILTERS[source]) {\n          searchParams.set(\"filter\", MEDIA_SOURCE_DEFAULT_FILTERS[source]);\n        }\n      }\n    }\n\n    this._stashedParams = null;\n    this._stashedSource = null;\n\n    if (hideNav) {\n      searchParams.set(\"media_nav\", \"false\");\n    }\n\n    if (process.env.RETICULUM_SERVER && document.location.host !== process.env.RETICULUM_SERVER) {\n      searchParams.set(\"media_source\", source);\n      pushHistoryPath(this.history, this.history.location.pathname, searchParams.toString());\n    } else {\n      pushHistoryPath(this.history, withSlug(this.history.location, `/media/${source}`), searchParams.toString());\n    }\n  };\n\n  _hasAccountWithAvatars = async () => {\n    const { credentialsAccountId } = window.APP.store;\n    if (!credentialsAccountId) return false;\n\n    const searchParams = new URLSearchParams();\n    const source = \"avatars\";\n    searchParams.set(\"source\", source);\n    searchParams.set(\"user\", credentialsAccountId);\n    const result = await fetchReticulumAuthenticated(`/api/v1/media/search?${searchParams.toString()}`);\n    return !!(result && result.entries) && result.entries.length > 0;\n  };\n\n  getUrlMediaSource = location => {\n    const { search } = location;\n    const urlParams = new URLSearchParams(search);\n    const pathname = sluglessPath(location);\n\n    if (!pathname.startsWith(\"/media\") && !urlParams.get(\"media_source\")) return null;\n    return urlParams.get(\"media_source\") || pathname.substring(7);\n  };\n\n  pushExitMediaBrowserHistory = (history, stashLastSearchParams = true) => {\n    if (!history) history = this.history;\n\n    if (stashLastSearchParams) this._stashLastSearchParams(history.location);\n\n    const { pathname } = history.location;\n    const hasMediaPath = sluglessPath(history.location).startsWith(\"/media\");\n    pushHistoryPath(\n      history,\n      hasMediaPath ? withSlug(history.location, \"/\") : pathname,\n      this.getSearchClearedSearchParams(history.location).toString()\n    );\n    this.dispatchEvent(new CustomEvent(\"media-exit\"));\n  };\n}\n","export const waitForEvent = function(eventName, eventObj) {\n  return new Promise(resolve => {\n    eventObj.addEventListener(eventName, resolve, { once: true });\n  });\n};\n\nexport const waitForDOMContentLoaded = function() {\n  if (document.readyState === \"complete\" || document.readyState === \"loaded\" || document.readyState === \"interactive\") {\n    return Promise.resolve(null);\n  } else {\n    return waitForEvent(\"DOMContentLoaded\", window);\n  }\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { pushHistoryState, replaceHistoryState } from \"../utils/history\";\n\nfunction isModifiedEvent(event) {\n  return !!(event.metaKey || event.altKey || event.ctrlKey || event.shiftKey);\n}\n\n/**\n * A history-aware link that pushes/replaces the state, but not the path, in the browser history.\n */\nclass StateLink extends React.Component {\n  static propTypes = {\n    history: PropTypes.object,\n    innerRef: PropTypes.object,\n    replace: PropTypes.bool,\n    stateKey: PropTypes.string,\n    stateValue: PropTypes.string,\n    stateDetail: PropTypes.object,\n    target: PropTypes.string,\n    onClick: PropTypes.func,\n    children: PropTypes.node,\n    className: PropTypes.string\n  };\n\n  async handleClick(event, history) {\n    if (this.props.onClick) this.props.onClick(event);\n\n    if (\n      !event.defaultPrevented && // onClick prevented default\n      event.button === 0 && // ignore everything but left clicks\n      (!this.props.target || this.props.target === \"_self\") && // let browser handle \"target=_blank\" etc.\n      !isModifiedEvent(event) // ignore clicks with modifier keys\n    ) {\n      event.preventDefault();\n      const method = this.props.replace ? replaceHistoryState : pushHistoryState;\n      method(history, this.props.stateKey, this.props.stateValue, this.props.stateDetail);\n    }\n  }\n\n  render() {\n    const { innerRef, target, className, children } = this.props;\n    return (\n      <a\n        target={target}\n        className={className}\n        onClick={event => this.handleClick(event, this.props.history)}\n        href=\"#\"\n        ref={innerRef}\n      >\n        {children}\n      </a>\n    );\n  }\n}\n\nexport default StateLink;\n","import nextTick from \"../utils/next-tick\";\nimport { mapMaterials } from \"../utils/material-utils\";\nimport SketchfabZipWorker from \"../workers/sketchfab-zip.worker.js\";\nimport MobileStandardMaterial from \"../materials/MobileStandardMaterial\";\nimport { textureLoader } from \"../utils/media-utils\";\nimport { getCustomGLTFParserURLResolver } from \"../utils/media-url-utils\";\nimport { promisifyWorker } from \"../utils/promisify-worker.js\";\nimport { MeshBVH, acceleratedRaycast } from \"three-mesh-bvh\";\nimport { disposeNode } from \"../utils/three-utils\";\n\nTHREE.Mesh.prototype.raycast = acceleratedRaycast;\n\nclass GLTFCache {\n  cache = new Map();\n\n  set(src, gltf) {\n    this.cache.set(src, {\n      gltf,\n      count: 0\n    });\n    return this.retain(src);\n  }\n\n  has(src) {\n    return this.cache.has(src);\n  }\n\n  get(src) {\n    return this.cache.get(src);\n  }\n\n  retain(src) {\n    const cacheItem = this.cache.get(src);\n    cacheItem.count++;\n    return cacheItem;\n  }\n\n  release(src) {\n    const cacheItem = this.cache.get(src);\n\n    if (!cacheItem) {\n      console.error(`Releasing uncached gltf ${src}`);\n      return;\n    }\n\n    cacheItem.count--;\n    if (cacheItem.count <= 0) {\n      cacheItem.gltf.scene.traverse(disposeNode);\n      this.cache.delete(src);\n    }\n  }\n}\nconst gltfCache = new GLTFCache();\nconst inflightGltfs = new Map();\n\nconst extractZipFile = promisifyWorker(new SketchfabZipWorker());\n\nfunction defaultInflator(el, componentName, componentData) {\n  if (!AFRAME.components[componentName]) {\n    throw new Error(`Inflator failed. \"${componentName}\" component does not exist.`);\n  }\n  if (AFRAME.components[componentName].multiple && Array.isArray(componentData)) {\n    for (let i = 0; i < componentData.length; i++) {\n      el.setAttribute(componentName + \"__\" + i, componentData[i]);\n    }\n  } else {\n    el.setAttribute(componentName, componentData);\n  }\n}\n\nAFRAME.GLTFModelPlus = {\n  // eslint-disable-next-line no-unused-vars\n  components: {},\n  registerComponent(componentKey, componentName, inflator) {\n    inflator = inflator || defaultInflator;\n    AFRAME.GLTFModelPlus.components[componentKey] = { inflator, componentName };\n  }\n};\n\nfunction parallelTraverse(a, b, callback) {\n  callback(a, b);\n\n  for (let i = 0; i < a.children.length; i++) {\n    parallelTraverse(a.children[i], b.children[i], callback);\n  }\n}\n\nfunction generateMeshBVH(object3D) {\n  object3D.traverse(obj => {\n    // note that we might already have a bounds tree if this was a clone of an object with one\n    const hasBufferGeometry = obj.isMesh && obj.geometry.isBufferGeometry;\n    const hasBoundsTree = hasBufferGeometry && obj.geometry.boundsTree;\n    if (hasBufferGeometry && !hasBoundsTree && obj.geometry.attributes.position) {\n      const geo = obj.geometry;\n      const triCount = geo.index ? geo.index.count / 3 : geo.attributes.position.count / 3;\n      // only bother using memory and time making a BVH if there are a reasonable number of tris,\n      // and if there are too many it's too painful and large to tolerate doing it (at least until\n      // we put this in a web worker)\n      if (triCount > 1000 && triCount < 1000000) {\n        // note that bounds tree construction creates an index as a side effect if one doesn't already exist\n        geo.boundsTree = new MeshBVH(obj.geometry, { strategy: 0, maxDepth: 30 });\n      }\n    }\n  });\n}\n\n// Modified version of Don McCurdy's AnimationUtils.clone\n// https://github.com/mrdoob/three.js/pull/14494\nfunction cloneSkinnedMesh(source) {\n  const cloneLookup = new Map();\n\n  const clone = source.clone();\n\n  parallelTraverse(source, clone, function(sourceNode, clonedNode) {\n    cloneLookup.set(sourceNode, clonedNode);\n    if (sourceNode.isMesh && sourceNode.geometry.boundsTree) {\n      clonedNode.geometry.boundsTree = sourceNode.geometry.boundsTree;\n    }\n  });\n\n  source.traverse(function(sourceMesh) {\n    if (!sourceMesh.isSkinnedMesh) return;\n\n    const sourceBones = sourceMesh.skeleton.bones;\n    const clonedMesh = cloneLookup.get(sourceMesh);\n\n    clonedMesh.skeleton = sourceMesh.skeleton.clone();\n\n    clonedMesh.skeleton.bones = sourceBones.map(function(sourceBone) {\n      if (!cloneLookup.has(sourceBone)) {\n        throw new Error(\"Required bones are not descendants of the given object.\");\n      }\n\n      return cloneLookup.get(sourceBone);\n    });\n\n    clonedMesh.bind(clonedMesh.skeleton, sourceMesh.bindMatrix);\n  });\n\n  return clone;\n}\n\nfunction cloneGltf(gltf) {\n  return {\n    animations: gltf.animations,\n    scene: cloneSkinnedMesh(gltf.scene)\n  };\n}\n\nfunction getHubsComponents(node) {\n  const hubsComponents =\n    node.userData.gltfExtensions &&\n    (node.userData.gltfExtensions.MOZ_hubs_components || node.userData.gltfExtensions.HUBS_components);\n\n  // We can remove support for legacy components when our environment, avatar and interactable models are\n  // updated to match Spoke output.\n  const legacyComponents = node.userData.components;\n\n  return hubsComponents || legacyComponents;\n}\n\n/// Walks the tree of three.js objects starting at the given node, using the GLTF data\n/// and template data to construct A-Frame entities and components when necessary.\n/// (It's unnecessary to construct entities for subtrees that have no component data\n/// or templates associated with any of their nodes.)\n///\n/// Returns the A-Frame entity associated with the given node, if one was constructed.\nconst inflateEntities = function(indexToEntityMap, node, templates, isRoot, modelToWorldScale = 1) {\n  // TODO: Remove this once we update the legacy avatars to the new node names\n  if (node.name === \"Chest\") {\n    node.name = \"Spine\";\n  } else if (node.name === \"Root Scene\") {\n    node.name = \"AvatarRoot\";\n  } else if (node.name === \"Bot_Skinned\") {\n    node.name = \"AvatarMesh\";\n  }\n\n  // inflate subtrees first so that we can determine whether or not this node needs to be inflated\n  const childEntities = [];\n  const children = node.children.slice(0); // setObject3D mutates the node's parent, so we have to copy\n  for (const child of children) {\n    const el = inflateEntities(indexToEntityMap, child, templates);\n    if (el) {\n      childEntities.push(el);\n    }\n  }\n\n  const entityComponents = getHubsComponents(node);\n\n  const nodeHasBehavior = !!entityComponents || node.name in templates;\n  if (!nodeHasBehavior && !childEntities.length && !isRoot) {\n    return null; // we don't need an entity for this node\n  }\n\n  const el = document.createElement(\"a-entity\");\n  el.append.apply(el, childEntities);\n\n  // Remove invalid CSS class name characters.\n  const className = (node.name || node.uuid).replace(/[^\\w-]/g, \"\");\n  el.classList.add(className);\n\n  // AFRAME rotation component expects rotations in YXZ, convert it\n  if (node.rotation.order !== \"YXZ\") {\n    node.rotation.setFromQuaternion(node.quaternion, \"YXZ\");\n  }\n\n  // Copy over the object's transform to the THREE.Group and reset the actual transform of the Object3D\n  // all updates to the object should be done through the THREE.Group wrapper\n  el.object3D.position.copy(node.position);\n  el.object3D.rotation.copy(node.rotation);\n  el.object3D.scale.copy(node.scale).multiplyScalar(modelToWorldScale);\n  el.object3D.matrixNeedsUpdate = true;\n\n  node.matrixAutoUpdate = false;\n  node.matrix.identity();\n  node.matrix.decompose(node.position, node.rotation, node.scale);\n\n  el.setObject3D(node.type.toLowerCase(), node);\n  if (entityComponents && \"nav-mesh\" in entityComponents) {\n    el.setObject3D(\"mesh\", node);\n  }\n\n  // Set the name of the `THREE.Group` to match the name of the node,\n  // so that `THREE.PropertyBinding` will find (and later animate)\n  // the group. See `PropertyBinding.findNode`:\n  // https://github.com/mrdoob/three.js/blob/dev/src/animation/PropertyBinding.js#L211\n  el.object3D.name = node.name;\n  if (node.animations) {\n    // Pass animations up to the group object so that when we can pass the group as\n    // the optional root in `THREE.AnimationMixer.clipAction` and use the hierarchy\n    // preserved under the group (but not the node). Otherwise `clipArray` will be\n    // `null` in `THREE.AnimationClip.findByName`.\n    node.parent.animations = node.animations;\n  }\n\n  const gltfIndex = node.userData.gltfIndex;\n  if (gltfIndex !== undefined) {\n    indexToEntityMap[gltfIndex] = el;\n  }\n\n  return el;\n};\n\nfunction inflateComponents(inflatedEntity, indexToEntityMap) {\n  inflatedEntity.object3D.traverse(object3D => {\n    const entityComponents = getHubsComponents(object3D);\n    const el = object3D.el;\n\n    if (entityComponents && el) {\n      for (const prop in entityComponents) {\n        if (entityComponents.hasOwnProperty(prop) && AFRAME.GLTFModelPlus.components.hasOwnProperty(prop)) {\n          const { componentName, inflator } = AFRAME.GLTFModelPlus.components[prop];\n          inflator(el, componentName, entityComponents[prop], entityComponents, indexToEntityMap);\n        }\n      }\n    }\n  });\n}\n\nfunction attachTemplate(root, name, templateRoot) {\n  const targetEls = root.querySelectorAll(\".\" + name);\n  for (const el of targetEls) {\n    const root = templateRoot.cloneNode(true);\n    // Merge root element attributes with the target element\n    for (const { name, value } of root.attributes) {\n      el.setAttribute(name, value);\n    }\n\n    // Append all child elements\n    while (root.children.length > 0) {\n      el.appendChild(root.children[0]);\n    }\n  }\n}\n\nfunction runMigration(version, json) {\n  if (version < 2) {\n    //old heightfields will be on the same node as the nav-mesh, delete those\n    const oldHeightfieldNode = json.nodes.find(node => {\n      let components = null;\n      if (node.extensions && node.extensions.MOZ_hubs_components) {\n        components = node.extensions.MOZ_hubs_components;\n      } else if (node.extensions && node.extensions.HUBS_components) {\n        components = node.extensions.HUBS_components;\n      }\n      return components && components.heightfield && components[\"nav-mesh\"];\n    });\n    if (oldHeightfieldNode) {\n      if (oldHeightfieldNode.extensions.MOZ_hubs_components) {\n        delete oldHeightfieldNode.extensions.MOZ_hubs_components.heightfield;\n      } else if (oldHeightfieldNode.extensions.HUBS_components) {\n        delete oldHeightfieldNode.extensions.HUBS_components.heightfield;\n      }\n    }\n  }\n}\n\nexport async function loadGLTF(src, contentType, preferredTechnique, onProgress, jsonPreprocessor) {\n  let gltfUrl = src;\n  let fileMap;\n\n  if (contentType.includes(\"model/gltf+zip\") || contentType.includes(\"application/x-zip-compressed\")) {\n    fileMap = await extractZipFile(gltfUrl);\n    gltfUrl = fileMap[\"scene.gtlf\"];\n  }\n\n  const loadingManager = new THREE.LoadingManager();\n  loadingManager.setURLModifier(getCustomGLTFParserURLResolver(gltfUrl));\n  const gltfLoader = new THREE.GLTFLoader(loadingManager);\n\n  const parser = await new Promise((resolve, reject) => gltfLoader.createParser(gltfUrl, resolve, onProgress, reject));\n\n  parser.textureLoader = textureLoader;\n\n  if (jsonPreprocessor) {\n    parser.json = jsonPreprocessor(parser.json);\n  }\n\n  let version = 0;\n  if (\n    parser.json.extensions &&\n    parser.json.extensions.MOZ_hubs_components &&\n    parser.json.extensions.MOZ_hubs_components.hasOwnProperty(\"version\")\n  ) {\n    version = parser.json.extensions.MOZ_hubs_components.version;\n  }\n  runMigration(version, parser.json);\n\n  const materials = parser.json.materials;\n  if (materials) {\n    for (let i = 0; i < materials.length; i++) {\n      const material = materials[i];\n\n      if (\n        material.extensions &&\n        material.extensions.MOZ_alt_materials &&\n        material.extensions.MOZ_alt_materials[preferredTechnique] !== undefined\n      ) {\n        const altMaterialIndex = material.extensions.MOZ_alt_materials[preferredTechnique];\n        materials[i] = materials[altMaterialIndex];\n      }\n    }\n  }\n\n  const nodes = parser.json.nodes;\n\n  if (nodes) {\n    for (let i = 0; i < nodes.length; i++) {\n      const node = nodes[i];\n\n      if (!node.extras) {\n        node.extras = {};\n      }\n\n      node.extras.gltfIndex = i;\n    }\n  }\n\n  const gltf = await new Promise(parser.parse.bind(parser));\n\n  gltf.scene.traverse(object => {\n    // GLTFLoader sets matrixAutoUpdate on animated objects, we want to keep the defaults\n    object.matrixAutoUpdate = THREE.Object3D.DefaultMatrixAutoUpdate;\n\n    object.material = mapMaterials(object, material => {\n      if (material.isMeshStandardMaterial && preferredTechnique === \"KHR_materials_unlit\") {\n        return MobileStandardMaterial.fromStandardMaterial(material);\n      }\n\n      return material;\n    });\n  });\n\n  if (fileMap) {\n    // The GLTF is now cached as a THREE object, we can get rid of the original blobs\n    Object.keys(fileMap).forEach(URL.revokeObjectURL);\n  }\n\n  return gltf;\n}\n\n/**\n * Loads a GLTF model, optionally recursively \"inflates\" the child nodes of a model into a-entities and sets\n * whitelisted components on them if defined in the node's extras.\n * @namespace gltf\n * @component gltf-model-plus\n */\nAFRAME.registerComponent(\"gltf-model-plus\", {\n  schema: {\n    src: { type: \"string\" },\n    contentType: { type: \"string\" },\n    useCache: { default: true },\n    inflate: { default: false },\n    batch: { default: false },\n    modelToWorldScale: { type: \"number\", default: 1 }\n  },\n\n  init() {\n    this.preferredTechnique =\n      window.APP && window.APP.quality === \"low\" ? \"KHR_materials_unlit\" : \"pbrMetallicRoughness\";\n\n    // This can be set externally if a consumer wants to do some node preprocssing.\n    this.jsonPreprocessor = null;\n\n    this.loadTemplates();\n  },\n\n  update() {\n    this.applySrc(this.data.src, this.data.contentType);\n  },\n\n  remove() {\n    if (this.data.batch && this.model) {\n      this.el.sceneEl.systems[\"hubs-systems\"].batchManagerSystem.removeObject(this.el.object3DMap.mesh);\n    }\n    if (this.data.src) {\n      gltfCache.release(this.data.src);\n    }\n  },\n\n  loadTemplates() {\n    this.templates = {};\n    this.el.querySelectorAll(\":scope > template\").forEach(templateEl => {\n      const root = document.importNode(templateEl.firstElementChild || templateEl.content.firstElementChild, true);\n      this.templates[templateEl.getAttribute(\"data-name\")] = root;\n    });\n  },\n\n  async loadModel(src, contentType, technique, useCache) {\n    if (useCache) {\n      if (gltfCache.has(src)) {\n        gltfCache.retain(src);\n        return cloneGltf(gltfCache.get(src).gltf);\n      } else {\n        if (inflightGltfs.has(src)) {\n          const gltf = await inflightGltfs.get(src);\n          gltfCache.retain(src);\n          return cloneGltf(gltf);\n        } else {\n          const promise = loadGLTF(src, contentType, technique, null, this.jsonPreprocessor);\n          inflightGltfs.set(src, promise);\n          const gltf = await promise;\n          inflightGltfs.delete(src);\n          gltfCache.set(src, gltf);\n          return cloneGltf(gltf);\n        }\n      }\n    } else {\n      return loadGLTF(src, contentType, technique, null, this.jsonPreprocessor);\n    }\n  },\n\n  async applySrc(src, contentType) {\n    try {\n      // If the src attribute is a selector, get the url from the asset item.\n      if (src && src.charAt(0) === \"#\") {\n        const assetEl = document.getElementById(src.substring(1));\n        src = assetEl.getAttribute(\"src\");\n      }\n\n      if (src === this.lastSrc) return;\n\n      const lastSrc = this.lastSrc;\n      this.lastSrc = src;\n\n      if (!src) {\n        if (this.inflatedEl) {\n          console.warn(\"gltf-model-plus set to an empty source, unloading inflated model.\");\n          this.disposeLastInflatedEl();\n        }\n        return;\n      }\n\n      this.el.emit(\"model-loading\");\n      const gltf = await this.loadModel(src, contentType, this.preferredTechnique, this.data.useCache);\n\n      // If we started loading something else already\n      // TODO: there should be a way to cancel loading instead\n      if (src != this.lastSrc) return;\n\n      // If we had inflated something already before, clean that up\n      this.disposeLastInflatedEl();\n\n      this.model = gltf.scene || gltf.scenes[0];\n      this.model.animations = gltf.animations;\n\n      if (this.data.batch) {\n        this.el.sceneEl.systems[\"hubs-systems\"].batchManagerSystem.addObject(this.model);\n      }\n\n      if (gltf.animations.length > 0) {\n        this.el.setAttribute(\"animation-mixer\", {});\n        this.el.components[\"animation-mixer\"].initMixer(gltf.animations);\n      } else {\n        generateMeshBVH(this.model);\n      }\n\n      const indexToEntityMap = {};\n\n      let object3DToSet = this.model;\n      if (\n        this.data.inflate &&\n        (this.inflatedEl = inflateEntities(\n          indexToEntityMap,\n          this.model,\n          this.templates,\n          true,\n          this.data.modelToWorldScale\n        ))\n      ) {\n        this.el.appendChild(this.inflatedEl);\n\n        object3DToSet = this.inflatedEl.object3D;\n        // TODO: Still don't fully understand the lifecycle here and how it differs between browsers, we should dig in more\n        // Wait one tick for the appended custom elements to be connected before attaching templates\n        await nextTick();\n        if (src != this.lastSrc) return; // TODO: there must be a nicer pattern for this\n\n        inflateComponents(this.inflatedEl, indexToEntityMap);\n\n        for (const name in this.templates) {\n          attachTemplate(this.el, name, this.templates[name]);\n        }\n      }\n\n      // The call to setObject3D below recursively clobbers any `el` backreferences to entities\n      // in the entire inflated entity graph to point to `object3DToSet`.\n      //\n      // We don't want those overwritten, since lots of code assumes `object3d.el` points to the relevant\n      // A-Frame entity for that three.js object, so we back them up and re-wire them here. If we didn't do\n      // this, all the `el` properties on these object3ds would point to the `object3DToSet` which is either\n      // the model or the root GLTF inflated entity.\n      const rewires = [];\n\n      object3DToSet.traverse(o => {\n        const el = o.el;\n        if (el) rewires.push(() => (o.el = el));\n      });\n\n      const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\n\n      if (environmentMapComponent) {\n        environmentMapComponent.applyEnvironmentMap(object3DToSet);\n      }\n\n      if (lastSrc) {\n        gltfCache.release(lastSrc);\n      }\n      this.el.setObject3D(\"mesh\", object3DToSet);\n\n      rewires.forEach(f => f());\n\n      this.el.emit(\"model-loaded\", { format: \"gltf\", model: this.model });\n    } catch (e) {\n      gltfCache.release(src);\n      console.error(\"Failed to load glTF model\", e, this);\n      this.el.emit(\"model-error\", { format: \"gltf\", src });\n    }\n  },\n\n  disposeLastInflatedEl() {\n    if (this.inflatedEl) {\n      this.inflatedEl.parentNode.removeChild(this.inflatedEl);\n\n      this.inflatedEl.object3D.traverse(x => {\n        if (x.material && x.material.dispose) {\n          x.material.dispose();\n        }\n\n        if (x.geometry) {\n          if (x.geometry.dispose) {\n            x.geometry.dispose();\n          }\n\n          x.geometry.boundsTree = null;\n        }\n      });\n\n      delete this.inflatedEl;\n\n      this.el.removeAttribute(\"animation-mixer\");\n    }\n  }\n});\n","// Wrapper for a worker which accepts work items and responds with results.\n//\n// The worker must receive messages with data of the shape { id, payload }, and then respond\n// with messages containing matching IDs of the shape { id, result, err }.\n//\n// Returns a function that accepts a work item, sends it to the worker, and returns a promise that\n// will resolve with the result or reject with the error.\n//\nexport function promisifyWorker(worker) {\n  let nextItemId = 0;\n  const outstanding = {}; // item ID: { resolve, reject }\n\n  worker.onmessage = msg => {\n    const { id, result, err } = msg.data;\n    const handlers = outstanding[id];\n    if (handlers == null) {\n      console.error(`Unknown message with ID ${id} received from ${worker}.`);\n    } else {\n      delete outstanding[id];\n      if (err != null) {\n        handlers.reject(new Error(err));\n      } else {\n        handlers.resolve(result);\n      }\n    }\n  };\n\n  return function(data, transfer) {\n    const id = nextItemId++;\n    const promise = new Promise((resolve, reject) => {\n      outstanding[id] = { resolve, reject };\n    });\n    worker.postMessage({ id, payload: data }, transfer);\n    return promise;\n  };\n}\n","/**\n * Chrome and Safari will start Audio contexts in a \"suspended\" state.\n * A user interaction (touch/mouse event) is needed in order to resume the AudioContext.\n */\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  const ctx = THREE.AudioContext.getContext();\n\n  function resume() {\n    ctx.resume();\n\n    setTimeout(function() {\n      if (ctx.state === \"running\") {\n        document.body.removeEventListener(\"touchend\", resume, false);\n        document.body.removeEventListener(\"mouseup\", resume, false);\n      }\n    }, 0);\n  }\n\n  document.body.addEventListener(\"touchend\", resume, false);\n  document.body.addEventListener(\"mouseup\", resume, false);\n});\n","// Monkeypatch to address performance issue with updating panner nodes\n// TODO this needs to be merged into 3.js\n\nTHREE.PositionalAudio.prototype.updateMatrixWorld = (function() {\n  const position = new THREE.Vector3();\n  const quaternion = new THREE.Quaternion();\n\n  const scale = new THREE.Vector3();\n  const orientation = new THREE.Vector3();\n\n  return function updateMatrixWorld(force) {\n    THREE.Object3D.prototype.updateMatrixWorld.call(this, force);\n\n    let setInitial = false;\n\n    if (!this._lastPosition) {\n      setInitial = true;\n      this._lastPosition = new THREE.Vector3();\n      this._lastOrientation = new THREE.Vector3();\n      this._lastListenerPosition = new THREE.Vector3();\n    }\n\n    const panner = this.panner;\n    const listener = panner.context.listener;\n    this.matrixWorld.decompose(position, quaternion, scale);\n    orientation.set(0, 0, 1).applyQuaternion(quaternion);\n\n    // Need to update the position on this node if either the listener moves or this node moves,\n    // because otherwise there are audio artifacts in Chrome.\n    if (\n      setInitial ||\n      Math.abs(position.x - this._lastPosition.x) > Number.EPSILON ||\n      Math.abs(position.y - this._lastPosition.y) > Number.EPSILON ||\n      Math.abs(position.z - this._lastPosition.z) > Number.EPSILON ||\n      Math.abs(orientation.x - this._lastOrientation.x) > Number.EPSILON ||\n      Math.abs(orientation.y - this._lastOrientation.y) > Number.EPSILON ||\n      Math.abs(orientation.z - this._lastOrientation.z) > Number.EPSILON ||\n      (listener.positionX && Math.abs(listener.positionX.value - this._lastListenerPosition.x) > Number.EPSILON) ||\n      (listener.positionY && Math.abs(listener.positionY.value - this._lastListenerPosition.y) > Number.EPSILON) ||\n      (listener.positionZ && Math.abs(listener.positionZ.value - this._lastListenerPosition.z) > Number.EPSILON)\n    ) {\n      panner.setPosition(position.x, position.y, position.z);\n      panner.setOrientation(orientation.x, orientation.y, orientation.z);\n\n      this._lastPosition.x = position.x;\n      this._lastPosition.y = position.y;\n      this._lastPosition.z = position.z;\n\n      this._lastOrientation.x = orientation.x;\n      this._lastOrientation.y = orientation.y;\n      this._lastOrientation.z = orientation.z;\n\n      if (listener.positionX && listener.positionY && listener.positionZ) {\n        this._lastListenerPosition.x = listener.positionX.value;\n        this._lastListenerPosition.y = listener.positionY.value;\n        this._lastListenerPosition.z = listener.positionZ.value;\n      }\n    }\n  };\n})();\n","/**\n * Toggles the position of 2 bones into \"on\" and \"off\" positions to indicate mute state.\n * @namespace avatar\n * @component bone-mute-state-indicator\n */\nAFRAME.registerComponent(\"bone-mute-state-indicator\", {\n  schema: {\n    unmutedBoneName: { default: \"Watch_Joint_MicON\" },\n    mutedBoneName: { default: \"Watch_Joint_Muted\" },\n    onPos: { default: 0.81 },\n    offPos: { default: 0.5 }\n  },\n\n  init() {\n    this.onStateToggled = this.onStateToggled.bind(this);\n    this.el.addEventListener(\"model-loaded\", () => {\n      this.unmutedBone = this.el.object3D.getObjectByName(this.data.unmutedBoneName);\n      this.mutedBone = this.el.object3D.getObjectByName(this.data.mutedBoneName);\n      this.modelLoaded = true;\n\n      this.updateMuteState();\n    });\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateToggled);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateToggled);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateToggled);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateToggled);\n  },\n\n  onStateToggled(e) {\n    if (!e.detail.state === \"muted\") return;\n    this.updateMuteState();\n  },\n\n  updateMuteState() {\n    if (!this.modelLoaded) return;\n    const muted = this.el.sceneEl.is(\"muted\");\n    this.mutedBone.position.y = muted ? this.data.onPos : this.data.offPos;\n    this.unmutedBone.position.y = !muted ? this.data.onPos : this.data.offPos;\n    this.mutedBone.matrixNeedsUpdate = true;\n    this.unmutedBone.matrixNeedsUpdate = true;\n  }\n});\n","/**\n * Scales an object to near-zero if the object is invisible. Useful for bones representing avatar body parts.\n * @namespace avatar\n * @component bone-visibility\n */\nAFRAME.registerComponent(\"bone-visibility\", {\n  tick() {\n    const { visible } = this.el.object3D;\n\n    if (this.lastVisible !== visible) {\n      if (visible) {\n        this.el.object3D.scale.set(1, 1, 1);\n      } else {\n        // Three.js doesn't like updating matrices with 0 scale, so we set it to a near zero number.\n        this.el.object3D.scale.set(0.00000001, 0.00000001, 0.00000001);\n      }\n\n      this.lastVisible = visible;\n      this.el.object3D.updateMatrices(true, true);\n      this.el.object3D.updateMatrixWorld(true, true);\n    }\n  }\n});\n","/**\n * Positions an entity relative to a given target when the given event is fired.\n * @component offset-relative-to\n */\nAFRAME.registerComponent(\"offset-relative-to\", {\n  schema: {\n    target: {\n      type: \"selector\"\n    },\n    offset: {\n      type: \"vec3\"\n    },\n    on: {\n      type: \"string\"\n    },\n    orientation: {\n      default: 1 // see doc/image_orientations.gif\n    },\n    selfDestruct: {\n      default: false\n    }\n  },\n  init() {\n    this.updateOffset = this.updateOffset.bind(this);\n    if (this.data.on) {\n      this.el.sceneEl.addEventListener(this.data.on, this.updateOffset);\n    } else {\n      this.updateOffset();\n    }\n  },\n\n  updateOffset: (function() {\n    const y = new THREE.Vector3(0, 1, 0);\n    const z = new THREE.Vector3(0, 0, -1);\n    const QUARTER_CIRCLE = Math.PI / 2;\n    const offsetVector = new THREE.Vector3();\n    return function() {\n      const obj = this.el.object3D;\n      const target = this.data.target.object3D;\n      offsetVector.copy(this.data.offset);\n      target.localToWorld(offsetVector);\n      if (obj.parent) {\n        obj.parent.worldToLocal(offsetVector);\n      }\n      obj.position.copy(offsetVector);\n      target.getWorldQuaternion(obj.quaternion);\n\n      // See doc/image_orientations.gif\n      switch (this.data.orientation) {\n        case 8:\n          obj.rotateOnAxis(z, 3 * QUARTER_CIRCLE);\n          break;\n        case 7:\n          obj.rotateOnAxis(z, 3 * QUARTER_CIRCLE);\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\n          break;\n        case 6:\n          obj.rotateOnAxis(z, QUARTER_CIRCLE);\n          break;\n        case 5:\n          obj.rotateOnAxis(z, QUARTER_CIRCLE);\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\n          break;\n        case 4:\n          obj.rotateOnAxis(z, 2 * QUARTER_CIRCLE);\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\n          break;\n        case 3:\n          obj.rotateOnAxis(z, 2 * QUARTER_CIRCLE);\n          break;\n        case 2:\n          obj.rotateOnAxis(y, 2 * QUARTER_CIRCLE);\n          break;\n        case 1:\n        default:\n          break;\n      }\n\n      obj.matrixNeedsUpdate = true;\n\n      if (this.data.selfDestruct) {\n        if (this.data.on) {\n          this.el.sceneEl.removeEventListener(this.data.on, this.updateOffset);\n        }\n        this.el.removeAttribute(\"offset-relative-to\");\n      }\n    };\n  })()\n});\n","const TWOPI = Math.PI * 2;\nfunction deltaAngle(a, b) {\n  const p = Math.abs(b - a) % TWOPI;\n  return p > Math.PI ? TWOPI - p : p;\n}\n\n/**\n * Positions the HUD and toggles app mode based on where the user is looking\n * @namespace ui\n * @component hud-controller\n */\nAFRAME.registerComponent(\"hud-controller\", {\n  schema: {\n    head: { type: \"selector\" },\n    offset: { default: 0.7 }, // distance from hud above head,\n    lookCutoff: { default: 20 }, // angle at which the hud should be \"on\",\n    animRange: { default: 30 }, // degrees over which to animate the hud into view\n    yawCutoff: { default: 50 } // yaw degrees at wich the hud should reoirent even if the user is looking up\n  },\n  init() {\n    this.onChildHovered = this.onChildHovered.bind(this);\n    this.removeHoverEvents = this.removeHoverEvents.bind(this);\n    this.isYLocked = false;\n    this.lockedHeadPositionY = 0;\n    this.lookDir = new THREE.Vector3();\n    this.lookEuler = new THREE.Euler();\n    this.store = window.APP.store;\n    this.hoverableChildren = this.el.querySelectorAll(\"[is-remote-hover-target]\");\n  },\n\n  tick() {\n    const hud = this.el.object3D;\n    const head = this.data.head.object3D;\n\n    const { offset, lookCutoff, animRange, yawCutoff } = this.data;\n\n    const pitch = head.rotation.x * THREE.Math.RAD2DEG;\n    const yawDif = deltaAngle(head.rotation.y, hud.rotation.y) * THREE.Math.RAD2DEG;\n\n    // HUD is always visible until first hover, to increase discoverability.\n    const forceHudVisible = !this.store.state.activity.hasHoveredInWorldHud;\n\n    // animate the hud into place over animRange degrees as the user aproaches the lookCutoff angle\n    let t = 1 - THREE.Math.clamp(lookCutoff - pitch, 0, animRange) / animRange;\n\n    // HUD is locked down while showing tooltip or if forced.\n    if (forceHudVisible) {\n      t = 1;\n    }\n\n    // Once the HUD is in place it should stay in place until you look sufficiently far down\n    if (t === 1) {\n      this.lockedHeadPositionY = head.position.y;\n      this.hudLocked = true;\n    } else if (this.hudLocked && pitch < lookCutoff - animRange / 2) {\n      this.hudLocked = false;\n    }\n\n    if (this.hudLocked) {\n      t = 1;\n    }\n\n    // Reorient the hud only if the user is looking away from the hud, for right now this arbitrarily means the hud is 1/2 way animated away\n    // TODO: come up with better huristics for this that maybe account for the user turning away from the hud \"too far\", also animate the position so that it doesnt just snap.\n    const hudOutOfView = yawDif >= yawCutoff || pitch < lookCutoff - animRange / 2;\n\n    if (hudOutOfView) {\n      this.lookDir.set(0, 0, -1);\n      this.lookDir.applyQuaternion(head.quaternion);\n      this.lookDir.add(head.position);\n      hud.position.x = this.lookDir.x;\n      hud.position.z = this.lookDir.z;\n      hud.rotation.copy(head.rotation);\n      hud.rotation.x = 0;\n      hud.rotation.z = 0;\n    }\n\n    hud.visible = !hudOutOfView || forceHudVisible;\n    hud.position.y = (this.isYLocked ? this.lockedHeadPositionY : head.position.y) + offset + (1 - t) * offset;\n    hud.rotation.x = (1 - t) * THREE.Math.DEG2RAD * 90;\n    hud.matrixNeedsUpdate = true;\n  },\n\n  play() {\n    for (let i = 0; i < this.hoverableChildren.length; i++) {\n      this.hoverableChildren[i].object3D.addEventListener(\"hovered\", this.onChildHovered);\n    }\n  },\n\n  pause() {\n    this.removeHoverEvents();\n  },\n\n  removeHoverEvents() {\n    for (let i = 0; i < this.hoverableChildren.length; i++) {\n      this.hoverableChildren[i].object3D.removeEventListener(\"hovered\", this.onChildHovered);\n    }\n  },\n\n  onChildHovered() {\n    if (!this.store.state.activity.hasHoveredInWorldHud) {\n      this.store.update({ activity: { hasHoveredInWorldHud: true } });\n      this.removeHoverEvents();\n    }\n  }\n});\n","/**\n * A button with an image, tooltip, hover states.\n * @namespace ui\n * @component icon-button\n */\nAFRAME.registerComponent(\"icon-button\", {\n  schema: {\n    image: { type: \"string\" },\n    hoverImage: { type: \"string\" },\n    activeImage: { type: \"string\" },\n    activeHoverImage: { type: \"string\" },\n    disabledImage: { type: \"string\" },\n    active: { type: \"boolean\" },\n    disabled: { type: \"boolean\" },\n    tooltip: { type: \"selector\" },\n    tooltipText: { type: \"string\" },\n    activeTooltipText: { type: \"string\" }\n  },\n\n  init() {\n    this.el.object3D.matrixNeedsUpdate = true;\n    this.onHover = () => {\n      this.hovering = true;\n      if (this.data.tooltip) {\n        this.data.tooltip.object3D.visible = true;\n      }\n      this.updateButtonState();\n    };\n    this.onHoverOut = () => {\n      this.hovering = false;\n      if (this.data.tooltip) {\n        this.data.tooltip.object3D.visible = false;\n      }\n      this.updateButtonState();\n    };\n  },\n\n  play() {\n    this.updateButtonState();\n    this.el.object3D.addEventListener(\"hovered\", this.onHover);\n    this.el.object3D.addEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"hovered\", this.onHover);\n    this.el.object3D.removeEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  update() {\n    this.updateButtonState();\n  },\n\n  updateButtonState() {\n    const hovering = this.hovering;\n    const active = this.data.active;\n    const disabled = this.data.disabled;\n\n    let image;\n    if (disabled) {\n      image = \"disabledImage\";\n    } else if (active) {\n      image = hovering ? \"activeHoverImage\" : \"activeImage\";\n    } else {\n      image = hovering ? \"hoverImage\" : \"image\";\n    }\n\n    if (this.el.components.sprite) {\n      if (this.data[image]) {\n        this.el.setAttribute(\"sprite\", \"name\", this.data[image]);\n      } else {\n        console.warn(`No ${image} image on me.`, this);\n      }\n    } else {\n      console.error(\"No sprite.\");\n    }\n\n    if (this.data.tooltip && hovering) {\n      const tooltipText =\n        (this.data.active ? this.data.activeTooltipText : this.data.tooltipText) + (disabled ? \" Disabled\" : \"\");\n      this.data.tooltip.querySelector(\"[text]\").setAttribute(\"text\", \"value\", tooltipText);\n    }\n  }\n});\n","/**\n * A button with text\n * @namespace ui\n * @component text-button\n */\nAFRAME.registerComponent(\"text-button\", {\n  schema: {\n    textHoverColor: { type: \"string\" },\n    textColor: { type: \"string\" },\n    backgroundHoverColor: { type: \"string\" },\n    backgroundColor: { type: \"string\" }\n  },\n\n  init() {\n    // TODO: This is a bit of a hack to deal with position \"component\" not setting matrixNeedsUpdate. Come up with a better solution.\n    this.el.object3D.matrixNeedsUpdate = true;\n    this.onHover = () => {\n      this.hovering = true;\n      this.updateButtonState();\n    };\n    this.onHoverOut = () => {\n      this.hovering = false;\n      this.updateButtonState();\n    };\n    this.textEl = this.el.querySelector(\"[text]\");\n  },\n\n  play() {\n    this.updateButtonState();\n    this.el.object3D.addEventListener(\"hovered\", this.onHover);\n    this.el.object3D.addEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"hovered\", this.onHover);\n    this.el.object3D.removeEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  update() {\n    this.updateButtonState();\n  },\n\n  updateButtonState() {\n    const hovering = this.hovering;\n    this.el.setAttribute(\"slice9\", \"color\", hovering ? this.data.backgroundHoverColor : this.data.backgroundColor);\n\n    if (this.textEl) {\n      this.textEl.setAttribute(\"text\", \"color\", hovering ? this.data.textHoverColor : this.data.textColor);\n    }\n  }\n});\n\nconst noop = function() {};\n// TODO: this should ideally be fixed upstream somehow but its pretty tricky since text is just a geometry not a different type of Object3D, and Object3D is what handles raycast checks.\nAFRAME.registerComponent(\"text-raycast-hack\", {\n  dependencies: [\"text\"],\n  init() {\n    this.el.getObject3D(\"text\").raycast = noop;\n  }\n});\n","/**\n * Registers a click handler and invokes the block method on the NAF adapter for the owner associated with its entity.\n * @namespace network\n * @component block-button\n */\nAFRAME.registerComponent(\"block-button\", {\n  init() {\n    this.onClick = () => {\n      this.block(this.owner);\n    };\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.owner = networkedEl.components.networked.data.owner;\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  },\n\n  block(clientId) {\n    window.APP.hubChannel.hide(clientId);\n  }\n});\n","AFRAME.registerComponent(\"mute-button\", {\n  init() {\n    this.onClick = () => {\n      this.mute(this.owner);\n    };\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.owner = networkedEl.components.networked.data.owner;\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  },\n\n  async mute(clientId) {\n    this.el.sceneEl.emit(\"action_mute_client\", { clientId });\n  }\n});\n","AFRAME.registerComponent(\"kick-button\", {\n  init() {\n    this.onClick = () => {\n      this.kick(this.owner);\n    };\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.owner = networkedEl.components.networked.data.owner;\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  },\n\n  async kick(clientId) {\n    this.el.sceneEl.emit(\"action_kick_client\", { clientId });\n  }\n});\n","AFRAME.registerComponent(\"close-vr-notice-button\", {\n  init() {\n    this.onClick = () => {\n      this.el.sceneEl.emit(\"action_vr_notice_closed\");\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","AFRAME.registerComponent(\"leave-room-button\", {\n  init() {\n    this.onClick = () => {\n      this.el.sceneEl.emit(\"leave_room_requested\");\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","AFRAME.registerComponent(\"visible-if-permitted\", {\n  schema: {\n    type: \"string\"\n  },\n  init() {\n    this.updateVisibility = this.updateVisibility.bind(this);\n    this.updateVisibility();\n    window.APP.hubChannel.addEventListener(\"permissions_updated\", this.updateVisibility);\n  },\n  updateVisibility() {\n    this.el.object3D.visible = this.el.sceneEl.systems.permissions.canOrWillIfCreator(this.data);\n  },\n  remove() {\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.updateVisibility);\n  }\n});\n","AFRAME.registerComponent(\"visibility-on-content-type\", {\n  schema: {\n    contentType: { type: \"string\" },\n    contentSubtype: { type: \"string\" },\n    visible: { type: \"boolean\", default: true }\n  },\n\n  init() {\n    this.updateVisibility = this.updateVisibility.bind(this);\n\n    NAF.utils.getNetworkedEntity(this.el).then(el => {\n      this.networkedEl = el;\n      el.addEventListener(\"media_resolved\", ({ detail: { contentType } }) => this.updateVisibility(contentType));\n      this.updateVisibility();\n    });\n  },\n\n  updateVisibility(contentType) {\n    const mediaLoader = this.networkedEl.components[\"media-loader\"];\n    const mediaImage = this.networkedEl.components[\"media-image\"];\n    const mediaVideo = this.networkedEl.components[\"media-video\"];\n    const currentContentType =\n      contentType || (mediaVideo && mediaVideo.data.contentType) || (mediaImage && mediaImage.data.contentType);\n    const matchesType =\n      !this.data.contentType ||\n      (currentContentType && currentContentType.toLowerCase().split(\";\")[0] === this.data.contentType);\n    const matchesSubtype =\n      !this.data.contentSubtype ||\n      (mediaLoader.data.contentSubtype && mediaLoader.data.contentSubtype === this.data.contentSubtype);\n    const matches = !!(matchesType && matchesSubtype);\n    this.el.object3D.visible = this.data.visible ? matches : !matches;\n  }\n});\n","AFRAME.registerComponent(\"hide-when-pinned-and-forbidden\", {\n  schema: {\n    // Hide regardless of being forbidden.\n    whenPinned: { type: \"boolean\" }\n  },\n  init() {\n    this._updateUI = this._updateUI.bind(this);\n    this._updateUIOnStateChange = this._updateUIOnStateChange.bind(this);\n    this.el.sceneEl.addEventListener(\"stateadded\", this._updateUIOnStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this._updateUIOnStateChange);\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n\n      this._updateUI();\n      this.targetEl.addEventListener(\"pinned\", this._updateUI);\n      this.targetEl.addEventListener(\"unpinned\", this._updateUI);\n    });\n  },\n\n  remove() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this._updateUIOnStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this._updateUIOnStateChange);\n\n    if (this.targetEl) {\n      this.targetEl.removeEventListener(\"pinned\", this._updateUI);\n      this.targetEl.removeEventListener(\"unpinned\", this._updateUI);\n    }\n  },\n\n  _updateUIOnStateChange(e) {\n    if (e.detail !== \"frozen\") return;\n    this._updateUI();\n  },\n\n  _updateUI() {\n    if (!this.targetEl) return;\n    const isPinned = this.targetEl.components.pinnable && this.targetEl.components.pinnable.data.pinned;\n\n    if (this.data.whenPinned) {\n      this.el.object3D.visible = !isPinned;\n    } else {\n      const pinnedAndForbidden = isPinned && !window.APP.hubChannel.canOrWillIfCreator(\"pin_objects\");\n      this.el.object3D.visible = !pinnedAndForbidden;\n    }\n  }\n});\n","/**\n * Stores networked avatar state.\n * @namespace avatar\n * @component networked-avatar\n */\nAFRAME.registerComponent(\"networked-avatar\", {\n  schema: {\n    left_hand_pose: { default: 0 },\n    right_hand_pose: { default: 0 }\n  }\n});\n","AFRAME.registerComponent(\"pinnable\", {\n  schema: {\n    pinned: { default: false }\n  },\n\n  init() {\n    this._fireEventsAndAnimate = this._fireEventsAndAnimate.bind(this);\n\n    // Fire pinned events when page changes so we can persist the page.\n    this.el.addEventListener(\"pager-page-changed\", this._fireEventsAndAnimate);\n\n    // Fire pinned events when video state changes so we can persist the page.\n    this.el.addEventListener(\"owned-video-state-changed\", this._fireEventsAndAnimate);\n  },\n\n  update(oldData) {\n    this._fireEventsAndAnimate(oldData);\n  },\n\n  _fireEventsAndAnimate(oldData, force) {\n    // We need to guard against _fireEventsAndAnimate being called during entity initialization,\n    // when the networked component isn't initialized yet.\n    if (this.el.components.networked && this.el.components.networked.data && !NAF.utils.isMine(this.el)) return;\n\n    // Avoid firing events during initialization by checking if the pin state has changed before doing so.\n    const pinStateChanged = !!oldData.pinned !== this.data.pinned;\n\n    if (this.data.pinned) {\n      if (pinStateChanged || force) {\n        this.el.emit(\"pinned\", { el: this.el });\n      }\n\n      this.el.removeAttribute(\"animation__pin-start\");\n      this.el.removeAttribute(\"animation__pin-end\");\n      const currentScale = this.el.object3D.scale;\n\n      this.el.setAttribute(\"animation__pin-start\", {\n        property: \"scale\",\n        dur: 200,\n        from: { x: currentScale.x, y: currentScale.y, z: currentScale.z },\n        to: { x: currentScale.x * 1.1, y: currentScale.y * 1.1, z: currentScale.z * 1.1 },\n        easing: \"easeOutElastic\"\n      });\n\n      this.el.setAttribute(\"animation__pin-end\", {\n        property: \"scale\",\n        delay: 200,\n        dur: 200,\n        from: { x: currentScale.x * 1.1, y: currentScale.y * 1.1, z: currentScale.z * 1.1 },\n        to: { x: currentScale.x, y: currentScale.y, z: currentScale.z },\n        easing: \"easeOutElastic\"\n      });\n\n      if (this.el.components[\"ammo-body\"]) {\n        this.el.setAttribute(\"ammo-body\", { type: \"static\" });\n      }\n    } else {\n      if (pinStateChanged || force) {\n        this.el.emit(\"unpinned\", { el: this.el });\n      }\n    }\n  },\n\n  isHeld(el) {\n    const { leftHand, rightHand, rightRemote } = el.sceneEl.systems.interaction.state;\n    return leftHand.held === el || rightHand.held === el || rightRemote.held === el;\n  },\n\n  tick() {\n    const held = this.isHeld(this.el);\n\n    if (!held && this.wasHeld) {\n      this._fireEventsAndAnimate(this.data, true);\n    }\n\n    this.wasHeld = held;\n  }\n});\n","const COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\n\nAFRAME.registerComponent(\"drop-object-button\", {\n  init() {\n    this.onClick = () => {\n      if (!NAF.utils.isMine(this.targetEl) && !NAF.utils.takeOwnership(this.targetEl)) return;\n\n      this.targetEl.setAttribute(\"floaty-object\", { modifyGravityOnRelease: false });\n      this.targetEl.setAttribute(\"ammo-body\", {\n        type: \"dynamic\",\n        gravity: { x: 0, y: -9.8, z: 0 },\n        angularDamping: 0.01,\n        linearDamping: 0.01,\n        linearSleepingThreshold: 1.6,\n        angularSleepingThreshold: 2.5,\n        collisionFilterMask: COLLISION_LAYERS.DEFAULT_INTERACTABLE\n      });\n      this.targetEl.components[\"ammo-body\"].body.activate();\n\n      // Remove drop button after using it\n      this.el.parentNode.removeChild(this.el);\n    };\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","AFRAME.registerComponent(\"remove-networked-object-button\", {\n  init() {\n    this.onClick = () => {\n      if (!NAF.utils.isMine(this.targetEl) && !NAF.utils.takeOwnership(this.targetEl)) return;\n\n      this.targetEl.setAttribute(\"animation__remove\", {\n        property: \"scale\",\n        dur: 200,\n        to: { x: 0.01, y: 0.01, z: 0.01 },\n        easing: \"easeInQuad\"\n      });\n\n      this.el.parentNode.removeAttribute(\"visibility-while-frozen\");\n      this.el.parentNode.setAttribute(\"visible\", false);\n\n      this.targetEl.addEventListener(\"animationcomplete\", () => {\n        NAF.utils.takeOwnership(this.targetEl);\n        this.targetEl.parentNode.removeChild(this.targetEl);\n      });\n    };\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","AFRAME.registerComponent(\"camera-focus-button\", {\n  schema: {\n    track: { default: false },\n    selector: { default: null }\n  },\n\n  init() {\n    this.cameraSystem = this.el.sceneEl.systems[\"camera-tools\"];\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      if (this.data.selector) {\n        this.targetEl = networkedEl.querySelector(this.data.selector);\n      } else {\n        this.targetEl = networkedEl;\n      }\n    });\n\n    this.onClick = () => {\n      const myCamera = this.cameraSystem.getMyCamera();\n      if (!myCamera) return;\n\n      myCamera.components[\"camera-tool\"].focus(this.targetEl, this.data.track);\n    };\n  },\n\n  tick() {\n    const isVisible = this.el.object3D.visible;\n    const shouldBeVisible = !!(this.cameraSystem && this.cameraSystem.getMyCamera());\n\n    if (isVisible !== shouldBeVisible) {\n      this.el.setAttribute(\"visible\", shouldBeVisible);\n    }\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","/**\n * Toggles the visibility of this entity based on networked ownership\n * @namespace ui\n * @component visible-to-owner\n */\nAFRAME.registerComponent(\"visible-to-owner\", {\n  init() {\n    this.onStateChange = e => {\n      this.el.setAttribute(\"visible\", e.detail.newOwner === NAF.clientId);\n    };\n    NAF.utils.getNetworkedEntity(this.el).then(el => {\n      el.addEventListener(\"ownership-changed\", this.onStateChange);\n      this.el.setAttribute(\"visible\", NAF.utils.isMine(el));\n    });\n  }\n});\n","AFRAME.registerComponent(\"emit-state-change\", {\n  multiple: true,\n  schema: {\n    state: { type: \"string\" },\n    transform: { type: \"string\", oneof: [\"rising\", \"falling\"] },\n    event: { type: \"string\" }\n  },\n\n  init() {\n    this.stateadded = this.stateadded.bind(this);\n    this.stateremoved = this.stateremoved.bind(this);\n  },\n\n  stateadded(e) {\n    if (e.detail === this.data.state) {\n      this.el.emit(this.data.event);\n    }\n  },\n  stateremoved(e) {\n    if (e.detail === this.data.state) {\n      this.el.emit(this.data.event);\n    }\n  },\n\n  update() {\n    this.el.removeEventListener(\"stateadded\", this.stateadded);\n    this.el.removeEventListener(\"stateremoved\", this.stateremoved);\n\n    if (this.data.transform === \"rising\") {\n      this.el.addEventListener(\"stateadded\", this.stateadded);\n    }\n    if (this.data.transform === \"falling\") {\n      this.el.addEventListener(\"stateremoved\", this.stateremoved);\n    }\n  }\n});\n","AFRAME.registerComponent(\"action-to-event\", {\n  multiple: true,\n\n  schema: {\n    path: { type: \"string\" },\n    event: { type: \"string\" },\n    withPermission: { type: \"string\" }\n  },\n\n  init() {\n    this.needsPermission = !!this.data.withPermission;\n    this.updatePermissions = () => {\n      if (!this.needsPermission) return;\n      this.hasPermission = window.APP.hubChannel.canOrWillIfCreator(this.data.withPermission);\n    };\n  },\n\n  play() {\n    this.el.sceneEl.systems.permissions.onPermissionsUpdated(this.updatePermissions);\n  },\n\n  pause() {\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.updatePermissions);\n  },\n\n  tick() {\n    if (this.needsPermission && !this.hasPermission) return;\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    if (userinput.get(this.data.path)) {\n      this.el.emit(this.data.event);\n    }\n  }\n});\n","AFRAME.registerComponent(\"action-to-remove\", {\n  multiple: true,\n\n  schema: {\n    path: { type: \"string\" },\n    requireOwnership: { type: \"boolean\", default: true }\n  },\n\n  init() {\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.networkedEl = networkedEl;\n    });\n  },\n\n  tick() {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    if (!userinput.get(this.data.path)) return;\n    if (this.data.requireOwnership && this.networkedEl && !NAF.utils.isMine(this.networkedEl)) return;\n\n    this.el.parentNode.removeChild(this.el);\n  }\n});\n","AFRAME.registerComponent(\"emit-scene-event-on-remove\", {\n  schema: {\n    event: { default: null }\n  },\n\n  remove() {\n    if (this.data.event) {\n      this.el.sceneEl.emit(this.data.event, { el: this.el });\n    }\n  }\n});\n","AFRAME.registerComponent(\"follow-in-fov\", {\n  schema: {\n    target: { type: \"selector\" },\n    offset: { type: \"vec3\" },\n    speed: { type: \"number\", default: 0.003 },\n    angle: { type: \"number\", default: 45 }\n  },\n\n  init() {\n    this.targetPos = new THREE.Vector3();\n    this.offset = new THREE.Vector3();\n    this.offset.copy(this.data.offset);\n\n    this.snappedRot = new THREE.Euler();\n    this.snappedQ = new THREE.Quaternion();\n    this.snappedXForm = new THREE.Matrix4();\n    this.snappedXFormWorld = new THREE.Matrix4();\n    this.tempVector = new THREE.Vector3();\n  },\n\n  tick(t, dt) {\n    if (!this.el.object3D.visible) return;\n\n    const obj = this.el.object3D;\n    const target = this.data.target.object3D;\n\n    // Compute position + rotation by projecting offset along a downward ray in target space,\n    // and mask out Z rotation.\n    this._applyMaskedTargetRotation(\n      -this.data.angle * THREE.Math.DEG2RAD,\n      target.rotation.y,\n      0,\n      this.snappedXFormWorld\n    );\n\n    this.targetPos.copy(this.offset);\n    this.targetPos.applyMatrix4(this.snappedXFormWorld);\n\n    if (obj.parent) {\n      obj.parent.worldToLocal(this.targetPos);\n    }\n\n    if (!this.started) {\n      obj.position.copy(this.targetPos);\n      this.started = true;\n    } else {\n      const t = this.data.speed * dt;\n\n      obj.position.set(\n        obj.position.x + (this.targetPos.x - obj.position.x) * t,\n        obj.position.y + (this.targetPos.y - obj.position.y) * t,\n        obj.position.z + (this.targetPos.z - obj.position.z) * t\n      );\n    }\n\n    this.snappedXFormWorld.decompose(this.tempVector, obj.quaternion, this.tempVector);\n    obj.matrixNeedsUpdate = true;\n  },\n\n  _applyMaskedTargetRotation(x, y, z, to) {\n    const target = this.data.target.object3D;\n    this.snappedRot.set(x, y, z, target.rotation.order);\n    this.snappedQ.setFromEuler(this.snappedRot);\n\n    this.snappedXForm.compose(\n      target.position,\n      this.snappedQ,\n      target.scale\n    );\n\n    to.multiplyMatrices(target.parent.matrixWorld, this.snappedXForm);\n  }\n});\n","AFRAME.registerComponent(\"matrix-auto-update\", {\n  schema: {\n    target: { type: \"string\" }\n  },\n\n  init: function() {\n    this._updateMatrixAutoUpdate = this._updateMatrixAutoUpdate.bind(this);\n    this._updateMatrixAutoUpdate();\n  },\n\n  play: function() {\n    this.el.sceneEl.addEventListener(\"object3dset\", this._updateMatrixAutoUpdate);\n  },\n\n  pause: function() {\n    this.el.sceneEl.removeEventListener(\"object3dset\", this._updateMatrixAutoUpdate);\n  },\n\n  _updateMatrixAutoUpdate: function() {\n    if (this.data.target) {\n      this.el.getObject3D(this.data.target).matrixAutoUpdate = true;\n    } else {\n      this.el.object3D.matrixAutoUpdate = true;\n    }\n  }\n});\n","AFRAME.registerComponent(\"tweet-media-button\", {\n  init() {\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n    });\n\n    this.onClick = () => {\n      const hasDiscordBridges = window.APP.hubChannel && window.APP.hubChannel.discordBridges().length > 0;\n\n      const text = !hasDiscordBridges\n        ? `Taken in hubs.mozilla.com - join me now at hub.link/${window.APP.hubChannel.hubId}! `\n        : `Taken in hubs.mozilla.com `;\n\n      const { src, contentSubtype } = this.targetEl.components[\"media-loader\"].data;\n      this.el.sceneEl.emit(\"action_media_tweet\", { url: src, contentSubtype, text, el: this.targetEl });\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","AFRAME.registerComponent(\"hover-menu\", {\n  multiple: true,\n  schema: {\n    template: { type: \"selector\" },\n    dirs: { type: \"array\" },\n    dim: { default: true },\n    withPermission: { type: \"string\" }\n  },\n\n  async init() {\n    this.onFrozenStateChange = this.onFrozenStateChange.bind(this);\n    this.hovering = false;\n    await this.getHoverMenu();\n    this.applyHoverState();\n  },\n\n  getHoverMenu() {\n    if (this.menuPromise) return this.menuPromise;\n    return (this.menuPromise = new Promise(resolve => {\n      const menu = this.el.appendChild(document.importNode(this.data.template.content, true).children[0]);\n      // we have to wait a tick for the attach callbacks to get fired for the elements in a template\n      setTimeout(() => {\n        this.menu = menu;\n        this.el.setAttribute(\"position-at-box-shape-border\", {\n          target: \".hover-container\",\n          dirs: this.data.dirs,\n          animate: false,\n          scale: false\n        });\n        resolve(this.menu);\n      });\n    }));\n  },\n\n  onFrozenStateChange(e) {\n    if (!e.detail === \"frozen\") return;\n    this.applyHoverState();\n  },\n\n  applyHoverState() {\n    if (!this.menu) return;\n    const allowed = !this.data.withPermission || window.APP.hubChannel.canOrWillIfCreator(this.data.withPermission);\n    this.menu.object3D.visible = allowed && !this.el.sceneEl.is(\"frozen\") && this.hovering;\n    if (this.data.dim && this.el.object3DMap.mesh && this.el.object3DMap.mesh.material) {\n      this.el.object3DMap.mesh.material.color.setScalar(this.menu.object3D.visible ? 0.5 : 1);\n    }\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onFrozenStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onFrozenStateChange);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onFrozenStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onFrozenStateChange);\n  }\n});\n","AFRAME.registerComponent(\"disable-frustum-culling\", {\n  init() {\n    this.el.object3D.traverse(o => (o.frustumCulled = false));\n  }\n});\n","AFRAME.registerComponent(\"set-active-camera\", {\n  init() {\n    // This is a hack needed to set the active camera because sometimes A-Frame will create the default camera and set it to the active camera on startup because the query selector to find an existing camera in the scene fails.\n\n    const cameraSystem = this.el.sceneEl.systems.camera;\n    const currentActiveCamera = cameraSystem.activeCameraEl;\n\n    if (currentActiveCamera !== this.el) {\n      cameraSystem.setActiveCamera(this.el);\n\n      // Also A-Frame fails to delete the default camera :P\n      currentActiveCamera.parentNode.removeChild(currentActiveCamera);\n\n      // Look controls leaves behind this CSS class.\n      this.el.sceneEl.canvas.classList.remove(\"a-grab-cursor\");\n    }\n  }\n});\n","AFRAME.registerComponent(\"track-pose\", {\n  schema: {\n    path: { type: \"string\" }\n  },\n\n  tick() {\n    const matrix = AFRAME.scenes[0].systems.userinput.get(this.data.path);\n    if (matrix) {\n      const o = this.el.object3D;\n      o.matrix.copy(matrix);\n      o.matrix.decompose(o.position, o.quaternion, o.scale);\n      o.matrixIsModified = true;\n    }\n  }\n});\n","AFRAME.registerComponent(\"replay\", {\n  init: function() {\n    this.playhead = 0;\n    this.poseIndex = 0;\n  },\n\n  tick: function(t, dt) {\n    let overflow = false;\n    while (!overflow && this.playhead >= this.poses[this.poseIndex].timestamp) {\n      this.el.setAttribute(\"position\", this.poses[this.poseIndex].position);\n      this.el.setAttribute(\"rotation\", this.poses[this.poseIndex].rotation);\n      this.el.object3D.matrixNeedsUpdate = true;\n      this.poseIndex += 1;\n      overflow = this.poseIndex === this.poses.length;\n    }\n\n    this.playhead += dt;\n\n    if (overflow) {\n      this.playhead = 0;\n      this.poseIndex = 0;\n    }\n  }\n});\n","AFRAME.registerComponent(\"visibility-by-path\", {\n  schema: {\n    path: { type: \"string\" }\n  },\n  tick() {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const shouldBeVisible = !!userinput.get(this.data.path);\n    if (this.el.object3D.visible !== shouldBeVisible) {\n      this.el.setAttribute(\"visible\", shouldBeVisible);\n    }\n  }\n});\n","AFRAME.registerComponent(\"tags\", {\n  schema: {\n    isHandCollisionTarget: { default: false },\n    isHoldable: { default: false },\n    offersHandConstraint: { default: false },\n    offersRemoteConstraint: { default: false },\n    singleActionButton: { default: false },\n    holdableButton: { default: false },\n    isPen: { default: false },\n    isHoverMenuChild: { default: false }\n  },\n  update() {\n    if (this.didUpdateOnce) {\n      console.warn(\"Do not edit tags with .setAttribute\");\n    }\n    this.didUpdateOnce = true;\n  }\n});\n","const isMobileVR = AFRAME.utils.device.isMobileVR();\n\n// Billboard component that only updates visible objects and only those in the camera view on mobile VR.\nAFRAME.registerComponent(\"billboard\", {\n  init: function() {\n    this.target = new THREE.Vector3();\n    this._updateBillboard = this._updateBillboard.bind(this);\n    this._updateIsInView = this._updateIsInView.bind(this);\n\n    if (isMobileVR) {\n      this.el.sceneEl.systems[\"frame-scheduler\"].schedule(this._updateIsInView, \"billboards\");\n    }\n  },\n  remove() {\n    if (isMobileVR) {\n      this.el.sceneEl.systems[\"frame-scheduler\"].unschedule(this._updateIsInView, \"billboards\");\n    }\n  },\n\n  tick() {\n    if (this.isInView || !isMobileVR) {\n      this._updateBillboard();\n    }\n  },\n\n  _updateIsInView: (function() {\n    const frustum = new THREE.Frustum();\n    const frustumMatrix = new THREE.Matrix4();\n    const box = new THREE.Box3();\n    const boxTemp = new THREE.Box3();\n\n    const expandBox = o => {\n      if (o.geometry) {\n        o.updateMatrices();\n        o.geometry.computeBoundingBox();\n        boxTemp.copy(o.geometry.boundingBox).applyMatrix4(o.matrixWorld);\n        box.expandByPoint(boxTemp.min);\n        box.expandByPoint(boxTemp.max);\n      }\n    };\n\n    const isInViewOfCamera = (obj, screenCamera) => {\n      frustumMatrix.multiplyMatrices(screenCamera.projectionMatrix, screenCamera.matrixWorldInverse);\n      frustum.setFromMatrix(frustumMatrix);\n      box.makeEmpty();\n      obj.traverse(expandBox);\n\n      // NOTE: not using box.setFromObject here because text nodes do not have Z values in their geometry buffer,\n      // and that routine ultimately assumes they do.\n      return frustum.intersectsBox(box);\n    };\n\n    return function() {\n      if (!this.el.object3D.visible) {\n        this.isInView = false;\n        return;\n      }\n\n      if (!this.playerCamera) {\n        this.playerCamera = document.querySelector(\"#player-camera\").getObject3D(\"camera\");\n      }\n\n      if (!this.playerCamera) return;\n\n      this.isInView = isInViewOfCamera(this.el.object3D, this.playerCamera);\n    };\n  })(),\n\n  _updateBillboard: function() {\n    if (!this.el.object3D.visible) return;\n\n    const camera = this.el.sceneEl.camera;\n    const object3D = this.el.object3D;\n\n    if (camera) {\n      // Set the camera world position as the target.\n      this.target.setFromMatrixPosition(camera.matrixWorld);\n      object3D.lookAt(this.target);\n      object3D.matrixNeedsUpdate = true;\n    }\n  }\n});\n","import { forEachMaterial } from \"../utils/material-utils\";\nimport { showHoverEffect } from \"../utils/permissions-utils\";\n\nconst interactorOneTransform = [];\nconst interactorTwoTransform = [];\n\nexport const validMaterials = [\"MeshStandardMaterial\", \"MeshBasicMaterial\", \"MobileStandardMaterial\"];\n/**\n * Applies effects to a hoverable based on hover state.\n * @namespace interactables\n * @component hoverable-visuals\n */\nAFRAME.registerComponent(\"hoverable-visuals\", {\n  schema: {\n    enableSweepingEffect: { type: \"boolean\", default: true }\n  },\n  init() {\n    // uniforms and boundingSphere are set from the component responsible for loading the mesh.\n    this.uniforms = null;\n    this.boundingSphere = new THREE.Sphere();\n\n    this.sweepParams = [0, 0];\n  },\n  remove() {\n    this.uniforms = null;\n    this.boundingBox = null;\n\n    // Used when the object is batched\n    const batchManagerSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].batchManagerSystem;\n    this.el.object3D.traverse(object => {\n      if (!object.material) return;\n      forEachMaterial(object, material => {\n        if (\n          !validMaterials.includes(material.type) ||\n          object.el.classList.contains(\"ui\") ||\n          object.el.classList.contains(\"hud\") ||\n          object.el.getAttribute(\"text-button\")\n        )\n          return;\n\n        batchManagerSystem.meshToEl.delete(object);\n      });\n    });\n  },\n  tick(time) {\n    if (!this.uniforms || !this.uniforms.length) return;\n\n    const isFrozen = this.el.sceneEl.is(\"frozen\");\n    const showEffect = showHoverEffect(this.el);\n\n    let interactorOne, interactorTwo;\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    if (interaction.state.leftHand.hovered === this.el && !interaction.state.leftHand.held) {\n      interactorOne = interaction.options.leftHand.entity.object3D;\n    }\n    if (interaction.state.rightRemote.hovered === this.el && !interaction.state.rightRemote.held) {\n      interactorTwo = interaction.options.rightRemote.entity.object3D;\n    }\n    if (interaction.state.rightHand.hovered === this.el && !interaction.state.rightHand.held) {\n      interactorTwo = interaction.options.rightHand.entity.object3D;\n    }\n\n    if (interactorOne) {\n      interactorOne.matrixWorld.toArray(interactorOneTransform);\n    }\n    if (interactorTwo) {\n      interactorTwo.matrixWorld.toArray(interactorTwoTransform);\n    }\n\n    if (interactorOne || interactorTwo || isFrozen) {\n      const worldY = this.el.object3D.matrixWorld.elements[13];\n      const scaledRadius = this.el.object3D.scale.y * this.boundingSphere.radius;\n      this.sweepParams[0] = worldY - scaledRadius;\n      this.sweepParams[1] = worldY + scaledRadius;\n    }\n\n    for (let i = 0, l = this.uniforms.length; i < l; i++) {\n      const uniform = this.uniforms[i];\n      uniform.hubs_EnableSweepingEffect.value = this.data.enableSweepingEffect && showEffect;\n      uniform.hubs_IsFrozen.value = isFrozen;\n      uniform.hubs_SweepParams.value = this.sweepParams;\n\n      uniform.hubs_HighlightInteractorOne.value = !!interactorOne && showEffect;\n      uniform.hubs_InteractorOnePos.value[0] = interactorOneTransform[12];\n      uniform.hubs_InteractorOnePos.value[1] = interactorOneTransform[13];\n      uniform.hubs_InteractorOnePos.value[2] = interactorOneTransform[14];\n\n      uniform.hubs_HighlightInteractorTwo.value = !!interactorTwo && showEffect;\n      uniform.hubs_InteractorTwoPos.value[0] = interactorTwoTransform[12];\n      uniform.hubs_InteractorTwoPos.value[1] = interactorTwoTransform[13];\n      uniform.hubs_InteractorTwoPos.value[2] = interactorTwoTransform[14];\n\n      if (interactorOne || interactorTwo || isFrozen) {\n        uniform.hubs_Time.value = time;\n      }\n    }\n  }\n});\n","// Given a function and a queue name, schedules things so a single function\n// from a given queue will be called per frame.\nAFRAME.registerSystem(\"frame-scheduler\", {\n  init() {\n    // Registry a map from queue name to list of registered functions.\n    this.registry = new Map();\n    this.queues = [];\n    this.frameIndex = 0;\n  },\n\n  schedule(func, queue) {\n    if (!this.registry.has(queue)) {\n      this.queues.push(queue);\n      this.registry.set(queue, []);\n    }\n\n    this.registry.get(queue).push(func);\n  },\n\n  unschedule(func) {\n    for (let i = 0; i < this.queues.length; i++) {\n      const queue = this.queues[i];\n      const entries = this.registry.get(queue);\n      const idx = entries.indexOf(func);\n\n      if (idx >= 0) {\n        entries.splice(idx, 1);\n      }\n    }\n  },\n\n  tick: function() {\n    for (let i = 0; i < this.queues.length; i++) {\n      const queue = this.queues[i];\n      const entries = this.registry.get(queue);\n      if (entries.length === 0) continue;\n\n      entries[this.frameIndex % entries.length]();\n    }\n\n    this.frameIndex++;\n  }\n});\n","/* global AFRAME */\n\n/**\n * Toggle visibility of an entity based on if the user is in vr mode or not\n * @namespace vr-mode\n * @component vr-mode-toggle-visibility\n */\nAFRAME.registerComponent(\"vr-mode-toggle-visibility\", {\n  schema: {\n    invert: { type: \"boolean\", default: false }\n  },\n\n  init() {\n    this.updateComponentState = this.updateComponentState.bind(this);\n  },\n\n  play() {\n    this.updateComponentState();\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  updateComponentState() {\n    const inVRMode = this.el.sceneEl.is(\"vr-mode\");\n    this.el.setAttribute(\"visible\", inVRMode !== this.data.invert);\n  }\n});\n\n/**\n * Toggle the isPlaying state of a component based on app mode\n * @namespace vr-mode\n * @component vr-mode-toggle-playing\n */\nAFRAME.registerComponent(\"vr-mode-toggle-playing\", {\n  multiple: true,\n  schema: {\n    invert: { type: \"boolean\", default: false }\n  },\n\n  init() {\n    this.updateComponentState = this.updateComponentState.bind(this);\n  },\n\n  play() {\n    this.updateComponentState();\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  updateComponentState() {\n    const componentName = this.id;\n    const inVRMode = this.el.sceneEl.is(\"vr-mode\");\n    this.el.components[componentName][inVRMode !== this.data.invert ? \"play\" : \"pause\"]();\n  }\n});\n\n/**\n * Toggle a CSS class based upon app mode.\n * @namespace vr-mode\n * @component vr-mode-toggle-class\n */\nAFRAME.registerComponent(\"vr-mode-toggle-class\", {\n  multiple: true,\n  schema: {\n    invert: { type: \"boolean\", default: false },\n    class: { type: \"string\", default: \"\" }\n  },\n\n  init() {\n    this.updateComponentState = this.updateComponentState.bind(this);\n  },\n\n  play() {\n    this.updateComponentState();\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.updateComponentState);\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.updateComponentState);\n  },\n\n  updateComponentState() {\n    const inVRMode = this.el.sceneEl.is(\"vr-mode\");\n\n    if (inVRMode) {\n      this.el.classList.add(this.data.class);\n    } else {\n      this.el.classList.remove(this.data.class);\n    }\n  }\n});\n","AFRAME.registerSystem(\"permissions\", {\n  onPermissionsUpdated(handler) {\n    if (window.APP.hubChannel) {\n      window.APP.hubChannel.addEventListener(\"permissions_updated\", handler);\n    } else {\n      window.addEventListener(\n        \"hub_channel_ready\",\n        () => window.APP.hubChannel.addEventListener(\"permissions_updated\", handler),\n        { once: true }\n      );\n    }\n  },\n  can(permissionName) {\n    return !!window.APP.hubChannel.can(permissionName);\n  },\n  canOrWillIfCreator(permissionName) {\n    return !!window.APP.hubChannel.canOrWillIfCreator(permissionName);\n  },\n  fetchPermissions() {\n    return window.APP.hubChannel.fetchPermissions();\n  }\n});\n","/**\n * Emits an \"exit\" event when a user has stopped using the app for a certain period of time\n * @system exit-on-blur\n */\nAFRAME.registerSystem(\"exit-on-blur\", {\n  init() {\n    this.onBlur = this.onBlur.bind(this);\n    this.onFocus = this.onFocus.bind(this);\n    this.onTimeout = this.onTimeout.bind(this);\n    this.onEnterVR = this.onEnterVR.bind(this);\n\n    this.isOculusBrowser = navigator.userAgent.match(/Oculus/);\n    this.enteredVR = false;\n\n    window.addEventListener(\"blur\", this.onBlur);\n    window.addEventListener(\"focus\", this.onFocus);\n    this.el.addEventListener(\"enter-vr\", this.onEnterVR);\n\n    this.lastTimeoutCheck = 0;\n    this.exitTimeout = null;\n  },\n\n  tick(t) {\n    // This is a hack to detect when an Oculus Go user has taken off the headset and the headset has\n    // entered standby mode. Currently Oculus Browser is not emitting a blur, vrdisplaydeactivate,\n    // vrdisplayblur, visibilitychange, or vrdisplaypresentchange event, so we wait 15 seconds after\n    // the last requestAnimationFrame callback to determine if the headset has gone into standby mode.\n    // We also check that you have entered VR so that this timeout does not occur in the setup UI.\n    if (\n      this.isOculusBrowser &&\n      this.enteredVR &&\n      (this.lastTimeoutCheck === 0 || t - this.lastTimeoutCheck >= 1000.0) // Don't do this clear every frame, slow.\n    ) {\n      this.lastTimeoutCheck = t;\n      clearTimeout(this.exitTimeout);\n      this.exitTimeout = setTimeout(this.onTimeout, 15 * 1000);\n    }\n  },\n\n  onEnterVR() {\n    this.enteredVR = true;\n  },\n\n  onBlur() {\n    if (this.el.isMobile) {\n      clearTimeout(this.exitTimeout);\n      this.exitTimeout = setTimeout(this.onTimeout, 30 * 1000);\n    }\n  },\n\n  onFocus() {\n    if (this.el.isMobile) {\n      clearTimeout(this.exitTimeout);\n    }\n  },\n\n  onTimeout() {\n    this.el.dispatchEvent(new CustomEvent(\"exit\"));\n  },\n\n  remove() {\n    clearTimeout(this.exitTimeout);\n    window.removeEventListener(\"blur\", this.onBlur);\n  }\n});\n","module.exports = {\n  COLLISION_LAYERS: {\n    ALL: -1,\n    NONE: 0,\n    INTERACTABLES: 1,\n    ENVIRONMENT: 2,\n    AVATAR: 4,\n    HANDS: 8,\n    DEFAULT_INTERACTABLE: 1 | 2 | 4 | 8,\n    UNOWNED_INTERACTABLE: 1 | 8,\n    DEFAULT_SPAWNER: 1 | 8\n  }\n};\n","/* global AFRAME NAF performance */\nAFRAME.registerComponent(\"owned-object-limiter\", {\n  schema: {\n    counter: { type: \"selector\" }\n  },\n\n  init() {\n    this.counter = this.data.counter.components[\"networked-counter\"];\n  },\n\n  tick() {\n    this._syncCounterRegistration();\n    const isHeld = this.el.sceneEl.systems.interaction.isHeld(this.el);\n    if (!isHeld && this.wasHeld && this.counter.timestamps.has(this.el)) {\n      this.counter.timestamps.set(this.el, performance.now());\n    }\n    this.wasHeld = isHeld;\n  },\n\n  remove() {\n    this.counter.deregister(this.el);\n  },\n\n  _syncCounterRegistration() {\n    if (!this.el.components[\"networked\"]) return;\n\n    const isPinned = this.el.components[\"pinnable\"] && this.el.components[\"pinnable\"].data.pinned;\n\n    if (NAF.utils.isMine(this.el) && !isPinned) {\n      this.counter.register(this.el);\n    } else {\n      this.counter.deregister(this.el);\n    }\n  }\n});\n","/* global NAF */\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\n\nAFRAME.registerComponent(\"set-unowned-body-kinematic\", {\n  init() {\n    this.setBodyKinematic = this.setBodyKinematic.bind(this);\n  },\n  play() {\n    this.el.addEventListener(\"ownership-lost\", this.setBodyKinematic);\n\n    if (!this.didThisOnce) {\n      // Do this in play instead of init so that the ammo-body and networked components are done\n      this.didThisOnce = true;\n\n      if (!NAF.utils.isMine(this.el)) {\n        this.setBodyKinematic();\n      }\n    }\n  },\n  pause() {\n    this.el.removeEventListener(\"ownership-lost\", this.setBodyKinematic);\n  },\n  setBodyKinematic() {\n    this.el.setAttribute(\"ammo-body\", {\n      type: \"kinematic\",\n      collisionFilterMask: COLLISION_LAYERS.UNOWNED_INTERACTABLE\n    });\n    if (this.el.components[\"floaty-object\"]) {\n      this.el.components[\"floaty-object\"].locked = true;\n    }\n  }\n});\n","/* global AFRAME performance */\n/**\n * Limits networked interactables to a maximum number at any given time\n * @namespace network\n * @component networked-counter\n */\nAFRAME.registerComponent(\"networked-counter\", {\n  schema: {\n    max: { default: 3 }\n  },\n\n  init() {\n    this.timestamps = new Map();\n    this.el.object3D.visible = false;\n  },\n\n  remove() {\n    this.timestamps.clear();\n  },\n\n  count() {\n    return this.timestamps.size;\n  },\n\n  register(el) {\n    if (this.data.max <= 0 || this.timestamps.has(el)) return;\n\n    this.timestamps.set(el, performance.now());\n    if (this.timestamps.size > this.data.max) {\n      this._destroyOldest();\n    }\n  },\n\n  deregister(el) {\n    if (!this.timestamps.has(el)) return;\n    this.timestamps.delete(el);\n  },\n\n  _destroyOldest() {\n    const interaction = this.el.sceneEl.systems.interaction;\n    let oldestEl = null,\n      minTs = Number.MAX_VALUE;\n    this.timestamps.forEach((ts, el) => {\n      if (ts < minTs && !interaction.isHeld(el) && NAF.utils.isMine(el)) {\n        oldestEl = el;\n        minTs = ts;\n      }\n    });\n    this._destroy(oldestEl);\n  },\n\n  _destroy(el) {\n    // Pause the entity so that it won't just re-register itself immediately in owned-object-limiter.\n    el.pause();\n    // networked-interactable's remove will also call deregister, but it will happen async so we do it here as well.\n    this.deregister(el);\n    el.parentNode.removeChild(el);\n  }\n});\n","AFRAME.registerComponent(\"set-yxz-order\", {\n  init: function() {\n    this.el.object3D.rotation.order = \"YXZ\";\n  }\n});\n","/**\n * Initializes teleporters when the environment bundle has loaded.\n * @namespace environment\n * @component nav-mesh-helper\n */\nAFRAME.registerComponent(\"nav-mesh-helper\", {\n  init: function() {\n    this.el.addEventListener(\"model-loaded\", () => {\n      const teleporters = document.querySelectorAll(\"[teleporter]\");\n      for (let i = 0; i < teleporters.length; i++) {\n        teleporters[i].components[\"teleporter\"].queryCollisionEntities();\n      }\n    });\n  }\n});\n","/**\n * Drawing Manager\n * Manages what networked-drawings are available to pen components\n * @namespace drawing\n * @component drawing-manager\n */\nAFRAME.registerComponent(\"drawing-manager\", {\n  init() {\n    this._onComponentInitialized = this._onComponentInitialized.bind(this);\n\n    this.el.object3D.visible = false;\n    this.drawingToPen = new Map();\n  },\n\n  remove() {\n    if (this.drawingEl) {\n      this.drawingEl.removeEventListener(\"componentinitialized\", this._onComponentInitialized);\n    }\n  },\n\n  _onComponentInitialized(e) {\n    if (e.detail.name == \"networked-drawing\") {\n      this.drawing = this.drawingEl.components[\"networked-drawing\"];\n    }\n  },\n\n  createDrawing() {\n    if (!this.drawingEl) {\n      this.drawingEl = document.createElement(\"a-entity\");\n      this.drawingEl.setAttribute(\"networked\", \"template: #interactable-drawing\");\n      this.el.sceneEl.appendChild(this.drawingEl);\n\n      this.drawingEl.addEventListener(\"componentinitialized\", this._onComponentInitialized);\n    }\n  },\n\n  getDrawing(pen) {\n    //TODO: future handling of multiple drawings\n    if (this.drawing && (!this.drawingToPen.has(this.drawing) || this.drawingToPen.get(this.drawing) === pen)) {\n      this.drawingToPen.set(this.drawing, pen);\n      return this.drawing;\n    }\n\n    return null;\n  },\n\n  returnDrawing(pen) {\n    if (this.drawingToPen.has(this.drawing) && this.drawingToPen.get(this.drawing) === pen) {\n      this.drawingToPen.delete(this.drawing);\n    }\n  }\n});\n","export const paths = {};\npaths.noop = \"/noop\";\npaths.actions = {};\npaths.actions.log = \"/actions/log\";\npaths.actions.toggleScreenShare = \"/actions/toggleScreenShare\";\npaths.actions.snapRotateLeft = \"/actions/snapRotateLeft\";\npaths.actions.snapRotateRight = \"/actions/snapRotateRight\";\npaths.actions.angularVelocity = \"/actions/angularVelocity\";\npaths.actions.logDebugFrame = \"/actions/logDebugFrame\";\npaths.actions.logInteractionState = \"/actions/logInteractionState\";\npaths.actions.cameraDelta = \"/actions/cameraDelta\";\npaths.actions.lobbyCameraDelta = \"/actions/lobbyCameraDelta\";\npaths.actions.characterAcceleration = \"/actions/characterAcceleration\";\npaths.actions.boost = \"/actions/boost\";\npaths.actions.startGazeTeleport = \"/actions/startTeleport\";\npaths.actions.stopGazeTeleport = \"/actions/stopTeleport\";\npaths.actions.spawnPen = \"/actions/spawnPen\";\npaths.actions.ensureFrozen = \"/actions/ensureFrozen\";\npaths.actions.toggleFreeze = \"/actions/toggleFreeze\";\npaths.actions.thaw = \"/actions/thaw\";\npaths.actions.muteMic = \"/actions/muteMic\";\npaths.actions.toggleFlying = \"/actions/toggleFlying\";\npaths.actions.focusChat = \"/actions/focusChat\";\npaths.actions.focusChatCommand = \"/actions/focusChatCommand\";\npaths.actions.toggleCamera = \"/actions/toggleCamera\";\npaths.actions.takeSnapshot = \"/actions/takeSnapshot\";\npaths.actions.mediaExit = \"/actions/mediaExit\";\npaths.actions.mediaSearch1 = \"/actions/mediaSearch1\";\npaths.actions.mediaSearch2 = \"/actions/mediaSearch2\";\npaths.actions.mediaSearch3 = \"/actions/mediaSearch3\";\npaths.actions.mediaSearch4 = \"/actions/mediaSearch4\";\npaths.actions.mediaSearch5 = \"/actions/mediaSearch5\";\npaths.actions.mediaSearch6 = \"/actions/mediaSearch6\";\npaths.actions.mediaSearch7 = \"/actions/mediaSearch7\";\npaths.actions.mediaSearch8 = \"/actions/mediaSearch8\";\npaths.actions.transformModifier = \"/actions/transformModifier\";\npaths.actions.rayObjectRotation = \"/actions/rayObjectRotation\";\npaths.actions.cursor = {};\npaths.actions.cursor.pose = \"/actions/cursorPose\";\npaths.actions.cursor.hideLine = \"/actions/cursorHideLine\";\npaths.actions.cursor.grab = \"/actions/cursorGrab\";\npaths.actions.cursor.drop = \"/actions/cursorDrop\";\npaths.actions.cursor.modDelta = \"/actions/cursorModDelta\";\npaths.actions.cursor.startDrawing = \"/actions/cursorStartDrawing\";\npaths.actions.cursor.stopDrawing = \"/actions/cursorStopDrawing\";\npaths.actions.cursor.undoDrawing = \"/actions/cursorUndoDrawing\";\npaths.actions.cursor.penNextColor = \"/actions/cursorPenNextColor\";\npaths.actions.cursor.penPrevColor = \"/actions/cursorPenPrevColor\";\npaths.actions.cursor.scalePenTip = \"/actions/cursorScalePenTip\";\npaths.actions.cursor.scaleGrabbedGrabbable = \"/actions/cursorScaleGrabbedGrabbable\";\npaths.actions.cursor.mediaVolumeMod = \"/actions/cursor/mediaVolumeMod\";\npaths.actions.cursor.takeSnapshot = \"/actions/cursorTakeSnapshot\";\npaths.actions.pen = {};\npaths.actions.pen.remove = \"/actions/pen/remove\";\npaths.actions.rightHand = {};\npaths.actions.rightHand.matrix = \"/actions/rightHand/matrix\";\npaths.actions.rightHand.pose = \"/actions/rightHandPose\";\npaths.actions.rightHand.grab = \"/actions/rightHandGrab\";\npaths.actions.rightHand.drop = \"/actions/rightHandDrop\";\npaths.actions.rightHand.modDelta = \"/actions/rightHandModDelta\";\npaths.actions.rightHand.startDrawing = \"/actions/rightHandStartDrawing\";\npaths.actions.rightHand.stopDrawing = \"/actions/rightHandStopDrawing\";\npaths.actions.rightHand.undoDrawing = \"/actions/rightHandUndoDrawing\";\npaths.actions.rightHand.switchDrawMode = \"/actions/rightHandSwitchDrawMode\";\npaths.actions.rightHand.penNextColor = \"/actions/rightHandPenNextColor\";\npaths.actions.rightHand.penPrevColor = \"/actions/rightHandPenPrevColor\";\npaths.actions.rightHand.scalePenTip = \"/actions/rightHandScalePenTip\";\npaths.actions.rightHand.startTeleport = \"/actions/rightHand/startTeleport\";\npaths.actions.rightHand.stopTeleport = \"/actions/rightHand/stopTeleport\";\npaths.actions.rightHand.takeSnapshot = \"/actions/rightHandTakeSnapshot\";\npaths.actions.rightHand.thumb = \"/actions/rightHand/thumbDown\";\npaths.actions.rightHand.index = \"/actions/rightHand/indexDown\";\npaths.actions.rightHand.middleRingPinky = \"/actions/rightHand/middleRingPinkyDown\";\npaths.actions.leftHand = {};\npaths.actions.leftHand.matrix = \"/actions/leftHand/matrix\";\npaths.actions.leftHand.pose = \"/actions/leftHandPose\";\npaths.actions.leftHand.grab = \"/actions/leftHandGrab\";\npaths.actions.leftHand.drop = \"/actions/leftHandDrop\";\npaths.actions.leftHand.modDelta = \"/actions/leftHandModDelta\";\npaths.actions.leftHand.startDrawing = \"/actions/leftHandStartDrawing\";\npaths.actions.leftHand.stopDrawing = \"/actions/leftHandStopDrawing\";\npaths.actions.leftHand.undoDrawing = \"/actions/leftHandUndoDrawing\";\npaths.actions.leftHand.switchDrawMode = \"/actions/leftHandSwitchDrawMode\";\npaths.actions.leftHand.penNextColor = \"/actions/leftHandPenNextColor\";\npaths.actions.leftHand.penPrevColor = \"/actions/leftHandPenPrevColor\";\npaths.actions.leftHand.scalePenTip = \"/actions/leftHandScalePenTip\";\npaths.actions.leftHand.startTeleport = \"/actions/leftHand/startTeleport\";\npaths.actions.leftHand.stopTeleport = \"/actions/leftHand/stopTeleport\";\npaths.actions.leftHand.takeSnapshot = \"/actions/leftHandTakeSnapshot\";\npaths.actions.leftHand.thumb = \"/actions/leftHand/thumbDown\";\npaths.actions.leftHand.index = \"/actions/leftHand/indexDown\";\npaths.actions.leftHand.middleRingPinky = \"/actions/leftHand/middleRingPinkyDown\";\npaths.actions.camera = {};\npaths.actions.camera.exitMirror = \"/actions/cameraExitMirror\";\npaths.haptics = {};\npaths.haptics.actuators = {};\npaths.haptics.actuators.left = \"/haptics/actuators/left\";\npaths.haptics.actuators.right = \"/haptics/actuators/right\";\n\npaths.device = {};\npaths.device.mouse = {};\npaths.device.mouse.coords = \"/device/mouse/coords\";\npaths.device.mouse.movementXY = \"/device/mouse/movementXY\";\npaths.device.mouse.buttonLeft = \"/device/mouse/buttonLeft\";\npaths.device.mouse.buttonRight = \"/device/mouse/buttonRight\";\npaths.device.mouse.wheel = \"/device/mouse/wheel\";\npaths.device.smartMouse = {};\npaths.device.smartMouse.cursorPose = \"/device/smartMouse/cursorPose\";\npaths.device.smartMouse.cameraDelta = \"/device/smartMouse/cameraDelta\";\npaths.device.touchscreen = {};\npaths.device.touchscreen.cursorPose = \"/device/touchscreen/cursorPose\";\npaths.device.touchscreen.touchCameraDelta = \"/device/touchscreen/touchCameraDelta\";\npaths.device.touchscreen.gyroCameraDelta = \"/device/touchscreen/gyroCameraDelta\";\npaths.device.touchscreen.cameraDelta = \"/device/touchscreen/cameraDelta\";\npaths.device.touchscreen.pinch = {};\npaths.device.touchscreen.pinch.delta = \"/device/touchscreen/pinch/delta\";\npaths.device.touchscreen.pinch.initialDistance = \"/device/touchscreen/pinch/initialDistance\";\npaths.device.touchscreen.pinch.currentDistance = \"/device/touchscreen/pinch/currentDistance\";\npaths.device.touchscreen.isTouching = \"/device/touchscreen/isTouching\";\npaths.device.touchscreen.isTouchingGrabbable = \"/device/touchscreen/isTouchingGrabbable\";\npaths.device.touchscreen.tap1 = \"/device/touchscreen/tap1\";\npaths.device.touchscreen.tap2 = \"/device/touchscreen/tap2\";\npaths.device.touchscreen.tap3 = \"/device/touchscreen/tap3\";\npaths.device.touchscreen.tap4 = \"/device/touchscreen/tap4\";\npaths.device.touchscreen.tap5 = \"/device/touchscreen/tap5\";\npaths.device.gyro = {};\npaths.device.gyro.averageDeltaX = \"/device/gyro/averageDeltaX\";\npaths.device.gyro.averageDeltaY = \"/device/gyro/averageDeltaY\";\npaths.device.hud = {};\npaths.device.hud.penButton = \"/device/hud/penButton\";\n\npaths.device.keyboard = {\n  map: new Map(),\n  key: function(k) {\n    let path = this.map.get(k);\n    if (path) {\n      return path;\n    }\n    path = `/device/keyboard/${k.toLowerCase()}`;\n    this.map.set(k, path);\n    return path;\n  }\n};\n\npaths.device.gamepad = gamepadIndex => ({\n  button: buttonIndex => ({\n    pressed: `/device/gamepad/${gamepadIndex}/button/${buttonIndex}/pressed`,\n    touched: `/device/gamepad/${gamepadIndex}/button/${buttonIndex}/touched`,\n    value: `/device/gamepad/${gamepadIndex}/button/${buttonIndex}/value`\n  }),\n  axis: axisIndex => `/device/gamepad/${gamepadIndex}/axis/${axisIndex}`\n});\n\nconst xbox = \"/device/xbox/\";\npaths.device.xbox = {\n  v: name => `/vars/xbox/${name}`,\n  button: buttonName => ({\n    pressed: `${xbox}button/${buttonName}/pressed`,\n    touched: `${xbox}button/${buttonName}/touched`,\n    value: `${xbox}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${xbox}axis/${axisName}`;\n  },\n  axesSum: `${xbox}axis/sum`\n};\n\npaths.device.oculusgo = {\n  // TODO remove these in favor of the direct accessors\n  button: buttonName => ({\n    pressed: `/device/oculusgo/button/${buttonName}/pressed`,\n    touched: `/device/oculusgo/button/${buttonName}/touched`,\n    value: `/device/oculusgo/button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `/device/oculusgo/axis/${axisName}`;\n  },\n  //\n  trigger: {\n    pressed: \"/device/oculusgo/button/trigger/pressed\",\n    touched: \"/device/oculusgo/button/trigger/touched\",\n    value: \"/device/oculusgo/button/trigger/value\"\n  },\n  touchpad: {\n    pressed: \"/device/oculusgo/button/touchpad/pressed\",\n    touched: \"/device/oculusgo/button/touchpad/touched\",\n    value: \"/device/oculusgo/button/touchpad/value\",\n    axisX: \"/device/oculusgo/axis/touchpadX\",\n    axisY: \"/device/oculusgo/axis/touchpadY\"\n  },\n  pose: \"/device/oculusgo/pose\",\n  matrix: \"/device/oculusgo/matrix\",\n  v: name => {\n    return `/vars/oculusgo/${name}`;\n  }\n};\n\nconst gearVRController = \"/device/gearVRController/\";\npaths.device.gearVRController = {\n  button: buttonName => ({\n    pressed: `${gearVRController}button/${buttonName}/pressed`,\n    touched: `${gearVRController}button/${buttonName}/touched`,\n    value: `${gearVRController}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${gearVRController}axis/${axisName}`;\n  },\n  pose: `${gearVRController}pose`,\n  matrix: `${gearVRController}matrix`,\n  v: name => {\n    return `/vars/gearVRController/${name}`;\n  }\n};\n\nconst daydream = \"/device/daydream/\";\npaths.device.daydream = {\n  button: buttonName => ({\n    pressed: `${daydream}button/${buttonName}/pressed`,\n    touched: `${daydream}button/${buttonName}/touched`,\n    value: `${daydream}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${daydream}axis/${axisName}`;\n  },\n  pose: `${daydream}pose`,\n  matrix: `${daydream}matrix`\n};\n\nconst rightOculusTouch = \"/device/rightOculusTouch/\";\npaths.device.rightOculusTouch = {\n  button: buttonName => ({\n    pressed: `${rightOculusTouch}button/${buttonName}/pressed`,\n    touched: `${rightOculusTouch}button/${buttonName}/touched`,\n    value: `${rightOculusTouch}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${rightOculusTouch}axis/${axisName}`;\n  },\n  axesSum: `${rightOculusTouch}axis/sum`,\n  pose: `${rightOculusTouch}pose`,\n  matrix: `${rightOculusTouch}matrix`\n};\n\nconst leftOculusTouch = \"/device/leftOculusTouch/\";\npaths.device.leftOculusTouch = {\n  button: buttonName => ({\n    pressed: `${leftOculusTouch}button/${buttonName}/pressed`,\n    touched: `${leftOculusTouch}button/${buttonName}/touched`,\n    value: `${leftOculusTouch}button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `${leftOculusTouch}axis/${axisName}`;\n  },\n  axesSum: `${leftOculusTouch}axis/sum`,\n  pose: `${leftOculusTouch}pose`,\n  matrix: `${leftOculusTouch}matrix`\n};\n\npaths.device.vive = {};\npaths.device.vive.left = {\n  button: buttonName => ({\n    pressed: `/device/vive/left/button/${buttonName}/pressed`,\n    touched: `/device/vive/left/button/${buttonName}/touched`,\n    value: `/device/vive/left/button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `/device/vive/left/axis/${axisName}`;\n  },\n  axesSum: \"/device/vive/left/axis/sum\",\n  pose: `/device/vive/left/pose`,\n  matrix: `/device/vive/left/matrix`\n};\npaths.device.vive.right = {\n  button: buttonName => ({\n    pressed: `/device/vive/right/button/${buttonName}/pressed`,\n    touched: `/device/vive/right/button/${buttonName}/touched`,\n    value: `/device/vive/right/button/${buttonName}/value`\n  }),\n  axis: axisName => {\n    return `/device/vive/right/axis/${axisName}`;\n  },\n  axesSum: \"/device/vive/right/axis/sum\",\n  pose: `/device/vive/right/pose`,\n  matrix: `/device/vive/right/matrix`\n};\n\nfunction button(device, side, name) {\n  return {\n    pressed: `${device}${side}/button/${name}/pressed`,\n    touched: `${device}${side}/button/${name}/touched`,\n    value: `${device}${side}/button/${name}/value`\n  };\n}\n\nfunction axes(device, side, name) {\n  return {\n    axisX: `${device}${side}/axis/${name}X`,\n    axisY: `${device}${side}/axis/${name}Y`\n  };\n}\n\nfunction wmrController(side) {\n  const wmr = \"/device/wmr/\";\n  return {\n    touchpad: {\n      ...button(wmr, side, \"touchpad\"),\n      ...axes(wmr, side, \"touchpad\")\n    },\n    trigger: button(wmr, side, \"trigger\"),\n    grip: button(wmr, side, \"grip\"),\n    menu: button(wmr, side, \"menu\"),\n    joystick: axes(wmr, side, \"joystick\"),\n    pose: `${wmr}${side}/pose`,\n    matrix: `${wmr}${side}/matrix`\n  };\n}\npaths.device.wmr = {};\npaths.device.wmr.v = name => `/vars/wmr/${name}`;\npaths.device.wmr.k = name => `/vars/wmr/keyboard/${name}`;\npaths.device.wmr.left = wmrController(\"left\");\npaths.device.wmr.right = wmrController(\"right\");\n","import { forEachMaterial } from \"../utils/material-utils\";\nimport cubeMapPosX from \"../assets/images/cubemap/posx.jpg\";\nimport cubeMapNegX from \"../assets/images/cubemap/negx.jpg\";\nimport cubeMapPosY from \"../assets/images/cubemap/posy.jpg\";\nimport cubeMapNegY from \"../assets/images/cubemap/negy.jpg\";\nimport cubeMapPosZ from \"../assets/images/cubemap/posz.jpg\";\nimport cubeMapNegZ from \"../assets/images/cubemap/negz.jpg\";\n\nexport async function createDefaultEnvironmentMap() {\n  const urls = [cubeMapPosX, cubeMapNegX, cubeMapPosY, cubeMapNegY, cubeMapPosZ, cubeMapNegZ];\n  const texture = await new Promise((resolve, reject) =>\n    new THREE.CubeTextureLoader().load(urls, resolve, undefined, reject)\n  );\n  texture.format = THREE.RGBFormat;\n  return texture;\n}\n\nAFRAME.registerComponent(\"environment-map\", {\n  init() {\n    this.environmentMap = null;\n\n    this.updateEnvironmentMap = this.updateEnvironmentMap.bind(this);\n  },\n\n  updateEnvironmentMap(environmentMap) {\n    this.environmentMap = environmentMap;\n    this.applyEnvironmentMap(this.el.object3D);\n  },\n\n  applyEnvironmentMap(object3D) {\n    object3D.traverse(object => {\n      forEachMaterial(object, material => {\n        if (material.isMeshStandardMaterial) {\n          material.envMap = this.environmentMap;\n          material.needsUpdate = true;\n        }\n      });\n    });\n  }\n});\n","module.exports = \"if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\\n  float ratio = 0.0;\\n\\n  if (hubs_EnableSweepingEffect) {\\n    float size = hubs_SweepParams.t - hubs_SweepParams.s;\\n    float line = mod(hubs_Time / 500.0 * size, size * 3.0) + hubs_SweepParams.s - size / 3.0;\\n\\n    if (hubs_WorldPosition.y < line) {\\n      // Highlight with a sweeping gradient.\\n      ratio = max(0.0, 1.0 - (line - hubs_WorldPosition.y) / (size * 1.5));\\n    }\\n  }\\n\\n  // Highlight with a gradient falling off with distance.\\n  float pulse = 9.0 + 3.0 * (sin(hubs_Time / 1000.0) + 1.0);\\n\\n  if (hubs_HighlightInteractorOne) {\\n    float dist1 = distance(hubs_WorldPosition, hubs_InteractorOnePos);\\n    ratio += -min(1.0, pow(dist1 * pulse, 3.0)) + 1.0;\\n  } \\n\\n  if (hubs_HighlightInteractorTwo) {\\n    float dist2 = distance(hubs_WorldPosition, hubs_InteractorTwoPos);\\n    ratio += -min(1.0, pow(dist2 * pulse, 3.0)) + 1.0;\\n  }\\n\\n  ratio = min(1.0, ratio);\\n\\n  // Gamma corrected highlight color\\n  vec3 highlightColor = vec3(0.184, 0.499, 0.933);\\n\\n  gl_FragColor.rgb = (gl_FragColor.rgb * (1.0 - ratio)) + (highlightColor * ratio);\\n}\\n\"","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posx-d235fb97df77b607be04b84125f40e7c.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negx-35034574e114423babdea92b6a2eb97a.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posy-d0c4e1e7979d75923d4d8b49c191bc6e.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negy-35808d21d1d17ac1b84d3184e365093b.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/posz-de29aa8396196e4b040cd5305e351dbe.jpg\";","module.exports = __webpack_public_path__ + \"assets/images/cubemap/negz-d73d18a8b7994524dc39a6ea3fcf43fc.jpg\";","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nexport default class DialogContainer extends Component {\n  static propTypes = {\n    title: PropTypes.node,\n    children: PropTypes.node.isRequired,\n    onClose: PropTypes.func,\n    closable: PropTypes.bool,\n    wide: PropTypes.bool,\n    className: PropTypes.string,\n    allowOverflow: PropTypes.bool,\n    additionalClass: PropTypes.string\n  };\n\n  static defaultProps = {\n    closable: true\n  };\n\n  constructor(props) {\n    super(props);\n    this.onKeyDown = this.onKeyDown.bind(this);\n    this.onContainerClicked = this.onContainerClicked.bind(this);\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"keydown\", this.onKeyDown);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"keydown\", this.onKeyDown);\n  }\n\n  onKeyDown(e) {\n    if (this.props.closable && e.key === \"Escape\") {\n      this.props.onClose();\n    }\n  }\n\n  onContainerClicked = e => {\n    if (this.props.closable && e.currentTarget === e.target) {\n      this.props.onClose();\n    }\n  };\n\n  render() {\n    return (\n      <div className={classNames(\"dialog-overlay\", this.props.className)}>\n        <div className=\"dialog\" onClick={this.onContainerClicked}>\n          <div className={`dialog__box ${this.props.wide ? \"dialog__wide\" : \"\"} `}>\n            <div\n              className={classNames(\n                \"dialog__box__contents\",\n                this.props.allowOverflow ? \"dialog__box__contents-overflow\" : null,\n                this.props.additionalClass\n              )}\n            >\n              {this.props.closable &&\n                this.props.onClose && (\n                  <WithHoverSound>\n                    <button className=\"dialog__box__contents__close\" onClick={() => this.props.onClose()}>\n                      <i>\n                        <FontAwesomeIcon icon={faTimes} />\n                      </i>\n                    </button>\n                  </WithHoverSound>\n                )}\n              {this.props.title && <div className=\"dialog__box__contents__title\">{this.props.title}</div>}\n              <div className=\"dialog__box__contents__body\">{this.props.children}</div>\n              <div className=\"dialog__box__contents__button-container\" />\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n","import { detectOS } from \"detect-browser\";\n\nexport function disableiOSZoom() {\n  if (detectOS(navigator.userAgent) !== \"iOS\") return;\n\n  let lastTouchAtMs = 0;\n\n  document.addEventListener(\"touchmove\", ev => {\n    if (ev.scale === 1) return;\n\n    ev.preventDefault();\n  });\n\n  document.addEventListener(\"touchend\", ev => {\n    const now = new Date().getTime();\n    const isDoubleTouch = now - lastTouchAtMs <= 300;\n    lastTouchAtMs = now;\n\n    if (isDoubleTouch) {\n      ev.preventDefault();\n    }\n  });\n}\n","import Store from \"./storage/store\";\nimport MediaSearchStore from \"./storage/media-search-store\";\n\nexport class App {\n  constructor() {\n    this.scene = null;\n    this.quality = \"low\";\n    this.store = new Store();\n    this.mediaSearchStore = new MediaSearchStore();\n  }\n\n  setQuality(quality) {\n    if (this.quality === quality) {\n      return false;\n    }\n\n    this.quality = quality;\n\n    if (this.scene) {\n      this.scene.dispatchEvent(new CustomEvent(\"quality-changed\", { detail: quality }));\n    }\n\n    return true;\n  }\n}\n","// Provides a global registry of running components\nexport function registerComponentInstance(component, name) {\n  window.APP.componentRegistry = window.APP.componentRegistry || {};\n  window.APP.componentRegistry[name] = window.APP.componentRegistry[name] || [];\n  window.APP.componentRegistry[name].push(component);\n}\n\nexport function deregisterComponentInstance(component, name) {\n  if (!window.APP.componentRegistry || !window.APP.componentRegistry[name]) return;\n  window.APP.componentRegistry[name].splice(window.APP.componentRegistry[name].indexOf(component), 1);\n}\n\nexport function getCurrentStreamer() {\n  if (!window.APP || !window.APP.componentRegistry || !window.APP.hubChannel || !window.APP.hubChannel.presence)\n    return null;\n  const playerInfos = window.APP.componentRegistry[\"player-info\"] || [];\n  const presences = window.APP.hubChannel.presence.state;\n\n  for (let i = 0; i < playerInfos.length; i++) {\n    const playerInfo = playerInfos[i];\n    const presence = presences[playerInfo.playerSessionId];\n\n    if (presence && presence.metas[0] && presence.metas[0].streaming) {\n      return playerInfo;\n    }\n  }\n\n  return null;\n}\n","import { SOUND_TOGGLE_MIC } from \"../systems/sound-effects-system\";\n\nconst bindAllEvents = function(elements, events, f) {\n  if (!elements || !elements.length) return;\n  for (const el of elements) {\n    events.length &&\n      events.forEach(e => {\n        el.addEventListener(e, f);\n      });\n  }\n};\nconst unbindAllEvents = function(elements, events, f) {\n  if (!elements || !elements.length) return;\n  for (const el of elements) {\n    events.length &&\n      events.forEach(e => {\n        el.removeEventListener(e, f);\n      });\n  }\n};\n\n/**\n * Toggles the microphone on the current network connection based on the given events.\n * @namespace network\n * @component mute-mic\n */\nAFRAME.registerComponent(\"mute-mic\", {\n  schema: {\n    eventSrc: { type: \"selectorAll\" },\n    toggleEvents: { type: \"array\" },\n    muteEvents: { type: \"array\" },\n    unmuteEvents: { type: \"array\" }\n  },\n  init: function() {\n    this.onToggle = this.onToggle.bind(this);\n    this.onMute = this.onMute.bind(this);\n    this.onUnmute = this.onUnmute.bind(this);\n  },\n\n  play: function() {\n    const { eventSrc, toggleEvents, muteEvents, unmuteEvents } = this.data;\n    bindAllEvents(eventSrc, toggleEvents, this.onToggle);\n    bindAllEvents(eventSrc, muteEvents, this.onMute);\n    bindAllEvents(eventSrc, unmuteEvents, this.onUnmute);\n  },\n\n  pause: function() {\n    const { eventSrc, toggleEvents, muteEvents, unmuteEvents } = this.data;\n    unbindAllEvents(eventSrc, toggleEvents, this.onToggle);\n    unbindAllEvents(eventSrc, muteEvents, this.onMute);\n    unbindAllEvents(eventSrc, unmuteEvents, this.onUnmute);\n  },\n\n  onToggle: function() {\n    if (!NAF.connection.adapter) return;\n    if (!this.el.sceneEl.is(\"entered\")) return;\n\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_TOGGLE_MIC);\n    if (this.el.is(\"muted\")) {\n      NAF.connection.adapter.enableMicrophone(true);\n      this.el.removeState(\"muted\");\n    } else {\n      NAF.connection.adapter.enableMicrophone(false);\n      this.el.addState(\"muted\");\n    }\n  },\n\n  onMute: function() {\n    if (!NAF.connection.adapter) return;\n    if (!this.el.is(\"muted\")) {\n      NAF.connection.adapter.enableMicrophone(false);\n      this.el.addState(\"muted\");\n    }\n  },\n\n  onUnmute: function() {\n    if (this.el.is(\"muted\")) {\n      NAF.connection.adapter.enableMicrophone(true);\n      this.el.removeState(\"muted\");\n    }\n  }\n});\n","import { SOUND_TOGGLE_FLYING } from \"../systems/sound-effects-system\";\n\nconst bindAllEvents = function(elements, events, f) {\n  if (!elements || !elements.length) return;\n  for (const el of elements) {\n    events.length &&\n      events.forEach(e => {\n        el.addEventListener(e, f);\n      });\n  }\n};\nconst unbindAllEvents = function(elements, events, f) {\n  if (!elements || !elements.length) return;\n  for (const el of elements) {\n    events.length &&\n      events.forEach(e => {\n        el.removeEventListener(e, f);\n      });\n  }\n};\n\n/**\n * Toggles flying.\n * @namespace network\n * @component toggle-flying\n */\nAFRAME.registerComponent(\"toggle-flying\", {\n  schema: {\n    eventSrc: { type: \"selectorAll\" },\n    toggleEvents: { type: \"array\" },\n    // flyingEvents: { type: \"array\" },\n  },\n  init: function() {\n    this.onToggle = this.onToggle.bind(this);\n    // this.onFlying = this.onFlying.bind(this);\n  },\n\n  play: function() {\n    const { eventSrc, toggleEvents } = this.data;\n    bindAllEvents(eventSrc, toggleEvents, this.onToggle);\n   // bindAllEvents(eventSrc, flyingEvents, this.onFlying);\n    \n  },\n\n  pause: function() {\n    const { eventSrc, toggleEvents } = this.data;\n    unbindAllEvents(eventSrc, toggleEvents, this.onToggle);\n    // unbindAllEvents(eventSrc, flyingEvents, this.onFlying);\n  },\n\n  onToggle: function() {\n    if (!this.el.sceneEl.is(\"entered\")) return;\n\n    // this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_TOGGLE_MIC);\n    if (this.el.is(\"flying\")) {\n      this.el.removeState(\"flying\");\n    } else {\n      this.el.addState(\"flying\");\n    }\n  },\n\n  // onFlying: function() {\n  //   if (!this.el.is(\"flying\")) {  \n  //     this.el.addState(\"flying\");\n  //   } else {\n  //     this.el.removeState(\"flying\");\n  //   }\n  // },\n});\n","import { SOUND_SPAWN_PEN } from \"../systems/sound-effects-system\";\n/**\n * HUD panel for muting, freezing, and other controls that don't necessarily have hardware buttons.\n * @namespace ui\n * @component in-world-hud\n */\nAFRAME.registerComponent(\"in-world-hud\", {\n  init() {\n    this.mic = this.el.querySelector(\".mic\");\n    this.spawn = this.el.querySelector(\".spawn\");\n    // this.pen = this.el.querySelector(\".penhud\");\n    this.cameraBtn = this.el.querySelector(\".camera-btn\");\n    this.inviteBtn = this.el.querySelector(\".invite-btn\");\n    this.background = this.el.querySelector(\".bg\");\n    this.flyBtn = this.el.querySelector(\".fly-btn\");\n\n    this.updateButtonStates = () => {\n      this.mic.setAttribute(\"mic-button\", \"active\", this.el.sceneEl.is(\"muted\"));\n      // this.pen.setAttribute(\"icon-button\", \"active\", this.el.sceneEl.is(\"pen\"));\n      this.cameraBtn.setAttribute(\"icon-button\", \"active\", this.el.sceneEl.is(\"camera\"));\n      this.flyBtn.setAttribute(\"icon-button\", \"active\", this.el.sceneEl.is(\"flying\"));\n\n      if (window.APP.hubChannel) {\n        this.spawn.setAttribute(\"icon-button\", \"disabled\", !window.APP.hubChannel.can(\"spawn_and_move_media\"));\n        // this.pen.setAttribute(\"icon-button\", \"disabled\", !window.APP.hubChannel.can(\"spawn_drawing\"));\n        this.cameraBtn.setAttribute(\"icon-button\", \"disabled\", !window.APP.hubChannel.can(\"spawn_camera\"));\n      }\n\n    };\n    this.updateButtonStates();\n\n    this.onStateChange = evt => {\n      if (!(evt.detail === \"muted\" || evt.detail === \"frozen\" || evt.detail === \"pen\" || evt.detail === \"camera\" || evt.detail === \"flying\"))\n        return;\n      this.updateButtonStates();\n    };\n\n    this.onMicClick = () => {\n      this.el.emit(\"action_mute\");\n    };\n\n    this.onSpawnClick = () => {\n      if (!window.APP.hubChannel.can(\"spawn_and_move_media\")) return;\n      this.el.emit(\"action_spawn\");\n    };\n\n    this.onPenClick = () => {\n      if (!window.APP.hubChannel.can(\"spawn_drawing\")) return;\n      this.el.emit(\"spawn_pen\");\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SPAWN_PEN);\n    };\n\n    this.onCameraClick = () => {\n      if (!window.APP.hubChannel.can(\"spawn_camera\")) return;\n      this.el.emit(\"action_toggle_camera\");\n    };\n\n    this.onFlyClick = () => {\n      this.el.emit(\"action_fly\");\n      const playerRig = document.querySelector(\"#player-rig\");\n      const enabled = playerRig.getAttribute(\"character-controller\", \"fly\").fly; \n      playerRig.setAttribute(\"character-controller\", \"fly\", !enabled);  \n    };\n\n    this.onInviteClick = () => {\n      this.el.emit(\"action_invite\");\n    };\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateChange);\n    this.el.sceneEl.systems.permissions.onPermissionsUpdated(this.updateButtonStates);\n\n    this.mic.object3D.addEventListener(\"interact\", this.onMicClick);\n    this.spawn.object3D.addEventListener(\"interact\", this.onSpawnClick);\n    // this.pen.object3D.addEventListener(\"interact\", this.onPenClick);\n    this.cameraBtn.object3D.addEventListener(\"interact\", this.onCameraClick);\n    this.flyBtn.object3D.addEventListener(\"interact\", this.onFlyClick);\n    this.inviteBtn.object3D.addEventListener(\"interact\", this.onInviteClick);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateChange);\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.updateButtonStates);\n\n    this.mic.object3D.removeEventListener(\"interact\", this.onMicClick);\n    this.spawn.object3D.removeEventListener(\"interact\", this.onSpawnClick);\n    // this.pen.object3D.removeEventListener(\"interact\", this.onPenClick);\n    this.cameraBtn.object3D.removeEventListener(\"interact\", this.onCameraClick);\n    this.flyBtn.object3D.removeEventListener(\"interact\", this.onFlyClick);\n    this.inviteBtn.object3D.removeEventListener(\"interact\", this.onInviteClick);\n  }\n});\n","import nipplejs from \"nipplejs\";\nimport styles from \"./virtual-gamepad-controls.css\";\n\n/**\n * Instantiates 2D virtual gamepads and emits associated events.\n * @namespace user-input\n * @component virtual-gamepad-controls\n */\nAFRAME.registerComponent(\"virtual-gamepad-controls\", {\n  schema: {},\n\n  init() {\n    this.onEnterVr = this.onEnterVr.bind(this);\n    this.onExitVr = this.onExitVr.bind(this);\n    this.onFirstInteraction = this.onFirstInteraction.bind(this);\n    this.onMoveJoystickChanged = this.onMoveJoystickChanged.bind(this);\n    this.onMoveJoystickEnd = this.onMoveJoystickEnd.bind(this);\n    this.onLookJoystickChanged = this.onLookJoystickChanged.bind(this);\n    this.onLookJoystickEnd = this.onLookJoystickEnd.bind(this);\n\n    this.mockJoystickContainer = document.createElement(\"div\");\n    this.mockJoystickContainer.classList.add(styles.mockJoystickContainer);\n    const leftMock = document.createElement(\"div\");\n    leftMock.classList.add(styles.mockJoystick);\n    const leftMockSmall = document.createElement(\"div\");\n    leftMockSmall.classList.add(styles.mockJoystick, styles.inner);\n    leftMock.appendChild(leftMockSmall);\n    this.mockJoystickContainer.appendChild(leftMock);\n    const rightMock = document.createElement(\"div\");\n    rightMock.classList.add(styles.mockJoystick);\n    const rightMockSmall = document.createElement(\"div\");\n    rightMockSmall.classList.add(styles.mockJoystick, styles.inner);\n    rightMock.appendChild(rightMockSmall);\n    this.mockJoystickContainer.appendChild(rightMock);\n    document.body.appendChild(this.mockJoystickContainer);\n\n    // Setup gamepad elements\n    const leftTouchZone = document.createElement(\"div\");\n    leftTouchZone.classList.add(styles.touchZone, styles.left);\n    document.body.appendChild(leftTouchZone);\n\n    this.leftTouchZone = leftTouchZone;\n\n    this.leftStick = nipplejs.create({\n      zone: this.leftTouchZone,\n      color: \"white\",\n      fadeTime: 0\n    });\n\n    this.leftStick.on(\"start\", this.onFirstInteraction);\n    this.leftStick.on(\"move\", this.onMoveJoystickChanged);\n    this.leftStick.on(\"end\", this.onMoveJoystickEnd);\n\n    const rightTouchZone = document.createElement(\"div\");\n    rightTouchZone.classList.add(styles.touchZone, styles.right);\n    document.body.appendChild(rightTouchZone);\n\n    this.rightTouchZone = rightTouchZone;\n\n    this.rightStick = nipplejs.create({\n      zone: this.rightTouchZone,\n      color: \"white\",\n      fadeTime: 0\n    });\n\n    this.rightStick.on(\"start\", this.onFirstInteraction);\n    this.rightStick.on(\"move\", this.onLookJoystickChanged);\n    this.rightStick.on(\"end\", this.onLookJoystickEnd);\n\n    this.inVr = false;\n    this.moving = false;\n    this.rotating = false;\n\n    this.moveEvent = {\n      axis: [0, 0]\n    };\n    this.rotateYEvent = {\n      value: 0\n    };\n    this.rotateXEvent = {\n      value: 0\n    };\n\n    this.el.sceneEl.addEventListener(\"enter-vr\", this.onEnterVr);\n    this.el.sceneEl.addEventListener(\"exit-vr\", this.onExitVr);\n  },\n\n  onFirstInteraction() {\n    this.leftStick.off(\"start\", this.onFirstInteraction);\n    this.rightStick.off(\"start\", this.onFirstInteraction);\n    document.body.removeChild(this.mockJoystickContainer);\n  },\n\n  onMoveJoystickChanged(event, joystick) {\n    const angle = joystick.angle.radian;\n    const force = joystick.force < 1 ? joystick.force : 1;\n    const moveStrength = 1.85;\n    const x = Math.cos(angle) * force * moveStrength;\n    const z = Math.sin(angle) * force * moveStrength;\n    this.moving = true;\n    this.moveEvent.axis[0] = x;\n    this.moveEvent.axis[1] = z;\n  },\n\n  onMoveJoystickEnd() {\n    this.moving = false;\n    this.moveEvent.axis[0] = 0;\n    this.moveEvent.axis[1] = 0;\n    this.el.sceneEl.emit(\"move\", this.moveEvent);\n  },\n\n  onLookJoystickChanged(event, joystick) {\n    // Set pitch and yaw angles on right stick move\n    const angle = joystick.angle.radian;\n    const force = joystick.force < 1 ? joystick.force : 1;\n    const turnStrength = 0.5;\n    this.rotating = true;\n    this.rotateYEvent.value = Math.cos(angle) * force * turnStrength;\n    this.rotateXEvent.value = Math.sin(angle) * force * turnStrength;\n  },\n\n  onLookJoystickEnd() {\n    this.rotating = false;\n    this.rotateYEvent.value = 0;\n    this.rotateXEvent.value = 0;\n    this.el.sceneEl.emit(\"rotateY\", this.rotateYEvent);\n    this.el.sceneEl.emit(\"rotateX\", this.rotateXEvent);\n  },\n\n  tick() {\n    if (!this.inVr) {\n      if (this.moving) {\n        this.el.sceneEl.emit(\"move\", this.moveEvent);\n      }\n\n      if (this.rotating) {\n        this.el.sceneEl.emit(\"rotateY\", this.rotateYEvent);\n        this.el.sceneEl.emit(\"rotateX\", this.rotateXEvent);\n      }\n    }\n  },\n\n  onEnterVr() {\n    // Hide the joystick controls\n    this.inVr = true;\n    this.leftTouchZone.style.display = \"none\";\n    this.rightTouchZone.style.display = \"none\";\n  },\n\n  onExitVr() {\n    // Show the joystick controls\n    this.inVr = false;\n    this.leftTouchZone.style.display = \"block\";\n    this.rightTouchZone.style.display = \"block\";\n  },\n\n  remove() {\n    this.el.sceneEl.removeEventListener(\"entervr\", this.onEnterVr);\n    this.el.sceneEl.removeEventListener(\"exitvr\", this.onExitVr);\n    document.body.removeChild(this.mockJoystickContainer);\n    document.body.removeChild(this.leftTouchZone);\n    document.body.removeChild(this.rightTouchZone);\n  }\n});\n","const { Vector3, Quaternion, Matrix4, Euler } = THREE;\n\nimport { AVATAR_TYPES } from \"../utils/avatar-utils\";\n\nfunction quaternionAlmostEquals(epsilon, u, v) {\n  // Note: q and -q represent same rotation\n  return (\n    (Math.abs(u.x - v.x) < epsilon &&\n      Math.abs(u.y - v.y) < epsilon &&\n      Math.abs(u.z - v.z) < epsilon &&\n      Math.abs(u.w - v.w) < epsilon) ||\n    (Math.abs(-u.x - v.x) < epsilon &&\n      Math.abs(-u.y - v.y) < epsilon &&\n      Math.abs(-u.z - v.z) < epsilon &&\n      Math.abs(-u.w - v.w) < epsilon)\n  );\n}\n\n/**\n * Provides access to the end effectors for IK.\n * @namespace avatar\n * @component ik-root\n */\nAFRAME.registerComponent(\"ik-root\", {\n  schema: {\n    camera: { type: \"string\", default: \".camera\" },\n    leftController: { type: \"string\", default: \".left-controller\" },\n    rightController: { type: \"string\", default: \".right-controller\" }\n  },\n  update(oldData) {\n    if (this.data.camera !== oldData.camera) {\n      this.camera = this.el.querySelector(this.data.camera);\n    }\n\n    if (this.data.leftController !== oldData.leftController) {\n      this.leftController = this.el.querySelector(this.data.leftController);\n    }\n\n    if (this.data.rightController !== oldData.rightController) {\n      this.rightController = this.el.querySelector(this.data.rightController);\n    }\n  }\n});\n\nfunction findIKRoot(entity) {\n  while (entity && !(entity.components && entity.components[\"ik-root\"])) {\n    entity = entity.parentNode;\n  }\n  return entity && entity.components[\"ik-root\"];\n}\n\nconst LEGACY_HAND_ROTATIONS = {\n  left: new Matrix4().makeRotationFromEuler(new Euler(-Math.PI / 2, Math.PI / 2, 0)),\n  right: new Matrix4().makeRotationFromEuler(new Euler(Math.PI / 2, Math.PI / 2, 0))\n};\n\nconst HAND_ROTATIONS = {\n  left: new Matrix4().makeRotationFromEuler(new Euler(-Math.PI / 2, Math.PI / 2, 0)),\n  right: new Matrix4().makeRotationFromEuler(new Euler(-Math.PI / 2, -Math.PI / 2, 0))\n};\n\n/**\n * Performs IK on a hip-rooted skeleton to align the hip, head and hands with camera and controller inputs.\n * @namespace avatar\n * @component ik-controller\n */\nAFRAME.registerComponent(\"ik-controller\", {\n  schema: {\n    leftEye: { type: \"string\", default: \"LeftEye\" },\n    rightEye: { type: \"string\", default: \"RightEye\" },\n    head: { type: \"string\", default: \"Head\" },\n    neck: { type: \"string\", default: \"Neck\" },\n    leftHand: { type: \"string\", default: \"LeftHand\" },\n    rightHand: { type: \"string\", default: \"RightHand\" },\n    chest: { type: \"string\", default: \"Spine\" },\n    hips: { type: \"string\", default: \"Hips\" },\n    rotationSpeed: { default: 5 },\n    alwaysUpdate: { type: \"boolean\", default: false }\n  },\n\n  init() {\n    this._runScheduledWork = this._runScheduledWork.bind(this);\n    this._updateIsInView = this._updateIsInView.bind(this);\n\n    this.flipY = new Matrix4().makeRotationY(Math.PI);\n\n    this.cameraForward = new Matrix4();\n    this.headTransform = new Matrix4();\n    this.hipsPosition = new Vector3();\n\n    this.invHipsToHeadVector = new Vector3();\n\n    this.middleEyeMatrix = new Matrix4();\n    this.middleEyePosition = new Vector3();\n    this.invMiddleEyeToHead = new Matrix4();\n\n    this.cameraYRotation = new Euler();\n    this.cameraYQuaternion = new Quaternion();\n\n    this.invHipsQuaternion = new Quaternion();\n    this.headQuaternion = new Quaternion();\n\n    this.rootToChest = new Matrix4();\n    this.invRootToChest = new Matrix4();\n\n    this.ikRoot = findIKRoot(this.el);\n\n    this.isInView = true;\n    this.hasConvergedHips = false;\n    this.lastCameraTransform = new THREE.Matrix4();\n    this.playerCamera = document.querySelector(\"#player-camera\").getObject3D(\"camera\");\n\n    this.el.sceneEl.systems[\"frame-scheduler\"].schedule(this._runScheduledWork, \"ik\");\n  },\n\n  remove() {\n    this.el.sceneEl.systems[\"frame-scheduler\"].unschedule(this._runScheduledWork, \"ik\");\n  },\n\n  update(oldData) {\n    if (this.data.leftEye !== oldData.leftEye) {\n      this.leftEye = this.el.object3D.getObjectByName(this.data.leftEye);\n    }\n\n    if (this.data.rightEye !== oldData.rightEye) {\n      this.rightEye = this.el.object3D.getObjectByName(this.data.rightEye);\n    }\n\n    if (this.data.head !== oldData.head) {\n      this.head = this.el.object3D.getObjectByName(this.data.head);\n    }\n\n    if (this.data.neck !== oldData.neck) {\n      this.neck = this.el.object3D.getObjectByName(this.data.neck);\n    }\n\n    if (this.data.leftHand !== oldData.leftHand) {\n      this.leftHand = this.el.object3D.getObjectByName(this.data.leftHand);\n    }\n\n    if (this.data.rightHand !== oldData.rightHand) {\n      this.rightHand = this.el.object3D.getObjectByName(this.data.rightHand);\n    }\n\n    if (this.data.chest !== oldData.chest) {\n      this.chest = this.el.object3D.getObjectByName(this.data.chest);\n    }\n\n    if (this.data.hips !== oldData.hips) {\n      this.hips = this.el.object3D.getObjectByName(this.data.hips);\n    }\n\n    // Set middleEye's position to be right in the middle of the left and right eyes.\n    this.middleEyePosition.addVectors(this.leftEye.position, this.rightEye.position);\n    this.middleEyePosition.divideScalar(2);\n    this.middleEyeMatrix.makeTranslation(this.middleEyePosition.x, this.middleEyePosition.y, this.middleEyePosition.z);\n    this.invMiddleEyeToHead = this.middleEyeMatrix.getInverse(this.middleEyeMatrix);\n\n    this.invHipsToHeadVector\n      .addVectors(this.chest.position, this.neck.position)\n      .add(this.head.position)\n      .negate();\n  },\n\n  tick(time, dt) {\n    if (!this.ikRoot) {\n      return;\n    }\n\n    const root = this.ikRoot.el.object3D;\n    const { camera, leftController, rightController } = this.ikRoot;\n\n    camera.object3D.updateMatrix();\n\n    const hasNewCameraTransform = !this.lastCameraTransform.equals(camera.object3D.matrix);\n\n    // Optimization: if the camera hasn't moved and the hips converged to the target orientation on a previous frame,\n    // then the avatar does not need any IK this frame.\n    //\n    // Update in-view avatars every frame, and update out-of-view avatars via frame scheduler.\n    if (\n      this.data.alwaysUpdate ||\n      this.forceIkUpdate ||\n      (this.isInView && (hasNewCameraTransform || !this.hasConvergedHips))\n    ) {\n      if (hasNewCameraTransform) {\n        this.lastCameraTransform.copy(camera.object3D.matrix);\n      }\n\n      const {\n        hips,\n        head,\n        neck,\n        chest,\n        cameraForward,\n        headTransform,\n        invMiddleEyeToHead,\n        invHipsToHeadVector,\n        flipY,\n        cameraYRotation,\n        cameraYQuaternion,\n        invHipsQuaternion,\n        rootToChest,\n        invRootToChest\n      } = this;\n\n      // Camera faces the -Z direction. Flip it along the Y axis so that it is +Z.\n      cameraForward.multiplyMatrices(camera.object3D.matrix, flipY);\n\n      // Compute the head position such that the hmd position would be in line with the middleEye\n      headTransform.multiplyMatrices(cameraForward, invMiddleEyeToHead);\n\n      // Then position the hips such that the head is aligned with headTransform\n      // (which positions middleEye in line with the hmd)\n      hips.position.setFromMatrixPosition(headTransform).add(invHipsToHeadVector);\n\n      // Animate the hip rotation to follow the Y rotation of the camera with some damping.\n      cameraYRotation.setFromRotationMatrix(cameraForward, \"YXZ\");\n      cameraYRotation.x = 0;\n      cameraYRotation.z = 0;\n      cameraYQuaternion.setFromEuler(cameraYRotation);\n      Quaternion.slerp(hips.quaternion, cameraYQuaternion, hips.quaternion, (this.data.rotationSpeed * dt) / 1000);\n\n      this.hasConvergedHips = quaternionAlmostEquals(0.0001, cameraYQuaternion, hips.quaternion);\n\n      // Take the head orientation computed from the hmd, remove the Y rotation already applied to it by the hips,\n      // and apply it to the head\n      invHipsQuaternion.copy(hips.quaternion).inverse();\n      head.quaternion.setFromRotationMatrix(headTransform).premultiply(invHipsQuaternion);\n\n      hips.updateMatrix();\n      rootToChest.multiplyMatrices(hips.matrix, chest.matrix);\n      invRootToChest.getInverse(rootToChest);\n\n      root.matrixNeedsUpdate = true;\n      neck.matrixNeedsUpdate = true;\n      head.matrixNeedsUpdate = true;\n      chest.matrixNeedsUpdate = true;\n    }\n\n    const { leftHand, rightHand } = this;\n\n    const handRotations =\n      this.ikRoot.el.components[\"player-info\"].data.avatarType === AVATAR_TYPES.LEGACY\n        ? LEGACY_HAND_ROTATIONS\n        : HAND_ROTATIONS;\n    if (leftHand) this.updateHand(handRotations.left, leftHand, leftController.object3D, true, this.isInView);\n    if (rightHand) this.updateHand(handRotations.right, rightHand, rightController.object3D, false, this.isInView);\n    this.forceIkUpdate = false;\n  },\n\n  updateHand(handRotation, handObject3D, controllerObject3D, isLeft, isInView) {\n    const handMatrix = handObject3D.matrix;\n\n    // TODO: This coupling with personal-space-invader is not ideal.\n    // There should be some intermediate thing managing multiple opinions about object visibility\n    const spaceInvader = handObject3D.el.components[\"personal-space-invader\"];\n    const handHiddenByPersonalSpace = spaceInvader && spaceInvader.invading;\n\n    handObject3D.visible = !handHiddenByPersonalSpace && controllerObject3D.visible;\n\n    // Optimization: skip IK update if not in view and not forced by frame scheduler\n    if (controllerObject3D.visible && (isInView || this.forceIkUpdate || this.data.alwaysUpdate)) {\n      handMatrix.multiplyMatrices(this.invRootToChest, controllerObject3D.matrix);\n\n      handMatrix.multiply(handRotation);\n\n      handObject3D.position.setFromMatrixPosition(handMatrix);\n      handObject3D.rotation.setFromRotationMatrix(handMatrix);\n      handObject3D.matrixNeedsUpdate = true;\n    }\n  },\n\n  _runScheduledWork() {\n    // Every scheduled run, we force an IK update on the next frame (so at most one avatar with forced IK per frame)\n    // and also update the this.isInView bit on the avatar which is used to determine if an IK update should be run\n    // every frame.\n    this.forceIkUpdate = true;\n\n    this._updateIsInView();\n  },\n\n  _updateIsInView: (function() {\n    const frustum = new THREE.Frustum();\n    const frustumMatrix = new THREE.Matrix4();\n    const cameraWorld = new THREE.Vector3();\n    const isInViewOfCamera = (screenCamera, pos) => {\n      frustumMatrix.multiplyMatrices(screenCamera.projectionMatrix, screenCamera.matrixWorldInverse);\n      frustum.setFromMatrix(frustumMatrix);\n      return frustum.containsPoint(pos);\n    };\n\n    return function() {\n      const camera = this.ikRoot.camera.object3D;\n      camera.getWorldPosition(cameraWorld);\n\n      this.isInView = isInViewOfCamera(this.playerCamera, cameraWorld);\n    };\n  })()\n});\n","import { paths } from \"../systems/userinput/paths\";\n\nconst POSES = {\n  open: \"open\",\n  point: \"point\",\n  fist: \"fist\",\n  hold: \"hold\",\n  thumbUp: \"thumbUp\",\n  thumbDown: \"thumbDown\",\n  indexDown: \"indexDown\",\n  pinch: \"pinch\",\n  mrpDown: \"mrpDown\"\n};\n\n/**\n * Emits events indicating that avatar hands should be posed differently.\n * @namespace user-input\n * @component hand-controls2\n */\nAFRAME.registerComponent(\"hand-controls2\", {\n  schema: { default: \"left\" },\n\n  init() {\n    this.pose = POSES.open;\n  },\n\n  poseForFingers(thumb, index, middleRingPinky) {\n    if (!thumb && !index && !middleRingPinky) {\n      return POSES.open;\n    } else if (thumb && index && middleRingPinky) {\n      return POSES.fist;\n    } else if (!thumb && index && middleRingPinky) {\n      return POSES.thumbUp;\n    } else if (!thumb && !index && middleRingPinky) {\n      return POSES.mrpDown;\n    } else if (!thumb && index && !middleRingPinky) {\n      return POSES.indexDown;\n    } else if (thumb && !index && !middleRingPinky) {\n      return POSES.thumbDown;\n    } else if (thumb && index && !middleRingPinky) {\n      return POSES.pinch;\n    } else if (thumb && !index && middleRingPinky) {\n      return POSES.point;\n    }\n\n    console.warn(`Did not find matching pose for thumb ${thumb}, index ${index}, middleRingPinky ${middleRingPinky}`);\n    return POSES.open;\n  },\n\n  tick() {\n    const hand = this.data;\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const subpath = hand === \"left\" ? paths.actions.leftHand : paths.actions.rightHand;\n    const thumb = userinput.get(subpath.thumb);\n    const index = userinput.get(subpath.index);\n    const middleRingPinky = userinput.get(subpath.middleRingPinky);\n    const pose = this.poseForFingers(thumb, index, middleRingPinky);\n    if (pose !== this.pose) {\n      this.el.emit(\"hand-pose\", { previous: this.pose, current: pose });\n      this.pose = pose;\n    }\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\nimport { SOUND_SNAP_ROTATE } from \"../systems/sound-effects-system\";\nconst CLAMP_VELOCITY = 0.01;\nconst MAX_DELTA = 0.2;\nconst EPS = 10e-6;\nconst MAX_WARNINGS = 10;\n\nconst NAV_ZONE = \"character\";\n\n/**\n * Avatar movement controller that listens to move, rotate and teleportation events and moves the avatar accordingly.\n * The controller accounts for playspace offset and orientation and depends on the nav mesh system for translation.\n * @namespace avatar\n * @component character-controller\n */\nAFRAME.registerComponent(\"character-controller\", {\n  schema: {\n    groundAcc: { default: 5.5 },\n    easing: { default: 10 },\n    pivot: { type: \"selector\" },\n    snapRotationDegrees: { default: THREE.Math.DEG2RAD * 45 },\n    rotationSpeed: { default: -3 },\n    fly: { default: false }\n  },\n\n  init: function() {\n    this.navGroup = null;\n    this.navNode = null;\n    this.velocity = new THREE.Vector3(0, 0, 0);\n    this.accelerationInput = new THREE.Vector3(0, 0, 0);\n    this.pendingSnapRotationMatrix = new THREE.Matrix4();\n    this.angularVelocity = 0; // Scalar value because we only allow rotation around Y\n    this._withinWarningLimit = true;\n    this._warningCount = 0;\n    this.setAccelerationInput = this.setAccelerationInput.bind(this);\n    this.snapRotateLeft = this.snapRotateLeft.bind(this);\n    this.snapRotateRight = this.snapRotateRight.bind(this);\n    this.setAngularVelocity = this.setAngularVelocity.bind(this);\n    this.el.sceneEl.addEventListener(\"nav-mesh-loaded\", () => {\n      this.navGroup = null;\n      this.navNode = null;\n    });\n  },\n\n  update: function() {\n    this.leftRotationMatrix = new THREE.Matrix4().makeRotationY(this.data.snapRotationDegrees);\n    this.rightRotationMatrix = new THREE.Matrix4().makeRotationY(-this.data.snapRotationDegrees);\n  },\n\n  play: function() {\n    const eventSrc = this.el.sceneEl;\n    eventSrc.addEventListener(\"move\", this.setAccelerationInput);\n    eventSrc.addEventListener(\"rotateY\", this.setAngularVelocity);\n  },\n\n  pause: function() {\n    const eventSrc = this.el.sceneEl;\n    eventSrc.removeEventListener(\"move\", this.setAccelerationInput);\n    eventSrc.removeEventListener(\"rotateY\", this.setAngularVelocity);\n    this.reset();\n  },\n\n  reset() {\n    this.accelerationInput.set(0, 0, 0);\n    this.velocity.set(0, 0, 0);\n    this.angularVelocity = 0;\n    this.pendingSnapRotationMatrix.identity();\n  },\n\n  setAccelerationInput: function(event) {\n    const axes = event.detail.axis;\n    this.accelerationInput.set(axes[0], 0, axes[1]);\n  },\n\n  setAngularVelocity: function(event) {\n    this.angularVelocity = event.detail.value;\n  },\n\n  snapRotateLeft: function() {\n    this.pendingSnapRotationMatrix.copy(this.leftRotationMatrix);\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SNAP_ROTATE);\n  },\n\n  snapRotateRight: function() {\n    this.pendingSnapRotationMatrix.copy(this.rightRotationMatrix);\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SNAP_ROTATE);\n  },\n\n  // We assume the rig is at the root, and its local position === its world position.\n  teleportTo: (function() {\n    const rig = new THREE.Vector3();\n    const head = new THREE.Vector3();\n    const deltaFromHeadToTargetForHead = new THREE.Vector3();\n    const targetForHead = new THREE.Vector3();\n    const targetForRig = new THREE.Vector3();\n    return function teleportTo(targetWorldPosition) {\n      const o = this.el.object3D;\n      o.getWorldPosition(rig);\n      this.data.pivot.object3D.getWorldPosition(head);\n      targetForHead.copy(targetWorldPosition);\n      targetForHead.y += this.data.pivot.object3D.position.y;\n      deltaFromHeadToTargetForHead.copy(targetForHead).sub(head);\n      targetForRig.copy(rig).add(deltaFromHeadToTargetForHead);\n\n      const pathfinder = this.el.sceneEl.systems.nav.pathfinder;\n      this.navGroup = pathfinder.getGroup(NAV_ZONE, targetForRig, true, true);\n      this.navNode = null;\n      this._setNavNode(targetForRig);\n      pathfinder.clampStep(rig, targetForRig, this.navNode, NAV_ZONE, this.navGroup, o.position);\n      o.matrixNeedsUpdate = true;\n    };\n  })(),\n\n  tick: (function() {\n    const move = new THREE.Matrix4();\n    const trans = new THREE.Matrix4();\n    const transInv = new THREE.Matrix4();\n    const pivotPos = new THREE.Vector3();\n    const rotationAxis = new THREE.Vector3(0, 1, 0);\n    const yawMatrix = new THREE.Matrix4();\n    const rotationMatrix = new THREE.Matrix4();\n    const rotationInvMatrix = new THREE.Matrix4();\n    const pivotRotationMatrix = new THREE.Matrix4();\n    const pivotRotationInvMatrix = new THREE.Matrix4();\n    const startPos = new THREE.Vector3();\n    const startScale = new THREE.Vector3();\n\n    return function(t, dt) {\n      if (!this.el.sceneEl.is(\"entered\")) return;\n      const deltaSeconds = dt / 1000;\n      const root = this.el.object3D;\n      const pivot = this.data.pivot.object3D;\n      const distance = this.data.groundAcc * deltaSeconds;\n\n      const userinput = AFRAME.scenes[0].systems.userinput;\n      const userinputAngularVelocity = userinput.get(paths.actions.angularVelocity);\n      if (userinputAngularVelocity !== null && userinputAngularVelocity !== undefined) {\n        this.angularVelocity = userinputAngularVelocity;\n      }\n      const rotationDelta = this.data.rotationSpeed * this.angularVelocity * deltaSeconds;\n\n      pivot.updateMatrices();\n      root.updateMatrices();\n\n      startScale.copy(root.scale);\n      startPos.copy(root.position);\n\n      if (userinput.get(paths.actions.snapRotateLeft)) {\n        this.snapRotateLeft();\n      }\n      if (userinput.get(paths.actions.snapRotateRight)) {\n        this.snapRotateRight();\n      }\n      const acc = userinput.get(paths.actions.characterAcceleration);\n      if (acc) {\n        this.accelerationInput.set(\n          this.accelerationInput.x + acc[0],\n          this.accelerationInput.y + 0,\n          this.accelerationInput.z + acc[1]\n        );\n      }\n\n      pivotPos.copy(pivot.position);\n      pivotPos.applyMatrix4(root.matrix);\n      trans.setPosition(pivotPos);\n      transInv.makeTranslation(-pivotPos.x, -pivotPos.y, -pivotPos.z);\n      rotationMatrix.makeRotationAxis(rotationAxis, root.rotation.y);\n      rotationInvMatrix.makeRotationAxis(rotationAxis, -root.rotation.y);\n      pivotRotationMatrix.makeRotationAxis(rotationAxis, pivot.rotation.y);\n      pivotRotationInvMatrix.makeRotationAxis(rotationAxis, -pivot.rotation.y);\n      this.updateVelocity(deltaSeconds, pivot);\n      this.accelerationInput.set(0, 0, 0);\n\n      const boost = userinput.get(paths.actions.boost) ? 2 : 1;\n      move.makeTranslation(\n        this.velocity.x * distance * boost,\n        this.velocity.y * distance * boost,\n        this.velocity.z * distance * boost\n      );\n      yawMatrix.makeRotationAxis(rotationAxis, rotationDelta);\n\n      // Translate to middle of playspace (player rig)\n      root.matrix.premultiply(transInv);\n      // Zero playspace (player rig) rotation\n      root.matrix.premultiply(rotationInvMatrix);\n      // Zero pivot (camera/head) rotation\n      root.matrix.premultiply(pivotRotationInvMatrix);\n      // Apply joystick translation\n      root.matrix.premultiply(move);\n      // Apply joystick yaw rotation\n      root.matrix.premultiply(yawMatrix);\n      // Apply snap rotation if necessary\n      root.matrix.premultiply(this.pendingSnapRotationMatrix);\n      // Reapply pivot (camera/head) rotation\n      root.matrix.premultiply(pivotRotationMatrix);\n      // Reapply playspace (player rig) rotation\n      root.matrix.premultiply(rotationMatrix);\n      // Reapply playspace (player rig) translation\n      root.matrix.premultiply(trans);\n      // update pos/rot/scale\n      root.matrix.decompose(root.position, root.quaternion, root.scale);\n\n      // TODO: the above matrix trnsfomraitons introduce some floating point errors in scale, this reverts them to\n      // avoid spamming network with fake scale updates\n      root.scale.copy(startScale);\n\n      this.pendingSnapRotationMatrix.identity(); // Revert to identity\n\n      if (this.velocity.lengthSq() > EPS && !this.data.fly) {\n        this.setPositionOnNavMesh(startPos, root.position, root);\n      }\n\n      root.matrixNeedsUpdate = true;\n    };\n  })(),\n\n  _warnWithWarningLimit: function(msg) {\n    if (!this._withinWarningLimit) return;\n    this._warningCount++;\n    if (this._warningCount > MAX_WARNINGS) {\n      this._withinWarningLimit = false;\n      msg = \"Warning count exceeded. Will not log further warnings\";\n    }\n    console.warn(\"character-controller\", msg);\n  },\n\n  _setNavNode: function(pos) {\n    if (this.navNode !== null) return;\n    const { pathfinder } = this.el.sceneEl.systems.nav;\n    this.navNode =\n      pathfinder.getClosestNode(pos, NAV_ZONE, this.navGroup, true) ||\n      pathfinder.getClosestNode(pos, NAV_ZONE, this.navGroup);\n  },\n\n  setPositionOnNavMesh: function(start, end, object3D) {\n    const { pathfinder } = this.el.sceneEl.systems.nav;\n    if (!(NAV_ZONE in pathfinder.zones)) return;\n    if (this.navGroup === null) {\n      this.navGroup = pathfinder.getGroup(NAV_ZONE, end, true, true);\n    }\n    this._setNavNode(end);\n    this.navNode = pathfinder.clampStep(start, end, this.navNode, NAV_ZONE, this.navGroup, object3D.position);\n    object3D.matrixNeedsUpdate = true;\n  },\n\n  updateVelocity: function(dt, pivot) {\n    const data = this.data;\n    const velocity = this.velocity;\n\n    // If FPS too low, reset velocity.\n    if (dt > MAX_DELTA) {\n      velocity.x = 0;\n      velocity.y = 0;\n      velocity.z = 0;\n      return;\n    }\n\n    // Decay velocity.\n    if (velocity.x !== 0) {\n      velocity.x -= velocity.x * data.easing * dt;\n    }\n    if (velocity.y !== 0) {\n      velocity.y -= velocity.y * data.easing * dt;\n    }\n    if (velocity.z !== 0) {\n      velocity.z -= velocity.z * data.easing * dt;\n    }\n\n    const dvx = data.groundAcc * dt * this.accelerationInput.x;\n    const dvz = data.groundAcc * dt * -this.accelerationInput.z;\n    velocity.x += dvx;\n\n    if (this.data.fly) {\n      velocity.y += dvz * -Math.sin(pivot.rotation.x);\n      velocity.z += dvz * Math.cos(pivot.rotation.x);\n    } else {\n      velocity.z += dvz;\n    }\n\n    const decay = 0.7;\n    this.accelerationInput.x = this.accelerationInput.x * decay;\n    this.accelerationInput.z = this.accelerationInput.z * decay;\n\n    if (Math.abs(velocity.x) < CLAMP_VELOCITY) {\n      velocity.x = 0;\n    }\n    if (Math.abs(velocity.y) < CLAMP_VELOCITY) {\n      velocity.y = 0;\n    }\n    if (Math.abs(velocity.z) < CLAMP_VELOCITY) {\n      velocity.z = 0;\n    }\n  }\n});\n","import { showHoverEffect } from \"../utils/permissions-utils\";\n\n/**\n * Applies effects to a hoverer based on hover state.\n * @namespace interactables\n * @component hover-visuals\n */\nAFRAME.registerComponent(\"hover-visuals\", {\n  schema: {\n    hand: { type: \"string\" }\n  },\n  init() {\n    // uniforms are set from the component responsible for loading the mesh.\n    this.handleLeftVisuals = this.handleLeftVisuals.bind(this);\n    this.handleRightVisuals = this.handleRightVisuals.bind(this);\n    this.hadLeftVisualLastFrame = false;\n    this.hadRightVisualLastFrame = false;\n    this.uniforms = null;\n  },\n  remove() {\n    this.uniforms = null;\n  },\n  tick() {\n    if (!this.uniforms || !this.uniforms.length) return;\n\n    // Push down loops to assist JIT:\n    if (this.data.hand === \"left\") {\n      this.handleLeftVisuals();\n    } else {\n      this.handleRightVisuals();\n    }\n  },\n\n  handleLeftVisuals: function() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const interactingElement = interaction.state.leftHand.held || interaction.state.leftHand.hovered;\n    const hideVisual = !interactingElement || !showHoverEffect(interactingElement);\n\n    // Last frame, we didn't have a visual so no need to update uniforms.\n    if (hideVisual && !this.hadLeftVisualLastFrame) return;\n    this.hadLeftVisualLastFrame = !hideVisual;\n\n    const elements = this.el.object3D.matrixWorld.elements;\n\n    for (let i = 0, l = this.uniforms.length; i < l; i++) {\n      const uniform = this.uniforms[i];\n      uniform.hubs_HighlightInteractorOne.value = !hideVisual;\n      uniform.hubs_InteractorOnePos.value[0] = elements[12];\n      uniform.hubs_InteractorOnePos.value[1] = elements[13];\n      uniform.hubs_InteractorOnePos.value[2] = elements[14];\n    }\n  },\n\n  handleRightVisuals: function() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n\n    const interactingElement = interaction.state.rightHand.held || interaction.state.rightHand.hovered;\n    const hideVisual = !interactingElement || !showHoverEffect(interactingElement);\n\n    // Last frame, we didn't have a visual so no need to update uniforms.\n    if (hideVisual && !this.hadRightVisualLastFrame) return;\n    this.hadRightVisualLastFrame = !hideVisual;\n\n    const elements = this.el.object3D.matrixWorld.elements;\n\n    for (let i = 0, l = this.uniforms.length; i < l; i++) {\n      const uniform = this.uniforms[i];\n      uniform.hubs_HighlightInteractorTwo.value = !hideVisual;\n      uniform.hubs_InteractorTwoPos.value[0] = elements[12];\n      uniform.hubs_InteractorTwoPos.value[1] = elements[13];\n      uniform.hubs_InteractorTwoPos.value[2] = elements[14];\n    }\n  }\n});\n","import { injectCustomShaderChunks } from \"../utils/media-utils\";\nimport { AVATAR_TYPES } from \"../utils/avatar-utils\";\nimport { registerComponentInstance } from \"../utils/component-utils\";\nimport { deregisterComponentInstance } from \"../utils/component-utils\";\n\nfunction ensureAvatarNodes(json) {\n  const { nodes } = json;\n  if (!nodes.some(node => node.name === \"Head\")) {\n    // If the avatar model doesn't have a Head node. The user has probably chosen a custom GLB.\n    // So, we need to construct a suitable hierarchy for avatar functionality to work.\n    // We re-parent the original root node to the Head node and set the scene root to a new AvatarRoot.\n\n    // Note: We assume that the first node in the primary scene is the one we care about.\n    const originalRoot = json.scenes[json.scene].nodes[0];\n    nodes.push({ name: \"LeftEye\", extensions: { MOZ_hubs_components: {} } });\n    nodes.push({ name: \"RightEye\", extensions: { MOZ_hubs_components: {} } });\n    nodes.push({\n      name: \"Head\",\n      children: [originalRoot, nodes.length - 1, nodes.length - 2],\n      extensions: { MOZ_hubs_components: { \"scale-audio-feedback\": \"\" } }\n    });\n    nodes.push({ name: \"Neck\", children: [nodes.length - 1] });\n    nodes.push({ name: \"Spine\", children: [nodes.length - 1] });\n    nodes.push({ name: \"Hips\", children: [nodes.length - 1] });\n    nodes.push({ name: \"AvatarRoot\", children: [nodes.length - 1] });\n    json.scenes[json.scene].nodes[0] = nodes.length - 1;\n  }\n  return json;\n}\n\n/**\n * Sets player info state, including avatar choice and display name.\n * @namespace avatar\n * @component player-info\n */\nAFRAME.registerComponent(\"player-info\", {\n  schema: {\n    avatarSrc: { type: \"string\" },\n    avatarType: { type: \"string\", default: AVATAR_TYPES.LEGACY }\n  },\n  init() {\n    this.displayName = null;\n    this.communityIdentifier = null;\n    this.isOwner = false;\n    this.isRecording = false;\n    this.applyProperties = this.applyProperties.bind(this);\n    this.updateDisplayName = this.updateDisplayName.bind(this);\n    this.applyDisplayName = this.applyDisplayName.bind(this);\n    this.handleModelError = this.handleModelError.bind(this);\n\n    this.isLocalPlayerInfo = this.el.id === \"player-rig\";\n    this.playerSessionId = null;\n\n    if (!this.isLocalPlayerInfo) {\n      NAF.utils.getNetworkedEntity(this.el).then(networkedEntity => {\n        this.playerSessionId = NAF.utils.getCreator(networkedEntity);\n        const playerPresence = window.APP.hubChannel.presence.state[this.playerSessionId];\n        if (playerPresence) {\n          this.updateDisplayNameFromPresenceMeta(playerPresence.metas[0]);\n        }\n      });\n    }\n    registerComponentInstance(this, \"player-info\");\n  },\n  remove() {\n    deregisterComponentInstance(this, \"player-info\");\n  },\n  play() {\n    this.el.addEventListener(\"model-loaded\", this.applyProperties);\n    this.el.sceneEl.addEventListener(\"presence_updated\", this.updateDisplayName);\n    if (this.isLocalPlayerInfo) {\n      this.el.querySelector(\".model\").addEventListener(\"model-error\", this.handleModelError);\n    }\n  },\n  pause() {\n    this.el.removeEventListener(\"model-loaded\", this.applyProperties);\n    this.el.sceneEl.removeEventListener(\"presence_updated\", this.updateDisplayName);\n    if (this.isLocalPlayerInfo) {\n      this.el.querySelector(\".model\").removeEventListener(\"model-error\", this.handleModelError);\n    }\n  },\n  update() {\n    this.applyProperties();\n  },\n  updateDisplayName(e) {\n    if (!this.playerSessionId && this.isLocalPlayerInfo) {\n      this.playerSessionId = NAF.clientId;\n    }\n    if (!this.playerSessionId) return;\n    if (this.playerSessionId !== e.detail.sessionId) return;\n\n    this.updateDisplayNameFromPresenceMeta(e.detail);\n  },\n  updateDisplayNameFromPresenceMeta(presenceMeta) {\n    this.displayName = presenceMeta.profile.displayName;\n    this.communityIdentifier = presenceMeta.profile.communityIdentifier;\n    this.isRecording = !!(presenceMeta.streaming || presenceMeta.recording);\n    this.isOwner = !!(presenceMeta.roles && presenceMeta.roles.owner);\n    this.applyDisplayName();\n  },\n  applyDisplayName() {\n    const nametagEl = this.el.querySelector(\".nametag\");\n    if (this.displayName && nametagEl) {\n      nametagEl.setAttribute(\"text\", { value: this.displayName });\n    }\n    const communityIdentifierEl = this.el.querySelector(\".communityIdentifier\");\n    if (communityIdentifierEl) {\n      if (this.communityIdentifier) {\n        communityIdentifierEl.setAttribute(\"text\", { value: this.communityIdentifier });\n      }\n    }\n\n    // Used to enable Megaphone mode, where rolloff is significantly less than the normal 2.0\n    const headEl = this.el.querySelector(\".head\");\n    if (headEl) {\n      if (this.isOwner) {\n        headEl.setAttribute(\"networked-audio-source\", { rolloffFactor: 0.0 }); // As though right on top of the admin.  \n        // Other options include \n        // distanceModel: \"inverse\"\n        // maxDistance: 10000\n        // positional: true\n        // refDistance: 1\n        // rolloffFactor: 0\n      }\n    }\n\n    const recordingBadgeEl = this.el.querySelector(\".recordingBadge\");\n    if (recordingBadgeEl) {\n      recordingBadgeEl.object3D.visible = this.isRecording;\n    }\n\n    const modBadgeEl = this.el.querySelector(\".modBadge\");\n    if (modBadgeEl) {\n      modBadgeEl.object3D.visible = !this.isRecording && this.isOwner;\n    }\n  },\n  applyProperties() {\n    this.applyDisplayName();\n\n    const modelEl = this.el.querySelector(\".model\");\n    if (this.data.avatarSrc && modelEl) {\n      modelEl.components[\"gltf-model-plus\"].jsonPreprocessor = ensureAvatarNodes;\n      modelEl.setAttribute(\"gltf-model-plus\", \"src\", this.data.avatarSrc);\n    }\n\n    const uniforms = injectCustomShaderChunks(this.el.object3D);\n    this.el.querySelectorAll(\"[hover-visuals]\").forEach(el => {\n      el.components[\"hover-visuals\"].uniforms = uniforms;\n    });\n  },\n  handleModelError() {\n    window.APP.store.resetToRandomLegacyAvatar();\n  }\n});\n","import { findAncestorWithComponent } from \"../utils/scene-graph\";\n\nconst POSES = {\n  open: \"allOpen\",\n  thumbDown: \"thumbDown\",\n  indexDown: \"indexDown\",\n  mrpDown: \"mrpDown\",\n  thumbUp: \"thumbsUp\",\n  point: \"point\",\n  fist: \"allGrip\",\n  pinch: \"pinch\"\n};\n\nconst NETWORK_POSES = [\"allOpen\", \"thumbDown\", \"indexDown\", \"mrpDown\", \"thumbsUp\", \"point\", \"allGrip\", \"pinch\"];\n\n/**\n * Animates between poses based on networked pose state using an animation mixer.\n * @namespace avatar\n * @component hand-pose\n */\nAFRAME.registerComponent(\"hand-pose\", {\n  multiple: true,\n\n  init() {\n    this.pose = 0;\n    this.animatePose = this.animatePose.bind(this);\n    const mixerEl = findAncestorWithComponent(this.el, \"animation-mixer\");\n    const suffix = this.id == \"left\" ? \"_L\" : \"_R\";\n    this.mixer = mixerEl && mixerEl.components[\"animation-mixer\"].mixer;\n    if (!this.mixer || !this.mixer.clipAction(POSES.open + suffix)) {\n      console.warn(\"Avatar does not an 'allOpen' animation, disabling hand animations\");\n      this.el.removeAttribute(\"hand-pose\");\n      return;\n    }\n    this.from = this.to = this.mixer.clipAction(POSES.open + suffix);\n    this.from.play();\n    this.networkField = `${this.id}_hand_pose`;\n\n    const getNetworkedAvatar = el => {\n      if (!el) {\n        window.setTimeout(() => {\n          getNetworkedAvatar(this.el);\n        }, 1000);\n        return;\n      }\n      const networkedAvatar = el.components && el.components[\"networked-avatar\"];\n      if (networkedAvatar) {\n        return networkedAvatar;\n      }\n      return getNetworkedAvatar(el.parentEl);\n    };\n    this.networkedAvatar = getNetworkedAvatar(this.el);\n  },\n\n  tick() {\n    if (\n      !this.networkedAvatar ||\n      !this.networkedAvatar.data ||\n      this.networkedAvatar.data[this.networkField] === this.pose\n    ) {\n      return;\n    }\n\n    this.animatePose(NETWORK_POSES[this.pose], NETWORK_POSES[this.networkedAvatar.data[this.networkField]]);\n    this.pose = this.networkedAvatar.data[this.networkField];\n  },\n\n  animatePose(prev, curr) {\n    this.from.stop();\n    this.to.stop();\n\n    const duration = 0.065;\n    const suffix = this.id == \"left\" ? \"_L\" : \"_R\";\n    this.from = this.mixer.clipAction(prev + suffix);\n    this.to = this.mixer.clipAction(curr + suffix);\n\n    this.from.fadeOut(duration);\n    this.to.fadeIn(duration);\n    this.to.play();\n    this.from.play();\n\n    this.mixer.update(0.001);\n  }\n});\n\n/**\n * Sets the networked hand pose state based on hand-pose events.\n * @namespace avatar\n * @component hand-pose-controller\n */\nAFRAME.registerComponent(\"hand-pose-controller\", {\n  multiple: true,\n  schema: {\n    eventSrc: { type: \"selector\" },\n    networkedAvatar: { type: \"selector\" }\n  },\n  init: function() {\n    this.setHandPose = this.setHandPose.bind(this);\n  },\n\n  play: function() {\n    this.data.eventSrc.addEventListener(\"hand-pose\", this.setHandPose);\n  },\n\n  pause: function() {\n    this.data.eventSrc.removeEventListener(\"hand-pose\", this.setHandPose);\n  },\n\n  setHandPose: function(evt) {\n    this.data.networkedAvatar.setAttribute(\n      \"networked-avatar\",\n      `${this.id}_hand_pose`,\n      NETWORK_POSES.indexOf(POSES[evt.detail.current])\n    );\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\nimport { SOUND_FREEZE, SOUND_THAW } from \"../systems/sound-effects-system\";\n\n/**\n * Toggles freezing of network traffic on the given event.\n * @namespace network\n * @component freeze-controller\n */\nAFRAME.registerComponent(\"freeze-controller\", {\n  schema: {\n    toggleEvent: { type: \"string\" }\n  },\n\n  init: function() {\n    this.onToggle = this.onToggle.bind(this);\n  },\n\n  play: function() {\n    this.el.addEventListener(this.data.toggleEvent, this.onToggle);\n  },\n\n  pause: function() {\n    this.el.removeEventListener(this.data.toggleEvent, this.onToggle);\n  },\n\n  tick: function() {\n    const scene = this.el.sceneEl;\n    if (!scene.is(\"entered\")) return;\n\n    const userinput = scene.systems.userinput;\n    const ensureFrozen = userinput.get(paths.actions.ensureFrozen);\n    const thaw = userinput.get(paths.actions.thaw);\n    const toggleFreeze = userinput.get(paths.actions.toggleFreeze);\n\n    const toggleFreezeDueToInput =\n      (this.el.is(\"frozen\") && thaw) || (!this.el.is(\"frozen\") && ensureFrozen) || toggleFreeze;\n\n    if (toggleFreezeDueToInput) {\n      this.onToggle();\n    }\n  },\n\n  onToggle: function() {\n    window.APP.store.update({ activity: { hasFoundFreeze: true } });\n    if (!NAF.connection.adapter) return;\n    NAF.connection.adapter.toggleFreeze();\n    if (NAF.connection.adapter.frozen) {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_FREEZE);\n      this.el.addState(\"frozen\");\n    } else {\n      this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_THAW);\n      this.el.removeState(\"frozen\");\n    }\n  }\n});\n","import { getLastWorldPosition } from \"../utils/three-utils\";\n\nconst isMobile = AFRAME.utils.device.isMobile();\n\n/**\n * Toggles the visibility of this entity when the scene is frozen.\n * @namespace ui\n * @component visibility-while-frozen\n */\nAFRAME.registerComponent(\"visibility-while-frozen\", {\n  schema: {\n    withinDistance: { type: \"number\" },\n    visible: { type: \"boolean\", default: true },\n    requireHoverOnNonMobile: { type: \"boolean\", default: true },\n    withPermission: { type: \"string\" }\n  },\n\n  init() {\n    this.updateVisibility = this.updateVisibility.bind(this);\n    this.camWorldPos = new THREE.Vector3();\n    this.objWorldPos = new THREE.Vector3();\n    this.cam = this.el.sceneEl.camera.el.object3D;\n\n    let hoverableSearch = this.el;\n\n    while (hoverableSearch !== document) {\n      if (hoverableSearch.getAttribute(\"is-remote-hover-target\") !== null) {\n        this.hoverable = hoverableSearch;\n        break;\n      }\n\n      hoverableSearch = hoverableSearch.parentNode;\n    }\n    if (!this.hoverable && this.data.requireHoverOnNonMobile) {\n      console.error(\"Didn't find a remote hover target.\");\n    }\n\n    this.onStateChange = evt => {\n      if (!evt.detail === \"frozen\") return;\n      this.updateVisibility();\n    };\n    this.updateVisibility();\n  },\n\n  tick() {\n    const isFrozen = this.el.sceneEl.is(\"frozen\");\n    const isVisible = this.el.object3D.visible;\n    const shouldNotBeVisible = isFrozen === !this.data.visible;\n    if (!isVisible && shouldNotBeVisible) return;\n\n    this.updateVisibility();\n  },\n\n  updateVisibility() {\n    const isFrozen = this.el.sceneEl.is(\"frozen\");\n\n    let isWithinDistance = true;\n    const isVisible = this.el.object3D.visible;\n\n    if (this.data.withinDistance) {\n      if (!isVisible) {\n        // Edge case, if the object is not visible force a matrix update\n        // since the main matrix update loop will not do it.\n        this.el.object3D.updateMatrices(true, true);\n      }\n\n      getLastWorldPosition(this.cam, this.camWorldPos);\n      this.objWorldPos.copy(this.el.object3D.position);\n      this.el.object3D.localToWorld(this.objWorldPos);\n\n      isWithinDistance =\n        this.camWorldPos.distanceToSquared(this.objWorldPos) < this.data.withinDistance * this.data.withinDistance;\n    }\n\n    const isTransforming = AFRAME.scenes[0].systems[\"transform-selected-object\"].transforming;\n\n    const allowed = !this.data.withPermission || window.APP.hubChannel.canOrWillIfCreator(this.data.withPermission);\n\n    let shouldBeVisible =\n      allowed &&\n      ((isFrozen && this.data.visible) || (!isFrozen && !this.data.visible)) &&\n      isWithinDistance &&\n      !isTransforming;\n\n    if (this.data.requireHoverOnNonMobile && !isMobile) {\n      shouldBeVisible =\n        shouldBeVisible &&\n        ((this.hoverable && AFRAME.scenes[0].systems.interaction.state.rightRemote.hovered === this.hoverable) ||\n          isVisible);\n    }\n\n    if (isVisible !== shouldBeVisible) {\n      this.el.setAttribute(\"visible\", shouldBeVisible);\n    }\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateChange);\n\n    if (this.hoverable) {\n      this.hoverable.object3D.addEventListener(\"hovered\", this.updateVisibility);\n      this.hoverable.object3D.addEventListener(\"unhovered\", this.updateVisibility);\n    }\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateChange);\n\n    if (this.hoverable) {\n      this.hoverable.object3D.addEventListener(\"hovered\", this.updateVisibility);\n      this.hoverable.object3D.addEventListener(\"unhovered\", this.updateVisibility);\n    }\n  }\n});\n\n/**\n * Toggles the interactivity of a UI entity while the scene is frozen.\n * @namespace ui\n * @component ui-class-while-frozen\n */\nAFRAME.registerComponent(\"ui-class-while-frozen\", {\n  init() {\n    this.onStateChange = evt => {\n      if (!evt.detail === \"frozen\") return;\n      this.el.classList.toggle(\"ui\", this.el.sceneEl.is(\"frozen\"));\n    };\n    this.el.classList.toggle(\"ui\", this.el.sceneEl.is(\"frozen\"));\n  },\n\n  play() {\n    this.el.sceneEl.addEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this.onStateChange);\n  },\n\n  pause() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this.onStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this.onStateChange);\n  }\n});\n","import \"./stats-plus.css\";\nimport qsTruthy from \"../utils/qs_truthy\";\n\n// Adapted from https://github.com/aframevr/aframe/blob/master/src/components/scene/stats.js\n\nfunction createStats(scene) {\n  const threeStats = new window.threeStats(scene.renderer);\n  const aframeStats = new window.aframeStats(scene);\n  const plugins = scene.isMobile ? [] : [threeStats, aframeStats];\n  return new window.rStats({\n    css: [], // Our stylesheet is injected from AFrame.\n    values: {\n      fps: { caption: \"fps\", below: 30 },\n      batchdraws: { caption: \"Draws\" },\n      batchinstances: { caption: \"Instances\" },\n      batchatlassize: { caption: \"Atlas Size\" }\n    },\n    groups: [\n      { caption: \"Framerate\", values: [\"fps\", \"raf\", \"physics\"] },\n      { caption: \"Batching\", values: [\"batchdraws\", \"batchinstances\", \"batchatlassize\"] }\n    ],\n    plugins: plugins\n  });\n}\n\nconst HIDDEN_CLASS = \"a-hidden\";\n\nAFRAME.registerComponent(\"stats-plus\", {\n  // Whether or not the stats panel is expanded.\n  // Shows FPS counter when collapsed.\n  schema: { default: false },\n  init() {\n    this.onExpand = this.onExpand.bind(this);\n    this.onCollapse = this.onCollapse.bind(this);\n    this.onEnterVr = this.onEnterVr.bind(this);\n    this.onExitVr = this.onExitVr.bind(this);\n\n    const scene = this.el.sceneEl;\n    this.stats = createStats(scene);\n    this.statsEl = document.querySelector(\".rs-base\");\n\n    // Add header to stats panel so we can collapse it\n    const statsHeaderEl = document.createElement(\"div\");\n    statsHeaderEl.classList.add(\"rs-header\");\n\n    const statsTitleEl = document.createElement(\"h1\");\n    statsTitleEl.innerHTML = \"Stats\";\n    statsHeaderEl.appendChild(statsTitleEl);\n\n    const collapseEl = document.createElement(\"div\");\n    collapseEl.classList.add(\"rs-collapse-btn\");\n    collapseEl.innerHTML = \"X\";\n    collapseEl.addEventListener(\"click\", this.onCollapse);\n    statsHeaderEl.appendChild(collapseEl);\n\n    this.statsEl.insertBefore(statsHeaderEl, this.statsEl.firstChild);\n\n    // Add fps counter to the page\n    this.fpsEl = document.createElement(\"div\");\n    this.fpsEl.addEventListener(\"click\", this.onExpand);\n    this.fpsEl.classList.add(\"rs-fps-counter\");\n    document.body.appendChild(this.fpsEl);\n    this.lastFpsUpdate = performance.now();\n    this.lastFps = 0;\n    this.frameCount = 0;\n    this.inVR = scene.is(\"vr-mode\");\n\n    if (scene.isMobile) {\n      this.statsEl.classList.add(\"rs-mobile\");\n      this.fpsEl.classList.add(\"rs-mobile\");\n    }\n\n    scene.addEventListener(\"enter-vr\", this.onEnterVr);\n    scene.addEventListener(\"exit-vr\", this.onExitVr);\n\n    this.vrStatsEnabled = qsTruthy(\"vrstats\");\n    if (this.vrStatsEnabled) {\n      this.initVRStats();\n    }\n    this.lastUpdate = 0;\n  },\n  initVRStats() {\n    this.vrPanel = document.createElement(\"a-entity\");\n    this.vrPanel.setAttribute(\"text\", { width: 0.5, whiteSpace: \"pre\", value: \"_\", baseline: \"bottom\" });\n    this.vrPanel.addEventListener(\n      \"loaded\",\n      () =>\n        this.vrPanel.object3D.traverse(x => {\n          if (x.material) x.material.depthTest = false;\n        }),\n      { once: true }\n    );\n    this.el.append(this.vrPanel);\n    const background = document.createElement(\"a-plane\");\n    background.setAttribute(\"color\", \"#333333\");\n    background.setAttribute(\"material\", \"shader\", \"flat\");\n    background.setAttribute(\"material\", \"depthTest\", false);\n    background.setAttribute(\"width\", 0.1);\n    background.setAttribute(\"height\", 0.12);\n    background.setAttribute(\"position\", \"-0.2 0.055 0\");\n    this.el.append(background);\n  },\n  toggleVRStats() {\n    if (this.vrStatsEnabled) {\n      this.el.object3D.visible = false;\n      this.vrStatsEnabled = false;\n    } else {\n      if (!this.vrPanel) {\n        this.initVRStats();\n      }\n      this.el.object3D.visible = true;\n      this.vrStatsEnabled = true;\n    }\n  },\n  play() {\n    this.el.sceneEl.systems.physics.addComponent(this);\n  },\n  pause() {\n    this.el.sceneEl.systems.physics.removeComponent(this);\n  },\n  beforeStep() {\n    this.stats(\"physics\").start();\n  },\n  afterStep() {\n    this.stats(\"physics\").end();\n  },\n  update(oldData) {\n    if (oldData !== this.data) {\n      if (this.data) {\n        this.statsEl.classList.remove(HIDDEN_CLASS);\n        this.fpsEl.classList.add(HIDDEN_CLASS);\n      } else {\n        this.statsEl.classList.add(HIDDEN_CLASS);\n        this.fpsEl.classList.remove(HIDDEN_CLASS);\n      }\n    }\n  },\n  tick(time) {\n    const stats = this.stats;\n    if (this.data || this.vrStatsEnabled) {\n      // Update rStats\n      stats(\"rAF\").tick();\n      stats(\"FPS\").frame();\n\n      const batchManagerSystem = this.el.sceneEl.systems[\"hubs-systems\"].batchManagerSystem;\n      if (batchManagerSystem.batchingEnabled) {\n        const batchManager = batchManagerSystem.batchManager;\n        stats(\"batchdraws\").set(batchManager.batches.length);\n        stats(\"batchinstances\").set(batchManager.instanceCount);\n        stats(\"batchatlassize\").set(batchManager.atlas.arrayDepth);\n      }\n\n      stats().update();\n    } else if (!this.inVR) {\n      // Update the fps counter\n      const now = performance.now();\n      this.frameCount++;\n\n      // Update the fps counter text once a second\n      if (now >= this.lastFpsUpdate + 1000) {\n        const fps = Math.round(this.frameCount / ((now - this.lastFpsUpdate) / 1000));\n        if (fps !== this.lastFps) {\n          this.fpsEl.innerHTML = Math.round(fps) + \" FPS\";\n          this.lastFps = fps;\n        }\n        this.lastFpsUpdate = now;\n        this.frameCount = 0;\n      }\n    }\n    if (this.vrStatsEnabled && time - this.lastUpdate > 100) {\n      this.vrPanel.setAttribute(\n        \"text\",\n        \"value\",\n        [\n          `f ${stats(\"fps\")\n            .value()\n            .toFixed(0)}`,\n          `r ${stats(\"raf\")\n            .value()\n            .toFixed(0)}`,\n          `p ${stats(\"physics\")\n            .value()\n            .toFixed(0)}`,\n          `c ${this.el.sceneEl.renderer.info.render.calls}`,\n          `t ${(this.el.sceneEl.renderer.info.render.triangles / 1000).toFixed(0)}k`\n        ].join(\"\\n\")\n      );\n      this.lastUpdate = time;\n    }\n  },\n  onEnterVr() {\n    this.inVR = true;\n    // Hide all stats elements when entering VR on mobile\n    if (this.el.sceneEl.isMobile) {\n      this.statsEl.classList.add(HIDDEN_CLASS);\n      this.fpsEl.classList.add(HIDDEN_CLASS);\n    }\n  },\n  onExitVr() {\n    this.inVR = false;\n    // Revert to previous state whe exiting VR on mobile\n    if (this.el.sceneEl.isMobile) {\n      if (this.data) {\n        this.statsEl.classList.remove(HIDDEN_CLASS);\n      } else {\n        this.fpsEl.classList.remove(HIDDEN_CLASS);\n      }\n    }\n  },\n  onExpand() {\n    this.el.setAttribute(this.name, true);\n  },\n  onCollapse() {\n    this.el.setAttribute(this.name, false);\n  },\n  remove() {\n    this.el.sceneEl.removeEventListener(\"enter-vr\", this.hide);\n    this.el.sceneEl.removeEventListener(\"exit-vr\", this.show);\n\n    if (this.statsEl) {\n      this.statsEl.parentNode.removeChild(this.statsEl);\n      this.fpsEl.parentNode.removeChild(this.fpsEl);\n    }\n  }\n});\n","/* global performance THREE AFRAME NAF MediaStream process setTimeout */\nimport GIFWorker from \"../workers/gifparsing.worker.js\";\nimport errorImageSrc from \"!!url-loader!../assets/images/media-error.gif\";\nimport { paths } from \"../systems/userinput/paths\";\nimport HLS from \"hls.js/dist/hls.light.js\";\nimport { addAndArrangeMedia, createImageTexture } from \"../utils/media-utils\";\nimport { proxiedUrlFor } from \"../utils/media-url-utils\";\nimport { buildAbsoluteURL } from \"url-toolkit\";\nimport { SOUND_CAMERA_TOOL_TOOK_SNAPSHOT } from \"../systems/sound-effects-system\";\nimport { promisifyWorker } from \"../utils/promisify-worker.js\";\n\nconst ONCE_TRUE = { once: true };\nconst TYPE_IMG_PNG = { type: \"image/png\" };\nconst parseGIF = promisifyWorker(new GIFWorker());\n\nexport const VOLUME_LABELS = [];\nfor (let i = 0; i <= 20; i++) {\n  let s = \"|\";\n  for (let j = 0; j <= 20; j++) {\n    s += i >= j ? \"|\" : \" \";\n  }\n  s += \"|\";\n  VOLUME_LABELS[i] = s;\n}\n\nclass GIFTexture extends THREE.Texture {\n  constructor(frames, delays, disposals) {\n    super(document.createElement(\"canvas\"));\n    this.image.width = frames[0].width;\n    this.image.height = frames[0].height;\n\n    this._ctx = this.image.getContext(\"2d\");\n\n    this.generateMipmaps = false;\n    this.isVideoTexture = true;\n    this.minFilter = THREE.NearestFilter;\n\n    this.frames = frames;\n    this.delays = delays;\n    this.disposals = disposals;\n\n    this.frame = 0;\n    this.frameStartTime = Date.now();\n  }\n\n  update() {\n    if (!this.frames || !this.delays || !this.disposals) return;\n    const now = Date.now();\n    if (now - this.frameStartTime > this.delays[this.frame]) {\n      if (this.disposals[this.frame] === 2) {\n        this._ctx.clearRect(0, 0, this.image.width, this.image.width);\n      }\n      this.frame = (this.frame + 1) % this.frames.length;\n      this.frameStartTime = now;\n      this._ctx.drawImage(this.frames[this.frame], 0, 0, this.image.width, this.image.height);\n      this.needsUpdate = true;\n    }\n  }\n}\n\nasync function createGIFTexture(url) {\n  return new Promise((resolve, reject) => {\n    fetch(url, { mode: \"cors\" })\n      .then(r => r.arrayBuffer())\n      .then(rawImageData => parseGIF(rawImageData, [rawImageData]))\n      .then(result => {\n        const { frames, delayTimes, disposals } = result;\n        let loadCnt = 0;\n        for (let i = 0; i < frames.length; i++) {\n          const img = new Image();\n          img.onload = e => {\n            loadCnt++;\n            frames[i] = e.target;\n            if (loadCnt === frames.length) {\n              const texture = new GIFTexture(frames, delayTimes, disposals);\n              texture.image.src = url;\n              texture.encoding = THREE.sRGBEncoding;\n              texture.minFilter = THREE.LinearFilter;\n              resolve(texture);\n            }\n          };\n          img.src = frames[i];\n        }\n      })\n      .catch(reject);\n  });\n}\n\nconst isIOS = AFRAME.utils.device.isIOS();\n\n/**\n * Create video element to be used as a texture.\n *\n * @param {string} src - Url to a video file.\n * @returns {Element} Video element.\n */\nasync function createVideoEl() {\n  const videoEl = document.createElement(\"video\");\n  videoEl.setAttribute(\"playsinline\", \"\");\n  videoEl.setAttribute(\"webkit-playsinline\", \"\");\n  // iOS Safari requires the autoplay attribute, or it won't play the video at all.\n  videoEl.autoplay = true;\n  // iOS Safari will not play videos without user interaction. We mute the video so that it can autoplay and then\n  // allow the user to unmute it with an interaction in the unmute-video-button component.\n  videoEl.muted = isIOS;\n  videoEl.preload = \"auto\";\n  videoEl.crossOrigin = \"anonymous\";\n\n  return videoEl;\n}\n\nfunction createVideoTexture(url, contentType) {\n  return new Promise(async (resolve, reject) => {\n    const videoEl = await createVideoEl();\n\n    const texture = new THREE.VideoTexture(videoEl);\n    texture.minFilter = THREE.LinearFilter;\n    texture.encoding = THREE.sRGBEncoding;\n\n    if (url.startsWith(\"hubs://\")) {\n      const streamClientId = url.substring(7).split(\"/\")[1]; // /clients/<client id>/video is only URL for now\n      const stream = await NAF.connection.adapter.getMediaStream(streamClientId, \"video\");\n      videoEl.srcObject = new MediaStream(stream.getVideoTracks());\n      // If hls.js is supported we always use it as it gives us better events\n    } else if (AFRAME.utils.material.isHLS(url, contentType)) {\n      if (HLS.isSupported()) {\n        const corsProxyPrefix = `https://${process.env.CORS_PROXY_SERVER}/`;\n        const baseUrl = url.startsWith(corsProxyPrefix) ? url.substring(corsProxyPrefix.length) : url;\n        const hls = new HLS({\n          xhrSetup: (xhr, u) => {\n            if (u.startsWith(corsProxyPrefix)) {\n              u = u.substring(corsProxyPrefix.length);\n            }\n\n            // HACK HLS.js resolves relative urls internally, but our CORS proxying screws it up. Resolve relative to the original unproxied url.\n            // TODO extend HLS.js to allow overriding of its internal resolving instead\n            if (!u.startsWith(\"http\")) {\n              u = buildAbsoluteURL(baseUrl, u.startsWith(\"/\") ? u : `/${u}`);\n            }\n\n            xhr.open(\"GET\", proxiedUrlFor(u));\n          }\n        });\n        texture.hls = hls;\n        hls.loadSource(url);\n        hls.attachMedia(videoEl);\n        hls.on(HLS.Events.ERROR, function(event, data) {\n          if (data.fatal) {\n            switch (data.type) {\n              case HLS.ErrorTypes.NETWORK_ERROR:\n                // try to recover network error\n                hls.startLoad();\n                break;\n              case HLS.ErrorTypes.MEDIA_ERROR:\n                hls.recoverMediaError();\n                break;\n              default:\n                reject(event);\n                return;\n            }\n          }\n        });\n        // If not, see if native support will work\n      } else if (videoEl.canPlayType(contentType)) {\n        videoEl.src = url;\n        videoEl.onerror = reject;\n      } else {\n        reject(\"HLS unsupported\");\n      }\n    } else {\n      videoEl.src = url;\n      videoEl.onerror = reject;\n    }\n\n    let hasResolved = false;\n\n    const resolveOnce = () => {\n      if (hasResolved) return;\n      hasResolved = true;\n      resolve(texture);\n    };\n\n    videoEl.addEventListener(\"canplay\", resolveOnce, { once: true });\n\n    // HACK: Sometimes iOS fails to fire the canplay event, so we poll for the video dimensions to appear instead.\n    if (isIOS) {\n      const poll = () => {\n        if ((texture.image.videoHeight || texture.image.height) && (texture.image.videoWidth || texture.image.width)) {\n          resolveOnce();\n        } else {\n          setTimeout(poll, 500);\n        }\n      };\n\n      poll();\n    }\n  });\n}\n\nfunction scaleToAspectRatio(el, ratio) {\n  const width = Math.min(1.0, 1.0 / ratio);\n  const height = Math.min(1.0, ratio);\n  el.object3DMap.mesh.scale.set(width, height, 1);\n  el.object3DMap.mesh.matrixNeedsUpdate = true;\n}\n\nfunction disposeTexture(texture) {\n  if (texture.image instanceof HTMLVideoElement) {\n    const video = texture.image;\n    video.pause();\n    video.src = \"\";\n    video.load();\n  }\n\n  if (texture.hls) {\n    texture.hls.destroy();\n  }\n\n  texture.dispose();\n}\n\nclass TextureCache {\n  cache = new Map();\n\n  set(src, texture) {\n    const image = texture.image;\n    this.cache.set(src, {\n      texture,\n      ratio: (image.videoHeight || image.height) / (image.videoWidth || image.width),\n      count: 0\n    });\n    return this.retain(src);\n  }\n\n  has(src) {\n    return this.cache.has(src);\n  }\n\n  get(src) {\n    return this.cache.get(src);\n  }\n\n  retain(src) {\n    const cacheItem = this.cache.get(src);\n    cacheItem.count++;\n    // console.log(\"retain\", src, cacheItem.count);\n    return cacheItem;\n  }\n\n  release(src) {\n    const cacheItem = this.cache.get(src);\n\n    if (!cacheItem) {\n      console.error(`Releasing uncached texture src ${src}`);\n      return;\n    }\n\n    cacheItem.count--;\n    // console.log(\"release\", src, cacheItem.count);\n    if (cacheItem.count <= 0) {\n      // Unload the video element to prevent it from continuing to play in the background\n      disposeTexture(cacheItem.texture);\n      this.cache.delete(src);\n    }\n  }\n}\n\nconst textureCache = new TextureCache();\nconst inflightTextures = new Map();\n\nconst errorImage = new Image();\nerrorImage.src = errorImageSrc;\nconst errorTexture = new THREE.Texture(errorImage);\nerrorTexture.magFilter = THREE.NearestFilter;\nerrorImage.onload = () => {\n  errorTexture.needsUpdate = true;\n};\nconst errorCacheItem = { texture: errorTexture, ratio: 1 };\n\nfunction timeFmt(t) {\n  let s = Math.floor(t),\n    h = Math.floor(s / 3600);\n  s -= h * 3600;\n  let m = Math.floor(s / 60);\n  s -= m * 60;\n  if (h < 10) h = `0${h}`;\n  if (m < 10) m = `0${m}`;\n  if (s < 10) s = `0${s}`;\n  return h === \"00\" ? `${m}:${s}` : `${h}:${m}:${s}`;\n}\n\nAFRAME.registerComponent(\"media-video\", {\n  schema: {\n    src: { type: \"string\" },\n    contentType: { type: \"string\" },\n    volume: { type: \"number\", default: 0.5 },\n    loop: { type: \"boolean\", default: true },\n    audioType: { type: \"string\", default: \"pannernode\" },\n    hidePlaybackControls: { type: \"boolean\", default: false },\n    distanceModel: { type: \"string\", default: \"inverse\" },\n    rolloffFactor: { type: \"number\", default: 1 },\n    refDistance: { type: \"number\", default: 1 },\n    maxDistance: { type: \"number\", default: 10000 },\n    coneInnerAngle: { type: \"number\", default: 360 },\n    coneOuterAngle: { type: \"number\", default: 0 },\n    coneOuterGain: { type: \"number\", default: 0 },\n    videoPaused: { type: \"boolean\" },\n    projection: { type: \"string\", default: \"flat\" },\n    time: { type: \"number\" },\n    tickRate: { default: 1000 }, // ms interval to send time interval updates\n    syncTolerance: { default: 2 }\n  },\n\n  init() {\n    this.onPauseStateChange = this.onPauseStateChange.bind(this);\n    this.tryUpdateVideoPlaybackState = this.tryUpdateVideoPlaybackState.bind(this);\n    this.updateSrc = this.updateSrc.bind(this);\n\n    this.seekForward = this.seekForward.bind(this);\n    this.seekBack = this.seekBack.bind(this);\n    this.volumeUp = this.volumeUp.bind(this);\n    this.volumeDown = this.volumeDown.bind(this);\n    this.snap = this.snap.bind(this);\n    this.changeVolumeBy = this.changeVolumeBy.bind(this);\n    this.togglePlaying = this.togglePlaying.bind(this);\n\n    this.lastUpdate = 0;\n    this.videoMutedAt = 0;\n    this.localSnapCount = 0;\n    this.isSnapping = false;\n    this.onSnapImageLoaded = () => (this.isSnapping = false);\n\n    this.el.setAttribute(\"hover-menu__video\", { template: \"#video-hover-menu\", dirs: [\"forward\", \"back\"] });\n    this.el.components[\"hover-menu__video\"].getHoverMenu().then(menu => {\n      // If we got removed while waiting, do nothing.\n      if (!this.el.parentNode) return;\n\n      this.hoverMenu = menu;\n\n      this.playbackControls = this.el.querySelector(\".video-playback\");\n      this.playPauseButton = this.el.querySelector(\".video-playpause-button\");\n      this.volumeUpButton = this.el.querySelector(\".video-volume-up-button\");\n      this.volumeDownButton = this.el.querySelector(\".video-volume-down-button\");\n      this.seekForwardButton = this.el.querySelector(\".video-seek-forward-button\");\n      this.seekBackButton = this.el.querySelector(\".video-seek-back-button\");\n      this.snapButton = this.el.querySelector(\".video-snap-button\");\n      this.timeLabel = this.el.querySelector(\".video-time-label\");\n      this.volumeLabel = this.el.querySelector(\".video-volume-label\");\n\n      this.playPauseButton.object3D.addEventListener(\"interact\", this.togglePlaying);\n      this.seekForwardButton.object3D.addEventListener(\"interact\", this.seekForward);\n      this.seekBackButton.object3D.addEventListener(\"interact\", this.seekBack);\n      this.volumeUpButton.object3D.addEventListener(\"interact\", this.volumeUp);\n      this.volumeDownButton.object3D.addEventListener(\"interact\", this.volumeDown);\n      this.snapButton.object3D.addEventListener(\"interact\", this.snap);\n\n      this.updateVolumeLabel();\n      this.updateHoverMenuBasedOnLiveState();\n      this.updatePlaybackState();\n    });\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.networkedEl = networkedEl;\n      this.networkedEl.components.networked.applyPersistentFirstSync();\n      this.updatePlaybackState();\n\n      // For scene-owned videos, take ownership after a random delay if nobody\n      // else has so there is a timekeeper. Do not due this on iOS because iOS has an\n      // annoying \"auto-pause\" feature that forces one non-autoplaying video to play\n      // at once, which will pause the videos for everyone in the room if owned.\n      if (!isIOS && NAF.utils.getNetworkOwner(this.networkedEl) === \"scene\") {\n        setTimeout(() => {\n          if (NAF.utils.getNetworkOwner(this.networkedEl) === \"scene\") {\n            NAF.utils.takeOwnership(this.networkedEl);\n          }\n        }, 2000 + Math.floor(Math.random() * 2000));\n      }\n    });\n\n    // from a-sound\n    const sceneEl = this.el.sceneEl;\n    sceneEl.audioListener = sceneEl.audioListener || new THREE.AudioListener();\n    if (sceneEl.camera) {\n      sceneEl.camera.add(sceneEl.audioListener);\n    }\n    sceneEl.addEventListener(\"camera-set-active\", function(evt) {\n      evt.detail.cameraEl.getObject3D(\"camera\").add(sceneEl.audioListener);\n    });\n  },\n\n  seekForward() {\n    if ((!this.videoIsLive && NAF.utils.isMine(this.networkedEl)) || NAF.utils.takeOwnership(this.networkedEl)) {\n      this.video.currentTime += 30;\n      this.el.setAttribute(\"media-video\", \"time\", this.video.currentTime);\n    }\n  },\n\n  seekBack() {\n    if ((!this.videoIsLive && NAF.utils.isMine(this.networkedEl)) || NAF.utils.takeOwnership(this.networkedEl)) {\n      this.video.currentTime -= 10;\n      this.el.setAttribute(\"media-video\", \"time\", this.video.currentTime);\n    }\n  },\n\n  changeVolumeBy(v) {\n    this.el.setAttribute(\"media-video\", \"volume\", THREE.Math.clamp(this.data.volume + v, 0, 1));\n    this.updateVolumeLabel();\n  },\n\n  volumeUp() {\n    this.changeVolumeBy(0.1);\n  },\n\n  volumeDown() {\n    this.changeVolumeBy(-0.1);\n  },\n\n  async snap() {\n    if (this.isSnapping) return;\n    this.isSnapping = true;\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_TOOK_SNAPSHOT);\n\n    const canvas = document.createElement(\"canvas\");\n    canvas.width = this.video.videoWidth;\n    canvas.height = this.video.videoHeight;\n    canvas.getContext(\"2d\").drawImage(this.video, 0, 0, canvas.width, canvas.height);\n    const blob = await new Promise(resolve => canvas.toBlob(resolve));\n    const file = new File([blob], \"snap.png\", TYPE_IMG_PNG);\n\n    this.localSnapCount++;\n    const { entity } = addAndArrangeMedia(this.el, file, \"photo-snapshot\", this.localSnapCount);\n    entity.addEventListener(\"image-loaded\", this.onSnapImageLoaded, ONCE_TRUE);\n  },\n\n  togglePlaying() {\n    // See onPauseStateChanged for note about iOS\n    if (isIOS && this.video.paused && NAF.utils.isMine(this.networkedEl)) {\n      this.video.play();\n      return;\n    }\n\n    if (this.networkedEl && (NAF.utils.isMine(this.networkedEl) || NAF.utils.takeOwnership(this.networkedEl))) {\n      this.tryUpdateVideoPlaybackState(!this.data.videoPaused);\n    }\n  },\n\n  onPauseStateChange() {\n    // iOS Safari will auto-pause other videos if one is manually started (not autoplayed.) So, to keep things\n    // easy to reason about, we *never* broadcast pauses from iOS.\n    //\n    // if an iOS safari user pauses and plays a video they'll pause all the other videos,\n    // which isn't great, but this check will at least ensure they don't pause those videos\n    // for all other users in the room! Of course, if they go and hit play on those videos auto-paused,\n    // they will become the timekeeper, and will seek everyone to where the video was auto-paused.\n    //\n    // This specific case will diverge the network schema and the video player state, so that\n    // this.data.videoPaused is false (so others will keep playing it) but our local player will\n    // have stopped. So we deal with this special case as well when we press the play button.\n    if (isIOS && this.video.paused && NAF.utils.isMine(this.networkedEl)) {\n      return;\n    }\n\n    // Used in the HACK in hub.js for dealing with auto-pause in Oculus Browser\n    if (this._ignorePauseStateChanges) return;\n\n    this.el.setAttribute(\"media-video\", \"videoPaused\", this.video.paused);\n\n    if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n      this.el.emit(\"owned-video-state-changed\");\n    }\n  },\n\n  updatePlaybackState(force) {\n    if (this.hoverMenu) {\n      this.playbackControls.object3D.visible = !this.data.hidePlaybackControls && !!this.video;\n      this.timeLabel.object3D.visible = !this.data.hidePlaybackControls;\n\n      const isPinned = this.el.components.pinnable && this.el.components.pinnable.data.pinned;\n      this.playPauseButton.object3D.visible = !!this.video && (!isPinned || window.APP.hubChannel.can(\"pin_objects\"));\n      this.snapButton.object3D.visible = !!this.video && window.APP.hubChannel.can(\"spawn_and_move_media\");\n      this.seekForwardButton.object3D.visible = !!this.video && !this.videoIsLive;\n      this.seekBackButton.object3D.visible = !!this.video && !this.videoIsLive;\n    }\n\n    // Only update playback position for videos you don't own\n    if (force || (this.networkedEl && !NAF.utils.isMine(this.networkedEl) && this.video)) {\n      if (Math.abs(this.data.time - this.video.currentTime) > this.data.syncTolerance) {\n        this.tryUpdateVideoPlaybackState(this.data.videoPaused, this.data.time);\n      } else {\n        this.tryUpdateVideoPlaybackState(this.data.videoPaused);\n      }\n    }\n\n    // Volume is local, always update it\n    if (this.audio) {\n      this.audio.gain.gain.value = this.data.volume;\n    }\n  },\n\n  tryUpdateVideoPlaybackState(pause, currentTime) {\n    if (this._playbackStateChangeTimeout) {\n      clearTimeout(this._playbackStateChangeTimeout);\n      delete this._playbackStateChangeTimeout;\n    }\n\n    if (!this.videoIsLive && currentTime !== undefined) {\n      this.video.currentTime = currentTime;\n    }\n\n    if (this.hoverMenu) {\n      this.playPauseButton.setAttribute(\"icon-button\", \"active\", pause);\n    }\n\n    if (pause) {\n      this.video.pause();\n    } else {\n      // Need to deal with the fact play() may fail if user has not interacted with browser yet.\n      this.video.play().catch(() => {\n        if (pause !== this.data.videoPaused) return;\n        this._playbackStateChangeTimeout = setTimeout(() => this.tryUpdateVideoPlaybackState(pause, currentTime), 1000);\n      });\n    }\n  },\n\n  async update(oldData) {\n    const src = this.data.src;\n    this.updatePlaybackState();\n\n    if (!src || src === oldData.src) return;\n    return this.updateSrc(oldData);\n  },\n\n  async updateSrc(oldData) {\n    const { src } = this.data;\n\n    this.cleanUp();\n    if (this.mesh && this.mesh.material) {\n      this.mesh.material.map = null;\n      this.mesh.material.needsUpdate = true;\n    }\n\n    let texture;\n    try {\n      texture = await createVideoTexture(src, this.data.contentType);\n\n      // No way to cancel promises, so if src has changed while we were creating the texture just throw it away.\n      if (this.data.src !== src) {\n        disposeTexture(texture);\n        return;\n      }\n\n      if (!src.startsWith(\"hubs://\")) {\n        // TODO FF error here if binding mediastream: The captured HTMLMediaElement is playing a MediaStream. Applying volume or mute status is not currently supported -- not an issue since we have no audio atm in shared video.\n        texture.audioSource = this.el.sceneEl.audioListener.context.createMediaElementSource(texture.image);\n\n        if (this.data.audioType === \"pannernode\") {\n          this.audio = new THREE.PositionalAudio(this.el.sceneEl.audioListener);\n          this.audio.setDistanceModel(this.data.distanceModel);\n          this.audio.setRolloffFactor(this.data.rolloffFactor);\n          this.audio.setRefDistance(this.data.refDistance);\n          this.audio.setMaxDistance(this.data.maxDistance);\n          this.audio.panner.coneInnerAngle = this.data.coneInnerAngle;\n          this.audio.panner.coneOuterAngle = this.data.coneOuterAngle;\n          this.audio.panner.coneOuterGain = this.data.coneOuterGain;\n        } else {\n          this.audio = new THREE.Audio(this.el.sceneEl.audioListener);\n        }\n\n        this.audio.setNodeSource(texture.audioSource);\n        this.el.setObject3D(\"sound\", this.audio);\n      }\n\n      this.video = texture.image;\n      this.video.loop = this.data.loop;\n      this.video.addEventListener(\"pause\", this.onPauseStateChange);\n      this.video.addEventListener(\"play\", this.onPauseStateChange);\n\n      if (texture.hls) {\n        const updateLiveState = () => {\n          this.videoIsLive = texture.hls.levels[texture.hls.currentLevel].details.live;\n          this.updateHoverMenuBasedOnLiveState();\n        };\n        texture.hls.on(HLS.Events.LEVEL_SWITCHED, updateLiveState);\n        if (texture.hls.currentLevel >= 0) {\n          updateLiveState();\n        }\n      } else {\n        this.videoIsLive = this.video.duration === Infinity;\n        this.updateHoverMenuBasedOnLiveState();\n      }\n\n      if (isIOS) {\n        const template = document.getElementById(\"video-unmute\");\n        this.el.appendChild(document.importNode(template.content, true));\n        this.el.setAttribute(\"position-at-box-shape-border__unmute-ui\", {\n          target: \".unmute-ui\",\n          dirs: [\"forward\", \"back\"]\n        });\n      }\n    } catch (e) {\n      console.error(\"Error loading video\", this.data.src, e);\n      texture = errorTexture;\n    }\n\n    const projection = this.data.projection;\n\n    if (!this.mesh || projection !== oldData.projection) {\n      const material = new THREE.MeshBasicMaterial();\n\n      let geometry;\n\n      if (projection === \"360-equirectangular\") {\n        geometry = new THREE.SphereBufferGeometry(1, 64, 32);\n        // invert the geometry on the x-axis so that all of the faces point inward\n        geometry.scale(-1, 1, 1);\n      } else {\n        geometry = new THREE.PlaneBufferGeometry();\n        material.side = THREE.DoubleSide;\n      }\n\n      this.mesh = new THREE.Mesh(geometry, material);\n      this.el.setObject3D(\"mesh\", this.mesh);\n    }\n\n    this.mesh.material.map = texture;\n    this.mesh.material.needsUpdate = true;\n\n    if (projection === \"flat\") {\n      scaleToAspectRatio(this.el, texture.image.videoHeight / texture.image.videoWidth);\n    }\n\n    this.updatePlaybackState(true);\n\n    if (this.video.muted) {\n      this.videoMutedAt = performance.now();\n    }\n\n    this.el.emit(\"video-loaded\", { projection: projection });\n  },\n\n  updateHoverMenuBasedOnLiveState() {\n    if (!this.hoverMenu) return;\n\n    this.seekForwardButton.object3D.visible = !this.videoIsLive;\n    this.seekBackButton.object3D.visible = !this.videoIsLive;\n\n    if (this.videoIsLive) {\n      this.timeLabel.setAttribute(\"text\", \"value\", \"LIVE\");\n    }\n  },\n\n  updateVolumeLabel() {\n    this.volumeLabel.setAttribute(\n      \"text\",\n      \"value\",\n      this.data.volume === 0 ? \"MUTE\" : VOLUME_LABELS[Math.floor(this.data.volume / 0.05)]\n    );\n  },\n\n  tick() {\n    if (!this.video) return;\n\n    const userinput = this.el.sceneEl.systems.userinput;\n    const interaction = this.el.sceneEl.systems.interaction;\n    const volumeMod = userinput.get(paths.actions.cursor.mediaVolumeMod);\n    if (interaction.state.rightRemote.hovered === this.el && volumeMod) {\n      this.changeVolumeBy(volumeMod);\n    }\n\n    const isHeld = interaction.isHeld(this.el);\n\n    if (this.wasHeld && !isHeld) {\n      this.localSnapCount = 0;\n    }\n\n    this.wasHeld = isHeld;\n\n    if (this.hoverMenu && this.hoverMenu.object3D.visible && !this.videoIsLive) {\n      this.timeLabel.setAttribute(\n        \"text\",\n        \"value\",\n        `${timeFmt(this.video.currentTime)} / ${timeFmt(this.video.duration)}`\n      );\n    }\n\n    // If a non-live video is currently playing and we own it, send out time updates\n    if (!this.data.videoPaused && !this.videoIsLive && this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n      const now = performance.now();\n      if (now - this.lastUpdate > this.data.tickRate) {\n        this.el.setAttribute(\"media-video\", \"time\", this.video.currentTime);\n        this.lastUpdate = now;\n      }\n    }\n  },\n\n  cleanUp() {\n    if (this.mesh && this.mesh.material) {\n      disposeTexture(this.mesh.material.map);\n    }\n  },\n\n  remove() {\n    this.cleanUp();\n\n    if (this.audio) {\n      this.el.removeObject3D(\"sound\");\n      this.audio.disconnect();\n      delete this.audio;\n    }\n\n    if (this.video) {\n      this.video.removeEventListener(\"pause\", this.onPauseStateChange);\n      this.video.removeEventListener(\"play\", this.onPauseStateChange);\n    }\n    if (this.hoverMenu) {\n      this.playPauseButton.object3D.removeEventListener(\"interact\", this.togglePlaying);\n      this.volumeUpButton.object3D.removeEventListener(\"interact\", this.volumeUp);\n      this.volumeDownButton.object3D.removeEventListener(\"interact\", this.volumeDown);\n      this.seekForwardButton.object3D.removeEventListener(\"interact\", this.seekForward);\n      this.seekBackButton.object3D.removeEventListener(\"interact\", this.seekBack);\n    }\n  }\n});\n\nAFRAME.registerComponent(\"media-image\", {\n  schema: {\n    src: { type: \"string\" },\n    projection: { type: \"string\", default: \"flat\" },\n    contentType: { type: \"string\" },\n    batch: { default: false }\n  },\n\n  remove() {\n    if (this.data.batch && this.mesh) {\n      this.el.sceneEl.systems[\"hubs-systems\"].batchManagerSystem.removeObject(this.mesh);\n    }\n    if (this._hasRetainedTexture) {\n      textureCache.release(this.data.src);\n      this.currentSrcIsRetained = false;\n    }\n  },\n\n  async update(oldData) {\n    let texture;\n    let ratio = 1;\n\n    try {\n      const { src, contentType } = this.data;\n      if (!src) return;\n\n      this.el.emit(\"image-loading\");\n\n      if (this.mesh && this.mesh.map && src !== oldData.src) {\n        this.mesh.material.map = null;\n        this.mesh.material.needsUpdate = true;\n        if (this.mesh.map !== errorTexture) {\n          textureCache.release(oldData.src);\n          this.currentSrcIsRetained = false;\n        }\n      }\n\n      let cacheItem;\n      if (textureCache.has(src)) {\n        cacheItem = textureCache.retain(src);\n      } else {\n        if (src === \"error\") {\n          cacheItem = errorCacheItem;\n        } else if (inflightTextures.has(src)) {\n          await inflightTextures.get(src);\n          cacheItem = textureCache.retain(src);\n        } else {\n          let promise;\n          if (contentType.includes(\"image/gif\")) {\n            promise = createGIFTexture(src);\n          } else if (contentType.startsWith(\"image/\")) {\n            promise = createImageTexture(src);\n          } else {\n            throw new Error(`Unknown image content type: ${contentType}`);\n          }\n          inflightTextures.set(src, promise);\n          texture = await promise;\n          inflightTextures.delete(src);\n          cacheItem = textureCache.set(src, texture);\n        }\n\n        // No way to cancel promises, so if src has changed or this entity was removed while we were creating the texture just throw it away.\n        if (this.data.src !== src || !this.el.parentNode) {\n          textureCache.release(src);\n          return;\n        }\n      }\n\n      texture = cacheItem.texture;\n      ratio = cacheItem.ratio;\n\n      this.currentSrcIsRetained = true;\n    } catch (e) {\n      console.error(\"Error loading image\", this.data.src, e);\n      texture = errorTexture;\n      this.currentSrcIsRetained = false;\n    }\n\n    const projection = this.data.projection;\n\n    if (!this.mesh || projection !== oldData.projection) {\n      const material = new THREE.MeshBasicMaterial();\n\n      let geometry;\n\n      if (projection === \"360-equirectangular\") {\n        geometry = new THREE.SphereBufferGeometry(1, 64, 32);\n        // invert the geometry on the x-axis so that all of the faces point inward\n        geometry.scale(-1, 1, 1);\n      } else {\n        geometry = new THREE.PlaneBufferGeometry(1, 1, 1, 1, texture.flipY);\n        material.side = THREE.DoubleSide;\n      }\n\n      this.mesh = new THREE.Mesh(geometry, material);\n      this.el.setObject3D(\"mesh\", this.mesh);\n    }\n\n    // We only support transparency on gifs. Other images will support cutout as part of batching, but not alpha transparency for now\n    this.mesh.material.transparent =\n      !this.data.batch || texture == errorTexture || this.data.contentType.includes(\"image/gif\");\n    this.mesh.material.map = texture;\n    this.mesh.material.needsUpdate = true;\n\n    if (projection === \"flat\") {\n      scaleToAspectRatio(this.el, ratio);\n    }\n\n    if (texture !== errorTexture && this.data.batch) {\n      this.el.sceneEl.systems[\"hubs-systems\"].batchManagerSystem.addObject(this.mesh);\n    }\n\n    this.el.emit(\"image-loaded\", { src: this.data.src, projection: projection });\n  }\n});\n","import { VOLUME_LABELS } from \"./media-views\";\n\nAFRAME.registerComponent(\"avatar-volume-controls\", {\n  schema: {\n    volume: { type: \"number\", default: 1.0 }\n  },\n\n  init() {\n    this.volumeUp = this.volumeUp.bind(this);\n    this.volumeDown = this.volumeDown.bind(this);\n    this.changeVolumeBy = this.changeVolumeBy.bind(this);\n    this.volumeUpButton = this.el.querySelector(\".avatar-volume-up-button\");\n    this.volumeDownButton = this.el.querySelector(\".avatar-volume-down-button\");\n    this.volumeLabel = this.el.querySelector(\".avatar-volume-label\");\n    this.volumeUpButton.object3D.addEventListener(\"interact\", this.volumeUp);\n    this.volumeDownButton.object3D.addEventListener(\"interact\", this.volumeDown);\n\n    this.updateVolumeLabel();\n  },\n\n  changeVolumeBy(v) {\n    this.el.setAttribute(\"avatar-volume-controls\", \"volume\", THREE.Math.clamp(this.data.volume + v, 0, 1));\n    this.updateVolumeLabel();\n  },\n\n  volumeUp() {\n    this.changeVolumeBy(0.1);\n  },\n\n  volumeDown() {\n    this.changeVolumeBy(-0.1);\n  },\n\n  update() {\n    if (this.audio) {\n      this.audio.gain.gain.value = this.data.volume;\n    }\n  },\n\n  updateVolumeLabel() {\n    this.volumeLabel.setAttribute(\n      \"text\",\n      \"value\",\n      this.data.volume === 0 ? \"Muted\" : VOLUME_LABELS[Math.floor(this.data.volume / 0.05)]\n    );\n  },\n\n  tick() {\n    if (this.audio) return;\n\n    // Walk up to Spine and then search down.\n    const source = this.el.parentNode.parentNode.querySelector(\"[networked-audio-source]\");\n    if (!source) return;\n\n    this.audio = source.components[\"networked-audio-source\"].sound;\n    this.update();\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\n\nAFRAME.registerComponent(\"pinch-to-move\", {\n  schema: {\n    speed: { default: 0.25 }\n  },\n  init() {\n    this.axis = [0, 0];\n  },\n  tick() {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const pinch = userinput.get(paths.device.touchscreen.pinchDelta);\n    if (pinch) {\n      this.axis[1] = pinch * this.data.speed;\n      this.el.emit(\"move\", { axis: this.axis });\n    }\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\n\nconst degToRad = THREE.Math.degToRad;\nconst radToDeg = THREE.Math.radToDeg;\n\nAFRAME.registerComponent(\"pitch-yaw-rotator\", {\n  schema: {\n    minPitch: { default: -90 },\n    maxPitch: { default: 90 }\n  },\n\n  init() {\n    this.pitch = 0;\n    this.yaw = 0;\n    this.onRotateX = this.onRotateX.bind(this);\n    this.el.sceneEl.addEventListener(\"rotateX\", this.onRotateX);\n    this.el.sceneEl.addEventListener(\"enter-vr\", () => this.pause());\n    this.el.sceneEl.addEventListener(\"exit-vr\", () => this.play());\n    this.pendingXRotation = 0;\n  },\n\n  onRotateX(e) {\n    this.pendingXRotation += e.detail.value;\n  },\n\n  look(deltaPitch, deltaYaw) {\n    const { minPitch, maxPitch } = this.data;\n    this.pitch += deltaPitch;\n    this.pitch = THREE.Math.clamp(this.pitch, minPitch, maxPitch);\n    this.yaw += deltaYaw;\n  },\n\n  set(pitch, yaw) {\n    const { minPitch, maxPitch } = this.data;\n    this.pitch = THREE.Math.clamp(radToDeg(pitch), minPitch, maxPitch);\n    this.yaw = radToDeg(yaw);\n  },\n\n  tick() {\n    const scene = AFRAME.scenes[0];\n    const userinput = scene.systems.userinput;\n    const cameraDelta = userinput.get(scene.is(\"entered\") ? paths.actions.cameraDelta : paths.actions.lobbyCameraDelta);\n    let lookX = this.pendingXRotation;\n    let lookY = 0;\n    if (cameraDelta) {\n      lookY += cameraDelta[0];\n      lookX += cameraDelta[1];\n    }\n    if (lookX !== 0 || lookY !== 0) {\n      this.look(lookX, lookY);\n      this.el.object3D.rotation.set(degToRad(this.pitch), degToRad(this.yaw), 0);\n      this.el.object3D.rotation.order = \"YXZ\";\n    }\n    this.pendingXRotation = 0;\n  }\n});\n","import { getBox } from \"../utils/auto-box-collider.js\";\nimport { getLastWorldPosition } from \"../utils/three-utils\";\n\nconst PI = Math.PI;\nconst HALF_PI = PI / 2;\nconst THREE_HALF_PI = 3 * HALF_PI;\nconst right = new THREE.Vector3(1, 0, 0);\nconst forward = new THREE.Vector3(0, 0, 1);\nconst left = new THREE.Vector3(-1, 0, 0);\nconst back = new THREE.Vector3(0, 0, -1);\nconst zero = new THREE.Vector3(0, 0, 0);\nconst dirs = {\n  left: {\n    dir: left,\n    rotation: THREE_HALF_PI,\n    halfExtent: \"x\"\n  },\n  right: {\n    dir: right,\n    rotation: HALF_PI,\n    halfExtent: \"x\"\n  },\n  forward: {\n    dir: forward,\n    rotation: 0,\n    halfExtent: \"z\"\n  },\n  back: {\n    dir: back,\n    rotation: PI,\n    halfExtent: \"z\"\n  }\n};\n\nAFRAME.registerComponent(\"position-at-box-shape-border\", {\n  multiple: true,\n  schema: {\n    target: { type: \"string\" },\n    dirs: { default: [\"left\", \"right\", \"forward\", \"back\"] },\n    animate: { default: true },\n    scale: { default: true }\n  },\n\n  init() {\n    this.cam = this.el.sceneEl.camera.el.object3D;\n    this._updateBox = this._updateBox.bind(this);\n    this._setupTarget = this._setupTarget.bind(this);\n    this.halfExtents = new THREE.Vector3();\n    this.el.sceneEl.systems[\"frame-scheduler\"].schedule(this._updateBox, \"media-components\");\n  },\n\n  remove() {\n    this.el.sceneEl.systems[\"frame-scheduler\"].unschedule(this._updateBox, \"media-components\");\n  },\n\n  update() {\n    this.dirs = this.data.dirs.map(d => dirs[d]);\n  },\n\n  _setupTarget() {\n    this.targetEl = this.el.querySelector(this.data.target);\n    if (!this.targetEl) {\n      console.warn(`Race condition on position-at-box-shape-border on selector ${this.data.target}`);\n      return;\n    }\n\n    this.target = this.targetEl.object3D;\n\n    this.targetEl.addEventListener(\"animationcomplete\", () => {\n      this.targetEl.removeAttribute(\"animation__show\");\n    });\n\n    this.target.scale.setScalar(0.01); // To avoid \"pop\" of gigantic button first time\n    this.target.matrixNeedsUpdate = true;\n  },\n\n  tick() {\n    if (!this.target) {\n      this._setupTarget();\n      return;\n    }\n\n    if (!this.el.getObject3D(\"mesh\")) {\n      return;\n    }\n\n    const isVisible = this.targetEl.object3D.visible;\n    const opening = isVisible && !this.wasVisible;\n    const scaleChanged =\n      this.el.object3D.scale.x !== this.previousScaleX ||\n      this.el.object3D.scale.y !== this.previousScaleY ||\n      this.el.object3D.scale.z !== this.previousScaleZ;\n    const isAnimating = this.targetEl.getAttribute(\"animation__show\");\n\n    // If the target is being shown or the scale changed while the opening animation is being run,\n    // we need to start or re-start the animation.\n    if (opening || (scaleChanged && isAnimating)) {\n      this._updateBox(this.data.animate, true);\n    }\n\n    this.wasVisible = isVisible;\n    this.previousScaleX = this.el.object3D.scale.x;\n    this.previousScaleY = this.el.object3D.scale.y;\n    this.previousScaleZ = this.el.object3D.scale.z;\n  },\n\n  _updateBox: (function() {\n    const camWorldPos = new THREE.Vector3();\n    const targetPosition = new THREE.Vector3();\n    const pointOnBoxFace = new THREE.Vector3();\n    const pointOnBoxFaceToCamera = new THREE.Vector3();\n    const boxCenter = new THREE.Vector3();\n    const tempParentWorldScale = new THREE.Vector3();\n    const boxFaceNormal = new THREE.Vector3();\n    const min = new THREE.Vector3(0.001, 0.001, 0.001);\n\n    return function(animate, forceNewExtents) {\n      if (forceNewExtents || this.mesh !== this.el.getObject3D(\"mesh\")) {\n        this.mesh = this.el.getObject3D(\"mesh\");\n\n        const box = getBox(this.el, this.mesh);\n        this.halfExtents = box.min\n          .clone()\n          .negate()\n          .add(box.max)\n          .multiplyScalar(0.65);\n\n        this.halfExtents.max(min);\n      }\n\n      if (!this.target) return;\n\n      getLastWorldPosition(this.cam, camWorldPos);\n\n      let targetSquareDistance = Infinity;\n      let targetDir = this.dirs[0].dir;\n      let targetHalfExtentStr = this.dirs[0].halfExtent;\n      let targetHalfExtent = this.halfExtents[targetHalfExtentStr];\n      let targetRotation = this.dirs[0].rotation;\n      let targetCameraDot = -1.1;\n\n      this.el.object3D.updateMatrices();\n\n      for (let i = 0; i < this.dirs.length; i++) {\n        const dir = this.dirs[i].dir;\n        const halfExtentStr = this.dirs[i].halfExtent;\n        const halfExtent = this.halfExtents[halfExtentStr];\n        pointOnBoxFace.copy(dir).multiplyScalar(halfExtent);\n        boxCenter.copy(zero);\n\n        this.el.object3D.localToWorld(pointOnBoxFace);\n        this.el.object3D.localToWorld(boxCenter);\n\n        pointOnBoxFaceToCamera.subVectors(camWorldPos, pointOnBoxFace);\n        pointOnBoxFaceToCamera.normalize();\n\n        boxFaceNormal.subVectors(pointOnBoxFace, boxCenter);\n        boxFaceNormal.normalize();\n\n        // Compute dot between camera + box normal to ensure menus are going to be\n        // somewhat perpendicular to camera frustum\n        const cameraAngleDotBoxNormal = boxFaceNormal.dot(pointOnBoxFaceToCamera);\n\n        const squareDistance = pointOnBoxFace.distanceToSquared(camWorldPos);\n        if (cameraAngleDotBoxNormal > targetCameraDot) {\n          targetSquareDistance = squareDistance;\n          targetDir = dir;\n          targetHalfExtent = halfExtent;\n          targetRotation = this.dirs[i].rotation;\n          targetHalfExtentStr = halfExtentStr;\n          targetCameraDot = cameraAngleDotBoxNormal;\n        }\n      }\n\n      this.target.position.copy(targetPosition.copy(targetDir).multiplyScalar(targetHalfExtent));\n      this.target.rotation.set(0, targetRotation, 0);\n\n      tempParentWorldScale.setFromMatrixScale(this.target.parent.matrixWorld);\n\n      const distance = Math.sqrt(targetSquareDistance);\n      const scale = Math.max(this.halfExtents.x, this.halfExtents.z) * distance;\n      const targetScale = Math.min(2.0, Math.max(0.5, scale * tempParentWorldScale.x));\n      const finalScale = this.data.scale ? targetScale / tempParentWorldScale.x : 1;\n\n      if (animate) {\n        this.targetEl.removeAttribute(\"animation__show\");\n\n        this.targetEl.setAttribute(\"animation__show\", {\n          property: \"scale\",\n          dur: 300,\n          from: { x: finalScale * 0.8, y: finalScale * 0.8, z: finalScale * 0.8 },\n          to: { x: finalScale, y: finalScale, z: finalScale },\n          easing: \"easeOutElastic\"\n        });\n      } else if (!this.targetEl.getAttribute(\"animation__show\")) {\n        this.target.scale.setScalar(finalScale);\n      }\n\n      this.target.matrixNeedsUpdate = true;\n    };\n  })()\n});\n","import { getPromotionTokenForFile } from \"../utils/media-utils\";\nimport { SOUND_PIN } from \"../systems/sound-effects-system\";\n\nAFRAME.registerComponent(\"pin-networked-object-button\", {\n  schema: {\n    // Selector for label informing users about Discord bridging of pins.\n    tipSelector: { type: \"string\" },\n\n    // Selector for label to change when pinned/unpinned, must be sibling of this components element\n    labelSelector: { type: \"string\" }\n  },\n\n  init() {\n    this._updateUI = this._updateUI.bind(this);\n    this._updateUIOnStateChange = this._updateUIOnStateChange.bind(this);\n    this.el.sceneEl.addEventListener(\"stateadded\", this._updateUIOnStateChange);\n    this.el.sceneEl.addEventListener(\"stateremoved\", this._updateUIOnStateChange);\n\n    this.tipEl = this.el.parentNode.querySelector(this.data.tipSelector);\n    this.labelEl = this.el.parentNode.querySelector(this.data.labelSelector);\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n\n      this._updateUI();\n      this.targetEl.addEventListener(\"pinned\", this._updateUI);\n      this.targetEl.addEventListener(\"unpinned\", this._updateUI);\n    });\n\n    this.onHovered = () => {\n      this.hovering = true;\n      this._updateUI();\n    };\n\n    this.onUnhovered = () => {\n      this.hovering = false;\n      this._updateUI();\n    };\n\n    this.onClick = () => {\n      if (!NAF.utils.isMine(this.targetEl) && !NAF.utils.takeOwnership(this.targetEl)) return;\n\n      const wasPinned = this.targetEl.components.pinnable && this.targetEl.components.pinnable.data.pinned;\n      this.targetEl.setAttribute(\"pinnable\", \"pinned\", !wasPinned);\n      if (!wasPinned) {\n        this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_PIN);\n      }\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n    this.el.object3D.addEventListener(\"hovered\", this.onHovered);\n    this.el.object3D.addEventListener(\"unhovered\", this.onUnhovered);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n    this.el.object3D.removeEventListener(\"hovered\", this.onHovered);\n    this.el.object3D.removeEventListener(\"unhovered\", this.onUnhovered);\n  },\n\n  remove() {\n    this.el.sceneEl.removeEventListener(\"stateadded\", this._updateUIOnStateChange);\n    this.el.sceneEl.removeEventListener(\"stateremoved\", this._updateUIOnStateChange);\n\n    if (this.targetEl) {\n      this.targetEl.removeEventListener(\"pinned\", this._updateUI);\n      this.targetEl.removeEventListener(\"unpinned\", this._updateUI);\n    }\n  },\n\n  _discordBridges() {\n    return window.APP.hubChannel.discordBridges();\n  },\n\n  _updateUIOnStateChange(e) {\n    if (e.detail !== \"frozen\") return;\n    this._updateUI();\n  },\n\n  _updateUI() {\n    const { fileIsOwned, fileId } = this.targetEl.components[\"media-loader\"].data;\n    const canPin =\n      window.APP.hubChannel.can(\"pin_objects\") && !!(fileIsOwned || (fileId && getPromotionTokenForFile(fileId)));\n    this.el.object3D.visible = canPin;\n    this.labelEl.object3D.visible = canPin;\n\n    const isPinned = this.targetEl.getAttribute(\"pinnable\") && this.targetEl.getAttribute(\"pinnable\").pinned;\n    const discordBridges = this._discordBridges();\n    this.tipEl.object3D.visible = !!(canPin && !isPinned && this.hovering && discordBridges.length > 0);\n\n    if (!canPin) return;\n    this.labelEl.setAttribute(\"text\", \"value\", isPinned ? \"un-pin\" : \"pin\");\n    this.el.setAttribute(\"text-button\", \"backgroundColor\", isPinned ? \"#fff\" : \"#ff3550\");\n    this.el.setAttribute(\"text-button\", \"backgroundHoverColor\", isPinned ? \"#bbb\" : \"#fc3545\");\n  }\n});\n","import { findAncestorWithComponent } from \"../utils/scene-graph\";\n\nAFRAME.registerComponent(\"unmute-video-button\", {\n  init() {\n    this.onClick = () => {\n      const videoEl = findAncestorWithComponent(this.el, \"media-video\");\n      const mediaVideo = videoEl.components[\"media-video\"];\n      if (!mediaVideo || !mediaVideo.video || !mediaVideo.videoMutedAt) return;\n\n      // iOS initially plays the sound and *then* mutes it, and sometimes a second video playing\n      // can break all sound in the app. (Likely a Safari bug.) Adding a delay before the unmute\n      // occurs seems to help with reducing this.\n      if (performance.now() - mediaVideo.videoMutedAt < 3000) {\n        return;\n      }\n\n      if (mediaVideo.video.muted) {\n        mediaVideo.video.muted = false;\n        this.el.setAttribute(\"visible\", false);\n      }\n    };\n  },\n\n  play() {\n    // Safari won't accept grab-start or even mousedown as user-initiated gestures,\n    // so we have to use a global touchstart event here.\n    document.addEventListener(\"touchstart\", this.onClick);\n  },\n\n  pause() {\n    document.removeEventListener(\"touchstart\", this.onClick);\n  }\n});\n","import { getLastWorldPosition } from \"../utils/three-utils\";\n\nAFRAME.registerComponent(\"destroy-at-extreme-distances\", {\n  schema: {\n    xMin: { default: -1000 },\n    xMax: { default: 1000 },\n    yMin: { default: -1000 },\n    yMax: { default: 1000 },\n    zMin: { default: -1000 },\n    zMax: { default: 1000 }\n  },\n\n  init() {\n    this._checkForDestroy = this._checkForDestroy.bind(this);\n    this.el.sceneEl.systems[\"frame-scheduler\"].schedule(this._checkForDestroy, \"media-components\");\n  },\n\n  remove() {\n    this.el.sceneEl.systems[\"frame-scheduler\"].unschedule(this._checkForDestroy, \"media-components\");\n  },\n\n  _checkForDestroy: (function() {\n    const pos = new THREE.Vector3();\n    return function() {\n      const { xMin, xMax, yMin, yMax, zMin, zMax } = this.data;\n      getLastWorldPosition(this.el.object3D, pos);\n\n      if (pos.x < xMin || pos.x > xMax || pos.y < yMin || pos.y > yMax || pos.z < zMin || pos.z > zMax) {\n        if (!this.el.components.networked || NAF.utils.isMine(this.el)) {\n          this.el.parentNode.removeChild(this.el);\n        }\n      }\n    };\n  })()\n});\n","import { addAndArrangeMedia } from \"../utils/media-utils\";\nimport { createImageBitmap } from \"../utils/image-bitmap-utils\";\nimport { ObjectTypes } from \"../object-types\";\nimport { paths } from \"../systems/userinput/paths\";\nimport { SOUND_CAMERA_TOOL_TOOK_SNAPSHOT, SOUND_CAMERA_TOOL_COUNTDOWN } from \"../systems/sound-effects-system\";\nimport { getAudioFeedbackScale } from \"./audio-feedback\";\n\nimport cameraModelSrc from \"../assets/camera_tool.glb\";\n\nconst cameraModelPromise = new Promise(resolve => new THREE.GLTFLoader().load(cameraModelSrc, resolve));\n\nconst pathsMap = {\n  \"player-right-controller\": {\n    takeSnapshot: paths.actions.rightHand.takeSnapshot\n  },\n  \"player-left-controller\": {\n    takeSnapshot: paths.actions.leftHand.takeSnapshot\n  },\n  cursor: {\n    takeSnapshot: paths.actions.cursor.takeSnapshot\n  }\n};\n\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\n\nconst VIEWFINDER_FPS = 6;\nconst VIDEO_FPS = 25;\n// Prefer h264 if available due to faster decoding speec on most platforms\nconst videoCodec = [\"h264\", \"vp9\", \"vp8\"].find(\n  codec => window.MediaRecorder && MediaRecorder.isTypeSupported(`video/webm; codecs=${codec}`)\n);\nconst videoMimeType = videoCodec ? `video/webm; codecs=${videoCodec}` : null;\nconst hasWebGL2 = !!document.createElement(\"canvas\").getContext(\"webgl2\");\nconst allowVideo = !!videoMimeType && hasWebGL2;\n\nconst CAPTURE_WIDTH = isMobileVR ? 640 : 1280;\nconst CAPTURE_HEIGHT = isMobileVR ? 360 : 720;\nconst RENDER_WIDTH = 1280;\nconst RENDER_HEIGHT = 720;\nconst CAPTURE_DURATIONS = allowVideo ? [0, 3, 7, 15, 30, 60, Infinity] : [0];\nconst DEFAULT_CAPTURE_DURATION = allowVideo ? 3 : 0;\nconst COUNTDOWN_DURATION = 3;\nconst VIDEO_LOOPS = 3; // Number of times to loop the videos we spawn before stopping them (for perf)\nconst MAX_DURATION_TO_LIMIT_LOOPS = 31; // Max duration for which we limit loops (eg GIFs vs long form videos)\n\nconst snapCanvas = document.createElement(\"canvas\");\n\nasync function pixelsToPNG(pixels, width, height) {\n  snapCanvas.width = width;\n  snapCanvas.height = height;\n  const context = snapCanvas.getContext(\"2d\");\n\n  const imageData = context.createImageData(width, height);\n  imageData.data.set(pixels);\n  const bitmap = await createImageBitmap(imageData);\n  context.scale(1, -1);\n  context.drawImage(bitmap, 0, -height);\n  const blob = await new Promise(resolve => snapCanvas.toBlob(resolve));\n  return new File([blob], \"snap.png\", { type: \"image/png\" });\n}\n\nfunction blitFramebuffer(renderer, src, srcX0, srcY0, srcX1, srcY1, dest, dstX0, dstY0, dstX1, dstY1) {\n  const gl = renderer.context;\n\n  // Copies from one framebuffer to another. Note that at the end of this function, you need to restore\n  // the original framebuffer via setRenderTarget\n  const srcFramebuffer = renderer.properties.get(src).__webglFramebuffer;\n  const destFramebuffer = renderer.properties.get(dest).__webglFramebuffer;\n\n  if (srcFramebuffer && destFramebuffer) {\n    gl.bindFramebuffer(gl.READ_FRAMEBUFFER, srcFramebuffer);\n    gl.bindFramebuffer(gl.DRAW_FRAMEBUFFER, destFramebuffer);\n\n    if (gl.checkFramebufferStatus(gl.READ_FRAMEBUFFER) === gl.FRAMEBUFFER_COMPLETE) {\n      gl.blitFramebuffer(srcX0, srcY0, srcX1, srcY1, dstX0, dstY0, dstX1, dstY1, gl.COLOR_BUFFER_BIT, gl.LINEAR);\n    }\n  }\n}\n\nAFRAME.registerComponent(\"camera-tool\", {\n  schema: {\n    captureDuration: { default: DEFAULT_CAPTURE_DURATION },\n    captureAudio: { default: false },\n    isSnapping: { default: false },\n    isRecording: { default: false },\n    label: { default: \"\" }\n  },\n\n  init() {\n    this.lastUpdate = performance.now();\n    this.localSnapCount = 0; // Counter that is used to arrange photos/videos\n\n    this.showCameraViewfinder = !isMobileVR;\n\n    this.renderTarget = new THREE.WebGLRenderTarget(RENDER_WIDTH, RENDER_HEIGHT, {\n      format: THREE.RGBAFormat,\n      minFilter: THREE.LinearFilter,\n      magFilter: THREE.NearestFilter,\n      encoding: THREE.sRGBEncoding,\n      depth: false,\n      stencil: false\n    });\n\n    this.camera = new THREE.PerspectiveCamera(50, RENDER_WIDTH / RENDER_HEIGHT, 0.1, 30000);\n    this.camera.rotation.set(0, Math.PI, 0);\n    this.camera.position.set(0, 0, 0.05);\n    this.camera.matrixNeedsUpdate = true;\n    this.el.setObject3D(\"camera\", this.camera);\n\n    const material = new THREE.MeshBasicMaterial({\n      map: this.renderTarget.texture\n    });\n\n    // Bit of a hack here to only update the renderTarget when the screens are in view\n    material.map.isVideoTexture = true;\n    material.map.update = () => {\n      if (this.showCameraViewfinder) {\n        this.viewfinderInViewThisFrame = true;\n      }\n    };\n\n    this.el.sceneEl.addEventListener(\"stateadded\", () => this.updateUI());\n    this.el.sceneEl.addEventListener(\"stateremoved\", () => this.updateUI());\n\n    cameraModelPromise.then(model => {\n      const mesh = model.scene.clone();\n      mesh.scale.set(2, 2, 2);\n      mesh.matrixNeedsUpdate = true;\n      this.el.setObject3D(\"mesh\", mesh);\n\n      const width = 0.28;\n      const geometry = new THREE.PlaneBufferGeometry(width, width / this.camera.aspect);\n\n      const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\n      if (environmentMapComponent) {\n        environmentMapComponent.applyEnvironmentMap(this.el.object3D);\n      }\n\n      this.screen = new THREE.Mesh(geometry, material);\n      this.screen.rotation.set(0, Math.PI, 0);\n      this.screen.position.set(0, 0, -0.042);\n      this.screen.matrixNeedsUpdate = true;\n      this.el.setObject3D(\"screen\", this.screen);\n\n      this.selfieScreen = new THREE.Mesh(geometry, material);\n      this.selfieScreen.position.set(0, 0.4, 0);\n      this.selfieScreen.scale.set(-2, 2, 2);\n      this.selfieScreen.matrixNeedsUpdate = true;\n      this.el.setObject3D(\"selfieScreen\", this.selfieScreen);\n\n      this.label = this.el.querySelector(\".label\");\n      this.labelActionBackground = this.el.querySelector(\".label-action-background\");\n      this.labelBackground = this.el.querySelector(\".label-background\");\n      this.durationLabel = this.el.querySelector(\".duration\");\n\n      this.snapIcon = this.el.querySelector(\".snap-icon\");\n      this.recordIcon = this.el.querySelector(\".record-icon\");\n      this.recordAlphaIcon = this.el.querySelector(\".record-alpha-icon\");\n\n      this.label.object3D.visible = false;\n      this.durationLabel.object3D.visible = false;\n\n      this.snapMenu = this.el.querySelector(\".camera-snap-menu\");\n      this.playerCamera = document.querySelector(\"#player-camera\").getObject3D(\"camera\");\n      this.snapButton = this.el.querySelector(\".snap-button\");\n      this.cancelButton = this.el.querySelector(\".cancel-button\");\n      this.nextDurationButton = this.el.querySelector(\".next-duration\");\n      this.prevDurationButton = this.el.querySelector(\".prev-duration\");\n      this.snapButton.object3D.addEventListener(\"interact\", () => this.snapClicked());\n      this.cancelButton.object3D.addEventListener(\"interact\", () => this.cancelSnapping());\n      this.nextDurationButton.object3D.addEventListener(\"interact\", () => this.changeDuration(1));\n      this.prevDurationButton.object3D.addEventListener(\"interact\", () => this.changeDuration(-1));\n      this.stopButton = this.el.querySelector(\".stop-button\");\n      this.stopButton.object3D.addEventListener(\"interact\", () => this.stopRecording());\n      this.captureAudioButton = this.el.querySelector(\".capture-audio\");\n      this.captureAudioIcon = this.el.querySelector(\".capture-audio-icon\");\n      this.captureAudioButton.object3D.addEventListener(\"interact\", () =>\n        this.el.setAttribute(\"camera-tool\", \"captureAudio\", !this.data.captureAudio)\n      );\n\n      this.updateUI();\n\n      this.updateRenderTargetNextTick = true;\n\n      this.cameraSystem = this.el.sceneEl.systems[\"camera-tools\"];\n      this.cameraSystem.register(this.el);\n    });\n  },\n\n  remove() {\n    this.cameraSystem.deregister(this.el);\n    this.el.sceneEl.emit(\"camera_removed\");\n    this.stopRecording();\n  },\n\n  updateViewfinder() {\n    this.updateRenderTargetNextTick = true;\n  },\n\n  changeDuration(delta) {\n    const idx = CAPTURE_DURATIONS.findIndex(d => this.data.captureDuration == d);\n    const newIdx = idx === 0 && delta === -1 ? CAPTURE_DURATIONS.length - 1 : (idx + delta) % CAPTURE_DURATIONS.length;\n    this.el.setAttribute(\"camera-tool\", \"captureDuration\", CAPTURE_DURATIONS[newIdx]);\n  },\n\n  focus(el, track) {\n    if (track) {\n      this.trackTarget = el;\n    } else {\n      this.trackTarget = null;\n    }\n\n    this.lookAt(el);\n  },\n\n  lookAt: (function() {\n    const targetPos = new THREE.Vector3();\n    return function(el) {\n      targetPos.setFromMatrixPosition(el.object3D.matrixWorld);\n      this.el.object3D.lookAt(targetPos);\n      this.el.object3D.matrixNeedsUpdate = true;\n    };\n  })(),\n\n  snapClicked() {\n    if (this.data.isSnapping) return;\n    if (!NAF.utils.isMine(this.el) && !NAF.utils.takeOwnership(this.el)) return;\n\n    this.el.setAttribute(\"camera-tool\", \"isSnapping\", true);\n    this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_COUNTDOWN);\n\n    this.snapCountdown = COUNTDOWN_DURATION;\n    this.el.setAttribute(\"camera-tool\", \"label\", `${this.snapCountdown}`);\n\n    this.countdownInterval = setInterval(async () => {\n      if (!NAF.utils.isMine(this.el) && !NAF.utils.takeOwnership(this.el)) {\n        clearInterval(this.countdownInterval);\n        this.countdownInterval = null;\n        return;\n      }\n\n      this.snapCountdown--;\n\n      if (this.snapCountdown === 0) {\n        clearInterval(this.countdownInterval);\n        this.countdownInterval = null;\n\n        if (this.data.captureDuration === 0) {\n          this.el.setAttribute(\"camera-tool\", { label: \"\", isSnapping: false });\n          this.takeSnapshotNextTick = true;\n        } else {\n          this.beginRecording(this.data.captureDuration);\n        }\n      } else {\n        this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_COUNTDOWN);\n        this.el.setAttribute(\"camera-tool\", \"label\", `${this.snapCountdown}`);\n      }\n    }, 1000);\n  },\n\n  cancelSnapping() {\n    clearInterval(this.countdownInterval);\n    this.stopRecording(true);\n    this.updateUI();\n  },\n\n  update() {\n    this.updateUI();\n  },\n\n  updateUI() {\n    if (!this.label) return;\n\n    const label = this.data.label;\n    const isFrozen = this.el.sceneEl.is(\"frozen\");\n    const hasDuration = this.data.captureDuration !== 0 && this.data.captureDuration !== Infinity;\n    const isPhoto = this.data.captureDuration === 0;\n\n    const isRecordingUnbound = !hasDuration && this.data.isRecording && this.videoRecorder;\n    this.label.object3D.visible = !!label && !isRecordingUnbound;\n    const showActionLabelBackground = this.label.object3D.visible && this.data.isRecording && !isRecordingUnbound;\n\n    if (label) {\n      this.label.setAttribute(\"text\", { value: label, color: showActionLabelBackground ? \"#fafafa\" : \"#ff3464\" });\n    }\n\n    this.labelActionBackground.object3D.visible = showActionLabelBackground;\n    this.labelBackground.object3D.visible = this.label.object3D.visible && !showActionLabelBackground;\n\n    this.stopButton.object3D.visible = isRecordingUnbound;\n\n    if (hasDuration) {\n      this.durationLabel.setAttribute(\"text\", \"value\", `${this.data.captureDuration}`);\n    }\n\n    this.durationLabel.object3D.visible = hasDuration && !this.data.isSnapping && !isFrozen;\n    this.recordIcon.object3D.visible = !hasDuration && !isPhoto && !isFrozen;\n    this.recordAlphaIcon.object3D.visible = hasDuration && !isPhoto && !isFrozen;\n    this.snapIcon.object3D.visible = isPhoto && !isFrozen;\n    this.snapButton.object3D.visible = !this.data.isSnapping && !isFrozen;\n    this.cancelButton.object3D.visible = this.data.isSnapping && !isFrozen;\n    this.prevDurationButton.object3D.visible = this.nextDurationButton.object3D.visible =\n      !this.data.isSnapping && allowVideo && !isFrozen;\n\n    this.captureAudioIcon.setAttribute(\"icon-button\", \"active\", this.data.captureAudio);\n  },\n\n  async beginRecording(duration) {\n    if (!this.videoContext) {\n      this.videoCanvas = document.createElement(\"canvas\");\n      this.videoCanvas.width = CAPTURE_WIDTH;\n      this.videoCanvas.height = CAPTURE_HEIGHT;\n      this.videoContext = this.videoCanvas.getContext(\"2d\");\n      this.videoImageData = this.videoContext.createImageData(CAPTURE_WIDTH, CAPTURE_HEIGHT);\n      this.videoPixels = new Uint8Array(CAPTURE_WIDTH * CAPTURE_HEIGHT * 4);\n      this.videoImageData.data.set(this.videoPixels);\n    }\n\n    const stream = new MediaStream();\n    const track = this.videoCanvas.captureStream(VIDEO_FPS).getVideoTracks()[0];\n\n    if (this.data.captureAudio) {\n      const selfAudio = await NAF.connection.adapter.getMediaStream(NAF.clientId, \"audio\");\n\n      // NOTE: if we don't have a self audio track, we can end up generating an empty video (browser bug?)\n      // if no audio comes through on the listener source. (Eg the room is otherwise silent.)\n      // So for now, if we don't have a track, just disable audio capture.\n      if (selfAudio && selfAudio.getAudioTracks().length > 0) {\n        const context = THREE.AudioContext.getContext();\n        const destination = context.createMediaStreamDestination();\n\n        const listener = this.el.sceneEl.audioListener;\n        if (listener) {\n          // NOTE audio is not captured from camera vantage point for now.\n          listener.getInput().connect(destination);\n        }\n        context.createMediaStreamSource(selfAudio).connect(destination);\n\n        const audio = destination.stream.getAudioTracks()[0];\n        stream.addTrack(audio);\n      }\n    }\n\n    stream.addTrack(track);\n    this.videoRecorder = new MediaRecorder(stream, { mimeType: videoMimeType });\n    const chunks = [];\n    const recordingStartTime = performance.now();\n\n    this.videoRecorder.ondataavailable = e => chunks.push(e.data);\n\n    this.updateRenderTargetNextTick = true;\n\n    this.videoRecorder.start();\n    this.el.setAttribute(\"camera-tool\", { isRecording: true, label: \" \" });\n    this.el.sceneEl.emit(\"action_camera_recording_started\");\n\n    if (duration !== Infinity) {\n      this.videoCountdown = this.data.captureDuration;\n      this.el.setAttribute(\"camera-tool\", \"label\", `${this.videoCountdown}`);\n\n      this.videoCountdownInterval = setInterval(() => {\n        this.videoCountdown--;\n\n        if (this.videoCountdown === 0) {\n          this.stopRecording();\n          this.videoCountdownInterval = null;\n        } else {\n          this.el.setAttribute(\"camera-tool\", \"label\", `${this.videoCountdown}`);\n        }\n      }, 1000);\n    }\n\n    this.videoRecorder._free = () => (chunks.length = 0); // Used for cancelling\n    this.videoRecorder.onstop = async () => {\n      this.el.sceneEl.emit(\"action_camera_recording_ended\");\n\n      if (chunks.length === 0) return;\n      const mimeType = chunks[0].type;\n      const recordingDuration = performance.now() - recordingStartTime;\n      const blob = new Blob(chunks, { type: mimeType });\n\n      chunks.length = 0;\n\n      const { entity, orientation } = addAndArrangeMedia(\n        this.el,\n        new File([blob], \"capture\", { type: mimeType.split(\";\")[0] }), // Drop codec\n        \"video-camera\",\n        this.localSnapCount,\n        !!this.playerIsBehindCamera\n      );\n\n      entity.addEventListener(\n        \"video-loaded\",\n        () => {\n          // If we were recording audio, then pause the video immediately after starting.\n          //\n          // Or, to limit the # of concurrent videos playing, if it was a short clip, let it loop\n          // a few times and then pause it.\n          if (this.data.captureAudio || recordingDuration <= MAX_DURATION_TO_LIMIT_LOOPS * 1000) {\n            setTimeout(() => {\n              if (!NAF.utils.isMine(entity) && !NAF.utils.takeOwnership(entity)) return;\n              entity.components[\"media-video\"].tryUpdateVideoPlaybackState(true);\n            }, this.data.captureAudio ? 0 : recordingDuration * VIDEO_LOOPS + 100);\n          }\n        },\n        { once: true }\n      );\n\n      this.localSnapCount++;\n\n      orientation.then(() => this.el.sceneEl.emit(\"object_spawned\", { objectType: ObjectTypes.CAMERA }));\n    };\n  },\n\n  stopRecording(cancel) {\n    if (this.videoRecorder) {\n      if (cancel) {\n        this.videoRecorder.onstop = () => {};\n        this.videoRecorder._free();\n      }\n\n      this.videoRecorder.stop();\n      this.videoRecorder = null;\n\n      if (!cancel) {\n        this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_TOOK_SNAPSHOT);\n      }\n    }\n    clearInterval(this.videoCountdownInterval);\n\n    this.videoCountdownInterval = null;\n    this.el.setAttribute(\"camera-tool\", \"label\", \"\");\n    this.el.setAttribute(\"camera-tool\", { isRecording: false, isSnapping: false });\n  },\n\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const heldLeftHand = interaction.state.leftHand.held === this.el;\n    const heldRightHand = interaction.state.rightHand.held === this.el;\n    const heldRightRemote = interaction.state.rightRemote.held === this.el;\n\n    const heldThisFrame =\n      (heldLeftHand && userinput.get(interaction.options.leftHand.grabPath)) ||\n      (heldRightHand && userinput.get(interaction.options.rightHand.grabPath)) ||\n      (heldRightRemote && userinput.get(interaction.options.rightRemote.grabPath));\n\n    const isHolding = heldLeftHand || heldRightHand || heldRightRemote;\n\n    this.updateSnapMenuOrientation();\n\n    if (heldThisFrame) {\n      this.localSnapCount = 0;\n    }\n\n    this.showCameraViewfinder = isHolding || !isMobileVR || this.data.isSnapping || this.videoRecorder;\n\n    if (this.screen && this.selfieScreen) {\n      this.screen.visible = this.selfieScreen.visible = !!this.showCameraViewfinder;\n    }\n\n    // Always draw held, snapping, or recording camera viewfinders with a decent framerate\n    if (\n      (isHolding || this.data.isSnapping || this.videoRecorder) &&\n      performance.now() - this.lastUpdate >= 1000 / (this.videoRecorder ? VIDEO_FPS : VIEWFINDER_FPS)\n    ) {\n      this.updateRenderTargetNextTick = true;\n    }\n\n    const isHoldingTrigger = this.isHoldingSnapshotTrigger();\n    const isPermittedToUse = window.APP.hubChannel.can(\"spawn_camera\");\n\n    if (isPermittedToUse) {\n      // If the user lets go of the trigger before 500ms, take a picture, otherwise record until they let go.\n      if (isHoldingTrigger && !this.data.isSnapping && !this.snapTriggerTimeout) {\n        this.snapTriggerTimeout = setTimeout(() => {\n          if (this.isHoldingSnapshotTrigger()) {\n            this.el.setAttribute(\"camera-tool\", \"isSnapping\", true);\n            this.beginRecording(Infinity);\n\n            const releaseInterval = setInterval(() => {\n              if (this.isHoldingSnapshotTrigger()) return;\n              this.stopRecording();\n              clearInterval(releaseInterval);\n            }, 500);\n          }\n\n          this.snapTriggerTimeout = null;\n        }, 500);\n      } else if (!isHoldingTrigger && !this.data.isSnapping && this.snapTriggerTimeout) {\n        clearTimeout(this.snapTriggerTimeout);\n        this.snapTriggerTimeout = null;\n        this.takeSnapshotNextTick = true;\n      }\n    }\n  },\n\n  tock: (function() {\n    const tempHeadScale = new THREE.Vector3();\n\n    return function tock() {\n      const sceneEl = this.el.sceneEl;\n      const renderer = this.renderer || sceneEl.renderer;\n      const now = performance.now();\n      const playerHead = this.cameraSystem.playerHead;\n\n      // Perform lookAt in tock so it will re-orient after grabs, etc.\n      if (this.trackTarget) {\n        if (this.trackTarget.parentNode) {\n          this.lookAt(this.trackTarget);\n        } else {\n          this.trackTarget = null; // Target removed\n        }\n      }\n\n      if (!this.playerHud) {\n        const hudEl = document.getElementById(\"player-hud\");\n        this.playerHud = hudEl && hudEl.object3D;\n      }\n\n      if (\n        this.takeSnapshotNextTick ||\n        (this.updateRenderTargetNextTick && (this.viewfinderInViewThisFrame || this.videoRecorder))\n      ) {\n        if (playerHead) {\n          tempHeadScale.copy(playerHead.scale);\n\n          // We want to scale our own head in between frames now that we're taking a video/photo.\n          let scale = 1;\n          // TODO: The local-audio-analyser has the non-networked media stream, which is active\n          // even while the user is muted. This should be looking at a different analyser that\n          // has the networked media stream instead.\n          const analyser = this.el.sceneEl.systems[\"local-audio-analyser\"];\n\n          if (analyser && playerHead.el.components[\"scale-audio-feedback\"]) {\n            scale = getAudioFeedbackScale(this.el.object3D, playerHead, 1, 2, analyser.volume);\n          }\n\n          playerHead.scale.set(scale, scale, scale);\n          playerHead.updateMatrices(true, true);\n          playerHead.updateMatrixWorld(true, true);\n        }\n\n        let playerHudWasVisible = false;\n\n        if (this.playerHud) {\n          playerHudWasVisible = this.playerHud.visible;\n          this.playerHud.visible = false;\n          if (this.el.sceneEl.systems[\"post-physics\"]) {\n            this.el.sceneEl.systems[\"post-physics\"].spriteSystem.mesh.visible = false;\n          }\n        }\n\n        const tmpVRFlag = renderer.vr.enabled;\n        const tmpOnAfterRender = sceneEl.object3D.onAfterRender;\n        delete sceneEl.object3D.onAfterRender;\n        renderer.vr.enabled = false;\n\n        if (allowVideo && this.videoRecorder && !this.videoRenderTarget) {\n          // Create a separate render target for video becuase we need to flip and (sometimes) downscale it before\n          // encoding it to video.\n          this.videoRenderTarget = new THREE.WebGLRenderTarget(CAPTURE_WIDTH, CAPTURE_HEIGHT, {\n            format: THREE.RGBAFormat,\n            minFilter: THREE.LinearFilter,\n            magFilter: THREE.NearestFilter,\n            encoding: THREE.sRGBEncoding,\n            depth: false,\n            stencil: false\n          });\n\n          // Used to set up framebuffer in three.js as a side effect\n          renderer.setRenderTarget(this.videoRenderTarget);\n        }\n\n        renderer.setRenderTarget(this.renderTarget);\n        renderer.render(sceneEl.object3D, this.camera);\n        renderer.setRenderTarget(null);\n\n        renderer.vr.enabled = tmpVRFlag;\n        sceneEl.object3D.onAfterRender = tmpOnAfterRender;\n        if (playerHead) {\n          playerHead.scale.copy(tempHeadScale);\n          playerHead.updateMatrices(true, true);\n          playerHead.updateMatrixWorld(true, true);\n        }\n        if (this.playerHud) {\n          this.playerHud.visible = playerHudWasVisible;\n          if (this.el.sceneEl.systems[\"post-physics\"]) {\n            this.el.sceneEl.systems[\"post-physics\"].spriteSystem.mesh.visible = true;\n          }\n        }\n        this.lastUpdate = now;\n\n        if (this.videoRecorder) {\n          // This blit operation will (if necessary) scale/resample the view finder render target and, importantly,\n          // flip the texture on Y\n          blitFramebuffer(\n            renderer,\n            this.renderTarget,\n            0,\n            0,\n            RENDER_WIDTH,\n            RENDER_HEIGHT,\n            this.videoRenderTarget,\n            0,\n            CAPTURE_HEIGHT,\n            CAPTURE_WIDTH,\n            0\n          );\n          renderer.readRenderTargetPixels(\n            this.videoRenderTarget,\n            0,\n            0,\n            CAPTURE_WIDTH,\n            CAPTURE_HEIGHT,\n            this.videoPixels\n          );\n          this.videoImageData.data.set(this.videoPixels);\n          this.videoContext.putImageData(this.videoImageData, 0, 0);\n        }\n\n        this.updateRenderTargetNextTick = false;\n        this.viewfinderInViewThisFrame = false;\n      }\n\n      if (this.takeSnapshotNextTick) {\n        if (!this.snapPixels) {\n          this.snapPixels = new Uint8Array(RENDER_WIDTH * RENDER_HEIGHT * 4);\n        }\n        renderer.readRenderTargetPixels(this.renderTarget, 0, 0, RENDER_WIDTH, RENDER_HEIGHT, this.snapPixels);\n\n        pixelsToPNG(this.snapPixels, RENDER_WIDTH, RENDER_HEIGHT).then(file => {\n          const { orientation } = addAndArrangeMedia(\n            this.el,\n            file,\n            \"photo-camera\",\n            this.localSnapCount,\n            !!this.playerIsBehindCamera\n          );\n\n          orientation.then(() => {\n            this.el.sceneEl.emit(\"object_spawned\", { objectType: ObjectTypes.CAMERA });\n          });\n        });\n        sceneEl.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CAMERA_TOOL_TOOK_SNAPSHOT);\n        this.takeSnapshotNextTick = false;\n        this.localSnapCount++;\n      }\n    };\n  })(),\n\n  isHoldingSnapshotTrigger: function() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const heldLeftHand = interaction.state.leftHand.held === this.el;\n    const heldRightHand = interaction.state.rightHand.held === this.el;\n    const heldRightRemote = interaction.state.rightRemote.held === this.el;\n\n    let grabberId;\n    if (heldRightHand) {\n      grabberId = \"player-right-controller\";\n    } else if (heldLeftHand) {\n      grabberId = \"player-left-controller\";\n    } else if (heldRightRemote) {\n      grabberId = \"cursor\";\n    }\n\n    if (grabberId) {\n      const grabberPaths = pathsMap[grabberId];\n      if (userinput.get(grabberPaths.takeSnapshot)) {\n        return true;\n      }\n    }\n\n    return !!userinput.get(paths.actions.takeSnapshot);\n  },\n\n  updateSnapMenuOrientation: (function() {\n    const playerWorld = new THREE.Vector3();\n    const cameraWorld = new THREE.Vector3();\n    const playerToCamera = new THREE.Vector3();\n    const cameraForwardPoint = new THREE.Vector3();\n    const cameraForwardWorld = new THREE.Vector3();\n    return function() {\n      this.el.object3D.getWorldPosition(cameraWorld);\n      this.playerCamera.getWorldPosition(playerWorld);\n      playerToCamera.subVectors(playerWorld, cameraWorld);\n      cameraForwardPoint.set(0, 0, 1);\n      this.el.object3D.localToWorld(cameraForwardPoint);\n      cameraForwardWorld.subVectors(cameraForwardPoint, cameraWorld);\n      cameraForwardWorld.normalize();\n      playerToCamera.normalize();\n\n      const playerIsBehindCamera = cameraForwardWorld.dot(playerToCamera) < 0;\n\n      if (this.playerIsBehindCamera !== playerIsBehindCamera) {\n        this.playerIsBehindCamera = playerIsBehindCamera;\n        this.snapMenu.object3D.rotation.set(0, this.playerIsBehindCamera ? Math.PI : 0, 0);\n        this.snapMenu.object3D.matrixNeedsUpdate = true;\n      }\n    };\n  })()\n});\n","import { addMedia } from \"../utils/media-utils\";\nimport { ObjectContentOrigins } from \"../object-types\";\nimport { guessContentType } from \"../utils/media-url-utils\";\n\nAFRAME.registerComponent(\"clone-media-button\", {\n  init() {\n    this.updateSrc = () => {\n      const src = (this.src = this.targetEl.components[\"media-loader\"].data.src);\n      const visible = src && guessContentType(src) !== \"video/vnd.hubs-webrtc\";\n      this.el.object3D.visible = !!visible;\n    };\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n      this.targetEl.addEventListener(\"media_resolved\", this.updateSrc, { once: true });\n      this.updateSrc();\n    });\n\n    this.onClick = () => {\n      const src = this.src;\n      const { contentSubtype, resize } = this.targetEl.components[\"media-loader\"].data;\n      const { entity } = addMedia(src, \"#interactable-media\", ObjectContentOrigins.URL, contentSubtype, true, resize);\n\n      entity.object3D.matrixNeedsUpdate = true;\n\n      entity.setAttribute(\"offset-relative-to\", {\n        target: \"#player-camera\",\n        offset: { x: 0, y: 0, z: -1.5 }\n      });\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","import { isHubsSceneUrl, isHubsRoomUrl, isHubsAvatarUrl } from \"../utils/media-url-utils\";\nimport { guessContentType } from \"../utils/media-url-utils\";\n\nAFRAME.registerComponent(\"open-media-button\", {\n  init() {\n    this.label = this.el.querySelector(\"[text]\");\n\n    this.updateSrc = () => {\n      const src = (this.src = this.targetEl.components[\"media-loader\"].data.src);\n      const visible = src && guessContentType(src) !== \"video/vnd.hubs-webrtc\";\n      const mayChangeScene = this.el.sceneEl.systems.permissions.canOrWillIfCreator(\"update_hub\");\n\n      this.el.object3D.visible = !!visible;\n\n      if (visible) {\n        let label = \"open link\";\n        if (isHubsAvatarUrl(src)) {\n          label = \"use avatar\";\n        } else if (isHubsSceneUrl(src) && mayChangeScene) {\n          label = \"use scene\";\n        } else if (isHubsRoomUrl(src)) {\n          label = \"visit room\";\n        }\n        this.label.setAttribute(\"text\", \"value\", label);\n      }\n    };\n\n    this.onClick = () => {\n      const mayChangeScene = this.el.sceneEl.systems.permissions.canOrWillIfCreator(\"update_hub\");\n\n      if (isHubsAvatarUrl(this.src)) {\n        const avatarId = new URL(this.src).pathname.split(\"/\").pop();\n        window.APP.store.update({ profile: { avatarId } });\n      } else if (isHubsSceneUrl(this.src) && mayChangeScene) {\n        this.el.sceneEl.emit(\"scene_media_selected\", this.src);\n      } else if (isHubsRoomUrl(this.src)) {\n        location.href = this.src;\n      } else {\n        window.open(this.src);\n      }\n    };\n\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n      this.targetEl.addEventListener(\"media_resolved\", this.updateSrc, { once: true });\n      this.updateSrc();\n    });\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onClick);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onClick);\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\nconst AMMO_BODY_ATTRIBUTES = { type: \"kinematic\", collisionFilterMask: COLLISION_LAYERS.HANDS };\n\nconst TRANSFORM_MODE = {\n  AXIS: \"axis\",\n  PUPPET: \"puppet\",\n  CURSOR: \"cursor\",\n  ALIGN: \"align\",\n  SCALE: \"scale\"\n};\n\nconst SCALE_SENSITIVITY = 100;\nconst MIN_SCALE = 0.1;\nconst MAX_SCALE = 100;\n\nconst STEP_LENGTH = Math.PI / 10;\nconst CAMERA_WORLD_QUATERNION = new THREE.Quaternion();\nconst CAMERA_WORLD_POSITION = new THREE.Vector3();\nconst TARGET_WORLD_QUATERNION = new THREE.Quaternion();\nconst v = new THREE.Vector3();\nconst v2 = new THREE.Vector3();\nconst q = new THREE.Quaternion();\nconst q2 = new THREE.Quaternion();\n\nAFRAME.registerComponent(\"transform-button\", {\n  schema: {\n    mode: {\n      type: \"string\",\n      oneof: Object.values(TRANSFORM_MODE),\n      default: TRANSFORM_MODE.CURSOR\n    },\n    axis: { type: \"vec3\", default: null }\n  },\n  init() {\n    NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n      this.targetEl = networkedEl;\n    });\n    const rightHand = document.querySelector(\"#player-right-controller\");\n    this.onGrabStart = e => {\n      if (!this.targetEl) {\n        return;\n      }\n      if (!NAF.utils.isMine(this.targetEl) && !NAF.utils.takeOwnership(this.targetEl)) {\n        return;\n      }\n      if (this.targetEl.body) {\n        this.targetEl.setAttribute(\"ammo-body\", AMMO_BODY_ATTRIBUTES);\n      }\n      this.transformSystem = this.transformSystem || AFRAME.scenes[0].systems[\"transform-selected-object\"];\n      this.transformSystem.startTransform(\n        this.targetEl.object3D,\n        e.object3D.el.id === \"cursor\" ? rightHand.object3D : e.object3D,\n        this.data\n      );\n    };\n    this.onGrabEnd = () => {\n      this.transformSystem = this.transformSystem || AFRAME.scenes[0].systems[\"transform-selected-object\"];\n      this.transformSystem.stopTransform();\n    };\n  },\n  play() {\n    this.el.object3D.addEventListener(\"interact\", this.onGrabStart);\n    this.el.object3D.addEventListener(\"holdable-button-down\", this.onGrabStart);\n    this.el.object3D.addEventListener(\"holdable-button-up\", this.onGrabEnd);\n  },\n  pause() {\n    this.el.object3D.removeEventListener(\"interact\", this.onGrabStart);\n    this.el.object3D.removeEventListener(\"holdable-button-down\", this.onGrabStart);\n    this.el.object3D.removeEventListener(\"holdable-button-up\", this.onGrabEnd);\n  }\n});\n\nAFRAME.registerSystem(\"transform-selected-object\", {\n  init() {\n    this.target = null;\n    this.mode = null;\n    this.transforming = false;\n    this.axis = new THREE.Vector3();\n    this.store = window.APP.store;\n\n    this.dxStore = 0;\n    this.dxApplied = 0;\n    this.dyAll = 0;\n    this.dyStore = 0;\n    this.dyApplied = 0;\n\n    this.puppet = {\n      initialControllerOrientation: new THREE.Quaternion(),\n      initialControllerOrientation_inverse: new THREE.Quaternion(),\n      initialObjectOrientation: new THREE.Quaternion(),\n      currentControllerOrientation: new THREE.Quaternion(),\n      controllerOrientationDelta: new THREE.Quaternion()\n    };\n\n    this.planarInfo = {\n      plane: new THREE.Mesh(\n        new THREE.PlaneBufferGeometry(100000, 100000, 2, 2),\n        new THREE.MeshBasicMaterial({\n          visible: false,\n          wireframe: true,\n          side: THREE.DoubleSide,\n          transparent: true,\n          opacity: 0.3\n        })\n      ),\n      normal: new THREE.Vector3(),\n      intersections: [],\n      previousPointOnPlane: new THREE.Vector3(),\n      currentPointOnPlane: new THREE.Vector3(),\n      deltaOnPlane: new THREE.Vector3(),\n      finalProjectedVec: new THREE.Vector3()\n    };\n    this.el.object3D.add(this.planarInfo.plane);\n  },\n\n  stopTransform() {\n    this.transforming = false;\n  },\n\n  startPlaneCasting() {\n    const { plane, intersections, previousPointOnPlane } = this.planarInfo;\n\n    this.el.camera.getWorldQuaternion(CAMERA_WORLD_QUATERNION);\n    plane.quaternion.copy(CAMERA_WORLD_QUATERNION);\n    this.target.getWorldPosition(plane.position);\n    plane.matrixNeedsUpdate = true;\n    plane.updateMatrixWorld(true);\n\n    intersections.length = 0;\n    this.raycaster =\n      this.raycaster || document.querySelector(\"#cursor-controller\").components[\"cursor-controller\"].raycaster;\n    const far = this.raycaster.far;\n    this.raycaster.far = 1000;\n    plane.raycast(this.raycaster, intersections);\n    this.raycaster.far = far;\n    this.transforming = !!intersections[0];\n    if (!this.transforming) {\n      return;\n    }\n\n    previousPointOnPlane.copy(intersections[0].point);\n\n    this.target.getWorldQuaternion(TARGET_WORLD_QUATERNION);\n\n    v.set(0, 0, -1).applyQuaternion(CAMERA_WORLD_QUATERNION);\n    v2.set(0, 0, -1).applyQuaternion(TARGET_WORLD_QUATERNION);\n    this.sign = v.dot(v2) > 0 ? 1 : -1;\n\n    v.set(0, 1, 0); //.applyQuaternion(this.CAMERA_WORLD_QUATERNION);\n    v2.set(0, 1, 0).applyQuaternion(TARGET_WORLD_QUATERNION);\n    this.sign2 = v.dot(v2) > 0 ? 1 : -1;\n\n    this.dyAll = 0;\n    this.dyStore = 0;\n    this.dyApplied = 0;\n    this.dxAll = 0;\n    this.dxStore = 0;\n    this.dxApplied = 0;\n  },\n\n  startTransform(target, hand, data) {\n    this.target = target;\n    this.hand = hand;\n    this.mode = data.mode;\n    this.transforming = true;\n\n    if (this.mode === TRANSFORM_MODE.ALIGN) {\n      this.store.update({ activity: { hasRecentered: true } });\n      return;\n    } else if (this.mode === TRANSFORM_MODE.SCALE) {\n      this.store.update({ activity: { hasScaled: true } });\n    } else {\n      this.store.update({ activity: { hasRotated: true } });\n    }\n\n    if (this.mode === TRANSFORM_MODE.PUPPET) {\n      this.target.getWorldQuaternion(this.puppet.initialObjectOrientation);\n      this.hand.getWorldQuaternion(this.puppet.initialControllerOrientation);\n      this.puppet.initialControllerOrientation_inverse.copy(this.puppet.initialControllerOrientation).inverse();\n      return;\n    }\n\n    if (this.mode === TRANSFORM_MODE.AXIS) {\n      this.axis.copy(data.axis);\n    }\n\n    this.startPlaneCasting();\n  },\n\n  puppetingTick() {\n    // Find controller delta as a quaternion, then apply it to the object, snapping in fixed increments if desired:\n    // Snap to fixed angle increments by converting to an Euler,\n    // restricting the angles using Math.floor, and converting back to a quaternion.\n    const {\n      currentControllerOrientation,\n      controllerOrientationDelta,\n      initialControllerOrientation_inverse,\n      initialObjectOrientation\n    } = this.puppet;\n    this.hand.getWorldQuaternion(currentControllerOrientation);\n    controllerOrientationDelta.copy(initialControllerOrientation_inverse).premultiply(currentControllerOrientation);\n    this.target.quaternion.copy(initialObjectOrientation).premultiply(controllerOrientationDelta);\n    this.target.matrixNeedsUpdate = true;\n  },\n\n  cursorAxisOrScaleTick() {\n    const {\n      plane,\n      normal,\n      intersections,\n      previousPointOnPlane,\n      currentPointOnPlane,\n      deltaOnPlane,\n      finalProjectedVec\n    } = this.planarInfo;\n\n    this.target.getWorldPosition(plane.position);\n    this.el.camera.getWorldQuaternion(plane.quaternion);\n    plane.matrixNeedsUpdate = true;\n    const cameraToPlaneDistance = v.sub(plane.position).length();\n\n    intersections.length = 0;\n    const far = this.raycaster.far;\n    this.raycaster.far = 1000;\n    plane.raycast(this.raycaster, intersections);\n    this.raycaster.far = far;\n    const intersection = intersections[0]; // point\n    if (!intersection) return;\n\n    normal.set(0, 0, -1).applyQuaternion(plane.quaternion);\n\n    currentPointOnPlane.copy(intersection.point);\n    deltaOnPlane.copy(currentPointOnPlane).sub(previousPointOnPlane);\n    const SENSITIVITY = 10;\n    finalProjectedVec\n      .copy(deltaOnPlane)\n      .projectOnPlane(normal)\n      .applyQuaternion(q.copy(plane.quaternion).inverse())\n      .multiplyScalar(SENSITIVITY / cameraToPlaneDistance);\n    if (this.mode === TRANSFORM_MODE.CURSOR || this.mode === TRANSFORM_MODE.SCALE) {\n      const modify = AFRAME.scenes[0].systems.userinput.get(paths.actions.transformModifier);\n\n      this.dyAll = this.dyStore + finalProjectedVec.y;\n      this.dyApplied = modify ? this.dyAll : Math.round(this.dyAll / STEP_LENGTH) * STEP_LENGTH;\n      this.dyStore = this.dyAll - this.dyApplied;\n\n      this.dxAll = this.dxStore + finalProjectedVec.x;\n      this.dxApplied = modify ? this.dxAll : Math.round(this.dxAll / STEP_LENGTH) * STEP_LENGTH;\n      this.dxStore = this.dxAll - this.dxApplied;\n\n      if (this.mode === TRANSFORM_MODE.CURSOR) {\n        this.target.getWorldQuaternion(TARGET_WORLD_QUATERNION);\n        v.set(1, 0, 0).applyQuaternion(modify ? CAMERA_WORLD_QUATERNION : TARGET_WORLD_QUATERNION);\n        q.setFromAxisAngle(v, modify ? -this.dyApplied : this.sign2 * this.sign * -this.dyApplied);\n\n        if (modify) {\n          v.set(0, 1, 0).applyQuaternion(CAMERA_WORLD_QUATERNION);\n        } else {\n          v.set(0, 1, 0);\n        }\n        q2.setFromAxisAngle(v, this.dxApplied);\n\n        this.target.quaternion.premultiply(q).premultiply(q2);\n      } else {\n        const scaleFactor =\n          THREE.Math.clamp(finalProjectedVec.y + finalProjectedVec.x, -0.0005, 0.0005) * SCALE_SENSITIVITY;\n\n        const newScale = this.target.scale.x * (1.0 + scaleFactor);\n\n        if (newScale > MIN_SCALE && newScale < MAX_SCALE) {\n          this.target.scale.multiplyScalar(1.0 + scaleFactor);\n        }\n      }\n\n      this.target.matrixNeedsUpdate = true;\n    } else if (this.mode === TRANSFORM_MODE.AXIS) {\n      this.dxAll = this.dxStore + finalProjectedVec.x;\n      this.dxApplied = Math.round(this.dxAll / STEP_LENGTH) * STEP_LENGTH;\n      this.dxStore = this.dxAll - this.dxApplied;\n\n      this.target.quaternion.multiply(q.setFromAxisAngle(this.axis, -this.sign * this.dxApplied));\n      this.target.matrixNeedsUpdate = true;\n    }\n\n    previousPointOnPlane.copy(currentPointOnPlane);\n  },\n\n  tick() {\n    if (!this.transforming) {\n      return;\n    }\n\n    if (this.mode === TRANSFORM_MODE.ALIGN) {\n      this.el.camera.getWorldPosition(CAMERA_WORLD_POSITION);\n      this.target.lookAt(CAMERA_WORLD_POSITION);\n      this.transforming = false;\n      return;\n    }\n\n    if (this.mode === TRANSFORM_MODE.PUPPET) {\n      this.puppetingTick();\n      return;\n    }\n    this.cursorAxisOrScaleTick();\n  }\n});\n\nAFRAME.registerComponent(\"transform-button-selector\", {\n  tick() {\n    const hand = AFRAME.scenes[0].systems.userinput.get(paths.actions.rightHand.pose);\n    if (!hand) {\n      if (this.el.components[\"transform-button\"].data.mode !== TRANSFORM_MODE.CURSOR) {\n        this.el.setAttribute(\"transform-button\", \"mode\", TRANSFORM_MODE.CURSOR);\n      }\n    } else {\n      if (this.el.components[\"transform-button\"].data.mode !== TRANSFORM_MODE.PUPPET) {\n        this.el.setAttribute(\"transform-button\", \"mode\", TRANSFORM_MODE.PUPPET);\n      }\n    }\n  }\n});\n\nconst FORWARD = new THREE.Vector3(0, 0, 1);\nconst TWO_PI = 2 * Math.PI;\nAFRAME.registerComponent(\"visible-if-transforming\", {\n  init() {},\n  tick(t) {\n    const shouldBeVisible = AFRAME.scenes[0].systems[\"transform-selected-object\"].transforming;\n    const visibleNeedsUpdate = this.el.getAttribute(\"visible\") !== shouldBeVisible;\n    if (visibleNeedsUpdate) {\n      this.el.setAttribute(\"visible\", AFRAME.scenes[0].systems[\"transform-selected-object\"].transforming);\n    }\n\n    if (shouldBeVisible) {\n      this.el.object3D.quaternion.setFromAxisAngle(FORWARD, TWO_PI * Math.sin(t / 1000.0));\n      this.el.object3D.matrixNeedsUpdate = true;\n    }\n  }\n});\n","const CYLINDER_TEXTURE =\n  \"data:image/png;base64,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\";\n\nimport { SOUND_TELEPORT_START, SOUND_TELEPORT_END } from \"../systems/sound-effects-system\";\n\nfunction easeIn(t) {\n  return t * t;\n}\n\nfunction easeOutIn(t) {\n  if (t < 0.5) return 0.5 * ((t = t * 2 - 1) * t * t + 1);\n  return 0.5 * (t = t * 2 - 1) * t * t + 0.5;\n}\n\nconst RayCurve = function(numPoints, width) {\n  this.geometry = new THREE.BufferGeometry();\n  this.vertices = new Float32Array(numPoints * 3 * 2);\n  this.uvs = new Float32Array(numPoints * 2 * 2);\n  this.width = width;\n\n  this.geometry.addAttribute(\"position\", new THREE.BufferAttribute(this.vertices, 3).setDynamic(true));\n\n  this.material = new THREE.MeshBasicMaterial({\n    side: THREE.DoubleSide,\n    transparent: true\n  });\n\n  this.mesh = new THREE.Mesh(this.geometry, this.material);\n  this.mesh.drawMode = THREE.TriangleStripDrawMode;\n\n  this.mesh.frustumCulled = false;\n  this.mesh.vertices = this.vertices;\n\n  this.direction = new THREE.Vector3();\n  this.numPoints = numPoints;\n};\n\nRayCurve.prototype = {\n  setDirection: function(direction) {\n    const UP = new THREE.Vector3(0, 1, 0);\n    this.direction\n      .copy(direction)\n      .cross(UP)\n      .normalize()\n      .multiplyScalar(this.width / 2);\n  },\n\n  setWidth: function(width) {\n    this.width = width;\n  },\n\n  setPoint: (function() {\n    const posA = new THREE.Vector3();\n    const posB = new THREE.Vector3();\n\n    return function(i, point) {\n      posA.copy(point).add(this.direction);\n      posB.copy(point).sub(this.direction);\n\n      let idx = 2 * 3 * i;\n      this.vertices[idx++] = posA.x;\n      this.vertices[idx++] = posA.y;\n      this.vertices[idx++] = posA.z;\n\n      this.vertices[idx++] = posB.x;\n      this.vertices[idx++] = posB.y;\n      this.vertices[idx++] = posB.z;\n\n      this.geometry.attributes.position.needsUpdate = true;\n    };\n  })()\n};\n\nfunction parabolicCurve(p0, v0, t, out) {\n  out.x = p0.x + v0.x * t;\n  out.y = p0.y + v0.y * t - 4.9 * t * t;\n  out.z = p0.z + v0.z * t;\n  return out;\n}\n\nfunction isValidNormalsAngle(collisionNormal, referenceNormal, landingMaxAngle) {\n  const angleNormals = referenceNormal.angleTo(collisionNormal);\n  return THREE.Math.RAD2DEG * angleNormals <= landingMaxAngle;\n}\n\nconst checkLineIntersection = (function() {\n  const direction = new THREE.Vector3();\n  return function checkLineIntersection(start, end, meshes, raycaster, referenceNormal, landingMaxAngle, hitPoint) {\n    direction.copy(end).sub(start);\n    const distance = direction.length();\n    raycaster.far = distance;\n    raycaster.set(start, direction.normalize());\n    const intersects = raycaster.intersectObjects(meshes, true);\n    if (intersects.length > 0 && isValidNormalsAngle(intersects[0].face.normal, referenceNormal, landingMaxAngle)) {\n      hitPoint.copy(intersects[0].point);\n      return true;\n    }\n    return false;\n  };\n})();\n\nfunction getMeshes(collisionEntities) {\n  return collisionEntities\n    .map(function(entity) {\n      return entity.getObject3D(\"mesh\");\n    })\n    .filter(function(n) {\n      return n;\n    });\n}\n\nconst MISS_OPACITY = 0.1;\nconst HIT_OPACITY = 0.3;\nconst MISS_COLOR = 0xff0000;\nconst HIT_COLOR = 0x00ff00;\nconst FORWARD = new THREE.Vector3(0, 0, -1);\nconst LANDING_NORMAL = new THREE.Vector3(0, 1, 0);\nconst MAX_LANDING_ANGLE = 45;\nconst DRAW_TIME_MS = 400;\nconst q = new THREE.Quaternion();\nconst vecHelper = new THREE.Vector3();\n\nAFRAME.registerComponent(\"teleporter\", {\n  schema: {\n    start: { type: \"string\" },\n    confirm: { type: \"string\" },\n    speed: { default: 12 },\n    collisionEntities: { default: \"\" },\n    hitCylinderColor: { type: \"color\", default: \"#99ff99\" },\n    hitCylinderRadius: { default: 0.25, min: 0 },\n    outerRadius: { default: 0.6, min: 0 },\n    hitCylinderHeight: { default: 0.3, min: 0 }\n  },\n\n  init() {\n    this.isTeleporting = false;\n    this.rayCurve = new RayCurve(20, 0.025);\n    this.rayCurve.mesh.visible = false;\n    this.teleportEntity = document.createElement(\"a-entity\");\n    this.teleportEntity.setObject3D(\"mesh\", this.rayCurve.mesh);\n    this.el.sceneEl.appendChild(this.teleportEntity);\n\n    this.p0 = new THREE.Vector3();\n    this.v0 = new THREE.Vector3();\n    this.parabola = Array.from(new Array(this.rayCurve.numPoints), () => new THREE.Vector3());\n    this.hit = false;\n    this.hitPoint = new THREE.Vector3();\n    this.meshes = [];\n    this.raycaster = new THREE.Raycaster();\n    this.rigWorldPosition = new THREE.Vector3();\n    this.newRigWorldPosition = new THREE.Vector3();\n    this.teleportOriginWorldPosition = new THREE.Vector3();\n\n    this.teleportEventDetail = {\n      oldPosition: this.rigWorldPosition,\n      newPosition: this.newRigWorldPosition,\n      hitPoint: this.hitPoint\n    };\n    this.prevHitHeight = 0;\n    this.direction = new THREE.Vector3();\n    this.hitEntity = this.createHitEntity();\n    this.hitEntity.object3D.visible = false;\n    this.el.sceneEl.appendChild(this.hitEntity);\n    this.queryCollisionEntities();\n  },\n\n  queryCollisionEntities: function() {\n    this.collisionEntities = [].slice.call(this.el.sceneEl.querySelectorAll(this.data.collisionEntities));\n    this.meshes = getMeshes(this.collisionEntities);\n  },\n\n  remove() {\n    this.stopPlayingTeleportSound();\n  },\n\n  stopPlayingTeleportSound() {\n    if (this.teleportingSound) {\n      const sfx = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem;\n      sfx.stopSoundNode(this.teleportingSound.source);\n      this.teleportingSound = null;\n    }\n  },\n\n  tick(t, dt) {\n    if (!this.el.sceneEl.is(\"entered\")) return;\n    const sfx = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem;\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const { start, confirm, speed } = this.data;\n    const object3D = this.el.object3D;\n\n    if (!this.isTeleporting && userinput.get(start)) {\n      this.isTeleporting = true;\n      this.timeTeleporting = 0;\n      this.hit = false;\n      this.rayCurve.mesh.visible = true;\n      this.rayCurve.mesh.updateMatrixWorld();\n      this.rayCurve.mesh.material.opacity = MISS_OPACITY;\n      this.rayCurve.mesh.material.color.set(MISS_COLOR);\n      this.rayCurve.mesh.material.needsUpdate = true;\n      this.teleportingSound = sfx.playSoundLoopedWithGain(SOUND_TELEPORT_START);\n      if (this.teleportingSound) {\n        this.teleportingSound.gain.gain.value = 0.005;\n      }\n    }\n\n    if (!this.isTeleporting) {\n      return;\n    }\n    if (this.teleportingSound) {\n      this.teleportingSound.gain.gain.value = Math.min(0.025, this.teleportingSound.gain.gain.value + 0.00002 * dt);\n    }\n\n    if (userinput.get(confirm)) {\n      this.hitEntity.setAttribute(\"visible\", false);\n      this.isTeleporting = false;\n      this.rayCurve.mesh.visible = false;\n\n      if (this.teleportingSound) {\n        this.stopPlayingTeleportSound();\n      }\n\n      if (!this.hit || this.timeTeleporting < DRAW_TIME_MS) {\n        return;\n      }\n\n      this.characterController =\n        this.characterController || document.querySelector(\"#player-rig\").components[\"character-controller\"];\n      this.characterController.teleportTo(this.hitPoint);\n\n      sfx.playSoundOneShot(SOUND_TELEPORT_END);\n      return;\n    }\n\n    this.timeTeleporting += dt;\n    object3D.updateMatrixWorld();\n    object3D.matrixWorld.decompose(this.p0, q, vecHelper);\n    this.direction\n      .copy(FORWARD)\n      .applyQuaternion(q)\n      .normalize();\n    this.rayCurve.setDirection(this.direction);\n    this.v0.copy(this.direction).multiplyScalar(speed);\n\n    let collidedIndex = this.rayCurve.numPoints - 1;\n\n    this.hit = false;\n    this.parabola[0].copy(this.p0);\n    const timeSegment = 1 / (this.rayCurve.numPoints - 1);\n    for (let i = 1; i < this.rayCurve.numPoints; i++) {\n      const t = i * timeSegment;\n      parabolicCurve(this.p0, this.v0, t, vecHelper);\n      this.parabola[i].copy(vecHelper);\n\n      if (\n        checkLineIntersection(\n          this.parabola[i - 1],\n          this.parabola[i],\n          this.meshes,\n          this.raycaster,\n          LANDING_NORMAL,\n          MAX_LANDING_ANGLE,\n          this.hitPoint\n        )\n      ) {\n        this.hit = true;\n        collidedIndex = i;\n        break;\n      }\n    }\n\n    const percentToDraw = this.timeTeleporting > DRAW_TIME_MS ? 1 : this.timeTeleporting / DRAW_TIME_MS;\n    const percentRaycasted = collidedIndex / (this.rayCurve.numPoints - 1);\n    const segmentT = (percentToDraw * percentRaycasted) / (this.rayCurve.numPoints - 1);\n\n    for (let i = 0; i < this.rayCurve.numPoints; i++) {\n      const t = i * segmentT;\n      parabolicCurve(this.p0, this.v0, t, vecHelper);\n      this.rayCurve.setPoint(i, vecHelper);\n    }\n\n    const color = this.hit ? HIT_COLOR : MISS_COLOR;\n    const opacity = this.hit && this.timeTeleporting >= DRAW_TIME_MS ? HIT_OPACITY : MISS_OPACITY;\n    this.rayCurve.material.color.set(color);\n    this.rayCurve.material.opacity = opacity;\n\n    this.hitEntity.setAttribute(\"visible\", this.hit);\n    if (this.hit) {\n      this.hitEntity.setAttribute(\"position\", this.hitPoint);\n      this.hitEntity.object3D.traverse(o => {\n        o.matrixNeedsUpdate = true;\n      });\n      const hitEntityOpacity = HIT_OPACITY * easeOutIn(percentToDraw);\n      const dRadii = this.data.outerRadius - this.data.hitCylinderRadius;\n      const outerScale = (this.data.outerRadius - easeIn(percentToDraw) * dRadii) / this.data.outerRadius;\n      this.outerTorus.object3D.scale.set(outerScale, outerScale, 1);\n      this.torus.setAttribute(\"material\", \"opacity\", hitEntityOpacity);\n      this.cylinder.setAttribute(\"material\", \"opacity\", hitEntityOpacity);\n    }\n  },\n\n  createHitEntity() {\n    const data = this.data;\n\n    // Parent.\n    const hitEntity = document.createElement(\"a-entity\");\n    hitEntity.className = \"hitEntity\";\n\n    // Torus.\n    this.torus = document.createElement(\"a-entity\");\n    this.torus.setAttribute(\"geometry\", {\n      primitive: \"torus\",\n      radius: data.hitCylinderRadius,\n      radiusTubular: 0.01,\n      segmentsRadial: 16,\n      segmentsTubular: 18\n    });\n    this.torus.setAttribute(\"rotation\", { x: 90, y: 0, z: 0 });\n    this.torus.setAttribute(\"material\", {\n      shader: \"flat\",\n      color: data.hitCylinderColor,\n      side: \"double\",\n      depthTest: false\n    });\n    hitEntity.appendChild(this.torus);\n\n    // Cylinder.\n    this.cylinder = document.createElement(\"a-entity\");\n    this.cylinder.setAttribute(\"position\", { x: 0, y: data.hitCylinderHeight / 2, z: 0 });\n    if (window.createImageBitmap !== undefined) {\n      this.cylinder.setAttribute(\"rotation\", { x: 0, y: 0, z: 180 });\n    }\n    this.cylinder.setAttribute(\"geometry\", {\n      primitive: \"cylinder\",\n      segmentsHeight: 1,\n      radius: data.hitCylinderRadius,\n      height: data.hitCylinderHeight,\n      openEnded: true\n    });\n    this.cylinder.setAttribute(\"material\", {\n      shader: \"flat\",\n      color: data.hitCylinderColor,\n      side: \"double\",\n      src: CYLINDER_TEXTURE,\n      transparent: true,\n      depthTest: false\n    });\n    hitEntity.appendChild(this.cylinder);\n\n    // create another torus for animating when the hit destination is ready to go\n    this.outerTorus = document.createElement(\"a-entity\");\n    this.outerTorus.setAttribute(\"geometry\", {\n      primitive: \"torus\",\n      radius: data.outerRadius,\n      radiusTubular: 0.01,\n      segmentsRadial: 16,\n      segmentsTubular: 18\n    });\n    this.outerTorus.setAttribute(\"rotation\", { x: 90, y: 0, z: 0 });\n    this.outerTorus.setAttribute(\"material\", {\n      shader: \"flat\",\n      color: data.hitCylinderColor,\n      side: \"double\",\n      opacity: HIT_OPACITY,\n      depthTest: false\n    });\n    this.outerTorus.setAttribute(\"id\", \"outerTorus\");\n    hitEntity.appendChild(this.outerTorus);\n\n    return hitEntity;\n  }\n});\n","import createTextGeometry from \"three-bmfont-text\";\n\n// 1 to match other A-Frame default widths.\nconst DEFAULT_WIDTH = 1;\n\n// @bryik set anisotropy to 16. Improves look of large amounts of text when viewed from angle.\nconst MAX_ANISOTROPY = 16;\n\n/**\n * Due to using negative scale, we return the opposite side specified.\n * https://github.com/mrdoob/three.js/pull/12787/\n */\nfunction parseSide(side) {\n  switch (side) {\n    case \"back\": {\n      return THREE.FrontSide;\n    }\n    case \"double\": {\n      return THREE.DoubleSide;\n    }\n    default: {\n      return THREE.BackSide;\n    }\n  }\n}\n\n/**\n * Determine wrap pixel count. Either specified or by experimental fudge factor.\n * Note that experimental factor will never be correct for variable width fonts.\n */\nfunction computeWidth(wrapPixels, wrapCount, widthFactor) {\n  return wrapPixels || (0.5 + wrapCount) * widthFactor;\n}\n\n/**\n * Compute default font width factor to use.\n */\nfunction computeFontWidthFactor(font) {\n  let sum = 0;\n  let digitsum = 0;\n  let digits = 0;\n  for (const ch of font.chars) {\n    sum += ch.xadvance;\n    if (ch.id >= 48 && ch.id <= 57) {\n      digits++;\n      digitsum += ch.xadvance;\n    }\n  }\n  return digits ? digitsum / digits : sum / font.chars.length;\n}\n\nfunction loadFont(src) {\n  return fetch(src)\n    .then(resp => resp.json())\n    .then(font => {\n      // Fix negative Y offsets for Roboto MSDF font from tool. Experimentally determined.\n      if (src.indexOf(\"/Roboto-msdf.json\") >= 0) {\n        for (const ch of font.chars) {\n          ch.yoffset += 30;\n        }\n      }\n      font.widthFactor = computeFontWidthFactor(font);\n      return font;\n    });\n}\n\nfunction loadTexture(src) {\n  return new Promise((resolve, reject) => {\n    new THREE.ImageLoader().load(\n      src,\n      image => {\n        const texture = new THREE.Texture();\n        texture.image = image;\n        texture.needsUpdate = true;\n        texture.anisotropy = MAX_ANISOTROPY;\n        resolve(texture);\n      },\n      undefined,\n      err => {\n        console.error(\"Error loading font image\", src, err);\n        reject(null);\n      }\n    );\n  });\n}\n\nconst FONTS = {\n  roboto: {\n    json: loadFont(\"https://cdn.aframe.io/fonts/Roboto-msdf.json\"),\n    texture: loadTexture(\"https://cdn.aframe.io/fonts/Roboto-msdf.png\")\n  }\n};\n\nAFRAME.registerComponent(\"text\", {\n  multiple: true,\n  schema: {\n    align: { type: \"string\", default: \"left\", oneOf: [\"left\", \"right\", \"center\"] },\n    alphaTest: { default: 0.5 },\n    // `anchor` defaults to center to match geometries.\n    anchor: { default: \"center\", oneOf: [\"left\", \"right\", \"center\", \"align\"] },\n    baseline: { default: \"center\", oneOf: [\"top\", \"center\", \"bottom\"] },\n    color: { type: \"color\", default: \"#FFF\" },\n    font: { type: \"string\", default: \"roboto\" },\n    // `height` has no default, will be populated at layout.\n    height: { type: \"number\" },\n    letterSpacing: { type: \"number\", default: 0 },\n    // `lineHeight` defaults to font's `lineHeight` value.\n    lineHeight: { type: \"number\" },\n    // `negate` must be true for fonts generated with older versions of msdfgen (white background).\n    negate: { type: \"boolean\", default: true },\n    opacity: { type: \"number\", default: 1.0 },\n    side: { default: \"front\", oneOf: [\"front\", \"back\", \"double\"] },\n    tabSize: { default: 4 },\n    transparent: { default: true },\n    value: { type: \"string\" },\n    whiteSpace: { default: \"normal\", oneOf: [\"normal\", \"pre\", \"nowrap\"] },\n    // `width` defaults to geometry width if present, else `DEFAULT_WIDTH`.\n    width: { type: \"number\" },\n    // `wrapCount` units are about one default font character. Wrap roughly at this number.\n    wrapCount: { type: \"number\", default: 40 },\n    // `wrapPixels` will wrap using bmfont pixel units (e.g., dejavu's is 32 pixels).\n    wrapPixels: { type: \"number\" },\n    // `xOffset` to add padding.\n    xOffset: { type: \"number\", default: 0 },\n    // `zOffset` will provide a small z offset to avoid z-fighting.\n    zOffset: { type: \"number\", default: 0.001 }\n  },\n\n  init: function() {\n    const shaderData = this.getShaderData(this.data);\n    this.shaderObject = new AFRAME.shaders[\"msdf\"].Shader();\n    this.shaderObject.el = this.el;\n    this.shaderObject.init(shaderData);\n    this.shaderObject.update(shaderData);\n    this.shaderObject.material.transparent = shaderData.transparent; // Apparently, was not set on `init` nor `update`.\n    this.shaderObject.material.side = shaderData.side;\n    this.geometry = createTextGeometry();\n    this.mesh = new THREE.Mesh(this.geometry, this.shaderObject.material);\n    this.el.setObject3D(this.attrName, this.mesh);\n  },\n\n  update: function(oldData) {\n    const data = this.data;\n    const shaderData = this.getShaderData(this.data);\n    this.shaderObject.update(shaderData);\n    this.shaderObject.material.transparent = shaderData.transparent; // Apparently, was not set on `init` nor `update`.\n    this.shaderObject.material.side = shaderData.side;\n\n    // New font. `updateFont` will later change data and layout.\n    if (oldData.font !== data.font) {\n      this.updateFont().catch(err => console.error(err));\n    }\n\n    // Not a new font, but we need to accomodate other changes with the existing font.\n    if (this.currentFont != null) {\n      this.updateGeometry(this.geometry, this.currentFont);\n      this.updateLayout(this.currentFont);\n    }\n  },\n\n  /**\n   * Clean up geometry, material, texture, mesh, objects.\n   */\n  remove: function() {\n    this.geometry.dispose();\n    this.geometry = null;\n    this.el.removeObject3D(this.attrName);\n    this.shaderObject.material.dispose();\n    this.shaderObject.material = null;\n    delete this.shaderObject;\n  },\n\n  getShaderData: (function() {\n    const shaderData = {};\n    return function(data) {\n      shaderData.alphaTest = data.alphaTest;\n      shaderData.color = data.color;\n      shaderData.opacity = data.opacity;\n      shaderData.side = parseSide(data.side);\n      shaderData.transparent = data.transparent;\n      shaderData.negate = data.negate;\n      return shaderData;\n    };\n  })(),\n\n  /**\n   * Load font for geometry, load font image for material, and apply.\n   */\n  updateFont: function() {\n    const data = this.data;\n    const geometry = this.geometry;\n\n    // Make invisible during font swap.\n    this.mesh.visible = false;\n    const fetchFontData = Promise.all([FONTS[data.font].json, FONTS[data.font].texture]);\n    return fetchFontData.then(([font, texture]) => {\n      if (font.pages.length !== 1) {\n        throw new Error(\"Currently only single-page bitmap fonts are supported.\");\n      }\n      this.currentFont = font;\n      this.updateGeometry(geometry, font);\n      this.shaderObject.update({ map: texture });\n      this.updateLayout(font);\n      this.mesh.visible = true;\n    });\n  },\n\n  /**\n   * Update layout with anchor, alignment, baseline, and considering any meshes.\n   */\n  updateLayout: function(font) {\n    const el = this.el;\n    const data = this.data;\n    const geometry = this.geometry;\n    const mesh = this.mesh;\n\n    if (!geometry.layout) {\n      return;\n    }\n\n    // Determine width to use (defined width, geometry's width, or default width).\n    const geometryComponent = el.getAttribute(\"geometry\");\n    const width = data.width || (geometryComponent && geometryComponent.width) || DEFAULT_WIDTH;\n\n    // Determine wrap pixel count. Either specified or by experimental fudge factor.\n    // Note that experimental factor will never be correct for variable width fonts.\n    const textRenderWidth = computeWidth(data.wrapPixels, data.wrapCount, font.widthFactor);\n    const textScale = width / textRenderWidth;\n\n    // Determine height to use.\n    const layout = geometry.layout;\n    const height = textScale * (layout.height + layout.descender);\n\n    // Update geometry dimensions to match text layout if width and height are set to 0.\n    // For example, scales a plane to fit text.\n    if (geometryComponent && geometryComponent.primitive === \"plane\") {\n      if (!geometryComponent.width) {\n        el.setAttribute(\"geometry\", \"width\", width);\n      }\n      if (!geometryComponent.height) {\n        el.setAttribute(\"geometry\", \"height\", height);\n      }\n    }\n\n    // Calculate X position to anchor text left, center, or right.\n    const anchor = data.anchor === \"align\" ? data.align : data.anchor;\n    let x, y;\n    if (anchor === \"left\") {\n      x = 0;\n    } else if (anchor === \"right\") {\n      x = -1 * layout.width;\n    } else if (anchor === \"center\") {\n      x = (-1 * layout.width) / 2;\n    } else {\n      throw new TypeError(\"Invalid text.anchor property value\", anchor);\n    }\n\n    // Calculate Y position to anchor text top, center, or bottom.\n    const baseline = data.baseline;\n    if (baseline === \"bottom\") {\n      y = 0;\n    } else if (baseline === \"top\") {\n      y = -1 * layout.height + layout.ascender;\n    } else if (baseline === \"center\") {\n      y = (-1 * layout.height) / 2;\n    } else {\n      throw new TypeError(\"Invalid text.baseline property value\", baseline);\n    }\n\n    // Position and scale mesh to apply layout.\n    mesh.position.x = x * textScale + data.xOffset;\n    mesh.position.y = y * textScale;\n    // Place text slightly in front to avoid Z-fighting.\n    mesh.position.z = data.zOffset;\n    mesh.scale.set(textScale, -1 * textScale, textScale);\n  },\n\n  /**\n   * Update the text geometry using `three-bmfont-text.update`.\n   */\n  updateGeometry: (function() {\n    const geometryUpdateBase = {};\n    const geometryUpdateData = {};\n    const newLineRegex = /\\\\n/g;\n    const tabRegex = /\\\\t/g;\n\n    return function(geometry, font) {\n      const data = this.data;\n\n      geometryUpdateData.font = font;\n      geometryUpdateData.lineHeight =\n        data.lineHeight && isFinite(data.lineHeight) ? data.lineHeight : font.common.lineHeight;\n      geometryUpdateData.text = data.value\n        .toString()\n        .replace(newLineRegex, \"\\n\")\n        .replace(tabRegex, \"\\t\");\n      geometryUpdateData.width = computeWidth(data.wrapPixels, data.wrapCount, font.widthFactor);\n      geometry.update(Object.assign(geometryUpdateBase, data, geometryUpdateData));\n    };\n  })()\n});\n","export const sets = {};\nsets.global = \"global\";\nsets.inputFocused = \"inputFocused\";\nsets.cursorHoveringOnPen = \"cursorHoveringOnPen\";\nsets.cursorHoveringOnCamera = \"cursorHoveringOnCamera\";\nsets.cursorHoveringOnInteractable = \"cursorHoveringOnInteractable\";\nsets.cursorHoveringOnUI = \"cursorHoveringOnUI\";\nsets.cursorHoveringOnVideo = \"cursorHoveringOnVideo\";\nsets.cursorHoveringOnNothing = \"cursorHoveringOnNothing\";\nsets.cursorHoldingPen = \"cursorHoldingPen\";\nsets.cursorHoldingCamera = \"cursorHoldingCamera\";\nsets.cursorHoldingInteractable = \"cursorHoldingInteractable\";\nsets.cursorHoldingUI = \"cursorHoldingUI\";\nsets.cursorHoldingNothing = \"cursorHoldingNothing\";\nsets.rightHandTeleporting = \"rightHandTeleporting\";\nsets.rightHandHoveringOnPen = \"rightHandHoveringOnPen\";\nsets.rightHandHoveringOnCamera = \"rightHandHoveringOnCamera\";\nsets.rightHandHoveringOnInteractable = \"rightHandHoveringOnInteractable\";\nsets.rightHandHoveringOnNothing = \"rightHandHoveringOnNothing\";\nsets.rightHandHoldingPen = \"rightHandHoldingPen\";\nsets.rightHandHoldingCamera = \"rightHandHoldingCamera\";\nsets.rightHandHoldingInteractable = \"rightHandHoldingInteractable\";\nsets.leftHandTeleporting = \"leftHandTeleporting\";\nsets.leftHandHoveringOnPen = \"leftHandHoveringOnPen\";\nsets.leftHandHoveringOnCamera = \"leftHandHoveringOnCamera\";\nsets.leftHandHoveringOnInteractable = \"leftHandHoveringOnInteractable\";\nsets.leftHandHoldingPen = \"leftHandHoldingPen\";\nsets.leftHandHoldingCamera = \"leftHandHoldingCamera\";\nsets.leftHandHoldingInteractable = \"leftHandHoldingInteractable\";\nsets.leftHandHoveringOnNothing = \"leftHandHoveringOnNothing\";\n","const { detect } = require(\"detect-browser\");\n\nconst browser = detect();\n\n// Precision on device detection is fuzzy -- we can sometimes know if a device is definitely\n// available, or definitely *not* available, and assume it may be available otherwise.\nexport const VR_DEVICE_AVAILABILITY = {\n  yes: \"yes\", // Implies VR can be launched into on this device immediately, in this browser\n  no: \"no\", // Implies this VR device is definitely not supported regardless of browser\n  maybe: \"maybe\" // Implies this device may support this VR platform, but may not be installed or in a compatible browser\n};\n\nfunction isMaybeGearVRCompatibleDevice(ua) {\n  return /\\WAndroid\\W/.test(ua);\n}\n\nfunction isMaybeDaydreamCompatibleDevice(ua) {\n  return /\\WAndroid\\W/.test(ua);\n}\n\n// Blacklist of VR device name regex matchers that we do not want to consider as valid VR devices\n// that can be entered into as a \"generic\" entry flow.\nconst GENERIC_ENTRY_TYPE_DEVICE_BLACKLIST = [/cardboard/i];\n\n// Tries to determine VR entry compatibility regardless of the current browser.\n//\n// For each VR \"entry type\", returns VR_DEVICE_AVAILABILITY.yes if that type can be launched into directly from this browser\n// on this device, returns VR_DEVICE_AVAILABILITY.no if that type is known to not be possible to ever use on this device no matter what,\n// and VR_DEVICE_AVAILABILITY.maybe if the device potentially could support that type if a different browser was running, or if\n// the software was setup, an HMD was purchased, etc.\n//\n// When \"yes\" or \"maybe\", we should present the option. If \"maybe\", when chosen try to get them into a compatible browser.\n// Once in a compatible browser, we should assume it will work (if it doesn't, it's because they don't have the headset,\n// haven't installed the software, our guess about their phone was wrong, etc.)\n//\n// At the time of this writing there are the following VR \"entry types\" that will be validated by this method:\n//\n// - screen: Enter \"on-screen\" in 2D\n// - generic: Generic WebVR (platform/OS agnostic indicator if a general 'Enter VR' option should be presented.)\n// - daydream: Google Daydream\n// - gearvr: Oculus GearVR\n// - cardboard: Google Cardboard\n//\nexport async function getAvailableVREntryTypes() {\n  const ua = navigator.userAgent;\n  const isSamsungBrowser = browser.name === \"chrome\" && /SamsungBrowser/.test(ua);\n  const isMobile = AFRAME.utils.device.isMobile();\n  const isMobileVR = AFRAME.utils.device.isMobileVR();\n\n  // This needs to be kept up-to-date with the latest browsers that can support VR and Hubs.\n  // Checking for navigator.getVRDisplays always passes b/c of polyfill.\n  const isWebVRCapableBrowser = window.hasNativeWebVRImplementation;\n\n  const isDaydreamCapableBrowser = !!(isWebVRCapableBrowser && browser.name === \"chrome\" && !isSamsungBrowser);\n  const isIDevice = AFRAME.utils.device.isIOS();\n  const isFirefoxBrowser = browser.name === \"firefox\";\n  const isUIWebView = typeof navigator.mediaDevices === \"undefined\";\n\n  const safari = isIDevice\n    ? !isUIWebView\n      ? VR_DEVICE_AVAILABILITY.yes\n      : VR_DEVICE_AVAILABILITY.maybe\n    : VR_DEVICE_AVAILABILITY.no;\n\n  const isCardboardCapableBrowser = !!(isMobile && !isIDevice && browser.name === \"chrome\" && !isSamsungBrowser);\n\n  let displays = [];\n  try {\n    // Skip getVRDisplays on desktop Chrome since the API is in a broken state there.\n    // See https://github.com/mozilla/hubs/issues/892\n    if (browser.name !== \"chrome\" || isMobile) {\n      // We pull the displays on non-WebVR capable mobile browsers so we can pick up cardboard.\n      displays = isWebVRCapableBrowser || isCardboardCapableBrowser ? await navigator.getVRDisplays() : [];\n    }\n  } catch (e) {\n    console.warn(\"navigator.getVRDisplays() failed\", e);\n  }\n\n  const isOculusBrowser = /Oculus/.test(ua);\n\n  const screen = isMobileVR\n    ? VR_DEVICE_AVAILABILITY.no\n    : isIDevice && isUIWebView\n      ? VR_DEVICE_AVAILABILITY.maybe\n      : VR_DEVICE_AVAILABILITY.yes;\n\n  // HACK -- we prompt the user to install firefox if they click the VR button on a non-WebVR compatible\n  // browser. once we change this (ie when Chrome has VR support) then this check can be removed. Without this\n  // check if you have FF on Mac/Linux you'll get the confusing flow of having a VR button but then\n  // being asked to download FF.\n  const isNonWebVRFirefox = !isWebVRCapableBrowser && isFirefoxBrowser;\n  let generic = isMobile || isNonWebVRFirefox ? VR_DEVICE_AVAILABILITY.no : VR_DEVICE_AVAILABILITY.maybe;\n  let cardboard = VR_DEVICE_AVAILABILITY.no;\n\n  // We only consider GearVR support as \"maybe\" and never \"yes\". The only browser\n  // that will detect GearVR outside of VR is Samsung Internet, and we'd prefer to launch into Oculus\n  // Browser for now since Samsung Internet requires an additional WebVR installation + flag, so return \"maybe\".\n  //\n  // If we are in Oculus Browser (ie, we are literally wearing a GearVR) then return 'yes'.\n  let gearvr = VR_DEVICE_AVAILABILITY.no;\n  if (isMaybeGearVRCompatibleDevice(ua)) {\n    gearvr = isOculusBrowser ? VR_DEVICE_AVAILABILITY.yes : VR_DEVICE_AVAILABILITY.maybe;\n  }\n\n  // For daydream detection, we first check if they are on an Android compatible device, and assume they\n  // may support daydream *unless* this browser has WebVR capabilities, in which case we can do better.\n  let daydream =\n    isMaybeDaydreamCompatibleDevice(ua) && !isMobileVR ? VR_DEVICE_AVAILABILITY.maybe : VR_DEVICE_AVAILABILITY.no;\n\n  cardboard =\n    isCardboardCapableBrowser && displays.find(d => d.capabilities.canPresent && /cardboard/i.test(d.displayName))\n      ? VR_DEVICE_AVAILABILITY.yes\n      : VR_DEVICE_AVAILABILITY.no;\n\n  if (isWebVRCapableBrowser) {\n    // Generic is supported for non-blacklisted devices and presentable HMDs.\n    generic = displays.find(\n      d => d.capabilities.canPresent && !GENERIC_ENTRY_TYPE_DEVICE_BLACKLIST.find(r => r.test(d.displayName))\n    )\n      ? VR_DEVICE_AVAILABILITY.yes\n      : VR_DEVICE_AVAILABILITY.no;\n\n    // For daydream detection, in a WebVR browser we can increase confidence in daydream compatibility.\n    const hasDaydreamWebVRDevice = displays.find(d => /daydream/i.test(d.displayName));\n\n    if (hasDaydreamWebVRDevice) {\n      // If we detected daydream via WebVR\n      daydream = VR_DEVICE_AVAILABILITY.yes;\n      generic = VR_DEVICE_AVAILABILITY.no;\n    } else if (isDaydreamCapableBrowser) {\n      // If we didn't detect daydream in a daydream capable browser, we definitely can't run daydream at all.\n      daydream = VR_DEVICE_AVAILABILITY.no;\n    }\n  }\n\n  return { screen, generic, gearvr, daydream, cardboard, safari };\n}\n","const isMobileVR = AFRAME.utils.device.isMobileVR();\n\nexport function canShare() {\n  // TODO, fix up when OB/FxR support sharing\n  return navigator.share && !isMobileVR;\n}\n\n/**\n * Wraps navigator.share with a fallback to twitter for unsupported browsers\n */\nexport function share(opts) {\n  if (canShare()) {\n    return navigator.share(opts);\n  } else {\n    const { title, url } = opts;\n    const width = 550;\n    const height = 420;\n    const left = (screen.width - width) / 2;\n    const top = (screen.height - height) / 2;\n    const params = `scrollbars=no,menubar=no,toolbar=no,status=no,width=${width},height=${height},top=${top},left=${left}`;\n    const tweetLink = `https://twitter.com/intent/tweet?url=${encodeURIComponent(url)}&text=${encodeURIComponent(\n      title\n    )}`;\n    window.open(tweetLink, \"_blank\", params);\n    return Promise.resolve();\n  }\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { Route } from \"react-router\";\n\n/**\n * A react-router Route that looks for a key/value pair in the state to render something.\n */\nclass StateRoute extends React.Component {\n  static propTypes = {\n    stateKey: PropTypes.string,\n    stateValue: PropTypes.string,\n    history: PropTypes.object\n  };\n\n  render() {\n    const { history, stateKey, stateValue, ...routeProps } = this.props;\n\n    if (\n      (!history.location.state && !stateValue) ||\n      (history.location.state &&\n        (history.location.state[stateKey] === stateValue || (!history.location.state[stateKey] && !stateValue)))\n    ) {\n      return <Route path=\"/\" {...routeProps} />;\n    }\n\n    return null;\n  }\n}\n\nexport default StateRoute;\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\n\nimport styles from \"../assets/stylesheets/promote-client-dialog.scss\";\nimport DialogContainer from \"./dialog-container\";\n\nexport default class PromoteClientDialog extends Component {\n  static propTypes = {\n    displayName: PropTypes.string,\n    onConfirm: PropTypes.func,\n    onClose: PropTypes.func\n  };\n\n  render() {\n    return (\n      <DialogContainer title=\"Promote User\" {...this.props}>\n        <div className={styles.message}>\n          <FormattedMessage id=\"promote.message\" />\n        </div>\n        <button\n          className={styles.confirmButton}\n          onClick={() => {\n            this.props.onConfirm();\n            this.props.onClose();\n          }}\n        >\n          <FormattedMessage id=\"promote.confirm-prefix\" />\n          <span>{this.props.displayName}</span>\n        </button>\n        <button className={styles.cancelButton} onClick={() => this.props.onClose()}>\n          <FormattedMessage id=\"promote.cancel\" />\n        </button>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport DialogContainer from \"./dialog-container.js\";\nimport PromoteClientDialog from \"./promote-client-dialog.js\";\nimport styles from \"../assets/stylesheets/client-info-dialog.scss\";\nimport { FormattedMessage } from \"react-intl\";\nimport { sluglessPath } from \"../utils/history\";\nimport { getAvatarThumbnailUrl } from \"../utils/avatar-utils\";\n\nexport function getClientInfoClientId(location) {\n  const { search } = location;\n  const urlParams = new URLSearchParams(search);\n  const pathname = sluglessPath(location);\n\n  if (!pathname.startsWith(\"/client\") && !urlParams.get(\"client_id\")) return null;\n  return urlParams.get(\"client_id\") || pathname.substring(9);\n}\n\nexport default class ClientInfoDialog extends Component {\n  static propTypes = {\n    clientId: PropTypes.string,\n    history: PropTypes.object,\n    hubChannel: PropTypes.object,\n    presences: PropTypes.object,\n    performConditionalSignIn: PropTypes.func,\n    onClose: PropTypes.func,\n    showNonHistoriedDialog: PropTypes.func\n  };\n\n  state = {\n    avatarThumbnailUrl: null\n  };\n\n  kick() {\n    const { clientId, performConditionalSignIn, hubChannel, onClose } = this.props;\n\n    performConditionalSignIn(\n      () => hubChannel.can(\"kick_users\"),\n      async () => await hubChannel.kick(clientId),\n      \"kick-user\"\n    );\n\n    onClose();\n  }\n\n  hide() {\n    const { clientId, onClose, hubChannel } = this.props;\n    hubChannel.hide(clientId);\n    onClose();\n  }\n\n  mute() {\n    const { clientId, performConditionalSignIn, hubChannel, onClose } = this.props;\n\n    performConditionalSignIn(\n      () => hubChannel.can(\"mute_users\"),\n      async () => await hubChannel.mute(clientId),\n      \"mute-user\"\n    );\n\n    onClose();\n  }\n\n  addOwner() {\n    const { clientId, performConditionalSignIn, hubChannel, onClose } = this.props;\n    const { profile } = this.getPresenceEntry();\n\n    performConditionalSignIn(\n      () => hubChannel.can(\"update_roles\"),\n      async () => {\n        onClose();\n\n        this.props.showNonHistoriedDialog(PromoteClientDialog, {\n          displayName: profile.displayName,\n          onConfirm: () => hubChannel.addOwner(clientId)\n        });\n      },\n      \"add-owner\"\n    );\n  }\n\n  removeOwner() {\n    const { clientId, performConditionalSignIn, hubChannel, onClose } = this.props;\n\n    performConditionalSignIn(\n      () => hubChannel.can(\"update_roles\"),\n      async () => await hubChannel.removeOwner(clientId),\n      \"remove-owner\"\n    );\n\n    onClose();\n  }\n\n  unhide() {\n    const { clientId, hubChannel, onClose } = this.props;\n    hubChannel.unhide(clientId);\n    onClose();\n  }\n\n  getPresenceEntry() {\n    if (!this.props.presences) return null;\n\n    const presence = Object.entries(this.props.presences).find(([k]) => k === this.props.clientId);\n    if (!presence) return { profile: {}, roles: {} };\n\n    const metas = presence[1].metas;\n    return metas[metas.length - 1];\n  }\n\n  componentDidMount() {\n    const { profile } = this.getPresenceEntry();\n    if (profile.avatarId) {\n      getAvatarThumbnailUrl(profile.avatarId).then(avatarThumbnailUrl => this.setState({ avatarThumbnailUrl }));\n    }\n  }\n\n  render() {\n    const { profile, roles } = this.getPresenceEntry();\n\n    const { displayName, communityIdentifier } = profile;\n    const { hubChannel, clientId, onClose } = this.props;\n    const title = (\n      <div className={styles.title}>\n        {displayName}\n        <div className={styles.communityIdentifier}>{communityIdentifier}</div>\n      </div>\n    );\n    const mayKick = hubChannel.canOrWillIfCreator(\"kick_users\");\n    const mayMute = hubChannel.canOrWillIfCreator(\"mute_users\");\n    const targetIsOwner = !!roles.owner;\n    const targetIsCreator = !!roles.creator;\n    const targetIsSignedIn = !!roles.signed_in;\n    const mayAddOwner = hubChannel.canOrWillIfCreator(\"update_roles\") && !targetIsOwner && !targetIsCreator;\n    const mayRemoveOwner = hubChannel.canOrWillIfCreator(\"update_roles\") && targetIsOwner && !targetIsCreator;\n    const isHidden = hubChannel.isHidden(clientId);\n\n    return (\n      <DialogContainer className={styles.clientInfoDialog} title={title} wide={true} {...this.props}>\n        <div className={styles.roomInfo}>\n          <div className={styles.clientProfileImage}>\n            <img src={this.state.avatarThumbnailUrl} />\n          </div>\n          <div className={styles.clientActionButtons}>\n            {mayAddOwner && (\n              <button\n                onClick={() => this.addOwner()}\n                disabled={!targetIsSignedIn}\n                title={targetIsSignedIn ? \"Promote\" : `${profile.displayName} is signed out.`}\n              >\n                <img className={styles.buttonIcon} src=\"../assets/images/add-owner.png\" />\n                <FormattedMessage id=\"client-info.add-owner\" />\n              </button>\n            )}\n            {mayRemoveOwner && (\n              <button onClick={() => this.removeOwner()}>\n                <img className={styles.buttonIcon} src=\"../assets/images/remove-owner.png\" />\n                <FormattedMessage id=\"client-info.remove-owner\" />\n              </button>\n            )}\n            {!isHidden && (\n              <button onClick={() => this.hide()}>\n                <FormattedMessage id=\"client-info.hide-button\" />\n              </button>\n            )}\n            {isHidden && (\n              <button onClick={() => this.unhide()}>\n                <FormattedMessage id=\"client-info.unhide-button\" />\n              </button>\n            )}\n            {mayMute && (\n              <button onClick={() => this.mute()}>\n                <FormattedMessage id=\"client-info.mute-button\" />\n              </button>\n            )}\n            {mayKick && (\n              <button onClick={() => this.kick()}>\n                <FormattedMessage id=\"client-info.kick-button\" />\n              </button>\n            )}\n            <button className={styles.cancel} onClick={onClose}>\n              <FormattedMessage id=\"client-info.cancel\" />\n            </button>\n          </div>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { IntlProvider, FormattedMessage } from \"react-intl\";\nimport { lang, messages } from \"../utils/i18n\";\nimport loaderStyles from \"../assets/stylesheets/loader.scss\";\n\nclass Loader extends Component {\n  static propTypes = {\n    scene: PropTypes.object,\n    finished: PropTypes.bool,\n    onLoaded: PropTypes.func\n  };\n\n  doneWithInitialLoad = false;\n  state = {\n    loadingNum: 0,\n    loadedNum: 0\n  };\n\n  componentDidMount() {\n    this.props.scene.addEventListener(\"model-loading\", this.onObjectLoading);\n    this.props.scene.addEventListener(\"image-loading\", this.onObjectLoading);\n    this.props.scene.addEventListener(\"model-loaded\", this.onObjectLoaded);\n    this.props.scene.addEventListener(\"image-loaded\", this.onObjectLoaded);\n    this.props.scene.addEventListener(\"model-error\", this.onObjectLoaded);\n    this.props.scene.addEventListener(\n      \"environment-scene-loaded\",\n      () => {\n        this.environmentSceneLoaded = true;\n        this.tryFinishLoading();\n      },\n      { once: true }\n    );\n  }\n\n  componentWillUnmount() {\n    this.props.scene.removeEventListener(\"model-loading\", this.onObjectLoading);\n    this.props.scene.removeEventListener(\"image-loading\", this.onObjectLoading);\n    this.props.scene.removeEventListener(\"model-loaded\", this.onObjectLoaded);\n    this.props.scene.removeEventListener(\"image-loaded\", this.onObjectLoaded);\n    this.props.scene.removeEventListener(\"model-error\", this.onObjectLoaded);\n  }\n\n  onObjectLoading = () => {\n    if (!this.doneWithInitialLoad && this.loadingTimeout) {\n      window.clearTimeout(this.loadingTimeout);\n      this.loadingTimeout = null;\n    }\n\n    this.setState(state => {\n      return { loadingNum: state.loadingNum + 1 };\n    });\n  };\n\n  onObjectLoaded = () => {\n    this.setState(state => {\n      return { loadedNum: state.loadedNum + 1 };\n    });\n\n    this.tryFinishLoading();\n  };\n\n  tryFinishLoading = () => {\n    if (!this.doneWithInitialLoad && this.loadingTimeout) window.clearTimeout(this.loadingTimeout);\n\n    if (this.environmentSceneLoaded) {\n      this.loadingTimeout = window.setTimeout(() => {\n        this.doneWithInitialLoad = true;\n        if (this.props.onLoaded) {\n          this.props.onLoaded();\n        }\n      }, 1500);\n    }\n  };\n\n  render() {\n    const nomore = (\n      <h4 className={loaderStyles.loadingText}>\n        <FormattedMessage id=\"loader.entering_lobby\" />\n      </h4>\n    );\n    const progress = this.state.loadingNum === 0 ? \" \" : `${this.state.loadedNum} / ${this.state.loadingNum} `;\n    const usual = (\n      <h4 className={loaderStyles.loadingText}>\n        <FormattedMessage id=\"loader.loading\" />\n        {progress}\n        <FormattedMessage id={this.state.loadingNum !== 1 ? \"loader.objects\" : \"loader.object\"} />\n        ...\n      </h4>\n    );\n    return (\n      <IntlProvider locale={lang} messages={messages}>\n        <div className=\"loading-panel\">\n          <img className=\"loading-panel__logo\" style={{height: 150, width: 150}} src={this.props.loadingIcon} />\n\n          {this.props.finished ? nomore : usual}\n\n          <div className=\"loader-wrap loader-bottom\">\n            <div className=\"loader\">\n              <div className=\"loader-center\" />\n            </div>\n          </div>\n        </div>\n      </IntlProvider>\n    );\n  }\n}\n\nexport default Loader;\n","import React from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport PropTypes from \"prop-types\";\n\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nconst AutoExitWarning = props => (\n  <div className=\"autoexit-panel\">\n    <div className=\"autoexit-panel__title\">\n      <FormattedMessage id=\"autoexit.title\" />\n      <span>{props.secondsRemaining}</span>\n      <FormattedMessage id=\"autoexit.title_units\" />\n    </div>\n    <div className=\"autoexit-panel__subtitle\">\n      <FormattedMessage id=\"autoexit.subtitle\" />\n    </div>\n    <WithHoverSound>\n      <div className=\"autoexit-panel__cancel-button\" onClick={props.onCancel}>\n        <FormattedMessage id=\"autoexit.cancel\" />\n      </div>\n    </WithHoverSound>\n  </div>\n);\n\nAutoExitWarning.propTypes = {\n  secondsRemaining: PropTypes.number,\n  onCancel: PropTypes.func\n};\n\nexport default AutoExitWarning;\n","import React from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport PropTypes from \"prop-types\";\n\nimport MobileScreenEntryImg from \"../assets/images/mobile_screen_entry.svg\";\nimport DesktopScreenEntryImg from \"../assets/images/desktop_screen_entry.svg\";\nimport GenericVREntryImg from \"../assets/images/generic_vr_entry.svg\";\nimport GearVREntryImg from \"../assets/images/gearvr_entry.svg\";\nimport DaydreamEntryImg from \"../assets/images/daydream_entry.svg\";\nimport styles from \"../assets/stylesheets/entry.scss\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\nimport cx from \"classnames\";\n\nconst EntryButton = props => {\n  return (\n    <WithHoverSound>\n      <button\n        className={cx([{ [styles.entryButton]: true, [styles.entryButtonSecondary]: props.secondary }])}\n        onClick={props.onClick}\n      >\n        <img src={props.iconSrc} className={styles.icon} />\n        <div className={styles.label}>\n          <div className={styles.contents}>\n            <span>\n              <FormattedMessage id={props.prefixMessageId} />\n            </span>\n            <span className={styles.bolded}>\n              <FormattedMessage id={props.mediumMessageId} />\n            </span>\n            {props.subtitle && (\n              <div className={styles.subtitle}>\n                <FormattedMessage id={props.subtitle} />\n              </div>\n            )}\n          </div>\n        </div>\n      </button>\n    </WithHoverSound>\n  );\n};\n\nEntryButton.propTypes = {\n  onClick: PropTypes.func,\n  iconSrc: PropTypes.string,\n  secondary: PropTypes.bool,\n  prefixMessageId: PropTypes.string,\n  mediumMessageId: PropTypes.string,\n  subtitle: PropTypes.string,\n  isInHMD: PropTypes.bool\n};\n\nconst isMobile = AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR();\n\nexport const TwoDEntryButton = props => {\n  const entryButtonProps = {\n    ...props,\n    iconSrc: isMobile ? MobileScreenEntryImg : DesktopScreenEntryImg,\n    prefixMessageId: \"entry.screen-prefix\",\n    mediumMessageId: isMobile ? \"entry.mobile-screen\" : \"entry.desktop-screen\"\n  };\n\n  return <EntryButton {...entryButtonProps} />;\n};\n\nexport const GenericEntryButton = props => {\n  const entryButtonProps = {\n    ...props,\n    iconSrc: GenericVREntryImg,\n    prefixMessageId: \"entry.generic-prefix\",\n    mediumMessageId: \"entry.generic-medium\",\n    subtitle: isMobile ? null : \"entry.generic-subtitle-desktop\"\n  };\n\n  return <EntryButton {...entryButtonProps} />;\n};\n\nexport const GearVREntryButton = props => {\n  const entryButtonProps = {\n    ...props,\n    iconSrc: GearVREntryImg,\n    prefixMessageId: \"entry.gearvr-prefix\",\n    mediumMessageId: \"entry.gearvr-medium\"\n  };\n\n  return <EntryButton {...entryButtonProps} />;\n};\n\nexport const DaydreamEntryButton = props => {\n  const entryButtonProps = {\n    ...props,\n    iconSrc: DaydreamEntryImg,\n    prefixMessageId: \"entry.daydream-prefix\",\n    mediumMessageId: \"entry.daydream-medium\"\n  };\n\n  return <EntryButton {...entryButtonProps} />;\n};\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { injectIntl, FormattedMessage } from \"react-intl\";\nimport classNames from \"classnames\";\nimport { faPencilAlt } from \"@fortawesome/free-solid-svg-icons/faPencilAlt\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nimport { SCHEMA } from \"../storage/store\";\nimport styles from \"../assets/stylesheets/profile.scss\";\n// import hubLogo from \"../assets/images/hub-preview-white.png\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\nimport { fetchAvatar } from \"../utils/avatar-utils\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\nimport { replaceHistoryState } from \"../utils/history\";\nimport StateLink from \"./state-link\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\n\nimport AvatarPreview from \"./avatar-preview\";\n\nclass ProfileEntryPanel extends Component {\n  static propTypes = {\n    displayNameOverride: PropTypes.string,\n    store: PropTypes.object,\n    mediaSearchStore: PropTypes.object,\n    messages: PropTypes.object,\n    finished: PropTypes.func,\n    intl: PropTypes.object,\n    history: PropTypes.object,\n    avatarId: PropTypes.string,\n    onClose: PropTypes.func\n  };\n\n  state = {\n    avatarId: null,\n    displayName: null,\n    avatar: null\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = this.getStateFromProfile();\n    if (props.avatarId) {\n      this.state.avatarId = props.avatarId;\n    }\n    this.props.store.addEventListener(\"statechanged\", this.storeUpdated);\n    this.scene = document.querySelector(\"a-scene\");\n  }\n\n  getStateFromProfile = () => {\n    const { displayName, avatarId } = this.props.store.state.profile;\n    return { displayName, avatarId };\n  };\n\n  storeUpdated = () => this.setState(this.getStateFromProfile());\n\n  saveStateAndFinish = e => {\n    e && e.preventDefault();\n\n    const { displayName } = this.props.store.state.profile;\n    const { hasChangedName } = this.props.store.state.activity;\n\n    const hasChangedNowOrPreviously = hasChangedName || this.state.displayName !== displayName;\n    this.props.store.update({\n      activity: {\n        hasChangedName: hasChangedNowOrPreviously,\n        hasAcceptedProfile: true\n      },\n      profile: {\n        displayName: this.state.displayName,\n        avatarId: this.state.avatarId\n      }\n    });\n    this.props.finished();\n  };\n\n  stopPropagation = e => {\n    e.stopPropagation();\n  };\n\n  setAvatarFromMediaResult = ({ detail: entry }) => {\n    this.setState({ avatarId: entry.id });\n    // Replace history state with the current avatar id since this component gets destroyed when we open the\n    // avatar editor and we want the back button to work. We read the history state back via the avatarId prop.\n    // We read the current state key from history since it could be \"overlay\" or \"entry_step\".\n    replaceHistoryState(this.props.history, this.props.history.location.state.key, \"profile\", { avatarId: entry.id });\n  };\n\n  componentDidMount() {\n    if (this.nameInput) {\n      // stop propagation so that avatar doesn't move when wasd'ing during text input.\n      this.nameInput.addEventListener(\"keydown\", this.stopPropagation);\n      this.nameInput.addEventListener(\"keypress\", this.stopPropagation);\n      this.nameInput.addEventListener(\"keyup\", this.stopPropagation);\n    }\n    this.scene.addEventListener(\"action_selected_media_result_entry\", this.setAvatarFromMediaResult);\n    // This handles editing avatars in the entry_step, since this component remains mounted with the same avatarId\n    this.scene.addEventListener(\"action_avatar_saved\", this.refetchAvatar);\n\n    this.refetchAvatar();\n  }\n\n  componentDidUpdate(_prevProps, prevState) {\n    if (prevState.avatarId !== this.state.avatarId) {\n      this.refetchAvatar();\n    }\n  }\n\n  componentWillUnmount() {\n    this.props.store.removeEventListener(\"statechanged\", this.storeUpdated);\n    if (this.nameInput) {\n      this.nameInput.removeEventListener(\"keydown\", this.stopPropagation);\n      this.nameInput.removeEventListener(\"keypress\", this.stopPropagation);\n      this.nameInput.removeEventListener(\"keyup\", this.stopPropagation);\n    }\n    this.scene.removeEventListener(\"action_selected_media_result_entry\", this.setAvatarFromMediaResult);\n    this.scene.removeEventListener(\"action_avatar_saved\", this.refetchAvatar);\n  }\n\n  refetchAvatar = async () => {\n    const avatar = await fetchAvatar(this.state.avatarId);\n    if (this.state.avatarId !== avatar.avatar_id) return; // This is an old result, ignore it\n    this.setState({ avatar });\n  };\n\n  render() {\n    const { formatMessage } = this.props.intl;\n\n    return (\n      <div className={styles.profileEntry}>\n        <div className={styles.close}>\n          <a onClick={() => this.props.onClose()}>\n            <i>\n              <FontAwesomeIcon icon={faTimes} />\n            </i>\n          </a>\n        </div>\n        <form onSubmit={this.saveStateAndFinish} className={styles.form}>\n          <div className={classNames([styles.box, styles.darkened])}>\n            <label htmlFor=\"#profile-entry-display-name\" className={styles.title}>\n              <FormattedMessage id=\"profile.header\" />\n            </label>\n            {this.props.displayNameOverride ? (\n              <span className={styles.displayName}>{this.props.displayNameOverride}</span>\n            ) : (\n              <input\n                id=\"profile-entry-display-name\"\n                className={styles.formFieldText}\n                value={this.state.displayName}\n                onFocus={e => handleTextFieldFocus(e.target)}\n                onBlur={() => handleTextFieldBlur()}\n                onChange={e => this.setState({ displayName: e.target.value })}\n                required\n                spellCheck=\"false\"\n                pattern={SCHEMA.definitions.profile.properties.displayName.pattern}\n                title={formatMessage({ id: \"profile.display_name.validation_warning\" })}\n                ref={inp => (this.nameInput = inp)}\n              />\n            )}\n\n            {this.state.avatar ? (\n              <div className={styles.preview}>\n                <AvatarPreview avatarGltfUrl={this.state.avatar.gltf_url} />\n\n                {this.state.avatar.account_id === this.props.store.credentialsAccountId && (\n                  <StateLink\n                    stateKey=\"overlay\"\n                    stateValue=\"avatar-editor\"\n                    stateDetail={{ avatarId: this.state.avatarId, hideDelete: true, returnToProfile: true }}\n                    history={this.props.history}\n                    className={styles.editAvatar}\n                  >\n                    <FontAwesomeIcon icon={faPencilAlt} />\n                  </StateLink>\n                )}\n\n                <div className={styles.chooseAvatar}>\n                  <a onClick={() => this.props.mediaSearchStore.sourceNavigateWithNoNav(\"avatars\")}>\n                    <FormattedMessage id=\"profile.choose_avatar\" />\n                  </a>\n                </div>\n              </div>\n            ) : (\n              <div className={styles.preview}>\n                <div className={styles.chooseAvatar}>\n                  <a onClick={() => this.props.mediaSearchStore.sourceNavigateWithNoNav(\"avatars\")}>\n                    <FormattedMessage id=\"profile.choose_avatar\" />\n                  </a>\n                </div>\n              </div>\n            )}\n\n            <WithHoverSound>\n              <input className={styles.formSubmit} type=\"submit\" value={formatMessage({ id: \"profile.save\" })} />\n            </WithHoverSound>\n            <div className={styles.links}>\n              <WithHoverSound>\n                <a\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  href={this.props.termsLink || \"https://github.com/mozilla/hubs/blob/master/TERMS.md\"}\n                >\n                  <FormattedMessage id=\"profile.terms_of_use\" />\n                </a>\n              </WithHoverSound>\n\n              <WithHoverSound>\n                <a\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                  href={this.props.privacyLink || \"https://github.com/mozilla/hubs/blob/master/PRIVACY.md\"}\n                >\n                  <FormattedMessage id=\"profile.privacy_notice\" />\n                </a>\n              </WithHoverSound>\n            </div>\n          </div>\n        </form>\n        <img className={styles.logo} src={this.props.logo} />\n      </div>\n    );\n  }\n}\n\nexport default injectIntl(ProfileEntryPanel);\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { injectIntl, FormattedMessage } from \"react-intl\";\nimport classNames from \"classnames\";\nimport { faAngleRight } from \"@fortawesome/free-solid-svg-icons/faAngleRight\";\nimport { faSearch } from \"@fortawesome/free-solid-svg-icons/faSearch\";\nimport { faStar } from \"@fortawesome/free-solid-svg-icons/faStar\";\nimport { faCloudUploadAlt } from \"@fortawesome/free-solid-svg-icons/faCloudUploadAlt\";\nimport { faLink } from \"@fortawesome/free-solid-svg-icons/faLink\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nimport styles from \"../assets/stylesheets/media-browser.scss\";\nimport { pushHistoryPath, pushHistoryState, sluglessPath } from \"../utils/history\";\nimport { SOURCES } from \"../storage/media-search-store\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\nimport { showFullScreenIfWasFullScreen } from \"../utils/fullscreen\";\nimport MediaTiles from \"./media-tiles\";\n\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\n\nconst PRIVACY_POLICY_LINKS = {\n  videos: \"https://privacy.microsoft.com/en-us/privacystatement\",\n  images: \"https://privacy.microsoft.com/en-us/privacystatement\",\n  gifs: \"https://tenor.com/legal-privacy\",\n  sketchfab: \"https://sketchfab.com/privacy\",\n  poly: \"https://policies.google.com/privacy\",\n  youtube: \"https://policies.google.com/privacy\",\n  twitch: \"https://www.twitch.tv/p/legal/privacy-policy/\"\n};\n\nconst DEFAULT_FACETS = {\n  sketchfab: [\n    { text: \"Animals\", params: { filter: \"animals-pets\" } },\n    { text: \"Architecture\", params: { filter: \"architecture\" } },\n    { text: \"Art\", params: { filter: \"art-abstract\" } },\n    { text: \"Vehicles\", params: { filter: \"cars-vehicles\" } },\n    { text: \"Characters\", params: { filter: \"characters-creatures\" } },\n    { text: \"Culture\", params: { filter: \"cultural-heritage-history\" } },\n    { text: \"Gadgets\", params: { filter: \"electronics-gadgets\" } },\n    { text: \"Fashion\", params: { filter: \"fashion-style\" } },\n    { text: \"Food\", params: { filter: \"food-drink\" } },\n    { text: \"Furniture\", params: { filter: \"furniture-home\" } },\n    { text: \"Music\", params: { filter: \"music\" } },\n    { text: \"Nature\", params: { filter: \"nature-plants\" } },\n    { text: \"News\", params: { filter: \"news-politics\" } },\n    { text: \"People\", params: { filter: \"people\" } },\n    { text: \"Places\", params: { filter: \"places-travel\" } },\n    { text: \"Science\", params: { filter: \"science-technology\" } },\n    { text: \"Sports\", params: { filter: \"sports-fitness\" } },\n    { text: \"Weapons\", params: { filter: \"weapons-military\" } }\n  ],\n  poly: [\n    { text: \"Animals\", params: { filter: \"animals\" } },\n    { text: \"Architecture\", params: { filter: \"architecture\" } },\n    { text: \"Art\", params: { filter: \"art\" } },\n    { text: \"Food\", params: { filter: \"food\" } },\n    { text: \"Nature\", params: { filter: \"nature\" } },\n    { text: \"Objects\", params: { filter: \"objects\" } },\n    { text: \"People\", params: { filter: \"people\" } },\n    { text: \"Scenes\", params: { filter: \"scenes\" } },\n    { text: \"Transport\", params: { filter: \"transport\" } }\n  ],\n  avatars: [\n    { text: \"Featured\", params: { filter: \"featured\" } },\n    { text: \"My Avatars\", params: { filter: \"my-avatars\" } }\n  ],\n  favorites: [],\n  scenes: [{ text: \"Featured\", params: { filter: \"featured\" } }, { text: \"My Scenes\", params: { filter: \"my-scenes\" } }]\n};\n\nclass MediaBrowser extends Component {\n  static propTypes = {\n    mediaSearchStore: PropTypes.object,\n    history: PropTypes.object,\n    intl: PropTypes.object,\n    hubChannel: PropTypes.object,\n    onMediaSearchResultEntrySelected: PropTypes.func,\n    performConditionalSignIn: PropTypes.func\n  };\n\n  state = { query: \"\", facets: [], showNav: true, selectNextResult: false, clearStashedQueryOnClose: false };\n\n  constructor(props) {\n    super(props);\n    this.state = this.getStoreAndHistoryState(props);\n    this.props.mediaSearchStore.addEventListener(\"statechanged\", this.storeUpdated);\n    this.props.mediaSearchStore.addEventListener(\"sourcechanged\", this.sourceChanged);\n  }\n\n  componentDidMount() {}\n\n  componentWillUnmount() {\n    this.props.mediaSearchStore.removeEventListener(\"statechanged\", this.storeUpdated);\n    this.props.mediaSearchStore.removeEventListener(\"sourcechanged\", this.sourceChanged);\n  }\n\n  storeUpdated = () => {\n    const newState = this.getStoreAndHistoryState(this.props);\n    this.setState(newState);\n\n    if (this.state.selectNextResult) {\n      if (newState.result && newState.result.entries.length > 0) {\n        this.selectEntry(newState.result.entries[0]);\n      } else {\n        this.close();\n      }\n    }\n  };\n\n  sourceChanged = () => {\n    if (this.inputRef && !isMobile && !isMobileVR) {\n      this.inputRef.focus();\n    }\n  };\n\n  getUrlSource = searchParams =>\n    searchParams.get(\"media_source\") || sluglessPath(this.props.history.location).substring(7);\n\n  getStoreAndHistoryState = props => {\n    const searchParams = new URLSearchParams(props.history.location.search);\n    const result = props.mediaSearchStore.result;\n\n    const newState = { result, query: this.state.query || searchParams.get(\"q\") || \"\" };\n    const urlSource = this.getUrlSource(searchParams);\n    newState.showNav = !!(searchParams.get(\"media_nav\") !== \"false\");\n\n    if (result && result.suggestions && result.suggestions.length > 0) {\n      newState.facets = result.suggestions.map(s => {\n        return { text: s, params: { q: s } };\n      });\n    } else {\n      newState.facets = DEFAULT_FACETS[urlSource] || [];\n    }\n\n    return newState;\n  };\n\n  handleQueryUpdated = (query, forceNow) => {\n    this.setState({ result: null });\n\n    if (this._sendQueryTimeout) {\n      clearTimeout(this._sendQueryTimeout);\n      this._sendQueryTimeout = null;\n    }\n\n    if (forceNow) {\n      this.props.mediaSearchStore.filterQueryNavigate(\"\", query);\n    } else {\n      // Don't update search on every keystroke, but buffer for some ms.\n      this._sendQueryTimeout = setTimeout(() => {\n        // Drop filter for now, so entering text drops into \"search all\" mode\n        this.props.mediaSearchStore.filterQueryNavigate(\"\", query);\n        this._sendQueryTimeout = null;\n      }, 500);\n    }\n\n    this.setState({ query });\n  };\n\n  handleEntryClicked = (evt, entry) => {\n    evt.preventDefault();\n\n    if (!entry.lucky_query) {\n      this.selectEntry(entry);\n    } else {\n      // Entry has a pointer to another \"i'm feeling lucky\" query -- used for trending videos\n      //\n      // Also, mark the browser to clear the stashed query on close, since this is a temporary\n      // query we are running to get the result we want.\n      this.setState({ clearStashedQueryOnClose: true });\n      this.handleQueryUpdated(entry.lucky_query, true);\n    }\n  };\n\n  selectEntry = entry => {\n    if (!this.props.onMediaSearchResultEntrySelected) return;\n    this.props.onMediaSearchResultEntrySelected(entry);\n    this.close();\n  };\n\n  handleSourceClicked = source => {\n    this.props.mediaSearchStore.sourceNavigate(source);\n  };\n\n  handleFacetClicked = facet => {\n    const searchParams = this.getSearchClearedSearchParams(true, true);\n\n    for (const [k, v] of Object.entries(facet.params)) {\n      searchParams.set(k, v);\n    }\n\n    pushHistoryPath(this.props.history, this.props.history.location.pathname, searchParams.toString());\n  };\n\n  getSearchClearedSearchParams = (keepSource, keepNav) => {\n    return this.props.mediaSearchStore.getSearchClearedSearchParams(this.props.history.location, keepSource, keepNav);\n  };\n\n  pushExitMediaBrowserHistory = (stashLastSearchParams = true) => {\n    this.props.mediaSearchStore.pushExitMediaBrowserHistory(this.props.history, stashLastSearchParams);\n  };\n\n  showCustomMediaDialog = source => {\n    const isSceneApiType = source === \"scenes\";\n    const isAvatarApiType = source === \"avatars\";\n    this.pushExitMediaBrowserHistory(!isAvatarApiType);\n    const dialog = isSceneApiType ? \"change_scene\" : isAvatarApiType ? \"avatar_url\" : \"create\";\n    pushHistoryState(this.props.history, \"modal\", dialog);\n  };\n\n  close = () => {\n    showFullScreenIfWasFullScreen();\n    const urlSource = this.getUrlSource(new URLSearchParams(this.props.history.location.search));\n    this.pushExitMediaBrowserHistory(urlSource !== \"avatars\" && urlSource !== \"favorites\");\n    if (this.state.clearStashedQueryOnClose) {\n      this.props.mediaSearchStore.clearStashedQuery();\n    }\n  };\n\n  handlePager = delta => {\n    this.setState({ result: null });\n    this.props.mediaSearchStore.pageNavigate(delta);\n    this.browserDiv.scrollTop = 0;\n  };\n\n  render() {\n    const { formatMessage } = this.props.intl;\n    const searchParams = new URLSearchParams(this.props.history.location.search);\n    const urlSource = this.getUrlSource(searchParams);\n    const isSceneApiType = urlSource === \"scenes\";\n    const isFavorites = urlSource === \"favorites\";\n    const showCustomOption =\n      !isFavorites && (!isSceneApiType || this.props.hubChannel.canOrWillIfCreator(\"update_hub\"));\n    const entries = (this.state.result && this.state.result.entries) || [];\n    const hideSearch = urlSource === \"avatars\" || urlSource === \"favorites\";\n    const showEmptyStringOnNoResult = urlSource !== \"avatars\" && urlSource !== \"scenes\";\n\n    // Don't render anything if we just did a feeling lucky query and are waiting on result.\n    if (this.state.selectNextResult) return <div />;\n    const handleCustomClicked = urlSource => {\n      const isAvatarApiType = urlSource === \"avatars\";\n      if (isAvatarApiType) {\n        this.showCustomMediaDialog(urlSource);\n      } else {\n        this.props.performConditionalSignIn(\n          () => !isSceneApiType || this.props.hubChannel.can(\"update_hub\"),\n          () => this.showCustomMediaDialog(urlSource),\n          \"change-scene\"\n        );\n      }\n    };\n\n    return (\n      <div className={styles.mediaBrowser} ref={browserDiv => (this.browserDiv = browserDiv)}>\n        <div className={classNames([styles.box, styles.darkened])}>\n          <div className={classNames(styles.header, { [styles.noSearch]: hideSearch })}>\n            <div className={styles.headerLeft}>\n              <a onClick={() => this.close()}>\n                <i>\n                  <FontAwesomeIcon icon={faTimes} />\n                </i>\n              </a>\n            </div>\n            <div className={styles.headerCenter}>\n              {urlSource === \"favorites\" && (\n                <div className={styles.favoritesHeader}>\n                  <i>\n                    <FontAwesomeIcon icon={faStar} />\n                  </i>\n                  <FormattedMessage id=\"media-browser.favorites-header\" />\n                </div>\n              )}\n              {!hideSearch && (\n                <div className={styles.search}>\n                  <i className={styles.searchIcon}>\n                    <FontAwesomeIcon icon={faSearch} />\n                  </i>\n                  <input\n                    type=\"text\"\n                    autoFocus={!isMobile && !isMobileVR}\n                    ref={r => (this.inputRef = r)}\n                    placeholder={formatMessage({\n                      id: `media-browser.search-placeholder.${urlSource}`\n                    })}\n                    onFocus={e => handleTextFieldFocus(e.target)}\n                    onBlur={() => handleTextFieldBlur()}\n                    onKeyDown={e => {\n                      if (e.key === \"Enter\" && e.ctrlKey) {\n                        if (entries.length > 0 && !this._sendQueryTimeout) {\n                          this.handleEntryClicked(e, entries[0]);\n                        } else if (this.state.query.trim() !== \"\") {\n                          this.handleQueryUpdated(this.state.query, true);\n                          this.setState({ selectNextResult: true });\n                        } else {\n                          this.close();\n                        }\n                      } else if (e.key === \"Escape\" || (e.key === \"Enter\" && isMobile)) {\n                        e.target.blur();\n                      }\n                    }}\n                    value={this.state.query}\n                    onChange={e => this.handleQueryUpdated(e.target.value)}\n                  />\n                  <i className={styles.searchClear} onClick={() => this.handleQueryUpdated(\"\", true)}>\n                    <FontAwesomeIcon icon={faTimes} />\n                  </i>\n                </div>\n              )}\n              <div className={styles.engineAttribution}>\n                {!hideSearch &&\n                  urlSource !== \"scenes\" &&\n                  urlSource !== \"avatars\" &&\n                  urlSource !== \"favorites\" && (\n                    <div className={styles.engineAttributionContents}>\n                      <FormattedMessage id={`media-browser.powered_by.${urlSource}`} />\n                      {PRIVACY_POLICY_LINKS[urlSource] && (\n                        <a href={PRIVACY_POLICY_LINKS[urlSource]} target=\"_blank\" rel=\"noreferrer noopener\">\n                          <FormattedMessage id=\"media-browser.privacy_policy\" />\n                        </a>\n                      )}\n                    </div>\n                  )}\n                {urlSource === \"scenes\" && (\n                  <div className={styles.engineAttributionContents}>\n                    <FormattedMessage id={`media-browser.powered_by.${urlSource}`} />\n                    <a href=\"/spoke\" target=\"_blank\" rel=\"noreferrer noopener\">\n                      <FormattedMessage id=\"media-browser.spoke\" />\n                    </a>\n                    |\n                    <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"/?report\">\n                      <FormattedMessage id=\"media-browser.report_issue\" />\n                    </a>\n                  </div>\n                )}\n              </div>\n            </div>\n            <div className={styles.headerRight}>\n              {showCustomOption && (\n                <a onClick={() => handleCustomClicked(urlSource)} className={styles.createButton}>\n                  <i>\n                    <FontAwesomeIcon icon={[\"scenes\", \"avatars\"].includes(urlSource) ? faLink : faCloudUploadAlt} />\n                  </i>\n                </a>\n              )}\n              {showCustomOption && (\n                <a onClick={() => handleCustomClicked(urlSource)} className={styles.createLink}>\n                  <FormattedMessage\n                    id={`media-browser.add_custom_${\n                      this.state.result && isSceneApiType ? \"scene\" : urlSource === \"avatars\" ? \"avatar\" : \"object\"\n                    }`}\n                  />\n                </a>\n              )}\n            </div>\n          </div>\n\n          {this.state.showNav && (\n            <div className={styles.nav}>\n              {SOURCES.map(s => (\n                <a\n                  onClick={() => this.handleSourceClicked(s)}\n                  key={s}\n                  className={classNames({ [styles.navSource]: true, [styles.navSourceSelected]: urlSource === s })}\n                >\n                  <FormattedMessage id={`media-browser.nav_title.${s}`} />\n                </a>\n              ))}\n              <div className={styles.navRightPad}>&nbsp;</div>\n              <div className={styles.navScrollArrow}>\n                <FontAwesomeIcon icon={faAngleRight} />\n              </div>\n            </div>\n          )}\n\n          {this.state.facets &&\n            this.state.facets.length > 0 && (\n              <div className={styles.facets}>\n                {this.state.facets.map((s, i) => (\n                  <a onClick={() => this.handleFacetClicked(s)} key={i} className={styles.facet}>\n                    {s.text}\n                  </a>\n                ))}\n              </div>\n            )}\n\n          {this.props.mediaSearchStore.isFetching ||\n          this._sendQueryTimeout ||\n          (this.state.result && this.state.result.entries.length > 0) ||\n          !showEmptyStringOnNoResult ? (\n            <MediaTiles\n              result={this.state.result}\n              history={this.props.history}\n              urlSource={urlSource}\n              handleEntryClicked={this.handleEntryClicked}\n              handlePager={this.handlePager}\n            />\n          ) : (\n            <div className={styles.emptyString}>\n              <FormattedMessage id={`media-browser.empty.${urlSource}`} />\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default injectIntl(MediaBrowser);\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport giphyLogo from \"../assets/images/giphy_logo.png\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faPaperclip } from \"@fortawesome/free-solid-svg-icons/faPaperclip\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport styles from \"../assets/stylesheets/create-object-dialog.scss\";\nimport cx from \"classnames\";\nimport DialogContainer from \"./dialog-container.js\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nconst attributionHostnames = {\n  \"giphy.com\": giphyLogo,\n  \"media.giphy.com\": giphyLogo\n};\n\nconst DEFAULT_OBJECT_URL = \"https://asset-bundles-prod.reticulum.io/interactables/Ducky/DuckyMesh-438ff8e022.gltf\";\nconst isMobile = AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR();\nconst instructions = \"Paste a URL to an image, video, model, scene, or upload.\";\nconst desktopTips = \"Tip: You can paste URLs directly into Hubs with Ctrl+V\";\nconst references = (\n  <span>\n    For models, try{\" \"}\n    <a href=\"https://sketchfab.com/search?features=downloadable&type=models\" target=\"_blank\" rel=\"noopener noreferrer\">\n      Sketchfab\n    </a>,{\" \"}\n    <a href=\"http://poly.google.com/\" target=\"_blank\" rel=\"noopener noreferrer\">\n      Google Poly\n    </a>, or our{\" \"}\n    <a href=\"https://sketchfab.com/mozillareality\" target=\"_blank\" rel=\"noopener noreferrer\">\n      collection\n    </a>.\n  </span>\n);\n\nconst mobileInstructions = (\n  <div>\n    <p>{instructions}</p>\n    <p>{references}</p>\n  </div>\n);\nconst desktopInstructions = (\n  <div>\n    <p>{instructions}</p>\n    <p>{references}</p>\n    <p>{desktopTips}</p>\n  </div>\n);\n\nlet lastUrl = \"\";\nconst fileInputId = \"file-input\";\n\nexport default class CreateObjectDialog extends Component {\n  state = {\n    url: \"\",\n    file: null,\n    fileName: \"\"\n  };\n\n  static propTypes = {\n    onCreate: PropTypes.func,\n    onClose: PropTypes.func\n  };\n\n  componentDidMount() {\n    this.setState({ url: lastUrl });\n  }\n\n  componentWillUnmount() {\n    lastUrl = this.state.url;\n  }\n\n  onUrlChange = e => {\n    let attributionImage = this.state.attributionImage;\n    if (e.target && e.target.value && e.target.validity.valid) {\n      const url = new URL(e.target.value);\n      attributionImage = attributionHostnames[url.hostname];\n    }\n    this.setState({\n      url: e.target && e.target.value,\n      attributionImage: attributionImage\n    });\n  };\n\n  onFileChange = e => {\n    this.setState({\n      file: e.target.files[0],\n      fileName: e.target.files[0].name\n    });\n  };\n\n  reset = e => {\n    e.preventDefault();\n    this.setState({\n      url: \"\",\n      file: null,\n      fileName: \"\"\n    });\n    this.fileInput.value = null;\n  };\n\n  onCreateClicked = e => {\n    e.preventDefault();\n    this.props.onCreate(this.state.file || this.state.url || DEFAULT_OBJECT_URL);\n    this.props.onClose();\n  };\n\n  render() {\n    const { onCreate, onClose, ...other } = this.props; // eslint-disable-line no-unused-vars\n\n    const cancelButton = (\n      <WithHoverSound>\n        <label className={cx(styles.smallButton, styles.cancelIcon)} onClick={this.reset}>\n          <FontAwesomeIcon icon={faTimes} />\n        </label>\n      </WithHoverSound>\n    );\n    const uploadButton = (\n      <WithHoverSound>\n        <label htmlFor={fileInputId} className={cx(styles.smallButton, styles.uploadIcon)}>\n          <FontAwesomeIcon icon={faPaperclip} />\n        </label>\n      </WithHoverSound>\n    );\n    const filenameLabel = <label className={cx(styles.leftSideOfInput)}>{this.state.fileName}</label>;\n    const urlInput = (\n      <input\n        className={cx(styles.leftSideOfInput)}\n        placeholder=\"Image/Video/glTF URL\"\n        onFocus={e => handleTextFieldFocus(e.target)}\n        onBlur={() => handleTextFieldBlur()}\n        onChange={this.onUrlChange}\n        type=\"url\"\n        value={this.state.url}\n      />\n    );\n\n    return (\n      <DialogContainer title=\"Create Object\" onClose={this.props.onClose} {...other}>\n        <div>\n          {isMobile ? mobileInstructions : desktopInstructions}\n          <form onSubmit={this.onCreateClicked}>\n            <div className={styles.addMediaForm}>\n              <input\n                id={fileInputId}\n                ref={f => (this.fileInput = f)}\n                className={styles.hideFileInput}\n                type=\"file\"\n                onChange={this.onFileChange}\n              />\n              <div className={styles.inputBorder}>\n                {this.state.file ? filenameLabel : urlInput}\n                {this.state.url || this.state.fileName ? cancelButton : uploadButton}\n              </div>\n              <div className={styles.buttons}>\n                <WithHoverSound>\n                  <button className={styles.actionButton}>\n                    <span>Create</span>\n                  </button>\n                </WithHoverSound>\n              </div>\n              {this.state.attributionImage ? (\n                <div>\n                  <img src={this.state.attributionImage} />\n                </div>\n              ) : null}\n            </div>\n          </form>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"../assets/stylesheets/change-scene-dialog.scss\";\nimport cx from \"classnames\";\nimport DialogContainer from \"./dialog-container.js\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport default class ChangeSceneDialog extends Component {\n  state = {\n    url: \"\"\n  };\n\n  static propTypes = {\n    onChange: PropTypes.func,\n    onClose: PropTypes.func\n  };\n\n  onUrlChange = e => {\n    this.setState({\n      url: e.target && e.target.value\n    });\n  };\n\n  reset = e => {\n    e.preventDefault();\n    this.setState({ url: \"\" });\n  };\n\n  onChangeClicked = e => {\n    e.preventDefault();\n\n    if (this.state.url) {\n      this.props.onChange(this.state.url);\n    }\n\n    this.props.onClose();\n  };\n\n  render() {\n    const { onChange, onClose } = this.props; // eslint-disable-line no-unused-vars\n\n    return (\n      <DialogContainer title=\"Custom Scene\" onClose={this.props.onClose}>\n        <div>\n          <div>\n            <p>\n              Paste a URL to a{\" \"}\n              <a href=\"/spoke\" target=\"_blank\" rel=\"noopener noreferrer\">\n                Spoke\n              </a>{\" \"}\n              scene or a URL to a{\" \"}\n              <a href=\"https://en.wikipedia.org/wiki/GlTF#GLB\" target=\"_blank\" rel=\"noopener noreferrer\">\n                GLB\n              </a>.\n            </p>\n          </div>\n          <form onSubmit={this.onChangeClicked}>\n            <div className={styles.changeSceneForm}>\n              <div className={styles.inputBorder}>\n                <input\n                  className={cx(styles.leftSideOfInput)}\n                  placeholder=\"Scene URL\"\n                  onFocus={e => handleTextFieldFocus(e.target)}\n                  onBlur={() => handleTextFieldBlur()}\n                  onChange={this.onUrlChange}\n                  type=\"url\"\n                  value={this.state.url}\n                />\n              </div>\n              <div className={styles.buttons}>\n                <button className={styles.actionButton}>\n                  <FormattedMessage id=\"change-scene-dialog.change-scene\" />\n                </button>\n              </div>\n              <div className={styles.spokeCreate}>\n                <div>\n                  <FormattedMessage id=\"change-scene-dialog.create-in-spoke\" />\n                </div>\n                <a className={styles.spokeLaunch} href=\"/spoke/new\" target=\"_blank\" rel=\"noopener noreferrer\">\n                  <FormattedMessage id=\"change-scene-dialog.new-spoke-project\" />\n                </a>\n              </div>\n            </div>\n          </form>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\n\nimport styles from \"../assets/stylesheets/avatar-url-dialog.scss\";\nimport DialogContainer from \"./dialog-container.js\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\n\nexport default class AvatarUrlDialog extends Component {\n  state = {\n    url: \"\"\n  };\n\n  static propTypes = {\n    onChange: PropTypes.func,\n    onClose: PropTypes.func\n  };\n\n  onUrlChange = e => {\n    this.setState({\n      url: e.target && e.target.value\n    });\n  };\n\n  onChangeClicked = e => {\n    e.preventDefault();\n\n    if (this.state.url) {\n      this.props.onChange(this.state.url);\n    }\n\n    this.props.onClose();\n  };\n\n  render() {\n    return (\n      <DialogContainer title=\"Custom Avatar URL\" className={styles.avatarUrlDialog} onClose={this.props.onClose}>\n        <p>\n          Paste a URL to a{\" \"}\n          <a href=\"https://en.wikipedia.org/wiki/GlTF#GLB\" target=\"_blank\" rel=\"noopener noreferrer\">\n            GLB\n          </a>.\n        </p>\n        <form className=\"form\" onSubmit={this.onChangeClicked}>\n          <input\n            className=\"url-field\"\n            placeholder=\"Avatar GLB URL\"\n            onFocus={e => handleTextFieldFocus(e.target)}\n            onBlur={() => handleTextFieldBlur()}\n            onChange={this.onUrlChange}\n            type=\"url\"\n            value={this.state.url}\n          />\n          <button className=\"submit\">\n            <FormattedMessage id=\"avatar-url-dialog.apply\" />\n          </button>\n        </form>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport DialogContainer from \"./dialog-container.js\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nexport default class HelpDialog extends Component {\n  render() {\n    return (\n      <DialogContainer title=\"Getting Started\" {...this.props}>\n        <div className=\"info-dialog__help\">\n          <p style={{ textAlign: \"center\" }}>\n            Join the Hubs community on{\" \"}\n            <WithHoverSound>\n              <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://discord.gg/wHmY4nd\">\n                Discord\n              </a>\n            </WithHoverSound>\n            !\n          </p>\n          <p>When in a room, other avatars can see and hear you.</p>\n          <p>\n            Use your controller&apos;s action button to teleport from place to place. If it has a grip, use it to pick\n            up objects.\n          </p>\n          <p>\n            In VR, <b>look up</b> to find your menu.\n          </p>\n          <p>\n            The <b>Mic Toggle</b> mutes your mic.\n          </p>\n          <p>\n            The <b>Pause Toggle</b> pauses all other avatars and lets you block others or pin or remove objects.\n          </p>\n          <p>\n            See detailed{\" \"}\n            <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://github.com/mozilla/hubs/wiki/Hubs-Features\">\n              feature\n            </a>{\" \"}\n            and{\" \"}\n            <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://github.com/mozilla/hubs/wiki/Hubs-Controls\">\n              controls\n            </a>{\" \"}\n            documentation.\n          </p>\n          <p className=\"dialog__box__contents__links\">\n            <WithHoverSound>\n              <a target=\"_blank\" rel=\"noopener noreferrer\" href={this.props.termsLink || \"https://github.com/mozilla/hubs/blob/master/TERMS.md\"}>\n                <FormattedMessage id=\"profile.terms_of_use\" />\n              </a>\n            </WithHoverSound>\n            <WithHoverSound>\n              <a\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                href={this.props.privacyLink || \"https://github.com/mozilla/hubs/blob/master/PRIVACY.md\"}\n              >\n                <FormattedMessage id=\"profile.privacy_notice\" />\n              </a>\n            </WithHoverSound>\n            <WithHoverSound>\n              <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"/?report\">\n                <FormattedMessage id=\"help.report_issue\" />\n              </a>\n            </WithHoverSound>\n          </p>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport copy from \"copy-to-clipboard\";\nimport classNames from \"classnames\";\nimport { FormattedMessage } from \"react-intl\";\nimport { share, canShare } from \"../utils/share\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nimport { WithHoverSound } from \"./wrap-with-audio\";\nimport styles from \"../assets/stylesheets/invite-dialog.scss\";\n\nfunction pad(num, size) {\n  let s = `${num}`;\n  while (s.length < size) s = `0${s}`;\n  return s;\n}\n\nexport default class InviteDialog extends Component {\n  static propTypes = {\n    entryCode: PropTypes.number,\n    hubId: PropTypes.string,\n    allowShare: PropTypes.bool,\n    isModal: PropTypes.bool,\n    onClose: PropTypes.func,\n    hasPush: PropTypes.bool,\n    isSubscribed: PropTypes.bool,\n    onSubscribeChanged: PropTypes.func,\n    embedUrl: PropTypes.string\n  };\n\n  state = {\n    copyButtonActive: false,\n    shareButtonActive: false\n  };\n\n  shareClicked = url => {\n    this.setState({ shareButtonActive: true });\n    share({ url, title: \"Join me now in #hubs!\" }).then(() => {\n      this.setState({ shareButtonActive: false });\n    });\n  };\n\n  copyClicked = link => {\n    this.setState({ copyButtonActive: true });\n    setTimeout(() => this.setState({ copyButtonActive: false }), 5000);\n\n    copy(link);\n  };\n\n  render() {\n    const { entryCode, embedUrl } = this.props;\n\n    const entryCodeString = pad(entryCode, 6);\n    const shortLinkText = `hub.link/${this.props.hubId}`;\n    const shortLink = \"https://\" + shortLinkText;\n    const embedText = `<iframe src=\"${embedUrl}\" style=\"width: 1024px; height: 768px;\" allow=\"microphone; camera; vr; speaker;\"></iframe>`;\n\n    return (\n      <div className={classNames({ [styles.dialog]: true, [styles.modal]: this.props.isModal })}>\n        {!this.props.isModal && <div className={styles.attachPoint} />}\n        <WithHoverSound>\n          <button className={styles.close} onClick={() => this.props.onClose()}>\n            <i>\n              <FontAwesomeIcon icon={faTimes} />\n            </i>\n          </button>\n        </WithHoverSound>\n        <div>\n          <FormattedMessage id={`invite.enter_via${this.props.isModal ? \"_modal\" : \"\"}`} />\n          <WithHoverSound>\n            <a href=\"https://hub.link\" target=\"_blank\" className={styles.hubLinkLink} rel=\"noopener noreferrer\">\n              hub.link\n            </a>\n          </WithHoverSound>\n          <FormattedMessage id=\"invite.and_enter_code\" />\n        </div>\n        <div className={styles.code}>\n          {entryCodeString.split(\"\").map((d, i) => (\n            <div className={classNames({ [styles.digit]: true, [styles[`digit_${i}`]]: true })} key={`link_code_${i}`}>\n              {d}\n            </div>\n          ))}\n        </div>\n        <div>\n          <FormattedMessage id={`invite.or_visit${this.props.isModal ? \"_modal\" : \"\"}`} />\n        </div>\n        <div className={styles.domain}>\n          <input type=\"text\" readOnly onFocus={e => e.target.select()} value={shortLinkText} />\n        </div>\n        <div className={styles.buttons}>\n          <WithHoverSound>\n            <button className={styles.linkButton} onClick={this.copyClicked.bind(this, shortLink)}>\n              <span>{this.state.copyButtonActive ? \"copied!\" : \"copy\"}</span>\n            </button>\n          </WithHoverSound>\n          {this.props.allowShare &&\n            canShare() && (\n              <WithHoverSound>\n                <button className={styles.linkButton} onClick={this.shareClicked.bind(this, shortLink)}>\n                  <span>{this.state.shareButtonActive ? \"sharing...\" : \"share\"}</span>\n                </button>\n              </WithHoverSound>\n            )}\n          {this.props.allowShare &&\n            !canShare() && (\n              <WithHoverSound>\n                <button className={styles.linkButton} onClick={this.shareClicked.bind(this, shortLink)}>\n                  <FormattedMessage id=\"invite.tweet\" />\n                </button>\n              </WithHoverSound>\n            )}\n        </div>\n        {embedUrl && (\n          <div className={styles.embed}>\n            <div>\n              <FormattedMessage id={`invite.embed`} />\n            </div>\n            <div className={styles.embedText}>\n              <input\n                type=\"text\"\n                readOnly\n                onFocus={e => {\n                  e.target.select();\n                  this.setState({ showEmbedTip: true });\n                }}\n                onBlur={() => this.setState({ showEmbedTip: false })}\n                value={embedText}\n              />\n            </div>\n            {this.state.showEmbedTip && (\n              <div className={styles.embedTipWrap}>\n                <div className={styles.embedTip}>\n                  <div className={styles.embedTipAttachPoint} />\n                  <FormattedMessage id=\"invite.embed-tip\" />\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n        {this.props.hasPush && (\n          <div className={styles.subscribe}>\n            <input\n              id=\"subscribe\"\n              type=\"checkbox\"\n              onChange={() => this.props.onSubscribeChanged()}\n              checked={this.props.isSubscribed}\n            />\n            <label htmlFor=\"subscribe\">\n              <FormattedMessage id=\"entry.notify_me\" />\n            </label>\n          </div>\n        )}\n\n        {this.props.isModal && (\n          <button className={styles.enterVrButton} onClick={() => this.props.onClose()}>\n            <FormattedMessage id=\"entry.return-to-vr\" />\n          </button>\n        )}\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport DialogContainer from \"./dialog-container.js\";\nimport PropTypes from \"prop-types\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nexport default class InviteTeamDialog extends Component {\n  static propTypes = {\n    hubChannel: PropTypes.object\n  };\n\n  state = {\n    inviteButtonText: \"invite a hubs team member\"\n  };\n\n  constructor(props) {\n    super(props);\n  }\n\n  inviteClicked = () => {\n    this.setState({ inviteButtonText: \"OK! We'll be there shortly.\" });\n    this.props.hubChannel.requestSupport();\n  };\n\n  render() {\n    return (\n      <DialogContainer title=\"Let's Chat!\" {...this.props}>\n        <div>\n          <div>\n            <p>Have an idea for Hubs? Having trouble?</p>\n            <p>We&apos;d love to chat. Someone from our team will join you in just a few minutes.</p>\n          </div>\n          <div className=\"invite-team-form\">\n            <div className=\"invite-team-form__buttons\">\n              <WithHoverSound>\n                <button className=\"invite-team-form__action-button\" onClick={this.inviteClicked}>\n                  <span>{this.state.inviteButtonText}</span>\n                </button>\n              </WithHoverSound>\n            </div>\n          </div>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport { FormattedMessage } from \"react-intl\";\nimport LinkDialogHeader from \"../assets/images/link_dialog_header.svg\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nimport styles from \"../assets/stylesheets/link-dialog.scss\";\n\nexport default class LinkDialog extends Component {\n  static propTypes = {\n    linkCode: PropTypes.string,\n    onClose: PropTypes.func\n  };\n\n  render() {\n    const { linkCode } = this.props;\n\n    return (\n      <div className={styles.dialog}>\n        <WithHoverSound>\n          <div className={styles.close} onClick={() => this.props.onClose()}>\n            <span>×</span>\n          </div>\n        </WithHoverSound>\n        <div>\n          {!linkCode && (\n            <div>\n              <div className={classNames(\"loading-panel\", styles.codeLoadingPanel)}>\n                <div className=\"loader-wrap\">\n                  <div className=\"loader\">\n                    <div className=\"loader-center\" />\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n          {linkCode && (\n            <div className={styles.contents}>\n              <img className={styles.imageHeader} src={LinkDialogHeader} />\n              <div className={styles.header}>\n                <FormattedMessage id=\"link.connect_headset\" />\n              </div>\n              <div>\n                <FormattedMessage id=\"link.in_your_browser\" />\n              </div>\n              <WithHoverSound>\n                <a href=\"https://hub.link\" className={styles.domain} target=\"_blank\" rel=\"noopener noreferrer\">\n                  hub.link\n                </a>\n              </WithHoverSound>\n              <div>\n                <FormattedMessage id=\"link.enter_code\" />\n              </div>\n              {linkCode && (\n                <div className={styles.code}>\n                  {linkCode.split(\"\").map((d, i) => (\n                    <span className={styles.digit} key={`link_code_${i}`}>\n                      {d}\n                    </span>\n                  ))}\n                </div>\n              )}\n              <div className={styles.keepOpen}>\n                <FormattedMessage id=\"link.do_not_close\" />\n              </div>\n              <WithHoverSound>\n                <button className={styles.closeButton} onClick={() => this.props.onClose()}>\n                  <FormattedMessage id=\"link.cancel\" />\n                </button>\n              </WithHoverSound>\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport copy from \"copy-to-clipboard\";\nimport DialogContainer from \"./dialog-container.js\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nexport default class SafariDialog extends Component {\n  state = {\n    copyLinkButtonText: \"copy\"\n  };\n\n  copyLinkClicked = link => {\n    copy(link);\n    this.setState({ copyLinkButtonText: \"copied!\" });\n  };\n\n  render() {\n    const onCopyClicked = this.copyLinkClicked.bind(this, document.location);\n    return (\n      <DialogContainer title=\"Open in Safari\" {...this.props}>\n        <div>\n          <div>We do not currently support your current browser on iOS. Copy and paste this link directly in Safari.</div>\n          <div className=\"invite-form\">\n            <input\n              type=\"text\"\n              readOnly\n              onFocus={e => e.target.select()}\n              value={document.location}\n              className=\"invite-form__link_field\"\n            />\n            <div className=\"invite-form__buttons\">\n              <WithHoverSound>\n                <button className=\"invite-form__action-button\" onClick={onCopyClicked}>\n                  <span>{this.state.copyLinkButtonText}</span>\n                </button>\n              </WithHoverSound>\n            </div>\n          </div>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport DialogContainer from \"./dialog-container.js\";\n\nexport default class SafariMicDialog extends Component {\n  render() {\n    return (\n      <DialogContainer title=\"Microphone Access Required\" {...this.props}>\n        <div>\n          <div>\n            Hubs requires microphone permissions in Safari. <br />\n            Please reload and allow microphone access to continue.\n          </div>\n          <div className=\"invite-form\">\n            <div className=\"invite-form__buttons\">\n              <button className=\"invite-form__action-button\" onClick={() => location.reload()}>\n                Reload\n              </button>\n            </div>\n          </div>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport cx from \"classnames\";\nimport { FormattedMessage } from \"react-intl\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\n\nimport styles from \"../assets/stylesheets/room-settings-dialog.scss\";\nimport DialogContainer from \"./dialog-container\";\n\nexport default class RoomSettingsDialog extends Component {\n  static propTypes = {\n    initialSettings: PropTypes.object,\n    onChange: PropTypes.func,\n    onClose: PropTypes.func\n  };\n\n  constructor(props) {\n    super(props);\n    this.state = props.initialSettings;\n  }\n\n  onSubmit = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    this.props.onChange(this.state);\n    this.props.onClose();\n  };\n\n  renderCheckbox(member_permission, disabled, onChange) {\n    return (\n      <label className={cx(styles.permission, { [styles.permissionDisabled]: disabled })} key={member_permission}>\n        <input\n          type=\"checkbox\"\n          checked={this.state.member_permissions[member_permission]}\n          disabled={disabled}\n          onChange={\n            onChange ||\n            (e =>\n              this.setState({\n                member_permissions: { ...this.state.member_permissions, [member_permission]: e.target.checked }\n              }))\n          }\n        />\n        <FormattedMessage id={`room-settings.${member_permission}`} />\n      </label>\n    );\n  }\n\n  render() {\n    return (\n      <DialogContainer title=\"Room Settings\" {...this.props}>\n        <form onSubmit={this.onSubmit} className={styles.roomSettingsForm}>\n          <span className={styles.subtitle}>\n            <FormattedMessage id=\"room-settings.name-subtitle\" />\n          </span>\n          <input\n            name=\"name\"\n            type=\"text\"\n            required\n            autoFocus\n            autoComplete=\"off\"\n            placeholder=\"Room name\"\n            value={this.state.name}\n            onFocus={e => handleTextFieldFocus(e.target)}\n            onBlur={() => handleTextFieldBlur()}\n            onChange={e => this.setState({ name: e.target.value })}\n            className={styles.nameField}\n          />\n          <span className={styles.subtitle}>\n            <FormattedMessage id=\"room-settings.permissions-subtitle\" />\n          </span>\n          <div className={styles.permissions}>\n            {this.renderCheckbox(\"spawn_and_move_media\", false, e => {\n              const newMemberPermissions = {\n                spawn_and_move_media: e.target.checked\n              };\n              if (!e.target.checked) {\n                newMemberPermissions.spawn_camera = false;\n                newMemberPermissions.pin_objects = false;\n              }\n              this.setState({ member_permissions: { ...this.state.member_permissions, ...newMemberPermissions } });\n            })}\n            <div className={styles.permissionsGroup}>\n              {this.renderCheckbox(\"spawn_camera\", !this.state.member_permissions.spawn_and_move_media)}\n              {this.renderCheckbox(\"pin_objects\", !this.state.member_permissions.spawn_and_move_media)}\n            </div>\n            {this.renderCheckbox(\"spawn_drawing\")}\n          </div>\n          <button type=\"submit\" className={styles.nextButton}>\n            <FormattedMessage id=\"room-settings.apply\" />\n          </button>\n        </form>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\n\nimport styles from \"../assets/stylesheets/close-room-dialog.scss\";\nimport DialogContainer from \"./dialog-container\";\n\nexport default class CloseRoomDialog extends Component {\n  static propTypes = {\n    onConfirm: PropTypes.func,\n    onClose: PropTypes.func\n  };\n\n  render() {\n    return (\n      <DialogContainer title=\"Close Room\" {...this.props}>\n        <div className={styles.message}>\n          <FormattedMessage id=\"close-room.message\" />\n        </div>\n        <button\n          className={styles.confirmButton}\n          onClick={() => {\n            this.props.onConfirm();\n            this.props.onClose();\n          }}\n        >\n          <FormattedMessage id=\"close-room.confirm\" />\n        </button>\n        <button className={styles.cancelButton} onClick={() => this.props.onClose()}>\n          <FormattedMessage id=\"close-room.cancel\" />\n        </button>\n      </DialogContainer>\n    );\n  }\n}\n","import { sets } from \"./userinput/sets\";\nimport { paths } from \"./userinput/paths\";\n\n// The output of this system is activeTips which shows, if any, the tips to show at the top\n// and bottom of the screen. There are named tips (eg locomotion) that each have validators.\n//\n// Each frame we run all the non-finished validators and take the first tip (by order)\n// which is VALID. Any tip that returns FINISHED will no longer be considered without\n// a local storage reset.\n\n// Validators can return these values:\n//\n// INVALID - Tip is not valid to show\n// VALID - Tip is valid to show\n// FINISH - Tip should always be assumed INVALID going forward\n//\n//\n// Tips have \"scope\", which is a certain context within which the validators are run (right now,\n// just the top of bottom of the screen.) They are also platform-local.\nconst INVALID = 0;\nconst VALID = 1;\nconst FINISH = 2;\n\nconst LOCAL_STORAGE_KEY = \"__hubs_finished_tips\";\nconst NUM_ENTRIES_FOR_FEEDBACK_TIP = 3;\n\nconst TIPS = {\n  desktop: {\n    top: [\"pen_mode\", \"video_share_mode\", \"mute_mode\"],\n    bottom: [\n      \"look\",\n      \"locomotion\",\n      \"turning\",\n      \"spawn_menu\",\n      \"object_grab\",\n      \"object_zoom\",\n      \"object_scale\",\n      \"freeze_gesture\",\n      \"menu_hover\",\n      \"object_recenter_button\",\n      \"object_rotate_button\",\n      \"object_scale_button\",\n      \"object_pin\",\n      \"invite\",\n      \"pen_color\",\n      \"pen_size\",\n      \"feedback\"\n    ]\n  },\n  mobile: {\n    top: [\"pen_mode\", \"video_share_mode\", \"freeze_mode\", \"mute_mode\"],\n    bottom: [\n      \"look\",\n      \"locomotion\",\n      \"spawn_menu\",\n      \"object_grab\",\n      \"freeze_gesture\",\n      \"object_recenter_button\",\n      \"object_rotate_button\",\n      \"object_scale_button\",\n      \"object_pin\",\n      \"invite\",\n      \"feedback\"\n    ]\n  },\n  standalone: { top: [], bottom: [] }\n};\n\n// These tips, if closed, will only clear themselves, not all tips.\nconst LOCAL_CLOSE_TIPS = [\"feedback\", \"invite\", \"object_pin\"];\n\n// These tips will remain active even if the user closes the tips globally.\nconst KEEP_ACTIVE_AFTER_GLOBAL_CLOSE = [\"feedback\"];\n\nlet localStorageCache = null;\nlet finishedScopes = {}; // Optimization, lets system skip scopes altogether once finished.\n\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\n\nconst tipPlatform = () => {\n  if (isMobileVR) return \"standalone\";\n  return isMobile ? \"mobile\" : \"desktop\";\n};\n\nconst platformTips = TIPS[tipPlatform()];\n\nconst isTipFinished = tip => {\n  if (localStorageCache === null) {\n    localStorageCache = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY));\n  }\n\n  return !!(localStorageCache[tip] && localStorageCache[tip].finished);\n};\n\nexport const markTipFinished = tip => {\n  const storeData = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY));\n  storeData[tip] = { finished: true };\n  localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(storeData));\n  localStorageCache = null;\n};\n\nexport const handleTipClose = (fullTip, scope) => {\n  const tip = fullTip.split(\".\")[1];\n\n  // Invite and pinning tips should be locally cleared, others should clear all remaining tips.\n  const tips = LOCAL_CLOSE_TIPS.includes(tip) ? [tip] : platformTips[scope];\n\n  for (let i = 0; i < tips.length; i++) {\n    const t = tips[i];\n\n    if (!KEEP_ACTIVE_AFTER_GLOBAL_CLOSE.includes(t) || t === tip) {\n      markTipFinished(t);\n    }\n  }\n};\n\nexport const resetTips = () => {\n  localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify({}));\n  localStorageCache = null;\n  window.APP.store.resetTipActivityFlags();\n  window.APP.store.resetConfirmedBroadcastedRooms();\n  finishedScopes = {};\n};\n\nconst VALIDATORS = {\n  look: function(userinput) {\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    const cameraDelta = userinput.get(\n      isMobile ? paths.device.touchscreen.touchCameraDelta : paths.device.smartMouse.cameraDelta\n    );\n    return cameraDelta ? FINISH : VALID;\n  },\n  locomotion: function(userinput) {\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    const accel = userinput.get(paths.actions.characterAcceleration);\n\n    // User moved\n    return accel && (accel[0] !== 0 || accel[1] !== 0) ? FINISH : VALID;\n  },\n  turning: function(userinput) {\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (userinput.get(paths.actions.snapRotateLeft) || userinput.get(paths.actions.snapRotateRight)) return FINISH;\n    return VALID;\n  },\n  spawn_menu: function(userinput, scene, mediaCounter) {\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (mediaCounter.count() === 0) return VALID;\n    return FINISH;\n  },\n  freeze_gesture: function(userinput, scene, mediaCounter) {\n    if (mediaCounter.count() === 0) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingInteractable)) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (scene.is(\"frozen\") && userinput.activeSets.includes(sets.cursorHoveringOnInteractable)) return FINISH;\n    return scene.is(\"frozen\") ? INVALID : VALID;\n  },\n  menu_hover: function(userinput, scene, mediaCounter) {\n    if (mediaCounter.count() === 0) return INVALID;\n    if (!scene.is(\"frozen\")) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (scene.is(\"frozen\") && userinput.activeSets.includes(sets.cursorHoveringOnInteractable)) return FINISH;\n    return VALID;\n  },\n  invite: function(userinput, scene) {\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingCamera)) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingInteractable)) return INVALID;\n    return scene.is(\"copresent\") ? FINISH : VALID;\n  },\n  object_grab: function(userinput, scene, mediaCounter) {\n    if (scene.is(\"frozen\")) return INVALID;\n    if (mediaCounter.count() === 0) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingCamera)) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingInteractable)) return FINISH;\n    return VALID;\n  },\n  object_rotate_button: function(userinput, scene, mediaCounter, store) {\n    if (!scene.is(\"frozen\")) return INVALID;\n    if (mediaCounter.count() === 0) return INVALID;\n    if (store && store.state.activity.hasRotated) return FINISH;\n    return VALID;\n  },\n  object_scale_button: function(userinput, scene, mediaCounter, store) {\n    if (!scene.is(\"frozen\")) return INVALID;\n    if (mediaCounter.count() === 0) return INVALID;\n    if (store && store.state.activity.hasScaled) return FINISH;\n    return VALID;\n  },\n  object_recenter_button: function(userinput, scene, mediaCounter, store) {\n    if (!scene.is(\"frozen\")) return INVALID;\n    if (mediaCounter.count() === 0) return INVALID;\n    if (store && store.state.activity.hasRecentered) return FINISH;\n    return VALID;\n  },\n  object_pin: function(userinput, scene, mediaCounter, store) {\n    if (!scene.is(\"frozen\")) return INVALID;\n    if (mediaCounter.count() === 0) return INVALID;\n    if (store && store.state.activity.hasPinned) return FINISH;\n    return VALID;\n  },\n  object_zoom: function(userinput, scene) {\n    if (scene.is(\"frozen\")) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingCamera)) return INVALID;\n    if (!userinput.activeSets.includes(sets.cursorHoldingInteractable)) return INVALID;\n    if (userinput.get(paths.actions.cursor.modDelta)) return FINISH;\n    return VALID;\n  },\n  object_scale: function(userinput, scene) {\n    if (scene.is(\"frozen\")) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (userinput.activeSets.includes(sets.cursorHoldingCamera)) return INVALID;\n    if (!userinput.activeSets.includes(sets.cursorHoldingInteractable)) return INVALID;\n    if (userinput.get(paths.actions.cursor.scaleGrabbedGrabbable)) return FINISH;\n    return VALID;\n  },\n  pen_color: function(userinput) {\n    if (!userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (userinput.get(paths.actions.cursor.penNextColor) || userinput.get(paths.actions.cursor.penPrevColor)) {\n      return FINISH;\n    }\n    return VALID;\n  },\n  pen_size: function(userinput) {\n    if (!userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    if (userinput.get(paths.actions.cursor.scalePenTip)) return FINISH;\n    return VALID;\n  },\n  pen_mode: function(userinput) {\n    if (!userinput.activeSets.includes(sets.cursorHoldingPen)) return INVALID;\n    return VALID;\n  },\n  freeze_mode: function(userinput, scene) {\n    return scene.is(\"frozen\") ? VALID : INVALID;\n  },\n  video_share_mode: function(userinput, scene) {\n    return scene.is(\"sharing_video\") ? VALID : INVALID;\n  },\n  mute_mode: function(userinput, scene) {\n    return scene.is(\"muted\") ? VALID : INVALID;\n  },\n  feedback: function(userinput, scene, mediaCounter, store) {\n    if (store && store.state.activity.entryCount >= NUM_ENTRIES_FOR_FEEDBACK_TIP) return VALID;\n    return INVALID;\n  }\n};\n\nAFRAME.registerSystem(\"tips\", {\n  init: function() {\n    this.activeTips = {};\n    this._finishedScopes = {};\n    this._performStep = this._performStep.bind(this);\n\n    if (localStorage.getItem(LOCAL_STORAGE_KEY) === null) {\n      localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify({}));\n    }\n  },\n\n  tick: function() {\n    if (isMobileVR) return; // Optimization for now, don't bother with this on mobile VR until we have real tips\n\n    if (!this._userinput) {\n      this._userinput = this.el.systems.userinput;\n\n      if (!this._userinput) return;\n    }\n\n    if (!this._mediaCounter) {\n      this._mediaCounter =\n        document.querySelector(\"#media-counter\") &&\n        document.querySelector(\"#media-counter\").components[\"networked-counter\"];\n\n      if (!this._mediaCounter) return;\n    }\n\n    const tips = platformTips;\n\n    const prevTop = this.activeTips.top;\n    const prevBottom = this.activeTips.bottom;\n\n    this._performStep(tips.top, \"top\");\n    this._performStep(tips.bottom, \"bottom\");\n\n    if (prevTop !== this.activeTips.top || prevBottom !== this.activeTips.bottom) {\n      this.el.emit(\"tips_changed\", this.activeTips);\n    }\n  },\n\n  _performStep: function(tips, scope) {\n    if (finishedScopes[scope]) return;\n\n    let chosenTip = null;\n    let finishCount = 0;\n\n    for (let i = 0; i < tips.length; i++) {\n      const tip = tips[i];\n      if (isTipFinished(tip)) {\n        finishCount++;\n        continue;\n      }\n\n      switch (VALIDATORS[tip](this._userinput, this.el, this._mediaCounter, window.APP.store)) {\n        case FINISH:\n          markTipFinished(tip);\n          break;\n        case VALID:\n          chosenTip = `${tipPlatform()}.${tip}`;\n          break;\n      }\n\n      if (chosenTip) break;\n    }\n\n    this.activeTips[scope] = chosenTip;\n\n    if (finishCount === tips.length) {\n      // Optimization: Tips are completed for this scope, no need to re-walk.\n      finishedScopes[scope] = true;\n    }\n  }\n});\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\nimport classNames from \"classnames\";\nimport styles from \"../assets/stylesheets/tip.scss\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport { handleTipClose } from \"../systems/tips.js\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nexport default class Tip extends Component {\n  static propTypes = {\n    history: PropTypes.object,\n    tip: PropTypes.string,\n    tipRegion: PropTypes.string,\n    broadcastTarget: PropTypes.string,\n    pushHistoryState: PropTypes.func,\n    onClose: PropTypes.func\n  };\n\n  render() {\n    const { tip, tipRegion, broadcastTarget, pushHistoryState } = this.props;\n    let tipBody;\n\n    if ([\".spawn_menu\", \"_button\"].find(x => tip.endsWith(x))) {\n      tipBody = (\n        <div className={styles.splitTip}>\n          <FormattedMessage id={`tips.${tip}-pre`} />\n          <div\n            className={classNames({\n              [styles.splitTipIcon]: true,\n              [styles[tip.split(\".\")[1] + \"-icon\"]]: true\n            })}\n          />\n          <FormattedMessage id={`tips.${tip}-post`} />\n        </div>\n      );\n    } else if (tip === \"discord\") {\n      tipBody = (\n        <div className={styles.tip}>\n          <span>{`Chat in this room is being bridged to ${broadcastTarget} on Discord.`}</span>\n        </div>\n      );\n    } else if (tip === \"embed\") {\n      tipBody = (\n        <div className={styles.tip}>\n          <FormattedMessage id=\"embed.presence-warning\" />\n        </div>\n      );\n    } else if (tip.endsWith(\".feedback\")) {\n      tipBody = (\n        <div className={styles.tip}>\n          <FormattedMessage id={`tips.${tip}`} />\n          &nbsp;\n          <button\n            className={styles.tipLink}\n            onClick={() => {\n              handleTipClose(tip, tipRegion);\n              pushHistoryState(\"modal\", \"feedback\");\n            }}\n          >\n            <FormattedMessage id={`tips.${tip}-link`} />\n          </button>\n        </div>\n      );\n    } else {\n      tipBody = (\n        <div className={styles.tip}>\n          <FormattedMessage id={`tips.${tip}`} />\n        </div>\n      );\n    }\n\n    return (\n      <div className={styles.tipRoot}>\n        <button\n          className={styles.tipCancel}\n          onClick={() => (this.props.onClose ? this.props.onClose(tip, tipRegion) : handleTipClose(tip, tipRegion))}\n        >\n          <i>\n            <FontAwesomeIcon icon={faTimes} />\n          </i>\n        </button>\n        {tipBody}\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport DialogContainer from \"./dialog-container.js\";\n\nexport default class WebRTCScreenshareUnsupportedDialog extends Component {\n  render() {\n    return (\n      <DialogContainer title=\"Share Screen\" {...this.props}>\n        <div style={{ display: \"flex\", flexDirection: \"column\", alignItems: \"center\" }}>\n          <p>\n            Your browser doesn&apos;t seem to support screen sharing.\n            <br />\n            To share your screen in Hubs, you can use Firefox.\n          </p>\n          <a\n            className=\"info-dialog--action-button\"\n            target=\"_blank\"\n            rel=\"noreferrer noopener\"\n            href=\"https://www.mozilla.org/firefox\"\n          >\n            Download Firefox\n          </a>\n          <p style={{ fontSize: \"0.8em\" }}>\n            You can try&nbsp;\n            <a\n              href=\"https://www.webrtc-experiment.com/screen-sharing/#5591174797993739\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n            >\n              testing WebRTC screen sharing\n            </a>&nbsp;in your browser.\n          </p>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport DialogContainer from \"./dialog-container.js\";\n\nexport default class WebAssemblyUnsupportedDialog extends Component {\n  render() {\n    return (\n      <DialogContainer title=\"WebAssembly Unsupported\" {...this.props}>\n        <div style={{ display: \"flex\", flexDirection: \"column\", alignItems: \"center\" }}>\n          <p>\n            Your browser doesn&apos;t seem to support WebAssembly.\n            <br />\n            Please update or switch to a newer browser.\n          </p>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport DialogContainer from \"./dialog-container.js\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nexport default class WebVRRecommendDialog extends Component {\n  render() {\n    return (\n      <DialogContainer title=\"Enter in VR\" {...this.props}>\n        <div style={{ display: \"flex\", flexDirection: \"column\", alignItems: \"center\" }}>\n          <p>To enter with Oculus or SteamVR, you can use Firefox.</p>\n          <WithHoverSound>\n            <a\n              className=\"info-dialog--action-button\"\n              href=\"https://www.mozilla.org/firefox\"\n              target=\"_blank\"\n              rel=\"noreferrer noopener\"\n            >\n              Download Firefox\n            </a>\n          </WithHoverSound>\n          <p style={{ fontSize: \"0.8em\" }}>\n            For a list of browsers with experimental VR support, visit{\" \"}\n            <WithHoverSound>\n              <a href=\"https://webvr.rocks\" target=\"_blank\" rel=\"noopener noreferrer\">\n                WebVR Rocks\n              </a>\n            </WithHoverSound>\n          </p>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport DialogContainer from \"./dialog-container.js\";\nimport styles from \"../assets/stylesheets/feedback-dialog.scss\";\n\nexport default class FeedbackDialog extends Component {\n  render() {\n    return (\n      <DialogContainer wide={true} title=\"\" {...this.props}>\n        <iframe\n          className={styles.formFrame}\n          src=\"https://docs.google.com/forms/d/e/1FAIpQLSe1C-7hCA1XMT8IL8XBnjlxMAU1JXrwAW8YkbmbBJ4B3pDSsw/viewform?embedded=true\"\n          frameBorder=\"0\"\n          marginHeight=\"0\"\n          marginWidth=\"0\"\n        >\n          Loading...\n        </iframe>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport DialogContainer from \"./dialog-container.js\";\nimport styles from \"../assets/stylesheets/leave-room-dialog.scss\";\nimport { FormattedMessage } from \"react-intl\";\nimport PropTypes from \"prop-types\";\n\nexport default class LeaveRoomDialog extends Component {\n  static propTypes = {\n    messageType: PropTypes.string,\n    destinationUrl: PropTypes.string\n  };\n\n  render() {\n    return (\n      <DialogContainer title=\"Leave Room\" {...this.props}>\n        <div className={styles.leaveRoom}>\n          <div>\n            <FormattedMessage id={`leave-room-dialog.${this.props.messageType}.message`} />\n          </div>\n          <a href={this.props.destinationUrl} rel=\"noopener noreferrer\">\n            <FormattedMessage id={`leave-room-dialog.${this.props.messageType}.confirm`} />\n          </a>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport DialogContainer from \"./dialog-container.js\";\nimport styles from \"../assets/stylesheets/room-info-dialog.scss\";\nimport { scaledThumbnailUrlFor } from \"../utils/media-url-utils\";\n\nexport default class RoomInfoDialog extends Component {\n  static propTypes = {\n    hubName: PropTypes.string,\n    scene: PropTypes.object\n  };\n\n  render() {\n    const toAttributionDiv = (a, i) => {\n      if (a.url) {\n        const source = a.url.includes(\"sketchfab.com\")\n          ? \"on Sketchfab\"\n          : a.url.includes(\"poly.google.com\")\n            ? \"on Google Poly\"\n            : \"\";\n\n        return (\n          <div className={styles.attribution} key={`${a.url} ${i}`}>\n            <div className={styles.attributionName}>\n              <a href={a.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                {a.name}\n              </a>\n            </div>\n            <div className={styles.attributionAuthor}>\n              by {a.author} {source}\n            </div>\n          </div>\n        );\n      } else {\n        return (\n          <div className={styles.attribution} key={`${a.name} ${a.author} {i}`}>\n            <div className={styles.attributionName}>{a.name}</div>\n            <div className={styles.attributionAuthor}>by {a.author}</div>\n          </div>\n        );\n      }\n    };\n\n    let attributions = null;\n    let creator = null;\n\n    if (this.props.scene.attributions) {\n      creator = this.props.scene.attributions.creator;\n      attributions = (\n        <div>\n          {this.props.scene.attributions.content && this.props.scene.attributions.content.map(toAttributionDiv)}\n        </div>\n      );\n    }\n\n    const title = <div className={styles.title}>{this.props.hubName}</div>;\n\n    return (\n      <DialogContainer title={title} wide={true} {...this.props}>\n        <div className={styles.roomInfo}>\n          <div className={styles.sceneScreenshot}>\n            <a href={this.props.scene.url} target=\"_blank\" rel=\"noopener noreferrer\">\n              <img src={scaledThumbnailUrlFor(this.props.scene.screenshot_url, 400, 480)} />\n            </a>\n          </div>\n          <div className={styles.sceneDetails}>\n            <div className={styles.sceneMain}>\n              <div className={styles.sceneName}>\n                <a href={this.props.scene.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                  {this.props.scene.name}\n                </a>\n              </div>\n              <div className={styles.sceneCreator}>{creator}</div>\n            </div>\n            <div className={styles.sceneAttributions}>{attributions}</div>\n            <div className={styles.sceneButtons}> </div>\n          </div>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport DialogContainer from \"./dialog-container.js\";\nimport { FormattedMessage } from \"react-intl\";\nimport styles from \"../assets/stylesheets/oauth-dialog.scss\";\nimport classNames from \"classnames\";\n\nexport default class OAuthDialog extends Component {\n  static propTypes = {\n    oauthInfo: PropTypes.array\n  };\n  renderSignInDisclaimer(type) {\n    return (\n      <div>\n        <div>\n          You&apos;ll need to sign in to <span className={styles.oauthTypeName}>{type}</span> to access this room.\n        </div>\n        <br />\n        <div>We&apos;ll ask for access to your e-mail address so you can skip signing in next time.</div>\n        <p className={styles.privacyNotice}>\n          By proceeding, you agree to the{\" \"}\n          <a rel=\"noopener noreferrer\" target=\"_blank\" href={this.props.termsLink || \"https://github.com/mozilla/hubs/blob/master/TERMS.md\"}>\n            terms of use\n          </a>{\" \"}\n          and{\" \"}\n          <a rel=\"noopener noreferrer\" target=\"_blank\" href={this.props.privacyLink || \"https://github.com/mozilla/hubs/blob/master/PRIVACY.md\"}>\n            privacy notice\n          </a>.\n        </p>\n      </div>\n    );\n  }\n\n  renderTweetDisclaimer() {\n    return (\n      <div className={styles.twitterMessage}>\n        <FormattedMessage id=\"oauth-dialog.message.twitter\" />\n      </div>\n    );\n  }\n\n  render() {\n    const info = this.props.oauthInfo && this.props.oauthInfo[0];\n    const closable = info && info.type === \"twitter\"; // NOTE: for now, allow closing dialog if doing Twitter sign in (currently just for sharing)\n\n    return (\n      <DialogContainer title=\"\" closable={closable} {...this.props}>\n        <div>\n          {info && (info.type === \"twitter\" ? this.renderTweetDisclaimer() : this.renderSignInDisclaimer(info.type))}\n          <div className=\"invite-form\">\n            <div className={`invite-form__buttons ${styles.oauthButtons}`}>\n              {info ? (\n                <a\n                  href={info.url}\n                  key={info.type}\n                  className={classNames({\n                    [styles.oauthButton]: true,\n                    [styles.oauthTwitterButton]: info.type === \"twitter\",\n                    [styles.oauthDiscordButton]: info.type === \"discord\"\n                  })}\n                >\n                  <FormattedMessage id={`oauth-dialog.sign-in.${info.type}`} />\n                </a>\n              ) : (\n                <div className=\"loader-wrap loader-mid\">\n                  <div className=\"loader\">\n                    <div className=\"loader-center\" />\n                  </div>\n                </div>\n              )}\n            </div>\n          </div>\n        </div>\n      </DialogContainer>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport DialogContainer from \"./dialog-container.js\";\nimport styles from \"../assets/stylesheets/tweet-dialog.scss\";\nimport Editor, { createEditorStateWithText } from \"draft-js-plugins-editor\";\nimport { FormattedMessage } from \"react-intl\";\nimport { fetchReticulumAuthenticated } from \"../utils/phoenix-utils\";\nimport createEmojiPlugin from \"draft-js-emoji-plugin\";\nimport createHashtagPlugin from \"draft-js-hashtag-plugin\";\nimport createLinkifyPlugin from \"draft-js-linkify-plugin\";\nimport createCounterPlugin from \"draft-js-counter-plugin\";\nimport classNames from \"classnames\";\nimport { scaledThumbnailUrlFor } from \"../utils/media-url-utils\";\nimport { Modifier, EditorState } from \"draft-js\";\nimport \"draft-js-emoji-plugin/lib/plugin.css\";\nimport \"draft-js-hashtag-plugin/lib/plugin.css\";\nimport \"draft-js-linkify-plugin/lib/plugin.css\";\nimport \"draft-js-counter-plugin/lib/plugin.css\";\n\nconst emojiPlugin = createEmojiPlugin();\nconst hashtagPlugin = createHashtagPlugin();\nconst linkifyPlugin = createLinkifyPlugin();\nconst counterPlugin = createCounterPlugin();\n\n// Taken from draft-js-emoji\nconst addEmoji = (emoji, editorState) => {\n  const contentState = editorState.getCurrentContent();\n  const contentStateWithEntity = contentState.createEntity(\"emoji\", \"IMMUTABLE\", { emojiUnicode: emoji });\n  const entityKey = contentStateWithEntity.getLastCreatedEntityKey();\n  const currentSelectionState = editorState.getSelection();\n\n  let emojiAddedContent;\n  let emojiEndPos = 0;\n  let blockSize = 0;\n\n  // in case text is selected it is removed and then the emoji is added\n  const afterRemovalContentState = Modifier.removeRange(contentState, currentSelectionState, \"backward\");\n\n  // deciding on the position to insert emoji\n  const targetSelection = afterRemovalContentState.getSelectionAfter();\n\n  emojiAddedContent = Modifier.insertText(afterRemovalContentState, targetSelection, emoji, null, entityKey);\n\n  emojiEndPos = targetSelection.getAnchorOffset();\n  const blockKey = targetSelection.getAnchorKey();\n  blockSize = contentState.getBlockForKey(blockKey).getLength();\n\n  // If the emoji is inserted at the end, a space is appended right after for\n  // a smooth writing experience.\n  if (emojiEndPos === blockSize) {\n    emojiAddedContent = Modifier.insertText(emojiAddedContent, emojiAddedContent.getSelectionAfter(), \" \");\n  }\n\n  const newEditorState = EditorState.push(editorState, emojiAddedContent, \"insert-emoji\");\n  return EditorState.forceSelection(newEditorState, emojiAddedContent.getSelectionAfter());\n};\n\nexport default class TweetDialog extends Component {\n  static propTypes = {\n    history: PropTypes.object,\n    onClose: PropTypes.func\n  };\n\n  constructor(props) {\n    super();\n\n    this.state = {\n      editorState: createEditorStateWithText(props.history.location.state.detail.text || \"\"),\n      suggestions: []\n    };\n  }\n\n  componentDidMount() {\n    // Calling this immediately seems to break editor initialization\n    setTimeout(() => {\n      this.editorRef.focus();\n\n      // Other attempts at doing this resulted in no visible cursor or weird editor behavior:\n      this.setState({ editorState: addEmoji(\"🐤\", this.state.editorState) });\n    });\n  }\n\n  async sendTweet() {\n    // For now assume url is a stored file media url\n    const media_stored_file_url = this.props.history.location.state.detail.url;\n    const body = this.state.editorState.getCurrentContent().getPlainText();\n\n    const payload = { media_stored_file_url, body };\n    this.setState({ posting: true });\n    await fetchReticulumAuthenticated(\"/api/v1/twitter/tweets\", \"POST\", payload);\n    this.setState({ posting: false, posted: true });\n  }\n\n  renderPostedDialog() {\n    return (\n      <DialogContainer wide={true} allowOverflow={true} closable={false} title=\"\" {...this.props}>\n        <div className={styles.posted}>\n          <div className={styles.message}>\n            <FormattedMessage id=\"tweet-dialog.posted\" />\n          </div>\n\n          <div className={styles.buttons}>\n            <button className={styles.tweetButton} onClick={() => this.props.onClose()}>\n              <FormattedMessage id=\"tweet-dialog.close\" />\n            </button>\n          </div>\n        </div>\n      </DialogContainer>\n    );\n  }\n\n  renderTweetDialog() {\n    const { EmojiSuggestions, EmojiSelect } = emojiPlugin;\n    const { CharCounter } = counterPlugin;\n    const { url, contentSubtype } = this.props.history.location.state.detail;\n\n    return (\n      <DialogContainer\n        wide={true}\n        allowOverflow={true}\n        title=\"\"\n        additionalClass={styles.dialogBackground}\n        {...this.props}\n      >\n        <div className={styles.tweet}>\n          <div className={styles.editor} onClick={() => this.editorRef.focus()}>\n            <div className={styles.editorInner}>\n              <Editor\n                ref={r => (this.editorRef = r)}\n                editorState={this.state.editorState}\n                onChange={editorState => this.setState({ editorState })}\n                plugins={[emojiPlugin, hashtagPlugin, linkifyPlugin, counterPlugin]}\n              />\n            </div>\n\n            <div className={styles.emojiButton}>\n              <EmojiSelect />\n            </div>\n\n            <div className={styles.emojiSuggestions}>\n              <EmojiSuggestions />\n            </div>\n\n            {this.state.editorState.getCurrentContent().getPlainText().length > 200 && (\n              <div className={styles.counter}>\n                <CharCounter editorState={this.state.editorState} limit={280} /> / 280\n              </div>\n            )}\n\n            <div className={styles.media}>\n              {contentSubtype && contentSubtype.startsWith(\"video\") ? (\n                <video src={url} width={450} height={255} controls />\n              ) : (\n                <img src={scaledThumbnailUrlFor(url, 450, 255)} />\n              )}\n            </div>\n          </div>\n\n          {!this.state.posting ? (\n            <div className={styles.buttons}>\n              <button\n                className={styles.tweetButton}\n                onClick={() => this.sendTweet()}\n                disabled={this.state.editorState.getCurrentContent().getPlainText().length > 280}\n              >\n                <FormattedMessage id=\"tweet-dialog.tweet\" />\n              </button>\n            </div>\n          ) : (\n            <div className={classNames([\"loader-wrap\", \"loader-mid\", styles.tweetLoader])}>\n              <div className=\"loader\">\n                <div className=\"loader-center\" />\n              </div>\n            </div>\n          )}\n        </div>\n      </DialogContainer>\n    );\n  }\n\n  render() {\n    if (this.state.posted) {\n      return this.renderPostedDialog();\n    } else {\n      return this.renderTweetDialog();\n    }\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"../assets/stylesheets/message-entry.scss\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\nimport { faPaperPlane } from \"@fortawesome/free-solid-svg-icons/faPaperPlane\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nclass LobbyChatBox extends Component {\n  static propTypes = {\n    discordBridges: PropTypes.array,\n    occupantCount: PropTypes.number,\n    onSendMessage: PropTypes.func\n  };\n\n  state = {\n    pendingMessage: \"\"\n  };\n\n  sendMessage = e => {\n    e.preventDefault();\n    if (this.props.onSendMessage) {\n      this.props.onSendMessage(this.state.pendingMessage);\n    }\n    this.setState({ pendingMessage: \"\" });\n  };\n\n  render() {\n    const textRows = this.state.pendingMessage.split(\"\\n\").length;\n    const pendingMessageTextareaHeight = textRows * 28 + \"px\";\n    const pendingMessageFieldHeight = textRows * 28 + 20 + \"px\";\n    const discordSnippet = this.props.discordBridges.map(ch => \"#\" + ch).join(\", \");\n    const occupantSnippet = `${this.props.occupantCount - 1} other${this.props.occupantCount > 2 ? \"s\" : \"\"}`;\n    const messageEntryPlaceholder =\n      this.props.occupantCount <= 1\n        ? \"Nobody is here yet...\"\n        : this.props.discordBridges.length\n          ? `Send message to ${occupantSnippet} and ${discordSnippet}...`\n          : `Send message to ${occupantSnippet}...`;\n\n    return (\n      <form onSubmit={this.sendMessage}>\n        <div\n          className={classNames({\n            [styles.messageEntry]: true,\n            [styles.messageEntryDisabled]: this.props.occupantCount <= 1\n          })}\n          style={{ height: pendingMessageFieldHeight }}\n        >\n          <textarea\n            className={classNames([styles.messageEntryInput, \"chat-focus-target\"])}\n            value={this.state.pendingMessage}\n            rows={textRows}\n            style={{ height: pendingMessageTextareaHeight }}\n            onFocus={e => handleTextFieldFocus(e.target)}\n            onBlur={() => handleTextFieldBlur()}\n            onChange={e => this.setState({ pendingMessage: e.target.value })}\n            disabled={this.props.occupantCount <= 1 ? true : false}\n            onKeyDown={e => {\n              if (e.key === \"Enter\" && !e.shiftKey) {\n                this.sendMessage(e);\n              } else if (e.key === \"Escape\") {\n                e.target.blur();\n              }\n            }}\n            placeholder={messageEntryPlaceholder}\n          />\n          <WithHoverSound>\n            <button\n              className={classNames([styles.messageEntryButton, styles.messageEntrySubmit])}\n              disabled={this.props.occupantCount <= 1 ? true : false}\n              type=\"submit\"\n            >\n              <i>\n                <FontAwesomeIcon icon={faPaperPlane} />\n              </i>\n            </button>\n          </WithHoverSound>\n        </div>\n      </form>\n    );\n  }\n}\n\nexport default LobbyChatBox;\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"../assets/stylesheets/chat-command-help.scss\";\nimport classNames from \"classnames\";\nimport { FormattedMessage } from \"react-intl\";\nimport qsTruthy from \"../utils/qs_truthy\";\n\nexport default class ChatCommandHelp extends Component {\n  static propTypes = {\n    matchingPrefix: PropTypes.string,\n    onTop: PropTypes.bool\n  };\n\n  render() {\n    const commands = [\n      \"leave\",\n      \"fly\",\n      \"grow\",\n      \"shrink\",\n      \"duck\",\n      \"debug\",\n      \"vrstats\",\n      \"scene <scene url>\",\n      \"rename <new name>\"\n    ];\n\n    if (qsTruthy(\"video_capture\")) {\n      commands.push(\"capture [stop]\");\n    }\n\n    return (\n      <div className={classNames({ [styles.commandHelp]: true, [styles.commandHelpOnTop]: this.props.onTop })}>\n        {commands.map(\n          c =>\n            (this.props.matchingPrefix === \"\" ||\n              c.split(\" \")[0].startsWith(this.props.matchingPrefix.split(\" \")[0])) && (\n              <div className={styles.entry} key={c}>\n                <div className={styles.command}>/{c}</div>\n                <div>\n                  <FormattedMessage id={`commands.${c.split(\" \")[0]}`} />\n                </div>\n              </div>\n            )\n        )}\n      </div>\n    );\n  }\n}\n","// https://stackoverflow.com/questions/6209161/extract-the-current-dom-and-print-it-as-a-string-with-styles-intact\n//\n// Mapping between tag names and css default values lookup tables. This allows to exclude default values in the result.\nconst defaultStylesByTagName = {};\n\n// Styles inherited from style sheets will not be rendered for elements with these tag names\nconst noStyleTags = {\n  BASE: true,\n  HEAD: true,\n  HTML: true,\n  META: true,\n  NOFRAME: true,\n  NOSCRIPT: true,\n  PARAM: true,\n  SCRIPT: true,\n  STYLE: true,\n  TITLE: true\n};\n\n// This list determines which css default values lookup tables are precomputed at load time\n// Lookup tables for other tag names will be automatically built at runtime if needed\nconst tagNames = [\n  \"A\",\n  \"ABBR\",\n  \"ADDRESS\",\n  \"AREA\",\n  \"ARTICLE\",\n  \"ASIDE\",\n  \"AUDIO\",\n  \"B\",\n  \"BASE\",\n  \"BDI\",\n  \"BDO\",\n  \"BLOCKQUOTE\",\n  \"BODY\",\n  \"BR\",\n  \"BUTTON\",\n  \"CANVAS\",\n  \"CAPTION\",\n  \"CENTER\",\n  \"CITE\",\n  \"CODE\",\n  \"COL\",\n  \"COLGROUP\",\n  \"COMMAND\",\n  \"DATALIST\",\n  \"DD\",\n  \"DEL\",\n  \"DETAILS\",\n  \"DFN\",\n  \"DIV\",\n  \"DL\",\n  \"DT\",\n  \"EM\",\n  \"EMBED\",\n  \"FIELDSET\",\n  \"FIGCAPTION\",\n  \"FIGURE\",\n  \"FONT\",\n  \"FOOTER\",\n  \"FORM\",\n  \"H1\",\n  \"H2\",\n  \"H3\",\n  \"H4\",\n  \"H5\",\n  \"H6\",\n  \"HEAD\",\n  \"HEADER\",\n  \"HGROUP\",\n  \"HR\",\n  \"HTML\",\n  \"I\",\n  \"IFRAME\",\n  \"IMG\",\n  \"INPUT\",\n  \"INS\",\n  \"KBD\",\n  \"KEYGEN\",\n  \"LABEL\",\n  \"LEGEND\",\n  \"LI\",\n  \"LINK\",\n  \"MAP\",\n  \"MARK\",\n  \"MATH\",\n  \"MENU\",\n  \"META\",\n  \"METER\",\n  \"NAV\",\n  \"NOBR\",\n  \"NOSCRIPT\",\n  \"OBJECT\",\n  \"OL\",\n  \"OPTION\",\n  \"OPTGROUP\",\n  \"OUTPUT\",\n  \"P\",\n  \"PARAM\",\n  \"PRE\",\n  \"PROGRESS\",\n  \"Q\",\n  \"RP\",\n  \"RT\",\n  \"RUBY\",\n  \"S\",\n  \"SAMP\",\n  \"SCRIPT\",\n  \"SECTION\",\n  \"SELECT\",\n  \"SMALL\",\n  \"SOURCE\",\n  \"SPAN\",\n  \"STRONG\",\n  \"STYLE\",\n  \"SUB\",\n  \"SUMMARY\",\n  \"SUP\",\n  \"SVG\",\n  \"TABLE\",\n  \"TBODY\",\n  \"TD\",\n  \"TEXTAREA\",\n  \"TFOOT\",\n  \"TH\",\n  \"THEAD\",\n  \"TIME\",\n  \"TITLE\",\n  \"TR\",\n  \"TRACK\",\n  \"U\",\n  \"UL\",\n  \"VAR\",\n  \"VIDEO\",\n  \"WBR\"\n];\n\nfunction computeDefaultStyleByTagName(tagName) {\n  const defaultStyle = {};\n  const element = document.body.appendChild(document.createElement(tagName));\n  const computedStyle = getComputedStyle(element);\n  for (let i = 0; i < computedStyle.length; i++) {\n    defaultStyle[computedStyle[i]] = computedStyle[computedStyle[i]];\n  }\n  document.body.removeChild(element);\n  return defaultStyle;\n}\n\nfunction getDefaultStyleByTagName(tagName) {\n  tagName = tagName.toUpperCase();\n  if (!defaultStylesByTagName[tagName]) {\n    defaultStylesByTagName[tagName] = computeDefaultStyleByTagName(tagName);\n  }\n  return defaultStylesByTagName[tagName];\n}\n\nexport function warmSerializeElement() {\n  for (let i = 0; i < tagNames.length; i++) {\n    if (!noStyleTags[tagNames[i]]) {\n      defaultStylesByTagName[tagNames[i]] = computeDefaultStyleByTagName(tagNames[i]);\n    }\n  }\n}\n\nexport default function serializeElement(el) {\n  if (Object.keys(defaultStylesByTagName).length === 0) {\n    // Precompute the lookup tables.\n    warmSerializeElement();\n  }\n\n  if (el.nodeType !== Node.ELEMENT_NODE) {\n    throw new TypeError();\n  }\n  const cssTexts = [];\n  const elements = el.querySelectorAll(\"*\");\n  for (let i = 0; i < elements.length; i++) {\n    const e = elements[i];\n    if (!noStyleTags[e.tagName]) {\n      const computedStyle = getComputedStyle(e);\n      const defaultStyle = getDefaultStyleByTagName(e.tagName);\n      cssTexts[i] = e.style.cssText;\n      for (let ii = 0; ii < computedStyle.length; ii++) {\n        const cssPropName = computedStyle[ii];\n\n        // Skip non-standard CSS for now, because it overwrites things like color\n        if (cssPropName.startsWith(\"-webkit\")) continue;\n\n        if (computedStyle[cssPropName] !== defaultStyle[cssPropName]) {\n          e.style[cssPropName] = computedStyle[cssPropName];\n        }\n      }\n    }\n  }\n  const result = el.outerHTML;\n  for (let i = 0; i < elements.length; i++) {\n    elements[i].style.cssText = cssTexts[i];\n  }\n  return result;\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\nimport classNames from \"classnames\";\n\nimport rootStyles from \"../assets/stylesheets/ui-root.scss\";\nimport styles from \"../assets/stylesheets/presence-list.scss\";\nimport PhoneImage from \"../assets/images/presence_phone.png\";\nimport DesktopImage from \"../assets/images/presence_desktop.png\";\nimport DiscordImage from \"../assets/images/presence_discord.png\";\nimport CameraImage from \"../assets/images/presence_camera.png\";\nimport HMDImage from \"../assets/images/presence_vr.png\";\nimport maskEmail from \"../utils/mask-email\";\nimport StateLink from \"./state-link.js\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faUsers } from \"@fortawesome/free-solid-svg-icons/faUsers\";\nimport { faPencilAlt } from \"@fortawesome/free-solid-svg-icons/faPencilAlt\";\nimport { pushHistoryPath, withSlug } from \"../utils/history\";\n\nfunction getPresenceImage(ctx) {\n  if (ctx && ctx.mobile) {\n    return PhoneImage;\n  } else if (ctx && ctx.hmd) {\n    return HMDImage;\n  } else if (ctx && ctx.discord) {\n    return DiscordImage;\n  } else {\n    return DesktopImage;\n  }\n}\n\nexport function navigateToClientInfo(history, clientId) {\n  const currentParams = new URLSearchParams(history.location.search);\n\n  if (process.env.RETICULUM_SERVER && document.location.host !== process.env.RETICULUM_SERVER) {\n    currentParams.set(\"client_id\", clientId);\n    pushHistoryPath(history, history.location.pathname, currentParams.toString());\n  } else {\n    pushHistoryPath(history, withSlug(history.location, `/clients/${clientId}`), currentParams.toString());\n  }\n}\n\nexport default class PresenceList extends Component {\n  static propTypes = {\n    presences: PropTypes.object,\n    history: PropTypes.object,\n    sessionId: PropTypes.string,\n    signedIn: PropTypes.bool,\n    email: PropTypes.string,\n    onSignIn: PropTypes.func,\n    onSignOut: PropTypes.func\n  };\n\n  state = {\n    expanded: false\n  };\n\n  navigateToClientInfo = clientId => {\n    navigateToClientInfo(this.props.history, clientId);\n  };\n\n  domForPresence = ([sessionId, data]) => {\n    const meta = data.metas[data.metas.length - 1];\n    const context = meta.context;\n    const profile = meta.profile;\n    const recording = meta.streaming || meta.recording;\n    const image = recording ? CameraImage : getPresenceImage(context);\n    const isBot = context && context.discord;\n    const isOwner = meta.roles && meta.roles.owner;\n    const badge = isOwner && (\n      <span className={styles.moderatorBadge} title=\"Moderator\">\n        &#x2605;\n      </span>\n    );\n\n    return (\n      <WithHoverSound key={sessionId}>\n        <div className={styles.row}>\n          <div className={styles.icon}>\n            <img src={image} />\n          </div>\n          <div\n            className={classNames({\n              [styles.listItem]: true\n            })}\n          >\n            {sessionId === this.props.sessionId ? (\n              <StateLink className={styles.self} stateKey=\"overlay\" stateValue=\"profile\" history={this.props.history}>\n                {profile && profile.displayName}\n                {badge}\n                <i>\n                  <FontAwesomeIcon icon={faPencilAlt} />\n                </i>\n              </StateLink>\n            ) : (\n              <div>\n                {!isBot ? (\n                  <button className={styles.clientLink} onClick={() => this.navigateToClientInfo(sessionId)}>\n                    {profile && profile.displayName}\n                  </button>\n                ) : (\n                  <span>{profile && profile.displayName}</span>\n                )}\n                {badge}\n              </div>\n            )}\n          </div>\n          <div className={styles.presence}>\n            <FormattedMessage id={`presence.in_${meta.presence}`} />\n          </div>\n        </div>\n      </WithHoverSound>\n    );\n  };\n\n  componentDidMount() {\n    document.querySelector(\".a-canvas\").addEventListener(\"mouseup\", () => {\n      if (this.state.expanded) {\n        this.setState({ expanded: false });\n      }\n    });\n  }\n\n  renderExpandedList() {\n    return (\n      <div className={styles.presenceList}>\n        <div className={styles.attachPoint} />\n        <div className={styles.contents}>\n          <div className={styles.rows}>\n            {Object.entries(this.props.presences || {})\n              .filter(([k]) => k === this.props.sessionId)\n              .map(this.domForPresence)}\n            {Object.entries(this.props.presences || {})\n              .filter(([k]) => k !== this.props.sessionId)\n              .map(this.domForPresence)}\n          </div>\n          <div className={styles.signIn}>\n            {this.props.signedIn ? (\n              <div>\n                <span>\n                  <FormattedMessage id=\"sign-in.as\" /> {maskEmail(this.props.email)}\n                </span>{\" \"}\n                <a onClick={this.props.onSignOut}>\n                  <FormattedMessage id=\"sign-in.out\" />\n                </a>\n              </div>\n            ) : (\n              <a onClick={this.props.onSignIn}>\n                <FormattedMessage id=\"sign-in.in\" />\n              </a>\n            )}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  render() {\n    const occupantCount = this.props.presences ? Object.entries(this.props.presences).length : 0;\n    return (\n      <div>\n        <div\n          onClick={() => this.setState({ expanded: !this.state.expanded })}\n          className={classNames({\n            [rootStyles.presenceInfo]: true,\n            [rootStyles.presenceInfoSelected]: this.state.expanded\n          })}\n        >\n          <FontAwesomeIcon icon={faUsers} />\n          <span className={rootStyles.occupantCount}>{occupantCount}</span>\n        </div>\n        {this.state.expanded && this.renderExpandedList()}\n      </div>\n    );\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport PropTypes from \"prop-types\";\nimport styles from \"../assets/stylesheets/presence-log.scss\";\nimport classNames from \"classnames\";\nimport Linkify from \"react-linkify\";\nimport { toArray as toEmojis } from \"react-emoji-render\";\nimport serializeElement from \"../utils/serialize-element\";\nimport { navigateToClientInfo } from \"./presence-list\";\n\nconst messageCanvas = document.createElement(\"canvas\");\nconst emojiRegex = /(?:[\\u2700-\\u27bf]|(?:\\ud83c[\\udde6-\\uddff]){2}|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\u0023-\\u0039]\\ufe0f?\\u20e3|\\u3299|\\u3297|\\u303d|\\u3030|\\u24c2|\\ud83c[\\udd70-\\udd71]|\\ud83c[\\udd7e-\\udd7f]|\\ud83c\\udd8e|\\ud83c[\\udd91-\\udd9a]|\\ud83c[\\udde6-\\uddff]|[\\ud83c[\\ude01-\\ude02]|\\ud83c\\ude1a|\\ud83c\\ude2f|[\\ud83c[\\ude32-\\ude3a]|[\\ud83c[\\ude50-\\ude51]|\\u203c|\\u2049|[\\u25aa-\\u25ab]|\\u25b6|\\u25c0|[\\u25fb-\\u25fe]|\\u00a9|\\u00ae|\\u2122|\\u2139|\\ud83c\\udc04|[\\u2600-\\u26FF]|\\u2b05|\\u2b06|\\u2b07|\\u2b1b|\\u2b1c|\\u2b50|\\u2b55|\\u231a|\\u231b|\\u2328|\\u23cf|[\\u23e9-\\u23f3]|[\\u23f8-\\u23fa]|\\ud83c\\udccf|\\u2934|\\u2935|[\\u2190-\\u21ff])/;\nconst urlRegex = /^https?:\\/\\/(www\\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%_+.~#?&//=]*)$/;\nconst textureLoader = new THREE.TextureLoader();\n\n// Hacky word wrapping, needed because the SVG conversion doesn't properly deal\n// with wrapping in Firefox for some reason. (The CSS white-space is set to pre)\nconst wordWrap = body => {\n  const maxCharsPerLine = 40;\n  const words = body.split(\" \");\n  const outWords = [];\n  let c = 0;\n\n  for (let i = 0; i < words.length; i++) {\n    const word = words[i];\n\n    if (word.startsWith(\":\") && word.endsWith(\":\")) {\n      c++;\n    } else {\n      c += word.length;\n    }\n\n    outWords.push(word);\n\n    if (c >= maxCharsPerLine) {\n      c = 0;\n      outWords.push(\"\\n\");\n    }\n  }\n\n  return outWords.join(\" \");\n};\n\nconst messageBodyDom = (body, from, fromSessionId, includeFromLink, history) => {\n  // Support wrapping text in ` to get monospace, and multiline.\n  const multiLine = body.split(\"\\n\").length > 1;\n  const wrapStyle = multiLine ? styles.messageWrapMulti : styles.messageWrap;\n  const mono = body.startsWith(\"`\") && body.endsWith(\"`\");\n  const messageBodyClasses = {\n    [styles.messageBody]: true,\n    [styles.messageBodyMulti]: multiLine,\n    [styles.messageBodyMono]: mono\n  };\n  const includeClientLink = includeFromLink && fromSessionId && history && NAF.clientId !== fromSessionId;\n  const onFromClick = includeClientLink ? () => navigateToClientInfo(history, fromSessionId) : () => {};\n\n  if (!multiLine) {\n    body = wordWrap(body);\n  }\n\n  const cleanedBody = (mono ? body.substring(1, body.length - 1) : body).trim();\n\n  return (\n    <div className={wrapStyle}>\n      {from && (\n        <div\n          onClick={onFromClick}\n          className={classNames({ [styles.messageSource]: true, [styles.messageSourceLink]: includeClientLink })}\n        >\n          {from}:\n        </div>\n      )}\n      <div className={classNames(messageBodyClasses)}>\n        <Linkify properties={{ target: \"_blank\", rel: \"noopener referrer\" }}>{toEmojis(cleanedBody)}</Linkify>\n      </div>\n    </div>\n  );\n};\n\nfunction renderChatMessage(body, from, allowEmojiRender, lowResolution) {\n  const isOneLine = body.split(\"\\n\").length === 1;\n  const context = messageCanvas.getContext(\"2d\");\n  const emoji = toEmojis(body);\n  const isEmoji =\n    allowEmojiRender &&\n    emoji.length === 1 &&\n    emoji[0].props &&\n    emoji[0].props.children.match &&\n    emoji[0].props.children.match(emojiRegex);\n\n  const el = document.createElement(\"div\");\n  el.setAttribute(\"xmlns\", \"http://www.w3.org/1999/xhtml\");\n  el.setAttribute(\"class\", `${styles.presenceLog} ${styles.presenceLogSpawn}`);\n\n  // The element is added to the DOM in order to have layout compute the width & height,\n  // and then it is removed after being rendered.\n  document.body.appendChild(el);\n\n  const entryDom = (\n    <div\n      className={classNames({\n        [styles.presenceLogEntry]: !isEmoji,\n        [styles.presenceLogEntryOneLine]: !isEmoji && isOneLine,\n        [styles.presenceLogEmoji]: isEmoji\n      })}\n    >\n      {messageBodyDom(body, from)}\n    </div>\n  );\n\n  return new Promise(resolve => {\n    ReactDOM.render(entryDom, el, () => {\n      // Scale by 12x\n      let objectScale = \"8.33%\";\n      let scale = 12;\n\n      if (lowResolution) {\n        // In low res, scale by 4x\n        objectScale = \"25%\";\n        scale = 4;\n      }\n\n      messageCanvas.width = el.offsetWidth * (scale + 0.1);\n      messageCanvas.height = el.offsetHeight * (scale + 0.1);\n\n      const xhtml = encodeURIComponent(`\n          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${messageCanvas.width}\" height=\"${messageCanvas.height}\">\n            <foreignObject width=\"${objectScale}\" height=\"${objectScale}\" style=\"transform: scale(${scale});\">\n              ${serializeElement(el)}\n            </foreignObject>\n          </svg>\n    `);\n      const img = new Image();\n\n      img.onload = async () => {\n        context.drawImage(img, 0, 0);\n        const blob = await new Promise(resolve => messageCanvas.toBlob(resolve));\n        ReactDOM.unmountComponentAtNode(el);\n        el.remove();\n        resolve(blob);\n      };\n\n      img.src = \"data:image/svg+xml,\" + xhtml;\n    });\n  });\n}\n\nexport async function createInWorldLogMessage({ name, type, body }) {\n  if (type !== \"chat\") return;\n\n  const lowResolution = AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR();\n  const blob = await renderChatMessage(body, name, false, lowResolution);\n  const entity = document.createElement(\"a-entity\");\n  const meshEntity = document.createElement(\"a-entity\");\n\n  document.querySelector(\"a-scene\").appendChild(entity);\n\n  entity.appendChild(meshEntity);\n  entity.setAttribute(\"follow-in-fov\", {\n    target: \"#player-camera\",\n    offset: { x: 0, y: 0.0, z: -0.8 }\n  });\n\n  const blobUrl = URL.createObjectURL(blob);\n\n  meshEntity.setAttribute(\"animation__float\", {\n    property: \"position\",\n    dur: 10000,\n    from: { x: 0, y: 0, z: 0 },\n    to: { x: 0, y: 0.05, z: -0.05 },\n    easing: \"easeOutQuad\"\n  });\n\n  entity.setAttribute(\"animation__spawn\", {\n    property: \"scale\",\n    dur: 200,\n    from: { x: 0.1, y: 0.1, z: 0.1 },\n    to: { x: 1, y: 1, z: 1 },\n    easing: \"easeOutElastic\"\n  });\n\n  meshEntity.setAttribute(\"animation__opacity\", {\n    property: \"meshMaterial.opacity\",\n    isRawProperty: true,\n    delay: 3000,\n    dur: 8000,\n    from: 1.0,\n    to: 0.0,\n    easing: \"easeInQuad\"\n  });\n\n  meshEntity.addEventListener(\"animationcomplete__opacity\", () => {\n    entity.parentNode.removeChild(entity);\n  });\n\n  textureLoader.load(blobUrl, texture => {\n    const material = new THREE.MeshBasicMaterial();\n    material.transparent = true;\n    material.map = texture;\n    material.generateMipmaps = false;\n    material.needsUpdate = true;\n\n    const geometry = new THREE.PlaneBufferGeometry(1, 1, 1, 1, texture.flipY);\n    const mesh = new THREE.Mesh(geometry, material);\n    meshEntity.setObject3D(\"mesh\", mesh);\n    meshEntity.meshMaterial = material;\n    const scaleFactor = 4000.0 / (lowResolution ? 3.0 : 1.0);\n    meshEntity.object3DMap.mesh.scale.set(texture.image.width / scaleFactor, texture.image.height / scaleFactor, 1);\n  });\n}\n\nexport async function spawnChatMessage(body, from) {\n  if (body.length === 0) return;\n\n  if (body.match(urlRegex)) {\n    document.querySelector(\"a-scene\").emit(\"add_media\", body);\n    return;\n  }\n\n  const blob = await renderChatMessage(body, from, true, false);\n  document.querySelector(\"a-scene\").emit(\"add_media\", new File([blob], \"message.png\", { type: \"image/png\" }));\n}\n\nexport default function ChatMessage(props) {\n  return (\n    <div className={props.className}>\n      {props.maySpawn && (\n        <button\n          className={classNames(styles.iconButton, styles.spawnMessage)}\n          onClick={() => spawnChatMessage(props.body)}\n        />\n      )}\n      {messageBodyDom(props.body, props.name, props.sessionId, props.includeFromLink, props.history)}\n    </div>\n  );\n}\n\nChatMessage.propTypes = {\n  name: PropTypes.string,\n  maySpawn: PropTypes.bool,\n  body: PropTypes.string,\n  sessionId: PropTypes.string,\n  history: PropTypes.object,\n  className: PropTypes.string,\n  includeFromLink: PropTypes.bool\n};\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport styles from \"../assets/stylesheets/message-entry.scss\";\nimport ChatCommandHelp from \"./chat-command-help\";\nimport { faPaperPlane } from \"@fortawesome/free-solid-svg-icons/faPaperPlane\";\nimport { faCamera } from \"@fortawesome/free-solid-svg-icons/faCamera\";\nimport { faPlus } from \"@fortawesome/free-solid-svg-icons/faPlus\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\nimport { spawnChatMessage } from \"./chat-message\";\nimport { pushHistoryState } from \"../utils/history\";\n\nconst isMobile = AFRAME.utils.device.isMobile();\n\nclass InWorldChatBox extends Component {\n  static propTypes = {\n    discordBridges: PropTypes.array,\n    onSendMessage: PropTypes.func,\n    onObjectCreated: PropTypes.func,\n    history: PropTypes.object,\n    enableSpawning: PropTypes.bool\n  };\n\n  state = {\n    pendingMessage: \"\"\n  };\n\n  sendMessage = e => {\n    e.preventDefault();\n    if (this.props.onSendMessage) {\n      this.props.onSendMessage(this.state.pendingMessage);\n    }\n    this.setState({ pendingMessage: \"\" });\n  };\n\n  render() {\n    const textRows = this.state.pendingMessage.split(\"\\n\").length;\n    const pendingMessageTextareaHeight = textRows * 28 + \"px\";\n    const pendingMessageFieldHeight = textRows * 28 + 20 + \"px\";\n    const discordSnippet = this.props.discordBridges.map(ch => \"#\" + ch).join(\", \");\n\n    return (\n      <form onSubmit={this.sendMessage}>\n        <div\n          className={classNames({ [styles.messageEntryInRoom]: true, [styles.messageEntryOnMobile]: isMobile })}\n          style={{ height: pendingMessageFieldHeight }}\n        >\n          {this.state.pendingMessage.startsWith(\"/\") && (\n            <ChatCommandHelp matchingPrefix={this.state.pendingMessage.substring(1)} />\n          )}\n          <input\n            id=\"message-entry-media-input\"\n            type=\"file\"\n            style={{ display: \"none\" }}\n            accept={isMobile ? \"image/*\" : \"*\"}\n            multiple\n            onChange={e => {\n              if (this.props.onObjectCreated) {\n                for (const file of e.target.files) {\n                  this.props.onObjectCreated(file);\n                }\n              }\n            }}\n          />\n          {this.props.enableSpawning && (\n            <label\n              htmlFor=\"message-entry-media-input\"\n              title={\"Upload\"}\n              className={classNames([\n                styles.messageEntryButton,\n                styles.messageEntryButtonInRoom,\n                styles.messageEntryUpload\n              ])}\n            >\n              <i>\n                <FontAwesomeIcon icon={isMobile ? faCamera : faPlus} />\n              </i>\n            </label>\n          )}\n          <textarea\n            style={{ height: pendingMessageTextareaHeight }}\n            className={classNames([\n              styles.messageEntryInput,\n              styles.messageEntryInputInRoom,\n              \"chat-focus-target\",\n              !this.props.enableSpawning && styles.messageEntryInputNoSpawn\n            ])}\n            value={this.state.pendingMessage}\n            rows={textRows}\n            onFocus={e => {\n              handleTextFieldFocus(e.target);\n            }}\n            onBlur={() => {\n              handleTextFieldBlur();\n            }}\n            onChange={e => {\n              e.stopPropagation();\n              this.setState({ pendingMessage: e.target.value });\n            }}\n            onKeyDown={e => {\n              if (e.key === \"Enter\" && !e.ctrlKey && !e.shiftKey) {\n                this.sendMessage(e);\n              } else if (e.key === \"Enter\" && e.ctrlKey) {\n                spawnChatMessage(e.target.value);\n                this.setState({ pendingMessage: \"\" });\n                e.target.blur();\n              } else if (e.key === \"Escape\") {\n                e.target.blur();\n              }\n            }}\n            placeholder={this.props.discordBridges.length ? `Send to room and ${discordSnippet}...` : \"Send to room...\"}\n          />\n          {this.props.enableSpawning && (\n            <button\n              className={classNames([styles.messageEntrySpawn])}\n              onClick={() => {\n                if (this.state.pendingMessage.length > 0) {\n                  spawnChatMessage(this.state.pendingMessage);\n                  this.setState({ pendingMessage: \"\" });\n                } else {\n                  pushHistoryState(this.props.history, \"modal\", \"create\");\n                }\n              }}\n            />\n          )}\n          <button\n            type=\"submit\"\n            className={classNames([\n              styles.messageEntryButton,\n              styles.messageEntryButtonInRoom,\n              styles.messageEntrySubmit\n            ])}\n          >\n            <i>\n              <FontAwesomeIcon icon={faPaperPlane} />\n            </i>\n          </button>\n        </div>\n      </form>\n    );\n  }\n}\n\nexport default InWorldChatBox;\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\nimport { fetchReticulumAuthenticated } from \"../utils/phoenix-utils\";\nimport { upload } from \"../utils/media-utils\";\nimport classNames from \"classnames\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nimport AvatarPreview from \"./avatar-preview\";\nimport styles from \"../assets/stylesheets/avatar-editor.scss\";\n\nconst AVATARS_API = \"/api/v1/avatars\";\n\nexport default class AvatarEditor extends Component {\n  static propTypes = {\n    avatarId: PropTypes.string,\n    onSignIn: PropTypes.func,\n    onSave: PropTypes.func,\n    onClose: PropTypes.func,\n    signedIn: PropTypes.bool,\n    hideDelete: PropTypes.bool,\n    debug: PropTypes.bool,\n    className: PropTypes.string\n  };\n\n  state = {\n    avatar: { name: \"My Avatar\", parent_avatar_listing_id: \"basebot\", files: {} },\n    previewGltfUrl: null\n  };\n\n  constructor(props) {\n    super(props);\n    // Blank avatar, used to create base avatar\n    // this.state = { avatar: { name: \"Base bot avatar\", files: {} } };\n\n    this.inputFiles = {};\n  }\n\n  componentDidMount = async () => {\n    if (this.props.avatarId) {\n      const avatar = await this.fetchAvatar(this.props.avatarId);\n      avatar.creatorAttribution = (avatar.attributions && avatar.attributions.creator) || \"\";\n      Object.assign(this.inputFiles, avatar.files);\n      this.setState({ avatar, previewGltfUrl: avatar.base_gltf_url });\n    } else {\n      const { base_gltf_url } = await this.fetchAvatar(\"basebot\");\n      this.setState({ previewGltfUrl: base_gltf_url });\n    }\n  };\n\n  fetchAvatar = avatarId => {\n    return fetchReticulumAuthenticated(`${AVATARS_API}/${avatarId}`).then(({ avatars }) => avatars[0]);\n  };\n\n  createOrUpdateAvatar = avatar => {\n    return fetchReticulumAuthenticated(\n      avatar.avatar_id ? `${AVATARS_API}/${avatar.avatar_id}` : AVATARS_API,\n      avatar.avatar_id ? \"PUT\" : \"POST\",\n      { avatar }\n    ).then(({ avatars }) => avatars[0]);\n  };\n\n  uploadAvatar = async e => {\n    e.preventDefault();\n\n    if (this.inputFiles.glb && this.inputFiles.glb instanceof File) {\n      const gltfLoader = new THREE.GLTFLoader();\n      const gltfUrl = URL.createObjectURL(this.inputFiles.glb);\n      const onProgress = console.log;\n      const parser = await new Promise((resolve, reject) =>\n        gltfLoader.createParser(gltfUrl, resolve, onProgress, reject)\n      );\n      URL.revokeObjectURL(gltfUrl);\n\n      const { content, body } = parser.extensions.KHR_binary_glTF;\n\n      // Inject hubs components on upload. Used to create base avatar\n      // const gltf = parser.json;\n      // Object.assign(gltf.scenes[0], {\n      //   extensions: {\n      //     MOZ_hubs_components: {\n      //       \"loop-animation\": {\n      //         clip: \"idle_eyes\"\n      //       }\n      //     }\n      //   }\n      // });\n      // Object.assign(gltf.nodes.find(n => n.name === \"Head\"), {\n      //   extensions: {\n      //     MOZ_hubs_components: {\n      //       \"scale-audio-feedback\": \"\"\n      //     }\n      //   }\n      // });\n      // content = JSON.stringify(gltf);\n\n      this.inputFiles.gltf = new File([content], \"file.gltf\", {\n        type: \"model/gltf\"\n      });\n      this.inputFiles.bin = new File([body], \"file.bin\", {\n        type: \"application/octet-stream\"\n      });\n    }\n\n    this.inputFiles.thumbnail = new File([await this.preview.getWrappedInstance().snapshot()], \"thumbnail.png\", {\n      type: \"image/png\"\n    });\n\n    const filesToUpload = [\"gltf\", \"bin\", \"base_map\", \"emissive_map\", \"normal_map\", \"orm_map\", \"thumbnail\"].filter(\n      k => this.inputFiles[k] === null || this.inputFiles[k] instanceof File\n    );\n\n    this.setState({ uploading: true });\n\n    const fileUploads = await Promise.all(filesToUpload.map(f => this.inputFiles[f] && upload(this.inputFiles[f])));\n    const avatar = {\n      ...this.state.avatar,\n      attributions: {\n        creator: this.state.avatar.creatorAttribution\n      },\n      files: fileUploads\n        .map((resp, i) => [filesToUpload[i], resp && [resp.file_id, resp.meta.access_token, resp.meta.promotion_token]])\n        .reduce((o, [k, v]) => ({ ...o, [k]: v }), {})\n    };\n\n    await this.createOrUpdateAvatar(avatar);\n\n    this.setState({ uploading: false });\n\n    if (this.props.onSave) this.props.onSave();\n  };\n\n  deleteAvatar = async e => {\n    e.preventDefault();\n    await fetchReticulumAuthenticated(`${AVATARS_API}/${this.state.avatar.avatar_id}`, \"DELETE\");\n    if (this.props.onSave) this.props.onSave();\n  };\n\n  fileField = (name, label, accept, disabled = false, title) => (\n    <div className=\"file-input-row\" key={name} title={title}>\n      <label htmlFor={`avatar-file_${name}`}>\n        <div className=\"img-box\" />\n        <span>{label}</span>\n      </label>\n      <input\n        id={`avatar-file_${name}`}\n        type=\"file\"\n        accept={accept}\n        disabled={disabled}\n        onChange={e => {\n          this.inputFiles[name] = e.target.files[0];\n          e.target.value = null;\n        }}\n      />\n      {this.state.avatar.files[name] && (\n        <a\n          onClick={() => {\n            this.inputFiles[name] = null;\n          }}\n        >\n          <i>\n            <FontAwesomeIcon icon={faTimes} />\n          </i>\n        </a>\n      )}\n    </div>\n  );\n\n  mapField = (name, label, accept, disabled = false, title) => (\n    <div className=\"file-input-row\" key={name} title={title}>\n      <label htmlFor={`avatar-file_${name}`}>\n        <div className=\"img-box\">{this.state.avatar.files[name] && <img src={this.state.avatar.files[name]} />}</div>\n        <span>{label}</span>\n      </label>\n      <input\n        id={`avatar-file_${name}`}\n        type=\"file\"\n        accept={accept}\n        disabled={disabled}\n        onChange={e => {\n          const file = e.target.files[0];\n          e.target.value = null;\n          this.inputFiles[name] = file;\n          URL.revokeObjectURL(this.state.avatar.files[name]);\n          this.setState({\n            avatar: {\n              ...this.state.avatar,\n              files: {\n                ...this.state.avatar.files,\n                [name]: URL.createObjectURL(file)\n              }\n            }\n          });\n        }}\n      />\n      {this.state.avatar.files[name] && (\n        <a\n          onClick={() => {\n            this.inputFiles[name] = null;\n            URL.revokeObjectURL(this.state.avatar.files[name]);\n            this.setState({\n              avatar: {\n                ...this.state.avatar,\n                files: {\n                  ...this.state.avatar.files,\n                  [name]: null\n                }\n              }\n            });\n          }}\n        >\n          <i>\n            <FontAwesomeIcon icon={faTimes} />\n          </i>\n        </a>\n      )}\n    </div>\n  );\n\n  textField = (name, placeholder, disabled, required) => (\n    <div>\n      <input\n        id={`avatar-${name}`}\n        type=\"text\"\n        disabled={disabled}\n        required={required}\n        placeholder={placeholder}\n        className=\"text-field\"\n        value={this.state.avatar[name] || \"\"}\n        onChange={e => this.setState({ avatar: { ...this.state.avatar, [name]: e.target.value } })}\n      />\n    </div>\n  );\n\n  textarea = (name, placeholder, disabled) => (\n    <div>\n      <textarea\n        id={`avatar-${name}`}\n        disabled={disabled}\n        placeholder={placeholder}\n        className=\"textarea\"\n        value={this.state.avatar[name] || \"\"}\n        onChange={e => this.setState({ avatar: { ...this.state.avatar, [name]: e.target.value } })}\n      />\n    </div>\n  );\n\n  checkbox = (name, children, disabled) => (\n    <div className=\"checkbox-container\">\n      <input\n        id={`avatar-${name}`}\n        type=\"checkbox\"\n        className=\"checkbox\"\n        disabled={disabled}\n        checked={!!this.state.avatar[name]}\n        onChange={e => this.setState({ avatar: { ...this.state.avatar, [name]: e.target.checked } })}\n      />\n      <label htmlFor={`#avatar-${name}`}>{children}</label>\n    </div>\n  );\n\n  render() {\n    const { debug } = this.props;\n    return (\n      <div className={classNames(styles.avatarEditor, this.props.className)}>\n        {this.props.onClose && (\n          <a className=\"close-button\" onClick={this.props.onClose}>\n            <i>\n              <FontAwesomeIcon icon={faTimes} />\n            </i>\n          </a>\n        )}\n        {this.props.signedIn ? (\n          <form onSubmit={this.uploadAvatar} className=\"center\">\n            <div className=\"split\">\n              <div className=\"form-body\">\n                {debug && this.textField(\"avatar_id\", \"Avatar ID\", true)}\n                {debug && this.textField(\"parent_avatar_id\", \"Parent Avatar ID\")}\n                {debug && this.textField(\"parent_avatar_listing_id\", \"Parent Avatar Listing ID\")}\n                {this.textField(\"name\", \"Name\", false, true)}\n                {debug && this.textarea(\"description\", \"Description\")}\n                {debug && this.fileField(\"glb\", \"Avatar GLB\", \"model/gltf+binary,.glb\")}\n\n                {this.mapField(\"base_map\", \"Base Map\", \"image/*\")}\n                {this.mapField(\"emissive_map\", \"Emissive Map\", \"image/*\")}\n                {this.mapField(\"normal_map\", \"Normal Map\", \"image/*\")}\n\n                {this.mapField(\"orm_map\", \"ORM Map\", \"image/*\", false, \"Occlussion (r), Roughness (g), Metallic (b)\")}\n\n                <hr />\n\n                {this.checkbox(\n                  \"allow_promotion\",\n                  <span>\n                    Allow{\" \"}\n                    <a\n                      href=\"https://github.com/mozilla/hubs/blob/master/PROMOTION.md\"\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                    >\n                      Promotion\n                    </a>\n                  </span>\n                )}\n                {this.checkbox(\n                  \"allow_remixing\",\n                  <span>\n                    Allow{\" \"}\n                    <a\n                      href=\"https://github.com/mozilla/hubs/blob/master/REMIXING.md\"\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                    >\n                      Remixing\n                    </a>{\" \"}\n                    <span className=\"license\">\n                      (under{\" \"}\n                      <a href=\"https://creativecommons.org/licenses/by/3.0/\" target=\"_blank\" rel=\"noopener noreferrer\">\n                        CC-BY 3.0\n                      </a>)\n                    </span>\n                  </span>\n                )}\n                {this.textField(\"creatorAttribution\", \"Attribution (optional)\", false, false)}\n\n                {/* {this.mapField(\"ao_map\", \"AO Map\", \"images/\\*\", true)} */}\n                {/* {this.mapField(\"metallic_map\", \"Metallic Map\", \"image/\\*\", true)} */}\n                {/* {this.mapField(\"roughness_map\", \"Roughness Map\", \"image/\\*\", true)} */}\n              </div>\n              <AvatarPreview\n                className=\"preview\"\n                avatarGltfUrl={this.state.previewGltfUrl}\n                {...this.inputFiles}\n                ref={p => (this.preview = p)}\n              />\n            </div>\n            <div className=\"info\">\n              <p>\n                <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://tryquilt.io/\">\n                  <FormattedMessage id=\"avatar-editor.quilt-link\" />\n                </a>\n              </p>\n              <p>\n                <FormattedMessage id=\"avatar-editor.info\" />\n                <a target=\"_blank\" rel=\"noopener noreferrer\" href=\"https://github.com/j-conrad/hubs-avatar-pipelines\">\n                  <FormattedMessage id=\"avatar-editor.info-link\" />\n                </a>\n              </p>\n            </div>\n            <div>\n              <input\n                disabled={this.state.uploading}\n                className=\"form-submit\"\n                type=\"submit\"\n                value={this.state.uploading ? \"Uploading...\" : \"Save\"}\n              />\n            </div>\n            {!this.props.hideDelete && (\n              <div className=\"delete-avatar\">\n                {this.state.confirmDelete ? (\n                  <span>\n                    are you sure? <a onClick={this.deleteAvatar}>yes</a> /{\" \"}\n                    <a onClick={() => this.setState({ confirmDelete: false })}>no</a>\n                  </span>\n                ) : (\n                  <a onClick={() => this.setState({ confirmDelete: true })}>delete avatar</a>\n                )}\n              </div>\n            )}\n          </form>\n        ) : (\n          <a onClick={this.props.onSignIn}>\n            <FormattedMessage id=\"sign-in.in\" />\n          </a>\n        )}\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\nimport MovingAverage from \"moving-average\";\n\nexport default class MicLevelWidget extends Component {\n  static propTypes = {\n    hasAudioTrack: PropTypes.bool,\n    muteOnEntry: PropTypes.bool,\n    scene: PropTypes.object\n  };\n\n  state = {\n    volume: 0\n  };\n\n  componentDidMount() {\n    this.startAnalyser();\n  }\n\n  componentWillUnmount() {\n    this.stopAnalyser();\n  }\n\n  stopAnalyser() {\n    if (this.micUpdateInterval != null) {\n      clearInterval(this.micUpdateInterval);\n    }\n  }\n\n  startAnalyser() {\n    if (this.micUpdateInterval) {\n      clearInterval(this.micUpdateInterval);\n    }\n    const micLevelMovingAverage = MovingAverage(100);\n    let max = 0;\n    this.micUpdateInterval = setInterval(() => {\n      const analyser = this.props.scene.systems[\"local-audio-analyser\"];\n      max = Math.max(analyser.volume, max);\n      // We use a moving average to smooth out the visual animation or else it would twitch too fast for\n      // the css renderer to keep up.\n      micLevelMovingAverage.push(Date.now(), analyser.volume);\n      const average = micLevelMovingAverage.movingAverage();\n      const volume = max === 0 ? 0 : average / max;\n      if (Math.abs(this.state.volume - volume) > 0.05) {\n        this.setState({ volume });\n      }\n    }, 50);\n  }\n\n  render() {\n    const maxLevelHeight = 111;\n    const micClip = {\n      clip: `rect(${maxLevelHeight - Math.floor(this.state.volume * maxLevelHeight)}px, 111px, 111px, 0px)`\n    };\n\n    return (\n      <div className=\"audio-setup-panel__levels__icon\">\n        <img\n          src=\"../assets/images/level_background.png\"\n          srcSet=\"../assets/images/level_background@2x.png 2x\"\n          className=\"audio-setup-panel__levels__icon-part\"\n        />\n        {!this.props.muteOnEntry && (\n          <img\n            src=\"../assets/images/level_fill.png\"\n            srcSet=\"../assets/images/level_fill@2x.png 2x\"\n            className=\"audio-setup-panel__levels__icon-part\"\n            style={micClip}\n          />\n        )}\n        {this.props.hasAudioTrack && !this.props.muteOnEntry ? (\n          <img\n            src=\"../assets/images/mic_level.png\"\n            srcSet=\"../assets/images/mic_level@2x.png 2x\"\n            className=\"audio-setup-panel__levels__icon-part\"\n          />\n        ) : (\n          <img\n            src=\"../assets/images/mic_denied.png\"\n            srcSet=\"../assets/images/mic_denied@2x.png 2x\"\n            className=\"audio-setup-panel__levels__icon-part\"\n          />\n        )}\n        {this.props.hasAudioTrack &&\n          !this.props.muteOnEntry && (\n            <div className=\"audio-setup-panel__levels__test_label\">\n              <FormattedMessage id=\"audio.talk_to_test\" />\n            </div>\n          )}\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport { FormattedMessage } from \"react-intl\";\nimport { WithHoverSound } from \"./wrap-with-audio\";\n\nimport webmTone from \"../assets/sfx/tone.webm\";\nimport mp3Tone from \"../assets/sfx/tone.mp3\";\nimport oggTone from \"../assets/sfx/tone.ogg\";\nimport wavTone from \"../assets/sfx/tone.wav\";\n\nexport default class OutputLevelWidget extends Component {\n  state = {\n    tonePlaying: false\n  };\n\n  constructor(props) {\n    super(props);\n    this.playTestTone = this.playTestTone.bind(this);\n    this.toneClip = document.createElement(\"audio\");\n    if (this.toneClip.canPlayType(\"audio/webm\")) {\n      this.toneClip.src = webmTone;\n    } else if (this.toneClip.canPlayType(\"audio/mpeg\")) {\n      this.toneClip.src = mp3Tone;\n    } else if (this.toneClip.canPlayType(\"audio/ogg\")) {\n      this.toneClip.src = oggTone;\n    } else {\n      this.toneClip.src = wavTone;\n    }\n  }\n\n  componentWillUnmount() {\n    this.toneClip.pause();\n    this.toneClip.currentTime = 0;\n    if (this.testToneTimeout != null) {\n      clearTimeout(this.testToneTimeout);\n    }\n  }\n\n  playTestTone() {\n    if (this.testToneTimeout != null) {\n      clearTimeout(this.testToneTimeout);\n    }\n    this.toneClip.currentTime = 0;\n    this.toneClip.play();\n    this.setState({ tonePlaying: true });\n    this.testToneTimeout = setTimeout(() => {\n      this.setState({ tonePlaying: false });\n    }, 1393);\n  }\n\n  render() {\n    const maxLevelHeight = 111;\n    const speakerClip = { clip: `rect(${this.state.tonePlaying ? 0 : maxLevelHeight}px, 111px, 111px, 0px)` };\n    return (\n      <WithHoverSound>\n        <div className=\"audio-setup-panel__levels__icon_clickable\" onClick={this.playTestTone}>\n          <img\n            src=\"../assets/images/level_action_background.png\"\n            srcSet=\"../assets/images/level_action_background@2x.png 2x\"\n            className=\"audio-setup-panel__levels__icon-part\"\n          />\n          <img\n            src=\"../assets/images/level_action_fill.png\"\n            srcSet=\"../assets/images/level_action_fill@2x.png 2x\"\n            className=\"audio-setup-panel__levels__icon-part\"\n            style={speakerClip}\n          />\n          <img\n            src=\"../assets/images/speaker_level.png\"\n            srcSet=\"../assets/images/speaker_level@2x.png 2x\"\n            className=\"audio-setup-panel__levels__icon-part\"\n          />\n          <div className=\"audio-setup-panel__levels__test_label\">\n            <FormattedMessage id=\"audio.click_to_test\" />\n          </div>\n        </div>\n      </WithHoverSound>\n    );\n  }\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport styles from \"../assets/stylesheets/presence-log.scss\";\nimport classNames from \"classnames\";\n\nimport { share } from \"../utils/share\";\nimport { getLandingPageForPhoto } from \"../utils/phoenix-utils\";\n\nexport default function PhotoMessage({ name, body: { src: url }, className, maySpawn, hubId }) {\n  const landingPageUrl = getLandingPageForPhoto(url);\n  const onShareClicked = share.bind(null, {\n    url: landingPageUrl,\n    title: `Taken in #hubs, join me at https://hub.link/${hubId}`\n  });\n  return (\n    <div className={className}>\n      {maySpawn && <button className={classNames(styles.iconButton, styles.share)} onClick={onShareClicked} />}\n      <div className={styles.mediaBody}>\n        <span>\n          <b>{name}</b>\n        </span>\n        <span>\n          {\"took a \"}\n          <b>\n            <a href={landingPageUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n              photo\n            </a>\n          </b>.\n        </span>\n      </div>\n      <a href={landingPageUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n        <img src={url} />\n      </a>\n    </div>\n  );\n}\nPhotoMessage.propTypes = {\n  name: PropTypes.string,\n  maySpawn: PropTypes.bool,\n  body: PropTypes.object,\n  className: PropTypes.string,\n  hubId: PropTypes.string\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nimport styles from \"../assets/stylesheets/presence-log.scss\";\nimport classNames from \"classnames\";\n\nimport { share } from \"../utils/share\";\n\nexport default function VideoMessage({ name, body: { src: url }, className, maySpawn, hubId }) {\n  const onShareClicked = share.bind(null, {\n    url: url,\n    title: `Taken in #hubs, join me at https://hub.link/${hubId}`\n  });\n  return (\n    <div className={className}>\n      {maySpawn && <button className={classNames(styles.iconButton, styles.share)} onClick={onShareClicked} />}\n      <div className={styles.mediaBody}>\n        <span>\n          <b>{name}</b>\n        </span>\n        <span>\n          {\"took a \"}\n          <b>\n            <a href={url} target=\"_blank\" rel=\"noopener noreferrer\">\n              video\n            </a>\n          </b>.\n        </span>\n      </div>\n    </div>\n  );\n}\nVideoMessage.propTypes = {\n  name: PropTypes.string,\n  maySpawn: PropTypes.bool,\n  body: PropTypes.object,\n  className: PropTypes.string,\n  hubId: PropTypes.string\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"../assets/stylesheets/presence-log.scss\";\nimport classNames from \"classnames\";\nimport { proxiedUrlFor } from \"../utils/media-url-utils\";\n\nfunction spawnImage(url) {\n  document.querySelector(\"a-scene\").emit(\"add_media\", url);\n}\n\nexport default function ImageMessage({ name, body: { src: url }, className, maySpawn }) {\n  return (\n    <div className={className}>\n      {maySpawn && (\n        <button className={classNames(styles.iconButton, styles.spawnMessage)} onClick={() => spawnImage(url)} />\n      )}\n      <div className={styles.mediaBody}>{name && <div className={styles.messageSource}>{name}:</div>}</div>\n      <a href={url} target=\"_blank\" rel=\"noopener noreferrer\">\n        <img src={proxiedUrlFor(url)} />\n      </a>\n    </div>\n  );\n}\n\nImageMessage.propTypes = {\n  name: PropTypes.string,\n  maySpawn: PropTypes.bool,\n  body: PropTypes.object,\n  className: PropTypes.string\n};\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"../assets/stylesheets/presence-log.scss\";\nimport classNames from \"classnames\";\nimport { FormattedMessage } from \"react-intl\";\n\nimport ChatMessage from \"./chat-message\";\nimport PhotoMessage from \"./photo-message\";\nimport VideoMessage from \"./video-message\";\nimport ImageMessage from \"./image-message\";\nimport { getPresenceContextForSession } from \"../utils/phoenix-utils\";\n\nexport default class PresenceLog extends Component {\n  static propTypes = {\n    entries: PropTypes.array,\n    inRoom: PropTypes.bool,\n    hubId: PropTypes.string,\n    history: PropTypes.object,\n    presences: PropTypes.object\n  };\n\n  constructor(props) {\n    super(props);\n  }\n\n  domForEntry = e => {\n    const entryClasses = {\n      [styles.presenceLogEntry]: true,\n      [styles.presenceLogEntryWithButton]: (e.type === \"chat\" || e.type === \"image\") && e.maySpawn,\n      [styles.presenceLogChat]: e.type === \"chat\",\n      [styles.expired]: !!e.expired\n    };\n\n    const presenceContext = e.sessionId ? getPresenceContextForSession(this.props.presences, e.sessionId) : {};\n    const isBot = !!presenceContext.discord;\n\n    switch (e.type) {\n      case \"join\":\n      case \"entered\":\n        return (\n          <div key={e.key} className={classNames(entryClasses)}>\n            <b>{e.name}</b>&nbsp;<FormattedMessage id={`presence.${e.type}_${e.presence}`} />\n          </div>\n        );\n      case \"leave\":\n        return (\n          <div key={e.key} className={classNames(entryClasses)}>\n            <b>{e.name}</b>&nbsp;<FormattedMessage id={`presence.${e.type}`} />\n          </div>\n        );\n      case \"display_name_changed\":\n        return (\n          <div key={e.key} className={classNames(entryClasses)}>\n            <b>{e.oldName}</b>&nbsp;<FormattedMessage id=\"presence.name_change\" />&nbsp;<b>{e.newName}</b>.\n          </div>\n        );\n      case \"scene_changed\":\n        return (\n          <div key={e.key} className={classNames(entryClasses)}>\n            <b>{e.name}</b>&nbsp;<FormattedMessage id=\"presence.scene_change\" />&nbsp;<b>{e.sceneName}</b>.\n          </div>\n        );\n      case \"hub_name_changed\":\n        return (\n          <div key={e.key} className={classNames(entryClasses)}>\n            <b>{e.name}</b>&nbsp;<FormattedMessage id=\"presence.hub_name_change\" />&nbsp;<b>{e.hubName}</b>.\n          </div>\n        );\n      case \"chat\":\n        return (\n          <ChatMessage\n            key={e.key}\n            name={e.name}\n            className={classNames(entryClasses)}\n            body={e.body}\n            maySpawn={e.maySpawn}\n            sessionId={e.sessionId}\n            includeFromLink={this.props.inRoom && !isBot}\n            history={this.props.history}\n          />\n        );\n      case \"image\":\n        return (\n          <ImageMessage\n            key={e.key}\n            name={e.name}\n            className={classNames(entryClasses, styles.media)}\n            body={e.body}\n            maySpawn={e.maySpawn}\n          />\n        );\n      case \"photo\":\n        return (\n          <PhotoMessage\n            key={e.key}\n            name={e.name}\n            className={classNames(entryClasses, styles.media)}\n            body={e.body}\n            maySpawn={e.maySpawn}\n            hubId={this.props.hubId}\n          />\n        );\n      case \"video\":\n        return (\n          <VideoMessage\n            key={e.key}\n            name={e.name}\n            className={classNames(entryClasses, styles.media)}\n            body={e.body}\n            maySpawn={e.maySpawn}\n            hubId={this.props.hubId}\n          />\n        );\n      case \"log\":\n        return (\n          <div key={e.key} className={classNames(entryClasses)}>\n            {e.body}\n          </div>\n        );\n    }\n  };\n\n  render() {\n    const presenceClasses = {\n      [styles.presenceLog]: true,\n      [styles.presenceLogInRoom]: this.props.inRoom\n    };\n\n    return <div className={classNames(presenceClasses)}>{this.props.entries.map(this.domForEntry)}</div>;\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\nimport classNames from \"classnames\";\nimport StateLink from \"./state-link.js\";\nimport { resetTips } from \"../systems/tips\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faImage } from \"@fortawesome/free-solid-svg-icons/faImage\";\nimport { faStar } from \"@fortawesome/free-solid-svg-icons/faStar\";\nimport { faDoorClosed } from \"@fortawesome/free-solid-svg-icons/faDoorClosed\";\nimport { faPencilAlt } from \"@fortawesome/free-solid-svg-icons/faPencilAlt\";\nimport { faInfoCircle } from \"@fortawesome/free-solid-svg-icons/faInfoCircle\";\nimport { faBars } from \"@fortawesome/free-solid-svg-icons/faBars\";\nimport { faPlus } from \"@fortawesome/free-solid-svg-icons/faPlus\";\nimport { faMinus } from \"@fortawesome/free-solid-svg-icons/faMinus\";\nimport { faVideo } from \"@fortawesome/free-solid-svg-icons/faVideo\";\nimport { showFullScreenIfAvailable } from \"../utils/fullscreen\";\nimport LeaveRoomDialog from \"./leave-room-dialog.js\";\n\nimport styles from \"../assets/stylesheets/settings-menu.scss\";\nimport rootStyles from \"../assets/stylesheets/ui-root.scss\";\n\nexport default class SettingsMenu extends Component {\n  static propTypes = {\n    history: PropTypes.object,\n    isStreaming: PropTypes.bool,\n    toggleStreamerMode: PropTypes.func,\n    mediaSearchStore: PropTypes.object,\n    scene: PropTypes.object,\n    hubScene: PropTypes.object,\n    hubChannel: PropTypes.object,\n    performConditionalSignIn: PropTypes.func,\n    showNonHistoriedDialog: PropTypes.func,\n    pushHistoryState: PropTypes.func,\n    toggleFlyMode: PropTypes.func\n  };\n\n  state = {\n    expanded: false\n  };\n\n  componentDidMount() {\n    document.querySelector(\".a-canvas\").addEventListener(\"mouseup\", () => {\n      if (this.state.expanded) {\n        this.setState({ expanded: false });\n      }\n    });\n  }\n\n  renderExpandedMenu() {\n    const rowClasses = classNames([styles.row, styles.settingsRow]);\n    const rowHeader = classNames([styles.row, styles.settingsRow, styles.rowHeader]);\n    const showRoomSettings = !!this.props.hubChannel.canOrWillIfCreator(\"update_hub\");\n    // const showRoomSettings = false;\n    // const showCloseRoom = !!this.props.hubChannel.canOrWillIfCreator(\"close_hub\");\n    const showCloseRoom = false;\n    const showRoomInfo = !!this.props.hubScene;\n    // const showRoomInfo = false;\n    // const showRoomSection = showRoomSettings || showRoomInfo || showCloseRoom;\n    const showRoomSection = false;\n    const showStreamerMode = this.props.scene.is(\"entered\") && !!this.props.hubChannel.canOrWillIfCreator(\"kick_users\");\n\n    const playerRig = document.querySelector(\"#player-rig\");\n    const flyEnabled = playerRig.getAttribute(\"character-controller\", \"fly\").fly;\n\n    // Draw self first\n    return (\n      <div className={styles.settingsMenu}>\n        <div className={styles.attachPoint} />\n        <div className={styles.contents}>\n          <div className={styles.rows}>\n            <div className={rowHeader}>\n              <FormattedMessage id=\"settings.row-profile\" />\n            </div>\n            <div className={rowClasses}>\n              <div className={styles.icon}>\n                <img src=\"../assets/images/change_avatar.svg\" />\n              </div>\n              <div className={styles.listItem}>\n                <StateLink\n                  stateKey=\"overlay\"\n                  stateValue=\"profile\"\n                  history={this.props.history}\n                  onClick={() => this.setState({ expanded: false })}\n                >\n                  <FormattedMessage id=\"settings.change-avatar\" />\n                </StateLink>\n              </div>\n            </div>\n            <div className={rowClasses}>\n                <div className={styles.icon}>\n                  <i>\n                    <FontAwesomeIcon icon={faStar} />\n                  </i>\n                </div>\n                <div className={styles.listItem}>\n                  <div\n                    className={styles.listItemLink}\n                    onClick={() => {\n                      this.props.toggleFlyMode(!flyEnabled);\n                      this.setState({ expanded: false });\n                    }}\n                  >\n                    {flyEnabled ? \"Disable\" : \"Enable\"} Fly Mode\n                  </div>\n                </div>\n              </div>\n            {false ? <div className={rowClasses}>\n              <div className={styles.icon}>\n                <i>\n                  <FontAwesomeIcon icon={faStar} />\n                </i>\n              </div>\n              <div className={styles.listItem}>\n                <div\n                  className={styles.listItemLink}\n                  onClick={() => {\n                    this.props.performConditionalSignIn(\n                      () => this.props.hubChannel.signedIn,\n                      () => {\n                        showFullScreenIfAvailable();\n                        this.props.mediaSearchStore.sourceNavigateWithNoNav(\"favorites\");\n                      },\n                      \"favorite-rooms\"\n                    );\n                  }}\n                >\n                  <FormattedMessage id=\"settings.favorites\" />\n                </div>\n              </div>\n            </div> : <span />}\n            {showRoomSection && (\n              <div className={rowHeader}>\n                <FormattedMessage id=\"settings.row-room\" />\n              </div>\n            )}\n            {false && showRoomSettings && (\n              <div className={rowClasses}>\n                <div className={styles.icon}>\n                  <i>\n                    <FontAwesomeIcon icon={faImage} />\n                  </i>\n                </div>\n                <div className={styles.listItem}>\n                  <div\n                    className={styles.listItemLink}\n                    onClick={() => {\n                      this.props.performConditionalSignIn(\n                        () => this.props.hubChannel.can(\"update_hub\"),\n                        () => {\n                          showFullScreenIfAvailable();\n                          this.props.mediaSearchStore.sourceNavigateWithNoNav(\"scenes\");\n                          this.setState({ expanded: false });\n                        },\n                        \"change-scene\"\n                      );\n                    }}\n                  >\n                    <FormattedMessage id=\"settings.change-scene\" />\n                  </div>\n                </div>\n              </div>\n            )}\n            {showRoomSettings && (\n              <div className={rowClasses}>\n                <div className={styles.icon}>\n                  <i>\n                    <FontAwesomeIcon icon={faPencilAlt} />\n                  </i>\n                </div>\n                <div className={styles.listItem}>\n                  <a\n                    href=\"#\"\n                    onClick={e => {\n                      e.preventDefault();\n\n                      this.props.performConditionalSignIn(\n                        () => this.props.hubChannel.can(\"update_hub\"),\n                        () => {\n                          this.props.pushHistoryState(\"modal\", \"room_settings\");\n                          this.setState({ expanded: false });\n                        },\n                        \"room-settings\"\n                      );\n                    }}\n                  >\n                    <FormattedMessage id=\"settings.room-settings\" />\n                  </a>\n                </div>\n              </div>\n            )}\n            {showCloseRoom && (\n              <div className={rowClasses}>\n                <div className={styles.icon}>\n                  <i>\n                    <FontAwesomeIcon icon={faDoorClosed} />\n                  </i>\n                </div>\n                <div className={styles.listItem}>\n                  <a\n                    href=\"#\"\n                    onClick={e => {\n                      e.preventDefault();\n\n                      this.props.performConditionalSignIn(\n                        () => this.props.hubChannel.can(\"update_hub\"),\n                        () => {\n                          this.props.pushHistoryState(\"modal\", \"close_room\");\n                          this.setState({ expanded: false });\n                        },\n                        \"close-room\"\n                      );\n                    }}\n                  >\n                    <FormattedMessage id=\"settings.close-room\" />\n                  </a>\n                </div>\n              </div>\n            )}\n            {showRoomInfo && (\n              <div className={rowClasses}>\n                <div className={styles.icon}>\n                  <i>\n                    <FontAwesomeIcon icon={faInfoCircle} />\n                  </i>\n                </div>\n                <div className={styles.listItem}>\n                  <StateLink\n                    stateKey=\"modal\"\n                    stateValue=\"room_info\"\n                    history={this.props.history}\n                    onClick={() => this.setState({ expanded: false })}\n                  >\n                    <FormattedMessage id=\"settings.room-info\" />\n                  </StateLink>\n                </div>\n              </div>\n            )}\n            <div className={rowClasses}>\n              <div className={styles.icon}>\n                <i>\n                  <FontAwesomeIcon icon={faDoorClosed} />\n                </i>\n              </div>\n              <div className={styles.listItem}>\n                <a\n                  href=\"#\"\n                  onClick={e => {\n                    e.preventDefault();\n                    this.props.showNonHistoriedDialog(LeaveRoomDialog, {\n                      destinationUrl: \"/\",\n                      messageType: \"create-room\"\n                    });\n                    this.setState({ expanded: false });\n                  }}\n                >\n                  <FormattedMessage id=\"settings.leave-room\" />\n                </a>\n              </div>\n            </div>\n            {showStreamerMode ? (\n              <div className={rowHeader}>\n                <FormattedMessage id=\"settings.row-tools\" />\n              </div>\n            ) : (\n              <div />\n            )}\n            {showStreamerMode ? (\n              <div className={rowClasses}>\n                <div className={styles.icon}>\n                  <i>\n                    <FontAwesomeIcon icon={faVideo} />\n                  </i>\n                </div>\n                <div className={styles.listItem}>\n                  <div\n                    className={styles.listItemLink}\n                    onClick={() => {\n                      this.props.toggleStreamerMode(true);\n                      this.setState({ expanded: false });\n                    }}\n                  >\n                    <FormattedMessage id=\"settings.enable-streamer-mode\" />\n                  </div>\n                </div>\n              </div>\n            ) : (\n              <div />\n            )}\n            {false && <div className={classNames([styles.bottomLinksMain])}>\n              <a href=\"/whats-new\" target=\"_blank\" rel=\"noreferrer noopener\">\n                <FormattedMessage id=\"settings.whats-new\" />\n              </a>\n              <button\n                onClick={e => {\n                  e.preventDefault();\n                  resetTips();\n                  this.setState({ expanded: false });\n                }}\n              >\n                <FormattedMessage id=\"settings.tips\" />\n              </button>\n              <a href=\"https://github.com/mozilla/hubs/wiki/Hubs-Controls\" target=\"_blank\" rel=\"noreferrer noopener\">\n                <FormattedMessage id=\"settings.controls\" />\n              </a>\n            </div>}\n            {false && <div className={classNames([styles.bottomLinks])}>\n              <a href=\"https://github.com/mozilla/hubs/wiki/Hubs-Features\" target=\"_blank\" rel=\"noreferrer noopener\">\n                <FormattedMessage id=\"settings.features\" />\n              </a>\n              <a href=\"https://discord.gg/wHmY4nd\" target=\"_blank\" rel=\"noreferrer noopener\">\n                <FormattedMessage id=\"settings.community\" />\n              </a>\n              <button\n                onClick={e => {\n                  e.preventDefault();\n                  this.props.pushHistoryState(\"modal\", \"feedback\");\n                }}\n              >\n                <FormattedMessage id=\"settings.send-feedback\" />\n              </button>\n              <a className={styles.bottomLink} href=\"/?report\" target=\"_blank\" rel=\"noreferrer noopener\">\n                <FormattedMessage id=\"settings.report\" />\n              </a>\n              <a\n                className={styles.bottomLink}\n                href={this.props.termsLink || \"https://github.com/mozilla/hubs/blob/master/TERMS.md\"}\n                target=\"_blank\"\n                rel=\"noreferrer noopener\"\n              >\n                <FormattedMessage id=\"settings.terms\" />\n              </a>\n              <a\n                className={styles.bottomLink}\n                href={this.props.privacyLink || \"https://github.com/mozilla/hubs/blob/master/PRIVACY.md\"}\n                target=\"_blank\"\n                rel=\"noreferrer noopener\"\n              >\n                <FormattedMessage id=\"settings.privacy\" />\n              </a>\n            </div>}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  render() {\n    return (\n      <div>\n        <FontAwesomeIcon\n          icon={faBars}\n          onClick={() => this.setState({ expanded: !this.state.expanded })}\n          className={classNames({\n            [rootStyles.cornerButton]: true,\n            [rootStyles.cornerButtonSelected]: this.state.expanded\n          })}\n        />\n        {this.state.expanded && this.renderExpandedMenu()}\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\n// import hubLogo from \"../assets/images/hub-preview-white.png\";\nimport styles from \"../assets/stylesheets/preload-overlay.scss\";\nimport { FormattedMessage } from \"react-intl\";\n\nconst isMobile = AFRAME.utils.device.isMobile();\n\nexport default class PreloadOverlay extends Component {\n  static propTypes = {\n    hubName: PropTypes.string,\n    hubScene: PropTypes.object,\n    baseUrl: PropTypes.string,\n    onLoadClicked: PropTypes.func\n  };\n\n  render() {\n    return (\n      <div className={styles.treatment}>\n        <div className={styles.screenshot}>\n          {this.props.hubScene && <img className={styles.screenshot} src={this.props.hubScene.screenshot_url} />}\n        </div>\n        <a href=\"/\" target=\"_blank\" rel=\"noopener noreferrer\" className={styles.logo}>\n          <img src={this.props.logo} />\n        </a>\n        <div className={styles.mainPanel}>\n          <div className={styles.hubName}>{this.props.hubName}</div>\n          {this.props.onLoadClicked &&\n            (!isMobile ? (\n              <button className={styles.loadButton} onClick={this.props.onLoadClicked}>\n                <FormattedMessage id=\"embed.load-button\" />\n              </button>\n            ) : (\n              <a href={this.props.baseUrl} target=\"_blank\" className={styles.loadButton} rel=\"noreferrer noopener\">\n                <FormattedMessage id=\"embed.load-button\" />\n              </a>\n            ))}\n        </div>\n      </div>\n    );\n  }\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport cx from \"classnames\";\n\nconst { detect } = require(\"detect-browser\");\nimport styles from \"../assets/stylesheets/2d-hud.scss\";\nimport uiStyles from \"../assets/stylesheets/ui-root.scss\";\nimport spritesheet from \"../assets/images/spritesheets/css-spritesheet.css\";\nimport { FormattedMessage } from \"react-intl\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport { micLevelForVolume } from \"../components/audio-feedback\";\n\nconst SPRITESHEET_ICONS = {\n  MIC: [\n    spritesheet.mic0,\n    spritesheet.mic1,\n    spritesheet.mic2,\n    spritesheet.mic3,\n    spritesheet.mic4,\n    spritesheet.mic5,\n    spritesheet.mic6,\n    spritesheet.mic7\n  ],\n  MIC_OFF: [\n    spritesheet.micOff0,\n    spritesheet.micOff1,\n    spritesheet.micOff2,\n    spritesheet.micOff3,\n    spritesheet.micOff4,\n    spritesheet.micOff5,\n    spritesheet.micOff6,\n    spritesheet.micOff7\n  ]\n};\nconst browser = detect();\nconst noop = () => {};\n\nclass TopHUD extends Component {\n  static propTypes = {\n    scene: PropTypes.object,\n    muted: PropTypes.bool,\n    flyingEnabled: PropTypes.bool,\n    isCursorHoldingPen: PropTypes.bool,\n    hasActiveCamera: PropTypes.bool,\n    frozen: PropTypes.bool,\n    watching: PropTypes.bool,\n    onWatchEnded: PropTypes.func,\n    videoShareMediaSource: PropTypes.string,\n    showVideoShareFailed: PropTypes.bool,\n    hideVideoShareFailedTip: PropTypes.func,\n    activeTip: PropTypes.string,\n    history: PropTypes.object,\n    onToggleMute: PropTypes.func,\n    onToggleFreeze: PropTypes.func,\n    onSpawnPen: PropTypes.func,\n    onSpawnCamera: PropTypes.func,\n    onShareVideo: PropTypes.func,\n    onEndShareVideo: PropTypes.func,\n    onShareVideoNotCapable: PropTypes.func,\n    mediaSearchStore: PropTypes.object,\n    isStreaming: PropTypes.bool,\n    showStreamingTip: PropTypes.bool,\n    hideStreamingTip: PropTypes.func\n  };\n\n  state = {\n    showVideoShareOptions: false,\n    lastActiveMediaSource: null,\n    micLevel: 0,\n    cameraDisabled: false,\n    penDisabled: false,\n    mediaDisabled: false\n  };\n\n  constructor(props) {\n    super(props);\n    this.state.cameraDisabled = !window.APP.hubChannel.can(\"spawn_camera\");\n    this.state.penDisabled = !window.APP.hubChannel.can(\"spawn_drawing\");\n    this.state.mediaDisabled = !window.APP.hubChannel.can(\"spawn_and_move_media\");\n  }\n\n  onPermissionsUpdated = () => {\n    this.setState({\n      cameraDisabled: !window.APP.hubChannel.can(\"spawn_camera\"),\n      penDisabled: !window.APP.hubChannel.can(\"spawn_drawing\"),\n      mediaDisabled: !window.APP.hubChannel.can(\"spawn_and_move_media\")\n    });\n  };\n\n  componentDidMount = () => {\n    let max = 0;\n    if (this.micUpdateInterval) {\n      clearInterval(this.micUpdateInterval);\n    }\n    this.micUpdateInterval = setInterval(() => {\n      const volume = this.props.scene.systems[\"local-audio-analyser\"].volume;\n      max = Math.max(volume, max);\n      const micLevel = micLevelForVolume(volume, max);\n      if (micLevel !== this.state.micLevel) {\n        this.setState({ micLevel });\n      }\n    }, 50);\n    window.APP.hubChannel.addEventListener(\"permissions_updated\", this.onPermissionsUpdated);\n  };\n\n  componentWillUnmount = () => {\n    if (this.micUpdateInterval) {\n      clearInterval(this.micUpdateInterval);\n    }\n    window.APP.hubChannel.removeEventListener(\"permissions_updated\", this.onPermissionsUpdated);\n  };\n\n  handleVideoShareClicked = source => {\n    if ((source === \"screen\" || source === \"window\") && browser.name !== \"firefox\") {\n      this.props.onShareVideoNotCapable();\n      return;\n    }\n\n    if (this.props.videoShareMediaSource) {\n      this.props.onEndShareVideo();\n    } else {\n      this.props.onShareVideo(source);\n      this.setState({ lastActiveMediaSource: source });\n    }\n  };\n\n  buildVideoSharingButtons = () => {\n    const isMobile = AFRAME.utils.device.isMobile() || AFRAME.utils.device.isMobileVR();\n\n    const videoShareExtraOptionTypes = [];\n    const primaryVideoShareType =\n      this.props.videoShareMediaSource || this.state.lastActiveMediaSource || (isMobile ? \"camera\" : \"screen\");\n\n    if (this.state.showVideoShareOptions) {\n      videoShareExtraOptionTypes.push(primaryVideoShareType);\n\n      [\"screen\", \"window\", \"camera\"].forEach(t => {\n        if (videoShareExtraOptionTypes.indexOf(t) === -1) {\n          videoShareExtraOptionTypes.push(t);\n        }\n      });\n    }\n\n    const showExtrasOnHover = () => {\n      if (isMobile) return;\n\n      clearTimeout(this.hideVideoSharingButtonTimeout);\n\n      if (!this.props.videoShareMediaSource) {\n        this.setState({ showVideoShareOptions: true });\n      }\n    };\n\n    const hideExtrasOnOut = () => {\n      this.hideVideoSharingButtonTimeout = setTimeout(() => {\n        this.setState({ showVideoShareOptions: false });\n      }, 250);\n    };\n\n    const maybeHandlePrimaryShare = () => {\n      if (!this.state.showVideoShareOptions) {\n        this.handleVideoShareClicked(primaryVideoShareType);\n      }\n    };\n\n    const capitalize = str => str[0].toUpperCase() + str.slice(1);\n\n    return (\n      <div\n        className={cx(styles.iconButton, styles[`share_${primaryVideoShareType}`], {\n          [styles.active]: this.props.videoShareMediaSource === primaryVideoShareType,\n          [styles.disabled]: this.state.mediaDisabled,\n          [styles.videoShare]: true\n        })}\n        title={\n          this.props.videoShareMediaSource !== null\n            ? \"Stop sharing\"\n            : `Share ${capitalize(primaryVideoShareType)}${this.state.mediaDisabled ? \" Disabled\" : \"\"}`\n        }\n        onClick={this.state.mediaDisabled ? noop : maybeHandlePrimaryShare}\n        onMouseOver={this.state.mediaDisabled ? noop : showExtrasOnHover}\n      >\n        {videoShareExtraOptionTypes.length > 0 && (\n          <div className={cx(styles.videoShareExtraOptions)} onMouseOut={hideExtrasOnOut}>\n            {videoShareExtraOptionTypes.map(type => (\n              <div\n                key={type}\n                className={cx(styles.iconButton, styles[`share_${type}`], {\n                  [styles.active]: this.props.videoShareMediaSource === type,\n                  [styles.disabled]: this.state.mediaDisabled\n                })}\n                title={\n                  this.props.videoShareMediaSource === type\n                    ? \"Stop sharing\"\n                    : `Share ${capitalize(type)}${this.state.mediaDisabled ? \" Disabled\" : \"\"}`\n                }\n                onClick={this.state.mediaDisabled ? noop : () => this.handleVideoShareClicked(type)}\n                onMouseOver={this.state.mediaDisabled ? noop : showExtrasOnHover}\n              />\n            ))}\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  render() {\n    const videoSharingButtons = this.buildVideoSharingButtons();\n    const isMobile = AFRAME.utils.device.isMobile();\n    const tipDivForType = (type, cancelFunc) => (\n      <div className={cx(styles.topTip)}>\n        {cancelFunc && (\n          <button className={styles.tipCancel} onClick={cancelFunc}>\n            <i>\n              <FontAwesomeIcon icon={faTimes} />\n            </i>\n          </button>\n        )}\n        {!this.props.frozen && <div className={cx([styles.attachPoint, styles[`attach_${type.split(\".\")[1]}`]])} />}\n        <FormattedMessage id={`tips.${type}`} />\n      </div>\n    );\n\n    let tip;\n\n    if (this.props.watching) {\n      tip = (\n        <div className={cx([styles.topTip, styles.topTipNoHud])}>\n          <button className={styles.tipCancel} onClick={() => this.props.onWatchEnded()}>\n            <i>\n              <FontAwesomeIcon icon={faTimes} />\n            </i>\n          </button>\n          <FormattedMessage id={`tips.${isMobile ? \"mobile\" : \"desktop\"}.watching`} />\n          {!isMobile && (\n            <button className={styles.tipCancelText} onClick={() => this.props.onWatchEnded()}>\n              <FormattedMessage id=\"tips.watching.back\" />\n            </button>\n          )}\n        </div>\n      );\n    } else if (this.props.showVideoShareFailed) {\n      tip = tipDivForType(`${isMobile ? \"mobile\" : \"desktop\"}.video_share_failed`, this.props.hideVideoShareFailedTip);\n    } else if (this.props.activeTip) {\n      tip = tipDivForType(this.props.activeTip);\n    }\n\n    const micLevel = this.state.micLevel;\n    const micIconClass = this.props.muted ? SPRITESHEET_ICONS.MIC_OFF[micLevel] : SPRITESHEET_ICONS.MIC[micLevel];\n    // Hide buttons when frozen.\n    return (\n      <div className={cx(styles.container, styles.top, styles.unselectable, uiStyles.uiInteractive)}>\n        {this.props.frozen || this.props.watching ? (\n          <div className={cx(uiStyles.uiInteractive, styles.panel)}>{tip}</div>\n        ) : (\n          <div className={cx(uiStyles.uiInteractive, styles.panel)}>\n            {tip}\n            {videoSharingButtons}\n            <div\n              className={cx(styles.iconButton, micIconClass)}\n              title={this.props.muted ? \"Unmute Mic\" : \"Mute Mic\"}\n              onClick={this.props.onToggleMute}\n            />\n            <button\n              className={cx(uiStyles.uiInteractive, styles.iconButton, styles.spawn, {\n                [styles.disabled]: this.state.mediaDisabled\n              })}\n              onClick={\n                this.state.mediaDisabled ? noop : () => this.props.mediaSearchStore.sourceNavigateToDefaultSource()\n              }\n            />\n            {false && <div\n              className={cx(styles.iconButton, styles.pen, {\n                [styles.active]: this.props.isCursorHoldingPen,\n                [styles.disabled]: this.state.penDisabled\n              })}\n              title={`Pen${this.state.penDisabled ? \" Disabled\" : \"\"}`}\n              onClick={this.state.penDisabled ? noop : this.props.onSpawnPen}\n            />}\n            <div\n              className={cx(styles.iconButton, styles.camera, {\n                [styles.active]: this.props.hasActiveCamera,\n                [styles.disabled]: this.state.cameraDisabled\n              })}\n              title={`Camera${this.state.cameraDisabled ? \" Disabled\" : \"\"}`}\n              onClick={this.state.cameraDisabled ? noop : this.props.onSpawnCamera}\n            />\n            <div\n              className={cx(styles.iconButton, styles.fly, { [styles.active]: this.props.flyingEnabled })}\n              title={this.props.flyingEnabled ? \"Disable Flying\" : \"Enable Flying\"}\n              onClick={()=>this.props.onToggleFlying(!this.props.flyingEnabled)}\n            />\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n\nexport default { TopHUD };\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport styles from \"../assets/stylesheets/spectating-label.scss\";\nimport { FormattedMessage } from \"react-intl\";\n\nexport class SpectatingLabel extends Component {\n  static propTypes = {\n    name: PropTypes.string\n  };\n\n  render() {\n    return (\n      <div className={styles.label}>\n        <FormattedMessage id=\"lobby.watching\" />\n        <b>{this.props.name}</b>\n      </div>\n    );\n  }\n}\n","import { willRequireUserGesture, showFullScreenIfAvailable } from \"./fullscreen\";\nimport screenfull from \"screenfull\";\n\nlet _isIn2DInterstitial = false;\nlet _exitAction = null;\n\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\n\nconst afterUserGesturePrompt = f => {\n  const scene = document.querySelector(\"a-scene\");\n  scene.addEventListener(\"2d-interstitial-gesture-complete\", f, { once: true });\n  scene.emit(\"2d-interstitial-gesture-required\");\n};\n\nexport function handleExitTo2DInterstitial(isLower, exitAction) {\n  const scene = document.querySelector(\"a-scene\");\n  if (!scene.is(\"vr-mode\")) {\n    if (isMobileVR && willRequireUserGesture()) {\n      afterUserGesturePrompt(() => {\n        showFullScreenIfAvailable();\n      });\n    }\n\n    return;\n  }\n\n  _isIn2DInterstitial = true;\n  _exitAction = exitAction;\n\n  if (isMobileVR) {\n    // Immersive browser, exit VR.\n    scene.exitVR().then(() => {\n      afterUserGesturePrompt(() => {\n        showFullScreenIfAvailable();\n      });\n    });\n  } else {\n    // Non-immersive browser, show notice\n    const vrNotice = document.querySelector(\".vr-notice\");\n    vrNotice.object3D.visible = true;\n    vrNotice.setAttribute(\"follow-in-fov\", {\n      angle: isLower ? 39 : -15\n    });\n  }\n}\n\nexport function exit2DInterstitialAndEnterVR(force) {\n  if (!force && !_isIn2DInterstitial) {\n    return;\n  }\n\n  _isIn2DInterstitial = false;\n\n  document.querySelector(\".vr-notice\").object3D.visible = false;\n\n  const scene = document.querySelector(\"a-scene\");\n\n  if (isMobileVR) {\n    if (screenfull.isFullscreen) {\n      screenfull.exit();\n      afterUserGesturePrompt(() => scene.enterVR());\n    } else {\n      scene.enterVR();\n    }\n  } else {\n    if (!scene.is(\"vr-mode\")) {\n      scene.enterVR();\n    }\n  }\n}\n\nexport function isIn2DInterstitial() {\n  return _isIn2DInterstitial;\n}\n\nexport function forceExitFrom2DInterstitial() {\n  if (!_isIn2DInterstitial) return;\n\n  if (_exitAction) {\n    _exitAction();\n    _exitAction = null;\n  }\n\n  exit2DInterstitialAndEnterVR();\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport copy from \"copy-to-clipboard\";\nimport { getAirtableAssets, airtableAssetsInitialState } from '../everyspace/airtable'\nimport { IntlProvider, FormattedMessage, addLocaleData } from \"react-intl\";\nimport en from \"react-intl/locale-data/en\";\nimport screenfull from \"screenfull\";\nimport { HelmetComponent } from \"../everyspace/helmet\";\nimport { VR_DEVICE_AVAILABILITY } from \"../utils/vr-caps-detect\";\nimport { canShare } from \"../utils/share\";\nimport styles from \"../assets/stylesheets/ui-root.scss\";\nimport entryStyles from \"../assets/stylesheets/entry.scss\";\nimport inviteStyles from \"../assets/stylesheets/invite-dialog.scss\";\nimport { ReactAudioContext, WithHoverSound } from \"./wrap-with-audio\";\nimport {\n  pushHistoryState,\n  clearHistoryState,\n  popToBeginningOfHubHistory,\n  navigateToPriorPage,\n  sluglessPath\n} from \"../utils/history\";\nimport StateLink from \"./state-link.js\";\nimport StateRoute from \"./state-route.js\";\nimport { getPresenceProfileForSession, discordBridgesForPresences } from \"../utils/phoenix-utils\";\nimport { getClientInfoClientId } from \"./client-info-dialog\";\nimport { getCurrentStreamer } from \"../utils/component-utils\";\n\nimport { lang, messages } from \"../utils/i18n\";\nimport Loader from \"./loader\";\nimport AutoExitWarning from \"./auto-exit-warning\";\nimport { TwoDEntryButton, GenericEntryButton, DaydreamEntryButton } from \"./entry-buttons.js\";\nimport ProfileEntryPanel from \"./profile-entry-panel\";\nimport MediaBrowser from \"./media-browser\";\n\nimport CreateObjectDialog from \"./create-object-dialog.js\";\nimport ChangeSceneDialog from \"./change-scene-dialog.js\";\nimport AvatarUrlDialog from \"./avatar-url-dialog.js\";\nimport HelpDialog from \"./help-dialog.js\";\nimport InviteDialog from \"./invite-dialog.js\";\nimport InviteTeamDialog from \"./invite-team-dialog.js\";\nimport LinkDialog from \"./link-dialog.js\";\nimport SafariDialog from \"./safari-dialog.js\";\nimport SafariMicDialog from \"./safari-mic-dialog.js\";\nimport SignInDialog from \"./sign-in-dialog.js\";\nimport RoomSettingsDialog from \"./room-settings-dialog.js\";\nimport CloseRoomDialog from \"./close-room-dialog.js\";\nimport Tip from \"./tip.js\";\nimport WebRTCScreenshareUnsupportedDialog from \"./webrtc-screenshare-unsupported-dialog.js\";\nimport WebAssemblyUnsupportedDialog from \"./webassembly-unsupported-dialog.js\";\nimport WebVRRecommendDialog from \"./webvr-recommend-dialog.js\";\nimport FeedbackDialog from \"./feedback-dialog.js\";\nimport LeaveRoomDialog from \"./leave-room-dialog.js\";\nimport RoomInfoDialog from \"./room-info-dialog.js\";\nimport ClientInfoDialog from \"./client-info-dialog.js\";\nimport OAuthDialog from \"./oauth-dialog.js\";\nimport TweetDialog from \"./tweet-dialog.js\";\nimport LobbyChatBox from \"./lobby-chat-box.js\";\nimport InWorldChatBox from \"./in-world-chat-box.js\";\nimport AvatarEditor from \"./avatar-editor\";\nimport MicLevelWidget from \"./mic-level-widget.js\";\nimport OutputLevelWidget from \"./output-level-widget.js\";\nimport PresenceLog from \"./presence-log.js\";\nimport PresenceList from \"./presence-list.js\";\nimport SettingsMenu from \"./settings-menu.js\";\nimport PreloadOverlay from \"./preload-overlay.js\";\nimport TwoDHUD from \"./2d-hud\";\nimport { SpectatingLabel } from \"./spectating-label\";\nimport { showFullScreenIfAvailable, showFullScreenIfWasFullScreen } from \"../utils/fullscreen\";\nimport { exit2DInterstitialAndEnterVR, isIn2DInterstitial } from \"../utils/vr-interstitial\";\n\nimport { faTimes } from \"@fortawesome/free-solid-svg-icons/faTimes\";\nimport { faStar } from \"@fortawesome/free-solid-svg-icons/faStar\";\nimport { faArrowLeft } from \"@fortawesome/free-solid-svg-icons/faArrowLeft\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\n\nimport qsTruthy from \"../utils/qs_truthy\";\nconst avatarEditorDebug = qsTruthy(\"avatarEditorDebug\");\n\naddLocaleData([...en]);\n\n// This is a list of regexes that match the microphone labels of HMDs.\n//\n// If entering VR mode, and if any of these regexes match an audio device,\n// the user will be prevented from entering VR until one of those devices is\n// selected as the microphone.\n//\n// Note that this doesn't have to be exhaustive: if no devices match any regex\n// then we rely upon the user to select the proper mic.\nconst HMD_MIC_REGEXES = [/\\Wvive\\W/i, /\\Wrift\\W/i];\n\nconst IN_ROOM_MODAL_ROUTER_PATHS = [\"/media\"];\nconst IN_ROOM_MODAL_QUERY_VARS = [\"media_source\"];\n\nconst LOBBY_MODAL_ROUTER_PATHS = [\"/media/scenes\", \"/media/avatars\", \"/media/favorites\"];\nconst LOBBY_MODAL_QUERY_VARS = [\"media_source\"];\nconst LOBBY_MODAL_QUERY_VALUES = [\"scenes\", \"avatars\", \"favorites\"];\n\nasync function grantedMicLabels() {\n  const mediaDevices = await navigator.mediaDevices.enumerateDevices();\n  return mediaDevices.filter(d => d.label && d.kind === \"audioinput\").map(d => d.label);\n}\n\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\nconst isMobilePhoneOrVR = isMobile || isMobileVR;\n\nconst AUTO_EXIT_TIMER_SECONDS = 10;\n\nclass UIRoot extends Component {\n  willCompileAndUploadMaterials = false;\n\n  static propTypes = {\n    enterScene: PropTypes.func,\n    exitScene: PropTypes.func,\n    onSendMessage: PropTypes.func,\n    disableAutoExitOnConcurrentLoad: PropTypes.bool,\n    forcedVREntryType: PropTypes.string,\n    isBotMode: PropTypes.bool,\n    store: PropTypes.object,\n    mediaSearchStore: PropTypes.object,\n    scene: PropTypes.object,\n    authChannel: PropTypes.object,\n    hubChannel: PropTypes.object,\n    linkChannel: PropTypes.object,\n    hubEntryCode: PropTypes.number,\n    availableVREntryTypes: PropTypes.object,\n    environmentSceneLoaded: PropTypes.bool,\n    roomUnavailableReason: PropTypes.string,\n    platformUnsupportedReason: PropTypes.string,\n    hubId: PropTypes.string,\n    hubName: PropTypes.string,\n    hubMemberPermissions: PropTypes.object,\n    hubScene: PropTypes.object,\n    hubIsBound: PropTypes.bool,\n    isSupportAvailable: PropTypes.bool,\n    presenceLogEntries: PropTypes.array,\n    presences: PropTypes.object,\n    sessionId: PropTypes.string,\n    subscriptions: PropTypes.object,\n    initialIsSubscribed: PropTypes.bool,\n    initialIsFavorited: PropTypes.bool,\n    showSignInDialog: PropTypes.bool,\n    signInMessageId: PropTypes.string,\n    signInCompleteMessageId: PropTypes.string,\n    signInContinueTextId: PropTypes.string,\n    onContinueAfterSignIn: PropTypes.func,\n    showSafariDialog: PropTypes.bool,\n    showSafariMicDialog: PropTypes.bool,\n    showWebAssemblyDialog: PropTypes.bool,\n    showOAuthDialog: PropTypes.bool,\n    onCloseOAuthDialog: PropTypes.func,\n    oauthInfo: PropTypes.array,\n    isCursorHoldingPen: PropTypes.bool,\n    hasActiveCamera: PropTypes.bool,\n    onMediaSearchResultEntrySelected: PropTypes.func,\n    onAvatarSaved: PropTypes.func,\n    activeTips: PropTypes.object,\n    location: PropTypes.object,\n    history: PropTypes.object,\n    showInterstitialPrompt: PropTypes.bool,\n    onInterstitialPromptClicked: PropTypes.func,\n    performConditionalSignIn: PropTypes.func,\n    hide: PropTypes.bool,\n    showPreload: PropTypes.bool,\n    onPreloadLoadClicked: PropTypes.func,\n    embed: PropTypes.bool,\n    embedToken: PropTypes.string,\n    onLoaded: PropTypes.func\n  };\n\n  state = {\n    enterInVR: false,\n    muteOnEntry: false,\n    entered: false,\n    dialog: null,\n    showShareDialog: false,\n    broadcastTipDismissed: false,\n    linkCode: null,\n    linkCodeCancel: null,\n    miniInviteActivated: false,\n\n    didConnectToNetworkedScene: false,\n    noMoreLoadingUpdates: false,\n    hideLoader: false,\n    watching: false,\n    isStreaming: false,\n    showStreamingTip: false,\n\n    waitingOnAudio: false,\n    mediaStream: null,\n    audioTrack: null,\n    micDevices: [],\n\n    autoExitTimerStartedAt: null,\n    autoExitTimerInterval: null,\n    secondsRemainingBeforeAutoExit: Infinity,\n\n    muted: false,\n    flyingEnabled: false,\n    frozen: false,\n\n    exited: false,\n\n    signedIn: false,\n    videoShareMediaSource: null,\n    showVideoShareFailed: false\n  };\n\n  constructor(props) {\n    super(props);\n    if (props.showSafariMicDialog) {\n      this.state.dialog = <SafariMicDialog closable={false} />;\n    }\n    if (props.showSafariDialog) {\n      this.state.dialog = <SafariDialog closable={false} />;\n    }\n    if (props.showWebAssemblyDialog) {\n      this.state.dialog = <WebAssemblyUnsupportedDialog closable={false} />;\n    }\n\n    props.mediaSearchStore.setHistory(props.history);\n\n    // An exit handler that discards event arguments and can be cleaned up.\n    this.exitEventHandler = () => this.exit();\n\n    this.state.airtableAssets = airtableAssetsInitialState;\n  }\n\n  componentDidUpdate(prevProps) {\n    const { hubChannel, showSignInDialog } = this.props;\n    if (hubChannel) {\n      const { signedIn } = hubChannel;\n      if (signedIn !== this.state.signedIn) {\n        this.setState({ signedIn });\n      }\n    }\n    if (prevProps.showSignInDialog !== showSignInDialog) {\n      if (showSignInDialog) {\n        this.showContextualSignInDialog();\n      } else {\n        this.closeDialog();\n      }\n    }\n    if (!this.willCompileAndUploadMaterials && this.state.noMoreLoadingUpdates) {\n      this.willCompileAndUploadMaterials = true;\n      // We want to ensure that react and the browser have had the chance to render / update.\n      // See https://stackoverflow.com/a/34999925 , although our solution flipped setTimeout and requestAnimationFrame\n      window.requestAnimationFrame(() => {\n        window.setTimeout(() => {\n          if (!this.props.isBotMode) {\n            this.props.scene.renderer.compileAndUploadMaterials(this.props.scene.object3D, this.props.scene.camera);\n          }\n\n          if (!this.state.hideLoader) {\n            this.setState({ hideLoader: true });\n          }\n        }, 0);\n      });\n    }\n  }\n\n  componentDidMount() {\n    window.addEventListener(\"concurrentload\", this.onConcurrentLoad);\n    document.querySelector(\".a-canvas\").addEventListener(\"mouseup\", () => {\n      if (this.state.showShareDialog) {\n        this.setState({ showShareDialog: false });\n      }\n    });\n\n    this.props.scene.addEventListener(\n      \"didConnectToNetworkedScene\",\n      () => {\n        this.setState({ didConnectToNetworkedScene: true });\n      },\n      { once: true }\n    );\n    this.props.scene.addEventListener(\"loaded\", this.onSceneLoaded);\n    this.props.scene.addEventListener(\"stateadded\", this.onAframeStateChanged);\n    this.props.scene.addEventListener(\"stateremoved\", this.onAframeStateChanged);\n    this.props.scene.addEventListener(\"share_video_enabled\", this.onShareVideoEnabled);\n    this.props.scene.addEventListener(\"share_video_disabled\", this.onShareVideoDisabled);\n    this.props.scene.addEventListener(\"share_video_failed\", this.onShareVideoFailed);\n    this.props.scene.addEventListener(\"exit\", this.exitEventHandler);\n    this.props.scene.addEventListener(\"action_exit_watch\", () => this.setState({ watching: false, hide: false }));\n\n    const scene = this.props.scene;\n\n    this.props.store.addEventListener(\"statechanged\", this.onStoreChanged);\n\n    const unsubscribe = this.props.history.listen((location, action) => {\n      const state = location.state;\n\n      // If we just hit back into the entry flow, just go back to the page before the room landing page.\n      if (action === \"POP\" && state && state.entry_step && this.state.entered) {\n        unsubscribe();\n        navigateToPriorPage(this.props.history);\n        return;\n      }\n    });\n\n    // If we refreshed the page with any state history (eg if we were in the entry flow\n    // or had a modal/overlay open) just reset everything to the beginning of the flow by\n    // erasing all history that was accumulated for this room (including across refreshes.)\n    //\n    // We don't do this for the media browser case, since we want to be able to share\n    // links to the browser pages\n    if (this.props.history.location.state && !sluglessPath(this.props.history.location).startsWith(\"/media\")) {\n      popToBeginningOfHubHistory(this.props.history);\n    }\n\n    this.setState({\n      audioContext: {\n        playSound: sound => {\n          scene.emit(sound);\n        },\n        onMouseLeave: () => {\n          //          scene.emit(\"play_sound-hud_mouse_leave\");\n        }\n      }\n    });\n\n    if (this.props.forcedVREntryType && this.props.forcedVREntryType.endsWith(\"_now\")) {\n      setTimeout(() => this.handleForceEntry(), 2000);\n    }\n\n    this.fetchAirtableAssets()\n  }\n\n  fetchAirtableAssets = async () => {\n    const airtableAssets = await getAirtableAssets()\n    if (airtableAssets) this.setState({ airtableAssets })\n  }\n\n  componentWillUnmount() {\n    this.props.scene.removeEventListener(\"loaded\", this.onSceneLoaded);\n    this.props.scene.removeEventListener(\"exit\", this.exitEventHandler);\n    this.props.scene.removeEventListener(\"share_video_enabled\", this.onShareVideoEnabled);\n    this.props.scene.removeEventListener(\"share_video_disabled\", this.onShareVideoDisabled);\n    this.props.scene.removeEventListener(\"share_video_failed\", this.onShareVideoFailed);\n  }\n\n  // SignInDialog = ({onClose, message, onSignIn}) => <SignInDialog onClose={onClose} message={message} onSignIn={onSignIn} privacyLink={this.state.airtableAssets.Privacy_Link} termsLink={this.state.airtableAssets.Terms_Link} />\n\n  showContextualSignInDialog = () => {\n    const {\n      signInMessageId,\n      authChannel,\n      signInCompleteMessageId,\n      signInContinueTextId,\n      onContinueAfterSignIn\n    } = this.props;\n\n    this.showNonHistoriedDialog(SignInDialog, {\n      message: messages[signInMessageId],\n      onSignIn: async email => {\n        const { authComplete } = await authChannel.startAuthentication(email, this.props.hubChannel);\n\n        this.showNonHistoriedDialog(SignInDialog, { authStarted: true, onClose: onContinueAfterSignIn });\n\n        await authComplete;\n\n        this.setState({ signedIn: true });\n        this.showNonHistoriedDialog(SignInDialog, {\n          authComplete: true,\n          message: messages[signInCompleteMessageId],\n          continueText: messages[signInContinueTextId],\n          onClose: onContinueAfterSignIn,\n          onContinue: onContinueAfterSignIn\n        });\n      },\n      onClose: onContinueAfterSignIn\n    });\n  };\n\n  updateSubscribedState = () => {\n    const isSubscribed = this.props.subscriptions && this.props.subscriptions.isSubscribed();\n    this.setState({ isSubscribed });\n  };\n\n  toggleFavorited = () => {\n    this.props.performConditionalSignIn(\n      () => this.props.hubChannel.signedIn,\n      () => {\n        const isFavorited = this.isFavorited();\n\n        this.props.hubChannel[isFavorited ? \"unfavorite\" : \"favorite\"]();\n        this.setState({ isFavorited: !isFavorited });\n      },\n      \"favorite-room\"\n    );\n  };\n\n  isFavorited = () => {\n    return this.state.isFavorited !== undefined ? this.state.isFavorited : this.props.initialIsFavorited;\n  };\n\n  onLoadingFinished = () => {\n    this.setState({ noMoreLoadingUpdates: true });\n\n    if (this.props.onLoaded) {\n      this.props.onLoaded();\n    }\n  };\n\n  onSceneLoaded = () => {\n    this.setState({ sceneLoaded: true });\n  };\n\n  // TODO: we need to come up with a cleaner way to handle the shared state between aframe and react than emmitting events and setting state on the scene\n  onAframeStateChanged = e => {\n    if (!(e.detail === \"muted\" || e.detail === \"frozen\")) return;\n    this.setState({\n      [e.detail]: this.props.scene.is(e.detail)\n    });\n  };\n\n  onShareVideoEnabled = e => {\n    this.setState({ videoShareMediaSource: e.detail.source });\n  };\n\n  onShareVideoDisabled = () => {\n    this.setState({ videoShareMediaSource: null });\n  };\n\n  onShareVideoFailed = () => {\n    this.setState({ showVideoShareFailed: true });\n  };\n\n  toggleMute = () => {\n    this.props.scene.emit(\"action_mute\");\n  };\n\n  toggleFreeze = () => {\n    this.props.scene.emit(\"action_freeze\");\n  };\n\n  shareVideo = mediaSource => {\n    this.props.scene.emit(`action_share_${mediaSource}`);\n  };\n\n  endShareVideo = () => {\n    this.props.scene.emit(\"action_end_video_sharing\");\n  };\n\n  spawnPen = () => {\n    this.props.scene.emit(\"penButtonPressed\");\n  };\n\n  onSubscribeChanged = async () => {\n    if (!this.props.subscriptions) return;\n\n    await this.props.subscriptions.toggle();\n    this.updateSubscribedState();\n  };\n\n  handleForceEntry = () => {\n    if (!this.props.forcedVREntryType) return;\n\n    if (this.props.forcedVREntryType.startsWith(\"daydream\")) {\n      this.enterDaydream();\n    } else if (this.props.forcedVREntryType.startsWith(\"vr\")) {\n      this.enterVR();\n    } else if (this.props.forcedVREntryType.startsWith(\"2d\")) {\n      this.enter2D();\n    }\n  };\n\n  onConcurrentLoad = () => {\n    if (this.props.disableAutoExitOnConcurrentLoad) return;\n\n    const autoExitTimerInterval = setInterval(() => {\n      let secondsRemainingBeforeAutoExit = Infinity;\n\n      if (this.state.autoExitTimerStartedAt) {\n        const secondsSinceStart = (new Date() - this.state.autoExitTimerStartedAt) / 1000;\n        secondsRemainingBeforeAutoExit = Math.max(0, Math.floor(AUTO_EXIT_TIMER_SECONDS - secondsSinceStart));\n      }\n\n      this.setState({ secondsRemainingBeforeAutoExit });\n      this.checkForAutoExit();\n    }, 500);\n\n    this.setState({ autoExitTimerStartedAt: new Date(), autoExitTimerInterval });\n  };\n\n  checkForAutoExit = () => {\n    if (this.state.secondsRemainingBeforeAutoExit !== 0) return;\n    this.endAutoExitTimer();\n    this.exit();\n  };\n\n  exit = reason => {\n    this.props.exitScene(reason);\n    this.setState({ exited: true });\n  };\n\n  isWaitingForAutoExit = () => {\n    return this.state.secondsRemainingBeforeAutoExit <= AUTO_EXIT_TIMER_SECONDS;\n  };\n\n  endAutoExitTimer = () => {\n    clearInterval(this.state.autoExitTimerInterval);\n    this.setState({\n      autoExitTimerStartedAt: null,\n      autoExitTimerInterval: null,\n      secondsRemainingBeforeAutoExit: Infinity\n    });\n  };\n\n  performDirectEntryFlow = async enterInVR => {\n    this.setState({ enterInVR, waitingOnAudio: true });\n\n    const hasGrantedMic = (await grantedMicLabels()).length > 0;\n\n    if (hasGrantedMic) {\n      await this.setMediaStreamToDefault();\n      this.beginOrSkipAudioSetup();\n    } else {\n      this.pushHistoryState(\"entry_step\", \"mic_grant\");\n    }\n\n    this.setState({ waitingOnAudio: false });\n  };\n\n  enter2D = async () => {\n    await this.performDirectEntryFlow(false);\n  };\n\n  enterVR = async () => {\n    if (this.props.forcedVREntryType || this.props.availableVREntryTypes.generic !== VR_DEVICE_AVAILABILITY.maybe) {\n      await this.performDirectEntryFlow(true);\n    } else {\n      this.pushHistoryState(\"modal\", \"webvr\");\n    }\n  };\n\n  enterDaydream = async () => {\n    await this.performDirectEntryFlow(true);\n  };\n\n  micDeviceChanged = async ev => {\n    const constraints = { audio: { deviceId: { exact: [ev.target.value] } } };\n    await this.fetchAudioTrack(constraints);\n    await this.setupNewMediaStream();\n  };\n\n  setMediaStreamToDefault = async () => {\n    let hasAudio = false;\n    const { lastUsedMicDeviceId } = this.props.store.state.settings;\n\n    // Try to fetch last used mic, if there was one.\n    if (lastUsedMicDeviceId) {\n      hasAudio = await this.fetchAudioTrack({ audio: { deviceId: { ideal: lastUsedMicDeviceId } } });\n    } else {\n      hasAudio = await this.fetchAudioTrack({ audio: true });\n    }\n\n    await this.setupNewMediaStream();\n\n    return { hasAudio };\n  };\n\n  fetchAudioTrack = async constraints => {\n    if (this.state.audioTrack) {\n      this.state.audioTrack.stop();\n    }\n\n    try {\n      const mediaStream = await navigator.mediaDevices.getUserMedia(constraints);\n      const audioTrack = mediaStream.getAudioTracks()[0];\n      this.setState({ audioTrack });\n\n      if (/Oculus/.test(navigator.userAgent)) {\n        // HACK Oculus Browser 6 seems to randomly end the microphone audio stream. This re-creates it.\n        // Note the ended event will only fire if some external event ends the stream, not if we call stop().\n        const recreateAudioStream = async () => {\n          console.warn(\n            \"Oculus Browser 6 bug hit: Audio stream track ended without calling stop. Recreating audio stream.\"\n          );\n\n          const mediaStream = await navigator.mediaDevices.getUserMedia(constraints);\n          const audioTrack = mediaStream.getAudioTracks()[0];\n          NAF.connection.adapter.setLocalMediaStream(mediaStream);\n          audioTrack.addEventListener(\"ended\", recreateAudioStream, { once: true });\n        };\n\n        audioTrack.addEventListener(\"ended\", recreateAudioStream, { once: true });\n      }\n\n      return true;\n    } catch (e) {\n      // Error fetching audio track, most likely a permission denial.\n      this.setState({ audioTrack: null });\n      return false;\n    }\n  };\n\n  setupNewMediaStream = async () => {\n    const mediaStream = new MediaStream();\n\n    await this.fetchMicDevices();\n\n    // we should definitely have an audioTrack at this point unless they denied mic access\n    if (this.state.audioTrack) {\n      mediaStream.addTrack(this.state.audioTrack);\n      const micDeviceId = this.micDeviceIdForMicLabel(this.micLabelForMediaStream(mediaStream));\n      if (micDeviceId) {\n        this.props.store.update({ settings: { lastUsedMicDeviceId: micDeviceId } });\n      }\n      const mediaStreamForMicAnalysis = new MediaStream();\n      mediaStreamForMicAnalysis.addTrack(this.state.audioTrack.clone());\n      this.props.scene.emit(\"local-media-stream-created\", { mediaStream: mediaStreamForMicAnalysis });\n    }\n\n    this.setState({ mediaStream });\n  };\n\n  onMicGrantButton = async () => {\n    if (this.props.location.state && this.props.location.state.entry_step === \"mic_grant\") {\n      const { hasAudio } = await this.setMediaStreamToDefault();\n\n      if (hasAudio) {\n        this.pushHistoryState(\"entry_step\", \"mic_granted\");\n      } else {\n        this.beginOrSkipAudioSetup();\n      }\n    } else {\n      this.beginOrSkipAudioSetup();\n    }\n  };\n\n  beginOrSkipAudioSetup = () => {\n    const skipAudioSetup = this.props.forcedVREntryType && this.props.forcedVREntryType.endsWith(\"_now\");\n\n    if (skipAudioSetup) {\n      this.onAudioReadyButton();\n    } else {\n      this.pushHistoryState(\"entry_step\", \"audio\");\n    }\n  };\n\n  fetchMicDevices = () => {\n    return new Promise(resolve => {\n      navigator.mediaDevices.enumerateDevices().then(mediaDevices => {\n        this.setState(\n          {\n            micDevices: mediaDevices\n              .filter(d => d.kind === \"audioinput\")\n              .map(d => ({ deviceId: d.deviceId, label: d.label }))\n          },\n          resolve\n        );\n      });\n    });\n  };\n\n  shouldShowHmdMicWarning = () => {\n    if (isMobile || AFRAME.utils.device.isMobileVR()) return false;\n    if (!this.state.enterInVR) return false;\n    if (!this.hasHmdMicrophone()) return false;\n\n    return !HMD_MIC_REGEXES.find(r => this.selectedMicLabel().match(r));\n  };\n\n  hasHmdMicrophone = () => {\n    return !!this.state.micDevices.find(d => HMD_MIC_REGEXES.find(r => d.label.match(r)));\n  };\n\n  micLabelForMediaStream = mediaStream => {\n    return (mediaStream && mediaStream.getAudioTracks().length > 0 && mediaStream.getAudioTracks()[0].label) || \"\";\n  };\n\n  selectedMicLabel = () => {\n    return this.micLabelForMediaStream(this.state.mediaStream);\n  };\n\n  micDeviceIdForMicLabel = label => {\n    return this.state.micDevices.filter(d => d.label === label).map(d => d.deviceId)[0];\n  };\n\n  selectedMicDeviceId = () => {\n    return this.micDeviceIdForMicLabel(this.selectedMicLabel());\n  };\n\n  shouldShowFullScreen = () => {\n    // Disable full screen on iOS, since Safari's fullscreen mode does not let you prevent native pinch-to-zoom gestures.\n    return (\n      (isMobile || AFRAME.utils.device.isMobileVR()) &&\n      !AFRAME.utils.device.isIOS() &&\n      !this.state.enterInVR &&\n      screenfull.enabled\n    );\n  };\n\n  onAudioReadyButton = () => {\n    if (!this.state.enterInVR) {\n      showFullScreenIfAvailable();\n    }\n\n    this.props.enterScene(this.state.mediaStream, this.state.enterInVR, this.state.muteOnEntry);\n\n    const mediaStream = this.state.mediaStream;\n\n    if (mediaStream) {\n      if (mediaStream.getAudioTracks().length > 0) {\n        console.log(`Using microphone: ${mediaStream.getAudioTracks()[0].label}`);\n      }\n\n      if (mediaStream.getVideoTracks().length > 0) {\n        console.log(\"Screen sharing enabled.\");\n      }\n    }\n\n    this.setState({ entered: true, showShareDialog: false });\n    clearHistoryState(this.props.history);\n  };\n\n  attemptLink = async () => {\n    this.pushHistoryState(\"overlay\", \"link\");\n    const { code, cancel, onFinished } = await this.props.linkChannel.generateCode();\n    this.setState({ linkCode: code, linkCodeCancel: cancel });\n    onFinished.then(() => {\n      this.setState({ log: false, linkCode: null, linkCodeCancel: null });\n      this.props.history.goBack();\n    });\n  };\n\n  showShareDialog = () => {\n    this.props.store.update({ activity: { hasOpenedShare: true } });\n    this.setState({ showShareDialog: true });\n  };\n\n  toggleShareDialog = async () => {\n    this.props.store.update({ activity: { hasOpenedShare: true } });\n    this.setState({ showShareDialog: !this.state.showShareDialog });\n  };\n\n  createObject = media => {\n    this.props.scene.emit(\"add_media\", media);\n  };\n\n  changeScene = url => {\n    this.props.hubChannel.updateScene(url);\n  };\n\n  setAvatarUrl = url => {\n    this.props.store.update({ profile: { ...this.props.store.state.profile, ...{ avatarId: url } } });\n  };\n\n  closeDialog = () => {\n    if (this.state.dialog) {\n      this.setState({ dialog: null });\n    } else {\n      this.props.history.goBack();\n    }\n\n    if (isIn2DInterstitial()) {\n      exit2DInterstitialAndEnterVR();\n    } else {\n      showFullScreenIfWasFullScreen();\n    }\n  };\n\n  showNonHistoriedDialog = (DialogClass, props = {}) => {\n    this.setState({\n      dialog: <DialogClass {...{ onClose: this.closeDialog, ...props }} />\n    });\n  };\n\n  toggleStreamerMode = enable => {\n    const playerRig = document.querySelector(\"#player-rig\");\n    playerRig.setAttribute(\"character-controller\", \"fly\", enable);\n\n    if (enable) {\n      this.props.hubChannel.beginStreaming();\n      this.setState({ isStreaming: true, showStreamingTip: true });\n    } else {\n      this.props.hubChannel.endStreaming();\n      this.setState({ isStreaming: false });\n    }\n  };\n\n  toggleFlyMode = enable => {\n    const playerRig = document.querySelector(\"#player-rig\");\n    playerRig.setAttribute(\"character-controller\", \"fly\", enable);  \n    this.setState({flyingEnabled: enable})\n  }\n  \n\n  renderDialog = (DialogClass, props = {}) => <DialogClass {...{ onClose: this.closeDialog, ...props }} />;\n\n  showSignInDialog = () => {\n    this.showNonHistoriedDialog(SignInDialog, {\n      message: messages[\"sign-in.prompt\"],\n      onSignIn: async email => {\n        const { authComplete } = await this.props.authChannel.startAuthentication(email, this.props.hubChannel);\n\n        this.showNonHistoriedDialog(SignInDialog, { authStarted: true });\n\n        await authComplete;\n\n        this.setState({ signedIn: true });\n        this.closeDialog();\n      }\n    });\n  };\n\n  signOut = async () => {\n    await this.props.authChannel.signOut(this.props.hubChannel);\n    this.setState({ signedIn: false });\n  };\n\n  showWebRTCScreenshareUnsupportedDialog = () => {\n    this.pushHistoryState(\"modal\", \"webrtc-screenshare\");\n  };\n\n  onMiniInviteClicked = () => {\n    const link = \"https://hub.link/\" + this.props.hubId;\n\n    this.setState({ miniInviteActivated: true });\n    setTimeout(() => {\n      this.setState({ miniInviteActivated: false });\n    }, 5000);\n\n    if (canShare()) {\n      navigator.share({ title: document.title, url: link });\n    } else {\n      copy(link);\n    }\n  };\n\n  sendMessage = msg => {\n    this.props.onSendMessage(msg);\n  };\n\n  occupantCount = () => {\n    return this.props.presences ? Object.entries(this.props.presences).length : 0;\n  };\n\n  onStoreChanged = () => {\n    const broadcastedRoomConfirmed = this.props.store.state.confirmedBroadcastedRooms.includes(this.props.hubId);\n    if (broadcastedRoomConfirmed !== this.state.broadcastTipDismissed) {\n      this.setState({ broadcastTipDismissed: broadcastedRoomConfirmed });\n    }\n  };\n\n  confirmBroadcastedRoom = () => {\n    this.props.store.update({ confirmedBroadcastedRooms: [this.props.hubId] });\n  };\n\n  discordBridges = () => {\n    if (!this.props.presences) {\n      return [];\n    } else {\n      return discordBridgesForPresences(this.props.presences);\n    }\n  };\n\n  hasEmbedPresence = () => {\n    if (!this.props.presences) {\n      return false;\n    } else {\n      for (const p of Object.values(this.props.presences)) {\n        for (const m of p.metas) {\n          if (m.context && m.context.embed) {\n            return true;\n          }\n        }\n      }\n    }\n\n    return false;\n  };\n\n  pushHistoryState = (k, v) => pushHistoryState(this.props.history, k, v);\n\n  renderInterstitialPrompt = () => {\n    return (\n      <IntlProvider locale={lang} messages={messages}>\n        <div className={styles.interstitial} onClick={() => this.props.onInterstitialPromptClicked()}>\n          <div>\n            <FormattedMessage id=\"interstitial.prompt\" />\n          </div>\n        </div>\n      </IntlProvider>\n    );\n  };\n\n  renderExitedPane = () => {\n    let subtitle = null;\n    if (this.props.roomUnavailableReason === \"closed\") {\n      // TODO i18n, due to links and markup\n      subtitle = (\n        <div>\n          Sorry, this room is no longer available.\n          <p />A room may be closed if we receive reports that it violates our{\" \"}\n          <WithHoverSound>\n            <a target=\"_blank\" rel=\"noreferrer noopener\" href=\"https://github.com/mozilla/hubs/blob/master/TERMS.md\">\n              Terms of Use\n            </a>\n          </WithHoverSound>\n          .<br />\n          If you have questions, contact us at{\" \"}\n          <WithHoverSound>\n            <a href=\"mailto:hubs@mozilla.com\">hubs@mozilla.com</a>\n          </WithHoverSound>\n          .<p />\n          If you&apos;d like to run your own server, hubs&apos;s source code is available on{\" \"}\n          <WithHoverSound>\n            <a href=\"https://github.com/mozilla/hubs\">GitHub</a>\n          </WithHoverSound>\n          .\n        </div>\n      );\n    } else if (this.props.platformUnsupportedReason === \"no_data_channels\") {\n      // TODO i18n, due to links and markup\n      subtitle = (\n        <div>\n          Your browser does not support{\" \"}\n          <WithHoverSound>\n            <a\n              href=\"https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/createDataChannel#Browser_compatibility\"\n              rel=\"noreferrer noopener\"\n            >\n              WebRTC Data Channels\n            </a>\n          </WithHoverSound>\n          , which is required to use Hubs.\n          <br />\n          If you&quot;d like to use Hubs with Oculus or SteamVR, you can{\" \"}\n          <WithHoverSound>\n            <a href=\"https://www.mozilla.org/firefox\" rel=\"noreferrer noopener\">\n              Download Firefox\n            </a>\n          </WithHoverSound>\n          .\n        </div>\n      );\n    } else {\n      const reason = this.props.roomUnavailableReason || this.props.platformUnsupportedReason;\n      const exitSubtitleId = `exit.subtitle.${reason || \"exited\"}`;\n      subtitle = (\n        <div>\n          <FormattedMessage id={exitSubtitleId} />\n          <p />\n          {![\"left\", \"disconnected\"].includes(this.props.roomUnavailableReason) && (\n            <div>\n              You can also{\" \"}\n              <WithHoverSound>\n                <a href=\"/\">create a new room</a>\n              </WithHoverSound>\n              .\n            </div>\n          )}\n        </div>\n      );\n    }\n\n    return (\n      <IntlProvider locale={lang} messages={messages}>\n        <div className=\"exited-panel\">\n          <img className=\"exited-panel__logo\" src=\"../assets/images/logo.svg\" />\n          <div className=\"exited-panel__subtitle\">{subtitle}</div>\n        </div>\n      </IntlProvider>\n    );\n  };\n\n  renderBotMode = () => {\n    return (\n      <div className=\"loading-panel\">\n        <img className=\"loading-panel__logo\" src=\"../assets/images/logo.svg\" />\n        <input type=\"file\" id=\"bot-audio-input\" accept=\"audio/*\" />\n        <input type=\"file\" id=\"bot-data-input\" accept=\"application/json\" />\n      </div>\n    );\n  };\n\n  renderEntryStartPanel = () => {\n    const { hasAcceptedProfile, hasChangedName } = this.props.store.state.activity;\n    const promptForNameAndAvatarBeforeEntry = this.props.hubIsBound ? !hasAcceptedProfile : !hasChangedName;\n\n    return (\n      <div className={entryStyles.entryPanel}>\n        <div className={entryStyles.name}>\n\n          <span>{this.props.hubName}</span>\n\n          {false && this.props.hubChannel.canOrWillIfCreator(\"update_hub\") ? (\n\n            <button\n              className={entryStyles.renameButton}\n              onClick={() =>\n                this.props.performConditionalSignIn(\n                  () => this.props.hubChannel.can(\"update_hub\"),\n                  () => this.pushHistoryState(\"modal\", \"room_settings\"),\n                  \"room-settings\"\n                )\n              }\n            >\n              {this.props.hubName}\n            </button>\n          ) : false ? (\n            <span>{this.props.hubName}</span>\n          ) : <span />}\n          <button onClick={() => this.setState({ watching: true })} className={entryStyles.collapseButton}>\n            <i>\n              <FontAwesomeIcon icon={faTimes} />\n            </i>\n          </button>\n\n          {false && <button\n            onClick={() => this.toggleFavorited()}\n            className={classNames({\n              [entryStyles.entryFavoriteButton]: true,\n              [entryStyles.favoriteButton]: true,\n              [entryStyles.favorited]: this.isFavorited()\n            })}\n          >\n            <i title=\"Favorite\">\n              <FontAwesomeIcon icon={faStar} />\n            </i>\n          </button>}\n        </div>\n\n        <div className={entryStyles.roomSubtitle}>\n          <FormattedMessage id=\"entry.lobby\" />\n        </div>\n\n        <div className={entryStyles.center}>\n\n          <LobbyChatBox\n            occupantCount={this.occupantCount()}\n            discordBridges={this.discordBridges()}\n            onSendMessage={this.sendMessage}\n          />\n        </div>\n\n        {!this.state.waitingOnAudio ? (\n          <div className={entryStyles.buttonContainer}>\n            {!isMobileVR && (\n              <a\n                onClick={e => {\n                  e.preventDefault();\n                  this.attemptLink();\n                }}\n                className={classNames([entryStyles.secondaryActionButton, entryStyles.wideButton])}\n              >\n                <FormattedMessage id=\"entry.device-medium\" />\n                <div className={entryStyles.buttonSubtitle}>\n                  <FormattedMessage id={isMobile ? \"entry.device-subtitle-mobile\" : \"entry.device-subtitle-desktop\"} />\n                </div>\n              </a>\n            )}\n            {promptForNameAndAvatarBeforeEntry || !this.props.forcedVREntryType ? (\n              <StateLink\n                stateKey=\"entry_step\"\n                stateValue={promptForNameAndAvatarBeforeEntry ? \"profile\" : \"device\"}\n                history={this.props.history}\n                className={classNames([entryStyles.actionButton, entryStyles.wideButton])}\n              >\n                <FormattedMessage id=\"entry.enter-room\" />\n              </StateLink>\n            ) : (\n              <a\n                onClick={e => {\n                  e.preventDefault();\n                  this.handleForceEntry();\n                }}\n                className={classNames([entryStyles.actionButton, entryStyles.wideButton])}\n              >\n                <FormattedMessage id=\"entry.enter-room\" />\n              </a>\n            )}\n          </div>\n        ) : (\n          <div>\n            <div className=\"loader-wrap loader-mid\">\n              <div className=\"loader\">\n                <div className=\"loader-center\" />\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  renderDevicePanel = () => {\n    return (\n      <div className={entryStyles.entryPanel}>\n        <div onClick={() => this.props.history.goBack()} className={entryStyles.back}>\n          <i>\n            <FontAwesomeIcon icon={faArrowLeft} />\n          </i>\n          <FormattedMessage id=\"entry.back\" />\n        </div>\n\n        <div className={entryStyles.title}>\n          <FormattedMessage id=\"entry.choose-device\" />\n        </div>\n\n        {!this.state.waitingOnAudio ? (\n          <div className={entryStyles.buttonContainer}>\n            {this.props.availableVREntryTypes.cardboard !== VR_DEVICE_AVAILABILITY.no && (\n              <div className={entryStyles.secondary} onClick={this.enterVR}>\n                <FormattedMessage id=\"entry.cardboard\" />\n              </div>\n            )}\n            {this.props.availableVREntryTypes.generic !== VR_DEVICE_AVAILABILITY.no && (\n              <GenericEntryButton secondary={true} onClick={this.enterVR} />\n            )}\n            {this.props.availableVREntryTypes.daydream === VR_DEVICE_AVAILABILITY.yes && (\n              <DaydreamEntryButton secondary={true} onClick={this.enterDaydream} subtitle={null} />\n            )}\n            {this.props.availableVREntryTypes.screen === VR_DEVICE_AVAILABILITY.yes && (\n              <TwoDEntryButton onClick={this.enter2D} />\n            )}\n          </div>\n        ) : (\n          <div className={entryStyles.audioLoader}>\n            <div className=\"loader-wrap loader-mid\">\n              <div className=\"loader\">\n                <div className=\"loader-center\" />\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  renderMicPanel = granted => {\n    return (\n      <div className=\"mic-grant-panel\">\n        <div onClick={() => this.props.history.goBack()} className={entryStyles.back}>\n          <i>\n            <FontAwesomeIcon icon={faArrowLeft} />\n          </i>\n          <FormattedMessage id=\"entry.back\" />\n        </div>\n\n        <div className=\"mic-grant-panel__grant-container\">\n          <div className=\"mic-grant-panel__title\">\n            <FormattedMessage id={granted ? \"audio.granted-title\" : \"audio.grant-title\"} />\n          </div>\n          <div className=\"mic-grant-panel__subtitle\">\n            <FormattedMessage id={granted ? \"audio.granted-subtitle\" : \"audio.grant-subtitle\"} />\n          </div>\n          <div className=\"mic-grant-panel__button-container\">\n            {granted ? (\n              <WithHoverSound>\n                <button className=\"mic-grant-panel__button\" onClick={this.onMicGrantButton}>\n                  <img src=\"../assets/images/mic_granted.png\" srcSet=\"../assets/images/mic_granted@2x.png 2x\" />\n                </button>\n              </WithHoverSound>\n            ) : (\n              <WithHoverSound>\n                <button className=\"mic-grant-panel__button\" onClick={this.onMicGrantButton}>\n                  <img src=\"../assets/images/mic_denied.png\" srcSet=\"../assets/images/mic_denied@2x.png 2x\" />\n                </button>\n              </WithHoverSound>\n            )}\n          </div>\n          <div className=\"mic-grant-panel__next-container\">\n            <WithHoverSound>\n              <button className={classNames(\"mic-grant-panel__next\")} onClick={this.onMicGrantButton}>\n                <FormattedMessage id=\"audio.granted-next\" />\n              </button>\n            </WithHoverSound>\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  renderAudioSetupPanel = () => {\n    const subtitleId = isMobilePhoneOrVR ? \"audio.subtitle-mobile\" : \"audio.subtitle-desktop\";\n    return (\n      <div className=\"audio-setup-panel\">\n        <div onClick={() => this.props.history.goBack()} className={entryStyles.back}>\n          <i>\n            <FontAwesomeIcon icon={faArrowLeft} />\n          </i>\n          <FormattedMessage id=\"entry.back\" />\n        </div>\n\n        <div>\n          <div className=\"audio-setup-panel__title\">\n            <FormattedMessage id=\"audio.title\" />\n          </div>\n          <div className=\"audio-setup-panel__subtitle\">\n            {(isMobilePhoneOrVR || this.state.enterInVR) && <FormattedMessage id={subtitleId} />}\n          </div>\n          <div className=\"audio-setup-panel__levels\">\n            <MicLevelWidget\n              scene={this.props.scene}\n              hasAudioTrack={!!this.state.audioTrack}\n              muteOnEntry={this.state.muteOnEntry}\n            />\n            <OutputLevelWidget />\n          </div>\n          {this.state.audioTrack && this.state.micDevices.length > 1 ? (\n            <div className=\"audio-setup-panel__device-chooser\">\n              <WithHoverSound>\n                <select\n                  className=\"audio-setup-panel__device-chooser__dropdown\"\n                  value={this.selectedMicDeviceId()}\n                  onChange={this.micDeviceChanged}\n                >\n                  {this.state.micDevices.map(d => (\n                    <option key={d.deviceId} value={d.deviceId}>\n                      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n                      {d.label}\n                    </option>\n                  ))}\n                </select>\n              </WithHoverSound>\n              <img\n                className=\"audio-setup-panel__device-chooser__mic-icon\"\n                src=\"../assets/images/mic_small.png\"\n                srcSet=\"../assets/images/mic_small@2x.png 2x\"\n              />\n              <img\n                className=\"audio-setup-panel__device-chooser__dropdown-arrow\"\n                src=\"../assets/images/dropdown_arrow.png\"\n                srcSet=\"../assets/images/dropdown_arrow@2x.png 2x\"\n              />\n            </div>\n          ) : (\n            <div />\n          )}\n          {this.shouldShowHmdMicWarning() && (\n            <div className=\"audio-setup-panel__hmd-mic-warning\">\n              <img\n                src=\"../assets/images/warning_icon.png\"\n                srcSet=\"../assets/images/warning_icon@2x.png 2x\"\n                className=\"audio-setup-panel__hmd-mic-warning__icon\"\n              />\n              <span className=\"audio-setup-panel__hmd-mic-warning__label\">\n                <FormattedMessage id=\"audio.hmd-mic-warning\" />\n              </span>\n            </div>\n          )}\n        </div>\n        <div className=\"audio-setup-panel__mute-container\">\n          <input\n            id=\"mute-on-entry\"\n            type=\"checkbox\"\n            onChange={() => this.setState({ muteOnEntry: !this.state.muteOnEntry })}\n            checked={this.state.muteOnEntry}\n          />\n          <label htmlFor=\"mute-on-entry\">\n            <FormattedMessage id=\"entry.mute-on-entry\" />\n          </label>\n        </div>\n        <div className=\"audio-setup-panel__enter-button-container\">\n          <WithHoverSound>\n            <button className=\"audio-setup-panel__enter-button\" onClick={this.onAudioReadyButton}>\n              <FormattedMessage id=\"audio.enter-now\" />\n            </button>\n          </WithHoverSound>\n        </div>\n      </div>\n    );\n  };\n\n  isInModalOrOverlay = () => {\n    if (\n      this.state.entered &&\n      (IN_ROOM_MODAL_ROUTER_PATHS.find(x => sluglessPath(this.props.history.location).startsWith(x)) ||\n        IN_ROOM_MODAL_QUERY_VARS.find(x => new URLSearchParams(this.props.history.location.search).get(x)))\n    ) {\n      return true;\n    }\n\n    if (\n      !this.state.entered &&\n      (LOBBY_MODAL_ROUTER_PATHS.find(x => sluglessPath(this.props.history.location).startsWith(x)) ||\n        LOBBY_MODAL_QUERY_VARS.find(\n          (x, i) => new URLSearchParams(this.props.history.location.search).get(x) === LOBBY_MODAL_QUERY_VALUES[i]\n        ))\n    ) {\n      return true;\n    }\n\n    return !!(\n      (this.props.history &&\n        this.props.history.location.state &&\n        (this.props.history.location.state.modal || this.props.history.location.state.overlay)) ||\n      this.state.dialog\n    );\n  };\n\n  render() {\n    if (this.props.hide || this.state.hide) return <div />;\n\n    const isExited = this.state.exited || this.props.roomUnavailableReason || this.props.platformUnsupportedReason;\n    const preload = this.props.showPreload;\n\n    const isLoading =\n      !preload &&\n      (!this.state.hideLoader || !this.state.didConnectToNetworkedScene) &&\n      !(this.props.showSafariMicDialog || this.props.showSafariDialog || this.props.showWebAssemblyDialog);\n\n    const rootStyles = {\n      [styles.ui]: true,\n      \"ui-root\": true,\n      \"in-modal-or-overlay\": this.isInModalOrOverlay()\n    };\n    const hasPush = navigator.serviceWorker && \"PushManager\" in window;\n\n    if (this.props.showOAuthDialog && !this.props.showInterstitialPrompt)\n      return (\n        <IntlProvider locale={lang} messages={messages}>\n          <div className={classNames(rootStyles)}>\n            <OAuthDialog onClose={this.props.onCloseOAuthDialog} oauthInfo={this.props.oauthInfo}  privacyLink={this.state.airtableAssets.Privacy_Link} termsLink={this.state.airtableAssets.Terms_Link} />\n          </div>\n        </IntlProvider>\n      );\n    if (isExited) return this.renderExitedPane();\n    if (isLoading) {\n      return (\n        <Loader loadingIcon={this.state.airtableAssets.Icon} scene={this.props.scene} finished={this.state.noMoreLoadingUpdates} onLoaded={this.onLoadingFinished} />\n      );\n    }\n    if (this.props.showInterstitialPrompt) return this.renderInterstitialPrompt();\n    if (this.props.isBotMode) return this.renderBotMode();\n\n    const embed = this.props.embed;\n    const entered = this.state.entered;\n    const watching = this.state.watching;\n    const enteredOrWatching = entered || watching;\n    const enteredOrWatchingOrPreload = entered || watching || preload;\n    const baseUrl = `${location.protocol}//${location.host}${location.pathname}`;\n    const inEntryFlow = !!(\n      this.props.history &&\n      this.props.history.location.state &&\n      this.props.history.location.state.entry_step\n    );\n\n    const entryDialog =\n      this.props.availableVREntryTypes &&\n      !preload &&\n      (this.isWaitingForAutoExit() ? (\n        <AutoExitWarning\n          secondsRemaining={this.state.secondsRemainingBeforeAutoExit}\n          onCancel={this.endAutoExitTimer}\n        />\n      ) : (\n        <div className={entryStyles.entryDialog}>\n          <StateRoute stateKey=\"entry_step\" stateValue=\"device\" history={this.props.history}>\n            {this.renderDevicePanel()}\n          </StateRoute>\n          <StateRoute stateKey=\"entry_step\" stateValue=\"mic_grant\" history={this.props.history}>\n            {this.renderMicPanel(false)}\n          </StateRoute>\n          <StateRoute stateKey=\"entry_step\" stateValue=\"mic_granted\" history={this.props.history}>\n            {this.renderMicPanel(true)}\n          </StateRoute>\n          <StateRoute stateKey=\"entry_step\" stateValue=\"audio\" history={this.props.history}>\n            {this.renderAudioSetupPanel()}\n          </StateRoute>\n          <StateRoute stateKey=\"entry_step\" stateValue=\"\" history={this.props.history}>\n            {this.renderEntryStartPanel()}\n          </StateRoute>\n        </div>\n      ));\n\n    const dialogBoxContentsClassNames = classNames({\n      [styles.uiInteractive]: !this.isInModalOrOverlay(),\n      [styles.uiDialogBoxContents]: true,\n      [styles.backgrounded]: this.isInModalOrOverlay()\n    });\n\n    const showVREntryButton = entered && isMobileVR;\n\n    const presenceLogEntries = this.props.presenceLogEntries || [];\n\n    const mediaSource = this.props.mediaSearchStore.getUrlMediaSource(this.props.history.location);\n\n    // Allow scene picker pre-entry, otherwise wait until entry\n    const showMediaBrowser =\n      mediaSource && ([\"scenes\", \"avatars\", \"favorites\"].includes(mediaSource) || this.state.entered);\n    const hasTopTip = (this.props.activeTips && this.props.activeTips.top) || this.state.showVideoShareFailed;\n\n    const clientInfoClientId = getClientInfoClientId(this.props.history.location);\n    const showClientInfo = !!clientInfoClientId;\n\n    const discordBridges = this.discordBridges();\n    const discordSnippet = discordBridges.map(ch => \"#\" + ch).join(\", \");\n    const hasEmbedPresence = this.hasEmbedPresence();\n    const hasDiscordBridges = discordBridges.length > 0;\n    const showBroadcastTip =\n      (hasDiscordBridges || (hasEmbedPresence && !this.props.embed)) && !this.state.broadcastTipDismissed;\n\n    const showInviteTip =\n      !showVREntryButton &&\n      !hasTopTip &&\n      !entered &&\n      !embed &&\n      !preload &&\n      !watching &&\n      !hasTopTip &&\n      !inEntryFlow &&\n      !this.props.store.state.activity.hasOpenedShare &&\n      this.occupantCount() <= 1;\n\n    const showChooseSceneButton =\n    false && \n      !showVREntryButton &&\n      !entered &&\n      !embed &&\n      !preload &&\n      !watching &&\n      !showInviteTip &&\n      !this.state.showShareDialog &&\n      this.props.hubChannel &&\n      this.props.hubChannel.canOrWillIfCreator(\"update_hub\");\n\n    const displayNameOverride = this.props.hubIsBound\n      ? getPresenceProfileForSession(this.props.presences, this.props.sessionId).displayName\n      : null;\n\n    const streaming = this.state.isStreaming;\n    const streamingTip = streaming &&\n      this.state.showStreamingTip && (\n        <div className={classNames([styles.streamingTip])}>\n          <div className={classNames([styles.streamingTipAttachPoint])} />\n          <button\n            title=\"Dismiss\"\n            className={styles.streamingTipClose}\n            onClick={() => this.setState({ showStreamingTip: false })}\n          >\n            <FontAwesomeIcon icon={faTimes} />\n          </button>\n\n          <div className={styles.streamingTipMessage}>\n            <FormattedMessage id=\"tips.streaming\" />\n          </div>\n        </div>\n      );\n\n    const streamer = getCurrentStreamer();\n    const streamerName = streamer && streamer.displayName;\n\n    return (\n      <ReactAudioContext.Provider value={this.state.audioContext}>\n        <IntlProvider locale={lang} messages={messages}>\n          <div className={classNames(rootStyles)}>\n            <HelmetComponent page=\"Live\" assets={this.state.airtableAssets} />\n            {this.state.dialog}\n            {preload && (\n              <PreloadOverlay\n                hubName={this.props.hubName}\n                hubScene={this.props.hubScene}\n                baseUrl={baseUrl}\n                onLoadClicked={this.props.onPreloadLoadClicked}\n                logo={this.state.DarkLogo}\n              />\n            )}\n            <StateRoute\n              stateKey=\"overlay\"\n              stateValue=\"profile\"\n              history={this.props.history}\n              render={props => (\n                <ProfileEntryPanel\n                  {...props}\n                  displayNameOverride={displayNameOverride}\n                  finished={() => this.pushHistoryState()}\n                  onClose={() => this.pushHistoryState()}\n                  store={this.props.store}\n                  mediaSearchStore={this.props.mediaSearchStore}\n                  avatarId={props.location.state.detail && props.location.state.detail.avatarId}\n                  logo={this.state.airtableAssets.DarkLogo}\n                  privacyLink={this.state.airtableAssets.Privacy_Link}\n                  termsLink={this.state.airtableAssets.Terms_Link}\n                />\n              )}\n            />\n            <StateRoute\n              stateKey=\"overlay\"\n              stateValue=\"avatar-editor\"\n              history={this.props.history}\n              render={props => (\n                <AvatarEditor\n                  className={styles.avatarEditor}\n                  signedIn={this.state.signedIn}\n                  onSignIn={this.showSignInDialog}\n                  onSave={() => {\n                    if (props.location.state.detail && props.location.state.detail.returnToProfile) {\n                      this.props.history.goBack();\n                    } else {\n                      this.props.history.goBack();\n                      // We are returning to the media browser. Trigger an update so that the filter switches to\n                      // my-avatars, now that we've saved an avatar.\n                      this.props.mediaSearchStore.sourceNavigateWithNoNav(\"avatars\");\n                    }\n                    this.props.onAvatarSaved();\n                  }}\n                  onClose={() => this.props.history.goBack()}\n                  store={this.props.store}\n                  debug={avatarEditorDebug}\n                  avatarId={props.location.state.detail && props.location.state.detail.avatarId}\n                  hideDelete={props.location.state.detail && props.location.state.detail.hideDelete}\n                />\n              )}\n            />\n            {showMediaBrowser && (\n              <MediaBrowser\n                history={this.props.history}\n                mediaSearchStore={this.props.mediaSearchStore}\n                hubChannel={this.props.hubChannel}\n                onMediaSearchResultEntrySelected={entry => {\n                  if (entry.type === \"hub\") {\n                    this.showNonHistoriedDialog(LeaveRoomDialog, {\n                      destinationUrl: entry.url,\n                      messageType: \"join-room\"\n                    });\n                  } else {\n                    this.props.onMediaSearchResultEntrySelected(entry);\n                  }\n                }}\n                performConditionalSignIn={this.props.performConditionalSignIn}\n              />\n            )}\n            <StateRoute\n              stateKey=\"entry_step\"\n              stateValue=\"profile\"\n              history={this.props.history}\n              render={props => (\n                <ProfileEntryPanel\n                  {...props}\n                  displayNameOverride={displayNameOverride}\n                  finished={() => {\n                    if (this.props.forcedVREntryType) {\n                      this.pushHistoryState();\n                      this.handleForceEntry();\n                    } else {\n                      this.pushHistoryState(\"entry_step\", \"device\");\n                    }\n                  }}\n                  onClose={() => this.pushHistoryState()}\n                  store={this.props.store}\n                  mediaSearchStore={this.props.mediaSearchStore}\n                  avatarId={props.location.state.detail && props.location.state.detail.avatarId}\n                  logo={this.state.airtableAssets.DarkLogo}\n                  privacyLink={this.state.airtableAssets.Privacy_Link}\n                  termsLink={this.state.airtableAssets.Terms_Link}\n                />\n              )}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"room_settings\"\n              history={this.props.history}\n              render={() =>\n                this.renderDialog(RoomSettingsDialog, {\n                  initialSettings: { name: this.props.hubName, member_permissions: this.props.hubMemberPermissions },\n                  onChange: settings => this.props.hubChannel.updateHub(settings)\n                })\n              }\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"close_room\"\n              history={this.props.history}\n              render={() => this.renderDialog(CloseRoomDialog, { onConfirm: () => this.props.hubChannel.closeHub() })}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"help\"\n              history={this.props.history}\n              render={() => this.renderDialog(<HelpDialog privacyLink={this.state.airtableAssets.Privacy_Link} termsLink={this.state.airtableAssets.Terms_Link} />)}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"support\"\n              history={this.props.history}\n              render={() => this.renderDialog(InviteTeamDialog, { hubChannel: this.props.hubChannel })}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"create\"\n              history={this.props.history}\n              render={() => this.renderDialog(CreateObjectDialog, { onCreate: this.createObject })}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"change_scene\"\n              history={this.props.history}\n              render={() => this.renderDialog(ChangeSceneDialog, { onChange: this.changeScene })}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"avatar_url\"\n              history={this.props.history}\n              render={() => this.renderDialog(AvatarUrlDialog, { onChange: this.setAvatarUrl })}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"webvr\"\n              history={this.props.history}\n              render={() => this.renderDialog(WebVRRecommendDialog)}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"webrtc-screenshare\"\n              history={this.props.history}\n              render={() => this.renderDialog(WebRTCScreenshareUnsupportedDialog)}\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"room_info\"\n              history={this.props.history}\n              render={() =>\n                this.renderDialog(RoomInfoDialog, { scene: this.props.hubScene, hubName: this.props.hubName })\n              }\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"feedback\"\n              history={this.props.history}\n              render={() =>\n                this.renderDialog(FeedbackDialog, {\n                  history: this.props.history,\n                  onClose: () => this.pushHistoryState(\"modal\", null)\n                })\n              }\n            />\n            <StateRoute\n              stateKey=\"modal\"\n              stateValue=\"tweet\"\n              history={this.props.history}\n              render={() => this.renderDialog(TweetDialog, { history: this.props.history, onClose: this.closeDialog })}\n            />\n            {showClientInfo && (\n              <ClientInfoDialog\n                clientId={clientInfoClientId}\n                onClose={this.closeDialog}\n                history={this.props.history}\n                presences={this.props.presences}\n                hubChannel={this.props.hubChannel}\n                showNonHistoriedDialog={this.showNonHistoriedDialog}\n                performConditionalSignIn={this.props.performConditionalSignIn}\n              />\n            )}\n            {(!enteredOrWatching || this.isWaitingForAutoExit()) && (\n              <div className={styles.uiDialog}>\n                <PresenceLog\n                  entries={presenceLogEntries}\n                  presences={this.props.presences}\n                  hubId={this.props.hubId}\n                  history={this.props.history}\n                />\n                <div className={dialogBoxContentsClassNames}>{entryDialog}</div>\n              </div>\n            )}\n            {enteredOrWatchingOrPreload && (\n              <PresenceLog\n                inRoom={true}\n                presences={this.props.presences}\n                entries={presenceLogEntries}\n                hubId={this.props.hubId}\n                history={this.props.history}\n              />\n            )}\n            {entered &&\n              this.props.activeTips &&\n              this.props.activeTips.bottom &&\n              (!presenceLogEntries || presenceLogEntries.length === 0) &&\n              !showBroadcastTip && (\n                <Tip tip={this.props.activeTips.bottom} tipRegion=\"bottom\" pushHistoryState={this.pushHistoryState} />\n              )}\n            {enteredOrWatchingOrPreload &&\n              showBroadcastTip && (\n                <Tip\n                  tip={hasDiscordBridges ? \"discord\" : \"embed\"}\n                  broadcastTarget={discordSnippet}\n                  onClose={() => this.confirmBroadcastedRoom()}\n                />\n              )}\n            {enteredOrWatchingOrPreload && (\n              <InWorldChatBox\n                discordBridges={discordBridges}\n                onSendMessage={this.sendMessage}\n                onObjectCreated={this.createObject}\n                enableSpawning={entered}\n                history={this.props.history}\n              />\n            )}\n            {this.state.frozen && (\n              <button className={styles.leaveButton} onClick={() => this.exit(\"left\")}>\n                <FormattedMessage id=\"entry.leave-room\" />\n              </button>\n            )}\n            {!this.state.frozen &&\n              !watching &&\n              !preload && (\n                <div\n                  className={classNames({\n                    [inviteStyles.inviteContainer]: true,\n                    [inviteStyles.inviteContainerBelowHud]: entered,\n                    [inviteStyles.inviteContainerInverted]: this.state.showShareDialog\n                  })}\n                >\n                  {false && !embed &&\n                    !showVREntryButton &&\n                    !hasTopTip &&\n                    !streaming && (\n                      <WithHoverSound>\n                        <button\n                          className={classNames({\n                            [inviteStyles.inviteButton]: true,\n                            [inviteStyles.hideSmallScreens]: this.occupantCount() > 1 && entered\n                          })}\n                          onClick={() => this.toggleShareDialog()}\n                        >\n                          <FormattedMessage id=\"entry.share-button\" />\n                        </button>\n                      </WithHoverSound>\n                    )}\n                  {showChooseSceneButton && (\n                    <button\n                      className={classNames([styles.chooseSceneButton])}\n                      onClick={() => {\n                        this.props.performConditionalSignIn(\n                          () => this.props.hubChannel.can(\"update_hub\"),\n                          () => {\n                            showFullScreenIfAvailable();\n                            this.props.mediaSearchStore.sourceNavigateWithNoNav(\"scenes\");\n                          },\n                          \"change-scene\"\n                        );\n                      }}\n                    >\n                      <FormattedMessage id=\"entry.change-scene\" />\n                    </button>\n                  )}\n\n                  {showInviteTip && (\n                    <div className={styles.inviteTip}>\n                      <div className={styles.inviteTipAttachPoint} />\n                      <FormattedMessage id={`entry.${isMobile ? \"mobile\" : \"desktop\"}.invite-tip`} />\n                    </div>\n                  )}\n                  {!embed &&\n                    !showVREntryButton &&\n                    this.occupantCount() > 1 &&\n                    !hasTopTip &&\n                    entered &&\n                    !streaming && (\n                      <WithHoverSound>\n                        <button onClick={this.onMiniInviteClicked} className={inviteStyles.inviteMiniButton}>\n                          <span>\n                            {this.state.miniInviteActivated\n                              ? navigator.share\n                                ? \"sharing...\"\n                                : \"copied!\"\n                              : \"hub.link/\" + this.props.hubId}\n                          </span>\n                        </button>\n                      </WithHoverSound>\n                    )}\n                  {showVREntryButton && (\n                    <WithHoverSound>\n                      <button className={inviteStyles.enterButton} onClick={() => exit2DInterstitialAndEnterVR(true)}>\n                        <FormattedMessage id=\"entry.enter-in-vr\" />\n                      </button>\n                    </WithHoverSound>\n                  )}\n                  {embed && (\n                    <a href={baseUrl} className={inviteStyles.enterButton} target=\"_blank\" rel=\"noopener noreferrer\">\n                      <FormattedMessage id=\"entry.open-in-window\" />\n                    </a>\n                  )}\n                  {this.state.showShareDialog && (\n                    <InviteDialog\n                      allowShare={!isMobileVR}\n                      entryCode={this.props.hubEntryCode}\n                      embedUrl={\n                        this.props.embedToken && !isMobilePhoneOrVR\n                          ? `${baseUrl}?embed_token=${this.props.embedToken}`\n                          : null\n                      }\n                      hasPush={hasPush}\n                      isSubscribed={\n                        this.state.isSubscribed === undefined ? this.props.initialIsSubscribed : this.state.isSubscribed\n                      }\n                      onSubscribeChanged={() => this.onSubscribeChanged()}\n                      hubId={this.props.hubId}\n                      onClose={() => this.setState({ showShareDialog: false })}\n                    />\n                  )}\n                </div>\n              )}\n            <StateRoute\n              stateKey=\"overlay\"\n              stateValue=\"invite\"\n              history={this.props.history}\n              render={() => (\n                <InviteDialog\n                  allowShare={!!navigator.share}\n                  entryCode={this.props.hubEntryCode}\n                  hubId={this.props.hubId}\n                  isModal={true}\n                  onClose={() => {\n                    this.props.history.goBack();\n                    exit2DInterstitialAndEnterVR();\n                  }}\n                />\n              )}\n            />\n            <StateRoute\n              stateKey=\"overlay\"\n              stateValue=\"link\"\n              history={this.props.history}\n              render={() => (\n                <LinkDialog\n                  linkCode={this.state.linkCode}\n                  onClose={() => {\n                    this.state.linkCodeCancel();\n                    this.setState({ linkCode: null, linkCodeCancel: null });\n                    this.props.history.goBack();\n                  }}\n                />\n              )}\n            />\n            {streaming && (\n              <button\n                title=\"Exit Camera Mode\"\n                onClick={() => this.toggleStreamerMode(false)}\n                className={classNames([styles.cornerButton, styles.cameraModeExitButton])}\n              >\n                <FontAwesomeIcon icon={faTimes} />\n              </button>\n            )}\n            {streamingTip}\n\n            <PresenceList\n              history={this.props.history}\n              presences={this.props.presences}\n              sessionId={this.props.sessionId}\n              signedIn={this.state.signedIn}\n              email={this.props.store.state.credentials.email}\n              onSignIn={this.showSignInDialog}\n              onSignOut={this.signOut}\n            />\n\n            {!streaming &&\n              !preload && (\n                <SettingsMenu\n                  history={this.props.history}\n                  mediaSearchStore={this.props.mediaSearchStore}\n                  isStreaming={streaming}\n                  toggleStreamerMode={this.toggleStreamerMode}\n                  hubChannel={this.props.hubChannel}\n                  hubScene={this.props.hubScene}\n                  scene={this.props.scene}\n                  performConditionalSignIn={this.props.performConditionalSignIn}\n                  showNonHistoriedDialog={this.showNonHistoriedDialog}\n                  pushHistoryState={this.pushHistoryState}\n                  toggleFlyMode={this.toggleFlyMode}\n                  privacyLink={this.state.airtableAssets.Privacy_Link} \n                  termsLink={this.state.airtableAssets.Terms_Link}\n                />\n              )}\n            {!entered && !streaming && !isMobile && streamerName && <SpectatingLabel name={streamerName} />}\n            {enteredOrWatching && (\n              <div className={styles.topHud}>\n                <TwoDHUD.TopHUD\n                  scene={this.props.scene}\n                  history={this.props.history}\n                  mediaSearchStore={this.props.mediaSearchStore}\n                  muted={this.state.muted}\n                  frozen={this.state.frozen}\n                  watching={this.state.watching}\n                  onWatchEnded={() => this.setState({ watching: false })}\n                  videoShareMediaSource={this.state.videoShareMediaSource}\n                  showVideoShareFailed={this.state.showVideoShareFailed}\n                  hideVideoShareFailedTip={() => this.setState({ showVideoShareFailed: false })}\n                  activeTip={this.props.activeTips && this.props.activeTips.top}\n                  isCursorHoldingPen={this.props.isCursorHoldingPen}\n                  hasActiveCamera={this.props.hasActiveCamera}\n                  onToggleMute={this.toggleMute}\n                  onToggleFlying={this.toggleFlyMode}\n                  flyingEnabled={this.state.flyingEnabled}\n                  onToggleFreeze={this.toggleFreeze}\n                  onSpawnPen={this.spawnPen}\n                  onSpawnCamera={() => this.props.scene.emit(\"action_toggle_camera\")}\n                  onShareVideo={this.shareVideo}\n                  onEndShareVideo={this.endShareVideo}\n                  onShareVideoNotCapable={() => this.showWebRTCScreenshareUnsupportedDialog()}\n                  isStreaming={streaming}\n                  showStreamingTip={this.state.showStreamingTip}\n                  hideStreamingTip={() => {\n                    this.setState({ showStreamingTip: false });\n                  }}\n                />\n                {false && !watching && !streaming ? (\n                  <div className={styles.nagCornerButton}>\n                    <button onClick={() => this.pushHistoryState(\"modal\", \"feedback\")}>\n                      <FormattedMessage id=\"feedback.prompt\" />\n                    </button>\n                  </div>\n                ) : (\n                  <div className={styles.nagCornerButton}>\n                    <button onClick={() => this.setState({ hide: true })}>\n                      <FormattedMessage id=\"hide-ui.prompt\" />\n                    </button>\n                  </div>\n                )}\n\n                {false && !streaming && (\n                  <button\n                    onClick={() => this.toggleFavorited()}\n                    className={classNames({\n                      [entryStyles.favorited]: this.isFavorited(),\n                      [styles.inRoomFavoriteButton]: true\n                    })}\n                  >\n                    <i title=\"Favorite\">\n                      <FontAwesomeIcon icon={faStar} />\n                    </i>\n                  </button>\n                )}\n              </div>\n            )}\n          </div>\n        </IntlProvider>\n      </ReactAudioContext.Provider>\n    );\n  }\n}\n\nexport default UIRoot;\n","import jwtDecode from \"jwt-decode\";\nimport { EventTarget } from \"event-target-shim\";\nimport { Presence } from \"phoenix\";\nimport { migrateChannelToSocket, discordBridgesForPresences } from \"./phoenix-utils\";\n\nconst MS_PER_DAY = 1000 * 60 * 60 * 24;\nconst MS_PER_MONTH = 1000 * 60 * 60 * 24 * 30;\n\nfunction isSameMonth(da, db) {\n  return da.getFullYear() == db.getFullYear() && da.getMonth() == db.getMonth();\n}\n\nfunction isSameDay(da, db) {\n  return isSameMonth(da, db) && da.getDate() == db.getDate();\n}\n\n// Permissions that will be assumed if the user becomes the creator.\nconst HUB_CREATOR_PERMISSIONS = [\"update_hub\", \"update_roles\", \"close_hub\", \"mute_users\", \"kick_users\"];\nconst VALID_PERMISSIONS =\n  HUB_CREATOR_PERMISSIONS + [\"tweet\", \"spawn_camera\", \"spawn_drawing\", \"spawn_and_move_media\", \"pin_objects\"];\n\nexport default class HubChannel extends EventTarget {\n  constructor(store, hubId) {\n    super();\n    this.store = store;\n    this.hubId = hubId;\n    this._signedIn = !!this.store.state.credentials.token;\n    this._permissions = {};\n    this._blockedSessionIds = new Set();\n  }\n\n  get signedIn() {\n    return this._signedIn;\n  }\n\n  // Returns true if this current session has the given permission.\n  can(permission) {\n    if (!VALID_PERMISSIONS.includes(permission)) throw new Error(`Invalid permission name: ${permission}`);\n    return this._permissions && this._permissions[permission];\n  }\n\n  // Returns true if the current session has the given permission, *or* will get the permission\n  // if they sign in and become the creator.\n  canOrWillIfCreator(permission) {\n    if (this._getCreatorAssignmentToken() && HUB_CREATOR_PERMISSIONS.includes(permission)) return true;\n    return this.can(permission);\n  }\n\n  // Migrates this hub channel to a new phoenix channel and presence\n  async migrateToSocket(socket, params) {\n    let presenceBindings;\n\n    // Unbind presence, and then set up bindings after reconnect\n    if (this.presence) {\n      presenceBindings = {\n        onJoin: this.presence.caller.onJoin,\n        onLeave: this.presence.caller.onLeave,\n        onSync: this.presence.caller.onSync\n      };\n\n      this.presence.onJoin(function() {});\n      this.presence.onLeave(function() {});\n      this.presence.onSync(function() {});\n    }\n\n    this.channel = await migrateChannelToSocket(this.channel, socket, params);\n    this.presence = new Presence(this.channel);\n\n    if (presenceBindings) {\n      this.presence.onJoin(presenceBindings.onJoin);\n      this.presence.onLeave(presenceBindings.onLeave);\n      this.presence.onSync(presenceBindings.onSync);\n    }\n  }\n\n  setPhoenixChannel = channel => {\n    this.channel = channel;\n    this.presence = new Presence(channel);\n  };\n\n  setPermissionsFromToken = token => {\n    // Note: token is not verified.\n    this._permissions = jwtDecode(token);\n    this.dispatchEvent(new CustomEvent(\"permissions_updated\"));\n\n    // Refresh the token 1 minute before it expires.\n    const nextRefresh = new Date(this._permissions.exp * 1000 - 60 * 1000) - new Date();\n    setTimeout(async () => {\n      const result = await this.fetchPermissions();\n      this.dispatchEvent(new CustomEvent(\"permissions-refreshed\", { detail: result }));\n    }, nextRefresh);\n  };\n\n  sendEntryEvent = async () => {\n    if (!this.channel) {\n      console.warn(\"No phoenix channel initialized before room entry.\");\n      return;\n    }\n\n    let entryDisplayType = \"Screen\";\n\n    if (navigator.getVRDisplays) {\n      const vrDisplay = (await navigator.getVRDisplays()).find(d => d.isPresenting);\n\n      if (vrDisplay) {\n        entryDisplayType = vrDisplay.displayName;\n      }\n    }\n\n    // This is fairly hacky, but gets the # of initial occupants\n    let initialOccupantCount = 0;\n\n    if (NAF.connection.adapter && NAF.connection.adapter.publisher) {\n      initialOccupantCount = NAF.connection.adapter.publisher.initialOccupants.length;\n    }\n\n    const entryTimingFlags = this.getEntryTimingFlags();\n\n    const entryEvent = {\n      ...entryTimingFlags,\n      initialOccupantCount,\n      entryDisplayType,\n      userAgent: navigator.userAgent\n    };\n\n    this.channel.push(\"events:entered\", entryEvent);\n  };\n\n  beginStreaming() {\n    this.channel.push(\"events:begin_streaming\", {});\n  }\n\n  endStreaming() {\n    this.channel.push(\"events:end_streaming\", {});\n  }\n\n  beginRecording() {\n    this.channel.push(\"events:begin_recording\", {});\n  }\n\n  endRecording() {\n    this.channel.push(\"events:end_recording\", {});\n  }\n\n  getEntryTimingFlags = () => {\n    const entryTimingFlags = { isNewDaily: true, isNewMonthly: true, isNewDayWindow: true, isNewMonthWindow: true };\n    const storedLastEnteredAt = this.store.state.activity.lastEnteredAt;\n\n    if (!storedLastEnteredAt) {\n      return entryTimingFlags;\n    }\n\n    const now = new Date();\n    const lastEntered = new Date(storedLastEnteredAt);\n    const msSinceLastEntered = now - lastEntered;\n\n    // note that new daily and new monthly is based on client local time\n    entryTimingFlags.isNewDaily = !isSameDay(now, lastEntered);\n    entryTimingFlags.isNewMonthly = !isSameMonth(now, lastEntered);\n    entryTimingFlags.isNewDayWindow = msSinceLastEntered > MS_PER_DAY;\n    entryTimingFlags.isNewMonthWindow = msSinceLastEntered > MS_PER_MONTH;\n\n    return entryTimingFlags;\n  };\n\n  sendObjectSpawnedEvent = objectType => {\n    if (!this.channel) {\n      console.warn(\"No phoenix channel initialized before object spawn.\");\n      return;\n    }\n\n    const spawnEvent = {\n      object_type: objectType\n    };\n\n    this.channel.push(\"events:object_spawned\", spawnEvent);\n  };\n\n  sendProfileUpdate = () => {\n    this.channel.push(\"events:profile_updated\", { profile: this.store.state.profile });\n  };\n\n  updateScene = url => {\n    if (!this._permissions.update_hub) return \"unauthorized\";\n    this.channel.push(\"update_scene\", { url });\n  };\n\n  updateHub = settings => {\n    if (!this._permissions.update_hub) return \"unauthorized\";\n    this.channel.push(\"update_hub\", settings);\n  };\n\n  closeHub = () => {\n    if (!this._permissions.close_hub) return \"unauthorized\";\n    this.channel.push(\"close_hub\", {});\n  };\n\n  subscribe = subscription => {\n    this.channel.push(\"subscribe\", { subscription });\n  };\n\n  // If true, will tell the server to not send us any NAF traffic\n  allowNAFTraffic = allow => {\n    this.channel.push(allow ? \"unblock_naf\" : \"block_naf\", {});\n  };\n\n  unsubscribe = subscription => {\n    return new Promise(resolve => this.channel.push(\"unsubscribe\", { subscription }).receive(\"ok\", resolve));\n  };\n\n  sendMessage = (body, type = \"chat\") => {\n    if (!body) return;\n    this.channel.push(\"message\", { body, type });\n  };\n\n  _getCreatorAssignmentToken = () => {\n    const creatorAssignmentTokenEntry =\n      this.store.state.creatorAssignmentTokens &&\n      this.store.state.creatorAssignmentTokens.find(t => t.hubId === this.hubId);\n\n    return creatorAssignmentTokenEntry && creatorAssignmentTokenEntry.creatorAssignmentToken;\n  };\n\n  signIn = token => {\n    return new Promise((resolve, reject) => {\n      const creator_assignment_token = this._getCreatorAssignmentToken();\n\n      this.channel\n        .push(\"sign_in\", { token, creator_assignment_token })\n        .receive(\"ok\", ({ perms_token }) => {\n          this.setPermissionsFromToken(perms_token);\n          this._signedIn = true;\n          resolve();\n        })\n        .receive(\"error\", err => {\n          if (err.reason === \"invalid_token\") {\n            console.warn(\"sign in failed\", err);\n            // Token expired or invalid TODO purge from storage if possible\n            resolve();\n          } else {\n            console.error(\"sign in failed\", err);\n            reject();\n          }\n        });\n    });\n  };\n\n  signOut = () => {\n    return new Promise((resolve, reject) => {\n      this.channel\n        .push(\"sign_out\")\n        .receive(\"ok\", async () => {\n          this._signedIn = false;\n          await this.fetchPermissions();\n          resolve();\n        })\n        .receive(\"error\", reject);\n    });\n  };\n\n  getHost = () => {\n    return new Promise((resolve, reject) => {\n      this.channel\n        .push(\"get_host\")\n        .receive(\"ok\", res => {\n          resolve(res.host);\n        })\n        .receive(\"error\", reject);\n    });\n  };\n\n  getTwitterOAuthURL = () => {\n    return new Promise((resolve, reject) => {\n      this.channel\n        .push(\"oauth\", { type: \"twitter\" })\n        .receive(\"ok\", res => {\n          resolve(res.oauth_url);\n        })\n        .receive(\"error\", reject);\n    });\n  };\n\n  discordBridges = () => {\n    if (!this.presence || !this.presence.state) return [];\n    return discordBridgesForPresences(this.presence.state);\n  };\n\n  pin = (id, gltfNode, fileId, fileAccessToken, promotionToken) => {\n    const payload = { id, gltf_node: gltfNode };\n    if (fileId && promotionToken) {\n      payload.file_id = fileId;\n      payload.file_access_token = fileAccessToken;\n      payload.promotion_token = promotionToken;\n    }\n    return new Promise((resolve, reject) => {\n      this.channel\n        .push(\"pin\", payload)\n        .receive(\"ok\", resolve)\n        .receive(\"error\", reject);\n    });\n  };\n\n  unpin = (id, fileId) => {\n    const payload = { id };\n    if (fileId) {\n      payload.file_id = fileId;\n    }\n    this.channel.push(\"unpin\", payload);\n  };\n\n  fetchPermissions = () => {\n    return new Promise((resolve, reject) => {\n      this.channel\n        .push(\"refresh_perms_token\")\n        .receive(\"ok\", res => {\n          this.setPermissionsFromToken(res.perms_token);\n          resolve({ permsToken: res.perms_token, permissions: this._permissions });\n        })\n        .receive(\"error\", reject);\n    });\n  };\n\n  mute = sessionId => this.channel.push(\"mute\", { session_id: sessionId });\n  addOwner = sessionId => this.channel.push(\"add_owner\", { session_id: sessionId });\n  removeOwner = sessionId => this.channel.push(\"remove_owner\", { session_id: sessionId });\n\n  hide = sessionId => {\n    NAF.connection.adapter.block(sessionId);\n    this._blockedSessionIds.add(sessionId);\n  };\n\n  unhide = sessionId => {\n    if (!this._blockedSessionIds.has(sessionId)) return;\n    NAF.connection.adapter.unblock(sessionId);\n    NAF.connection.entities.completeSync(sessionId);\n    this._blockedSessionIds.delete(sessionId);\n  };\n\n  isHidden = sessionId => this._blockedSessionIds.has(sessionId);\n\n  kick = async sessionId => {\n    const permsToken = await this.fetchPermissions();\n    NAF.connection.adapter.kick(sessionId, permsToken);\n    this.channel.push(\"kick\", { session_id: sessionId });\n  };\n\n  requestSupport = () => this.channel.push(\"events:request_support\", {});\n  favorite = () => this.channel.push(\"favorite\", {});\n  unfavorite = () => this.channel.push(\"unfavorite\", {});\n\n  disconnect = () => {\n    if (this.channel) {\n      this.channel.socket.disconnect();\n    }\n  };\n}\n","const PHYSICS_CONSTANTS = require(\"aframe-physics-system/src/constants\"),\n  SHAPE = PHYSICS_CONSTANTS.SHAPE,\n  FIT = PHYSICS_CONSTANTS.FIT;\n\nfunction exceedsDensityThreshold(count, subtree) {\n  const bounds = subtree.boundingData;\n  const triangleThreshold = 1000;\n  const minimumVolume = 0.1;\n  const minimumTriangles = 100;\n  const dx = bounds[3] - bounds[0];\n  const dy = bounds[4] - bounds[1];\n  const dz = bounds[5] - bounds[2];\n  const volume = dx * dy * dz;\n\n  if (volume < minimumVolume) {\n    return false;\n  }\n\n  if (count < minimumTriangles) {\n    return false;\n  }\n\n  return count / volume > triangleThreshold;\n}\n\nfunction isHighDensity(subtree) {\n  if (subtree.count) {\n    const result = exceedsDensityThreshold(subtree.count, subtree);\n    return result === true ? true : subtree.count;\n  } else {\n    const leftResult = isHighDensity(subtree.left);\n    if (leftResult === true) return true;\n    const rightResult = isHighDensity(subtree.right);\n    if (rightResult === true) return true;\n\n    const count = leftResult + rightResult;\n    const result = exceedsDensityThreshold(count, subtree);\n    return result === true ? true : count;\n  }\n}\n\nfunction isGeometryHighDensity(geo) {\n  const bvh = geo.boundsTree;\n  const roots = bvh._roots;\n  for (let i = 0; i < roots.length; ++i) {\n    return isHighDensity(roots[i]) === true;\n  }\n  return false;\n}\n\nexport const traverseMeshesAndAddShapes = (function() {\n  const shapePrefix = \"ammo-shape__\";\n  const shapes = [];\n  return function(el) {\n    const meshRoot = el.object3DMap.mesh;\n    while (shapes.length > 0) {\n      const { id, entity } = shapes.pop();\n      entity.removeAttribute(id);\n    }\n\n    console.group(\"traverseMeshesAndAddShapes\");\n\n    if (document.querySelector([\"[ammo-shape__trimesh]\", \"[ammo-shape__heightfield]\"])) {\n      console.log(\"heightfield or trimesh found on scene\");\n    } else {\n      console.log(\"collision not found in scene\");\n\n      let isHighDensity = false;\n      meshRoot.traverse(o => {\n        if (\n          o.isMesh &&\n          (!THREE.Sky || o.__proto__ != THREE.Sky.prototype) &&\n          !o.name.startsWith(\"Floor_Plan\") &&\n          !o.name.startsWith(\"Ground_Plane\") &&\n          o.geometry.boundsTree\n        ) {\n          if (isGeometryHighDensity(o.geometry)) {\n            isHighDensity = true;\n            return;\n          }\n        }\n      });\n\n      let navMesh = null;\n\n      if (isHighDensity) {\n        console.log(\"mesh contains high triangle density region\");\n        navMesh = document.querySelector(\"[nav-mesh]\");\n      }\n\n      if (navMesh) {\n        console.log(`mesh density exceeded, using floor plan only`);\n        navMesh.setAttribute(shapePrefix + \"floorPlan\", {\n          type: SHAPE.MESH,\n          margin: 0.01,\n          fit: FIT.ALL,\n          includeInvisible: true\n        });\n        shapes.push({ id: shapePrefix + \"floorPlan\", entity: navMesh });\n      } else if (!isHighDensity) {\n        el.setAttribute(shapePrefix + \"environment\", {\n          type: SHAPE.MESH,\n          margin: 0.01,\n          fit: FIT.ALL\n        });\n        shapes.push({ id: shapePrefix + \"environment\", entity: el });\n        console.log(\"adding mesh shape for all visible meshes\");\n      } else {\n        el.setAttribute(shapePrefix + \"defaultFloor\", {\n          type: SHAPE.BOX,\n          margin: 0.01,\n          halfExtents: { x: 4000, y: 0.5, z: 4000 },\n          offset: { x: 0, y: -0.5, z: 0 },\n          fit: FIT.MANUAL\n        });\n        shapes.push({ id: shapePrefix + \"defaultFloor\", entity: el });\n        console.log(\"adding default floor collision\");\n      }\n    }\n    console.groupEnd();\n  };\n})();\n","import { spawnChatMessage } from \"./react-components/chat-message\";\nimport { SOUND_QUACK, SOUND_SPECIAL_QUACK } from \"./systems/sound-effects-system\";\n\nconst DUCK_URL = \"https://asset-bundles-prod.reticulum.io/interactables/Ducky/DuckyMesh-438ff8e022.gltf\";\n\n// Handles user-entered messages\nexport default class MessageDispatch {\n  constructor(scene, entryManager, hubChannel, addToPresenceLog, remountUI, mediaSearchStore) {\n    this.scene = scene;\n    this.entryManager = entryManager;\n    this.hubChannel = hubChannel;\n    this.addToPresenceLog = addToPresenceLog;\n    this.remountUI = remountUI;\n    this.mediaSearchStore = mediaSearchStore;\n  }\n\n  log = body => {\n    this.addToPresenceLog({ type: \"log\", body });\n  };\n\n  dispatch = message => {\n    if (message.startsWith(\"/\")) {\n      const commandParts = message.substring(1).split(\" \");\n      this.dispatchCommand(commandParts[0], ...commandParts.slice(1));\n      document.activeElement.blur(); // Commands should blur\n    } else {\n      this.hubChannel.sendMessage(message);\n    }\n  };\n\n  dispatchCommand = (command, ...args) => {\n    const entered = this.scene.is(\"entered\");\n\n    if (!entered) {\n      this.addToPresenceLog({ type: \"log\", body: \"You must enter the room to use this command.\" });\n      return;\n    }\n\n    const playerRig = document.querySelector(\"#player-rig\");\n    const scales = [0.0625, 0.125, 0.25, 0.5, 1.0, 1.5, 3, 5, 7.5, 12.5];\n    const curScale = playerRig.object3D.scale;\n    let err;\n    let physicsSystem;\n    const captureSystem = this.scene.systems[\"capture-system\"];\n\n    switch (command) {\n      case \"fly\":\n        if (playerRig.getAttribute(\"character-controller\").fly !== true) {\n          playerRig.setAttribute(\"character-controller\", \"fly\", true);\n          this.addToPresenceLog({ type: \"log\", body: \"Fly mode enabled.\" });\n        } else {\n          playerRig.setAttribute(\"character-controller\", \"fly\", false);\n          this.addToPresenceLog({ type: \"log\", body: \"Fly mode disabled.\" });\n        }\n        break;\n      case \"grow\":\n        for (let i = 0; i < scales.length; i++) {\n          if (scales[i] > curScale.x) {\n            playerRig.object3D.scale.set(scales[i], scales[i], scales[i]);\n            playerRig.object3D.matrixNeedsUpdate = true;\n            break;\n          }\n        }\n\n        break;\n      case \"shrink\":\n        for (let i = scales.length - 1; i >= 0; i--) {\n          if (curScale.x > scales[i]) {\n            playerRig.object3D.scale.set(scales[i], scales[i], scales[i]);\n            break;\n          }\n        }\n\n        break;\n      case \"leave\":\n        this.entryManager.exitScene();\n        this.remountUI({ roomUnavailableReason: \"left\" });\n        break;\n      case \"duck\":\n        spawnChatMessage(DUCK_URL);\n        if (Math.random() < 0.01) {\n          this.scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_SPECIAL_QUACK);\n        } else {\n          this.scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_QUACK);\n        }\n        break;\n      case \"debug\":\n        physicsSystem = document.querySelector(\"a-scene\").systems.physics;\n        physicsSystem.setDebug(!physicsSystem.debug);\n        break;\n      case \"vrstats\":\n        document.getElementById(\"stats\").components[\"stats-plus\"].toggleVRStats();\n        break;\n      case \"scene\":\n        if (args[0]) {\n          err = this.hubChannel.updateScene(args[0]);\n\n          if (err === \"unauthorized\") {\n            this.addToPresenceLog({ type: \"log\", body: \"You do not have permission to change the scene.\" });\n          }\n        } else if (this.hubChannel.canOrWillIfCreator(\"update_hub\")) {\n          this.mediaSearchStore.sourceNavigateWithNoNav(\"scenes\");\n        }\n\n        break;\n      case \"rename\":\n        err = this.hubChannel.rename(args.join(\" \"));\n        if (err === \"unauthorized\") {\n          this.addToPresenceLog({ type: \"log\", body: \"You do not have permission to rename this room.\" });\n        }\n        break;\n      case \"capture\":\n        if (!captureSystem.available()) {\n          this.log(\"Capture unavailable.\");\n          break;\n        }\n        if (args[0] === \"stop\") {\n          if (captureSystem.started()) {\n            captureSystem.stop();\n            this.log(\"Capture stopped.\");\n          } else {\n            this.log(\"Capture already stopped.\");\n          }\n        } else {\n          if (captureSystem.started()) {\n            this.log(\"Capture already running.\");\n          } else {\n            captureSystem.start();\n            this.log(\"Capture started.\");\n          }\n        }\n        break;\n    }\n  };\n}\n","import qsTruthy from \"./utils/qs_truthy\";\nimport nextTick from \"./utils/next-tick\";\nimport pinnedEntityToGltf from \"./utils/pinned-entity-to-gltf\";\n\nconst isBotMode = qsTruthy(\"bot\");\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isDebug = qsTruthy(\"debug\");\nconst qs = new URLSearchParams(location.search);\n\nimport { addMedia, getPromotionTokenForFile } from \"./utils/media-utils\";\nimport {\n  isIn2DInterstitial,\n  handleExitTo2DInterstitial,\n  exit2DInterstitialAndEnterVR,\n  forceExitFrom2DInterstitial\n} from \"./utils/vr-interstitial\";\nimport { ObjectContentOrigins } from \"./object-types\";\nimport { getAvatarSrc, getAvatarType } from \"./utils/avatar-utils\";\nimport { pushHistoryState } from \"./utils/history\";\nimport { SOUND_ENTER_SCENE } from \"./systems/sound-effects-system\";\n\nconst isIOS = AFRAME.utils.device.isIOS();\n\nexport default class SceneEntryManager {\n  constructor(hubChannel, authChannel, availableVREntryTypes, history) {\n    this.hubChannel = hubChannel;\n    this.authChannel = authChannel;\n    this.availableVREntryTypes = availableVREntryTypes;\n    this.store = window.APP.store;\n    this.mediaSearchStore = window.APP.mediaSearchStore;\n    this.scene = document.querySelector(\"a-scene\");\n    this.cursorController = document.querySelector(\"#cursor-controller\");\n    this.playerRig = document.querySelector(\"#player-rig\");\n    this._entered = false;\n    this.performConditionalSignIn = () => {};\n    this.history = history;\n  }\n\n  init = () => {\n    this.whenSceneLoaded(() => {\n      this.cursorController.components[\"cursor-controller\"].enabled = false;\n    });\n  };\n\n  hasEntered = () => {\n    return this._entered;\n  };\n\n  enterScene = async (mediaStream, enterInVR, muteOnEntry) => {\n    const playerCamera = document.querySelector(\"#player-camera\");\n    playerCamera.removeAttribute(\"scene-preview-camera\");\n\n    if (isDebug) {\n      NAF.connection.adapter.session.options.verbose = true;\n    }\n\n    if (enterInVR) {\n      // This specific scene state var is used to check if the user went through the\n      // entry flow and chose VR entry, and is used to preempt VR mode on refreshes.\n      this.scene.addState(\"vr-entered\");\n\n      // HACK - A-Frame calls getVRDisplays at module load, we want to do it here to\n      // force gamepads to become live.\n      navigator.getVRDisplays();\n\n      exit2DInterstitialAndEnterVR(true);\n    }\n\n    if (isMobile || qsTruthy(\"mobile\")) {\n      this.playerRig.setAttribute(\"virtual-gamepad-controls\", {});\n    }\n\n    this._setupPlayerRig();\n    this._setupBlocking();\n    this._setupKicking();\n    this._setupMedia(mediaStream);\n    this._setupCamera();\n\n    if (qsTruthy(\"offline\")) return;\n\n    this._spawnAvatar();\n\n    this.scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_ENTER_SCENE);\n\n    if (isBotMode) {\n      this._runBot(mediaStream);\n      return;\n    }\n\n    if (mediaStream) {\n      NAF.connection.adapter.setLocalMediaStream(mediaStream);\n    }\n\n    this.scene.classList.remove(\"hand-cursor\");\n    this.scene.classList.add(\"no-cursor\");\n\n    this.cursorController.components[\"cursor-controller\"].enabled = true;\n    this._entered = true;\n\n    // Delay sending entry event telemetry until VR display is presenting.\n    (async () => {\n      while (enterInVR && !(await navigator.getVRDisplays()).find(d => d.isPresenting)) {\n        await nextTick();\n      }\n\n      this.hubChannel.sendEntryEvent().then(() => {\n        this.store.update({ activity: { lastEnteredAt: new Date().toISOString() } });\n      });\n    })();\n\n    // Bump stored entry count after 30s\n    setTimeout(() => this.store.bumpEntryCount(), 30000);\n\n    this.scene.addState(\"entered\");\n\n    if (muteOnEntry) {\n      this.scene.emit(\"action_mute\");\n    }\n  };\n\n  whenSceneLoaded = callback => {\n    if (this.scene.hasLoaded) {\n      callback();\n    } else {\n      this.scene.addEventListener(\"loaded\", callback);\n    }\n  };\n\n  enterSceneWhenLoaded = (mediaStream, enterInVR) => {\n    this.whenSceneLoaded(() => this.enterScene(mediaStream, enterInVR));\n  };\n\n  exitScene = () => {\n    if (NAF.connection.adapter && NAF.connection.adapter.localMediaStream) {\n      NAF.connection.adapter.localMediaStream.getTracks().forEach(t => t.stop());\n    }\n    if (this.hubChannel) {\n      this.hubChannel.disconnect();\n    }\n    if (this.scene.renderer) {\n      this.scene.renderer.setAnimationLoop(null); // Stop animation loop, TODO A-Frame should do this\n    }\n    document.body.removeChild(this.scene);\n  };\n\n  _setupPlayerRig = () => {\n    this._setPlayerInfoFromProfile();\n    this.store.addEventListener(\"statechanged\", this._setPlayerInfoFromProfile);\n\n    const avatarScale = parseInt(qs.get(\"avatar_scale\"), 10);\n    if (avatarScale) {\n      this.playerRig.setAttribute(\"scale\", { x: avatarScale, y: avatarScale, z: avatarScale });\n    }\n  };\n\n  _setPlayerInfoFromProfile = async () => {\n    const avatarId = this.store.state.profile.avatarId;\n    const avatarSrc = await getAvatarSrc(avatarId);\n\n    this.playerRig.setAttribute(\"player-info\", { avatarSrc, avatarType: getAvatarType(avatarId) });\n  };\n\n  _setupKicking = () => {\n    // This event is only received by the kicker\n    document.body.addEventListener(\"kicked\", ({ detail }) => {\n      const { clientId: kickedClientId } = detail;\n      const { entities } = NAF.connection.entities;\n      for (const id in entities) {\n        const entity = entities[id];\n        if (NAF.utils.getCreator(entity) !== kickedClientId) continue;\n\n        if (entity.components.networked.data.persistent) {\n          NAF.utils.takeOwnership(entity);\n          this._unpinElement(entity);\n          entity.parentNode.removeChild(entity);\n        } else {\n          NAF.entities.removeEntity(id);\n        }\n      }\n    });\n  };\n\n  _setupBlocking = () => {\n    document.body.addEventListener(\"blocked\", ev => {\n      NAF.connection.entities.removeEntitiesOfClient(ev.detail.clientId);\n    });\n\n    document.body.addEventListener(\"unblocked\", ev => {\n      NAF.connection.entities.completeSync(ev.detail.clientId, true);\n    });\n  };\n\n  _pinElement = async el => {\n    const { networkId } = el.components.networked.data;\n\n    const { fileId, src } = el.components[\"media-loader\"].data;\n\n    let fileAccessToken, promotionToken;\n    if (fileId) {\n      fileAccessToken = new URL(src).searchParams.get(\"token\");\n      const storedPromotionToken = getPromotionTokenForFile(fileId);\n      if (storedPromotionToken) {\n        promotionToken = storedPromotionToken.promotionToken;\n      }\n    }\n\n    const gltfNode = pinnedEntityToGltf(el);\n    if (!gltfNode) return;\n    el.setAttribute(\"networked\", { persistent: true });\n    el.setAttribute(\"media-loader\", { fileIsOwned: true });\n\n    try {\n      await this.hubChannel.pin(networkId, gltfNode, fileId, fileAccessToken, promotionToken);\n      this.store.update({ activity: { hasPinned: true } });\n    } catch (e) {\n      if (e.reason === \"invalid_token\") {\n        await this.authChannel.signOut(this.hubChannel);\n        this._signInAndPinOrUnpinElement(el);\n      } else {\n        console.warn(\"Pin failed for unknown reason\", e);\n      }\n    }\n  };\n\n  _signInAndPinOrUnpinElement = (el, pin) => {\n    const action = pin ? () => this._pinElement(el) : async () => await this._unpinElement(el);\n\n    this.performConditionalSignIn(() => this.hubChannel.signedIn, action, pin ? \"pin\" : \"unpin\", () => {\n      // UI pins/un-pins the entity optimistically, so we undo that here.\n      // Note we have to disable the sign in flow here otherwise this will recurse.\n      this._disableSignInOnPinAction = true;\n      el.setAttribute(\"pinnable\", \"pinned\", !pin);\n      this._disableSignInOnPinAction = false;\n    });\n  };\n\n  _unpinElement = el => {\n    const components = el.components;\n    const networked = components.networked;\n\n    if (!networked || !networked.data || !NAF.utils.isMine(el)) return;\n\n    const networkId = components.networked.data.networkId;\n    el.setAttribute(\"networked\", { persistent: false });\n\n    const mediaLoader = components[\"media-loader\"];\n    const fileId = mediaLoader.data && mediaLoader.data.fileId;\n\n    this.hubChannel.unpin(networkId, fileId);\n  };\n\n  _setupMedia = mediaStream => {\n    const offset = { x: 0, y: 0, z: -1.5 };\n    const spawnMediaInfrontOfPlayer = (src, contentOrigin) => {\n      if (!this.hubChannel.can(\"spawn_and_move_media\")) return;\n      const { entity, orientation } = addMedia(\n        src,\n        \"#interactable-media\",\n        contentOrigin,\n        null,\n        !(src instanceof MediaStream),\n        true\n      );\n      orientation.then(or => {\n        entity.setAttribute(\"offset-relative-to\", {\n          target: \"#player-camera\",\n          offset,\n          orientation: or\n        });\n      });\n\n      return entity;\n    };\n\n    this.scene.addEventListener(\"add_media\", e => {\n      const contentOrigin = e.detail instanceof File ? ObjectContentOrigins.FILE : ObjectContentOrigins.URL;\n\n      spawnMediaInfrontOfPlayer(e.detail, contentOrigin);\n    });\n\n    this.scene.addEventListener(\"pinned\", e => {\n      if (this._disableSignInOnPinAction) return;\n      this._signInAndPinOrUnpinElement(e.detail.el, true);\n    });\n\n    this.scene.addEventListener(\"unpinned\", e => {\n      if (this._disableSignInOnPinAction) return;\n      this._signInAndPinOrUnpinElement(e.detail.el, false);\n    });\n\n    this.scene.addEventListener(\"object_spawned\", e => {\n      this.hubChannel.sendObjectSpawnedEvent(e.detail.objectType);\n    });\n\n    this.scene.addEventListener(\"action_spawn\", () => {\n      handleExitTo2DInterstitial(false, () => window.APP.mediaSearchStore.pushExitMediaBrowserHistory());\n      window.APP.mediaSearchStore.sourceNavigateToDefaultSource();\n    });\n\n    this.scene.addEventListener(\"action_invite\", () => {\n      handleExitTo2DInterstitial(false, () => this.history.goBack());\n      pushHistoryState(this.history, \"overlay\", \"invite\");\n    });\n\n    this.scene.addEventListener(\"action_kick_client\", ({ detail: { clientId } }) => {\n      this.performConditionalSignIn(\n        () => this.hubChannel.can(\"kick_users\"),\n        async () => await window.APP.hubChannel.kick(clientId),\n        \"kick-user\"\n      );\n    });\n\n    this.scene.addEventListener(\"action_mute_client\", ({ detail: { clientId } }) => {\n      this.performConditionalSignIn(\n        () => this.hubChannel.can(\"mute_users\"),\n        () => window.APP.hubChannel.mute(clientId),\n        \"mute-user\"\n      );\n    });\n\n    this.scene.addEventListener(\"action_vr_notice_closed\", () => forceExitFrom2DInterstitial());\n\n    document.addEventListener(\"paste\", e => {\n      if (\n        (e.target.matches(\"input, textarea\") || e.target.contentEditable === \"true\") &&\n        document.activeElement === e.target\n      )\n        return;\n\n      // Never paste into scene if dialog is open\n      const uiRoot = document.querySelector(\".ui-root\");\n      if (uiRoot && uiRoot.classList.contains(\"in-modal-or-overlay\")) return;\n\n      const url = e.clipboardData.getData(\"text\");\n      const files = e.clipboardData.files && e.clipboardData.files;\n      if (url) {\n        spawnMediaInfrontOfPlayer(url, ObjectContentOrigins.URL);\n      } else {\n        for (const file of files) {\n          spawnMediaInfrontOfPlayer(file, ObjectContentOrigins.CLIPBOARD);\n        }\n      }\n    });\n\n    document.addEventListener(\"dragover\", e => e.preventDefault());\n\n    document.addEventListener(\"drop\", e => {\n      e.preventDefault();\n\n      let url = e.dataTransfer.getData(\"url\");\n\n      if (!url) {\n        // Sometimes dataTransfer text contains a valid URL, so try for that.\n        try {\n          url = new URL(e.dataTransfer.getData(\"text\")).href;\n        } catch (e) {\n          // Nope, not this time.\n        }\n      }\n\n      const files = e.dataTransfer.files;\n\n      if (url) {\n        spawnMediaInfrontOfPlayer(url, ObjectContentOrigins.URL);\n      } else {\n        for (const file of files) {\n          spawnMediaInfrontOfPlayer(file, ObjectContentOrigins.FILE);\n        }\n      }\n    });\n\n    let currentVideoShareEntity;\n    let isHandlingVideoShare = false;\n\n    const shareVideoMediaStream = async constraints => {\n      if (isHandlingVideoShare) return;\n      isHandlingVideoShare = true;\n\n      let newStream;\n\n      try {\n        newStream = await navigator.mediaDevices.getUserMedia(constraints);\n      } catch (e) {\n        isHandlingVideoShare = false;\n        this.scene.emit(\"share_video_failed\");\n        return;\n      }\n\n      const videoTracks = newStream ? newStream.getVideoTracks() : [];\n\n      if (videoTracks.length > 0) {\n        newStream.getVideoTracks().forEach(track => mediaStream.addTrack(track));\n        NAF.connection.adapter.setLocalMediaStream(mediaStream);\n        currentVideoShareEntity = spawnMediaInfrontOfPlayer(mediaStream, undefined);\n\n        // Wire up custom removal event which will stop the stream.\n        currentVideoShareEntity.setAttribute(\"emit-scene-event-on-remove\", \"event:action_end_video_sharing\");\n      }\n\n      this.scene.emit(\"share_video_enabled\", { source: constraints.video.mediaSource });\n      this.scene.addState(\"sharing_video\");\n      isHandlingVideoShare = false;\n    };\n\n    this.scene.addEventListener(\"action_share_camera\", () => {\n      shareVideoMediaStream({\n        video: {\n          mediaSource: \"camera\",\n          width: isIOS ? { max: 1280 } : { max: 1280, ideal: 720 },\n          frameRate: 30\n        }\n      });\n    });\n\n    this.scene.addEventListener(\"action_share_window\", () => {\n      shareVideoMediaStream({\n        video: {\n          mediaSource: \"window\",\n          // Work around BMO 1449832 by calculating the width. This will break for multi monitors if you share anything\n          // other than your current monitor that has a different aspect ratio.\n          width: 720 * (screen.width / screen.height),\n          height: 720,\n          frameRate: 30\n        }\n      });\n    });\n\n    this.scene.addEventListener(\"action_share_screen\", () => {\n      shareVideoMediaStream({\n        video: {\n          mediaSource: \"screen\",\n          // Work around BMO 1449832 by calculating the width. This will break for multi monitors if you share anything\n          // other than your current monitor that has a different aspect ratio.\n          width: 720 * (screen.width / screen.height),\n          height: 720,\n          frameRate: 30\n        }\n      });\n    });\n\n    this.scene.addEventListener(\"action_end_video_sharing\", () => {\n      if (isHandlingVideoShare) return;\n      isHandlingVideoShare = true;\n\n      if (currentVideoShareEntity && currentVideoShareEntity.parentNode) {\n        NAF.utils.takeOwnership(currentVideoShareEntity);\n        currentVideoShareEntity.parentNode.removeChild(currentVideoShareEntity);\n      }\n\n      for (const track of mediaStream.getVideoTracks()) {\n        mediaStream.removeTrack(track);\n      }\n\n      NAF.connection.adapter.setLocalMediaStream(mediaStream);\n      currentVideoShareEntity = null;\n\n      this.scene.emit(\"share_video_disabled\");\n      this.scene.removeState(\"sharing_video\");\n      isHandlingVideoShare = false;\n    });\n\n    this.scene.addEventListener(\"action_selected_media_result_entry\", e => {\n      // TODO spawn in space when no rights\n      const entry = e.detail;\n      if ([\"avatar\", \"avatar_listing\"].includes(entry.type)) return;\n      if ((entry.type === \"scene_listing\" || entry.type === \"scene\") && this.hubChannel.can(\"update_hub\")) return;\n\n      // If user has HMD lifted up or gone through interstitial, delay spawning for now. eventually show a modal\n      const spawnDelay = isIn2DInterstitial() ? 3000 : 0;\n\n      setTimeout(() => {\n        spawnMediaInfrontOfPlayer(entry.url, ObjectContentOrigins.URL);\n      }, spawnDelay);\n\n      exit2DInterstitialAndEnterVR();\n    });\n\n    this.mediaSearchStore.addEventListener(\"media-exit\", () => {\n      exit2DInterstitialAndEnterVR();\n    });\n  };\n\n  _setupCamera = () => {\n    this.scene.addEventListener(\"action_toggle_camera\", () => {\n      if (!this.hubChannel.can(\"spawn_camera\")) return;\n      const myCamera = this.scene.systems[\"camera-tools\"].getMyCamera();\n\n      if (myCamera) {\n        myCamera.parentNode.removeChild(myCamera);\n        this.scene.removeState(\"camera\");\n      } else {\n        const entity = document.createElement(\"a-entity\");\n        entity.setAttribute(\"networked\", { template: \"#interactable-camera\" });\n        entity.setAttribute(\"offset-relative-to\", {\n          target: \"#player-camera\",\n          offset: { x: 0, y: 0, z: -1.5 }\n        });\n        this.scene.appendChild(entity);\n        this.scene.addState(\"camera\");\n      }\n\n      // Need to wait a frame so camera is registered with system.\n      setTimeout(() => this.scene.emit(\"camera_toggled\"));\n    });\n\n    this.scene.addEventListener(\"photo_taken\", e => this.hubChannel.sendMessage({ src: e.detail }, \"photo\"));\n    this.scene.addEventListener(\"video_taken\", e => this.hubChannel.sendMessage({ src: e.detail }, \"video\"));\n  };\n\n  _spawnAvatar = () => {\n    this.playerRig.setAttribute(\"networked\", \"template: #remote-avatar; attachTemplateToLocal: false;\");\n    this.playerRig.setAttribute(\"networked-avatar\", \"\");\n    this.playerRig.emit(\"entered\");\n  };\n\n  _runBot = async mediaStream => {\n    const audioEl = document.createElement(\"audio\");\n    let audioInput;\n    let dataInput;\n\n    // Wait for startup to render form\n    do {\n      audioInput = document.querySelector(\"#bot-audio-input\");\n      dataInput = document.querySelector(\"#bot-data-input\");\n      await nextTick();\n    } while (!audioInput || !dataInput);\n\n    const getAudio = () => {\n      audioEl.loop = true;\n      audioEl.muted = true;\n      audioEl.crossorigin = \"anonymous\";\n      audioEl.src = URL.createObjectURL(audioInput.files[0]);\n      document.body.appendChild(audioEl);\n    };\n\n    if (audioInput.files && audioInput.files.length > 0) {\n      getAudio();\n    } else {\n      audioInput.onchange = getAudio;\n    }\n\n    const camera = document.querySelector(\"#player-camera\");\n    const leftController = document.querySelector(\"#player-left-controller\");\n    const rightController = document.querySelector(\"#player-right-controller\");\n    const getRecording = () => {\n      fetch(URL.createObjectURL(dataInput.files[0]))\n        .then(resp => resp.json())\n        .then(recording => {\n          camera.setAttribute(\"replay\", \"\");\n          camera.components[\"replay\"].poses = recording.camera.poses;\n\n          leftController.setAttribute(\"replay\", \"\");\n          leftController.components[\"replay\"].poses = recording.left.poses;\n          leftController.removeAttribute(\"visibility-by-path\");\n          leftController.removeAttribute(\"track-pose\");\n          leftController.setAttribute(\"visible\", true);\n\n          rightController.setAttribute(\"replay\", \"\");\n          rightController.components[\"replay\"].poses = recording.right.poses;\n          rightController.removeAttribute(\"visibility-by-path\");\n          rightController.removeAttribute(\"track-pose\");\n          rightController.setAttribute(\"visible\", true);\n        });\n    };\n\n    if (dataInput.files && dataInput.files.length > 0) {\n      getRecording();\n    } else {\n      dataInput.onchange = getRecording;\n    }\n\n    await new Promise(resolve => audioEl.addEventListener(\"canplay\", resolve));\n    mediaStream.addTrack(\n      audioEl.captureStream\n        ? audioEl.captureStream().getAudioTracks()[0]\n        : audioEl.mozCaptureStream\n          ? audioEl.mozCaptureStream().getAudioTracks()[0]\n          : null\n    );\n    NAF.connection.adapter.setLocalMediaStream(mediaStream);\n    audioEl.play();\n  };\n}\n","export default function pinnedEntityToGltf(el) {\n  if (!NAF.utils.isMine(el)) return;\n\n  // Construct a GLTF node from this entity\n  const object3D = el.object3D;\n  const components = el.components;\n  const networkId = components.networked.data.networkId;\n\n  const gltfComponents = {};\n  // TODO: Move to MOZ_hubs_components and include version number. Requires migration of existing room objects.\n  // Please do this before making a breaking change to the data stored here.\n  const gltfNode = { name: networkId, extensions: { HUBS_components: gltfComponents } };\n\n  // Adapted from three.js GLTFExporter\n  const equalArray = (x, y) => x.length === y.length && x.every((v, i) => v === y[i]);\n  const rotation = object3D.quaternion.toArray();\n  const position = object3D.position.toArray();\n  const scale = object3D.scale.toArray();\n\n  if (!equalArray(rotation, [0, 0, 0, 1])) gltfNode.rotation = rotation;\n  if (!equalArray(position, [0, 0, 0])) gltfNode.translation = position;\n  if (!equalArray(scale, [1, 1, 1])) gltfNode.scale = scale;\n\n  if (components[\"media-loader\"]) {\n    const mediaSrc = components[\"media-loader\"].data.src;\n    const mediaContentSubtype = components[\"media-loader\"].data.contentSubtype;\n\n    if (mediaSrc.startsWith(\"hubs://\") && mediaSrc.endsWith(\"/video\")) {\n      // Do not persist hubs client video urls\n      return null;\n    }\n\n    gltfComponents.media = { src: mediaSrc, contentSubtype: mediaContentSubtype, id: networkId };\n\n    if (components[\"media-pager\"]) {\n      gltfComponents.media.pageIndex = components[\"media-pager\"].data.index;\n    }\n\n    if (components[\"media-video\"] && components[\"media-video\"].data.videoPaused) {\n      gltfComponents.media.paused = true;\n      gltfComponents.media.time = components[\"media-video\"].data.time;\n    }\n  }\n\n  gltfComponents.pinnable = { pinned: true };\n\n  return gltfNode;\n}\n","import nextTick from \"./utils/next-tick.js\";\nconst INIT_TIMEOUT_MS = 5000;\n\n// Manages web push subscriptions\n//\nfunction urlBase64ToUint8Array(base64String) {\n  const padding = \"=\".repeat((4 - (base64String.length % 4)) % 4);\n  const base64 = (base64String + padding).replace(/-/g, \"+\").replace(/_/g, \"/\");\n\n  const rawData = window.atob(base64);\n  const outputArray = new Uint8Array(rawData.length);\n\n  for (let i = 0; i < rawData.length; ++i) {\n    outputArray[i] = rawData.charCodeAt(i);\n  }\n  return outputArray;\n}\n\nexport default class Subscriptions {\n  constructor(hubId) {\n    this.hubId = hubId;\n  }\n\n  setHubChannel = hubChannel => {\n    this.hubChannel = hubChannel;\n  };\n\n  setRegistration = registration => {\n    this.registration = registration;\n  };\n\n  setRegistrationFailed = () => {\n    this.registration = null;\n  };\n\n  setVapidPublicKey = vapidPublicKey => {\n    this.vapidPublicKey = vapidPublicKey;\n  };\n\n  setSubscribed = isSubscribed => {\n    this._isSubscribed = isSubscribed;\n  };\n\n  isSubscribed = () => {\n    return this._isSubscribed;\n  };\n\n  getCurrentEndpoint = async () => {\n    if (!navigator.serviceWorker) return null;\n    const startedAt = performance.now();\n\n    // registration becomes null if failed, non null if registered\n    while (this.registration === undefined && performance.now() - startedAt < INIT_TIMEOUT_MS) await nextTick();\n    if (performance.now() - startedAt >= INIT_TIMEOUT_MS) console.warn(\"Service worker registration timed out.\");\n    if (!this.registration || !this.registration.pushManager) return null;\n\n    while (this.vapidPublicKey === undefined) await nextTick();\n    if (this.vapidPublicKey === null) return null;\n\n    try {\n      const convertedVapidKey = urlBase64ToUint8Array(this.vapidPublicKey);\n\n      if (\n        (await this.registration.pushManager.permissionState({\n          userVisibleOnly: true,\n          applicationServerKey: convertedVapidKey\n        })) !== \"granted\"\n      )\n        return null;\n    } catch (e) {\n      return null; // Chrome can throw here complaining about userVisible if push is not right\n    }\n    const sub = await this.registration.pushManager.getSubscription();\n    if (!sub) return null;\n\n    return sub.endpoint;\n  };\n\n  toggle = async () => {\n    if (!this.registration) return;\n\n    if (this._isSubscribed) {\n      const pushSubscription = await this.registration.pushManager.getSubscription();\n      const res = await this.hubChannel.unsubscribe(pushSubscription);\n\n      if (res && res.has_remaining_subscriptions === false) {\n        pushSubscription.unsubscribe();\n      }\n    } else {\n      let pushSubscription = await this.registration.pushManager.getSubscription();\n\n      if (!pushSubscription) {\n        const convertedVapidKey = urlBase64ToUint8Array(this.vapidPublicKey);\n\n        pushSubscription = await this.registration.pushManager.subscribe({\n          userVisibleOnly: true,\n          applicationServerKey: convertedVapidKey\n        });\n      }\n\n      this.hubChannel.subscribe(pushSubscription);\n    }\n\n    this._isSubscribed = !this._isSubscribed;\n  };\n}\n","import { forEachMaterial } from \"../utils/material-utils\";\nimport qsTruthy from \"../utils/qs_truthy\";\n\nconst invaderPos = new AFRAME.THREE.Vector3();\nconst bubblePos = new AFRAME.THREE.Vector3();\nconst isDebug = qsTruthy(\"debug\");\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\n\n/**\n * Updates invaders every tick, doing one per frame on mobile VR.\n * testing multiline things\n * @namespace avatar/personal-space-bubble\n * @system personal-space-bubble\n */\nAFRAME.registerSystem(\"personal-space-bubble\", {\n  schema: {\n    debug: { default: false },\n    enabled: { default: true }\n  },\n\n  init() {\n    this.invaders = [];\n    this.bubbles = [];\n    this.tickCount = 0;\n    this._updateInvaders = this._updateInvaders.bind(this);\n  },\n\n  registerBubble(bubble) {\n    this.bubbles.push(bubble);\n  },\n\n  unregisterBubble(bubble) {\n    const index = this.bubbles.indexOf(bubble);\n\n    if (index !== -1) {\n      this.bubbles.splice(index, 1);\n    }\n  },\n\n  registerInvader(invader) {\n    NAF.utils.getNetworkedEntity(invader.el).then(networkedEl => {\n      const owner = NAF.utils.getNetworkOwner(networkedEl);\n\n      if (owner !== NAF.clientId) {\n        this.invaders.push(invader);\n      }\n    });\n  },\n\n  unregisterInvader(invader) {\n    const index = this.invaders.indexOf(invader);\n\n    if (index !== -1) {\n      this.invaders.splice(index, 1);\n    }\n  },\n\n  update() {\n    for (let i = 0; i < this.bubbles.length; i++) {\n      this.bubbles[i].updateDebug();\n    }\n\n    for (let i = 0; i < this.invaders.length; i++) {\n      this.invaders[i].updateDebug();\n      if (!this.data.enabled) {\n        this.invaders[i].setInvading(false);\n      }\n    }\n\n    if (this.data.enabled) {\n      this.el.addState(\"spacebubble\");\n    } else {\n      this.el.removeState(\"spacebubble\");\n    }\n  },\n\n  tick() {\n    this._updateInvaders();\n    this.tickCount++;\n  },\n\n  _updateInvaders: (function() {\n    const tempInvasionFlags = [];\n\n    const setInvaderFlag = (i, invaders, bubble) => {\n      // Hide the invader if inside the bubble\n      const invader = invaders[i];\n      invaderPos.setFromMatrixPosition(invader.el.object3D.matrixWorld);\n\n      const distanceSquared = bubblePos.distanceToSquared(invaderPos);\n      const radiusSum = bubble.data.radius + invader.data.radius;\n\n      if (distanceSquared < radiusSum * radiusSum) {\n        tempInvasionFlags[i] = true;\n      }\n    };\n\n    const flushInvadingFlagsForIndex = (i, invaders) => {\n      if (invaders[i].invading !== tempInvasionFlags[i]) {\n        invaders[i].setInvading(tempInvasionFlags[i]);\n      }\n    };\n\n    return function() {\n      if (!this.data.enabled) return;\n      if (this.invaders.length === 0) return;\n\n      tempInvasionFlags.length = 0;\n\n      // precondition for this stuff -- the bubbles and invaders need updated world matrices.\n      // right now this is satisfied because we update the world matrices in the character controller\n      for (let i = 0; i < this.invaders.length; i++) {\n        this.invaders[i].el.object3D.updateMatrices(); // We read matrixWorld below, update matrices here\n        tempInvasionFlags[i] = false;\n      }\n\n      // Loop through all of the space bubbles (usually one)\n      for (let i = 0; i < this.bubbles.length; i++) {\n        const bubble = this.bubbles[i];\n\n        bubble.el.object3D.updateMatrices();\n        bubblePos.setFromMatrixPosition(bubble.el.object3D.matrixWorld);\n\n        if (!isMobileVR) {\n          for (let j = 0; j < this.invaders.length; j++) {\n            setInvaderFlag(j, this.invaders, bubble);\n          }\n        } else {\n          // Optimization: update one invader per frame on mobile VR\n          setInvaderFlag(this.tickCount % this.invaders.length, this.invaders, bubble);\n        }\n      }\n\n      if (!isMobileVR) {\n        for (let i = 0; i < this.invaders.length; i++) {\n          flushInvadingFlagsForIndex(i, this.invaders);\n        }\n      } else {\n        flushInvadingFlagsForIndex(this.tickCount % this.invaders.length, this.invaders);\n      }\n    };\n  })()\n});\n\nfunction createSphereGizmo(radius) {\n  const geometry = new THREE.SphereBufferGeometry(radius, 10, 10);\n  const wireframe = new THREE.WireframeGeometry(geometry);\n  const line = new THREE.LineSegments(wireframe);\n  line.material.opacity = 0.5;\n  line.material.transparent = true;\n  return line;\n}\n\n// TODO: we need to come up with a more generic way of doing this as this is very specific to our avatars.\n/**\n * Specifies a mesh associated with an invader.\n * @namespace avatar/personal-space-bubble\n * @component space-invader-mesh\n */\nAFRAME.registerComponent(\"space-invader-mesh\", {\n  schema: {\n    meshName: { type: \"string\" }\n  },\n  update() {\n    this.targetMesh = this.el.object3D.getObjectByName(this.data.meshName);\n  }\n});\n\nfunction findInvaderMesh(entity) {\n  while (entity && !(entity.components && entity.components[\"space-invader-mesh\"])) {\n    entity = entity.parentNode;\n  }\n  return entity && entity.components[\"space-invader-mesh\"].targetMesh;\n}\n\nconst DEBUG_OBJ = \"psb-debug\";\n\n/**\n * Represents an entity that can invade a personal space bubble\n * @namespace avatar/personal-space-bubble\n * @component personal-space-invader\n */\nAFRAME.registerComponent(\"personal-space-invader\", {\n  schema: {\n    radius: { type: \"number\", default: 0.1 },\n    useMaterial: { default: false },\n    debug: { default: false },\n    invadingOpacity: { default: 0.3 }\n  },\n\n  init() {\n    const system = this.el.sceneEl.systems[\"personal-space-bubble\"];\n    system.registerInvader(this);\n    if (this.data.useMaterial) {\n      const mesh = findInvaderMesh(this.el);\n      if (mesh) {\n        this.targetMesh = mesh;\n      }\n    }\n    this.invading = false;\n  },\n\n  update() {\n    this.radiusSquared = this.data.radius * this.data.radius;\n    this.updateDebug();\n  },\n\n  updateDebug() {\n    const system = this.el.sceneEl.systems[\"personal-space-bubble\"];\n    if (system.data.debug || this.data.debug) {\n      !this.el.object3DMap[DEBUG_OBJ] && this.el.setObject3D(DEBUG_OBJ, createSphereGizmo(this.data.radius));\n    } else if (this.el.object3DMap[DEBUG_OBJ]) {\n      this.el.removeObject3D(DEBUG_OBJ);\n    }\n  },\n\n  remove() {\n    this.el.sceneEl.systems[\"personal-space-bubble\"].unregisterInvader(this);\n  },\n\n  setInvading(invading) {\n    if (this.invading === invading) return;\n\n    if (this.targetMesh && this.targetMesh.material) {\n      forEachMaterial(this.targetMesh, material => {\n        material.opacity = invading ? this.data.invadingOpacity : 1;\n        material.transparent = invading;\n      });\n    } else {\n      this.el.object3D.visible = !invading;\n    }\n    this.invading = invading;\n  }\n});\n\n/**\n * Represents a personal space bubble on an entity.\n * @namespace avatar/personal-space-bubble\n * @component personal-space-bubble\n */\nAFRAME.registerComponent(\"personal-space-bubble\", {\n  schema: {\n    radius: { type: \"number\", default: 0.8 },\n    debug: { default: false }\n  },\n  init() {\n    this.system.registerBubble(this);\n  },\n\n  update() {\n    this.radiusSquared = this.data.radius * this.data.radius;\n    this.updateDebug();\n  },\n\n  updateDebug() {\n    if (!isDebug) return;\n\n    if (this.system.data.debug || this.data.debug) {\n      !this.el.object3DMap[DEBUG_OBJ] && this.el.setObject3D(DEBUG_OBJ, createSphereGizmo(this.data.radius));\n    } else if (this.el.object3DMap[DEBUG_OBJ]) {\n      this.el.removeObject3D(DEBUG_OBJ);\n    }\n  },\n\n  remove() {\n    this.system.unregisterBubble(this);\n  }\n});\n","import { waitForDOMContentLoaded } from \"../utils/async-utils\";\n\nconst CAMERA_UPDATE_FRAME_DELAY = 10; // Update one camera every N'th frame\n\n// Used for tracking and managing camera tools in the scene\nAFRAME.registerSystem(\"camera-tools\", {\n  init() {\n    this.cameraEls = [];\n    this.cameraUpdateCount = 0;\n    this.ticks = 0;\n\n    waitForDOMContentLoaded().then(() => {\n      const playerModelEl = document.querySelector(\"#player-rig .model\");\n      playerModelEl.addEventListener(\"model-loading\", () => (this.playerHead = null));\n      playerModelEl.addEventListener(\"model-loaded\", this.updatePlayerHead.bind(this));\n      this.updatePlayerHead();\n    });\n  },\n\n  updatePlayerHead() {\n    const headEl = document.getElementById(\"player-head\");\n    this.playerHead = headEl && headEl.object3D;\n  },\n\n  register(el) {\n    this.cameraEls.push(el);\n    el.addEventListener(\"ownership-changed\", this._onOwnershipChange);\n    delete this.myCamera;\n  },\n\n  deregister(el) {\n    this.cameraEls = this.cameraEls.filter(c => c !== el);\n    el.removeEventListener(\"ownership-changed\", this._onOwnershipChange);\n    delete this.myCamera;\n  },\n\n  getMyCamera() {\n    if (this.myCamera !== undefined) return this.myCamera;\n    this.myCamera = this.cameraEls.find(NAF.utils.isMine) || null;\n    return this.myCamera;\n  },\n\n  _onOwnershipChange() {\n    this.myCamera = null;\n  },\n\n  tick() {\n    this.ticks++;\n\n    // We update at most one camera viewfinder per frame.\n    if (this.ticks % CAMERA_UPDATE_FRAME_DELAY === 0) {\n      if (this.cameraEls.length == 0) return;\n\n      this.cameraUpdateCount++;\n      this.cameraEls[this.cameraUpdateCount % this.cameraEls.length].components[\"camera-tool\"].updateViewfinder();\n    }\n  }\n});\n","import { paths } from \"../paths\";\n\n// TODO: Where do these values (500, 10, 2) come from?\nconst modeMod = {\n  [WheelEvent.DOM_DELTA_PIXEL]: 500,\n  [WheelEvent.DOM_DELTA_LINE]: 10,\n  [WheelEvent.DOM_DELTA_PAGE]: 2\n};\n\nconst isInModal = (() => {\n  let uiRoot = null;\n\n  return function() {\n    if (!uiRoot) {\n      uiRoot = document.querySelector(\".ui-root\");\n    }\n\n    return uiRoot && uiRoot.classList.contains(\"in-modal-or-overlay\");\n  };\n})();\n\nexport class MouseDevice {\n  constructor() {\n    this.events = [];\n    this.coords = [0, 0]; // normalized screenspace coordinates in [(-1, 1), (-1, 1)]\n    this.movementXY = [0, 0]; // deltas\n    this.buttonLeft = false;\n    this.buttonRight = false;\n    this.wheel = 0; // delta\n\n    const queueEvent = this.events.push.bind(this.events);\n    const canvas = document.querySelector(\"canvas\");\n    [\"mousedown\", \"wheel\"].map(x => canvas.addEventListener(x, queueEvent));\n    [\"mousemove\", \"mouseup\"].map(x => window.addEventListener(x, queueEvent));\n\n    document.addEventListener(\"wheel\", e => {\n      // Do not capture wheel events if they are being sent to an modal/overlay\n      if (!isInModal()) {\n        e.preventDefault();\n      }\n    });\n  }\n\n  process(event) {\n    if (event.type === \"wheel\") {\n      this.wheel += (event.deltaX + event.deltaY) / modeMod[event.deltaMode];\n      return true;\n    }\n\n    const left = event.button === 0;\n    const right = event.button === 2;\n    this.coords[0] = (event.clientX / window.innerWidth) * 2 - 1;\n    this.coords[1] = -(event.clientY / window.innerHeight) * 2 + 1;\n    this.movementXY[0] += event.movementX;\n    this.movementXY[1] += event.movementY;\n    if (event.type === \"mousedown\" && left) {\n      this.mouseDownLeftThisFrame = true;\n      this.buttonLeft = true;\n    } else if (event.type === \"mousedown\" && right) {\n      this.mouseDownRightThisFrame = true;\n      this.buttonRight = true;\n    } else if (event.type === \"mouseup\" && left) {\n      if (this.mouseDownLeftThisFrame) {\n        return false;\n      }\n      this.buttonLeft = false;\n    } else if (event.type === \"mouseup\" && right) {\n      if (this.mouseDownRightThisFrame) {\n        return false;\n      }\n      this.buttonRight = false;\n    }\n    return true;\n  }\n\n  write(frame) {\n    this.movementXY[0] = 0; // deltas\n    this.movementXY[1] = 0; // deltas\n    this.wheel = 0; // delta\n\n    this.didStopProcessingEarly = false;\n    this.mouseDownLeftThisFrame = false;\n    this.mouseDownRightThisFrame = false;\n\n    for (let i = 0; i < this.events.length; i++) {\n      const event = this.events[i];\n      if (!this.process(event)) {\n        this.didStopProcessingEarly = true;\n        this.events.splice(0, i);\n        break;\n      }\n    }\n\n    if (!this.didStopProcessingEarly) {\n      this.events.length = 0;\n    }\n\n    frame.setVector2(paths.device.mouse.coords, this.coords[0], this.coords[1]);\n    frame.setVector2(paths.device.mouse.movementXY, this.movementXY[0], this.movementXY[1]);\n    frame.setValueType(paths.device.mouse.buttonLeft, this.buttonLeft);\n    frame.setValueType(paths.device.mouse.buttonRight, this.buttonRight);\n    frame.setValueType(paths.device.mouse.wheel, this.wheel);\n  }\n}\n\nwindow.oncontextmenu = e => {\n  if (!isInModal()) {\n    e.preventDefault();\n  }\n};\n","// You might prefer to use this over a Set because iterating over a set allocates memory\nexport function ArrayBackedSet(initialItems) {\n  return {\n    items: initialItems || [],\n    has(item) {\n      return this.items.indexOf(item) !== -1;\n    },\n    add(item) {\n      if (!this.has(item)) {\n        this.items.push(item);\n      }\n    },\n    delete(item) {\n      const index = this.items.indexOf(item);\n      if (index !== -1) {\n        this.items[index] = this.items[this.items.length - 1];\n        this.items.pop();\n      }\n    },\n    clear() {\n      this.items.length = 0;\n    }\n  };\n}\n","import { paths } from \"../paths\";\nimport { ArrayBackedSet } from \"../array-backed-set\";\nexport class KeyboardDevice {\n  constructor() {\n    this.seenKeys = new ArrayBackedSet();\n    this.keys = {};\n    this.events = [];\n\n    [\"keydown\", \"keyup\"].map(x =>\n      document.addEventListener(x, e => {\n        if (!e.key) return;\n        this.events.push(e);\n\n        // Block browser hotkeys for chat command, media browser and freeze\n        if (\n          (e.type === \"keydown\" &&\n            e.key === \"/\" &&\n            ![\"TEXTAREA\", \"INPUT\"].includes(document.activeElement && document.activeElement.nodeName) &&\n            !(document.activeElement && document.activeElement.contentEditable === \"true\")) ||\n          (e.ctrlKey &&\n            (e.key === \"1\" ||\n              e.key === \"2\" ||\n              e.key === \"3\" ||\n              e.key === \"4\" ||\n              e.key === \"5\" ||\n              e.key === \"6\" ||\n              e.key === \"7\" ||\n              e.key === \"8\" ||\n              e.key === \"9\" ||\n              e.key === \"0\")) ||\n          e.key === \"Tab\"\n        ) {\n          e.preventDefault();\n          return false;\n        }\n      })\n    );\n    [\"blur\"].map(x => window.addEventListener(x, this.events.push.bind(this.events)));\n  }\n\n  write(frame) {\n    for (let i = 0; i < this.events.length; i++) {\n      const event = this.events[i];\n      if (event.type === \"blur\") {\n        this.keys = {};\n        this.seenKeys.clear();\n      } else {\n        const key = event.key.toLowerCase();\n        this.keys[key] = event.type === \"keydown\";\n        this.seenKeys.add(key);\n      }\n    }\n\n    this.events.length = 0;\n\n    for (let i = 0; i < this.seenKeys.items.length; i++) {\n      const key = this.seenKeys.items[i];\n      const path = paths.device.keyboard.key(key);\n      frame.setValueType(path, this.keys[key]);\n    }\n  }\n}\n","import { paths } from \"../paths\";\n\nexport class HudDevice {\n  constructor() {\n    this.events = [];\n    document.querySelector(\"a-scene\").addEventListener(\"penButtonPressed\", this.events.push.bind(this.events));\n  }\n\n  write(frame) {\n    frame.setValueType(paths.device.hud.penButton, this.events.length !== 0);\n    while (this.events.length) {\n      this.events.pop();\n    }\n  }\n}\n","import { paths } from \"../paths\";\n\nexport class XboxControllerDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n    this.buttonMap = [\n      { name: \"a\", buttonId: 0 },\n      { name: \"b\", buttonId: 1 },\n      { name: \"x\", buttonId: 2 },\n      { name: \"y\", buttonId: 3 },\n      { name: \"leftBumper\", buttonId: 4 },\n      { name: \"rightBumper\", buttonId: 5 },\n      { name: \"leftTrigger\", buttonId: 6 },\n      { name: \"rightTrigger\", buttonId: 7 },\n      { name: \"back\", buttonId: 8 },\n      { name: \"start\", buttonId: 9 },\n      { name: \"leftJoystick\", buttonId: 10 },\n      { name: \"rightJoystick\", buttonId: 11 },\n      { name: \"dpadUp\", buttonId: 12 },\n      { name: \"dpadDown\", buttonId: 13 },\n      { name: \"dpadLeft\", buttonId: 14 },\n      { name: \"dpadRight\", buttonId: 15 }\n    ];\n    this.axisMap = [\n      { name: \"leftJoystickHorizontal\", axisId: 0 },\n      { name: \"leftJoystickVertical\", axisId: 1 },\n      { name: \"rightJoystickHorizontal\", axisId: 2 },\n      { name: \"rightJoystickVertical\", axisId: 3 }\n    ];\n  }\n\n  write(frame) {\n    this.gamepad = navigator.getGamepads()[this.gamepad.index];\n    if (this.gamepad.connected) {\n      const xboxPaths = paths.device.xbox;\n      this.buttonMap.forEach(b => {\n        const path = xboxPaths.button(b.name);\n        const button = this.gamepad.buttons[b.buttonId];\n        frame.setValueType(path.pressed, !!button.pressed);\n        frame.setValueType(path.touched, !!button.touched);\n        frame.setValueType(path.value, button.value);\n      });\n      frame.setValueType(xboxPaths.axesSum, 0);\n      this.axisMap.forEach(axis => {\n        frame.setValueType(xboxPaths.axis(axis.name), this.gamepad.axes[axis.axisId]);\n        frame.setValueType(xboxPaths.axesSum, frame.get(xboxPaths.axesSum) + Math.abs(this.gamepad.axes[axis.axisId]));\n      });\n\n      if (this.gamepad.hapticActuators && this.gamepad.hapticActuators[0]) {\n        frame.setValueType(paths.haptics.actuators[this.gamepad.hand], this.gamepad.hapticActuators[0]);\n      }\n    }\n  }\n}\n","const THREE = typeof window !== \"undefined\" && window.THREE;\nconst Vector3 = (THREE && THREE.Vector3) || function() {};\nconst Quaternion = (THREE && THREE.Quaternion) || function() {};\nconst forward = typeof window !== \"undefined\" && window.THREE && new THREE.Vector3(0, 0, -1);\nexport function Pose() {\n  return {\n    position: new Vector3(),\n    direction: new Vector3(),\n    orientation: new Quaternion(),\n    fromOriginAndDirection: function(origin, direction) {\n      this.position = origin;\n      this.direction = direction;\n      this.orientation = this.orientation.setFromUnitVectors(forward, direction);\n      return this;\n    },\n    fromCameraProjection: function(camera, normalizedX, normalizedY) {\n      this.position.setFromMatrixPosition(camera.matrixWorld);\n      this.direction\n        .set(normalizedX, normalizedY, 0.5)\n        .unproject(camera)\n        .sub(this.position)\n        .normalize();\n      this.fromOriginAndDirection(this.position, this.direction);\n      return this;\n    },\n    copy: function(pose) {\n      this.position.copy(pose.position);\n      this.direction.copy(pose.direction);\n      this.orientation.copy(pose.orientation);\n    }\n  };\n}\n","// Vector from eyes to elbow (divided by user height).\nconst EYES_TO_ELBOW = { x: 0.175, y: -0.3, z: -0.03 };\n// Vector from eyes to elbow (divided by user height).\nconst FOREARM = { x: 0, y: 0, z: -0.175 };\n\nexport const applyArmModel = (function() {\n  const controllerEuler = new THREE.Euler();\n  const deltaControllerPosition = new THREE.Vector3();\n  const controllerQuaternion = new THREE.Quaternion();\n  const controllerPosition = new THREE.Vector3();\n  return function applyArmModel(gamepadPose, hand, headObject3D, userHeight) {\n    headObject3D.updateMatrices();\n    controllerPosition.copy(headObject3D.position);\n    controllerPosition.y = controllerPosition.y - userHeight;\n    deltaControllerPosition.set(\n      EYES_TO_ELBOW.x * (hand === \"left\" ? -1 : hand === \"right\" ? 1 : 0),\n      EYES_TO_ELBOW.y,\n      EYES_TO_ELBOW.z\n    );\n    deltaControllerPosition.multiplyScalar(userHeight);\n    deltaControllerPosition.applyAxisAngle(headObject3D.up, headObject3D.rotation.y);\n    controllerPosition.add(deltaControllerPosition);\n    deltaControllerPosition.set(FOREARM.x, FOREARM.y, FOREARM.z);\n    deltaControllerPosition.multiplyScalar(userHeight);\n    controllerQuaternion.fromArray(gamepadPose.orientation);\n    controllerEuler.setFromQuaternion(controllerQuaternion);\n    controllerEuler.set(controllerEuler.x, controllerEuler.y, 0);\n    deltaControllerPosition.applyEuler(controllerEuler);\n    controllerPosition.add(deltaControllerPosition);\n    return controllerPosition;\n  };\n})();\n","export const copySittingToStandingTransform = function copySittingToStandingTransform(matrix) {\n  navigator.getVRDisplays &&\n    navigator.getVRDisplays().then(displays => {\n      if (displays[0] && displays[0].stageParameters && displays[0].stageParameters.sittingToStandingTransform) {\n        matrix.fromArray(displays[0].stageParameters.sittingToStandingTransform);\n      }\n    });\n};\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { applyArmModel } from \"../arm-model.js\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\n\nconst TOUCHPAD = paths.device.oculusgo.touchpad;\nconst TRIGGER = paths.device.oculusgo.trigger;\n\nexport class OculusGoControllerDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n    this.rayObjectRotation = new THREE.Quaternion();\n    this.pose = new Pose();\n    this.q = new THREE.Quaternion();\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n    this.matrix = new THREE.Matrix4();\n    this.orientation = new THREE.Quaternion();\n\n    // TODO ideally we should just be getting pose from the gamepad\n    // TODO if controller is set to left hand, we still use right hand query here\n    // because otherwise things break.\n    this.rayObject = document.querySelector(\"#player-right-controller\").object3D;\n    this.headObject3D = document.querySelector(\"#player-camera\").object3D;\n    navigator.getGamepads();\n  }\n\n  write(frame) {\n    // Have to call navigator.getGamepads() in order for the gamepad object to update.\n    navigator.getGamepads();\n    if (this.gamepad.connected) {\n      frame.setValueType(TOUCHPAD.axisX, this.gamepad.axes[0]);\n      frame.setValueType(TOUCHPAD.axisY, this.gamepad.axes[1]);\n      frame.setValueType(TOUCHPAD.pressed, this.gamepad.buttons[0].pressed);\n      frame.setValueType(TOUCHPAD.touched, this.gamepad.buttons[0].touched);\n      frame.setValueType(TOUCHPAD.value, this.gamepad.buttons[0].value);\n      frame.setValueType(TRIGGER.pressed, this.gamepad.buttons[1].pressed);\n      frame.setValueType(TRIGGER.touched, this.gamepad.buttons[1].touched);\n      frame.setValueType(TRIGGER.value, this.gamepad.buttons[1].value);\n\n      this.rayObject.updateMatrices();\n      this.rayObject.getWorldQuaternion(this.q);\n      frame.setValueType(paths.actions.rayObjectRotation, this.q);\n      const rayMatrixWorld = this.rayObject.matrixWorld;\n      this.rayObjectRotation.setFromRotationMatrix(rayMatrixWorld);\n      this.pose.position.setFromMatrixPosition(rayMatrixWorld);\n      this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n      this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n      frame.setPose(paths.device.oculusgo.pose, this.pose);\n\n      if (this.gamepad.pose.orientation) {\n        // TODO if controller is set to left hand, we still draw right hand until\n        // bindings are overhauled to handle primary/secondary hands.\n        frame.setMatrix4(\n          paths.device.oculusgo.matrix,\n          this.matrix\n            .compose(\n              applyArmModel(this.gamepad.pose, this.gamepad.hand, this.headObject3D, 1.6),\n              this.orientation.fromArray(this.gamepad.pose.orientation),\n              ONES\n            )\n            .premultiply(this.sittingToStandingMatrix)\n        );\n      }\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { applyArmModel } from \"../arm-model.js\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\n\nconst TOUCHPAD = paths.device.gearVRController.button(\"touchpad\");\nconst TRIGGER = paths.device.gearVRController.button(\"trigger\");\nconst TOUCHPAD_X = paths.device.gearVRController.axis(\"touchpadX\");\nconst TOUCHPAD_Y = paths.device.gearVRController.axis(\"touchpadY\");\n\nexport class GearVRControllerDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n    this.buttonMap = [{ name: \"touchpad\", buttonId: 0 }, { name: \"trigger\", buttonId: 1 }];\n    this.axisMap = [{ name: \"touchpadX\", axisId: 0 }, { name: \"touchpadY\", axisId: 1 }];\n\n    this.rayObjectRotation = new THREE.Quaternion();\n    this.selector = `#player-${gamepad.hand}-controller`;\n    this.pose = new Pose();\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n\n    this.matrix = new THREE.Matrix4();\n    this.orientation = new THREE.Quaternion();\n  }\n\n  write(frame) {\n    // Chrome requires a call to getGamepads() for the gamepad state to update.\n    navigator.getGamepads();\n    if (this.gamepad.connected) {\n      const touchpad = this.gamepad.buttons[0];\n      frame.setValueType(TOUCHPAD.pressed, !!touchpad.pressed);\n      frame.setValueType(TOUCHPAD.touched, !!touchpad.touched);\n      frame.setValueType(TOUCHPAD.value, !!touchpad.value);\n\n      const trigger = this.gamepad.buttons[1];\n      frame.setValueType(TRIGGER.pressed, !!trigger.pressed);\n      frame.setValueType(TRIGGER.touched, !!trigger.touched);\n      frame.setValueType(TRIGGER.value, !!trigger.value);\n\n      frame.setValueType(TOUCHPAD_X, this.gamepad.axes[0]);\n      frame.setValueType(TOUCHPAD_Y, this.gamepad.axes[1]);\n\n      // TODO we should just be getting pose from the gamepad\n      if (!this.rayObject) {\n        this.rayObject = document.querySelector(this.selector).object3D;\n      }\n      this.rayObject.updateMatrixWorld();\n      this.rayObjectRotation.setFromRotationMatrix(this.rayObject.matrixWorld);\n      this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\n      this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n      this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n      frame.setPose(paths.device.gearVRController.pose, this.pose);\n      this.headObject3D = this.headObject3D || document.querySelector(\"#player-camera\").object3D;\n      if (this.gamepad.pose.orientation) {\n        frame.setMatrix4(\n          paths.device.gearVRController.matrix,\n          this.matrix\n            .compose(\n              applyArmModel(this.gamepad.pose, this.gamepad.hand, this.headObject3D, 1.6),\n              this.orientation.fromArray(this.gamepad.pose.orientation),\n              ONES\n            )\n            .premultiply(this.sittingToStandingMatrix)\n        );\n      }\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\n\nexport const leftOculusTouchButtonMap = [\n  { name: \"thumbStick\", buttonId: 0 },\n  { name: \"trigger\", buttonId: 1 },\n  { name: \"grip\", buttonId: 2 },\n  { name: \"x\", buttonId: 3 },\n  { name: \"y\", buttonId: 4 }\n];\nexport const rightOculusTouchButtonMap = [\n  { name: \"thumbStick\", buttonId: 0 },\n  { name: \"trigger\", buttonId: 1 },\n  { name: \"grip\", buttonId: 2 },\n  { name: \"a\", buttonId: 3 },\n  { name: \"b\", buttonId: 4 }\n];\n\nconst LEFT_HAND_OFFSET = new THREE.Matrix4().makeTranslation(-0.025, -0.03, 0.1);\nconst RIGHT_HAND_OFFSET = new THREE.Matrix4().makeTranslation(0.025, -0.03, 0.1);\n\nexport class OculusTouchControllerDevice {\n  constructor(gamepad) {\n    this.rayObjectRotation = new THREE.Quaternion();\n\n    // wake the gamepad api up. otherwise it does not report touch controllers.\n    // in chrome it still won't unless you enter vr.\n    navigator.getVRDisplays();\n\n    const buttonMaps = {\n      left: leftOculusTouchButtonMap,\n      right: rightOculusTouchButtonMap\n    };\n\n    const devicePaths = {\n      left: paths.device.leftOculusTouch,\n      right: paths.device.rightOculusTouch\n    };\n\n    this.gamepad = gamepad;\n    this.pose = new Pose();\n    this.buttonMap = buttonMaps[gamepad.hand];\n    this.axisMap = [{ name: \"joyX\", axisId: 0 }, { name: \"joyY\", axisId: 1 }];\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n    this.matrix = new THREE.Matrix4();\n    this.path = devicePaths[gamepad.hand];\n    this.selector = `#player-${gamepad.hand}-controller`;\n\n    this.position = new THREE.Vector3();\n    this.orientation = new THREE.Quaternion();\n    this.handOffset = this.gamepad.hand === \"left\" ? LEFT_HAND_OFFSET : RIGHT_HAND_OFFSET;\n  }\n\n  write(frame) {\n    if (!this.gamepad) return;\n    this.gamepad = navigator.getGamepads()[this.gamepad.index];\n    if (!this.gamepad || !this.gamepad.connected) return;\n\n    this.buttonMap.forEach(b => {\n      const path = this.path.button(b.name);\n      const button = this.gamepad.buttons[b.buttonId];\n      frame.setValueType(path.pressed, !!button.pressed);\n      frame.setValueType(path.touched, !!button.touched);\n      frame.setValueType(path.value, button.value);\n    });\n    frame.setValueType(this.path.axesSum, 0);\n    this.axisMap.forEach(axis => {\n      frame.setValueType(this.path.axis(axis.name), this.gamepad.axes[axis.axisId]);\n      frame.setValueType(this.path.axesSum, frame.get(this.path.axesSum) + Math.abs(this.gamepad.axes[axis.axisId]));\n    });\n\n    this.rayObject = this.rayObject || document.querySelector(this.selector).object3D;\n    this.rayObject.updateMatrixWorld();\n    this.rayObjectRotation.setFromRotationMatrix(this.rayObject.matrixWorld);\n    this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\n    this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n    this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n    frame.setPose(this.path.pose, this.pose);\n    if (this.gamepad.pose.position && this.gamepad.pose.orientation) {\n      frame.setMatrix4(\n        this.path.matrix,\n        this.matrix\n          .compose(\n            this.position.fromArray(this.gamepad.pose.position),\n            this.orientation.fromArray(this.gamepad.pose.orientation),\n            ONES\n          )\n          .premultiply(this.sittingToStandingMatrix)\n          .multiply(this.handOffset)\n      );\n    }\n    if (this.gamepad.hapticActuators && this.gamepad.hapticActuators[0]) {\n      frame.setValueType(paths.haptics.actuators[this.gamepad.hand], this.gamepad.hapticActuators[0]);\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { applyArmModel } from \"../arm-model\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\nconst HAND_OFFSET = new THREE.Matrix4().makeTranslation(0, 0, -0.04);\n\nconst TOUCHPAD = paths.device.daydream.button(\"touchpad\");\nconst TOUCHPAD_X = paths.device.daydream.axis(\"touchpadX\");\nconst TOUCHPAD_Y = paths.device.daydream.axis(\"touchpadY\");\nconst POSE = paths.device.daydream.pose;\nconst MATRIX = paths.device.daydream.matrix;\n\nexport class DaydreamControllerDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n\n    this.rayObjectRotation = new THREE.Quaternion();\n    this.selector = `#player-${gamepad.hand || \"right\"}-controller`;\n    this.pose = new Pose();\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n    this.matrix = new THREE.Matrix4();\n    this.orientation = new THREE.Quaternion();\n  }\n\n  write(frame) {\n    this.gamepad = navigator.getGamepads()[0];\n    if (this.gamepad && this.gamepad.connected) {\n      const button = this.gamepad.buttons[0];\n      frame.setValueType(TOUCHPAD.pressed, !!button.pressed);\n      frame.setValueType(TOUCHPAD.touched, !!button.touched);\n      frame.setValueType(TOUCHPAD.value, !!button.value);\n\n      frame.setValueType(TOUCHPAD_X, this.gamepad.axes[0]);\n      frame.setValueType(TOUCHPAD_Y, this.gamepad.axes[1]);\n\n      // TODO ideally we should just be getting pose from the gamepad\n      if (!this.rayObject) {\n        this.rayObject = document.querySelector(this.selector).object3D;\n      }\n      this.rayObject.updateMatrixWorld();\n      this.rayObjectRotation.setFromRotationMatrix(this.rayObject.matrixWorld);\n      this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\n      this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n      this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n      frame.setPose(POSE, this.pose);\n\n      this.headObject3D = this.headObject3D || document.querySelector(\"#player-camera\").object3D;\n\n      if (this.gamepad.pose.orientation) {\n        frame.setMatrix4(\n          MATRIX,\n          this.matrix\n            .compose(\n              applyArmModel(this.gamepad.pose, this.gamepad.hand, this.headObject3D, 1.6),\n              this.orientation.fromArray(this.gamepad.pose.orientation),\n              ONES\n            )\n            .premultiply(this.sittingToStandingMatrix)\n            .multiply(HAND_OFFSET)\n        );\n      }\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\n\nconst ONES = new THREE.Vector3(1, 1, 1);\nconst HAND_OFFSET = new THREE.Matrix4().compose(\n  new THREE.Vector3(0, 0, 0.13),\n  new THREE.Quaternion().setFromEuler(new THREE.Euler(-40 * THREE.Math.DEG2RAD, 0, 0)),\n  new THREE.Vector3(1, 1, 1)\n);\nconst RAY_ROTATION = new THREE.Quaternion().setFromAxisAngle(new THREE.Vector3(1, 0, 0), -Math.PI / 12);\n\nexport class ViveControllerDevice {\n  constructor(gamepad) {\n    // wake the gamepad api up. otherwise it does not report touch controllers.\n    // in chrome it still won't unless you enter vr.\n    navigator.getVRDisplays();\n    this.gamepad = gamepad;\n\n    if (this.gamepad.id === \"HTC Vive Focus Plus Controller\") {\n      this.buttonMap = [\n        { name: \"touchpad\", buttonId: 0 },\n        { name: \"trigger\", buttonId: 1 },\n        { name: \"grip\", buttonId: 2 }\n      ];\n    } else {\n      if (gamepad.axes.length === 2) {\n        this.isViveWand = true;\n      }\n      this.buttonMap = [\n        { name: \"touchpad\", buttonId: 0 },\n        { name: \"trigger\", buttonId: 1 },\n        { name: \"grip\", buttonId: 2 },\n        { name: \"top\", buttonId: 3 }\n      ];\n    }\n    this.axisMap = [\n      { name: \"touchX\", axisId: 0 },\n      { name: \"touchY\", axisId: 1 },\n      { name: \"joyX\", axisId: 2 },\n      { name: \"joyY\", axisId: 3 }\n    ];\n\n    this.pose = new Pose();\n    this.rayObjectRotation = new THREE.Quaternion();\n    this.path = paths.device.vive[gamepad.hand || \"right\"];\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n\n    this.matrix = new THREE.Matrix4();\n    this.position = new THREE.Vector3();\n    this.orientation = new THREE.Quaternion();\n  }\n\n  write(frame) {\n    const gamepads = navigator.getGamepads();\n    if (gamepads.length < this.gamepad.index + 1) {\n      //workaround for: https://bugzilla.mozilla.org/show_bug.cgi?id=1568076\n      return;\n    }\n    this.gamepad = gamepads[this.gamepad.index];\n    if (!this.gamepad.connected) return;\n\n    this.buttonMap.forEach(b => {\n      const path = this.path.button(b.name);\n      const button = this.gamepad.buttons[b.buttonId];\n      frame.setValueType(path.pressed, !!button.pressed);\n      frame.setValueType(path.touched, !!button.touched);\n      frame.setValueType(path.value, button.value);\n    });\n    frame.setValueType(this.path.axesSum, 0);\n    this.axisMap.forEach(axis => {\n      frame.setValueType(this.path.axis(axis.name), this.gamepad.axes[axis.axisId]);\n      frame.setValueType(this.path.axesSum, frame.get(this.path.axesSum) + Math.abs(this.gamepad.axes[axis.axisId]));\n    });\n\n    if (!this.selector) {\n      if (this.gamepad.hand) {\n        this.path = paths.device.vive[this.gamepad.hand];\n        this.selector = `#player-${this.gamepad.hand}-controller`;\n        console.warn(\"gamepad hand eventually specified\");\n      } else {\n        return;\n      }\n    }\n    const el = document.querySelector(this.selector);\n    const rayObject = el.object3D;\n    rayObject.updateMatrixWorld();\n    this.rayObjectRotation.setFromRotationMatrix(rayObject.matrixWorld);\n    this.pose.position.setFromMatrixPosition(rayObject.matrixWorld);\n    this.pose.direction\n      .set(0, 0, -1)\n      .applyQuaternion(RAY_ROTATION)\n      .applyQuaternion(this.rayObjectRotation);\n    this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n    frame.setPose(this.path.pose, this.pose);\n\n    if (this.gamepad.pose.position && this.gamepad.pose.orientation) {\n      frame.setMatrix4(\n        this.path.matrix,\n        this.matrix\n          .compose(\n            this.position.fromArray(this.gamepad.pose.position),\n            this.orientation.fromArray(this.gamepad.pose.orientation),\n            ONES\n          )\n          .premultiply(this.sittingToStandingMatrix)\n          .multiply(HAND_OFFSET)\n      );\n    }\n\n    if (this.gamepad.hapticActuators && this.gamepad.hapticActuators[0]) {\n      frame.setValueType(paths.haptics.actuators[this.gamepad.hand], this.gamepad.hapticActuators[0]);\n    }\n  }\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { copySittingToStandingTransform } from \"./copy-sitting-to-standing-transform\";\nconst ONES = new THREE.Vector3(1, 1, 1);\nconst HAND_OFFSET = new THREE.Matrix4().compose(\n  new THREE.Vector3(0, -0.017, 0.13),\n  new THREE.Quaternion().setFromEuler(new THREE.Euler(-40 * THREE.Math.DEG2RAD, 0, 0)),\n  new THREE.Vector3(1, 1, 1)\n);\n\nexport class WindowsMixedRealityControllerDevice {\n  constructor(gamepad) {\n    this.rayObject = null;\n    this.rayObjectRotation = new THREE.Quaternion();\n\n    // wake the gamepad api up. otherwise it does not report touch controllers.\n    // in chrome it still won't unless you enter vr.\n    navigator.getVRDisplays();\n\n    this.gamepad = gamepad;\n    this.pose = new Pose();\n\n    if (gamepad.hand) {\n      this.selector = `#player-${gamepad.hand}-controller`;\n    }\n\n    this.sittingToStandingMatrix = new THREE.Matrix4().makeTranslation(0, 1.6, 0);\n    copySittingToStandingTransform(this.sittingToStandingMatrix);\n    this.matrix = new THREE.Matrix4();\n    this.position = new THREE.Vector3();\n    this.orientation = new THREE.Quaternion();\n  }\n  write(frame) {\n    this.gamepad = navigator.getGamepads()[this.gamepad.index];\n    if (!this.gamepad.connected) return;\n\n    const path = paths.device.wmr[this.gamepad.hand || \"right\"];\n\n    frame.setValueType(path.touchpad.pressed, this.gamepad.buttons[0].pressed);\n    frame.setValueType(path.touchpad.touched, this.gamepad.buttons[0].touched);\n    frame.setValueType(path.touchpad.value, this.gamepad.buttons[0].value);\n\n    frame.setValueType(path.trigger.pressed, this.gamepad.buttons[1].pressed);\n    frame.setValueType(path.trigger.touched, this.gamepad.buttons[1].touched);\n    frame.setValueType(path.trigger.value, this.gamepad.buttons[1].value);\n\n    frame.setValueType(path.grip.pressed, this.gamepad.buttons[2].pressed);\n    frame.setValueType(path.grip.touched, this.gamepad.buttons[2].touched);\n    frame.setValueType(path.grip.value, this.gamepad.buttons[2].value);\n\n    frame.setValueType(path.menu.pressed, this.gamepad.buttons[3].pressed);\n    frame.setValueType(path.menu.touched, this.gamepad.buttons[3].touched);\n    frame.setValueType(path.menu.value, this.gamepad.buttons[3].value);\n\n    frame.setValueType(path.touchpad.axisX, this.gamepad.axes[0]);\n    frame.setValueType(path.touchpad.axisY, this.gamepad.axes[1]);\n    frame.setValueType(path.joystick.axisX, this.gamepad.axes[2]);\n    frame.setValueType(path.joystick.axisY, this.gamepad.axes[3]);\n\n    if (!this.selector) {\n      if (!this.gamepad.hand) return;\n      this.selector = `#player-${this.gamepad.hand}-controller`;\n    }\n\n    this.rayObject = this.rayObject || document.querySelector(this.selector).object3D;\n    this.rayObject.updateMatrixWorld();\n    this.rayObjectRotation.setFromRotationMatrix(this.rayObject.matrixWorld);\n\n    this.pose.position.setFromMatrixPosition(this.rayObject.matrixWorld);\n    this.pose.direction.set(0, 0, -1).applyQuaternion(this.rayObjectRotation);\n    this.pose.fromOriginAndDirection(this.pose.position, this.pose.direction);\n    frame.setPose(path.pose, this.pose);\n\n    if (this.gamepad.pose.position && this.gamepad.pose.orientation) {\n      frame.setMatrix4(\n        path.matrix,\n        this.matrix\n          .compose(\n            this.position.fromArray(this.gamepad.pose.position),\n            this.orientation.fromArray(this.gamepad.pose.orientation),\n            ONES\n          )\n          .premultiply(this.sittingToStandingMatrix)\n          .multiply(HAND_OFFSET)\n      );\n    }\n\n    if (this.gamepad.hapticActuators && this.gamepad.hapticActuators[0]) {\n      frame.setValueType(paths.haptics.actuators[this.gamepad.hand], this.gamepad.hapticActuators[0]);\n    }\n  }\n}\n","import { paths } from \"../paths\";\n\nconst TWOPI = Math.PI * 2;\n\nclass CircularBuffer {\n  constructor(length) {\n    this.items = new Array(length).fill(0);\n    this.writePtr = 0;\n  }\n\n  push(item) {\n    this.items[this.writePtr] = item;\n    this.writePtr = (this.writePtr + 1) % this.items.length;\n  }\n}\n\nconst abs = Math.abs;\n// Input: two numbers between [-Math.PI, Math.PI]\n// Output: difference between them, where -Math.PI === Math.PI\nconst difference = (curr, prev) => {\n  const a = curr - prev;\n  const b = curr + TWOPI - prev;\n  const c = curr - (prev + TWOPI);\n  if (abs(a) < abs(b)) {\n    if (abs(a) < abs(c)) {\n      return a;\n    }\n  }\n  if (abs(b) < abs(c)) {\n    return b;\n  }\n\n  return c;\n};\n\nconst average = a => {\n  let sum = 0;\n  for (let i = 0; i < a.length; i++) {\n    const n = a[i];\n    sum += n;\n  }\n  return sum / a.length;\n};\n\nexport class GyroDevice {\n  constructor() {\n    this.hmdEuler = new THREE.Euler();\n    this.hmdQuaternion = new THREE.Quaternion();\n    this.prevX = this.hmdEuler.x;\n    this.prevY = this.hmdEuler.y;\n    this.dXBuffer = new CircularBuffer(6);\n    this.dYBuffer = new CircularBuffer(6);\n    this.hasPolyfill = window.webvrpolyfill;\n    if (this.hasPolyfill) {\n      this.vrDisplay = window.webvrpolyfill.getPolyfillDisplays()[0];\n      this.frameData = new window.webvrpolyfill.constructor.VRFrameData();\n    }\n  }\n\n  write(frame) {\n    if (!this.hasPolyfill) {\n      return;\n    }\n    const hmdEuler = this.hmdEuler;\n    this.vrDisplay.getFrameData(this.frameData);\n    if (this.frameData.pose.orientation !== null) {\n      this.hmdQuaternion.fromArray(this.frameData.pose.orientation);\n      hmdEuler.setFromQuaternion(this.hmdQuaternion, \"YXZ\");\n    }\n\n    // Don't use gyro values when device is lying flat\n    if (hmdEuler.x < -Math.PI * 0.475) return;\n\n    const dX = THREE.Math.RAD2DEG * difference(hmdEuler.x, this.prevX);\n    const dY = THREE.Math.RAD2DEG * difference(hmdEuler.y, this.prevY);\n\n    this.dXBuffer.push(Math.abs(dX) < 0.001 ? 0 : dX);\n    this.dYBuffer.push(Math.abs(dY) < 0.001 ? 0 : dY);\n\n    this.averageDeltaX = average(this.dXBuffer.items);\n    this.averageDeltaY = average(this.dYBuffer.items);\n\n    this.prevX = hmdEuler.x;\n    this.prevY = hmdEuler.y;\n    frame.setValueType(paths.device.gyro.averageDeltaX, this.averageDeltaX);\n    frame.setValueType(paths.device.gyro.averageDeltaY, this.averageDeltaY);\n  }\n}\n","/* global AFRAME Ammo NAF */\nimport { paths } from \"./userinput/paths\";\nimport { SOUND_HOVER_OR_GRAB } from \"./sound-effects-system\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\nimport { canMove } from \"../utils/permissions-utils\";\n\nfunction findHandCollisionTargetForHand(body) {\n  const driver = AFRAME.scenes[0].systems.physics.driver;\n  const numManifolds = driver.dispatcher.getNumManifolds();\n  const handPtr = Ammo.getPointer(body);\n  for (let i = 0; i < numManifolds; i++) {\n    const persistentManifold = driver.dispatcher.getManifoldByIndexInternal(i);\n    const body0ptr = Ammo.getPointer(persistentManifold.getBody0());\n    const body1ptr = Ammo.getPointer(persistentManifold.getBody1());\n    if (handPtr !== body0ptr && handPtr !== body1ptr) {\n      continue;\n    }\n    const numContacts = persistentManifold.getNumContacts();\n    for (let j = 0; j < numContacts; j++) {\n      const manifoldPoint = persistentManifold.getContactPoint(j);\n      if (manifoldPoint.getDistance() <= 10e-6) {\n        const object3D = driver.els.get(handPtr === body0ptr ? body1ptr : body0ptr).object3D;\n        if (object3D.el && object3D.el.components.tags && object3D.el.components.tags.data.isHandCollisionTarget) {\n          return object3D.el;\n        }\n        return null;\n      }\n    }\n  }\n  return null;\n}\n\nconst remoteHoverTargets = new Map();\nexport function findRemoteHoverTarget(object3D) {\n  if (!object3D) return null;\n  const target = remoteHoverTargets.get(object3D);\n  return target || findRemoteHoverTarget(object3D.parent);\n}\nAFRAME.registerComponent(\"is-remote-hover-target\", {\n  init: function() {\n    remoteHoverTargets.set(this.el.object3D, this.el);\n  },\n  remove: function() {\n    remoteHoverTargets.delete(this.el.object3D);\n  }\n});\n\nfunction isUI(el) {\n  return (\n    el && el.components.tags && (el.components.tags.data.singleActionButton || el.components.tags.data.holdableButton)\n  );\n}\n\nAFRAME.registerSystem(\"interaction\", {\n  updateCursorIntersection: function(intersection) {\n    this.rightRemoteHoverTarget = intersection && findRemoteHoverTarget(intersection.object);\n  },\n\n  isHeld(el) {\n    return this.state.leftHand.held === el || this.state.rightHand.held === el || this.state.rightRemote.held === el;\n  },\n\n  init: function() {\n    this.options = {\n      leftHand: {\n        entity: null,\n        grabPath: paths.actions.leftHand.grab,\n        dropPath: paths.actions.leftHand.drop,\n        hoverFn: findHandCollisionTargetForHand\n      },\n      rightHand: {\n        entity: null,\n        grabPath: paths.actions.rightHand.grab,\n        dropPath: paths.actions.rightHand.drop,\n        hoverFn: findHandCollisionTargetForHand\n      },\n      rightRemote: {\n        entity: null,\n        grabPath: paths.actions.cursor.grab,\n        dropPath: paths.actions.cursor.drop,\n        hoverFn: this.getRightRemoteHoverTarget\n      }\n    };\n    this.state = {\n      leftHand: {\n        hovered: null,\n        held: null,\n        spawning: null\n      },\n      rightHand: {\n        hovered: null,\n        held: null,\n        spawning: null\n      },\n      rightRemote: {\n        hovered: null,\n        held: null,\n        spawning: null\n      }\n    };\n    this.previousState = {\n      leftHand: {\n        hovered: null,\n        held: null,\n        spawning: null\n      },\n      rightHand: {\n        hovered: null,\n        held: null,\n        spawning: null\n      },\n      rightRemote: {\n        hovered: null,\n        held: null,\n        spawning: null\n      }\n    };\n\n    waitForDOMContentLoaded().then(() => {\n      this.cursorController = document.querySelector(\"#cursor-controller\");\n      this.options.leftHand.entity = document.querySelector(\"#player-left-controller\");\n      this.options.rightHand.entity = document.querySelector(\"#player-right-controller\");\n      this.options.rightRemote.entity = document.querySelector(\"#cursor\");\n    });\n  },\n\n  getRightRemoteHoverTarget() {\n    return this.rightRemoteHoverTarget;\n  },\n\n  tickInteractor(options, state) {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    if (state.held) {\n      const networked = state.held.components[\"networked\"];\n      const lostOwnership = networked && networked.data && networked.data.owner !== NAF.clientId;\n      if (userinput.get(options.dropPath) || lostOwnership) {\n        state.held = null;\n      }\n    } else {\n      state.hovered = options.hoverFn.call(this, options.entity.body);\n      if (state.hovered) {\n        const entity = state.hovered;\n        const isHoldable = entity.components.tags && entity.components.tags.data.isHoldable;\n        const isFrozen = this.el.is(\"frozen\");\n        const isPinned = entity.components.pinnable && entity.components.pinnable.data.pinned;\n        if (isHoldable && userinput.get(options.grabPath) && (isFrozen || !isPinned) && canMove(entity)) {\n          state.held = entity;\n        }\n      }\n    }\n  },\n\n  tick2(sfx) {\n    if (!this.el.is(\"entered\")) return;\n\n    Object.assign(this.previousState.rightHand, this.state.rightHand);\n    Object.assign(this.previousState.rightRemote, this.state.rightRemote);\n    Object.assign(this.previousState.leftHand, this.state.leftHand);\n\n    this.rightHandTeleporter =\n      this.rightHandTeleporter || document.querySelector(\"#player-right-controller\").components[\"teleporter\"];\n    this.gazeTeleporter = this.gazeTeleporter || document.querySelector(\"#gaze-teleport\").components[\"teleporter\"];\n\n    if (this.options.leftHand.entity.object3D.visible) {\n      this.tickInteractor(this.options.leftHand, this.state.leftHand);\n    }\n    if (this.options.rightHand.entity.object3D.visible && !this.state.rightRemote.held) {\n      this.tickInteractor(this.options.rightHand, this.state.rightHand);\n    }\n\n    if (!this.state.rightHand.held && !this.state.rightHand.hovered) {\n      this.tickInteractor(this.options.rightRemote, this.state.rightRemote);\n    }\n\n    const rightHandInteracting = this.state.rightHand.hovered || this.state.rightHand.held;\n    const rightHandTeleporting = this.rightHandTeleporter.isTeleporting || this.gazeTeleporter.isTeleporting;\n    const rightRemotePenIntersectingInVR =\n      this.el.sceneEl.is(\"vr-mode\") &&\n      this.state.rightRemote.held &&\n      this.state.rightRemote.held.components &&\n      this.state.rightRemote.held.components.tags &&\n      this.state.rightRemote.held.components.tags.data.isPen &&\n      this.state.rightRemote.held.children[0].components.pen.intersection;\n\n    const enableRightRemote = !rightHandInteracting && !rightHandTeleporting && !rightRemotePenIntersectingInVR;\n\n    this.cursorController.components[\"cursor-controller\"].enabled = enableRightRemote;\n\n    if (!enableRightRemote) {\n      this.state.rightRemote.hovered = null;\n    }\n\n    if (\n      this.state.leftHand.held !== this.previousState.leftHand.held ||\n      this.state.rightHand.held !== this.previousState.rightHand.held ||\n      this.state.rightRemote.held !== this.previousState.rightRemote.held ||\n      (isUI(this.state.rightRemote.hovered) &&\n        this.state.rightRemote.hovered !== this.previousState.rightRemote.hovered)\n    ) {\n      sfx.playSoundOneShot(SOUND_HOVER_OR_GRAB);\n    }\n\n    if (this.el.systems.userinput.get(paths.actions.logInteractionState)) {\n      console.log(\n        \"Interaction System State\\nleftHand held\",\n        this.state.leftHand.held,\n        \"\\nleftHand hovered\",\n        this.state.leftHand.hovered,\n        \"\\nrightHand held\",\n        this.state.rightHand.held,\n        \"\\nrightHand hovered\",\n        this.state.rightHand.hovered,\n        \"\\nrightRemote held\",\n        this.state.rightRemote.held,\n        \"\\nrightRemote hovered\",\n        this.state.rightRemote.hovered\n      );\n    }\n  }\n});\n","import { sets } from \"../sets\";\nimport { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { findRemoteHoverTarget } from \"../../interactions\";\nimport { canMove } from \"../../../utils/permissions-utils\";\n\nconst calculateCursorPose = function(camera, coords, origin, direction, cursorPose) {\n  origin.setFromMatrixPosition(camera.matrixWorld);\n  direction\n    .set(coords[0], coords[1], 0.5)\n    .unproject(camera)\n    .sub(origin)\n    .normalize();\n  cursorPose.fromOriginAndDirection(origin, direction);\n  return cursorPose;\n};\n\nexport class AppAwareMouseDevice {\n  constructor() {\n    this.prevButtonLeft = false;\n    this.clickedOnAnything = false;\n    this.cursorPose = new Pose();\n    this.prevCursorPose = new Pose();\n    this.origin = new THREE.Vector3();\n    this.prevOrigin = new THREE.Vector3();\n    this.direction = new THREE.Vector3();\n    this.prevDirection = new THREE.Vector3();\n  }\n\n  write(frame) {\n    this.prevCursorPose.copy(this.cursorPose);\n    this.prevOrigin.copy(this.origin);\n    this.prevDirection.copy(this.prevDirection);\n\n    if (!this.cursorController) {\n      this.cursorController = document.querySelector(\"[cursor-controller]\").components[\"cursor-controller\"];\n    }\n\n    if (!this.camera) {\n      this.camera = document.querySelector(\"#player-camera\").components.camera.camera;\n    }\n\n    const buttonLeft = frame.get(paths.device.mouse.buttonLeft);\n    const buttonRight = frame.get(paths.device.mouse.buttonRight);\n    if (buttonLeft && !this.prevButtonLeft) {\n      const rawIntersections = [];\n      this.cursorController.raycaster.intersectObjects(\n        AFRAME.scenes[0].systems[\"hubs-systems\"].cursorTargettingSystem.targets,\n        true,\n        rawIntersections\n      );\n      const intersection = rawIntersections.find(x => x.object.el);\n      const remoteHoverTarget = intersection && findRemoteHoverTarget(intersection.object);\n      const userinput = AFRAME.scenes[0].systems.userinput;\n      const isInteractable =\n        intersection &&\n        intersection.object.el.matches(\".pen, .pen *, .video, .video *, .interactable, .interactable *\");\n      const isPinned =\n        remoteHoverTarget && remoteHoverTarget.components.pinnable && remoteHoverTarget.components.pinnable.data.pinned;\n      const isFrozen = AFRAME.scenes[0].is(\"frozen\");\n      this.clickedOnAnything =\n        (isInteractable && (isFrozen || !isPinned) && canMove(remoteHoverTarget)) ||\n        userinput.activeSets.includes(sets.cursorHoldingPen) ||\n        userinput.activeSets.includes(sets.cursorHoldingInteractable) ||\n        userinput.activeSets.includes(sets.cursorHoldingCamera);\n    }\n    this.prevButtonLeft = buttonLeft;\n\n    if (!buttonLeft) {\n      this.clickedOnAnything = false;\n    }\n\n    if ((!this.clickedOnAnything && buttonLeft) || buttonRight) {\n      const movementXY = frame.get(paths.device.mouse.movementXY);\n      if (movementXY) {\n        frame.setVector2(paths.device.smartMouse.cameraDelta, movementXY[0], movementXY[1]);\n      }\n    }\n\n    const coords = frame.get(paths.device.mouse.coords);\n    frame.setPose(\n      paths.device.smartMouse.cursorPose,\n      calculateCursorPose(this.camera, coords, this.origin, this.direction, this.cursorPose)\n    );\n  }\n}\n","export function touchIsAssigned(touch, assignments) {\n  return (\n    assignments.find(assignment => {\n      return assignment.touch.identifier === touch.identifier;\n    }) !== undefined\n  );\n}\n\nexport function jobIsAssigned(job, assignments) {\n  return (\n    assignments.find(assignment => {\n      return assignment.job === job;\n    }) !== undefined\n  );\n}\n\nexport function assign(touch, job, assignments) {\n  if (touchIsAssigned(touch, assignments) || jobIsAssigned(job, assignments)) {\n    console.error(\"cannot reassign touches or jobs. unassign first\");\n    return undefined;\n  }\n  const assignment = { job, touch };\n  assignments.push(assignment);\n  return assignment;\n}\n\nexport function unassign(touch, job, assignments) {\n  function match(assignment) {\n    return assignment.touch.identifier === touch.identifier && assignment.job === job;\n  }\n  assignments.splice(assignments.findIndex(match), 1);\n}\n\nexport function findByJob(job, assignments) {\n  return assignments.find(assignment => {\n    return assignment.job === job;\n  });\n}\n\nexport function findByTouch(touch, assignments) {\n  return assignments.find(assignment => {\n    return assignment.touch.identifier === touch.identifier;\n  });\n}\n","import { paths } from \"../paths\";\nimport { Pose } from \"../pose\";\nimport { touchIsAssigned, jobIsAssigned, assign, unassign, findByJob, findByTouch } from \"./touchscreen/assignments\";\nimport { findRemoteHoverTarget } from \"../../interactions\";\nimport { canMove } from \"../../../utils/permissions-utils\";\n\nconst MOVE_CURSOR_JOB = \"MOVE CURSOR\";\nconst MOVE_CAMERA_JOB = \"MOVE CAMERA\";\nconst FIRST_PINCHER_JOB = \"FIRST PINCHER\";\nconst SECOND_PINCHER_JOB = \"SECOND PINCHER\";\n\nconst TAP_PATHS = [\n  paths.device.touchscreen.tap1,\n  paths.device.touchscreen.tap2,\n  paths.device.touchscreen.tap3,\n  paths.device.touchscreen.tap4,\n  paths.device.touchscreen.tap5\n];\n\nfunction distance(x1, y1, x2, y2) {\n  const dx = x1 - x2;\n  const dy = y1 - y2;\n  return Math.sqrt(dx * dx + dy * dy);\n}\n\nconst getPlayerCamera = (() => {\n  let playerCamera;\n\n  return function() {\n    if (!playerCamera) {\n      playerCamera = document.querySelector(\"#player-camera\").components.camera.camera;\n    }\n\n    return playerCamera;\n  };\n})();\n\nfunction shouldMoveCursor(touch, raycaster) {\n  const isCursorGrabbing = !!AFRAME.scenes[0].systems.interaction.state.rightRemote.held;\n  if (isCursorGrabbing) {\n    return true;\n  }\n  const rawIntersections = [];\n  raycaster.setFromCamera(\n    {\n      x: (touch.clientX / window.innerWidth) * 2 - 1,\n      y: -(touch.clientY / window.innerHeight) * 2 + 1\n    },\n    getPlayerCamera()\n  );\n  raycaster.intersectObjects(\n    AFRAME.scenes[0].systems[\"hubs-systems\"].cursorTargettingSystem.targets,\n    true,\n    rawIntersections\n  );\n  const intersection = rawIntersections.find(x => x.object.el);\n  const remoteHoverTarget = intersection && findRemoteHoverTarget(intersection.object);\n  const isInteractable = intersection && intersection.object.el.matches(\".interactable, .interactable *\");\n  const isPinned =\n    remoteHoverTarget && remoteHoverTarget.components.pinnable && remoteHoverTarget.components.pinnable.data.pinned;\n  const isFrozen = AFRAME.scenes[0].is(\"frozen\");\n  return isInteractable && (isFrozen || !isPinned) && canMove(remoteHoverTarget);\n}\n\nexport class AppAwareTouchscreenDevice {\n  constructor() {\n    this.raycaster = new THREE.Raycaster(new THREE.Vector3(), new THREE.Vector3(), 0, 4);\n    this.assignments = [];\n    this.pinch = { initialDistance: 0, currentDistance: 0, delta: 0 };\n\n    // When touches appear, this timestamps and then watches for the high water mark of # of touches\n    this.pendingTap = { maxTouchCount: 0, startedAt: 0 };\n    this.tapIndexToWriteNextFrame = 0;\n\n    this.events = [];\n    [\"touchstart\", \"touchend\", \"touchmove\", \"touchcancel\"].map(x =>\n      document.querySelector(\"canvas\").addEventListener(x, this.events.push.bind(this.events))\n    );\n  }\n\n  end(touch) {\n    if (!touchIsAssigned(touch, this.assignments)) {\n      console.warn(\"touch does not have a job\", touch);\n    } else {\n      const assignment = findByTouch(touch, this.assignments);\n      switch (assignment.job) {\n        case MOVE_CURSOR_JOB:\n        case MOVE_CAMERA_JOB:\n          // If grab was being delayed, we should fire the initial grab and also delay the unassignment\n          // to ensure we write at least two frames with the grab down (since the action set will change)\n          // and otherwise we'd not see the falling xform.\n          if (assignment.framesUntilGrab >= 0) {\n            assignment.framesUntilUnassign = assignment.framesUntilGrab + 2;\n          } else {\n            unassign(assignment.touch, assignment.job, this.assignments);\n          }\n\n          break;\n        case FIRST_PINCHER_JOB:\n          unassign(assignment.touch, assignment.job, this.assignments);\n          this.pinch = { initialDistance: 0, currentDistance: 0, delta: 0 };\n\n          if (jobIsAssigned(SECOND_PINCHER_JOB, this.assignments)) {\n            const second = findByJob(SECOND_PINCHER_JOB, this.assignments);\n            unassign(second.touch, second.job, this.assignments);\n            if (jobIsAssigned(MOVE_CAMERA_JOB, this.assignments)) {\n              // reassign secondPincher to firstPincher\n              const first = assign(second.touch, FIRST_PINCHER_JOB, this.assignments);\n              first.clientX = second.clientX;\n              first.clientY = second.clientY;\n            } else {\n              // reassign secondPincher to moveCamera\n              const cameraMover = assign(second.touch, MOVE_CAMERA_JOB, this.assignments);\n              cameraMover.clientX = second.clientX;\n              cameraMover.clientY = second.clientY;\n              cameraMover.delta = [0, 0];\n            }\n          }\n          break;\n        case SECOND_PINCHER_JOB:\n          unassign(assignment.touch, assignment.job, this.assignments);\n          this.pinch = { initialDistance: 0, currentDistance: 0, delta: 0 };\n          if (jobIsAssigned(FIRST_PINCHER_JOB, this.assignments) && !jobIsAssigned(MOVE_CAMERA_JOB, this.assignments)) {\n            //reassign firstPincher to moveCamera\n            const first = findByJob(FIRST_PINCHER_JOB, this.assignments);\n            unassign(first.touch, first.job, this.assignments);\n            const cameraMover = assign(first.touch, MOVE_CAMERA_JOB, this.assignments);\n            cameraMover.clientX = first.clientX;\n            cameraMover.clientY = first.clientY;\n            cameraMover.delta = [0, 0];\n          }\n          break;\n      }\n    }\n\n    // Touches cleared, determine what to do with pending tap\n    if (this.assignments.length === 0) {\n      if (this.pendingTap.maxTouchCount > 0 && performance.now() - this.pendingTap.startedAt <= 125) {\n        this.tapIndexToWriteNextFrame = this.pendingTap.maxTouchCount;\n      }\n\n      this.pendingTap = { maxTouchCount: 0 };\n    }\n  }\n\n  move(touch) {\n    if (!touchIsAssigned(touch, this.assignments)) {\n      if (!touch.target.classList[0] || !touch.target.classList[0].startsWith(\"virtual-gamepad-controls\")) {\n        console.warn(\"touch does not have job\", touch);\n      }\n      return;\n    }\n\n    const assignment = findByTouch(touch, this.assignments);\n    switch (assignment.job) {\n      case MOVE_CURSOR_JOB:\n        assignment.cursorPose.fromCameraProjection(\n          getPlayerCamera(),\n          (touch.clientX / window.innerWidth) * 2 - 1,\n          -(touch.clientY / window.innerHeight) * 2 + 1\n        );\n        break;\n      case MOVE_CAMERA_JOB:\n        assignment.delta[0] += touch.clientX - assignment.clientX;\n        assignment.delta[1] += touch.clientY - assignment.clientY;\n        assignment.clientX = touch.clientX;\n        assignment.clientY = touch.clientY;\n        break;\n      case FIRST_PINCHER_JOB:\n      case SECOND_PINCHER_JOB:\n        assignment.clientX = touch.clientX;\n        assignment.clientY = touch.clientY;\n        if (jobIsAssigned(FIRST_PINCHER_JOB, this.assignments) && jobIsAssigned(SECOND_PINCHER_JOB, this.assignments)) {\n          const first = findByJob(FIRST_PINCHER_JOB, this.assignments);\n          const second = findByJob(SECOND_PINCHER_JOB, this.assignments);\n          const currentDistance = distance(first.clientX, first.clientY, second.clientX, second.clientY);\n          this.pinch.delta += currentDistance - this.pinch.currentDistance;\n          this.pinch.currentDistance = currentDistance;\n        }\n        break;\n    }\n  }\n\n  start(touch) {\n    if (touchIsAssigned(touch, this.assignments)) {\n      console.error(\"touch already has a job\");\n      return;\n    }\n\n    const isFirstTouch = this.assignments.length === 0;\n    const isSecondTouch = this.assignments.length === 1;\n    const isThirdTouch = this.assignments.length === 2;\n\n    const hasSecondPinch = !!findByJob(SECOND_PINCHER_JOB, this.assignments);\n\n    if (isFirstTouch || (isThirdTouch && hasSecondPinch)) {\n      let assignment;\n\n      // First touch or third touch and other two fingers were pinching\n      if (shouldMoveCursor(touch, this.raycaster)) {\n        assignment = assign(touch, MOVE_CURSOR_JOB, this.assignments);\n\n        // Grabbing objects is delayed by several frames:\n        // - We don't want the physics constraint to be applied too early, which results in crazy velocities\n        // - We don't want to mis-trigger grabs if the user is about to put down a second finger.\n        assignment.framesUntilGrab = 2;\n      } else {\n        assignment = assign(touch, MOVE_CAMERA_JOB, this.assignments);\n        assignment.delta = [0, 0];\n      }\n\n      assignment.clientX = touch.clientX;\n      assignment.clientY = touch.clientY;\n\n      // On touch down, we always move the cursor on the first frame, but the MOVE_CURSOR_JOB indicates\n      // the touch will then track the cursor (instead of the camera)\n      assignment.cursorPose = new Pose().fromCameraProjection(\n        getPlayerCamera(),\n        (touch.clientX / window.innerWidth) * 2 - 1,\n        -(touch.clientY / window.innerHeight) * 2 + 1\n      );\n    } else if (isSecondTouch || isThirdTouch) {\n      const cursorJob = findByJob(MOVE_CURSOR_JOB, this.assignments);\n\n      if (isSecondTouch && cursorJob && cursorJob.framesUntilGrab < 0) {\n        // The second touch is happening after grab activated, so assign this touch to first pinch.\n        const first = assign(touch, FIRST_PINCHER_JOB, this.assignments);\n        first.clientX = touch.clientX;\n        first.clientY = touch.clientY;\n      } else {\n        // Second or third touch, but third touch only if not pinching\n        if (isSecondTouch) {\n          // The second touch is happening before the grab activated, so re-assign the first\n          // to the first pinch, and effectively cancel the grab.\n          const previousAssignment = this.assignments[0];\n          unassign(previousAssignment.touch, previousAssignment.job, this.assignments);\n          const first = assign(previousAssignment.touch, FIRST_PINCHER_JOB, this.assignments);\n          first.clientX = previousAssignment.clientX;\n          first.clientY = previousAssignment.clientY;\n        }\n\n        const first = findByJob(FIRST_PINCHER_JOB, this.assignments);\n\n        if (!first) {\n          const first = assign(touch, FIRST_PINCHER_JOB, this.assignments);\n          first.clientX = touch.clientX;\n          first.clientY = touch.clientY;\n          return;\n        } else {\n          const second = assign(touch, SECOND_PINCHER_JOB, this.assignments);\n          second.clientX = touch.clientX;\n          second.clientY = touch.clientY;\n\n          const initialDistance = distance(first.clientX, first.clientY, second.clientX, second.clientY);\n\n          this.pinch = {\n            initialDistance,\n            currentDistance: initialDistance,\n            delta: 0\n          };\n        }\n      }\n    }\n\n    if (this.pendingTap.maxTouchCount === 0 && this.assignments.length > 0) {\n      this.pendingTap.startedAt = performance.now();\n    }\n\n    this.pendingTap.maxTouchCount = Math.max(this.pendingTap.maxTouchCount, this.assignments.length);\n  }\n\n  process(event) {\n    switch (event.type) {\n      case \"touchstart\":\n        for (const touch of event.changedTouches) {\n          this.start(touch);\n        }\n        break;\n      case \"touchmove\":\n        for (const touch of event.touches) {\n          this.move(touch);\n        }\n        break;\n      case \"touchend\":\n      case \"touchcancel\":\n        for (const touch of event.changedTouches) {\n          this.end(touch);\n        }\n        break;\n    }\n  }\n\n  write(frame) {\n    if (this.pinch) {\n      this.pinch.delta = 0;\n    }\n    const cameraMover =\n      jobIsAssigned(MOVE_CAMERA_JOB, this.assignments) && findByJob(MOVE_CAMERA_JOB, this.assignments);\n    if (cameraMover) {\n      cameraMover.delta[0] = 0;\n      cameraMover.delta[1] = 0;\n    }\n\n    this.events.forEach(event => {\n      this.process(event);\n    });\n    while (this.events.length) {\n      this.events.pop();\n    }\n\n    const path = paths.device.touchscreen;\n    const hasCursorJob = jobIsAssigned(MOVE_CURSOR_JOB, this.assignments);\n    const hasCameraJob = jobIsAssigned(MOVE_CAMERA_JOB, this.assignments);\n\n    if (hasCursorJob || hasCameraJob) {\n      frame.setValueType(path.isTouching, true);\n\n      const assignment = findByJob(MOVE_CURSOR_JOB, this.assignments) || findByJob(MOVE_CAMERA_JOB, this.assignments);\n      frame.setPose(path.cursorPose, assignment.cursorPose);\n    }\n\n    frame.setValueType(path.isTouchingGrabbable, false);\n\n    if (hasCursorJob) {\n      const assignment = findByJob(MOVE_CURSOR_JOB, this.assignments);\n      frame.setValueType(path.isTouchingGrabbable, assignment.framesUntilGrab <= 0);\n      assignment.framesUntilGrab--;\n\n      if (assignment.framesUntilUnassign >= 0) {\n        if (assignment.framesUntilUnassign === 0) {\n          unassign(assignment.touch, assignment.job, this.assignments);\n        }\n\n        assignment.framesUntilUnassign--;\n      }\n    }\n\n    if (hasCameraJob) {\n      const delta = findByJob(MOVE_CAMERA_JOB, this.assignments).delta;\n      frame.setVector2(path.touchCameraDelta, delta[0], delta[1]);\n    }\n\n    frame.setValueType(path.pinch.delta, this.pinch.delta);\n    frame.setValueType(path.pinch.initialDistance, this.pinch.initialDistance);\n    frame.setValueType(path.pinch.currentDistance, this.pinch.currentDistance);\n\n    if (this.tapIndexToWriteNextFrame && this.tapIndexToWriteNextFrame < TAP_PATHS.length) {\n      // write to tap-X path if we had an X-fingered tap\n      frame.setValueType(TAP_PATHS[this.tapIndexToWriteNextFrame - 1], true);\n    }\n\n    this.tapIndexToWriteNextFrame = 0;\n  }\n}\n","import { Pose } from \"../pose\";\nimport { angleTo4Direction } from \"../../../utils/dpad\";\n\nexport const xforms = {\n  noop: function() {},\n  copy: function(frame, src, dest) {\n    frame.setValueType(dest.value, frame.get(src.value));\n  },\n  scale: function(scalar) {\n    return function scale(frame, src, dest) {\n      if (frame.get(src.value) !== undefined) {\n        frame.setValueType(dest.value, frame.get(src.value) * scalar);\n      }\n    };\n  },\n  scaleExp: function(scalar, exp = 1) {\n    return function scale(frame, src, dest) {\n      if (frame.get(src.value) !== undefined) {\n        if (exp === 1) {\n          frame.setValueType(dest.value, frame.get(src.value) * scalar);\n        } else {\n          frame.setValueType(dest.value, Math.pow(frame.get(src.value), exp) * scalar);\n        }\n      }\n    };\n  },\n  deadzone: function(deadzoneSize) {\n    return function deadzone(frame, src, dest) {\n      frame.setValueType(dest.value, Math.abs(frame.get(src.value)) < deadzoneSize ? 0 : frame.get(src.value));\n    };\n  },\n  split_vec2: function(frame, src, dest) {\n    const value = frame.get(src.value);\n    if (value !== undefined) {\n      frame.setValueType(dest.x, value[0]);\n      frame.setValueType(dest.y, value[1]);\n    }\n  },\n  compose_vec2: function(frame, src, dest) {\n    const x = frame.get(src.x);\n    const y = frame.get(src.y);\n    if (x !== undefined && y !== undefined) {\n      frame.setVector2(dest.value, x, y);\n    }\n  },\n  negate: function(frame, src, dest) {\n    frame.setValueType(dest.value, -frame.get(src.value));\n  },\n  copyIfFalse: function(frame, src, dest) {\n    frame.setValueType(dest.value, frame.get(src.bool) ? undefined : frame.get(src.value));\n  },\n  copyIfTrue: function(frame, src, dest) {\n    frame.setValueType(dest.value, frame.get(src.bool) ? frame.get(src.value) : undefined);\n  },\n  zeroIfDefined: function(frame, src, dest) {\n    frame.setValueType(dest.value, frame.get(src.bool) !== undefined ? 0 : frame.get(src.value));\n  },\n  true: function(frame, src, dest) {\n    frame.setValueType(dest.value, true);\n  },\n  rising: function rising(frame, src, dest, prevState) {\n    frame.setValueType(dest.value, frame.get(src.value) && prevState === false);\n    return !!frame.get(src.value);\n  },\n  risingWithFrameDelay: function(n) {\n    return function risingWithFrameDelay(frame, src, dest, state = { values: new Array(n) }) {\n      frame.setValueType(dest.value, state.values.shift());\n      state.values.push(frame.get(src.value) && !state.prev);\n      state.prev = frame.get(src.value);\n      return state;\n    };\n  },\n  falling: function falling(frame, src, dest, prevState) {\n    frame.setValueType(dest.value, !frame.get(src.value) && prevState);\n    return !!frame.get(src.value);\n  },\n  vec2Zero: function(frame, _, dest) {\n    frame.setVector2(dest.value, 0, 0);\n  },\n  poseFromCameraProjection: function() {\n    let camera;\n    const pose = new Pose();\n    return function poseFromCameraProjection(frame, src, dest) {\n      if (!camera) {\n        camera = document.querySelector(\"#player-camera\").components.camera.camera;\n      }\n      const value = frame.get(src.value);\n      frame.setPose(dest.value, pose.fromCameraProjection(camera, value[0], value[1]));\n    };\n  },\n  vec2dpad: function(deadzoneRadius, invertX = false, invertY = false) {\n    const deadzoneRadiusSquared = deadzoneRadius * deadzoneRadius;\n\n    return function vec2dpad(frame, src, dest) {\n      if (!frame.get(src.value)) return;\n      const [x, y] = frame.get(src.value);\n      const inCenter = x * x + y * y < deadzoneRadiusSquared;\n      const direction = inCenter ? \"center\" : angleTo4Direction(Math.atan2(invertX ? -x : x, invertY ? -y : y));\n      if (!dest[direction]) return;\n      frame.setValueType(dest[direction], true);\n    };\n  },\n  always: function(constValue) {\n    return function always(frame, _, dest) {\n      frame.setValueType(dest.value, constValue);\n    };\n  },\n  wasd_to_vec2: function(frame, { w, a, s, d }, { vec2 }) {\n    let x = 0;\n    let y = 0;\n    if (frame.get(a)) x -= 1;\n    if (frame.get(d)) x += 1;\n    if (frame.get(w)) y += 1;\n    if (frame.get(s)) y -= 1;\n    frame.setVector2(vec2, x, y);\n  },\n  add_vec2: function(frame, src, dest) {\n    const first = frame.get(src.first);\n    const second = frame.get(src.second);\n    if (first && second) {\n      frame.setVector2(dest.value, first[0] + second[0], first[1] + second[1]);\n    } else if (second) {\n      frame.setVector2(dest.value, second[0], second[1]);\n    } else if (first) {\n      frame.setVector2(dest.value, first[0], first[1]);\n    }\n  },\n  max_vec2: function(frame, src, dest) {\n    const first = frame.get(src.first);\n    const second = frame.get(src.second);\n    if (first && second) {\n      const max =\n        first[0] * first[0] + first[1] * first[1] > second[0] * second[0] + second[1] * second[1] ? first : second;\n      frame.setVector2(dest.value, max[0], max[1]);\n    } else if (second) {\n      frame.setVector2(dest.value, second[0], second[1]);\n    } else if (first) {\n      frame.setVector2(dest.value, first[0], first[1]);\n    }\n  },\n  normalize_vec2: function(frame, src, dest) {\n    const vec2 = frame.get(src.value);\n    if (vec2) {\n      if (vec2[0] === 0 && vec2[0] === 0) {\n        frame.setVector2(dest.value, vec2[0], vec2[1]);\n      } else {\n        const l = Math.sqrt(vec2[0] * vec2[0] + vec2[1] * vec2[1]);\n        frame.setVector2(dest.value, vec2[0] / l, vec2[1] / l);\n      }\n    }\n  },\n  all: function(frame, src, dest) {\n    for (let i = 0, l = src.length; i < l; i++) {\n      const path = src[i];\n      if (!frame.get(path)) {\n        frame.setValueType(dest.value, false);\n        return;\n      }\n    }\n    frame.setValueType(dest.value, true);\n  },\n  any: function(frame, src, dest) {\n    for (let i = 0, l = src.length; i < l; i++) {\n      const path = src[i];\n      if (frame.get(path)) {\n        frame.setValueType(dest.value, true);\n        return;\n      }\n    }\n    frame.setValueType(dest.value, false);\n  },\n  touch_axis_scroll(scale = 1, snap_to) {\n    return function touch_axis_scroll(frame, src, dest, state = { value: 0, touching: false }) {\n      if (snap_to === undefined || Math.abs(frame.get(src.value) - state.value) >= snap_to) {\n        frame.setValueType(\n          dest.value,\n          state.touching && frame.get(src.touching) ? scale * (frame.get(src.value) - state.value) : 0\n        );\n      }\n\n      state.value = frame.get(src.value);\n      state.touching = frame.get(src.touching);\n\n      return state;\n    };\n  }\n};\n","export function angleTo4Direction(angle) {\n  angle = (angle * THREE.Math.RAD2DEG + 180 + 45) % 360;\n  if (angle > 0 && angle < 90) {\n    return \"north\";\n  } else if (angle >= 90 && angle < 180) {\n    return \"west\";\n  } else if (angle >= 180 && angle < 270) {\n    return \"south\";\n  } else {\n    return \"east\";\n  }\n}\n\nexport function angleTo8Direction(angle) {\n  angle = (angle * THREE.Math.RAD2DEG + 180 + 45) % 360;\n  let direction = \"\";\n  if ((angle >= 0 && angle < 120) || angle >= 330) {\n    direction += \"north\";\n  }\n  if (angle >= 150 && angle < 300) {\n    direction += \"south\";\n  }\n  if (angle >= 60 && angle < 210) {\n    direction += \"west\";\n  }\n  if ((angle >= 240 && angle < 360) || angle < 30) {\n    direction += \"east\";\n  }\n  return direction;\n}\n","export const addSetsToBindings = mapping => {\n  for (const setName in mapping) {\n    for (const binding of mapping[setName]) {\n      if (!binding.sets) {\n        binding.sets = [];\n      }\n      binding.sets.push(setName);\n    }\n  }\n  return mapping;\n};\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\n// import { Pose } from \"../pose\";\n\nconst wasd_vec2 = \"/var/mouse-and-keyboard/wasd_vec2\";\nconst keyboardCharacterAcceleration = \"/var/mouse-and-keyboard/keyboardCharacterAcceleration\";\nconst arrows_vec2 = \"/var/mouse-and-keyboard/arrows_vec2\";\nconst togglePenWithRMB = \"/vars/mouse-and-keyboard/drop_pen_with_RMB\";\nconst togglePenWithEsc = \"/vars/mouse-and-keyboard/drop_pen_with_esc\";\nconst togglePenWithP = \"/vars/mouse-and-keyboard/drop_pen_with_p\";\nconst togglePenWithHud = \"/vars/mouse-and-keyboard/drop_pen_with_hud\";\nconst togglePen = \"/vars/mouse-and-keyboard/togglePen\";\n\nconst k = name => {\n  return `/keyboard-mouse-user/keyboard-var/${name}`;\n};\n\nexport const keyboardMouseUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {},\n      dest: { value: paths.actions.cursor.hideLine },\n      xform: xforms.always(true)\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"arrowup\"),\n        a: paths.device.keyboard.key(\"arrowleft\"),\n        s: paths.device.keyboard.key(\"arrowdown\"),\n        d: paths.device.keyboard.key(\"arrowright\")\n      },\n      dest: { vec2: arrows_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"w\"),\n        a: paths.device.keyboard.key(\"a\"),\n        s: paths.device.keyboard.key(\"s\"),\n        d: paths.device.keyboard.key(\"d\")\n      },\n      dest: { vec2: wasd_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        first: wasd_vec2,\n        second: arrows_vec2\n      },\n      dest: { value: keyboardCharacterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: { value: keyboardCharacterAcceleration },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.normalize_vec2\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"shift\") },\n      dest: { value: paths.actions.boost },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: paths.actions.camera.exitMirror },\n      xform: xforms.falling\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"q\") },\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"e\") },\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Tab\") },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: paths.actions.thaw },\n      xform: xforms.falling\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"p\") },\n      dest: { value: togglePenWithP },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.hud.penButton },\n      dest: { value: togglePenWithHud },\n      xform: xforms.rising\n    },\n    {\n      src: [togglePenWithHud, togglePenWithP],\n      dest: { value: togglePen },\n      xform: xforms.any\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.spawnPen },\n      xform: xforms.rising,\n      priority: 100\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"c\") },\n      dest: { value: paths.actions.toggleCamera },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"x\") },\n      dest: { value: paths.actions.takeSnapshot },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.smartMouse.cursorPose },\n      dest: { value: paths.actions.cursor.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.smartMouse.cameraDelta },\n      dest: { x: \"/var/smartMouseCamDeltaX\", y: \"/var/smartMouseCamDeltaY\" },\n      xform: xforms.split_vec2\n    },\n    {\n      src: { value: \"/var/smartMouseCamDeltaX\" },\n      dest: { value: \"/var/smartMouseCamDeltaXScaled\" },\n      xform: xforms.scale(-0.2)\n    },\n    {\n      src: { value: \"/var/smartMouseCamDeltaY\" },\n      dest: { value: \"/var/smartMouseCamDeltaYScaled\" },\n      xform: xforms.scale(-0.1)\n    },\n    {\n      src: { x: \"/var/smartMouseCamDeltaXScaled\", y: \"/var/smartMouseCamDeltaYScaled\" },\n      dest: { value: paths.actions.cameraDelta },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: paths.actions.cameraDelta },\n      dest: { value: paths.actions.lobbyCameraDelta },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"m\")\n      },\n      dest: {\n        value: paths.actions.muteMic\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"t\")\n      },\n      dest: {\n        value: paths.actions.focusChat\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"/\")\n      },\n      dest: {\n        value: paths.actions.focusChatCommand\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: paths.actions.mediaExit },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"1\")\n      },\n      dest: { value: \"/var/shift+1\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+1\" },\n      dest: { value: paths.actions.mediaSearch1 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"2\")\n      },\n      dest: { value: \"/var/shift+2\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+2\" },\n      dest: { value: paths.actions.mediaSearch2 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"3\")\n      },\n      dest: { value: \"/var/shift+3\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+3\" },\n      dest: { value: paths.actions.mediaSearch3 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"4\")\n      },\n      dest: { value: \"/var/shift+4\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+4\" },\n      dest: { value: paths.actions.mediaSearch4 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"5\")\n      },\n      dest: { value: \"/var/shift+5\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+5\" },\n      dest: { value: paths.actions.mediaSearch5 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"6\")\n      },\n      dest: { value: \"/var/shift+6\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+6\" },\n      dest: { value: paths.actions.mediaSearch6 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"7\")\n      },\n      dest: { value: \"/var/shift+7\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+7\" },\n      dest: { value: paths.actions.mediaSearch7 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"8\")\n      },\n      dest: { value: \"/var/shift+8\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+8\" },\n      dest: { value: paths.actions.mediaSearch8 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"l\")\n      },\n      dest: {\n        value: paths.actions.logDebugFrame\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"k\")\n      },\n      dest: {\n        value: paths.actions.logInteractionState\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.mouse.buttonRight\n      },\n      dest: {\n        value: paths.actions.startGazeTeleport\n      },\n      xform: xforms.rising,\n      priority: 100\n    },\n    {\n      src: {\n        value: paths.device.mouse.buttonRight\n      },\n      dest: {\n        value: paths.actions.stopGazeTeleport\n      },\n      xform: xforms.falling,\n      priority: 100\n    }\n\n    // Helpful bindings for debugging hands in 2D\n    // {\n    //   src: {},\n    //   dest: { value: paths.actions.rightHand.matrix },\n    //   xform: xforms.always(\n    //     new THREE.Matrix4().compose(\n    //       new THREE.Vector3(0.2, 1.3, -0.8),\n    //       new THREE.Quaternion(0, 0, 0, 0),\n    //       new THREE.Vector3(1, 1, 1)\n    //     )\n    //   )\n    // },\n    // {\n    //   src: {},\n    //   dest: { value: paths.actions.leftHand.matrix },\n    //   xform: xforms.always(\n    //     new THREE.Matrix4().compose(\n    //       new THREE.Vector3(-0.2, 1.4, -0.8),\n    //       new THREE.Quaternion(0, 0, 0, 0),\n    //       new THREE.Vector3(1, 1, 1)\n    //     )\n    //   )\n    // }\n  ],\n\n  [sets.cursorHoldingPen]: [\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.keyboard.key(\"q\")\n      },\n      dest: { value: \"/var/shift+q\" },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+q\" },\n      dest: { value: paths.actions.cursor.penPrevColor },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.keyboard.key(\"e\")\n      },\n      dest: { value: \"/var/shift+e\" },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+e\" },\n      dest: { value: paths.actions.cursor.penNextColor },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.keyboard.key(\"q\")\n      },\n      dest: { value: \"/var/notshift+q\" },\n      xform: xforms.copyIfFalse\n    },\n    {\n      src: { value: \"/var/notshift+q\" },\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.keyboard.key(\"e\")\n      },\n      dest: { value: \"/var/notshift+e\" },\n      xform: xforms.copyIfFalse\n    },\n    {\n      src: { value: \"/var/notshift+e\" },\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        value: k(\"wheelWithShift\")\n      },\n      dest: { value: \"/var/cursorScalePenTipWheel\" },\n      xform: xforms.copy,\n      priority: 200\n    },\n    {\n      src: { value: \"/var/cursorScalePenTipWheel\" },\n      dest: { value: paths.actions.cursor.scalePenTip },\n      xform: xforms.scale(0.03)\n    },\n    {\n      src: { value: paths.device.mouse.buttonRight },\n      dest: { value: togglePenWithRMB },\n      xform: xforms.falling,\n      priority: 200\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: togglePenWithEsc },\n      xform: xforms.rising\n    },\n    {\n      src: [togglePenWithRMB, togglePenWithEsc, togglePenWithP, togglePenWithHud],\n      dest: { value: togglePen },\n      xform: xforms.any\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"z\")\n      },\n      dest: { value: paths.actions.cursor.undoDrawing },\n      priority: 1001,\n      xform: xforms.rising\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.pen.remove },\n      xform: xforms.rising,\n      priority: 200\n    }\n  ],\n\n  [sets.cursorHoldingCamera]: [\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.falling,\n      priority: 2\n    }\n  ],\n\n  [sets.cursorHoldingInteractable]: [\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.mouse.wheel\n      },\n      dest: {\n        value: k(\"wheelWithShift\")\n      },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"shift\"),\n        value: paths.device.mouse.wheel\n      },\n      dest: {\n        value: k(\"wheelWithoutShift\")\n      },\n      xform: xforms.copyIfFalse\n    },\n    {\n      src: {\n        value: k(\"wheelWithoutShift\")\n      },\n      dest: { value: paths.actions.cursor.modDelta },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: k(\"wheelWithShift\")\n      },\n      dest: { value: paths.actions.cursor.scaleGrabbedGrabbable },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.falling,\n      priority: 2\n    }\n  ],\n  [sets.cursorHoldingUI]: [\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"shift\") },\n      dest: { value: paths.actions.transformModifier },\n      xform: xforms.copy\n    }\n  ],\n  [sets.cursorHoveringOnInteractable]: [\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n  [sets.cursorHoveringOnVideo]: [\n    {\n      src: { value: paths.device.mouse.wheel },\n      dest: { value: paths.actions.cursor.mediaVolumeMod },\n      xform: xforms.scale(-0.3)\n    }\n  ],\n  [sets.inputFocused]: [\n    {\n      src: { value: \"/device/keyboard\" },\n      dest: { value: paths.noop },\n      xform: xforms.noop,\n      priority: 1000\n    }\n  ],\n\n  [sets.cursorHoveringOnUI]: [\n    {\n      src: { value: paths.device.mouse.buttonLeft },\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.rising\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst zero = \"/vars/touchscreen/zero\";\nconst forward = \"/vars/touchscreen/pinchDeltaForward\";\nconst touchCamDelta = \"vars/touchscreen/touchCameraDelta\";\nconst touchCamDeltaX = \"vars/touchscreen/touchCameraDelta/x\";\nconst touchCamDeltaY = \"vars/touchscreen/touchCameraDelta/y\";\nconst touchCamDeltaXScaled = \"vars/touchscreen/touchCameraDelta/x/scaled\";\nconst touchCamDeltaYScaled = \"vars/touchscreen/touchCameraDelta/y/scaled\";\nconst gyroCamDelta = \"vars/gyro/gyroCameraDelta\";\nconst gyroCamDeltaXScaled = \"vars/gyro/gyroCameraDelta/x/scaled\";\nconst gyroCamDeltaYScaled = \"vars/gyro/gyroCameraDelta/y/scaled\";\nconst togglePen = \"/vars/touchscreen/togglePen\";\n\nexport const touchscreenUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {},\n      dest: { value: paths.actions.cursor.hideLine },\n      xform: xforms.always(true)\n    },\n    {\n      src: { value: paths.device.touchscreen.pinch.delta },\n      dest: { value: forward },\n      xform: xforms.scale(0.25)\n    },\n    {\n      src: { value: paths.device.touchscreen.tap2 },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.copy\n    },\n    {\n      src: {},\n      dest: { value: zero },\n      xform: xforms.always(0)\n    },\n    {\n      src: { x: zero, y: forward },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: paths.device.touchscreen.cursorPose },\n      dest: { value: paths.actions.cursor.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.touchscreen.touchCameraDelta },\n      dest: { x: touchCamDeltaX, y: touchCamDeltaY },\n      xform: xforms.split_vec2\n    },\n    {\n      src: { value: touchCamDeltaX },\n      dest: { value: touchCamDeltaXScaled },\n      xform: xforms.scale(0.18)\n    },\n    {\n      src: { value: touchCamDeltaY },\n      dest: { value: touchCamDeltaYScaled },\n      xform: xforms.scale(0.35)\n    },\n    {\n      src: { x: touchCamDeltaXScaled, y: touchCamDeltaYScaled },\n      dest: { value: touchCamDelta },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: paths.device.gyro.averageDeltaX },\n      dest: { value: gyroCamDeltaXScaled },\n      xform: xforms.scale(1.0)\n    },\n    {\n      src: { value: paths.device.gyro.averageDeltaY },\n      dest: { value: gyroCamDeltaYScaled },\n      xform: xforms.scale(1.0)\n    },\n    {\n      src: { x: gyroCamDeltaYScaled, y: gyroCamDeltaXScaled },\n      dest: { value: gyroCamDelta },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        first: touchCamDelta,\n        second: gyroCamDelta\n      },\n      dest: { value: paths.actions.cameraDelta },\n      xform: xforms.add_vec2\n    },\n    {\n      src: { value: touchCamDelta },\n      dest: { value: paths.actions.lobbyCameraDelta },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.touchscreen.isTouchingGrabbable },\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.hud.penButton },\n      dest: { value: togglePen },\n      xform: xforms.rising\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.spawnPen },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n  [sets.cursorHoldingInteractable]: [\n    {\n      src: { value: paths.device.touchscreen.isTouchingGrabbable },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.falling,\n      priority: 1\n    }\n  ],\n\n  [sets.cursorHoveringOnPen]: [],\n  [sets.cursorHoldingPen]: [\n    {\n      src: { value: paths.device.touchscreen.isTouchingGrabbable },\n      dest: { value: paths.actions.cursor.startDrawing },\n      xform: xforms.risingWithFrameDelay(5),\n      priority: 2\n    },\n    {\n      src: { value: paths.device.touchscreen.isTouchingGrabbable },\n      dest: { value: paths.actions.cursor.stopDrawing },\n      xform: xforms.falling,\n      priority: 2\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: togglePen },\n      dest: { value: paths.actions.pen.remove },\n      xform: xforms.rising,\n      priority: 3\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nexport const keyboardDebuggingBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {\n        value: paths.device.keyboard.key(\"l\")\n      },\n      dest: {\n        value: paths.actions.logDebugFrame\n      },\n      xform: xforms.rising\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst name = \"/touch/var/\";\n\nconst leftButton = paths.device.leftOculusTouch.button;\nconst leftAxis = paths.device.leftOculusTouch.axis;\nconst leftPose = paths.device.leftOculusTouch.pose;\nconst rightButton = paths.device.rightOculusTouch.button;\nconst rightAxis = paths.device.rightOculusTouch.axis;\nconst rightPose = paths.device.rightOculusTouch.pose;\n\nconst leftJoyXDeadzoned = `${name}left/joy/x/deadzoned`;\nconst leftJoyYDeadzoned = `${name}left/joy/y/deadzoned`;\nconst scaledLeftJoyX = `${name}left/scaledJoyX`;\nconst scaledLeftJoyY = `${name}left/scaledJoyY`;\nconst cursorDrop2 = `${name}right/cursorDrop2`;\nconst cursorDrop1 = `${name}right/cursorDrop1`;\nconst rightHandDrop2 = `${name}right/rightHandDrop2`;\nconst rightGripRisingGrab = `${name}right/grip/RisingGrab`;\nconst rightTriggerRisingGrab = `${name}right/trigger/RisingGrab`;\nconst leftGripRisingGrab = `${name}left/grip/RisingGrab`;\nconst leftTriggerRisingGrab = `${name}left/trigger/RisingGrab`;\nconst rightDpadNorth = `${name}rightDpad/north`;\nconst rightDpadSouth = `${name}rightDpad/south`;\nconst rightDpadEast = `${name}rightDpad/east`;\nconst rightDpadWest = `${name}rightDpad/west`;\nconst rightDpadCenter = `${name}rightDpad/center`;\nconst rightJoy = `${name}right/joy`;\nconst rightJoyY1 = `${name}right/joyY1`;\nconst rightJoyY2 = `${name}right/joyY2`;\nconst rightJoyYDeadzoned = `${name}right/joy/y/deadzoned`;\nconst leftDpadNorth = `${name}leftDpad/north`;\nconst leftDpadSouth = `${name}leftDpad/south`;\nconst leftDpadEast = `${name}leftDpad/east`;\nconst leftDpadWest = `${name}leftDpad/west`;\nconst leftDpadCenter = `${name}leftDpad/center`;\nconst leftJoy = `${name}left/joy`;\nconst oculusTouchCharacterAcceleration = `${name}characterAcceleration`;\nconst keyboardCharacterAcceleration = \"/var/keyboard/characterAcceleration\";\nconst characterAcceleration = \"/var/oculus-touch/nonNormalizedCharacterAcceleration\";\nconst wasd_vec2 = \"/var/keyboard/wasd_vec2\";\nconst arrows_vec2 = \"/var/keyboard/arrows_vec2\";\nconst keyboardBoost = \"/var/keyboard-oculus/boost\";\nconst rightBoost = \"/var/right-oculus/boost\";\nconst leftBoost = \"/var/left-oculus/boost\";\nconst rightTouchSnapRight = `${name}/right/snap-right`;\nconst rightTouchSnapLeft = `${name}/right/snap-left`;\nconst keyboardSnapRight = `${name}/keyboard/snap-right`;\nconst keyboardSnapLeft = `${name}/keyboard/snap-left`;\n\nconst lowerButtons = `${name}buttons/lower`;\n\nconst ensureFrozenViaButtons = `${name}buttons/ensureFrozen`;\nconst ensureFrozenViaKeyboard = `${name}keyboard/ensureFrozen`;\n\nconst thawViaButtons = `${name}buttons/thaw`;\nconst thawViaKeyboard = `${name}keyboard/thaw`;\n\nconst v = s => {\n  return \"/oculus-touch-user-vars/\" + s;\n};\nconst leftGripPressed1 = v(\"leftGripPressed1\");\nconst leftGripPressed2 = v(\"leftGripPressed2\");\nconst rightGripPressed1 = v(\"rightGripPressed1\");\nconst rightGripPressed2 = v(\"rightGripPressed2\");\nconst leftTriggerPressed1 = v(\"leftTriggerPressed1\");\nconst leftTriggerPressed2 = v(\"leftTriggerPressed2\");\nconst rightTriggerPressed1 = v(\"rightTriggerPressed1\");\nconst rightTriggerPressed2 = v(\"rightTriggerPressed2\");\n\nexport const oculusTouchUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {\n        value: paths.device.leftOculusTouch.matrix\n      },\n      dest: {\n        value: paths.actions.leftHand.matrix\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: paths.device.rightOculusTouch.matrix\n      },\n      dest: {\n        value: paths.actions.rightHand.matrix\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [ensureFrozenViaButtons, ensureFrozenViaKeyboard],\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.any\n    },\n    {\n      src: [thawViaButtons, thawViaKeyboard],\n      dest: { value: paths.actions.thaw },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: leftButton(\"grip\").pressed\n      },\n      dest: {\n        value: leftGripPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: leftButton(\"grip\").pressed\n      },\n      dest: {\n        value: leftGripPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: leftGripPressed1\n      },\n      dest: {\n        value: paths.actions.leftHand.middleRingPinky\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [leftButton(\"x\").touched, leftButton(\"y\").touched, leftButton(\"thumbStick\").touched],\n      dest: {\n        value: paths.actions.leftHand.thumb\n      },\n      xform: xforms.any\n    },\n    {\n      src: { value: leftButton(\"trigger\").pressed },\n      dest: {\n        value: leftTriggerPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftButton(\"trigger\").pressed },\n      dest: {\n        value: leftTriggerPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftTriggerPressed1 },\n      dest: {\n        value: paths.actions.leftHand.index\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightButton(\"grip\").pressed\n      },\n      dest: {\n        value: rightGripPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightButton(\"grip\").pressed\n      },\n      dest: {\n        value: rightGripPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightGripPressed1\n      },\n      dest: {\n        value: paths.actions.rightHand.middleRingPinky\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [rightButton(\"a\").touched, rightButton(\"b\").touched, rightButton(\"thumbStick\").touched],\n      dest: {\n        value: paths.actions.rightHand.thumb\n      },\n      xform: xforms.any\n    },\n    {\n      src: { value: rightButton(\"trigger\").pressed },\n      dest: {\n        value: rightTriggerPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightButton(\"trigger\").pressed },\n      dest: {\n        value: rightTriggerPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightTriggerPressed1 },\n      dest: {\n        value: paths.actions.rightHand.index\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: leftAxis(\"joyX\"),\n        y: leftAxis(\"joyY\")\n      },\n      dest: {\n        value: leftJoy\n      },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: leftJoy\n      },\n      dest: {\n        north: leftDpadNorth,\n        south: leftDpadSouth,\n        east: leftDpadEast,\n        west: leftDpadWest,\n        center: leftDpadCenter\n      },\n      xform: xforms.vec2dpad(0.2, false, true)\n    },\n    {\n      src: {\n        value: rightAxis(\"joyY\")\n      },\n      dest: { value: rightJoyY1 },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightAxis(\"joyY\")\n      },\n      dest: { value: rightJoyY2 },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: rightAxis(\"joyX\"),\n        y: rightJoyY1\n      },\n      dest: {\n        value: rightJoy\n      },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: rightJoy\n      },\n      dest: {\n        north: rightDpadNorth,\n        south: rightDpadSouth,\n        east: rightDpadEast,\n        west: rightDpadWest,\n        center: rightDpadCenter\n      },\n      xform: xforms.vec2dpad(0.2, false, true)\n    },\n    {\n      src: {\n        value: rightDpadEast\n      },\n      dest: {\n        value: rightTouchSnapRight\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"e\") },\n      dest: { value: keyboardSnapRight },\n      xform: xforms.rising\n    },\n    {\n      src: [rightTouchSnapRight, keyboardSnapRight],\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.any\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Tab\") },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: ensureFrozenViaKeyboard },\n      xform: xforms.copy\n    },\n    {\n      src: [leftButton(\"x\").pressed, rightButton(\"a\").pressed],\n      dest: { value: lowerButtons },\n      xform: xforms.any\n    },\n    {\n      src: { value: lowerButtons },\n      dest: { value: ensureFrozenViaButtons },\n      xform: xforms.copy\n    },\n    {\n      src: { value: lowerButtons },\n      dest: { value: thawViaButtons },\n      xform: xforms.falling\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: thawViaKeyboard },\n      xform: xforms.falling\n    },\n    {\n      src: {\n        value: rightDpadWest\n      },\n      dest: {\n        value: rightTouchSnapLeft\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"q\") },\n      dest: { value: keyboardSnapLeft },\n      xform: xforms.rising\n    },\n    {\n      src: [rightTouchSnapLeft, keyboardSnapLeft],\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: leftAxis(\"joyY\")\n      },\n      dest: {\n        value: leftJoyYDeadzoned\n      },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: {\n        value: leftJoyYDeadzoned\n      },\n      dest: {\n        value: scaledLeftJoyY\n      },\n      xform: xforms.scale(-1.5) // horizontal character speed modifier\n    },\n    {\n      src: {\n        value: leftAxis(\"joyX\")\n      },\n      dest: {\n        value: leftJoyXDeadzoned\n      },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: {\n        value: leftJoyXDeadzoned\n      },\n      dest: {\n        value: scaledLeftJoyX\n      },\n      xform: xforms.scale(1.5) // horizontal character speed modifier\n    },\n    {\n      src: {\n        x: scaledLeftJoyX,\n        y: scaledLeftJoyY\n      },\n      dest: { value: oculusTouchCharacterAcceleration },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"arrowup\"),\n        a: paths.device.keyboard.key(\"arrowleft\"),\n        s: paths.device.keyboard.key(\"arrowdown\"),\n        d: paths.device.keyboard.key(\"arrowright\")\n      },\n      dest: { vec2: arrows_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"w\"),\n        a: paths.device.keyboard.key(\"a\"),\n        s: paths.device.keyboard.key(\"s\"),\n        d: paths.device.keyboard.key(\"d\")\n      },\n      dest: { vec2: wasd_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        first: wasd_vec2,\n        second: arrows_vec2\n      },\n      dest: { value: keyboardCharacterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: {\n        first: oculusTouchCharacterAcceleration,\n        second: keyboardCharacterAcceleration\n      },\n      dest: {\n        value: characterAcceleration\n      },\n      xform: xforms.max_vec2\n    },\n    {\n      src: {\n        value: characterAcceleration,\n        override: \"/device/overrides/foo\"\n      },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"shift\") },\n      dest: { value: keyboardBoost },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: leftButton(\"y\").pressed\n      },\n      dest: {\n        value: leftBoost\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightButton(\"b\").pressed\n      },\n      dest: {\n        value: rightBoost\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [keyboardBoost, leftBoost, rightBoost],\n      dest: { value: paths.actions.boost },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"t\")\n      },\n      dest: {\n        value: paths.actions.focusChat\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"/\")\n      },\n      dest: {\n        value: paths.actions.focusChatCommand\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: paths.actions.mediaExit },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"p\") },\n      dest: { value: paths.actions.spawnPen },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"c\") },\n      dest: { value: paths.actions.toggleCamera },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"x\") },\n      dest: { value: paths.actions.takeSnapshot },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"1\")\n      },\n      dest: { value: \"/var/shift+1\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+1\" },\n      dest: { value: paths.actions.mediaSearch1 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"2\")\n      },\n      dest: { value: \"/var/shift+2\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+2\" },\n      dest: { value: paths.actions.mediaSearch2 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"3\")\n      },\n      dest: { value: \"/var/shift+3\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+3\" },\n      dest: { value: paths.actions.mediaSearch3 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"4\")\n      },\n      dest: { value: \"/var/shift+4\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+4\" },\n      dest: { value: paths.actions.mediaSearch4 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"5\")\n      },\n      dest: { value: \"/var/shift+5\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+5\" },\n      dest: { value: paths.actions.mediaSearch5 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"6\")\n      },\n      dest: { value: \"/var/shift+6\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+6\" },\n      dest: { value: paths.actions.mediaSearch6 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"7\")\n      },\n      dest: { value: \"/var/shift+7\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+7\" },\n      dest: { value: paths.actions.mediaSearch7 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"8\")\n      },\n      dest: { value: \"/var/shift+8\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+8\" },\n      dest: { value: paths.actions.mediaSearch8 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"l\")\n      },\n      dest: {\n        value: paths.actions.logDebugFrame\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"k\")\n      },\n      dest: {\n        value: paths.actions.logInteractionState\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"m\")\n      },\n      dest: {\n        value: paths.actions.muteMic\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rightPose },\n      dest: { value: paths.actions.cursor.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightPose },\n      dest: { value: paths.actions.rightHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: leftPose },\n      dest: { value: paths.actions.leftHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.stopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    }\n  ],\n\n  [sets.leftHandHoveringOnNothing]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startTeleport },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.cursorHoveringOnUI]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.cursorHoveringOnVideo]: [\n    {\n      src: { value: rightAxis(\"joyY\") },\n      dest: { value: paths.actions.cursor.mediaVolumeMod },\n      xform: xforms.scale(-0.01)\n    }\n  ],\n\n  [sets.cursorHoveringOnNothing]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.leftHandHoveringOnInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: leftGripRisingGrab },\n      xform: xforms.rising\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: leftTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [leftGripRisingGrab],\n      dest: { value: paths.actions.leftHand.grab },\n      xform: xforms.any,\n      priority: 2\n    }\n  ],\n\n  [sets.leftHandHoldingInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.falling\n    },\n    {\n      src: {},\n      dest: { value: ensureFrozenViaButtons },\n      priority: 1,\n      xform: xforms.always(false)\n    }\n  ],\n\n  [sets.leftHandHoveringOnPen]: [],\n  [sets.leftHandHoldingPen]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        value: leftDpadEast,\n        override: \"/device/overrides/foo\"\n      },\n      dest: {\n        value: paths.actions.leftHand.penNextColor\n      },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: {\n        value: leftDpadWest,\n        override: \"/device/overrides/foo\"\n      },\n      dest: {\n        value: paths.actions.leftHand.penPrevColor\n      },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: leftJoyYDeadzoned },\n      dest: { value: paths.actions.leftHand.scalePenTip },\n      xform: xforms.scaleExp(-0.005, 5),\n      priority: 1\n    },\n    {\n      src: { value: leftButton(\"y\").pressed },\n      dest: { value: paths.actions.leftHand.switchDrawMode },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: leftButton(\"x\").pressed },\n      dest: { value: paths.actions.leftHand.undoDrawing },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.cursorHoveringOnInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rightGripRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: rightTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [rightGripRisingGrab],\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.any,\n      priority: 2\n    }\n  ],\n\n  [sets.cursorHoldingUI]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: cursorDrop2 },\n      xform: xforms.falling,\n      priority: 5\n    }\n  ],\n\n  [sets.cursorHoldingInteractable]: [\n    {\n      src: { value: rightAxis(\"joyY\") },\n      dest: { value: paths.actions.cursor.modDelta },\n      xform: xforms.scale(0.1)\n    },\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: cursorDrop1 },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: [cursorDrop1, cursorDrop2],\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.any,\n      priority: 2\n    },\n    {\n      src: {},\n      dest: { value: ensureFrozenViaButtons },\n      priority: 1,\n      xform: xforms.always(false)\n    }\n  ],\n\n  [sets.cursorHoveringOnPen]: [],\n\n  [sets.cursorHoldingPen]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: rightButton(\"b\").pressed },\n      dest: { value: paths.actions.cursor.undoDrawing },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.rightHandHoveringOnInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rightGripRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: rightTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [rightGripRisingGrab],\n      dest: { value: paths.actions.rightHand.grab },\n      xform: xforms.any,\n      priority: 2\n    }\n  ],\n\n  [sets.rightHandHoldingInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: {\n        value: rightHandDrop2\n      },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: [rightHandDrop2],\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.any,\n      priority: 2\n    },\n    {\n      src: {},\n      dest: { value: ensureFrozenViaButtons },\n      priority: 1,\n      xform: xforms.always(false)\n    }\n  ],\n  [sets.rightHandHoveringOnPen]: [],\n  [sets.rightHandHoldingPen]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        value: rightDpadEast\n      },\n      dest: {\n        value: paths.actions.rightHand.penNextColor\n      },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: {\n        value: rightDpadWest\n      },\n      dest: {\n        value: paths.actions.rightHand.penPrevColor\n      },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: {\n        value: rightAxis(\"joyY\")\n      },\n      dest: {\n        value: rightJoyYDeadzoned\n      },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: rightJoyYDeadzoned },\n      dest: { value: paths.actions.rightHand.scalePenTip },\n      xform: xforms.scaleExp(-0.005, 5),\n      priority: 2\n    },\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: { value: rightButton(\"b\").pressed },\n      dest: { value: paths.actions.rightHand.switchDrawMode },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: rightButton(\"a\").pressed },\n      dest: { value: paths.actions.rightHand.undoDrawing },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.cursorHoveringOnCamera]: [],\n  [sets.rightHandHoveringOnCamera]: [],\n  [sets.leftHandHoveringOnCamera]: [],\n\n  [sets.rightHandHoldingCamera]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.takeSnapshot },\n      xform: xforms.copy,\n      priority: 4\n    }\n  ],\n  [sets.leftHandHoldingCamera]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.takeSnapshot },\n      xform: xforms.copy,\n      priority: 4\n    }\n  ],\n  [sets.cursorHoldingCamera]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.takeSnapshot },\n      xform: xforms.copy,\n      priority: 4\n    }\n  ],\n\n  [sets.rightHandHoveringOnNothing]: [],\n  [sets.inputFocused]: [\n    {\n      src: { value: \"/device/keyboard\" },\n      dest: { value: paths.noop },\n      xform: xforms.noop,\n      priority: 1000\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst v = name => {\n  return `/vive-user/vive-var/${name}`;\n};\n\nconst lButton = paths.device.vive.left.button;\nconst lAxis = paths.device.vive.left.axis;\nconst lPose = paths.device.vive.left.pose;\nconst lJoyScaled = v(\"left/joy/scaled\");\nconst lJoyXScaled = v(\"left/joyX/scaled\");\nconst lJoyYScaled = v(\"left/joyY/scaled\");\nconst lTouch = v(\"left/touch\");\nconst lTouchScaled = v(\"left/touch/scaled\");\nconst lTouchXScaled = v(\"left/touchX/scaled\");\nconst lTouchYScaled = v(\"left/touchY/scaled\");\nconst lDpadNorth = v(\"left/dpad/north\");\nconst lDpadSouth = v(\"left/dpad/south\");\nconst lDpadEast = v(\"left/dpad/east\");\nconst lDpadWest = v(\"left/dpad/west\");\nconst lDpadCenter = v(\"left/dpad/center\");\nconst lTriggerFallingStopDrawing = v(\"left/trigger/falling/stopDrawing\");\nconst lGripFallingStopDrawing = v(\"left/grip/falling/stopDrawing\");\nconst lTriggerRisingGrab = v(\"left/trigger/rising/grab\");\nconst lGripRisingGrab = v(\"left/grab/rising/grab\");\nconst lTouchpadRising2 = v(\"left/touchpad/rising2\");\nconst lTouchpadRising1 = v(\"left/touchpad/rising1\");\nconst touchCharacterAcceleration = v(\"left/touch/characterAcceleration\");\nconst lCharacterAcceleration = v(\"left/characterAcceleration\");\nconst characterAcceleration = v(\"nonNormalizedCharacterAcceleration\");\nconst leftBoost = v(\"left/boost\");\n\nconst rButton = paths.device.vive.right.button;\nconst rAxis = paths.device.vive.right.axis;\nconst rPose = paths.device.vive.right.pose;\nconst rTouch = v(\"right/touch\");\nconst rJoy = v(\"right/joy\");\nconst rDpadNorth1 = v(\"right/dpad/north\");\nconst rDpadSouth1 = v(\"right/dpad/south\");\nconst rDpadEast1 = v(\"right/dpad/east\");\nconst rDpadWest1 = v(\"right/dpad/west\");\nconst rDpadCenter1 = v(\"right/dpad/center\");\nconst rDpadNorth2 = v(\"right/dpad/north2\");\nconst rDpadSouth2 = v(\"right/dpad/south2\");\nconst rDpadEast2 = v(\"right/dpad/east2\");\nconst rDpadWest2 = v(\"right/dpad/west2\");\nconst rDpadCenter2 = v(\"right/dpad/center2\");\nconst rDpadCenterStrip = v(\"right/dpad/centerStrip\");\nconst rTouchpadRising = v(\"right/touchpad/rising\");\nconst rTouchpadFalling = v(\"right/touchpad/falling\");\nconst rightBoost = v(\"right/boost\");\nconst rTriggerRisingGrab = v(\"right/trigger/rising/grab\");\nconst rGripRisingGrab = v(\"right/grab/rising/grab\");\nconst cursorDrop1 = v(\"right/cursorDrop1\");\nconst cursorDrop2 = v(\"right/cursorDrop2\");\nconst rTriggerStopTeleport = v(\"right/trigger/stopTeleport\");\nconst rTouchpadStopTeleport = v(\"right/touchpad/stopTeleport\");\nconst rootForFrozenOverrideWhenHolding = \"rootForFrozenOverrideWhenHolding\";\n\nconst ensureFrozenViaDpad = v(\"dpad/ensureFrozen\");\nconst ensureFrozenViaKeyboard = v(\"keyboard/ensureFrozen\");\n\nconst thawViaDpad = v(\"dpad/thaw\");\nconst thawViaKeyboard = v(\"keyboard/thaw\");\n\nconst rSnapRight1 = v(\"right/snap-right\");\nconst rSnapLeft1 = v(\"right/snap-left\");\nconst rSnapRight2 = v(\"right/snap-right2\");\nconst rSnapLeft2 = v(\"right/snap-left2\");\n\nconst k = name => {\n  return `/vive-user/keyboard-var/${name}`;\n};\nconst keyboardSnapRight = k(\"snap-right\");\nconst keyboardSnapLeft = k(\"snap-left\");\nconst keyboardCharacterAcceleration = k(\"characterAcceleration\");\nconst wasd_vec2 = k(\"wasd_vec2\");\nconst arrows_vec2 = k(\"arrows_vec2\");\nconst keyboardBoost = k(\"boost\");\n\nconst leftGripPressed1 = v(\"leftGripPressed1\");\nconst leftGripPressed2 = v(\"leftGripPressed2\");\nconst rightGripPressed1 = v(\"rightGripPressed1\");\nconst rightGripPressed2 = v(\"rightGripPressed2\");\nconst leftTriggerPressed1 = v(\"leftTriggerPressed1\");\nconst leftTriggerPressed2 = v(\"leftTriggerPressed2\");\nconst leftTouchpadPressed1 = v(\"leftTouchpadPressed1\");\nconst leftTouchpadPressed2 = v(\"leftTouchpadPressed2\");\nconst rightTriggerPressed1 = v(\"rightTriggerPressed1\");\nconst rightTriggerPressed2 = v(\"rightTriggerPressed2\");\nconst leftTouchpadFallingStopTeleport = v(\"leftTouchpadFallingStopTeleport\");\nconst leftTriggerFallingStopTeleport = v(\"leftTriggerFallingStopTeleport\");\nconst leftGripFallingWhileHoldingPen = v(\"leftGripFallingWhileHoldingPen\");\n\nexport const viveUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: {\n        value: paths.device.vive.left.matrix\n      },\n      dest: {\n        value: paths.actions.leftHand.matrix\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: paths.device.vive.right.matrix\n      },\n      dest: {\n        value: paths.actions.rightHand.matrix\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [ensureFrozenViaDpad, ensureFrozenViaKeyboard],\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.any\n    },\n    {\n      src: [thawViaDpad, thawViaKeyboard],\n      dest: { value: paths.actions.thaw },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: lButton(\"grip\").pressed\n      },\n      dest: {\n        value: leftGripPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: leftGripPressed1\n      },\n      dest: {\n        value: paths.actions.leftHand.middleRingPinky\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: lButton(\"grip\").pressed\n      },\n      dest: {\n        value: leftGripPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [lButton(\"touchpad\").touched, lButton(\"top\").touched],\n      dest: {\n        value: paths.actions.leftHand.thumb\n      },\n      xform: xforms.any\n    },\n    {\n      src: { value: leftTriggerPressed1 },\n      dest: {\n        value: paths.actions.leftHand.index\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: lButton(\"trigger\").pressed },\n      dest: {\n        value: leftTriggerPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: { value: lButton(\"trigger\").pressed },\n      dest: {\n        value: leftTriggerPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rButton(\"grip\").pressed\n      },\n      dest: {\n        value: rightGripPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rButton(\"grip\").pressed\n      },\n      dest: {\n        value: rightGripPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rightGripPressed1\n      },\n      dest: {\n        value: paths.actions.rightHand.middleRingPinky\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [rButton(\"touchpad\").touched, rButton(\"top\").touched],\n      dest: {\n        value: paths.actions.rightHand.thumb\n      },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: rButton(\"trigger\").pressed\n      },\n      dest: { value: rightTriggerPressed1 },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rButton(\"trigger\").pressed\n      },\n      dest: { value: rightTriggerPressed2 },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rightTriggerPressed1 },\n      dest: {\n        value: paths.actions.rightHand.index\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: lAxis(\"touchX\"),\n        y: lAxis(\"touchY\")\n      },\n      dest: {\n        value: lTouch\n      },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: lTouch\n      },\n      dest: {\n        north: lDpadNorth,\n        south: lDpadSouth,\n        east: lDpadEast,\n        west: lDpadWest,\n        center: lDpadCenter\n      },\n      xform: xforms.vec2dpad(0.35)\n    },\n    {\n      src: {\n        value: lButton(\"touchpad\").pressed\n      },\n      dest: {\n        value: leftTouchpadPressed1\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: lButton(\"touchpad\").pressed\n      },\n      dest: {\n        value: leftTouchpadPressed2\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: rAxis(\"touchX\"),\n        y: rAxis(\"touchY\")\n      },\n      dest: {\n        value: rTouch\n      },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: rTouch\n      },\n      dest: {\n        north: rDpadNorth1,\n        south: rDpadSouth1,\n        east: rDpadEast1,\n        west: rDpadWest1,\n        center: rDpadCenter1\n      },\n      xform: xforms.vec2dpad(0.35, false, true)\n    },\n    {\n      src: {\n        x: rAxis(\"joyX\"),\n        y: rAxis(\"joyY\")\n      },\n      dest: {\n        value: rJoy\n      },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: rJoy\n      },\n      dest: {\n        north: rDpadNorth2,\n        south: rDpadSouth2,\n        east: rDpadEast2,\n        west: rDpadWest2,\n        center: rDpadCenter2\n      },\n      xform: xforms.vec2dpad(0.35, false, true)\n    },\n    {\n      src: [rDpadNorth1, rDpadSouth1, rDpadCenter1],\n      dest: { value: rDpadCenterStrip },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: rButton(\"touchpad\").pressed\n      },\n      dest: {\n        value: rTouchpadRising\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: rButton(\"touchpad\").pressed\n      },\n      dest: {\n        value: rTouchpadFalling\n      },\n      xform: xforms.falling\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadEast1\n      },\n      dest: {\n        value: rSnapRight1\n      },\n      xform: xforms.copyIfTrue,\n      priority: 1\n    },\n    {\n      src: {\n        value: rDpadEast2\n      },\n      dest: {\n        value: rSnapRight2\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"e\") },\n      dest: { value: keyboardSnapRight },\n      xform: xforms.rising\n    },\n    {\n      src: [rSnapRight1, rSnapRight2, keyboardSnapRight],\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.any\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Tab\") },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: ensureFrozenViaKeyboard },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: thawViaKeyboard },\n      xform: xforms.falling\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"p\") },\n      dest: { value: paths.actions.spawnPen },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"c\") },\n      dest: { value: paths.actions.toggleCamera },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"x\") },\n      dest: { value: paths.actions.takeSnapshot },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rButton(\"touchpad\").pressed, bool: rDpadCenterStrip },\n      dest: { value: ensureFrozenViaDpad },\n      root: rootForFrozenOverrideWhenHolding,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: rTouchpadFalling },\n      dest: { value: thawViaDpad },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadWest1\n      },\n      dest: {\n        value: rSnapLeft1\n      },\n      xform: xforms.copyIfTrue,\n      priority: 1\n    },\n    {\n      src: {\n        value: rDpadWest2\n      },\n      dest: {\n        value: rSnapLeft2\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"q\") },\n      dest: { value: keyboardSnapLeft },\n      xform: xforms.rising\n    },\n    {\n      src: [rSnapLeft1, rSnapLeft2, keyboardSnapLeft],\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: lAxis(\"touchX\")\n      },\n      dest: {\n        value: lTouchXScaled\n      },\n      xform: xforms.scale(1.5) // horizontal character speed modifier\n    },\n    {\n      src: {\n        value: lAxis(\"touchY\")\n      },\n      dest: { value: lTouchYScaled },\n      xform: xforms.scale(1.5) // vertical character speed modifier\n    },\n    {\n      src: {\n        x: lTouchXScaled,\n        y: lTouchYScaled\n      },\n      dest: { value: lTouchScaled },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        bool: leftTouchpadPressed2,\n        value: lTouchScaled\n      },\n      dest: { value: touchCharacterAcceleration },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: {\n        value: lAxis(\"joyX\")\n      },\n      dest: {\n        value: lJoyXScaled\n      },\n      xform: xforms.scale(1.5) // horizontal character speed modifier\n    },\n    {\n      src: {\n        value: lAxis(\"joyY\")\n      },\n      dest: { value: lJoyYScaled },\n      xform: xforms.scale(1.5) // vertical character speed modifier\n    },\n    {\n      src: {\n        x: lJoyXScaled,\n        y: lJoyYScaled\n      },\n      dest: { value: lJoyScaled },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        first: lJoyScaled,\n        second: touchCharacterAcceleration\n      },\n      dest: { value: lCharacterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"arrowup\"),\n        a: paths.device.keyboard.key(\"arrowleft\"),\n        s: paths.device.keyboard.key(\"arrowdown\"),\n        d: paths.device.keyboard.key(\"arrowright\")\n      },\n      dest: { vec2: arrows_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"w\"),\n        a: paths.device.keyboard.key(\"a\"),\n        s: paths.device.keyboard.key(\"s\"),\n        d: paths.device.keyboard.key(\"d\")\n      },\n      dest: { vec2: wasd_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"t\")\n      },\n      dest: {\n        value: paths.actions.focusChat\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"/\")\n      },\n      dest: {\n        value: paths.actions.focusChatCommand\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: paths.actions.mediaExit },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"1\")\n      },\n      dest: { value: \"/var/shift+1\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+1\" },\n      dest: { value: paths.actions.mediaSearch1 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"2\")\n      },\n      dest: { value: \"/var/shift+2\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+2\" },\n      dest: { value: paths.actions.mediaSearch2 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"3\")\n      },\n      dest: { value: \"/var/shift+3\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+3\" },\n      dest: { value: paths.actions.mediaSearch3 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"4\")\n      },\n      dest: { value: \"/var/shift+4\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+4\" },\n      dest: { value: paths.actions.mediaSearch4 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"5\")\n      },\n      dest: { value: \"/var/shift+5\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+5\" },\n      dest: { value: paths.actions.mediaSearch5 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"6\")\n      },\n      dest: { value: \"/var/shift+6\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+6\" },\n      dest: { value: paths.actions.mediaSearch6 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"7\")\n      },\n      dest: { value: \"/var/shift+7\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+7\" },\n      dest: { value: paths.actions.mediaSearch7 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"8\")\n      },\n      dest: { value: \"/var/shift+8\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+8\" },\n      dest: { value: paths.actions.mediaSearch8 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"l\")\n      },\n      dest: {\n        value: paths.actions.logDebugFrame\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"k\")\n      },\n      dest: {\n        value: paths.actions.logInteractionState\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"m\")\n      },\n      dest: {\n        value: paths.actions.muteMic\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        first: wasd_vec2,\n        second: arrows_vec2\n      },\n      dest: { value: keyboardCharacterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: {\n        first: lCharacterAcceleration,\n        second: keyboardCharacterAcceleration\n      },\n      dest: {\n        value: characterAcceleration\n      },\n      xform: xforms.max_vec2\n    },\n    {\n      src: { value: characterAcceleration },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.normalize_vec2\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"shift\") },\n      dest: { value: keyboardBoost },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: lButton(\"top\").pressed\n      },\n      dest: {\n        value: leftBoost\n      },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: rButton(\"top\").pressed\n      },\n      dest: {\n        value: rightBoost\n      },\n      xform: xforms.copy\n    },\n    {\n      src: [keyboardBoost, leftBoost, rightBoost],\n      dest: { value: paths.actions.boost },\n      xform: xforms.any\n    },\n    {\n      src: { value: rPose },\n      dest: { value: paths.actions.cursor.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: rPose },\n      dest: { value: paths.actions.rightHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: lPose },\n      dest: { value: paths.actions.leftHand.pose },\n      xform: xforms.copy\n    }\n  ],\n  [sets.rightHandTeleporting]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: rTriggerStopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: { value: rButton(\"touchpad\").pressed },\n      dest: { value: rTouchpadStopTeleport },\n      xform: xforms.falling\n    },\n    {\n      src: [rTriggerStopTeleport, rTouchpadStopTeleport],\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.any\n    }\n  ],\n  [sets.leftHandHoveringOnNothing]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startTeleport },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.leftHandTeleporting]: [\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: leftTriggerFallingStopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: [leftTriggerFallingStopTeleport, leftTouchpadFallingStopTeleport, leftGripFallingWhileHoldingPen],\n      dest: { value: paths.actions.leftHand.stopTeleport },\n      xform: xforms.any\n    }\n  ],\n\n  [sets.rightHandHoveringOnNothing]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.cursorHoveringOnNothing]: [],\n\n  [sets.cursorHoveringOnUI]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.rising,\n      priority: 1\n    }\n  ],\n\n  [sets.cursorHoveringOnVideo]: [\n    {\n      src: {\n        value: rAxis(\"touchY\"),\n        touching: rButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.mediaVolumeMod },\n      xform: xforms.touch_axis_scroll(0.1)\n    },\n    {\n      src: {\n        value: rAxis(\"joyY\")\n      },\n      dest: { value: paths.actions.cursor.mediaVolumeMod },\n      xform: xforms.scale(0.02)\n    }\n  ],\n\n  [sets.leftHandHoveringOnInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: lGripRisingGrab },\n      xform: xforms.rising\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: lTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: [lGripRisingGrab],\n      dest: { value: paths.actions.leftHand.grab },\n      xform: xforms.any\n    }\n  ],\n\n  [sets.leftHandHoldingInteractable]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.falling,\n      priority: 1\n    }\n  ],\n\n  [sets.leftHandHoveringOnPen]: [],\n  [sets.leftHandHoldingPen]: [\n    {\n      src: { value: leftTouchpadPressed2 },\n      dest: { value: leftTouchpadFallingStopTeleport },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: {\n        value: leftTouchpadPressed2\n      },\n      dest: {\n        value: lTouchpadRising1\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: {\n        bool: lTouchpadRising1,\n        value: lDpadCenter\n      },\n      dest: { value: paths.actions.leftHand.startTeleport },\n      xform: xforms.copyIfTrue,\n      priority: 1\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: paths.actions.leftHand.startDrawing },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: leftTriggerPressed2 },\n      dest: { value: lTriggerFallingStopDrawing },\n      xform: xforms.falling,\n      priority: 2\n    },\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: lGripFallingStopDrawing },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: leftGripFallingWhileHoldingPen },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: [lTriggerFallingStopDrawing, lGripFallingStopDrawing],\n      dest: { value: paths.actions.leftHand.stopDrawing },\n      xform: xforms.any\n    },\n    {\n      src: {\n        value: leftTouchpadPressed2\n      },\n      dest: {\n        value: lTouchpadRising2\n      },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: {\n        bool: lTouchpadRising2,\n        value: lDpadNorth\n      },\n      dest: {\n        value: paths.actions.leftHand.penNextColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        bool: lTouchpadRising2,\n        value: lDpadSouth\n      },\n      dest: {\n        value: paths.actions.leftHand.penPrevColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        value: lAxis(\"touchX\"),\n        touching: lButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.leftHand.scalePenTip },\n      xform: xforms.touch_axis_scroll(0.05)\n    },\n    {\n      src: { value: rButton(\"top\").pressed },\n      dest: { value: paths.actions.leftHand.undoDrawing },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: lButton(\"top\").pressed },\n      dest: { value: paths.actions.leftHand.switchDrawMode },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.cursorHoveringOnInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rGripRisingGrab },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: rTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: [rGripRisingGrab],\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.any\n    }\n  ],\n\n  [sets.cursorHoldingUI]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: {\n        value: cursorDrop2\n      },\n      xform: xforms.falling,\n      priority: 4\n    }\n  ],\n\n  [sets.cursorHoldingInteractable]: [\n    {\n      src: {\n        value: rAxis(\"touchY\"),\n        touching: rButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.modDelta },\n      xform: xforms.touch_axis_scroll(-1)\n    },\n    {\n      src: {\n        value: rAxis(\"joyY\")\n      },\n      dest: { value: paths.actions.cursor.modDelta },\n      xform: xforms.scale(-0.02)\n    },\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: cursorDrop1 },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: [cursorDrop1, cursorDrop2],\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.any\n    },\n    {\n      src: {},\n      dest: { value: ensureFrozenViaDpad },\n      root: rootForFrozenOverrideWhenHolding,\n      xform: xforms.always(false)\n    }\n  ],\n\n  [sets.cursorHoveringOnPen]: [],\n\n  [sets.cursorHoldingPen]: [\n    {\n      src: [cursorDrop1],\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.noop,\n      priority: 1\n    },\n    {\n      src: [cursorDrop2],\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.noop,\n      priority: 1\n    },\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.rising,\n      priority: 1\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadCenter1\n      },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        value: rAxis(\"touchX\"),\n        touching: rButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.scalePenTip },\n      xform: xforms.touch_axis_scroll(0.1)\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadNorth1\n      },\n      dest: {\n        value: paths.actions.cursor.penNextColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadSouth1\n      },\n      dest: {\n        value: paths.actions.cursor.penPrevColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: { value: rButton(\"top\").pressed },\n      dest: { value: paths.actions.cursor.undoDrawing },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.rightHandHoveringOnInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: rGripRisingGrab },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: rTriggerRisingGrab },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: [rGripRisingGrab],\n      dest: { value: paths.actions.rightHand.grab },\n      xform: xforms.any\n    }\n  ],\n\n  [sets.rightHandHoldingInteractable]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.falling,\n      priority: 1\n    },\n    {\n      src: {},\n      dest: { value: ensureFrozenViaDpad },\n      root: rootForFrozenOverrideWhenHolding,\n      xform: xforms.always(false)\n    }\n  ],\n  [sets.rightHandHoveringOnPen]: [],\n  [sets.rightHandHoldingPen]: [\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadCenter1\n      },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.startDrawing },\n      xform: xforms.rising,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.stopDrawing },\n      xform: xforms.falling,\n      priority: 3\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadNorth1\n      },\n      dest: {\n        value: paths.actions.rightHand.penNextColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        bool: rTouchpadRising,\n        value: rDpadSouth1\n      },\n      dest: {\n        value: paths.actions.rightHand.penPrevColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 2\n    },\n    {\n      src: {\n        value: rAxis(\"touchX\"),\n        touching: rButton(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.rightHand.scalePenTip },\n      xform: xforms.touch_axis_scroll(0.05)\n    },\n    {\n      src: { value: lButton(\"top\").pressed },\n      dest: { value: paths.actions.rightHand.undoDrawing },\n      xform: xforms.rising,\n      priority: 2\n    },\n    {\n      src: { value: rButton(\"top\").pressed },\n      dest: { value: paths.actions.rightHand.switchDrawMode },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n\n  [sets.cursorHoveringOnCamera]: [],\n  [sets.rightHandHoveringOnCamera]: [],\n  [sets.leftHandHoveringOnCamera]: [],\n\n  [sets.rightHandHoldingCamera]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.rightHand.takeSnapshot },\n      xform: xforms.copy,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.noop },\n      xform: xforms.falling,\n      priority: 3\n    }\n  ],\n  [sets.leftHandHoldingCamera]: [\n    {\n      src: { value: lButton(\"trigger\").pressed },\n      dest: { value: paths.actions.leftHand.takeSnapshot },\n      xform: xforms.copy\n    }\n  ],\n  [sets.cursorHoldingCamera]: [\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.actions.cursor.takeSnapshot },\n      xform: xforms.copy,\n      priority: 3\n    },\n    {\n      src: { value: rightTriggerPressed2 },\n      dest: { value: paths.noop },\n      xform: xforms.falling,\n      priority: 3\n    }\n  ],\n  [sets.inputFocused]: [\n    {\n      src: { value: \"/device/keyboard\" },\n      dest: { value: paths.noop },\n      xform: xforms.noop,\n      priority: 1000\n    }\n  ]\n});\n\nexport const viveWandUserBindings = addSetsToBindings({\n  [sets.leftHandHoldingPen]: [\n    {\n      src: { value: leftGripPressed2 },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ],\n  [sets.rightHandHoldingPen]: [\n    {\n      src: { value: rightGripPressed2 },\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.rising,\n      priority: 2\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst lGripPressed = paths.device.wmr.left.grip.pressed;\nconst rGripPressed = paths.device.wmr.right.grip.pressed;\nconst rTriggerPressed = paths.device.wmr.right.trigger.pressed;\n\nconst rJoyNorth = paths.device.wmr.v(\"right/joy/north\");\nconst rGripRising = paths.device.wmr.v(\"right/grip/rising\");\nconst rTriggerRising = paths.device.wmr.v(\"right/trigger/rising\");\nconst rGripFalling = paths.device.wmr.v(\"right/grip/falling\");\nconst rTriggerFalling = paths.device.wmr.v(\"right/trigger/falling\");\n\nfunction dpadVariables(hand) {\n  return {\n    padWest: paths.device.wmr.v(hand + \"/pad/west\"),\n    padEast: paths.device.wmr.v(hand + \"/pad/east\"),\n    padNorth: paths.device.wmr.v(hand + \"/pad/north\"),\n    padSouth: paths.device.wmr.v(hand + \"/pad/south\"),\n    padCenter: paths.device.wmr.v(hand + \"/pad/center\"),\n    padCenterStrip: paths.device.wmr.v(hand + \"/pad/centerStrip\")\n  };\n}\n\nfunction dpadBindings(hand) {\n  const { padWest, padEast, padNorth, padSouth, padCenter, padCenterStrip } = dpadVariables(hand);\n  const pad = paths.device.wmr.v(hand + \"/pad\");\n  return [\n    {\n      src: {\n        x: paths.device.wmr[hand].touchpad.axisX,\n        y: paths.device.wmr[hand].touchpad.axisY\n      },\n      dest: { value: pad },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: pad },\n      dest: {\n        west: padWest,\n        east: padEast,\n        north: padNorth,\n        south: padSouth,\n        center: padCenter\n      },\n      xform: xforms.vec2dpad(0.5, false, false)\n    },\n    {\n      src: [padNorth, padCenter, padSouth],\n      dest: { value: padCenterStrip },\n      xform: xforms.any\n    }\n  ];\n}\n\nconst neverFrozenBinding = {\n  src: {},\n  dest: { value: paths.actions.ensureFrozen },\n  xform: xforms.always(false)\n};\n\nfunction penBindings(hand, forCursor) {\n  const padY = paths.device.wmr[hand].touchpad.axisY;\n  const triggerPressed = paths.device.wmr[hand].trigger.pressed;\n  const padPressed = paths.device.wmr[hand].touchpad.pressed;\n  const padTouched = paths.device.wmr[hand].touchpad.touched;\n\n  const padRising = paths.device.wmr.v(hand + \"/pad/rising\");\n  const padCenterStripTouched = paths.device.wmr.v(hand + \"/pad/centerStrip/touched\");\n  const { padWest, padEast, padCenter, padCenterStrip } = dpadVariables(hand);\n\n  const actions = paths.actions[forCursor ? \"cursor\" : hand + \"Hand\"];\n\n  return [\n    neverFrozenBinding,\n    ...dpadBindings(hand),\n    {\n      src: { value: triggerPressed },\n      dest: { value: actions.startDrawing },\n      xform: xforms.rising\n    },\n    {\n      src: { value: triggerPressed },\n      dest: { value: actions.stopDrawing },\n      xform: xforms.falling\n    },\n    {\n      src: { value: padPressed },\n      dest: { value: padRising },\n      xform: xforms.rising\n    },\n    {\n      src: { bool: padRising, value: padWest },\n      dest: { value: actions.penPrevColor },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { bool: padRising, value: padEast },\n      dest: { value: actions.penNextColor },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: [padCenterStrip, padTouched],\n      dest: { value: padCenterStripTouched },\n      xform: xforms.all\n    },\n    {\n      src: { value: padY, touching: padCenterStripTouched },\n      dest: { value: actions.scalePenTip },\n      xform: xforms.touch_axis_scroll(-0.05)\n    },\n    {\n      src: [padRising, padCenter],\n      dest: { value: actions.undoDrawing },\n      xform: xforms.all\n    }\n  ];\n}\n\nfunction handPoseBindings(hand) {\n  const padTouched = paths.device.wmr[hand].touchpad.touched;\n  const triggerPressed = paths.device.wmr[hand].trigger.pressed;\n  const gripPressed = paths.device.wmr[hand].grip.pressed;\n  const actions = paths.actions[hand + \"Hand\"];\n  return [\n    {\n      src: { value: padTouched },\n      dest: { value: actions.thumb },\n      xform: xforms.copy\n    },\n    {\n      src: { value: triggerPressed },\n      dest: { value: actions.index },\n      xform: xforms.copy\n    },\n    {\n      src: { value: gripPressed },\n      dest: { value: actions.middleRingPinky },\n      xform: xforms.copy\n    }\n  ];\n}\n\nfunction freezeBindings() {\n  const leftPadPressed = paths.device.wmr.left.touchpad.pressed;\n  const rightPadPressed = paths.device.wmr.right.touchpad.pressed;\n  const leftPadFalling = paths.device.wmr.v(\"left/touchpad/falling\");\n  const rightPadFalling = paths.device.wmr.v(\"right/touchpad/falling\");\n  const keyboardSaceFalling = paths.device.wmr.k(\"space/falling\");\n  return [\n    {\n      src: [paths.device.keyboard.key(\" \"), leftPadPressed, rightPadPressed],\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.any\n    },\n    {\n      src: { value: paths.device.keyboard.key(\" \") },\n      dest: { value: keyboardSaceFalling },\n      xform: xforms.falling\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Tab\") },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.rising\n    },\n    {\n      src: { value: leftPadPressed },\n      dest: { value: leftPadFalling },\n      xform: xforms.falling\n    },\n    {\n      src: { value: rightPadPressed },\n      dest: { value: rightPadFalling },\n      xform: xforms.falling\n    },\n    {\n      src: [keyboardSaceFalling, leftPadFalling, rightPadFalling],\n      dest: { value: paths.actions.thaw },\n      xform: xforms.any\n    }\n  ];\n}\n\nfunction characterAccelerationBindings() {\n  const wasd_vec2 = paths.device.wmr.k(\"wasd_vec2\");\n  const arrows_vec2 = paths.device.wmr.k(\"arrows_vec2\");\n  const keyboardCharacterAcceleration = paths.device.wmr.k(\"characterAcceleration\");\n  const lJoyXDeadzoned = paths.device.wmr.v(\"left/joy/x/deadzoned\");\n  const lJoyYDeadzoned = paths.device.wmr.v(\"left/joy/y/deadzoned\");\n  const lJoyXScaled = paths.device.wmr.v(\"left/joy/x/scaled\");\n  const lJoyYScaled = paths.device.wmr.v(\"left/joy/y/scaled\");\n  const lCharacterAcceleration = paths.device.wmr.v(\"left/characterAcceleration\");\n  return [\n    {\n      src: {\n        w: paths.device.keyboard.key(\"arrowup\"),\n        a: paths.device.keyboard.key(\"arrowleft\"),\n        s: paths.device.keyboard.key(\"arrowdown\"),\n        d: paths.device.keyboard.key(\"arrowright\")\n      },\n      dest: { vec2: arrows_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        w: paths.device.keyboard.key(\"w\"),\n        a: paths.device.keyboard.key(\"a\"),\n        s: paths.device.keyboard.key(\"s\"),\n        d: paths.device.keyboard.key(\"d\")\n      },\n      dest: { vec2: wasd_vec2 },\n      xform: xforms.wasd_to_vec2\n    },\n    {\n      src: {\n        first: wasd_vec2,\n        second: arrows_vec2\n      },\n      dest: { value: keyboardCharacterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: { value: paths.device.wmr.left.joystick.axisX },\n      dest: { value: lJoyXDeadzoned },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: lJoyXDeadzoned },\n      dest: { value: lJoyXScaled },\n      xform: xforms.scale(1.5) // horizontal character speed modifier\n    },\n    {\n      src: { value: paths.device.wmr.left.joystick.axisY },\n      dest: { value: lJoyYDeadzoned },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: lJoyYDeadzoned },\n      dest: { value: lJoyYScaled },\n      xform: xforms.scale(-1.5) // vertical character speed modifier\n    },\n    {\n      src: { x: lJoyXScaled, y: lJoyYScaled },\n      dest: { value: lCharacterAcceleration },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        first: lCharacterAcceleration,\n        second: keyboardCharacterAcceleration\n      },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.max_vec2\n    },\n    {\n      src: [\n        paths.device.wmr.left.trigger.pressed,\n        paths.device.wmr.right.trigger.pressed,\n        paths.device.keyboard.key(\"shift\")\n      ],\n      dest: { value: paths.actions.boost },\n      xform: xforms.any\n    }\n  ];\n}\n\nfunction cursorModDeltaBindings() {\n  const { padNorth, padSouth } = dpadVariables(\"right\");\n  const rPadNorthOrSouth = paths.device.wmr.v(\"right/pad/northOrSouth\");\n  const rPadNorthOrSouthPressed = paths.device.wmr.v(\"right/pad/northOrSouth/pressed\");\n  const rPadNorthOrSouthPressedY = paths.device.wmr.v(\"right/pad/northOrSouthpressed/y\");\n  return [\n    ...dpadBindings(\"right\"),\n    {\n      src: [padNorth, padSouth],\n      dest: { value: rPadNorthOrSouth },\n      xform: xforms.any\n    },\n    {\n      src: [rPadNorthOrSouth, paths.device.wmr.right.touchpad.pressed],\n      dest: { value: rPadNorthOrSouthPressed },\n      xform: xforms.all\n    },\n    {\n      src: {\n        bool: rPadNorthOrSouthPressed,\n        value: paths.device.wmr.right.touchpad.axisY\n      },\n      dest: { value: rPadNorthOrSouthPressedY },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: rPadNorthOrSouthPressedY },\n      dest: { value: paths.actions.cursor.modDelta },\n      xform: xforms.scale(0.1)\n    }\n  ];\n}\n\nfunction cursorMediaVolumeModBindings() {\n  const hand = \"right\";\n  const padY = paths.device.wmr[hand].touchpad.axisY;\n  const padTouched = paths.device.wmr[hand].touchpad.touched;\n\n  const padCenterStripTouched = paths.device.wmr.v(hand + \"/pad/centerStrip/touched\");\n  const { padCenterStrip } = dpadVariables(hand);\n\n  return [\n    ...dpadBindings(hand),\n    {\n      src: [padCenterStrip, padTouched],\n      dest: { value: padCenterStripTouched },\n      xform: xforms.all\n    },\n    {\n      src: { value: padY, touching: padCenterStripTouched },\n      dest: { value: paths.actions.cursor.mediaVolumeMod },\n      xform: xforms.touch_axis_scroll(-0.1)\n    }\n  ];\n}\n\nfunction holdingCameraBindings(hand, forCursor) {\n  const actions = paths.actions[forCursor ? \"cursor\" : hand + \"Hand\"];\n  return [\n    neverFrozenBinding,\n    {\n      src: { value: paths.device.wmr[hand].trigger.pressed },\n      dest: { value: actions.takeSnapshot },\n      xform: xforms.copy\n    }\n  ];\n}\n\nfunction teleportationAndRotationBindings() {\n  const rJoy = paths.device.wmr.v(\"right/joy\");\n  const rJoyWest = paths.device.wmr.v(\"right/joy/west\");\n  const rJoyEast = paths.device.wmr.v(\"right/joy/East\");\n  const rJoyWestRising = paths.device.wmr.v(\"right/joy/west/rising\");\n  const rJoyEastRising = paths.device.wmr.v(\"right/joy/east/rising\");\n  const keyboardQRising = paths.device.wmr.k(\"q/rising\");\n  const keyboardERising = paths.device.wmr.k(\"e/rising\");\n  return [\n    {\n      src: {\n        x: paths.device.wmr.right.joystick.axisX,\n        y: paths.device.wmr.right.joystick.axisY\n      },\n      dest: { value: rJoy },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: rJoy },\n      dest: {\n        north: rJoyNorth,\n        west: rJoyWest,\n        east: rJoyEast\n      },\n      xform: xforms.vec2dpad(0.2, false, false)\n    },\n    {\n      src: { value: rJoyNorth },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rJoyWest },\n      dest: { value: rJoyWestRising },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rJoyEast },\n      dest: { value: rJoyEastRising },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"q\") },\n      dest: { value: keyboardQRising },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"e\") },\n      dest: { value: keyboardERising },\n      xform: xforms.rising\n    },\n    {\n      src: [rJoyWestRising, keyboardQRising],\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.any\n    },\n    {\n      src: [rJoyEastRising, keyboardERising],\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.any\n    }\n  ];\n}\n\nexport const wmrUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: { value: paths.device.wmr.left.matrix },\n      dest: { value: paths.actions.leftHand.matrix },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.wmr.right.matrix },\n      dest: { value: paths.actions.rightHand.matrix },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.wmr.left.pose },\n      dest: { value: paths.actions.leftHand.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.wmr.right.pose },\n      dest: { value: paths.actions.cursor.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.wmr.right.pose },\n      dest: { value: paths.actions.rightHand.pose },\n      xform: xforms.copy\n    },\n    ...handPoseBindings(\"left\"),\n    ...handPoseBindings(\"right\"),\n    ...freezeBindings(),\n    ...teleportationAndRotationBindings(),\n    ...characterAccelerationBindings(),\n    {\n      src: {\n        value: paths.device.keyboard.key(\"m\")\n      },\n      dest: {\n        value: paths.actions.muteMic\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"t\")\n      },\n      dest: {\n        value: paths.actions.focusChat\n      },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.keyboard.key(\"/\")\n      },\n      dest: {\n        value: paths.actions.focusChatCommand\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.keyboard.key(\"Escape\") },\n      dest: { value: paths.actions.mediaExit },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"1\")\n      },\n      dest: { value: \"/var/shift+1\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+1\" },\n      dest: { value: paths.actions.mediaSearch1 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"2\")\n      },\n      dest: { value: \"/var/shift+2\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+2\" },\n      dest: { value: paths.actions.mediaSearch2 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"3\")\n      },\n      dest: { value: \"/var/shift+3\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+3\" },\n      dest: { value: paths.actions.mediaSearch3 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"4\")\n      },\n      dest: { value: \"/var/shift+4\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+4\" },\n      dest: { value: paths.actions.mediaSearch4 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"5\")\n      },\n      dest: { value: \"/var/shift+5\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+5\" },\n      dest: { value: paths.actions.mediaSearch5 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"6\")\n      },\n      dest: { value: \"/var/shift+6\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+6\" },\n      dest: { value: paths.actions.mediaSearch6 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"7\")\n      },\n      dest: { value: \"/var/shift+7\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+7\" },\n      dest: { value: paths.actions.mediaSearch7 },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        bool: paths.device.keyboard.key(\"control\"),\n        value: paths.device.keyboard.key(\"8\")\n      },\n      dest: { value: \"/var/shift+8\" },\n      priority: 1001,\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: \"/var/shift+8\" },\n      dest: { value: paths.actions.mediaSearch8 },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.leftHandHoveringOnNothing]: [],\n  [sets.cursorHoveringOnNothing]: [],\n  [sets.rightHandHoveringOnNothing]: [],\n\n  [sets.rightHandTeleporting]: [\n    {\n      src: { value: rJoyNorth },\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.falling\n    }\n  ],\n\n  [sets.cursorHoveringOnUI]: [\n    {\n      src: { value: rTriggerPressed },\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.cursorHoveringOnVideo]: [...cursorMediaVolumeModBindings()],\n\n  [sets.leftHandHoveringOnInteractable]: [\n    {\n      src: { value: lGripPressed },\n      dest: { value: paths.actions.leftHand.grab },\n      xform: xforms.rising\n    }\n  ],\n  [sets.cursorHoveringOnInteractable]: [\n    {\n      src: { value: rGripPressed },\n      dest: { value: rGripRising },\n      xform: xforms.rising\n    },\n    {\n      src: { value: rTriggerPressed },\n      dest: { value: rTriggerRising },\n      xform: xforms.rising\n    },\n    {\n      src: [rGripRising, rTriggerRising],\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.any\n    }\n  ],\n  [sets.rightHandHoveringOnInteractable]: [\n    {\n      src: { value: rGripPressed },\n      dest: { value: paths.actions.rightHand.grab },\n      xform: xforms.rising\n    }\n  ],\n\n  [sets.leftHandHoldingInteractable]: [\n    neverFrozenBinding,\n    {\n      src: { value: lGripPressed },\n      dest: { value: paths.actions.leftHand.drop },\n      xform: xforms.falling\n    }\n  ],\n  [sets.cursorHoldingInteractable]: [\n    neverFrozenBinding,\n    ...cursorModDeltaBindings(),\n    {\n      src: { value: rGripPressed },\n      dest: { value: rGripFalling },\n      xform: xforms.falling\n    },\n    {\n      src: { value: rTriggerPressed },\n      dest: { value: rTriggerFalling },\n      xform: xforms.falling\n    },\n    {\n      src: [rGripFalling, rTriggerFalling],\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.any\n    }\n  ],\n  [sets.rightHandHoldingInteractable]: [\n    neverFrozenBinding,\n    {\n      src: { value: rGripPressed },\n      dest: { value: paths.actions.rightHand.drop },\n      xform: xforms.falling\n    }\n  ],\n\n  [sets.leftHandHoveringOnPen]: [],\n  [sets.cursorHoveringOnPen]: [],\n  [sets.rightHandHoveringOnPen]: [],\n\n  [sets.leftHandHoldingPen]: penBindings(\"left\"),\n  [sets.cursorHoldingPen]: penBindings(\"right\", true),\n  [sets.rightHandHoldingPen]: penBindings(\"right\"),\n\n  [sets.leftHandHoveringOnCamera]: [],\n  [sets.cursorHoveringOnCamera]: [],\n  [sets.rightHandHoveringOnCamera]: [],\n\n  [sets.leftHandHoldingCamera]: holdingCameraBindings(\"left\"),\n  [sets.cursorHoldingCamera]: holdingCameraBindings(\"right\", true),\n  [sets.rightHandHoldingCamera]: holdingCameraBindings(\"right\"),\n\n  [sets.inputFocused]: [\n    {\n      src: { value: \"/device/keyboard\" },\n      dest: { value: paths.noop },\n      xform: xforms.noop,\n      priority: 1000\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nconst button = paths.device.xbox.button;\nconst axis = paths.device.xbox.axis;\nconst scaledRightJoystickVertical = paths.device.xbox.v(\"scaledRightJoystickVertical\");\nconst scaledLeftJoystickCursorDelta = paths.device.xbox.v(\"scaledLeftJoystickCursorDelta\");\nconst deadzonedRightJoystickHorizontal = paths.device.xbox.v(\"deadzonedRightJoystickHorizontal\");\nconst deadzonedRightJoystickVertical = paths.device.xbox.v(\"deadzonedRightJoystickVertical\");\nconst deadzonedLeftJoystickHorizontal = paths.device.xbox.v(\"deadzonedLeftJoystickHorizontal\");\nconst deadzonedLeftJoystickVertical = paths.device.xbox.v(\"deadzonedLeftJoystickVertical\");\nconst vec2Zero = paths.device.xbox.v(\"vec2Zero\");\nconst zero = paths.device.xbox.v(\"zero\");\n\nfunction characterAccelerationBindings(disableForwardOnTrigger) {\n  const scaledLeftJoystickHorizontal = paths.device.xbox.v(\"scaledLeftJoystickHorizontal\");\n  const scaledLeftJoystickVertical = paths.device.xbox.v(\"scaledLeftJoystickVertical\");\n  const scaledLeftJoystickForwardAcceleration = paths.device.xbox.v(\"scaledLeftJoystickForwardAcceleration\");\n  return [\n    {\n      src: { value: deadzonedLeftJoystickHorizontal },\n      dest: { value: scaledLeftJoystickHorizontal },\n      xform: xforms.scale(1.5) // horizontal move speed modifier\n    },\n    {\n      src: { value: deadzonedLeftJoystickVertical },\n      dest: { value: scaledLeftJoystickVertical },\n      xform: xforms.scale(-1.25) // vertical move speed modifier\n    },\n    {\n      src: {\n        bool: button(\"leftTrigger\").pressed,\n        value: scaledLeftJoystickVertical\n      },\n      dest: { value: scaledLeftJoystickForwardAcceleration },\n      xform: disableForwardOnTrigger ? xforms.copyIfFalse : xforms.copy\n    },\n    {\n      src: {\n        x: scaledLeftJoystickHorizontal,\n        y: scaledLeftJoystickForwardAcceleration\n      },\n      dest: { value: paths.actions.characterAcceleration },\n      xform: xforms.compose_vec2\n    }\n  ];\n}\n\nexport const xboxControllerUserBindings = addSetsToBindings({\n  [sets.cursorHoldingPen]: [\n    {\n      src: { value: button(\"rightTrigger\").pressed },\n      dest: { value: paths.actions.cursor.startDrawing },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: { value: button(\"rightTrigger\").pressed },\n      dest: { value: paths.actions.cursor.stopDrawing },\n      xform: xforms.falling,\n      priority: 200\n    },\n    {\n      src: { value: button(\"b\").pressed },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.rising\n    },\n    {\n      src: { value: button(\"y\").pressed },\n      dest: { value: paths.actions.cursor.undoDrawing },\n      xform: xforms.rising,\n      priority: 200\n    },\n    {\n      src: { value: button(\"a\").pressed },\n      dest: { value: paths.actions.cursor.penNextColor },\n      xform: xforms.rising\n    },\n    {\n      src: { value: button(\"x\").pressed },\n      dest: { value: paths.actions.cursor.penPrevColor },\n      xform: xforms.rising\n    }\n  ],\n  [sets.global]: [\n    {\n      src: {},\n      dest: { value: paths.actions.cursor.hideLine },\n      xform: xforms.always(true)\n    },\n    {\n      src: { value: axis(\"rightJoystickHorizontal\") },\n      dest: { value: deadzonedRightJoystickHorizontal },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: deadzonedRightJoystickHorizontal },\n      dest: { value: paths.actions.angularVelocity },\n      xform: xforms.scale(0.6) // horizontal look speed modifier\n    },\n    {\n      src: { value: axis(\"rightJoystickVertical\") },\n      dest: { value: deadzonedRightJoystickVertical },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: deadzonedRightJoystickVertical },\n      dest: { value: scaledRightJoystickVertical },\n      xform: xforms.scale(-1.25) // vertical look speed modifier\n    },\n    {\n      src: {},\n      dest: { value: zero },\n      xform: xforms.always(0)\n    },\n    {\n      src: {\n        x: zero,\n        y: scaledRightJoystickVertical\n      },\n      dest: { value: paths.actions.cameraDelta },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: { value: paths.actions.cameraDelta },\n      dest: { value: paths.actions.lobbyCameraDelta },\n      xform: xforms.copy\n    },\n    {\n      src: { value: axis(\"leftJoystickHorizontal\") },\n      dest: { value: deadzonedLeftJoystickHorizontal },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: axis(\"leftJoystickVertical\") },\n      dest: { value: deadzonedLeftJoystickVertical },\n      xform: xforms.deadzone(0.1)\n    },\n    {\n      src: { value: button(\"leftTrigger\").pressed },\n      dest: { value: paths.actions.boost },\n      xform: xforms.copy\n    },\n    {\n      src: { value: button(\"leftBumper\").pressed },\n      dest: { value: paths.actions.snapRotateLeft },\n      xform: xforms.rising\n    },\n    {\n      src: { value: button(\"rightBumper\").pressed },\n      dest: { value: paths.actions.snapRotateRight },\n      xform: xforms.rising\n    },\n    {\n      src: {},\n      dest: { value: vec2Zero },\n      xform: xforms.vec2Zero\n    },\n    {\n      src: { value: vec2Zero },\n      dest: { value: paths.actions.cursor.pose },\n      xform: xforms.poseFromCameraProjection()\n    },\n    {\n      src: { value: button(\"y\").pressed },\n      dest: { value: paths.actions.spawnPen },\n      xform: xforms.rising,\n      priority: 100\n    },\n    {\n      src: { value: button(\"dpadUp\").pressed },\n      dest: { value: paths.actions.ensureFrozen },\n      xform: xforms.copy\n    },\n    {\n      src: { value: button(\"dpadUp\").pressed },\n      dest: { value: paths.actions.thaw },\n      xform: xforms.falling\n    },\n    {\n      src: { value: button(\"start\").pressed },\n      dest: { value: paths.actions.toggleFreeze },\n      xform: xforms.rising\n    },\n    {\n      src: { value: button(\"a\").pressed },\n      dest: { value: paths.actions.startGazeTeleport },\n      xform: xforms.rising\n    },\n    {\n      src: { value: button(\"a\").pressed },\n      dest: { value: paths.actions.stopGazeTeleport },\n      xform: xforms.falling\n    }\n  ],\n  [sets.cursorHoldingNothing]: [...characterAccelerationBindings()],\n  [sets.cursorHoldingInteractable]: [\n    ...characterAccelerationBindings(true),\n    {\n      src: { value: button(\"rightTrigger\").pressed },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.falling,\n      priority: 100\n    },\n    {\n      src: { value: deadzonedLeftJoystickVertical },\n      dest: { value: scaledLeftJoystickCursorDelta },\n      xform: xforms.scale(0.25)\n    },\n    {\n      src: {\n        bool: button(\"leftTrigger\").pressed,\n        value: scaledLeftJoystickCursorDelta\n      },\n      dest: { value: paths.actions.cursor.modDelta },\n      xform: xforms.copyIfTrue\n    }\n  ],\n  [sets.cursorHoveringOnUI]: [\n    {\n      src: { value: button(\"rightTrigger\").pressed },\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.rising\n    }\n  ],\n  [sets.cursorHoveringOnInteractable]: [\n    ...characterAccelerationBindings(),\n    {\n      src: { value: button(\"rightTrigger\").pressed },\n      dest: { value: paths.actions.cursor.grab },\n      xform: xforms.rising,\n      priority: 100\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\n// vars\nconst v = s => `/vars/daydream/${s}`;\nconst touchpad = v(\"touchpad/axis\");\nconst touchpadRising = v(\"touchpad/rising\");\nconst touchpadFalling = v(\"touchpad/falling\");\nconst touchpadPressed = v(\"touchpad/pressed\");\nconst dpadNorth = v(\"dpad/north\");\nconst dpadSouth = v(\"dpad/south\");\nconst dpadEast = v(\"dpad/east\");\nconst dpadWest = v(\"dpad/west\");\nconst dpadCenter = v(\"dpad/center\");\nconst brushSizeDelta = v(\"brushSizeDelta\");\nconst cursorModDelta = v(\"cursorModDelta\");\nconst dpadSouthDrop = v(\"dropSouth\");\nconst dpadCenterDrop = v(\"dropCenter\");\n\nconst grabBinding = [\n  {\n    src: { value: dpadCenter, bool: touchpadRising },\n    dest: { value: paths.actions.cursor.grab },\n    xform: xforms.copyIfTrue,\n    priority: 100\n  }\n];\n\nconst dropOnCenterOrSouth = [\n  {\n    src: { value: dpadCenter, bool: touchpadRising },\n    dest: { value: dpadCenterDrop },\n    xform: xforms.copyIfTrue,\n    priority: 100\n  },\n  {\n    src: { value: dpadSouth, bool: touchpadRising },\n    dest: { value: dpadSouthDrop },\n    xform: xforms.copyIfTrue,\n    priority: 100\n  },\n  {\n    src: [dpadCenterDrop, dpadSouthDrop],\n    dest: { value: paths.actions.cursor.drop },\n    xform: xforms.any\n  }\n];\n\nexport const daydreamUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: { value: paths.device.daydream.matrix },\n      dest: { value: paths.actions.rightHand.matrix },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        x: paths.device.daydream.axis(\"touchpadX\"),\n        y: paths.device.daydream.axis(\"touchpadY\")\n      },\n      dest: { value: touchpad },\n      xform: xforms.compose_vec2\n    },\n    {\n      src: {\n        value: paths.device.daydream.button(\"touchpad\").pressed\n      },\n      dest: { value: touchpadRising },\n      xform: xforms.rising\n    },\n    {\n      src: {\n        value: paths.device.daydream.button(\"touchpad\").pressed\n      },\n      dest: { value: touchpadFalling },\n      xform: xforms.falling\n    },\n    {\n      src: {\n        value: paths.device.daydream.button(\"touchpad\").pressed\n      },\n      dest: { value: touchpadPressed },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: touchpad\n      },\n      dest: {\n        north: dpadNorth,\n        south: dpadSouth,\n        east: dpadEast,\n        west: dpadWest,\n        center: dpadCenter\n      },\n      xform: xforms.vec2dpad(0.5)\n    },\n    {\n      src: {\n        value: dpadEast,\n        bool: touchpadRising\n      },\n      dest: {\n        value: paths.actions.snapRotateRight\n      },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: {\n        value: dpadWest,\n        bool: touchpadRising\n      },\n      dest: {\n        value: paths.actions.snapRotateLeft\n      },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: {\n        value: dpadCenter,\n        bool: touchpadRising\n      },\n      dest: { value: paths.actions.rightHand.startTeleport },\n      xform: xforms.copyIfTrue\n    },\n    {\n      src: { value: paths.device.daydream.pose },\n      dest: { value: paths.actions.cursor.pose },\n      xform: xforms.copy\n    },\n    {\n      src: { value: paths.device.daydream.pose },\n      dest: { value: paths.actions.rightHand.pose },\n      xform: xforms.copy\n    }\n  ],\n\n  [sets.cursorHoveringOnInteractable]: grabBinding,\n  [sets.cursorHoveringOnUI]: grabBinding,\n\n  [sets.cursorHoveringOnVideo]: [\n    {\n      src: {\n        value: paths.device.daydream.axis(\"touchpadY\"),\n        touching: paths.device.daydream.button(\"touchpad\").touched\n      },\n      dest: { value: paths.actions.cursor.mediaVolumeMod },\n      xform: xforms.touch_axis_scroll(-0.1)\n    }\n  ],\n\n  [sets.cursorHoldingInteractable]: [\n    {\n      src: { value: touchpadFalling },\n      dest: { value: paths.actions.cursor.drop },\n      xform: xforms.copy\n    },\n    {\n      src: {\n        value: paths.device.daydream.axis(\"touchpadY\"),\n        touching: paths.device.daydream.button(\"touchpad\").touched\n      },\n      dest: { value: cursorModDelta },\n      xform: xforms.touch_axis_scroll()\n    },\n    {\n      src: { value: cursorModDelta },\n      dest: { value: paths.actions.cursor.modDelta },\n      xform: xforms.copy\n    }\n  ],\n\n  [sets.rightHandTeleporting]: [\n    {\n      src: { value: touchpadFalling },\n      dest: { value: paths.actions.rightHand.stopTeleport },\n      xform: xforms.copy\n    }\n  ],\n\n  [sets.cursorHoldingPen]: [\n    {\n      src: { value: dpadNorth, bool: touchpadRising },\n      dest: { value: paths.actions.cursor.startDrawing },\n      xform: xforms.copyIfTrue,\n      priority: 100\n    },\n    {\n      src: { value: touchpadFalling },\n      dest: { value: paths.actions.cursor.stopDrawing },\n      xform: xforms.copy,\n      priority: 100\n    },\n    {\n      src: {\n        value: paths.device.daydream.axis(\"touchpadX\"),\n        touching: paths.device.daydream.button(\"touchpad\").touched\n      },\n      dest: { value: brushSizeDelta },\n      xform: xforms.touch_axis_scroll(-0.1)\n    },\n    {\n      src: {\n        value: brushSizeDelta,\n        bool: touchpadPressed\n      },\n      dest: { value: paths.actions.cursor.scalePenTip },\n      xform: xforms.copyIfFalse,\n      priority: 100\n    },\n    {\n      src: { value: dpadEast, bool: touchpadRising },\n      dest: {\n        value: paths.actions.cursor.penPrevColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 100\n    },\n    {\n      src: { value: dpadWest, bool: touchpadRising },\n      dest: {\n        value: paths.actions.cursor.penNextColor\n      },\n      xform: xforms.copyIfTrue,\n      priority: 100\n    },\n    {\n      src: {\n        value: cursorModDelta,\n        bool: touchpadPressed\n      },\n      dest: { value: paths.actions.cursor.modDelta },\n      xform: xforms.copyIfFalse,\n      priority: 100\n    },\n    ...dropOnCenterOrSouth\n  ],\n\n  [sets.cursorHoldingCamera]: [\n    // Don't drop on touchpad release\n    {\n      src: {\n        value: touchpadFalling\n      },\n      xform: xforms.noop,\n      priority: 100\n    },\n    {\n      src: {\n        value: dpadNorth,\n        bool: touchpadRising\n      },\n      dest: { value: paths.actions.cursor.takeSnapshot },\n      xform: xforms.copy,\n      priority: 100\n    },\n    ...dropOnCenterOrSouth\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nexport const cardboardUserBindings = addSetsToBindings({\n  [sets.global]: [\n    {\n      src: { value: paths.device.touchscreen.isTouching },\n      dest: {\n        value: paths.actions.startGazeTeleport\n      },\n      xform: xforms.rising\n    },\n    {\n      src: { value: paths.device.touchscreen.isTouching },\n      dest: {\n        value: paths.actions.stopGazeTeleport\n      },\n      xform: xforms.falling\n    }\n  ]\n});\n","import { paths } from \"../paths\";\nimport { sets } from \"../sets\";\nimport { xforms } from \"./xforms\";\nimport { addSetsToBindings } from \"./utils\";\n\nexport default function generate3DOFTriggerBindings(device) {\n  const touchpad = device.v(\"touchpad\");\n  const touchpadButton = device.button(\"touchpad\");\n  const triggerButton = device.button(\"trigger\");\n  const touchpadX = device.axis(\"touchpadX\");\n  const touchpadXForPen = device.axis(\"touchpadXForPen\");\n  const touchpadY = device.axis(\"touchpadY\");\n  const touchpadYForPen = device.axis(\"touchpadYForPen\");\n  const touchpadRising = device.v(\"touchpad/rising\");\n  const touchpadFalling = device.v(\"touchpad/falling\");\n  const triggerRising = device.v(\"trigger/rising\");\n  const triggerFalling = device.v(\"trigger/falling\");\n  const dpadNorth = device.v(\"dpad/north\");\n  const dpadSouth = device.v(\"dpad/south\");\n  const dpadEast = device.v(\"dpad/east\");\n  const dpadWest = device.v(\"dpad/west\");\n  const dpadCenter = device.v(\"dpad/center\");\n  const dpadCenterStrip = device.v(\"dpad/centerStrip\");\n  const dpadBottomCenterStrip = device.v(\"dpad/bottomCenterStrip\");\n  const togglePen = \"/vars/oculus-go/togglePen\";\n\n  const grabBinding = {\n    src: {\n      value: triggerRising\n    },\n    dest: { value: paths.actions.cursor.grab },\n    xform: xforms.copy,\n    priority: 200\n  };\n  const dropBinding = {\n    src: {\n      value: triggerFalling\n    },\n    dest: { value: paths.actions.cursor.drop },\n    xform: xforms.copy,\n    priority: 200\n  };\n\n  return addSetsToBindings({\n    [sets.global]: [\n      {\n        src: { value: device.matrix },\n        dest: { value: paths.actions.rightHand.matrix },\n        xform: xforms.copy\n      },\n      {\n        src: {\n          value: triggerButton.pressed\n        },\n        dest: { value: triggerRising },\n        xform: xforms.rising\n      },\n      {\n        src: {\n          value: triggerButton.pressed\n        },\n        dest: { value: triggerFalling },\n        xform: xforms.falling\n      },\n      {\n        src: {\n          value: touchpadButton.pressed\n        },\n        dest: { value: touchpadRising },\n        xform: xforms.rising,\n        priority: 100\n      },\n      {\n        src: {\n          value: touchpadButton.pressed\n        },\n        dest: { value: touchpadFalling },\n        xform: xforms.falling,\n        priority: 100\n      },\n      {\n        src: {\n          x: touchpadX,\n          y: touchpadY\n        },\n        dest: { value: touchpad },\n        xform: xforms.compose_vec2\n      },\n      {\n        src: { value: touchpadX },\n        dest: { value: touchpadXForPen },\n        xform: xforms.copy\n      },\n      {\n        src: { value: touchpadY },\n        dest: { value: touchpadYForPen },\n        xform: xforms.copy\n      },\n      {\n        src: {\n          value: touchpad\n        },\n        dest: {\n          north: dpadNorth,\n          south: dpadSouth,\n          east: dpadEast,\n          west: dpadWest,\n          center: dpadCenter\n        },\n        xform: xforms.vec2dpad(0.3)\n      },\n      {\n        src: [dpadCenter, dpadSouth],\n        dest: { value: dpadBottomCenterStrip },\n        xform: xforms.any\n      },\n      {\n        src: [dpadNorth, dpadBottomCenterStrip],\n        dest: { value: dpadCenterStrip },\n        xform: xforms.any\n      },\n      {\n        src: {\n          value: dpadCenterStrip,\n          bool: touchpadButton.pressed\n        },\n        dest: {\n          value: paths.actions.ensureFrozen\n        },\n        priority: 100,\n        xform: xforms.copyIfTrue\n      },\n      {\n        src: { value: touchpadFalling },\n        dest: {\n          value: paths.actions.thaw\n        },\n        xform: xforms.copy\n      },\n      {\n        src: {\n          value: dpadEast,\n          bool: touchpadRising\n        },\n        dest: {\n          value: paths.actions.snapRotateRight\n        },\n        xform: xforms.copyIfTrue,\n        priority: 100\n      },\n      {\n        src: {\n          value: dpadWest,\n          bool: touchpadRising\n        },\n        dest: {\n          value: paths.actions.snapRotateLeft\n        },\n        xform: xforms.copyIfTrue,\n        priority: 100\n      },\n      {\n        src: {\n          value: triggerRising\n        },\n        dest: { value: paths.actions.rightHand.startTeleport },\n        xform: xforms.copy,\n        priority: 100\n      },\n      {\n        src: { value: device.pose },\n        dest: { value: paths.actions.cursor.pose },\n        xform: xforms.copy\n      },\n      {\n        src: { value: device.pose },\n        dest: { value: paths.actions.rightHand.pose },\n        xform: xforms.copy\n      },\n      {\n        src: { value: touchpadButton.touched },\n        dest: { value: paths.actions.rightHand.thumb },\n        xform: xforms.copy\n      },\n      {\n        src: { value: triggerButton.pressed },\n        dest: { value: paths.actions.rightHand.index },\n        xform: xforms.copy\n      },\n      {\n        src: { value: triggerButton.pressed },\n        dest: { value: paths.actions.rightHand.middleRingPinky },\n        xform: xforms.copy\n      }\n    ],\n\n    [sets.cursorHoveringOnInteractable]: [grabBinding],\n    [sets.cursorHoveringOnUI]: [grabBinding],\n    [sets.cursorHoldingUI]: [dropBinding],\n    [sets.cursorHoveringOnVideo]: [\n      {\n        src: {\n          value: touchpadY,\n          touching: touchpadButton.touched\n        },\n        dest: { value: paths.actions.cursor.mediaVolumeMod },\n        xform: xforms.touch_axis_scroll(-0.1)\n      }\n    ],\n\n    [sets.cursorHoldingInteractable]: [\n      {\n        src: {\n          value: triggerFalling\n        },\n        dest: { value: paths.actions.cursor.drop },\n        xform: xforms.copy,\n        priority: 200\n      },\n      {\n        src: {\n          value: touchpadY,\n          touching: touchpadButton.touched\n        },\n        dest: { value: paths.actions.cursor.modDelta },\n        xform: xforms.touch_axis_scroll()\n      },\n      {\n        src: { value: dpadCenterStrip },\n        priority: 200,\n        xform: xforms.noop\n      }\n    ],\n\n    [sets.rightHandTeleporting]: [\n      {\n        src: {\n          value: triggerFalling\n        },\n        dest: { value: paths.actions.rightHand.stopTeleport },\n        xform: xforms.copy,\n        priority: 100\n      }\n    ],\n\n    [sets.cursorHoldingPen]: [\n      {\n        src: {\n          value: triggerRising\n        },\n        dest: { value: paths.actions.cursor.startDrawing },\n        xform: xforms.copy,\n        priority: 300\n      },\n      {\n        src: {\n          value: triggerFalling\n        },\n        dest: { value: paths.actions.cursor.stopDrawing },\n        xform: xforms.copy,\n        priority: 300\n      },\n      {\n        src: {\n          value: touchpadXForPen,\n          touching: touchpadButton.touched\n        },\n        dest: { value: paths.actions.cursor.scalePenTip },\n        xform: xforms.touch_axis_scroll(0.1, 0.1),\n        priority: 200\n      },\n      {\n        src: {\n          value: touchpadYForPen,\n          touching: touchpadButton.touched\n        },\n        dest: { value: paths.actions.cursor.modDelta },\n        xform: xforms.touch_axis_scroll(1, 0.1),\n        priority: 200\n      },\n      {\n        src: {\n          value: dpadBottomCenterStrip,\n          bool: touchpadFalling\n        },\n        dest: { value: togglePen },\n        xform: xforms.copyIfTrue,\n        priority: 300\n      },\n      {\n        src: { value: togglePen },\n        dest: { value: paths.actions.cursor.drop },\n        xform: xforms.rising,\n        priority: 200\n      },\n      {\n        src: { value: togglePen },\n        dest: { value: paths.actions.pen.remove },\n        xform: xforms.rising,\n        priority: 200\n      },\n      {\n        src: {\n          value: dpadEast,\n          bool: touchpadRising\n        },\n        dest: {\n          value: paths.actions.cursor.penPrevColor\n        },\n        xform: xforms.copyIfTrue,\n        priority: 200\n      },\n      {\n        src: {\n          value: dpadWest,\n          bool: touchpadRising\n        },\n        dest: {\n          value: paths.actions.cursor.penNextColor\n        },\n        xform: xforms.copyIfTrue,\n        priority: 200\n      },\n      {\n        src: {\n          value: dpadNorth,\n          bool: touchpadRising\n        },\n        dest: {\n          value: paths.actions.cursor.undoDrawing\n        },\n        xform: xforms.copyIfTrue,\n        priority: 200\n      }\n    ],\n\n    [sets.cursorHoldingCamera]: [\n      {\n        src: {\n          value: triggerRising\n        },\n        dest: { value: paths.actions.cursor.takeSnapshot },\n        xform: xforms.copy,\n        priority: 300\n      }\n    ]\n  });\n}\n","import { sets } from \"./sets\";\n\nlet leftTeleporter, rightTeleporter;\n\nexport function resolveActionSets() {\n  leftTeleporter = leftTeleporter || document.querySelector(\"#player-left-controller\").components.teleporter;\n  rightTeleporter = rightTeleporter || document.querySelector(\"#player-right-controller\").components.teleporter;\n  const userinput = AFRAME.scenes[0].systems.userinput;\n  const { leftHand, rightHand, rightRemote } = AFRAME.scenes[0].systems.interaction.state;\n\n  userinput.toggleSet(sets.leftHandHoveringOnNothing, !leftHand.held && !leftHand.hovered);\n  userinput.toggleSet(\n    sets.leftHandHoveringOnPen,\n    !leftHand.held &&\n      leftHand.hovered &&\n      leftHand.hovered.components.tags &&\n      leftHand.hovered.components.tags.data.isPen\n  );\n  userinput.toggleSet(\n    sets.leftHandHoveringOnCamera,\n    !leftHand.held && leftHand.hovered && leftHand.hovered.components[\"camera-tool\"]\n  );\n  userinput.toggleSet(\n    sets.leftHandHoveringOnInteractable,\n    !leftHand.held &&\n      (leftHand.hovered &&\n        ((leftHand.hovered.components.tags && leftHand.hovered.components.tags.data.offersRemoteConstraint) ||\n          leftHand.hovered.components[\"super-spawner\"]))\n  );\n  userinput.toggleSet(\n    sets.leftHandHoveringOnVideo,\n    !leftHand.held && leftHand.hovered && leftHand.hovered.components[\"media-video\"]\n  );\n  userinput.toggleSet(\n    sets.leftHandHoldingPen,\n    leftHand.held && leftHand.held.components.tags && leftHand.held.components.tags.data.isPen\n  );\n  userinput.toggleSet(sets.leftHandHoldingCamera, leftHand.held && leftHand.held.components[\"camera-tool\"]);\n  userinput.toggleSet(sets.leftHandHoldingInteractable, leftHand.held);\n\n  userinput.toggleSet(\n    sets.rightHandHoveringOnNothing,\n    !rightRemote.held && !rightRemote.hovered && !rightHand.held && !rightHand.hovered\n  );\n  userinput.toggleSet(\n    sets.rightHandHoveringOnPen,\n    !rightHand.held &&\n      rightHand.hovered &&\n      rightHand.hovered.components.tags &&\n      rightHand.hovered.components.tags.data.isPen\n  );\n  userinput.toggleSet(\n    sets.rightHandHoveringOnCamera,\n    !rightHand.held && rightHand.hovered && rightHand.hovered.components[\"camera-tool\"]\n  );\n  userinput.toggleSet(\n    sets.rightHandHoveringOnInteractable,\n    !rightHand.held &&\n      (rightHand.hovered &&\n        ((rightHand.hovered.components.tags && rightHand.hovered.components.tags.data.offersRemoteConstraint) ||\n          rightHand.hovered.components[\"super-spawner\"]))\n  );\n  userinput.toggleSet(\n    sets.rightHandHoveringOnVideo,\n    !rightHand.held && rightHand.hovered && rightHand.hovered.components[\"media-video\"]\n  );\n  userinput.toggleSet(\n    sets.rightHandHoldingPen,\n    rightHand.held && rightHand.held.components.tags && rightHand.held.components.tags.data.isPen\n  );\n  userinput.toggleSet(sets.rightHandHoldingCamera, rightHand.held && rightHand.held.components[\"camera-tool\"]);\n  userinput.toggleSet(sets.rightHandHoldingInteractable, rightHand.held);\n\n  userinput.toggleSet(\n    sets.cursorHoveringOnNothing,\n    !rightHand.held && !rightHand.hovered && !rightRemote.held && !rightRemote.hovered\n  );\n  userinput.toggleSet(\n    sets.cursorHoveringOnPen,\n    !rightHand.held &&\n      !rightHand.hovered &&\n      !rightRemote.held &&\n      rightRemote.hovered &&\n      rightRemote.hovered.components.tags &&\n      rightRemote.hovered.components.tags.data.isPen\n  );\n  userinput.toggleSet(\n    sets.cursorHoveringOnCamera,\n\n    !rightHand.held &&\n      !rightHand.hovered &&\n      !rightRemote.held &&\n      rightRemote.hovered &&\n      rightRemote.hovered.components[\"camera-tool\"]\n  );\n  userinput.toggleSet(\n    sets.cursorHoveringOnInteractable,\n    !rightHand.held &&\n      !rightHand.hovered &&\n      !rightRemote.held &&\n      rightRemote.hovered &&\n      ((rightRemote.hovered.components.tags && rightRemote.hovered.components.tags.data.offersRemoteConstraint) ||\n        rightRemote.hovered.components[\"super-spawner\"])\n  );\n  userinput.toggleSet(\n    sets.cursorHoveringOnUI,\n    !rightHand.held &&\n      !rightHand.hovered &&\n      !rightRemote.held &&\n      rightRemote.hovered &&\n      (rightRemote.hovered.components.tags &&\n        (rightRemote.hovered.components.tags.data.singleActionButton ||\n          rightRemote.hovered.components.tags.data.holdableButton))\n  );\n  userinput.toggleSet(\n    sets.cursorHoveringOnVideo,\n    !rightHand.held &&\n      !rightHand.hovered &&\n      !rightRemote.held &&\n      rightRemote.hovered &&\n      rightRemote.hovered.components[\"media-video\"]\n  );\n\n  userinput.toggleSet(sets.cursorHoldingNothing, !rightHand.held && !rightRemote.held);\n  userinput.toggleSet(\n    sets.cursorHoldingPen,\n\n    !rightHand.held &&\n      !rightHand.hovered &&\n      rightRemote.held &&\n      rightRemote.held.components.tags &&\n      rightRemote.held.components.tags.data.isPen\n  );\n  userinput.toggleSet(\n    sets.cursorHoldingCamera,\n    !rightHand.held && !rightHand.hovered && rightRemote.held && rightRemote.held.components[\"camera-tool\"]\n  );\n  userinput.toggleSet(\n    sets.cursorHoldingUI,\n    !rightHand.held &&\n      !rightHand.hovered &&\n      rightRemote.held &&\n      rightRemote.held.components.tags &&\n      rightRemote.held.components.tags.data.holdableButton\n  );\n  userinput.toggleSet(sets.cursorHoldingInteractable, rightRemote.held);\n\n  userinput.toggleSet(sets.leftHandTeleporting, leftTeleporter.isTeleporting);\n  userinput.toggleSet(sets.rightHandTeleporting, rightTeleporter.isTeleporting);\n\n  userinput.toggleSet(\n    sets.inputFocused,\n    document.activeElement.nodeName === \"INPUT\" ||\n      document.activeElement.nodeName === \"TEXTAREA\" ||\n      document.activeElement.contentEditable === \"true\"\n  );\n}\n","import { paths } from \"../paths\";\n\nexport class GamepadDevice {\n  constructor(gamepad) {\n    this.gamepad = gamepad;\n  }\n\n  write(frame) {\n    if (this.gamepad.connected) {\n      this.gamepad.buttons.forEach((button, i) => {\n        const buttonPath = paths.device.gamepad(this.gamepad.index).button(i);\n        frame.setValueType(buttonPath.pressed, !!button.pressed);\n        frame.setValueType(buttonPath.touched, !!button.touched);\n        frame.setValueType(buttonPath.value, button.value);\n      });\n      this.gamepad.axes.forEach((axis, i) => {\n        frame.setValueType(paths.device.gamepad(this.gamepad.index).axis(i), axis);\n      });\n    }\n  }\n}\n","export const gamepadBindings = {};\n","import { sets } from \"./sets\";\nimport { paths } from \"./paths\";\n\nimport { MouseDevice } from \"./devices/mouse\";\nimport { KeyboardDevice } from \"./devices/keyboard\";\nimport { HudDevice } from \"./devices/hud\";\nimport { XboxControllerDevice } from \"./devices/xbox-controller\";\nimport { OculusGoControllerDevice } from \"./devices/oculus-go-controller\";\nimport { GearVRControllerDevice } from \"./devices/gear-vr-controller\";\nimport { OculusTouchControllerDevice } from \"./devices/oculus-touch-controller\";\nimport { DaydreamControllerDevice } from \"./devices/daydream-controller\";\nimport { ViveControllerDevice } from \"./devices/vive-controller\";\nimport { WindowsMixedRealityControllerDevice } from \"./devices/windows-mixed-reality-controller\";\nimport { GyroDevice } from \"./devices/gyro\";\n\nimport { AppAwareMouseDevice } from \"./devices/app-aware-mouse\";\nimport { AppAwareTouchscreenDevice } from \"./devices/app-aware-touchscreen\";\n\nimport { keyboardMouseUserBindings } from \"./bindings/keyboard-mouse-user\";\nimport { touchscreenUserBindings } from \"./bindings/touchscreen-user\";\nimport { keyboardDebuggingBindings } from \"./bindings/keyboard-debugging\";\nimport { oculusTouchUserBindings } from \"./bindings/oculus-touch-user\";\nimport { viveUserBindings, viveWandUserBindings } from \"./bindings/vive-user\";\nimport { wmrUserBindings } from \"./bindings/windows-mixed-reality-user\";\nimport { xboxControllerUserBindings } from \"./bindings/xbox-controller-user\";\nimport { daydreamUserBindings } from \"./bindings/daydream-user\";\nimport { cardboardUserBindings } from \"./bindings/cardboard-user\";\n\nimport generate3DOFTriggerBindings from \"./bindings/oculus-go-user\";\nconst oculusGoUserBindings = generate3DOFTriggerBindings(paths.device.oculusgo);\nconst gearVRControllerUserBindings = generate3DOFTriggerBindings(paths.device.gearVRController);\n\nimport { resolveActionSets } from \"./resolve-action-sets\";\nimport { GamepadDevice } from \"./devices/gamepad\";\nimport { gamepadBindings } from \"./bindings/generic-gamepad\";\nimport { getAvailableVREntryTypes, VR_DEVICE_AVAILABILITY } from \"../../utils/vr-caps-detect\";\nimport { ArrayBackedSet } from \"./array-backed-set\";\n\nfunction arrayContentsDiffer(a, b) {\n  if (a.length !== b.length) return true;\n\n  for (let i = 0, il = a.length; i < il; i++) {\n    const elem = a[i];\n    let found = false;\n\n    for (let j = 0, jl = b.length; j < jl; j++) {\n      if (elem === b[j]) {\n        found = true;\n        break;\n      }\n    }\n\n    if (!found) return true;\n  }\n\n  return false;\n}\n\nconst satisfiesPath = (binding, path) => {\n  for (const key in binding.dest) {\n    if (binding.dest[key].indexOf(path) !== -1) {\n      return true;\n    }\n  }\n  return false;\n};\n\nconst satisfyPath = (bindings, path) => {\n  for (const binding of bindings) {\n    if (satisfiesPath(binding, path)) {\n      return true;\n    }\n  }\n  return false;\n};\n\nconst satisfiedBy = (binding, bindings) => {\n  for (const path of Object.values(binding.src)) {\n    if (path.startsWith(\"/device/\")) continue;\n    if (!satisfyPath(bindings, path)) return false;\n  }\n  return true;\n};\n\nfunction dependencySort(mappings) {\n  const unsorted = [];\n  for (const mapping of mappings) {\n    for (const setName in mapping) {\n      for (const binding of mapping[setName]) {\n        unsorted.push(binding);\n      }\n    }\n  }\n\n  const sorted = [];\n  while (unsorted.length > 0) {\n    const binding = unsorted.shift();\n    if (satisfiedBy(binding, sorted)) {\n      sorted.push(binding);\n    } else {\n      unsorted.push(binding);\n    }\n  }\n\n  return sorted;\n}\n\nfunction canMask(masker, masked) {\n  if (masker.priority === undefined) {\n    masker.priority = 0;\n  }\n  if (masked.priority === undefined) {\n    masked.priority = 0;\n  }\n  if (masked.priority >= masker.priority) return false;\n  for (const maskerKey in masker.src) {\n    const maskerPath = masker.src[maskerKey];\n    for (const maskedKey in masked.src) {\n      const maskedPath = masked.src[maskedKey];\n      if (maskedPath.indexOf(maskerPath) !== -1) {\n        return true;\n      }\n    }\n  }\n  return false;\n}\n\nfunction computeMasks(bindings) {\n  const masks = new Array(bindings.length);\n  for (let row = 0; row < bindings.length; row++) {\n    const masksRow = (masks[row] = []);\n    const bindingsRow = bindings[row];\n    for (let col = 0; col < bindings.length; col++) {\n      if (canMask(bindings[col], bindingsRow)) {\n        masksRow.push(col);\n      }\n    }\n  }\n  return masks;\n}\n\nfunction isActive(binding, sets) {\n  for (let i = 0; i < binding.sets.length; i++) {\n    if (sets.includes(binding.sets[i])) {\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction computeExecutionStrategy(sortedBindings, masks, activeSets) {\n  const actives = new Array(sortedBindings.length);\n  for (let row = 0; row < sortedBindings.length; row++) {\n    actives[row] = isActive(sortedBindings[row], activeSets);\n  }\n\n  const masked = new Array(sortedBindings.length);\n  for (let row = 0; row < sortedBindings.length; row++) {\n    const maskedRow = (masked[row] = []);\n    const masksRow = masks[row];\n    for (let col = 0; col < sortedBindings.length; col++) {\n      if (actives[col] && masksRow.indexOf(col) !== -1) {\n        maskedRow.push(col);\n      }\n    }\n  }\n\n  return { actives, masked };\n}\n\nAFRAME.registerSystem(\"userinput\", {\n  get(path) {\n    if (!this.frame) return;\n    return this.frame.get(path);\n  },\n\n  toggleSet(set, value) {\n    this.pendingSetChanges.push(set);\n    this.pendingSetChanges.push(!!value);\n  },\n\n  init() {\n    this.frame = {\n      generation: 0,\n      values: {},\n      generations: {},\n      get: function(path) {\n        if (this.generations[path] !== this.generation) return undefined;\n        return this.values[path];\n      },\n      setValueType: function(path, value) {\n        this.values[path] = value;\n        this.generations[path] = this.generation;\n      },\n      setVector2: function(path, a, b) {\n        const value = this.values[path] || [];\n        value[0] = a;\n        value[1] = b;\n        this.values[path] = value;\n        this.generations[path] = this.generation;\n      },\n      setPose: function(path, pose) {\n        this.setValueType(path, pose);\n      },\n      setMatrix4: function(path, mat4) {\n        // Should we assume the incoming mat4 is safe to store instead of copying values?\n        const value = this.values[path] || new THREE.Matrix4();\n        value.copy(mat4);\n        this.values[path] = value;\n        this.generations[path] = this.generation;\n      }\n    };\n\n    this.prevActiveSets = [];\n    this.activeSets = [sets.global];\n    this.pendingSetChanges = [];\n    this.xformStates = new Map();\n    this.activeDevices = new ArrayBackedSet([new HudDevice()]);\n\n    const isMobile = AFRAME.utils.device.isMobile();\n    const isMobileVR = AFRAME.utils.device.isMobileVR();\n\n    if (!(isMobile || isMobileVR)) {\n      this.activeDevices.add(new MouseDevice());\n      this.activeDevices.add(new AppAwareMouseDevice());\n      this.activeDevices.add(new KeyboardDevice());\n    } else if (!isMobileVR) {\n      this.activeDevices.add(new AppAwareTouchscreenDevice());\n      this.activeDevices.add(new KeyboardDevice());\n      this.activeDevices.add(new GyroDevice());\n    }\n\n    this.isMobile = isMobile;\n    this.isMobileVR = isMobileVR;\n\n    this.registeredMappings = new Set([keyboardDebuggingBindings]);\n    this.registeredMappingsChanged = true;\n\n    const vrGamepadMappings = new Map();\n    vrGamepadMappings.set(WindowsMixedRealityControllerDevice, wmrUserBindings);\n    vrGamepadMappings.set(ViveControllerDevice, viveUserBindings);\n    vrGamepadMappings.set(OculusTouchControllerDevice, oculusTouchUserBindings);\n    vrGamepadMappings.set(OculusGoControllerDevice, oculusGoUserBindings);\n    vrGamepadMappings.set(GearVRControllerDevice, gearVRControllerUserBindings);\n    vrGamepadMappings.set(DaydreamControllerDevice, daydreamUserBindings);\n\n    const nonVRGamepadMappings = new Map();\n    nonVRGamepadMappings.set(XboxControllerDevice, xboxControllerUserBindings);\n    nonVRGamepadMappings.set(GamepadDevice, gamepadBindings);\n\n    const updateBindingsForVRMode = () => {\n      const inVRMode = this.el.sceneEl.is(\"vr-mode\");\n      const isMobile = AFRAME.utils.device.isMobile();\n\n      if (inVRMode) {\n        console.log(\"Using VR bindings.\");\n        this.registeredMappings.delete(isMobile ? touchscreenUserBindings : keyboardMouseUserBindings);\n        // add mappings for all active VR input devices\n        for (let i = 0; i < this.activeDevices.items.length; i++) {\n          const activeDevice = this.activeDevices.items[i];\n          const mapping = vrGamepadMappings.get(activeDevice.constructor);\n          mapping && this.registeredMappings.add(mapping);\n          if (activeDevice instanceof ViveControllerDevice && activeDevice.isViveWand) {\n            this.registeredMappings.add(viveWandUserBindings);\n          }\n        }\n\n        // Handle cardboard by looking of VR device caps\n        if (isMobile) {\n          getAvailableVREntryTypes().then(availableVREntryTypes => {\n            if (availableVREntryTypes.cardboard === VR_DEVICE_AVAILABILITY.yes) {\n              this.registeredMappings.add(cardboardUserBindings);\n              this.registeredMappingsChanged = true;\n            }\n          });\n        }\n      } else {\n        console.log(\"Using Non-VR bindings.\");\n        // remove mappings for all active VR input devices\n        for (let i = 0; i < this.activeDevices.items.length; i++) {\n          const activeDevice = this.activeDevices.items[i];\n          this.registeredMappings.delete(vrGamepadMappings.get(activeDevice.constructor));\n        }\n        this.registeredMappings.add(isMobile ? touchscreenUserBindings : keyboardMouseUserBindings);\n      }\n\n      for (let i = 0; i < this.activeDevices.items.length; i++) {\n        const activeDevice = this.activeDevices.items[i];\n        const mapping = nonVRGamepadMappings.get(activeDevice.constructor);\n        mapping && this.registeredMappings.add(mapping);\n      }\n\n      this.registeredMappingsChanged = true;\n    };\n\n    const gamepadConnected = e => {\n      let gamepadDevice;\n      for (let i = 0; i < this.activeDevices.items.length; i++) {\n        const activeDevice = this.activeDevices.items[i];\n        if (activeDevice.gamepad && activeDevice.gamepad.index === e.gamepad.index) {\n          console.warn(\"connected already fired for gamepad\", e.gamepad);\n          return; // multiple connect events without a disconnect event\n        }\n      }\n      // HACK Firefox Nightly bug causes corrupt gamepad names for OpenVR, so do startsWith\n      if (e.gamepad.id.startsWith(\"OpenVR Gamepad\") || e.gamepad.id === \"HTC Vive Focus Plus Controller\") {\n        gamepadDevice = new ViveControllerDevice(e.gamepad);\n      } else if (e.gamepad.id.startsWith(\"Oculus Touch\")) {\n        gamepadDevice = new OculusTouchControllerDevice(e.gamepad);\n      } else if (e.gamepad.id.startsWith(\"Spatial Controller\")) {\n        gamepadDevice = new WindowsMixedRealityControllerDevice(e.gamepad);\n      } else if (e.gamepad.id === \"Oculus Go Controller\") {\n        gamepadDevice = new OculusGoControllerDevice(e.gamepad);\n      } else if (e.gamepad.id === \"Gear VR Controller\" || e.gamepad.id === \"HTC Vive Focus Controller\") {\n        gamepadDevice = new GearVRControllerDevice(e.gamepad);\n      } else if (e.gamepad.id === \"Daydream Controller\") {\n        gamepadDevice = new DaydreamControllerDevice(e.gamepad);\n      } else if (e.gamepad.mapping === \"standard\") {\n        // Our XboxController device and bindings should be generic enough for most gamepads.\n        gamepadDevice = new XboxControllerDevice(e.gamepad);\n      } else {\n        // This device doesn't actually have any bindings, but we need to fallback to something.\n        gamepadDevice = new GamepadDevice(e.gamepad);\n      }\n\n      this.activeDevices.add(gamepadDevice);\n\n      updateBindingsForVRMode();\n    };\n\n    const gamepadDisconnected = e => {\n      for (let i = 0; i < this.activeDevices.items.length; i++) {\n        const device = this.activeDevices.items[i];\n        if (device.gamepad && device.gamepad.index === e.gamepad.index) {\n          this.registeredMappings.delete(\n            vrGamepadMappings.get(device.constructor) || nonVRGamepadMappings.get(device.constructor)\n          );\n          this.activeDevices.delete(device);\n          return;\n        }\n      }\n\n      updateBindingsForVRMode();\n    };\n\n    window.addEventListener(\"gamepadconnected\", gamepadConnected, false);\n    window.addEventListener(\"gamepaddisconnected\", gamepadDisconnected, false);\n    for (const gamepad of navigator.getGamepads()) {\n      gamepad && gamepadConnected({ gamepad });\n    }\n\n    this.el.sceneEl.addEventListener(\"enter-vr\", updateBindingsForVRMode);\n    this.el.sceneEl.addEventListener(\"exit-vr\", updateBindingsForVRMode);\n\n    updateBindingsForVRMode();\n  },\n\n  maybeToggleXboxMapping() {\n    if (this.isMobile || this.isMobileVR) return;\n\n    const vrAxesSum =\n      (this.get(paths.device.vive.left.axesSum) || 0) +\n      (this.get(paths.device.vive.right.axesSum) || 0) +\n      (this.get(paths.device.leftOculusTouch.axesSum) || 0) +\n      (this.get(paths.device.rightOculusTouch.axesSum) || 0);\n    const mouseMovement = this.get(paths.device.mouse.movementXY);\n    const nonXboxActivity = (mouseMovement[0] || mouseMovement[1]) > 2 || vrAxesSum > 0.5;\n\n    const hasXboxMapping = this.registeredMappings.has(xboxControllerUserBindings);\n\n    if (nonXboxActivity && hasXboxMapping) {\n      this.registeredMappings.delete(xboxControllerUserBindings);\n      this.registeredMappingsChanged = true;\n    } else if (this.get(paths.device.xbox.axesSum) > 0.5 && !hasXboxMapping) {\n      this.registeredMappings.add(xboxControllerUserBindings);\n      this.registeredMappingsChanged = true;\n    }\n  },\n\n  tick2() {\n    this.frame.generation += 1;\n    const registeredMappingsChanged = this.registeredMappingsChanged;\n    if (registeredMappingsChanged) {\n      this.registeredMappingsChanged = false;\n      this.prevSortedBindings = this.sortedBindings;\n      this.sortedBindings = dependencySort(this.registeredMappings);\n      if (!this.prevSortedBindings) {\n        this.prevSortedBindings = this.sortedBindings;\n      }\n      this.masks = computeMasks(this.sortedBindings);\n    }\n\n    this.prevActiveSets.length = 0;\n    for (let i = 0; i < this.activeSets.length; i++) {\n      const item = this.activeSets[i];\n      this.prevActiveSets.push(item);\n    }\n    resolveActionSets();\n    for (let i = 0, l = this.pendingSetChanges.length; i < l; i += 2) {\n      const set = this.pendingSetChanges[i];\n      const value = this.pendingSetChanges[i + 1];\n\n      if (value) {\n        if (!this.activeSets.includes(set)) {\n          this.activeSets.push(set);\n        }\n      } else {\n        const idx = this.activeSets.indexOf(set);\n\n        if (idx > -1) {\n          this.activeSets.splice(idx, 1);\n        }\n      }\n    }\n    const activeSetsChanged = arrayContentsDiffer(this.prevActiveSets, this.activeSets);\n    this.pendingSetChanges.length = 0;\n    if (registeredMappingsChanged || activeSetsChanged || (!this.actives && !this.masked)) {\n      this.prevActives = this.actives;\n      this.prevMasked = this.masked;\n      const { actives, masked } = computeExecutionStrategy(this.sortedBindings, this.masks, this.activeSets);\n      this.actives = actives;\n      this.masked = masked;\n    }\n\n    for (let i = 0; i < this.activeDevices.items.length; i++) {\n      this.activeDevices.items[i].write(this.frame);\n    }\n\n    for (let i = 0; i < this.sortedBindings.length; i++) {\n      if (!this.actives[i] || this.masked[i].length > 0) continue;\n\n      const binding = this.sortedBindings[i];\n\n      let bindingExistedLastFrame = true;\n      if (!registeredMappingsChanged && activeSetsChanged && this.prevSortedBindings) {\n        const j = this.prevSortedBindings.indexOf(binding);\n        bindingExistedLastFrame = j > -1 && this.prevActives[j] && this.prevMasked[j].length === 0;\n      }\n      if (!bindingExistedLastFrame) {\n        this.xformStates.delete(binding);\n      }\n\n      const { src, dest, xform, debug } = binding;\n\n      let oldValue;\n\n      if (debug) {\n        oldValue = this.frame.get(dest.value);\n      }\n\n      const newState = xform(this.frame, src, dest, this.xformStates.get(binding));\n\n      if (debug) {\n        // Note for now this only works with bindings that have { value: } sources and dests\n        console.log(\n          `${JSON.stringify(src.value)} (${src.value && JSON.stringify(this.frame.get(src.value))}) to ${JSON.stringify(\n            dest\n          )}: ${oldValue} -> ${this.frame.get(dest.value)}`\n        );\n      }\n\n      if (newState !== undefined) {\n        this.xformStates.set(binding, newState);\n      }\n    }\n\n    this.prevSortedBindings = this.sortedBindings;\n\n    this.maybeToggleXboxMapping();\n  }\n});\n","import { paths } from \"./paths\";\nimport qsTruthy from \"../../utils/qs_truthy\";\n\nconst PATHS_TO_SHOW = [\"/actions/\", \"/device/\"];\n\nAFRAME.registerSystem(\"userinput-debug\", {\n  active: true,\n\n  tick() {\n    if (!this.active) return;\n\n    const userinput = AFRAME.scenes[0].systems.userinput;\n\n    if (this.userinputFrameStatus) {\n      const replacer = (k, v) => {\n        if (typeof v === \"number\") {\n          return `${v >= 0 ? \"+\" : \"\"}${v.toFixed(3)}`;\n        }\n        return v;\n      };\n      const pathsOutput = [];\n      const { frame } = userinput;\n      for (const key in frame.values) {\n        if (!frame.get(key)) continue;\n        if (!PATHS_TO_SHOW.some(x => key.startsWith(x))) continue;\n        let val = JSON.stringify(frame.get(key), replacer);\n        if (val) val = val.replace(/{\"(\\w{3,})\":/g, '{\\n  \"$1\":').replace(/,\"(\\w{3,})\":/g, ',\\n  \"$1\":');\n        pathsOutput.push(`${key} -> ${val}`);\n      }\n      this.userinputFrameStatus.textContent = pathsOutput.join(\"\\n\");\n    }\n\n    if (userinput.get(paths.actions.logDebugFrame)) {\n      if (qsTruthy(\"userinput_debug\") && !this.userinputFrameStatus) {\n        this.userinputFrameStatus = document.createElement(\"div\");\n        this.userinputFrameStatus.id = \"userinput-frame-status\";\n        this.userinputFrameStatus.style = `\n          position: absolute;\n          z-index: 2;\n          left: 0; bottom: 0;\n          background: white;\n          white-space: pre;\n          font-family: monospace;\n          font-size: 8pt;\n        `;\n        document.body.append(this.userinputFrameStatus);\n      }\n\n      console.log(userinput);\n      console.log(\"sorted\", userinput.sortedBindings);\n      console.log(\"actives\", userinput.actives);\n      console.log(\"masks\", userinput.masks);\n      console.log(\"masked\", userinput.masked);\n      console.log(\"devices\", userinput.activeDevices);\n      console.log(\"activeSets\", userinput.activeSets);\n      console.log(\"frame\", userinput.frame);\n      console.log(\"xformStates\", userinput.xformStates);\n      const { sortedBindings, actives, masked } = userinput;\n      for (const i in sortedBindings) {\n        const sb = [];\n        if (masked[i].length > 0) {\n          for (const j of masked[i]) {\n            sb.push(JSON.stringify(sortedBindings[j]));\n          }\n        }\n\n        if (this.logBindings) {\n          console.log(\n            \"binding: \",\n            i,\n            \"\\n\",\n            sortedBindings[i],\n            \"\\n\",\n            \"dest: \",\n            sortedBindings[i].dest && Object.values(sortedBindings[i].dest),\n            \"\\n\",\n            \"active: \",\n            actives[i],\n            \"\\n\",\n            \"maskedBy: \",\n            masked[i],\n            \"\\n\",\n            sb.join(\"\\n\"),\n            \"\\n\"\n          );\n        }\n      }\n    }\n  }\n});\n","import { paths } from \"./userinput/paths\";\nimport { SOURCES } from \"../storage/media-search-store\";\n\nconst MEDIA_SEARCH_PATHS = [\n  paths.actions.mediaSearch1,\n  paths.actions.mediaSearch2,\n  paths.actions.mediaSearch3,\n  paths.actions.mediaSearch4,\n  paths.actions.mediaSearch5,\n  paths.actions.mediaSearch6,\n  paths.actions.mediaSearch7,\n  paths.actions.mediaSearch8\n];\n\n// Every frame, looks for input paths that trigger UI-relevant events and handles them.\nAFRAME.registerSystem(\"ui-hotkeys\", {\n  init() {\n    this.mediaSearchStore = window.APP.mediaSearchStore;\n  },\n\n  tick: function() {\n    if (!this.userinput) {\n      this.userinput = this.el.systems.userinput;\n    }\n\n    if (this.userinput.get(paths.actions.focusChat)) {\n      this.focusChat();\n    }\n\n    if (this.userinput.get(paths.actions.focusChatCommand)) {\n      this.focusChat(\"/\");\n    }\n\n    if (this.userinput.get(paths.actions.mediaExit)) {\n      if (window.APP.history.location.state && window.APP.history.location.state.value !== \"avatar-editor\") {\n        this.mediaSearchStore.pushExitMediaBrowserHistory();\n      }\n\n      this.el.emit(\"action_exit_watch\");\n    }\n\n    for (let i = 0; i < MEDIA_SEARCH_PATHS.length; i++) {\n      if (this.userinput.get(MEDIA_SEARCH_PATHS[i]) && window.APP.hubChannel.can(\"spawn_and_move_media\")) {\n        this.mediaSearchStore.sourceNavigate(SOURCES[i]);\n      }\n    }\n\n    if (this.userinput.get(paths.actions.toggleCamera)) {\n      this.el.emit(\"action_toggle_camera\");\n    }\n  },\n\n  focusChat: function(prefix) {\n    const target = document.querySelector(\".chat-focus-target\");\n    if (!target) return;\n\n    target.focus();\n\n    if (prefix) {\n      target.value = prefix;\n    }\n  }\n});\n","import { waitForDOMContentLoaded } from \"../utils/async-utils\";\n\nexport class CursorTargettingSystem {\n  constructor() {\n    this.targets = [];\n    this.setDirty = this.setDirty.bind(this);\n    this.dirty = true;\n\n    // TODO: Use the MutationRecords passed into the callback function to determine added/removed nodes!\n    this.observer = new MutationObserver(this.setDirty);\n\n    waitForDOMContentLoaded().then(() => {\n      const scene = document.querySelector(\"a-scene\");\n      this.rightRemote = document.querySelector(\"#cursor-controller\");\n      this.observer.observe(scene, { childList: true, attributes: true, subtree: true });\n      scene.addEventListener(\"object3dset\", this.setDirty);\n      scene.addEventListener(\"object3dremove\", this.setDirty);\n    });\n  }\n\n  setDirty() {\n    this.dirty = true;\n  }\n\n  tick(t) {\n    if (this.dirty) {\n      this.populateEntities(this.targets);\n      this.dirty = false;\n    }\n\n    this.rightRemote.components[\"cursor-controller\"].tick2(t);\n  }\n\n  populateEntities(targets) {\n    targets.length = 0;\n    // TODO: Do not querySelectorAll on the entire scene every time anything changes!\n    const els = AFRAME.scenes[0].querySelectorAll(\".collidable, .interactable, .ui\");\n    for (let i = 0; i < els.length; i++) {\n      if (els[i].object3D) {\n        targets.push(els[i].object3D);\n      }\n    }\n  }\n\n  remove() {\n    this.observer.disconnect();\n    AFRAME.scenes[0].removeEventListener(\"object3dset\", this.setDirty);\n    AFRAME.scenes[0].removeEventListener(\"object3dremove\", this.setDirty);\n  }\n}\n","/* global NAF AFRAME */\nconst ACTIVATION_STATE = require(\"aframe-physics-system/src/constants\").ACTIVATION_STATE;\n\nexport class ConstraintsSystem {\n  constructor() {\n    this.prevLeftHand = {\n      held: null,\n      hovered: null,\n      spawning: null\n    };\n    this.prevRightHand = {\n      held: null,\n      hovered: null,\n      spawning: null\n    };\n    this.prevRightRemote = {\n      held: null,\n      hovered: null,\n      spawning: null\n    };\n  }\n\n  tickInteractor(constraintTag, entityId, state, prevState) {\n    if (prevState.held === state.held) {\n      if (!state.spawning && prevState.spawning && state.held && state.held.components.tags.data[constraintTag]) {\n        state.held.setAttribute(\"ammo-body\", {\n          type: \"dynamic\",\n          activationState: ACTIVATION_STATE.DISABLE_DEACTIVATION\n        });\n        state.held.setAttribute(\"ammo-constraint__\" + entityId, { target: \"#\" + entityId });\n      }\n      return;\n    }\n    if (prevState.held && prevState.held.components.tags.data[constraintTag]) {\n      prevState.held.removeAttribute(\"ammo-constraint__\" + entityId);\n      let hasAnotherConstraint = false;\n      for (const componentName in prevState.held.components) {\n        if (componentName.startsWith(\"ammo-constraint\")) {\n          hasAnotherConstraint = true;\n        }\n      }\n      if (!hasAnotherConstraint) {\n        prevState.held.setAttribute(\"ammo-body\", { activationState: ACTIVATION_STATE.ACTIVE_TAG });\n      }\n    }\n    if (!state.spawning && state.held && state.held.components.tags.data[constraintTag]) {\n      if (!state.held.components[\"networked\"] || NAF.utils.isMine(state.held) || NAF.utils.takeOwnership(state.held)) {\n        state.held.setAttribute(\"ammo-body\", {\n          type: \"dynamic\",\n          activationState: ACTIVATION_STATE.DISABLE_DEACTIVATION\n        });\n        state.held.setAttribute(\"ammo-constraint__\" + entityId, { target: \"#\" + entityId });\n      } else {\n        console.log(\"Failed to obtain ownership while trying to create constraint on networked object.\");\n      }\n    }\n  }\n\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n\n    this.tickInteractor(\n      \"offersHandConstraint\",\n      interaction.options.leftHand.entity.id,\n      interaction.state.leftHand,\n      this.prevLeftHand\n    );\n    this.tickInteractor(\n      \"offersHandConstraint\",\n      interaction.options.rightHand.entity.id,\n      interaction.state.rightHand,\n      this.prevRightHand\n    );\n    this.tickInteractor(\n      \"offersRemoteConstraint\",\n      interaction.options.rightRemote.entity.id,\n      interaction.state.rightRemote,\n      this.prevRightRemote\n    );\n\n    Object.assign(this.prevLeftHand, interaction.state.leftHand);\n    Object.assign(this.prevRightHand, interaction.state.rightHand);\n    Object.assign(this.prevRightRemote, interaction.state.rightRemote);\n  }\n}\n","/* global THREE AFRAME */\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\nconst COLLISION_FILTER_MASK_HANDS = { collisionFilterMask: COLLISION_LAYERS.HANDS };\nexport const distanceBetweenStretchers = (() => {\n  const a = new THREE.Vector3();\n  const b = new THREE.Vector3();\n  return function distanceBetweenStretchers(obj1, obj2) {\n    obj1.getWorldPosition(a);\n    obj2.getWorldPosition(b);\n    return a.distanceTo(b);\n  };\n})();\n\nexport class TwoPointStretchingSystem {\n  constructor() {\n    this.initialScale = new THREE.Vector3();\n  }\n\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const { leftHand, rightHand, rightRemote } = interaction.state;\n\n    const stretching = leftHand.held && (leftHand.held === rightHand.held || leftHand.held === rightRemote.held);\n    let leftStretcher, rightStretcher;\n    if (stretching) {\n      leftStretcher = interaction.options.leftHand.entity.object3D;\n      rightStretcher =\n        leftHand.held === rightHand.held\n          ? interaction.options.rightHand.entity.object3D\n          : interaction.options.rightRemote.entity.object3D;\n      if (\n        leftStretcher !== this.previousLeftStretcher ||\n        rightStretcher !== this.previousRightStretcher ||\n        leftHand.held !== this.stretched\n      ) {\n        this.initialStretchDistance = distanceBetweenStretchers(leftStretcher, rightStretcher);\n        this.stretched = leftHand.held;\n        this.initialScale.copy(this.stretched.object3D.scale);\n        if (this.stretched.components[\"ammo-body\"]) {\n          this.stretched.setAttribute(\"ammo-body\", COLLISION_FILTER_MASK_HANDS);\n        }\n      }\n\n      this.stretched.object3D.scale\n        .copy(this.initialScale)\n        .multiplyScalar(distanceBetweenStretchers(leftStretcher, rightStretcher) / this.initialStretchDistance);\n      this.stretched.object3D.matrixNeedsUpdate = true;\n    }\n\n    this.previousLeftStretcher = leftStretcher;\n    this.previousRightStretcher = rightStretcher;\n  }\n}\n","export class SingleActionButtonSystem {\n  tick() {\n    this.didInteractThisFrame = false;\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const hovered = interaction.state.rightRemote.hovered;\n    if (\n      hovered &&\n      userinput.get(interaction.options.rightRemote.grabPath) &&\n      hovered.components.tags &&\n      hovered.components.tags.data.singleActionButton\n    ) {\n      this.didInteractThisFrame = true;\n      hovered.object3D.dispatchEvent({\n        type: \"interact\",\n        object3D: interaction.options.rightRemote.entity.object3D\n      });\n    }\n  }\n}\n\nexport class HoldableButtonSystem {\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const held = interaction.state.rightRemote.held;\n\n    if (this.prevHeld && this.prevHeld !== held) {\n      this.prevHeld.object3D.dispatchEvent({\n        type: \"holdable-button-up\",\n        object3D: interaction.options.rightRemote.entity.object3D\n      });\n    }\n    if (held && this.prevHeld !== held) {\n      held.object3D.dispatchEvent({\n        type: \"holdable-button-down\",\n        object3D: interaction.options.rightRemote.entity.object3D\n      });\n    }\n\n    this.prevHeld = held;\n  }\n}\n\nconst hasButtonComponent = (function() {\n  const BUTTON_COMPONENT_NAMES = [\"icon-button\", \"text-button\", \"pin-networked-object-button\", \"mic-button\"];\n  return function hasButtonComponent(components) {\n    for (let i = 0; i < BUTTON_COMPONENT_NAMES.length; i++) {\n      if (components[BUTTON_COMPONENT_NAMES[i]]) {\n        return true;\n      }\n    }\n    return false;\n  };\n})();\n\nfunction getHoverableButton(hovered) {\n  if (!hovered) return null;\n  if (hasButtonComponent(hovered.components)) return hovered;\n  if (hovered.children) {\n    // TODO: not sure if looping thru children here is desireable, but we did this to accomodate the rounded-button mixins\n    for (let i = 0; i < hovered.children.length; i++) {\n      if (hasButtonComponent(hovered.children[i].components)) {\n        return hovered.children[i];\n      }\n    }\n  }\n  return null;\n}\n\nfunction dispatch(el, event) {\n  el.object3D.dispatchEvent(event);\n  if (el.children) {\n    for (let i = 0; i < el.children.length; i++) {\n      if (hasButtonComponent(el.children[i].components)) {\n        el.children[i].object3D.dispatchEvent(event);\n      }\n    }\n  }\n}\n\nconst HOVERED = { type: \"hovered\" };\nconst UNHOVERED = { type: \"unhovered\" };\nexport class HoverButtonSystem {\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const button = getHoverableButton(interaction.state.rightRemote.hovered);\n\n    if (this.prevButton && this.prevButton !== button) {\n      dispatch(this.prevButton, UNHOVERED);\n    }\n\n    if (button && this.prevButton !== button) {\n      dispatch(button, HOVERED);\n    }\n\n    this.prevButton = button;\n  }\n}\n","function getSpecificHoverMenu(el) {\n  return (\n    el.components[\"hover-menu\"] ||\n    el.components[\"hover-menu__video\"] ||\n    el.components[\"hover-menu__hubs-item\"] ||\n    el.components[\"hover-menu__link\"] ||\n    el.components[\"hover-menu__photo\"]\n  );\n}\n\nfunction findHoverMenu(hovered) {\n  if (!hovered) return null;\n  const hoverMenu = getSpecificHoverMenu(hovered);\n  if (hoverMenu) {\n    return hoverMenu;\n  }\n  if (!(hovered.components.tags && hovered.components.tags.data.isHoverMenuChild)) {\n    return null;\n  }\n  let el = hovered.parentNode;\n  while (!getSpecificHoverMenu(el)) {\n    el = el.parentNode;\n  }\n  return getSpecificHoverMenu(el);\n}\n\nexport class HoverMenuSystem {\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const hoverMenu = findHoverMenu(interaction.state.rightRemote.hovered);\n\n    if (this.prevHoverMenu && this.prevHoverMenu !== hoverMenu) {\n      this.prevHoverMenu.hovering = false;\n      this.prevHoverMenu.applyHoverState();\n    }\n\n    if (hoverMenu && this.prevHoverMenu !== hoverMenu) {\n      hoverMenu.hovering = true;\n      hoverMenu.applyHoverState();\n    }\n\n    this.prevHoverMenu = hoverMenu;\n  }\n}\n","import { addMedia } from \"../utils/media-utils\";\nimport { ObjectContentOrigins } from \"../object-types\";\n\n// WARNING: This system mutates interaction system state!\nexport class SuperSpawnerSystem {\n  maybeSpawn(state, entity, grabPath) {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const superSpawner = state.hovered && state.hovered.components[\"super-spawner\"];\n    if (\n      superSpawner &&\n      !superSpawner.cooldownTimeout &&\n      userinput.get(grabPath) &&\n      window.APP.hubChannel.can(\"spawn_and_move_media\")\n    ) {\n      this.performSpawn(state, entity, grabPath, userinput, superSpawner);\n    }\n  }\n\n  performSpawn(state, entity, grabPath, userinput, superSpawner) {\n    entity.object3D.updateMatrices();\n    entity.object3D.matrix.decompose(entity.object3D.position, entity.object3D.quaternion, entity.object3D.scale);\n    const data = superSpawner.data;\n    const spawnedEntity = addMedia(\n      data.src,\n      data.template,\n      ObjectContentOrigins.SPAWNER,\n      null,\n      data.resolve,\n      data.resize,\n      false\n    ).entity;\n    spawnedEntity.object3D.position.copy(\n      data.useCustomSpawnPosition ? data.spawnPosition : superSpawner.el.object3D.position\n    );\n    spawnedEntity.object3D.rotation.copy(\n      data.useCustomSpawnRotation ? data.spawnRotation : superSpawner.el.object3D.rotation\n    );\n    spawnedEntity.object3D.scale.copy(data.useCustomSpawnScale ? data.spawnScale : superSpawner.el.object3D.scale);\n    spawnedEntity.object3D.matrixNeedsUpdate = true;\n    state.held = spawnedEntity;\n\n    superSpawner.activateCooldown();\n    state.spawning = true;\n    // WARNING: previously used waitForEvent which is semantically different than\n    // entity.addEventListener(\"body-loaded\", ...) and adding a callback fn via\n    // addEventListener will not work unless the callback function wraps its code in setTimeout(()=>{...}, 0)\n    spawnedEntity.addEventListener(\n      \"body-loaded\",\n      () => {\n        setTimeout(() => {\n          state.spawning = false;\n          spawnedEntity.object3D.position.copy(\n            data.useCustomSpawnPosition ? data.spawnPosition : superSpawner.el.object3D.position\n          );\n          if (data.centerSpawnedObject) {\n            spawnedEntity.body.position.copy(entity.object3D.position);\n          }\n          spawnedEntity.object3D.matrixNeedsUpdate = true;\n        });\n      },\n      { once: true }\n    );\n  }\n\n  tick() {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    this.maybeSpawn(\n      interaction.state.leftHand,\n      interaction.options.leftHand.entity,\n      interaction.options.leftHand.grabPath\n    );\n    this.maybeSpawn(\n      interaction.state.rightHand,\n      interaction.options.rightHand.entity,\n      interaction.options.rightHand.grabPath\n    );\n    this.maybeSpawn(\n      interaction.state.rightRemote,\n      interaction.options.rightRemote.entity,\n      interaction.options.rightRemote.grabPath\n    );\n  }\n}\n","import { paths } from \"./userinput/paths\";\nimport { distanceBetweenStretchers } from \"./two-point-stretching-system\";\n\nfunction copyState(previous, current, isTeleporting) {\n  previous.held = current.held;\n  previous.hovered = current.hovered;\n  previous.isTeleporting = isTeleporting;\n}\n\n// TODO: These strengths should be written into bindings, since vibration strength varies across devices.\nconst STRENGTH = {\n  DROP: 0.1,\n  PICKUP: 0.2,\n  BUTTON_PRESSED: 0.2,\n  HOVER: 0.08,\n  STRETCH_BASE: 0.05,\n  STRETCH_DISTANCE: 0.2,\n  TELEPORTING: 0.08,\n  TELEPORTED: 0.2\n};\n\nfunction determineStrength(previous, current, isTeleporting) {\n  if (previous.held && !current.held) {\n    return STRENGTH.DROP;\n  } else if (!previous.held && current.held) {\n    return STRENGTH.PICKUP;\n  } else if (!previous.hovered && current.hovered) {\n    return STRENGTH.HOVER;\n  } else if (isTeleporting) {\n    return STRENGTH.TELEPORTING;\n  } else if (previous.isTeleporting && !isTeleporting) {\n    return STRENGTH.TELEPORTED;\n  } else {\n    return 0;\n  }\n}\n\nfunction determineStretchStrength(stretchSystem) {\n  if (!stretchSystem.stretcherLeft || !stretchSystem.stretcherRight) {\n    return 0;\n  }\n\n  return THREE.Math.clamp(\n    STRENGTH.STRETCH_BASE +\n      STRENGTH.STRETCH_DISTANCE *\n        Math.abs(\n          distanceBetweenStretchers(stretchSystem.stretcherLeft, stretchSystem.stretcherRight) -\n            stretchSystem.initialStretchDistance\n        ),\n    0,\n    0.5\n  );\n}\n\nexport class HapticFeedbackSystem {\n  constructor() {\n    this.state = {\n      rightHand: {\n        held: null,\n        hovered: null,\n        isTeleporting: false\n      },\n      rightRemote: {\n        held: null,\n        hovered: null,\n        isTeleporting: false\n      },\n      leftHand: {\n        held: null,\n        hovered: null,\n        isTeleporting: false\n      }\n    };\n  }\n\n  tick(twoPointStretchingSystem, didClickButton) {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const leftActuator = userinput.get(paths.haptics.actuators.left);\n    const rightActuator = userinput.get(paths.haptics.actuators.right);\n    if (!leftActuator && !rightActuator) {\n      return;\n    }\n\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const { leftHand, rightHand, rightRemote } = interaction.state;\n    this.leftTeleporter =\n      this.leftTeleporter || document.querySelector(\"#player-left-controller\").components.teleporter;\n    this.rightTeleporter =\n      this.rightTeleporter || document.querySelector(\"#player-right-controller\").components.teleporter;\n\n    const leftHandStrength = determineStrength(this.state.leftHand, leftHand, this.leftTeleporter.isTeleporting);\n    const rightHandStrength = determineStrength(this.state.rightHand, rightHand, this.rightTeleporter.isTeleporting);\n    const rightRemoteStrength = determineStrength(this.state.rightRemote, rightRemote, false);\n    const buttonPressedStrength = didClickButton ? STRENGTH.BUTTON_PRESSED : 0;\n    const stretchingStrength = determineStretchStrength(twoPointStretchingSystem);\n\n    const leftStrength = Math.max(leftHandStrength, stretchingStrength);\n    const rightStrength = Math.max(rightHandStrength, rightRemoteStrength, stretchingStrength, buttonPressedStrength);\n\n    if (leftStrength && leftActuator) {\n      leftActuator.pulse(leftStrength, 15);\n    }\n\n    if (rightStrength && rightActuator) {\n      rightActuator.pulse(rightStrength, 15);\n    }\n\n    copyState(this.state.rightHand, rightHand, this.rightTeleporter.isTeleporting);\n    copyState(this.state.leftHand, leftHand, this.leftTeleporter.isTeleporting);\n    copyState(this.state.rightRemote, rightRemote, false);\n  }\n}\n","import { BatchRawUniformGroup } from \"@mozillareality/three-batch-manager\";\n\nconst tempVec3 = new Array(3);\nconst tempVec4 = new Array(4);\n\nexport const INSTANCE_DATA_BYTE_LENGTH = 112;\nconst DEFAULT_COLOR = new THREE.Color(1, 1, 1);\nconst HIDE_MATRIX = new THREE.Matrix4().makeScale(0, 0, 0);\n\nexport function sizeofInstances(instanceCount) {\n  const hubsDataSize =\n    instanceCount * 4 * 4 + // sweepParams\n    4 *\n      (3 + // interactorOnePos\n      1 + // isFrozen\n      3 + // interactorTwoPos\n        1); // time\n  return instanceCount * INSTANCE_DATA_BYTE_LENGTH + hubsDataSize;\n}\n\nexport default class HubsBatchRawUniformGroup extends BatchRawUniformGroup {\n  constructor(maxInstances, meshToEl) {\n    const data = new ArrayBuffer(sizeofInstances(maxInstances));\n    super(maxInstances, \"InstanceData\", data);\n\n    let offset = this.offset;\n    this.hubs_sweepParams = new Float32Array(this.data, offset, 4 * maxInstances);\n    offset += this.hubs_sweepParams.byteLength;\n\n    this.hubs_interactorOnePos = new Float32Array(this.data, offset, 3);\n    offset += this.hubs_interactorOnePos.byteLength;\n\n    this.hubs_isFrozen = new Uint32Array(this.data, offset, 1);\n    offset += this.hubs_isFrozen.byteLength;\n\n    this.hubs_interactorTwoPos = new Float32Array(this.data, offset, 3);\n    offset += this.hubs_interactorTwoPos.byteLength;\n\n    this.hubs_time = new Float32Array(this.data, offset, 1);\n    offset += this.hubs_time.byteLength;\n\n    this.offset = offset;\n\n    this.meshToEl = meshToEl;\n  }\n\n  update(time) {\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    let interactorOne, interactorTwo;\n\n    for (let instanceId = 0; instanceId < this.meshes.length; instanceId++) {\n      const mesh = this.meshes[instanceId];\n      if (!mesh) continue;\n\n      mesh.updateMatrices();\n\n      // TODO need to account for nested visibility deeper than 1 level\n      this.setInstanceTransform(instanceId, mesh.visible && mesh.parent.visible ? mesh.matrixWorld : HIDE_MATRIX);\n      this.setInstanceColor(instanceId, mesh.material.color || DEFAULT_COLOR, mesh.material.opacity || 1);\n\n      const el = this.meshToEl.get(mesh);\n      if (el) {\n        const obj = el.object3D;\n        const hoverableVisuals = el.components[\"hoverable-visuals\"];\n        const worldY = obj.matrixWorld.elements[13];\n        const scaledRadius = obj.scale.y * hoverableVisuals.boundingSphere.radius;\n\n        const isPinned = el.components.pinnable && el.components.pinnable.data.pinned;\n        const isSpawner = !!el.components[\"super-spawner\"];\n        const isFrozen = el.sceneEl.is(\"frozen\");\n        const hideDueToPinning = !isSpawner && isPinned && !isFrozen;\n\n        let highlightInteractorOne, highlightInteractorTwo;\n        if (interaction.state.leftHand.hovered === el && !interaction.state.leftHand.held) {\n          interactorOne = interaction.options.leftHand.entity.object3D;\n          highlightInteractorOne = true;\n        }\n\n        if (interaction.state.rightRemote.hovered === el && !interaction.state.rightRemote.held) {\n          interactorTwo = interaction.options.rightRemote.entity.object3D;\n          highlightInteractorTwo = true;\n        } else if (interaction.state.rightHand.hovered === el && !interaction.state.rightHand.held) {\n          interactorTwo = interaction.options.rightHand.entity.object3D;\n          highlightInteractorTwo = true;\n        }\n\n        tempVec4[0] = worldY - scaledRadius;\n        tempVec4[1] = worldY + scaledRadius;\n        tempVec4[2] = !!highlightInteractorOne && !hideDueToPinning;\n        tempVec4[3] = !!highlightInteractorTwo && !hideDueToPinning;\n        this.hubs_sweepParams.set(tempVec4, instanceId * 4);\n      }\n    }\n\n    if (interactorOne) {\n      tempVec3[0] = interactorOne.matrixWorld.elements[12];\n      tempVec3[1] = interactorOne.matrixWorld.elements[13];\n      tempVec3[2] = interactorOne.matrixWorld.elements[14];\n      this.hubs_interactorOnePos.set(tempVec3);\n    }\n\n    if (interactorTwo) {\n      tempVec3[0] = interactorTwo.matrixWorld.elements[12];\n      tempVec3[1] = interactorTwo.matrixWorld.elements[13];\n      tempVec3[2] = interactorTwo.matrixWorld.elements[14];\n      this.hubs_interactorTwoPos.set(tempVec3);\n    }\n\n    this.hubs_time[0] = time;\n    this.hubs_isFrozen[0] = AFRAME.scenes[0].is(\"frozen\") ? 1 : 0;\n  }\n}\n","import { BatchManager } from \"@mozillareality/three-batch-manager\";\n\nimport HubsBatchRawUniformGroup from \"./render-manager/hubs-batch-raw-uniform-group\";\nimport { sizeofInstances } from \"./render-manager/hubs-batch-raw-uniform-group\";\nimport unlitBatchVert from \"./render-manager/unlit-batch.vert\";\nimport unlitBatchFrag from \"./render-manager/unlit-batch.frag\";\nimport qsTruthy from \"../utils/qs_truthy\";\n\nconst MAX_INSTANCES = 500;\nconst UBO_BYTE_LENGTH = sizeofInstances(MAX_INSTANCES);\n\nexport class BatchManagerSystem {\n  constructor(scene, renderer) {\n    this.meshToEl = new WeakMap();\n    const gl = renderer.context;\n\n    if (qsTruthy(\"disableBatching\")) {\n      console.warn(\"Batching disabled by user via disableBatching. Disabling batching.\");\n      return;\n    }\n\n    if (!(window.WebGL2RenderingContext && gl instanceof WebGL2RenderingContext)) {\n      console.warn(\"Batching requires WebGL 2. Disabling batching.\");\n      return;\n    }\n\n    if (UBO_BYTE_LENGTH > gl.getParameter(gl.MAX_UNIFORM_BLOCK_SIZE)) {\n      console.warn(\"Insufficient MAX_UNIFORM_BLOCK_SIZE, Disabling batching\");\n      return;\n    }\n\n    this.batchingEnabled = true;\n\n    this.ubo = new HubsBatchRawUniformGroup(MAX_INSTANCES, this.meshToEl);\n    this.batchManager = new BatchManager(scene, renderer, {\n      maxInstances: MAX_INSTANCES,\n      ubo: this.ubo,\n      shaders: {\n        unlit: {\n          vertexShader: unlitBatchVert,\n          fragmentShader: unlitBatchFrag\n        }\n      }\n    });\n  }\n\n  addObject(rootObject) {\n    if (!this.batchingEnabled) return 0;\n\n    let batchedCount = 0;\n    rootObject.traverse(object => {\n      if (object.isMesh) {\n        if (this.batchManager.addMesh(object)) batchedCount++;\n      }\n    });\n    return batchedCount;\n  }\n\n  removeObject(rootObject) {\n    if (!this.batchingEnabled) return;\n\n    rootObject.traverse(object => {\n      if (object.isMesh) {\n        this.batchManager.removeMesh(object);\n      }\n    });\n  }\n\n  tick(time) {\n    if (!this.batchingEnabled) return;\n\n    this.batchManager.update(time);\n  }\n}\n","export class LobbyCameraSystem {\n  tick() {\n    const el = document.querySelector(\"[scene-preview-camera]\");\n    if (el) {\n      el.components[\"scene-preview-camera\"].tick2();\n    }\n  }\n}\n","import { CursorTargettingSystem } from \"./cursor-targetting-system\";\nimport { ConstraintsSystem } from \"./constraints-system\";\nimport { TwoPointStretchingSystem } from \"./two-point-stretching-system\";\nimport { SingleActionButtonSystem, HoldableButtonSystem, HoverButtonSystem } from \"./button-systems\";\nimport { HoverMenuSystem } from \"./hover-menu-system\";\nimport { SuperSpawnerSystem } from \"./super-spawner-system\";\nimport { HapticFeedbackSystem } from \"./haptic-feedback-system\";\nimport { SoundEffectsSystem } from \"./sound-effects-system\";\n\nimport { BatchManagerSystem } from \"./render-manager-system\";\nimport { LobbyCameraSystem } from \"./lobby-camera-system\";\n\nAFRAME.registerSystem(\"hubs-systems\", {\n  init() {\n    this.cursorTargettingSystem = new CursorTargettingSystem();\n    this.constraintsSystem = new ConstraintsSystem();\n    this.twoPointStretchingSystem = new TwoPointStretchingSystem();\n    this.singleActionButtonSystem = new SingleActionButtonSystem();\n    this.holdableButtonSystem = new HoldableButtonSystem();\n    this.hoverButtonSystem = new HoverButtonSystem();\n    this.hoverMenuSystem = new HoverMenuSystem();\n    this.superSpawnerSystem = new SuperSpawnerSystem();\n    this.hapticFeedbackSystem = new HapticFeedbackSystem();\n    this.soundEffectsSystem = new SoundEffectsSystem();\n    this.lobbyCameraSystem = new LobbyCameraSystem();\n    this.batchManagerSystem = new BatchManagerSystem(this.el.sceneEl.object3D, this.el.sceneEl.renderer);\n  },\n\n  tick(t) {\n    const systems = AFRAME.scenes[0].systems;\n    systems.userinput.tick2();\n    systems.interaction.tick2(this.soundEffectsSystem);\n    this.superSpawnerSystem.tick();\n    this.cursorTargettingSystem.tick(t);\n    this.constraintsSystem.tick();\n    this.twoPointStretchingSystem.tick();\n    this.singleActionButtonSystem.tick();\n    this.holdableButtonSystem.tick();\n    this.hoverButtonSystem.tick();\n    this.hoverMenuSystem.tick();\n    this.hapticFeedbackSystem.tick(this.twoPointStretchingSystem, this.singleActionButtonSystem.didInteractThisFrame);\n    this.soundEffectsSystem.tick();\n    this.lobbyCameraSystem.tick();\n    // batchManager is ticked in \"post-physics\" system\n  },\n\n  remove() {\n    this.cursorTargettingSystem.remove();\n  }\n});\n","import qsTruthy from \"../utils/qs_truthy\";\n\nAFRAME.registerSystem(\"capture-system\", {\n  init() {\n    this._gotAudioTrack = false;\n    this._recorderTimeout = null;\n  },\n\n  _initRecorder() {\n    if (!this.available()) return;\n\n    this._stream = new MediaStream();\n\n    const video = this.el.canvas.captureStream().getVideoTracks()[0];\n    this._stream.addTrack(video);\n\n    this._recorder = new MediaRecorder(this._stream, { mimeType: \"video/webm; codecs=vp8\" });\n\n    const chunks = [];\n\n    this._recorder.ondataavailable = e => {\n      chunks.push(e.data);\n    };\n    this._recorder.onstop = () => {\n      if (chunks.length === 0) return;\n      const mimeType = chunks[0].type;\n      const blob = new Blob(chunks, { type: mimeType });\n      chunks.length = 0;\n      this.el.emit(\"add_media\", new File([blob], \"capture\", { type: mimeType }));\n    };\n  },\n\n  available() {\n    return qsTruthy(\"video_capture\") && window.MediaRecorder && MediaRecorder.isTypeSupported(\"video/webm; codecs=vp8\");\n  },\n\n  started() {\n    return this._recorder && this._recorder.state !== \"inactive\";\n  },\n\n  _tryAddingAudioTrack() {\n    if (this._gotAudioTrack || !this.el.audioListener) return;\n\n    const listener = this.el.audioListener;\n    const destination = listener.context.createMediaStreamDestination();\n    listener.getInput().connect(destination);\n    const audio = destination.stream.getAudioTracks()[0];\n\n    this._stream.addTrack(audio);\n    this._gotAudioTrack = true;\n  },\n\n  start() {\n    if (!this._recorder) {\n      this._initRecorder();\n    }\n\n    // The scene doesn't get an audioListener until something in the scene is playing audio.\n    // So we have to get the audio track lazily.\n    this._tryAddingAudioTrack();\n\n    if (!this.started()) {\n      this._recorder.start();\n      this._recorderTimeout = setTimeout(() => {\n        if (this.started()) {\n          this._recorder.stop();\n        }\n      }, 15000);\n    }\n  },\n\n  stop() {\n    if (this.started()) {\n      clearTimeout(this._recorderTimeout);\n      this._recorder.stop();\n    }\n  }\n});\n","/* global AFRAME THREE */\n\n// See doc/spritesheet-generation.md for information about this spritesheet\nimport spritesheet from \"../assets/images/spritesheets/sprite-system-spritesheet.json\";\nimport { createImageTexture } from \"../utils/media-utils\";\nimport spritesheetPng from \"../assets/images/spritesheets/sprite-system-spritesheet.png\";\nimport { waitForDOMContentLoaded } from \"../utils/async-utils\";\nimport vert from \"./sprites/sprite.vert\";\nimport frag from \"./sprites/sprite.frag\";\n\nconst multiviewVertPrefix = [\n  // GLSL 3.0 conversion\n  \"#version 300 es\",\n  \"#define attribute in\",\n  \"#define varying out\",\n  \"#define texture2D texture\",\n  \"#extension GL_OVR_multiview : require\",\n  \"layout(num_views = 2) in;\",\n  \"uniform mat4 modelViewMatrix;\",\n  \"uniform mat4 modelViewMatrix2;\",\n  \"#define modelViewMatrix (gl_ViewID_OVR==0u?modelViewMatrix:modelViewMatrix2)\",\n  \"uniform mat4 projectionMatrix;\",\n  \"uniform mat4 projectionMatrix2;\",\n  \"#define projectionMatrix (gl_ViewID_OVR==0u?projectionMatrix:projectionMatrix2)\",\n  \"\"\n].join(\"\\n\");\nconst nonmultiviewVertPrefix = [\"uniform mat4 modelViewMatrix;\", \"uniform mat4 projectionMatrix;\", \"\"].join(\"\\n\");\n\nconst multiviewFragPrefix = [\n  \"#version 300 es\",\n  \"#define varying in\",\n  \"out highp vec4 pc_fragColor;\",\n  \"#define gl_FragColor pc_fragColor\",\n  \"#define texture2D texture\",\n  \"\"\n].join(\"\\n\");\n\nconst nonmultiviewFragPrefix = \"\";\n\nfunction isVisible(o) {\n  if (!o.visible) return false;\n  if (!o.parent) return true;\n  return isVisible(o.parent);\n}\n\nAFRAME.registerComponent(\"sprite\", {\n  schema: { name: { type: \"string\" } },\n  tick() {\n    // TODO when we run out of sprites we currently just stop rendering them. We need to do something better.\n    if (!(this.didRegisterWithSystem || this.didFailToRegister) && this.el.sceneEl.systems[\"post-physics\"]) {\n      const registered = this.el.sceneEl.systems[\"post-physics\"].spriteSystem.add(this);\n      this.didRegisterWithSystem = registered > 0;\n      this.didFailToRegister = registered < 0;\n    }\n  },\n\n  update() {\n    if (this.didRegisterWithSystem) {\n      this.el.sceneEl.systems[\"post-physics\"].spriteSystem.updateUVs(this);\n    }\n  },\n\n  remove() {\n    if (this.didRegisterWithSystem) {\n      this.el.sceneEl.systems[\"post-physics\"].spriteSystem.remove(this);\n    }\n  }\n});\n\nconst normalizedFrame = (function() {\n  const memo = new Map();\n  return function normalizedFrame(name, spritesheet, missingSprites) {\n    let ret = memo.get(name);\n    if (ret) {\n      return ret;\n    } else {\n      if (!spritesheet.frames[name]) {\n        if (missingSprites.indexOf(name) === -1) {\n          missingSprites.push(name);\n        }\n        ret = { x: 0, y: 0, w: 0, h: 0 };\n        memo.set(name, ret);\n        return ret;\n      }\n      const size = spritesheet.meta.size;\n      const frame = spritesheet.frames[name].frame;\n      ret = {\n        x: frame.x / size.w,\n        y: frame.y / size.h,\n        w: frame.w / size.w,\n        h: frame.h / size.h\n      };\n      memo.set(name, ret);\n      return ret;\n    }\n  };\n})();\n\nconst raycastOnSprite = (function() {\n  const vA = new THREE.Vector3();\n  const vB = new THREE.Vector3();\n  const vC = new THREE.Vector3();\n  const vD = new THREE.Vector3();\n  const point = new THREE.Vector3();\n  const intersectionInfo = { distance: 0, point, object: null };\n\n  return function raycast(raycaster, intersects) {\n    vA.set(-0.5, 0.5, 0).applyMatrix4(this.matrixWorld);\n    vB.set(0.5, 0.5, 0).applyMatrix4(this.matrixWorld);\n    vC.set(-0.5, -0.5, 0).applyMatrix4(this.matrixWorld);\n    let intersect = raycaster.ray.intersectTriangle(vA, vC, vB, false, point);\n    if (intersect === null) {\n      vD.set(0.5, -0.5, 0).applyMatrix4(this.matrixWorld);\n      intersect = raycaster.ray.intersectTriangle(vB, vC, vD, false, point);\n      if (intersect === null) {\n        return;\n      }\n    }\n\n    const distance = raycaster.ray.origin.distanceTo(point);\n    if (distance < raycaster.near || distance > raycaster.far) return;\n\n    intersectionInfo.distance = distance;\n    intersectionInfo.point = point;\n    intersectionInfo.object = this;\n    intersects.push(intersectionInfo);\n  };\n})();\n\nfunction getHoverableVisuals(el) {\n  if (!el || !el.components) return null;\n  if (el.components[\"hoverable-visuals\"]) {\n    return el.components[\"hoverable-visuals\"];\n  }\n  return getHoverableVisuals(el.parentEl);\n}\n\nfunction enableSweepingEffect(comp) {\n  const hoverableVisuals = getHoverableVisuals(comp.el);\n  if (!hoverableVisuals) {\n    return false;\n  }\n\n  const isPinned = hoverableVisuals.el.components.pinnable && hoverableVisuals.el.components.pinnable.data.pinned;\n  const isSpawner = !!hoverableVisuals.el.components[\"super-spawner\"];\n  const isFrozen = hoverableVisuals.el.sceneEl.is(\"frozen\");\n  const hideDueToPinning = !isSpawner && isPinned && !isFrozen;\n  return hoverableVisuals.data.enableSweepingEffect && !hideDueToPinning;\n}\n\nfunction createGeometry(maxSprites) {\n  const geometry = new THREE.BufferGeometry();\n  geometry.addAttribute(\"a_vertices\", new THREE.BufferAttribute(new Float32Array(maxSprites * 3 * 4), 3, false));\n  geometry.addAttribute(\n    \"a_hubs_EnableSweepingEffect\",\n    new THREE.BufferAttribute(new Float32Array(maxSprites * 4), 1, false)\n  );\n  geometry.addAttribute(\n    \"a_hubs_SweepParams\",\n    new THREE.BufferAttribute(new Float32Array(maxSprites * 4 * 2), 2, false)\n  );\n  geometry.addAttribute(\"a_uvs\", new THREE.BufferAttribute(new Float32Array(maxSprites * 2 * 4), 2, false));\n  const mvCols = new THREE.InterleavedBuffer(new Float32Array(maxSprites * 16 * 4), 16);\n  geometry.addAttribute(\"mvCol0\", new THREE.InterleavedBufferAttribute(mvCols, 4, 0, false));\n  geometry.addAttribute(\"mvCol1\", new THREE.InterleavedBufferAttribute(mvCols, 4, 4, false));\n  geometry.addAttribute(\"mvCol2\", new THREE.InterleavedBufferAttribute(mvCols, 4, 8, false));\n  geometry.addAttribute(\"mvCol3\", new THREE.InterleavedBufferAttribute(mvCols, 4, 12, false));\n  const indices = new Array(3 * 2 * maxSprites);\n  for (let i = 0; i < maxSprites; i++) {\n    indices[i * 3 * 2 + 0] = i * 4 + 0;\n    indices[i * 3 * 2 + 1] = i * 4 + 2;\n    indices[i * 3 * 2 + 2] = i * 4 + 1;\n    indices[i * 3 * 2 + 3] = i * 4 + 1;\n    indices[i * 3 * 2 + 4] = i * 4 + 2;\n    indices[i * 3 * 2 + 5] = i * 4 + 3;\n  }\n  geometry.setIndex(indices);\n  return geometry;\n}\n\nconst ZEROS = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n\nexport class SpriteSystem {\n  raycast(raycaster, intersects) {\n    for (let i = 0; i < this.slots.length; i++) {\n      if (!this.slots[i]) continue;\n\n      const o = this.indexWithSprite.get(i).el.object3D;\n      if (isVisible(o)) {\n        raycastOnSprite.call(o, raycaster, intersects);\n      }\n    }\n    return intersects;\n  }\n  constructor(scene) {\n    this.missingSprites = [];\n    this.maxSprites = 512;\n    this.slots = new Array(this.maxSprites);\n    this.spriteWithIndex = new Map();\n    this.indexWithSprite = new Map();\n    this.stack = new Array(this.maxSprites);\n    for (let i = 0; i < this.maxSprites; i++) {\n      this.stack[i] = this.maxSprites - 1 - i;\n    }\n\n    const vertexShader = String.prototype.concat(\n      scene.renderer.vr.multiview ? multiviewVertPrefix : nonmultiviewVertPrefix,\n      vert\n    );\n    const fragmentShader = String.prototype.concat(\n      scene.renderer.vr.multiview ? multiviewFragPrefix : nonmultiviewFragPrefix,\n      frag\n    );\n    Promise.all([createImageTexture(spritesheetPng), waitForDOMContentLoaded()]).then(([spritesheetTexture]) => {\n      const material = new THREE.RawShaderMaterial({\n        uniforms: {\n          u_spritesheet: { value: spritesheetTexture },\n          hubs_Time: { value: 0 }\n        },\n        vertexShader,\n        fragmentShader,\n        side: THREE.DoubleSide,\n        transparent: true\n      });\n      this.mesh = new THREE.Mesh(createGeometry(this.maxSprites), material);\n      const el = document.createElement(\"a-entity\");\n      el.classList.add(\"ui\");\n      scene.appendChild(el);\n      el.setObject3D(\"mesh\", this.mesh);\n      this.mesh.frustumCulled = false;\n      this.mesh.renderOrder = window.APP.RENDER_ORDER.HUD_ICONS;\n      this.mesh.raycast = this.raycast.bind(this);\n    });\n  }\n\n  tick(t) {\n    if (!this.mesh) return;\n\n    this.mesh.material.uniforms.hubs_Time.value = t;\n    this.mesh.material.uniformsNeedUpdate = true;\n\n    const mvCols = this.mesh.geometry.attributes[\"mvCol0\"].data; // interleaved\n    const aEnableSweepingEffect = this.mesh.geometry.attributes[\"a_hubs_EnableSweepingEffect\"];\n    const aSweepParams = this.mesh.geometry.attributes[\"a_hubs_SweepParams\"];\n    for (let i = 0; i < this.slots.length; i++) {\n      if (!this.slots[i]) continue;\n\n      const sprite = this.indexWithSprite.get(i);\n      if (isVisible(sprite.el.object3D)) {\n        const enableSweepingEffectValue = enableSweepingEffect(sprite) ? 1 : 0;\n        aEnableSweepingEffect.array[i * 4 + 0] = enableSweepingEffectValue;\n        aEnableSweepingEffect.array[i * 4 + 1] = enableSweepingEffectValue;\n        aEnableSweepingEffect.array[i * 4 + 2] = enableSweepingEffectValue;\n        aEnableSweepingEffect.array[i * 4 + 3] = enableSweepingEffectValue;\n        aEnableSweepingEffect.needsUpdate = true;\n        if (enableSweepingEffectValue) {\n          const hoverableVisuals = getHoverableVisuals(sprite.el);\n          const s = hoverableVisuals.sweepParams[0];\n          const t = hoverableVisuals.sweepParams[1];\n          aSweepParams.setXY(4 * i + 0, s, t);\n          aSweepParams.setXY(4 * i + 1, s, t);\n          aSweepParams.setXY(4 * i + 2, s, t);\n          aSweepParams.setXY(4 * i + 3, s, t);\n          aSweepParams.needsUpdate = true;\n        }\n\n        sprite.el.object3D.updateMatrices();\n        const mat4 = sprite.el.object3D.matrixWorld;\n        mvCols.array.set(mat4.elements, i * 4 * 16 + 0);\n        mvCols.array.set(mat4.elements, i * 4 * 16 + 1 * 16);\n        mvCols.array.set(mat4.elements, i * 4 * 16 + 2 * 16);\n        mvCols.array.set(mat4.elements, i * 4 * 16 + 3 * 16);\n        mvCols.needsUpdate = true;\n      } else {\n        mvCols.array.set(ZEROS, i * 4 * 16 + 0);\n        mvCols.array.set(ZEROS, i * 4 * 16 + 1 * 16);\n        mvCols.array.set(ZEROS, i * 4 * 16 + 2 * 16);\n        mvCols.array.set(ZEROS, i * 4 * 16 + 3 * 16);\n        mvCols.needsUpdate = true;\n      }\n    }\n  }\n\n  updateUVs(sprite) {\n    const flipY = this.mesh.material.uniforms.u_spritesheet.value.flipY;\n    const i = this.spriteWithIndex.get(sprite);\n    const frame = normalizedFrame(sprite.data.name, spritesheet, this.missingSprites);\n    const aUvs = this.mesh.geometry.attributes[\"a_uvs\"];\n\n    aUvs.setXY(i * 4 + 0, frame.x, flipY ? 1 - frame.y : frame.y);\n    aUvs.setXY(i * 4 + 1, frame.x + frame.w, flipY ? 1 - frame.y : frame.y);\n    aUvs.setXY(i * 4 + 2, frame.x, flipY ? 1 - frame.y - frame.h : frame.y + frame.h);\n    aUvs.setXY(i * 4 + 3, frame.x + frame.w, flipY ? 1 - frame.y - frame.h : frame.y + frame.h);\n    aUvs.needsUpdate = true;\n  }\n\n  add(sprite) {\n    if (!this.mesh) {\n      return 0;\n    }\n    const i = this.stack.pop();\n    if (i === undefined) {\n      console.error(\"Too many sprites\");\n      return -1;\n    }\n    this.slots[i] = true;\n    this.spriteWithIndex.set(sprite, i);\n    this.indexWithSprite.set(i, sprite);\n\n    this.updateUVs(sprite);\n\n    const aVertices = this.mesh.geometry.attributes[\"a_vertices\"];\n    aVertices.setXYZ(i * 4 + 0, -0.5, 0.5, 0);\n    aVertices.setXYZ(i * 4 + 1, 0.5, 0.5, 0);\n    aVertices.setXYZ(i * 4 + 2, -0.5, -0.5, 0);\n    aVertices.setXYZ(i * 4 + 3, 0.5, -0.5, 0);\n    aVertices.needsUpdate = true;\n    return 1;\n  }\n\n  remove(sprite) {\n    const i = this.spriteWithIndex.get(sprite);\n    this.spriteWithIndex.delete(sprite);\n    this.indexWithSprite.delete(i);\n    this.slots[i] = false;\n    this.stack.push(i);\n\n    const mvCols = this.mesh.geometry.attributes[\"mvCol0\"].data; // interleaved\n    mvCols.array.set(ZEROS, i * 4 * 16 + 0);\n    mvCols.array.set(ZEROS, i * 4 * 16 + 1 * 16);\n    mvCols.array.set(ZEROS, i * 4 * 16 + 2 * 16);\n    mvCols.array.set(ZEROS, i * 4 * 16 + 3 * 16);\n    mvCols.needsUpdate = true;\n  }\n}\n","import { SpriteSystem } from \"./sprites\";\n\nconst i = window.setInterval(() => {\n  if (AFRAME.scenes[0] && AFRAME.scenes[0].systems && AFRAME.scenes[0].systems.physics) {\n    AFRAME.registerSystem(\"post-physics\", {\n      init() {\n        this.spriteSystem = new SpriteSystem(this.el);\n        this.hubsSystems = this.el.sceneEl.systems[\"hubs-systems\"];\n      },\n      tick(t, dt) {\n        this.spriteSystem.tick(t, dt);\n        this.hubsSystems.batchManagerSystem.tick(t);\n      }\n    });\n    window.clearInterval(i);\n  }\n}, 1000);\n","import { paths } from \"../systems/userinput/paths\";\n\nAFRAME.registerComponent(\"scalable-when-grabbed\", {\n  tick: function() {\n    const userinput = AFRAME.scenes[0].systems.userinput;\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    if (interaction.state.rightRemote.held !== this.el) return;\n    const deltaScale = userinput.get(paths.actions.cursor.scaleGrabbedGrabbable);\n    if (!deltaScale) return;\n\n    this.el.object3D.scale.addScalar(deltaScale).clampScalar(0.1, 100);\n    this.el.object3D.matrixNeedsUpdate = true;\n  }\n});\n","import { paths } from \"../systems/userinput/paths\";\nimport { sets } from \"../systems/userinput/sets\";\nimport { getLastWorldPosition } from \"../utils/three-utils\";\n\nconst HIGHLIGHT = new THREE.Color(23 / 255, 64 / 255, 118 / 255);\nconst NO_HIGHLIGHT = new THREE.Color(190 / 255, 190 / 255, 190 / 255);\nconst TRANSFORM_COLOR_1 = new THREE.Color(150 / 255, 80 / 255, 150 / 255);\nconst TRANSFORM_COLOR_2 = new THREE.Color(23 / 255, 64 / 255, 118 / 255);\nAFRAME.registerComponent(\"cursor-controller\", {\n  schema: {\n    cursor: { type: \"selector\" },\n    camera: { type: \"selector\" },\n    far: { default: 25 },\n    near: { default: 0.01 },\n    defaultDistance: { default: 4 },\n    minDistance: { default: 0.18 }\n  },\n\n  init: function() {\n    this.enabled = true;\n\n    this.data.cursor.addEventListener(\n      \"loaded\",\n      () => {\n        this.data.cursor.object3DMap.mesh.renderOrder = window.APP.RENDER_ORDER.CURSOR;\n      },\n      { once: true }\n    );\n\n    this.raycaster = new THREE.Raycaster();\n    this.raycaster.firstHitOnly = true; // flag specific to three-mesh-bvh\n    this.distance = this.data.far;\n    this.color = new THREE.Color(0, 0, 0);\n\n    const lineGeometry = new THREE.BufferGeometry();\n    lineGeometry.addAttribute(\"position\", new THREE.BufferAttribute(new Float32Array(2 * 3), 3));\n\n    this.line = new THREE.Line(\n      lineGeometry,\n      new THREE.LineBasicMaterial({\n        color: \"white\",\n        opacity: 0.2,\n        transparent: true,\n        visible: false\n      })\n    );\n    this.el.setObject3D(\"line\", this.line);\n  },\n\n  update: function() {\n    this.raycaster.far = this.data.far;\n    this.raycaster.near = this.data.near;\n  },\n\n  tick2: (() => {\n    const rawIntersections = [];\n    const cameraPos = new THREE.Vector3();\n\n    return function(t) {\n      const userinput = AFRAME.scenes[0].systems.userinput;\n      const cursorPose = userinput.get(paths.actions.cursor.pose);\n      const hideLine = userinput.get(paths.actions.cursor.hideLine);\n\n      this.data.cursor.object3D.visible = this.enabled && !!cursorPose;\n      this.line.material.visible = !!(this.enabled && !hideLine);\n\n      if (!this.enabled || !cursorPose) {\n        return;\n      }\n\n      const interaction = AFRAME.scenes[0].systems.interaction;\n      let intersection;\n      const isGrabbing = !!interaction.state.rightRemote.held;\n      if (!isGrabbing) {\n        rawIntersections.length = 0;\n        this.raycaster.ray.origin = cursorPose.position;\n        this.raycaster.ray.direction = cursorPose.direction;\n        this.raycaster.intersectObjects(\n          AFRAME.scenes[0].systems[\"hubs-systems\"].cursorTargettingSystem.targets,\n          true,\n          rawIntersections\n        );\n        intersection = rawIntersections[0];\n        interaction.updateCursorIntersection(intersection);\n        this.distance = intersection ? intersection.distance : this.data.defaultDistance;\n      }\n\n      const { cursor, minDistance, far, camera } = this.data;\n\n      const cursorModDelta = userinput.get(paths.actions.cursor.modDelta) || 0;\n      if (isGrabbing && !userinput.activeSets.includes(sets.cursorHoldingUI)) {\n        this.distance = THREE.Math.clamp(this.distance - cursorModDelta, minDistance, far);\n      }\n      cursor.object3D.position.copy(cursorPose.position).addScaledVector(cursorPose.direction, this.distance);\n      // The cursor will always be oriented towards the player about its Y axis, so objects held by the cursor will rotate towards the player.\n      getLastWorldPosition(camera.object3D, cameraPos);\n      cameraPos.y = cursor.object3D.position.y;\n      cursor.object3D.lookAt(cameraPos);\n      cursor.object3D.scale.setScalar(Math.pow(this.distance, 0.315) * 0.75);\n      cursor.object3D.matrixNeedsUpdate = true;\n\n      if (AFRAME.scenes[0].systems[\"transform-selected-object\"].transforming) {\n        this.color.copy(TRANSFORM_COLOR_1).lerpHSL(TRANSFORM_COLOR_2, 0.5 + 0.5 * Math.sin(t / 1000.0));\n      } else if (intersection || isGrabbing) {\n        this.color.copy(HIGHLIGHT);\n      } else {\n        this.color.copy(NO_HIGHLIGHT);\n      }\n\n      if (!this.data.cursor.object3DMap.mesh.material.color.equals(this.color)) {\n        this.data.cursor.object3DMap.mesh.material.color.copy(this.color);\n        this.data.cursor.object3DMap.mesh.material.needsUpdate = true;\n      }\n\n      if (this.line.material.visible) {\n        const posePosition = cursorPose.position;\n        const cursorPosition = cursor.object3D.position;\n        const positionArray = this.line.geometry.attributes.position.array;\n\n        positionArray[0] = posePosition.x;\n        positionArray[1] = posePosition.y;\n        positionArray[2] = posePosition.z;\n        positionArray[3] = cursorPosition.x;\n        positionArray[4] = cursorPosition.y;\n        positionArray[5] = cursorPosition.z;\n\n        this.line.geometry.attributes.position.needsUpdate = true;\n        this.line.geometry.computeBoundingSphere();\n      }\n    };\n  })()\n});\n","import { paths } from \"../../systems/userinput/paths\";\nimport { getLastWorldPosition, getLastWorldQuaternion } from \"../../utils/three-utils\";\nimport {\n  SOUND_PEN_START_DRAW,\n  SOUND_PEN_STOP_DRAW,\n  SOUND_PEN_UNDO_DRAW,\n  SOUND_PEN_CHANGE_COLOR\n} from \"../../systems/sound-effects-system\";\nimport { waitForDOMContentLoaded } from \"../../utils/async-utils\";\nimport MobileStandardMaterial from \"../../materials/MobileStandardMaterial\";\n\nconst pathsMap = {\n  \"player-right-controller\": {\n    startDrawing: paths.actions.rightHand.startDrawing,\n    stopDrawing: paths.actions.rightHand.stopDrawing,\n    undoDrawing: paths.actions.rightHand.undoDrawing,\n    switchDrawMode: paths.actions.rightHand.switchDrawMode,\n    penNextColor: paths.actions.rightHand.penNextColor,\n    penPrevColor: paths.actions.rightHand.penPrevColor,\n    scalePenTip: paths.actions.rightHand.scalePenTip\n  },\n  \"player-left-controller\": {\n    startDrawing: paths.actions.leftHand.startDrawing,\n    stopDrawing: paths.actions.leftHand.stopDrawing,\n    undoDrawing: paths.actions.leftHand.undoDrawing,\n    switchDrawMode: paths.actions.leftHand.switchDrawMode,\n    penNextColor: paths.actions.leftHand.penNextColor,\n    penPrevColor: paths.actions.leftHand.penPrevColor,\n    scalePenTip: paths.actions.leftHand.scalePenTip\n  },\n  cursor: {\n    pose: paths.actions.cursor.pose,\n    startDrawing: paths.actions.cursor.startDrawing,\n    stopDrawing: paths.actions.cursor.stopDrawing,\n    undoDrawing: paths.actions.cursor.undoDrawing,\n    penNextColor: paths.actions.cursor.penNextColor,\n    penPrevColor: paths.actions.cursor.penPrevColor,\n    scalePenTip: paths.actions.cursor.scalePenTip\n  }\n};\n\nconst DRAW_MODE = {\n  DEFAULT_2D: 0,\n  PROJECTION: 1\n};\n\nconst MAX_DISTANCE_BETWEEN_SURFACES = 1;\n\n/**\n * Pen tool\n * A tool that allows drawing on networked-drawing components.\n * @namespace drawing\n * @component pen\n */\n\nfunction almostEquals(epsilon, u, v) {\n  return Math.abs(u.x - v.x) < epsilon && Math.abs(u.y - v.y) < epsilon && Math.abs(u.z - v.z) < epsilon;\n}\n\nAFRAME.registerComponent(\"pen\", {\n  schema: {\n    drawFrequency: { default: 5 }, //frequency of polling for drawing points\n    minDistanceBetweenPoints: { default: 0.01 }, //minimum distance to register new drawing point\n    camera: { type: \"selector\" },\n    drawingManager: { type: \"string\" },\n    color: { type: \"color\", default: \"#FF0033\" },\n    availableColors: {\n      default: [\n        \"#FF0033\",\n        \"#FFFF00\",\n        \"#0099FF\",\n        \"#00FF33\",\n        \"#9900FF\",\n        \"#FF6600\",\n        \"#8D5524\",\n        \"#C68642\",\n        \"#E0AC69\",\n        \"#F1C27D\",\n        \"#FFDBAC\",\n        \"#FFFFFF\",\n        \"#222222\",\n        \"#111111\",\n        \"#000000\"\n      ]\n    },\n    radius: { default: 0.01 }, //drawing geometry radius\n    minRadius: { default: 0.005 },\n    maxRadius: { default: 0.2 },\n    far: { default: 100 },\n    near: { default: 0.01 }\n  },\n\n  init() {\n    this.timeSinceLastDraw = 0;\n\n    this.lastPosition = new THREE.Vector3();\n    this.lastPosition.copy(this.el.object3D.position);\n\n    this.direction = new THREE.Vector3(1, 0, 0);\n\n    this.currentDrawing = null;\n\n    this.normal = new THREE.Vector3();\n\n    this.worldPosition = new THREE.Vector3();\n\n    this.colorIndex = 0;\n\n    this.grabbed = false;\n\n    this.raycaster = new THREE.Raycaster();\n    this.raycaster.firstHitOnly = true; // flag specific to three-mesh-bvh\n\n    this.originalPosition = this.el.object3D.position.clone();\n    this.intersection = null;\n    this.lastIntersectionDistance = 0;\n\n    const lineGeometry = new THREE.BufferGeometry();\n    lineGeometry.addAttribute(\"position\", new THREE.BufferAttribute(new Float32Array(2 * 3), 3));\n\n    this.line = new THREE.Line(\n      lineGeometry,\n      new THREE.LineBasicMaterial({\n        color: \"red\",\n        opacity: 0.2,\n        transparent: true,\n        visible: true\n      })\n    );\n\n    //prevents the line from being a raycast target for the cursor\n    this.line.raycast = function() {};\n\n    this.el.parentEl.setObject3D(\"penline\", this.line);\n\n    this.drawMode = DRAW_MODE.DEFAULT_2D;\n\n    this.targets = [];\n    this.setDirty = this.setDirty.bind(this);\n    this.dirty = true;\n\n    let material = new THREE.MeshStandardMaterial();\n    if (window.APP && window.APP.quality === \"low\") {\n      material = MobileStandardMaterial.fromStandardMaterial(material);\n    }\n    this.penTip = new THREE.Mesh(new THREE.SphereBufferGeometry(1, 16, 12), material);\n    this.penTip.scale.setScalar(this.data.radius / this.el.parentEl.object3D.scale.x);\n    this.penTip.matrixNeedsUpdate = true;\n\n    this.el.setObject3D(\"mesh\", this.penTip);\n\n    const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\n    if (environmentMapComponent) {\n      environmentMapComponent.applyEnvironmentMap(this.el.parentEl.object3D);\n    }\n\n    // TODO: Use the MutationRecords passed into the callback function to determine added/removed nodes!\n    this.observer = new MutationObserver(this.setDirty);\n\n    waitForDOMContentLoaded().then(() => {\n      const scene = document.querySelector(\"a-scene\");\n      this.rightRemote = document.querySelector(\"#cursor-controller\");\n      this.observer.observe(scene, { childList: true, attributes: true, subtree: true });\n      scene.addEventListener(\"object3dset\", this.setDirty);\n      scene.addEventListener(\"object3dremove\", this.setDirty);\n    });\n  },\n\n  play() {\n    this.drawingManager = document.querySelector(this.data.drawingManager).components[\"drawing-manager\"];\n    this.drawingManager.createDrawing();\n  },\n\n  update(prevData) {\n    if (prevData.color != this.data.color) {\n      this.penTip.material.color.set(this.data.color);\n      this.line.material.color.set(this.data.color);\n    }\n    if (prevData.radius != this.data.radius) {\n      this.el.setAttribute(\"radius\", this.data.radius);\n    }\n\n    this.raycaster.far = this.data.far;\n    this.raycaster.near = this.data.near;\n  },\n\n  tick: (() => {\n    const rawIntersections = [];\n    const lineStartPosition = new THREE.Vector3();\n    const lineEndPosition = new THREE.Vector3();\n    const worldQuaternion = new THREE.Quaternion();\n    return function(t, dt) {\n      const userinput = AFRAME.scenes[0].systems.userinput;\n      const interaction = AFRAME.scenes[0].systems.interaction;\n\n      if (interaction.state.rightHand.held === this.el.parentNode) {\n        this.grabberId = \"player-right-controller\";\n      } else if (interaction.state.leftHand.held === this.el.parentNode) {\n        this.grabberId = \"player-left-controller\";\n      } else if (interaction.state.rightRemote.held === this.el.parentNode) {\n        this.grabberId = \"cursor\";\n        this.drawMode = DRAW_MODE.PROJECTION;\n      } else {\n        this.grabberId = null;\n      }\n\n      if (this.grabberId && pathsMap[this.grabberId]) {\n        const sfx = this.el.sceneEl.systems[\"hubs-systems\"].soundEffectsSystem;\n        const paths = pathsMap[this.grabberId];\n        if (userinput.get(paths.startDrawing)) {\n          this._startDraw();\n          sfx.playSoundOneShot(SOUND_PEN_START_DRAW);\n        }\n        if (userinput.get(paths.stopDrawing)) {\n          this._endDraw();\n          sfx.playSoundOneShot(SOUND_PEN_STOP_DRAW);\n        }\n        const penScaleMod = userinput.get(paths.scalePenTip);\n        if (penScaleMod) {\n          this._changeRadius(penScaleMod);\n        }\n        if (userinput.get(paths.penNextColor)) {\n          this._changeColor(1);\n          sfx.playSoundOneShot(SOUND_PEN_CHANGE_COLOR);\n        }\n        if (userinput.get(paths.penPrevColor)) {\n          this._changeColor(-1);\n          sfx.playSoundOneShot(SOUND_PEN_CHANGE_COLOR);\n        }\n        if (userinput.get(paths.undoDrawing)) {\n          this._undoDraw();\n          sfx.playSoundOneShot(SOUND_PEN_UNDO_DRAW);\n        }\n        if (paths.switchDrawMode && userinput.get(paths.switchDrawMode)) {\n          this.drawMode = this.drawMode === DRAW_MODE.DEFAULT_2D ? DRAW_MODE.PROJECTION : DRAW_MODE.DEFAULT_2D;\n        }\n      }\n\n      rawIntersections.length = 0;\n\n      this.intersection = null;\n      let cursorPose;\n      if (this.drawMode === DRAW_MODE.PROJECTION) {\n        if (this.grabberId === \"cursor\") {\n          cursorPose = userinput.get(pathsMap.cursor.pose);\n          if (cursorPose) {\n            this.raycaster.ray.origin.copy(cursorPose.position);\n            this.raycaster.ray.direction.copy(cursorPose.direction);\n          }\n        } else if (this.grabberId !== null) {\n          getLastWorldPosition(this.el.parentEl.object3D, this.raycaster.ray.origin);\n          getLastWorldQuaternion(this.el.parentEl.object3D, worldQuaternion);\n          this.raycaster.ray.direction.set(0, -1, 0);\n          this.raycaster.ray.direction.applyQuaternion(worldQuaternion);\n        }\n\n        if (this.grabberId !== null) {\n          this.raycaster.intersectObjects(this.targets, true, rawIntersections);\n          this.intersection = rawIntersections[0];\n\n          if (this.intersection) {\n            if (cursorPose) {\n              lineStartPosition.copy(cursorPose.position);\n              this.el.parentEl.object3D.worldToLocal(lineStartPosition);\n            } else {\n              lineStartPosition.set(0, 0, 0);\n            }\n            lineEndPosition.copy(this.intersection.point);\n            this.el.parentEl.object3D.worldToLocal(lineEndPosition);\n\n            const positionArray = this.line.geometry.attributes.position.array;\n            positionArray[0] = lineStartPosition.x;\n            positionArray[1] = lineStartPosition.y;\n            positionArray[2] = lineStartPosition.z;\n            positionArray[3] = lineEndPosition.x;\n            positionArray[4] = lineEndPosition.y;\n            positionArray[5] = lineEndPosition.z;\n\n            this.line.geometry.attributes.position.needsUpdate = true;\n          }\n\n          if (this.intersection) {\n            this.el.object3D.position.copy(this.intersection.point);\n\n            this.el.parentEl.object3D.worldToLocal(this.el.object3D.position);\n\n            this.el.object3D.matrixNeedsUpdate = true;\n            this.worldPosition.copy(this.intersection.point);\n          } else {\n            this.el.object3D.position.copy(this.originalPosition);\n            this.el.object3D.matrixNeedsUpdate = true;\n            getLastWorldPosition(this.el.object3D, this.worldPosition);\n          }\n        }\n      } else {\n        this.el.object3D.position.copy(this.originalPosition);\n        this.el.object3D.matrixNeedsUpdate = true;\n        getLastWorldPosition(this.el.object3D, this.worldPosition);\n      }\n\n      this._setPenVisible(this.grabberId !== \"cursor\" || !this.intersection);\n      this._setLineVisible(\n        this.el.sceneEl.is(\"vr-mode\") && this.drawMode === DRAW_MODE.PROJECTION && this.intersection\n      );\n\n      //Prevent drawings from \"jumping\" large distances\n      if (\n        this.currentDrawing &&\n        (this.lastIntersectedObject !== (this.intersection ? this.intersection.object : null) &&\n          (!this.intersection ||\n            Math.abs(this.intersection.distance - this.lastIntersectionDistance) > MAX_DISTANCE_BETWEEN_SURFACES))\n      ) {\n        this.worldPosition.copy(this.lastPosition);\n        this._endDraw();\n      }\n      this.lastIntersectionDistance = this.intersection ? this.intersection.distance : 0;\n      this.lastIntersectedObject = this.intersection ? this.intersection.object : null;\n\n      if (!almostEquals(0.005, this.worldPosition, this.lastPosition)) {\n        this.direction.subVectors(this.worldPosition, this.lastPosition).normalize();\n        this.lastPosition.copy(this.worldPosition);\n      }\n\n      if (this.currentDrawing) {\n        const time = this.timeSinceLastDraw + dt;\n        if (\n          time >= this.data.drawFrequency &&\n          this.currentDrawing.getLastPoint().distanceTo(this.worldPosition) >= this.data.minDistanceBetweenPoints\n        ) {\n          this._getNormal(this.normal, this.worldPosition, this.direction);\n          this.currentDrawing.draw(this.worldPosition, this.direction, this.normal, this.data.color, this.data.radius);\n        }\n\n        this.timeSinceLastDraw = time % this.data.drawFrequency;\n      }\n\n      if (this.currentDrawing && !this.grabberId) {\n        this._endDraw();\n      }\n\n      if (this.dirty) {\n        this.populateEntities(this.targets);\n        this.dirty = false;\n      }\n\n      this.el.object3D.matrixNeedsUpdate = true;\n    };\n  })(),\n\n  _setPenVisible(visible) {\n    if (this.el.parentEl.object3DMap.mesh && this.el.parentEl.object3DMap.mesh.visible !== visible) {\n      this.el.parentEl.object3DMap.mesh.visible = visible;\n    }\n  },\n\n  _setLineVisible(visible) {\n    if (this.line.material.visible !== visible) {\n      this.line.material.visible = visible;\n    }\n  },\n\n  //helper function to get normal of direction of drawing cross direction to camera\n  _getNormal: (() => {\n    const directionToCamera = new THREE.Vector3();\n    return function(normal, position, direction) {\n      directionToCamera.subVectors(position, this.data.camera.object3D.position).normalize();\n      normal.crossVectors(direction, directionToCamera);\n    };\n  })(),\n\n  _startDraw() {\n    this.currentDrawing = this.drawingManager.getDrawing(this);\n    if (this.currentDrawing) {\n      this._getNormal(this.normal, this.worldPosition, this.direction);\n      this.currentDrawing.startDraw(this.worldPosition, this.direction, this.normal, this.data.color, this.data.radius);\n    }\n  },\n\n  _endDraw() {\n    if (this.currentDrawing) {\n      this.timeSinceLastDraw = 0;\n      this._getNormal(this.normal, this.worldPosition, this.direction);\n      this.currentDrawing.endDraw(this.worldPosition, this.direction, this.normal);\n      this.drawingManager.returnDrawing(this);\n      this.currentDrawing = null;\n    }\n  },\n\n  _undoDraw() {\n    const drawing = this.drawingManager.getDrawing(this);\n    if (drawing) {\n      drawing.undoDraw();\n      this.drawingManager.returnDrawing(this);\n    }\n  },\n\n  _changeColor(mod) {\n    this.colorIndex = (this.colorIndex + mod + this.data.availableColors.length) % this.data.availableColors.length;\n    this.data.color = this.data.availableColors[this.colorIndex];\n    this.penTip.material.color.set(this.data.color);\n    this.line.material.color.set(this.data.color);\n  },\n\n  _changeRadius(mod) {\n    this.data.radius = Math.max(this.data.minRadius, Math.min(this.data.radius + mod, this.data.maxRadius));\n    this.penTip.scale.setScalar(this.data.radius / this.el.parentEl.object3D.scale.x);\n    this.penTip.matrixNeedsUpdate = true;\n  },\n\n  setDirty() {\n    this.dirty = true;\n  },\n\n  populateEntities(targets) {\n    targets.length = 0;\n    // TODO: Do not querySelectorAll on the entire scene every time anything changes!\n    const els = AFRAME.scenes[0].querySelectorAll(\".collidable, .interactable, #environment-root\");\n    for (let i = 0; i < els.length; i++) {\n      if (!els[i].classList.contains(\"pen\") && els[i].object3D) {\n        targets.push(els[i].object3D);\n      }\n    }\n  },\n\n  remove() {\n    this.observer.disconnect();\n    AFRAME.scenes[0].removeEventListener(\"object3dset\", this.setDirty);\n    AFRAME.scenes[0].removeEventListener(\"object3dremove\", this.setDirty);\n    this.el.parentEl.removeObject3D(\"penline\");\n  }\n});\n","export default class SharedBufferGeometry {\n  constructor(material, primitiveMode, maxBufferSize) {\n    this.material = material;\n    this.primitiveMode = primitiveMode;\n\n    this.maxBufferSize = maxBufferSize;\n    this.geometries = [];\n    this.current = null;\n    this.drawing = new THREE.Object3D();\n    this.addBuffer();\n  }\n\n  restartPrimitive() {\n    if (this.idx.position >= this.current.attributes.position.count) {\n      console.error(\"maxBufferSize limit exceeded\");\n    } else if (this.idx.position !== 0) {\n      let prev = (this.idx.position - 1) * 3;\n      const position = this.current.attributes.position.array;\n      this.addVertex(position[prev++], position[prev++], position[prev++]);\n\n      this.idx.color++;\n      this.idx.normal++;\n    }\n  }\n\n  remove(prevIdx, idx) {\n    // Loop through all the attributes: position, color, normal,...\n    if (this.idx.position > idx.position) {\n      for (const key in this.idx) {\n        const componentSize = 3;\n        let pos = prevIdx[key] * componentSize;\n        const start = (idx[key] + 1) * componentSize;\n        const end = this.idx[key] * componentSize;\n        for (let i = start; i < end; i++) {\n          this.current.attributes[key].array[pos++] = this.current.attributes[key].array[i];\n        }\n        const diff = idx[key] - prevIdx[key] + 1;\n        this.idx[key] -= diff;\n      }\n    } else {\n      for (const key in this.idx) {\n        const diff = idx[key] - prevIdx[key];\n        this.idx[key] -= diff;\n      }\n    }\n\n    this.update();\n  }\n\n  undo(prevIdx) {\n    this.idx = prevIdx;\n    this.update();\n  }\n\n  addBuffer() {\n    const geometry = new THREE.BufferGeometry();\n\n    const vertices = new Float32Array(this.maxBufferSize * 3);\n    const normals = new Float32Array(this.maxBufferSize * 3);\n    const colors = new Float32Array(this.maxBufferSize * 3);\n\n    const mesh = new THREE.Mesh(geometry, this.material);\n\n    mesh.drawMode = this.primitiveMode;\n\n    mesh.frustumCulled = false;\n    mesh.vertices = vertices;\n\n    const object3D = new THREE.Object3D();\n    this.drawing.add(object3D);\n    object3D.add(mesh);\n\n    geometry.setDrawRange(0, 0);\n    geometry.addAttribute(\"position\", new THREE.BufferAttribute(vertices, 3).setDynamic(true));\n    geometry.addAttribute(\"normal\", new THREE.BufferAttribute(normals, 3).setDynamic(true));\n    geometry.addAttribute(\"color\", new THREE.BufferAttribute(colors, 3).setDynamic(true));\n\n    this.previous = null;\n    if (this.geometries.length > 0) {\n      this.previous = this.current;\n    }\n\n    this.idx = {\n      position: 0,\n      normal: 0,\n      color: 0\n    };\n\n    this.geometries.push(geometry);\n    this.current = geometry;\n  }\n\n  addColor(r, g, b) {\n    this.current.attributes.color.setXYZ(this.idx.color++, r, g, b);\n  }\n\n  addNormal(x, y, z) {\n    this.current.attributes.normal.setXYZ(this.idx.normal++, x, y, z);\n  }\n\n  addVertex(x, y, z) {\n    const buffer = this.current.attributes.position;\n    if (this.idx.position === buffer.count) {\n      console.error(\"maxBufferSize limit exceeded\");\n    }\n    buffer.setXYZ(this.idx.position++, x, y, z);\n  }\n\n  update() {\n    this.current.setDrawRange(0, this.idx.position);\n\n    this.current.attributes.color.needsUpdate = true;\n    this.current.attributes.normal.needsUpdate = true;\n    this.current.attributes.position.needsUpdate = true;\n  }\n}\n","import SharedBufferGeometry from \"./sharedbuffergeometry\";\n\nexport default class SharedBufferGeometryManager {\n  constructor() {\n    this.sharedBuffers = {};\n  }\n\n  addSharedBuffer(name, material, primitiveMode, maxBufferSize) {\n    this.sharedBuffers[name] = new SharedBufferGeometry(material, primitiveMode, maxBufferSize);\n  }\n\n  getSharedBuffer(name) {\n    return this.sharedBuffers[name];\n  }\n}\n","/* global THREE */\n/**\n * Networked Drawing\n * Creates procedurally generated 'lines' (or tubes) that are networked.\n * @namespace drawing\n * @component networked-drawing\n */\n\nimport SharedBufferGeometryManager from \"../../utils/sharedbuffergeometrymanager\";\nimport MobileStandardMaterial from \"../../materials/MobileStandardMaterial\";\n\nconst MSG_CONFIRM_CONNECT = 0;\nconst MSG_BUFFER_DATA = 1;\nconst MSG_BUFFER_DATA_FULL = 2;\n\nfunction copyData(fromArray, toArray, fromIndex, toIndex) {\n  let i = fromIndex - 1;\n  let j = -1;\n  while (i + 1 <= toIndex) {\n    toArray[++j] = fromArray[++i];\n  }\n}\n\nAFRAME.registerComponent(\"networked-drawing\", {\n  schema: {\n    segments: { default: 8 }, //the number of \"sides\" the procedural tube should have\n    defaultRadius: { default: 0.01 }, //the radius of the procedural tube\n    maxDrawTimeout: { default: 600000 }, //the maximum time a drawn line will live\n    maxLines: { default: 50 }, //how many lines can persist before lines older than minDrawTime are removed\n    maxPointsPerLine: { default: 250 } //the max number of points a single line can have\n  },\n\n  init() {\n    this._receiveData = this._receiveData.bind(this);\n\n    this.networkBuffer = [];\n\n    this.sendNetworkBufferQueue = [];\n\n    this.drawStarted = false;\n    this.lineStarted = false;\n    this.remoteLineStarted = false;\n\n    this.receivedBufferParts = 0;\n    this.bufferIndex = 0;\n    this.connectedToOwner = false;\n    this.networkBufferInitialized = false;\n\n    const options = {\n      vertexColors: THREE.VertexColors\n    };\n\n    this.color = new THREE.Color();\n    this.radius = this.data.defaultRadius;\n    this.segments = this.data.segments;\n\n    let material = new THREE.MeshStandardMaterial(options);\n    if (window.APP && window.APP.quality === \"low\") {\n      material = MobileStandardMaterial.fromStandardMaterial(material);\n    }\n\n    this.sharedBufferGeometryManager = new SharedBufferGeometryManager();\n    // NOTE: 20 is approximate for how many floats per point are added.\n    // maxLines + 1 because a line can be currently drawing while at maxLines.\n    // Multiply by 1/3 (0.333) because 3 floats per vertex (x, y, z).\n    const maxBufferSize = Math.round(this.data.maxPointsPerLine * 20 * (this.data.maxLines + 1) * 0.333);\n    this.sharedBufferGeometryManager.addSharedBuffer(0, material, THREE.TriangleStripDrawMode, maxBufferSize);\n\n    this.lastPoint = new THREE.Vector3();\n\n    this.lastSegments = [];\n    this.currentSegments = [];\n    for (let x = 0; x < this.segments; x++) {\n      this.lastSegments[x] = {\n        position: new THREE.Vector3(),\n        normal: new THREE.Vector3()\n      };\n      this.currentSegments[x] = {\n        position: new THREE.Vector3(),\n        normal: new THREE.Vector3()\n      };\n    }\n\n    this.sharedBuffer = this.sharedBufferGeometryManager.getSharedBuffer(0);\n    this.drawing = this.sharedBuffer.drawing;\n    const sceneEl = document.querySelector(\"a-scene\");\n    this.scene = sceneEl.object3D;\n    this.scene.add(this.drawing);\n\n    const environmentMapComponent = this.el.sceneEl.components[\"environment-map\"];\n    if (environmentMapComponent) {\n      environmentMapComponent.applyEnvironmentMap(this.drawing);\n    }\n\n    this.prevIdx = Object.assign({}, this.sharedBuffer.idx);\n    this.idx = Object.assign({}, this.sharedBuffer.idx);\n    this.vertexCount = 0; //number of vertices added for current line (used for line deletion).\n    this.networkBufferCount = 0; //number of items added to networkBuffer for current line (used for line deletion).\n    this.currentPointCount = 0; //number of points added for current line (used for maxPointsPerLine).\n    this.invalidPointRead = false; //flag flipped if we read a bad point anywhere during this line\n    this.lastReadPointCount = 0; //last read point count read off of the network, used for sanity checking\n    this.networkBufferHistory = []; //tracks vertexCount and networkBufferCount so that lines can be deleted.\n\n    NAF.connection.onConnect(() => {\n      NAF.utils.getNetworkedEntity(this.el).then(networkedEl => {\n        this.networkedEl = networkedEl;\n        this.networkId = NAF.utils.getNetworkId(this.networkedEl);\n        this.drawingId = \"drawing-\" + this.networkId;\n        NAF.connection.subscribeToDataChannel(this.drawingId, this._receiveData);\n      });\n    });\n  },\n\n  remove() {\n    NAF.connection.unsubscribeToDataChannel(this.drawingId, this._receiveData);\n\n    this.scene.remove(this.drawing);\n  },\n\n  tick(t) {\n    const connected = NAF.connection.isConnected() && this.networkedEl;\n    const isMine = connected && NAF.utils.isMine(this.networkedEl);\n\n    if (!this.connectedToOwner && connected) {\n      const owner = NAF.utils.getNetworkOwner(this.networkedEl);\n      if (!isMine && NAF.connection.hasActiveDataChannel(owner)) {\n        NAF.connection.sendDataGuaranteed(owner, this.drawingId, {\n          type: MSG_CONFIRM_CONNECT,\n          clientId: NAF.clientId\n        });\n        this.connectedToOwner = true;\n      }\n    }\n\n    if (this.networkBuffer.length > 0 && connected) {\n      if (!isMine) {\n        this._drawFromNetwork();\n      } else if (this.bufferIndex < this.networkBuffer.length) {\n        this._broadcastDrawing();\n      }\n    }\n\n    //TODO: handle possibility that a clientId gets stuck in sendNetworkBufferQueue\n    //if that client disconnects before this executes and an activeDataChannel is opened.\n    if (isMine && this.sendNetworkBufferQueue.length > 0) {\n      const connected = [];\n      for (let i = 0; i < this.sendNetworkBufferQueue.length; i++) {\n        if (NAF.connection.hasActiveDataChannel(this.sendNetworkBufferQueue[i])) {\n          connected.push(this.sendNetworkBufferQueue[i]);\n        }\n      }\n      for (let j = 0; j < connected.length; j++) {\n        const pos = this.sendNetworkBufferQueue.indexOf(connected[j]);\n        this._sendNetworkBuffer(connected[j]);\n        this.sendNetworkBufferQueue.splice(pos, 1);\n      }\n    }\n\n    this._deleteExpiredLines(t);\n  },\n\n  _broadcastDrawing: (() => {\n    const copyArray = [];\n    return function() {\n      copyArray.length = 0;\n      copyData(this.networkBuffer, copyArray, this.bufferIndex, this.networkBuffer.length - 1);\n\n      //remove undo's from networkBuffer after they've been sent so that\n      //newly joining clients don't get them\n      let index = -1;\n      while ((index = this.networkBuffer.indexOf(\"-\")) != -1) {\n        this.networkBuffer.splice(index, 1);\n      }\n      this.bufferIndex = this.networkBuffer.length;\n      NAF.connection.broadcastDataGuaranteed(this.drawingId, { type: MSG_BUFFER_DATA, buffer: copyArray });\n    };\n  })(),\n\n  _drawFromNetwork: (() => {\n    const position = new THREE.Vector3();\n    const direction = new THREE.Vector3();\n    const normal = new THREE.Vector3();\n    return function() {\n      let head = this.networkBuffer[0];\n      if (head === \"-\") {\n        this._undoDraw();\n        this.networkBuffer.shift();\n        head = this.networkBuffer[0];\n      }\n      let didWork = false;\n      while (head != null && this.networkBuffer.length >= 11) {\n        const pointCount = this.networkBuffer[0];\n\n        // This is a sanity check against the sequence number to help uncover remaining bugs.\n        // If the point is out-of-order, report the error and stop drawing this line.\n        if (pointCount !== this.lastReadPointCount + 1) {\n          this.invalidPointRead = true;\n\n          console.error(\n            `Draw networking error: ID ${this.drawingId} expected point ${this.lastReadPointCount +\n              1} but received ${pointCount}`\n          );\n        }\n\n        this.lastReadPointCount = pointCount;\n        position.set(this.networkBuffer[1], this.networkBuffer[2], this.networkBuffer[3]);\n        direction.set(this.networkBuffer[4], this.networkBuffer[5], this.networkBuffer[6]);\n        this.radius = Math.round(direction.length() * 1000) / 1000; //radius is encoded as length of direction vector\n        direction.normalize();\n        normal.set(this.networkBuffer[7], this.networkBuffer[8], this.networkBuffer[9]);\n        this.color.setHex(Math.round(normal.length()) - 1); //color is encoded as length of normal vector\n        normal.normalize();\n\n        this.networkBuffer.splice(0, 10);\n\n        if (!this.remoteLineStarted) {\n          this.startDraw(position, direction, normal);\n          this.remoteLineStarted = true;\n        }\n\n        if (this.networkBuffer[0] === null) {\n          if (!this.invalidPointRead) {\n            this._endDraw(position, direction, normal);\n          }\n\n          this.remoteLineStarted = false;\n          this.networkBuffer.shift();\n          this.lastReadPointCount = 0;\n          this.invalidPointRead = false;\n        } else {\n          if (!this.invalidPointRead) {\n            this._draw(position, direction, normal);\n            didWork = true;\n          }\n        }\n      }\n      if (didWork) this._updateBuffer();\n    };\n  })(),\n\n  _deleteExpiredLines(time) {\n    const length = this.networkBufferHistory.length;\n    if (length > 0) {\n      const drawTime = this.networkBufferHistory[0].time;\n      if (length > this.data.maxLines || drawTime + this.data.maxDrawTimeout <= time) {\n        const datum = this.networkBufferHistory[0];\n        if (length > 1) {\n          datum.idxLength += 2 - (this.segments % 2); //account for extra verts added for degenerate triangles\n          this.networkBufferHistory[1].idxLength -= 2 - (this.segments % 2);\n        }\n        this.idx.position = datum.idxLength;\n        this.idx.uv = datum.idxLength;\n        this.idx.normal = datum.idxLength;\n        this.idx.color = datum.idxLength;\n        this.sharedBuffer.remove(this.prevIdx, this.idx);\n        this.networkBufferHistory.shift();\n        if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n          this.networkBuffer.splice(0, datum.networkBufferCount);\n          this.bufferIndex -= datum.networkBufferCount;\n        }\n      }\n    }\n  },\n\n  _sendNetworkBuffer: (() => {\n    const copyArray = [];\n    //This number needs to be approx. < ~6000 based on napkin math\n    //see: https://github.com/webrtc/adapter/blob/682e0f2439e139da6c0c406370eae820637b8sc1a/src/js/common_shim.js#L157\n    const chunkAmount = 3000;\n    return function(clientId) {\n      if (NAF.utils.isMine(this.networkedEl)) {\n        if (this.networkBuffer.length <= chunkAmount) {\n          NAF.connection.sendDataGuaranteed(clientId, this.drawingId, {\n            type: MSG_BUFFER_DATA_FULL,\n            parts: 1,\n            buffer: this.networkBuffer\n          });\n        } else {\n          let start = 0;\n          let end = 0;\n          while (end < this.networkBuffer.length) {\n            end = Math.min(end + chunkAmount, this.networkBuffer.length);\n            copyArray.length = 0;\n            copyData(this.networkBuffer, copyArray, start, end - 1);\n            start = end;\n            NAF.connection.sendDataGuaranteed(clientId, this.drawingId, {\n              type: MSG_BUFFER_DATA_FULL,\n              parts: Math.ceil(this.networkBuffer.length / chunkAmount),\n              buffer: copyArray\n            });\n          }\n        }\n      }\n    };\n  })(),\n\n  _receiveData(_, dataType, data) {\n    switch (data.type) {\n      case MSG_CONFIRM_CONNECT:\n        this.sendNetworkBufferQueue.push(data.clientId);\n        break;\n      case MSG_BUFFER_DATA:\n        if (this.networkBufferInitialized) {\n          this.networkBuffer.push.apply(this.networkBuffer, data.buffer);\n        }\n        break;\n      case MSG_BUFFER_DATA_FULL:\n        this.networkBuffer.push.apply(this.networkBuffer, data.buffer);\n        if (++this.receivedBufferParts >= data.parts) {\n          this.networkBufferInitialized = true;\n        }\n        break;\n    }\n  },\n\n  getLastPoint() {\n    return this.lastPoint;\n  },\n\n  startDraw(position, direction, normal, color, radius) {\n    if (!NAF.connection.isConnected()) {\n      return;\n    }\n\n    this.drawStarted = true;\n\n    if (color) {\n      this.color.set(color);\n    }\n    if (radius) this.radius = radius;\n\n    this.lastPoint.copy(position);\n    this._addToNetworkBuffer(position, direction, normal);\n  },\n\n  draw(position, direction, normal, color, radius) {\n    if (!NAF.connection.isConnected() || !this.drawStarted) {\n      return;\n    }\n\n    if (color && color != \"#\" + this.color.getHexString().toUpperCase()) {\n      this.color.set(color);\n    }\n    if (radius) this.radius = radius;\n\n    this._addToNetworkBuffer(position, direction, normal);\n    this._draw(position, direction, normal);\n\n    this._updateBuffer();\n  },\n\n  _draw: (() => {\n    const capNormal = new THREE.Vector3();\n    return function(position, direction, normal, radiusMultiplier = 1.0) {\n      if (!this.lineStarted) {\n        this._generateSegments(this.lastSegments, position, direction, normal, this.radius * radiusMultiplier);\n\n        if (this.networkBufferHistory.length === 0) {\n          //start with CW faceculling order\n          this._addDegenerateTriangle();\n        } else {\n          //only do the following if the sharedBuffer is not empty\n          this._restartPrimitive();\n          this._addDegenerateTriangle();\n          if (this.segments % 2 === 0) {\n            //flip faceculling order if even numbered segments\n            this._addDegenerateTriangle();\n          }\n        }\n\n        //get normal for tip of cap\n        capNormal.copy(direction).negate();\n        //get normals for rim of cap\n        for (let i = 0; i < this.segments; i++) {\n          this.lastSegments[i].normal.add(capNormal).multiplyScalar(0.5);\n        }\n\n        this._drawCap(this.lastPoint, this.lastSegments, capNormal);\n        if (this.segments % 2 !== 0) {\n          //flip faceculling order if odd numbered segments\n          this._addDegenerateTriangle();\n        }\n\n        this.lineStarted = true;\n      } else {\n        this._generateSegments(this.currentSegments, position, direction, normal, this.radius * radiusMultiplier);\n        this._drawCylinder();\n\n        if (this.currentPointCount > this.data.maxPointsPerLine) {\n          this._drawEndCap(position, direction);\n          this._endLine();\n        }\n      }\n      this.lastPoint.copy(position);\n    };\n  })(),\n\n  undoDraw() {\n    if (!NAF.connection.isConnected() || this.drawStarted) {\n      return;\n    }\n    this._undoDraw();\n    this._pushToNetworkBuffer(\"-\");\n  },\n\n  _undoDraw() {\n    const length = this.networkBufferHistory.length;\n    if (length > 0) {\n      const datum = this.networkBufferHistory.pop();\n      this.idx.position = 0;\n      this.idx.uv = 0;\n      this.idx.normal = 0;\n      this.idx.color = 0;\n      if (length > 1) {\n        datum.idxLength += 1 - (this.segments % 2); //account for extra verts added for degenerate triangles\n        this.idx.position = this.sharedBuffer.idx.position - datum.idxLength;\n        this.idx.uv = this.sharedBuffer.idx.uv - datum.idxLength;\n        this.idx.normal = this.sharedBuffer.idx.normal - datum.idxLength;\n        this.idx.color = this.sharedBuffer.idx.color - datum.idxLength;\n      }\n      this.sharedBuffer.remove(this.idx, this.sharedBuffer.idx);\n      if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n        this.networkBuffer.splice(this.networkBuffer.length - datum.networkBufferCount, datum.networkBufferCount);\n        this.bufferIndex -= datum.networkBufferCount;\n      }\n    }\n  },\n\n  endDraw(position, direction, normal) {\n    this._endDraw(position, direction, normal);\n    this._updateBuffer();\n  },\n\n  _endDraw(position, direction, normal) {\n    if (!this.lineStarted && this.drawStarted) {\n      this._drawPoint(position);\n    } else if (this.lineStarted && this.drawStarted) {\n      this._addToNetworkBuffer(position, direction, normal);\n      this._draw(position, direction, normal);\n      this._drawEndCap(position, direction);\n    }\n    this._endLine();\n  },\n\n  _drawEndCap: (() => {\n    const projectedDirection = new THREE.Vector3();\n    const projectedPoint = new THREE.Vector3();\n    return function(position, direction) {\n      if (this.lineStarted && this.drawStarted) {\n        projectedDirection.copy(direction).multiplyScalar(this.radius);\n        projectedPoint.copy(position).add(projectedDirection);\n        this._addDegenerateTriangle(); //flip faceculling order before drawing end-cap\n        this._drawCap(projectedPoint, this.lastSegments, direction);\n      }\n    };\n  })(),\n\n  _endLine() {\n    if (!this.drawStarted) return;\n\n    if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) this._pushToNetworkBuffer(null);\n\n    const datum = {\n      networkBufferCount: this.networkBufferCount,\n      idxLength: this.vertexCount - 1,\n      time: this.el.sceneEl.clock.elapsedTime * 1000\n    };\n    this.networkBufferHistory.push(datum);\n    this.vertexCount = 0;\n    this.networkBufferCount = 0;\n    this.currentPointCount = 0;\n    this.lineStarted = false;\n    this.drawStarted = false;\n  },\n\n  _addToNetworkBuffer: (() => {\n    const copyDirection = new THREE.Vector3();\n    const copyNormal = new THREE.Vector3();\n    return function(position, direction, normal) {\n      if (this.networkedEl && NAF.utils.isMine(this.networkedEl)) {\n        ++this.currentPointCount;\n        this._pushToNetworkBuffer(this.currentPointCount);\n        this._pushToNetworkBuffer(position.x);\n        this._pushToNetworkBuffer(position.y);\n        this._pushToNetworkBuffer(position.z);\n        copyDirection.copy(direction);\n        copyDirection.setLength(this.radius); //encode radius as length of direction vector\n        this._pushToNetworkBuffer(copyDirection.x);\n        this._pushToNetworkBuffer(copyDirection.y);\n        this._pushToNetworkBuffer(copyDirection.z);\n        copyNormal.copy(normal);\n        copyNormal.setLength(this.color.getHex() + 1); //encode color as length, add one in case color is black\n        this._pushToNetworkBuffer(copyNormal.x);\n        this._pushToNetworkBuffer(copyNormal.y);\n        this._pushToNetworkBuffer(copyNormal.z);\n      }\n    };\n  })(),\n\n  _pushToNetworkBuffer(val) {\n    //don't increment networkBufferCount if undo, because the undo character\n    //will be removed in tick() on the next frame\n    if (val !== \"-\") {\n      ++this.networkBufferCount;\n    }\n    this.networkBuffer.push(val);\n  },\n\n  //draw a cylinder from last to current segments\n  _drawCylinder() {\n    //average the normals with the normals from the lastSegment\n    //not a perfect normal calculation, but works well enough\n    for (let i = 0; i < this.segments; i++) {\n      this.currentSegments[i].normal.add(this.lastSegments[i].normal).multiplyScalar(0.5);\n    }\n\n    for (let i = 0; i != this.segments + 1; i++) {\n      this._addVertex(this.lastSegments[i % this.segments]);\n      this._addVertex(this.currentSegments[i % this.segments]);\n    }\n\n    for (let i = 0; i < this.segments; i++) {\n      this.lastSegments[i].position.copy(this.currentSegments[i].position);\n      this.lastSegments[i].normal.copy(this.currentSegments[i].normal);\n    }\n  },\n\n  //draw a standalone point in space\n  _drawPoint: (() => {\n    const up = new THREE.Vector3(0, 1, 0);\n    const down = new THREE.Vector3(0, -1, 0);\n    const left = new THREE.Vector3(1, 0, 0);\n    const projectedDirection = new THREE.Vector3();\n    const projectedPoint = new THREE.Vector3();\n    return function(position) {\n      projectedDirection.copy(up).multiplyScalar(this.radius * 0.75);\n      projectedPoint.copy(position).add(projectedDirection);\n      this.lastPoint.copy(projectedPoint);\n\n      projectedDirection.copy(up).multiplyScalar(this.radius * 0.5);\n      projectedPoint.copy(position).add(projectedDirection);\n      this._draw(projectedPoint, down, left, 0.75);\n\n      this._draw(position, down, left);\n\n      projectedDirection.copy(down).multiplyScalar(this.radius * 0.5);\n      projectedPoint.copy(position).add(projectedDirection);\n      this._draw(projectedPoint, down, left, 0.75);\n\n      projectedDirection.copy(down).multiplyScalar(this.radius * 0.75);\n      projectedPoint.copy(position).add(projectedDirection);\n\n      this._addDegenerateTriangle(); //discarded\n      this._drawCap(projectedPoint, this.lastSegments, down);\n    };\n  })(),\n\n  //draw a cap to start/end a line\n  _drawCap(point, segments, normal) {\n    let segmentIndex = 0;\n    for (let i = 0; i < this.segments * 2 - (this.segments % 2); i++) {\n      if ((i - 2) % 4 === 0) {\n        this._addVertex({ position: point, normal: normal });\n      } else {\n        this._addVertex(segments[segmentIndex % this.segments]);\n        if ((i + 1) % 5 !== 0) {\n          ++segmentIndex;\n        }\n      }\n    }\n  },\n\n  _restartPrimitive() {\n    this.sharedBuffer.restartPrimitive();\n    ++this.vertexCount;\n  },\n\n  _updateBuffer() {\n    this.sharedBuffer.update();\n  },\n\n  _addVertex(segment) {\n    const point = segment.position;\n    const normal = segment.normal;\n    this.sharedBuffer.addVertex(point.x, point.y, point.z);\n    this.sharedBuffer.addColor(this.color.r, this.color.g, this.color.b);\n\n    if (normal) {\n      this.sharedBuffer.addNormal(normal.x, normal.y, normal.z);\n    } else {\n      ++this.sharedBuffer.idx.normal;\n    }\n\n    ++this.sharedBuffer.idx.uv;\n    ++this.vertexCount;\n  },\n\n  _addDegenerateTriangle() {\n    this._addVertex(this.lastSegments[0]);\n  },\n\n  //calculate the segments for a given point\n  _generateSegments(segmentsList, point, forward, up, radius) {\n    const angleIncrement = (Math.PI * 2) / this.segments;\n    for (let i = 0; i < this.segments; i++) {\n      const segment = segmentsList[i].position;\n      this._rotatePointAroundAxis(segment, point, forward, up, angleIncrement * i, radius);\n      segmentsList[i].normal.subVectors(segment, point).normalize();\n    }\n  },\n\n  _rotatePointAroundAxis: (() => {\n    const calculatedDirection = new THREE.Vector3();\n    return function(out, point, axis, up, angle, radius) {\n      calculatedDirection.copy(up);\n      calculatedDirection.applyAxisAngle(axis, angle);\n      out.copy(point).add(calculatedDirection.normalize().multiplyScalar(radius));\n    };\n  })()\n});\n","function registerNetworkSchemas() {\n  const vectorRequiresUpdate = epsilon => {\n    return () => {\n      let prev = null;\n\n      return curr => {\n        if (prev === null) {\n          prev = new THREE.Vector3(curr.x, curr.y, curr.z);\n          return true;\n        } else if (!NAF.utils.almostEqualVec3(prev, curr, epsilon)) {\n          prev.copy(curr);\n          return true;\n        }\n\n        return false;\n      };\n    };\n  };\n\n  // Note: networked template ids are semantically important. We use the template suffix as a filter\n  // for allowing and authorizing messages in reticulum. See https://github.com/mozilla/reticulum/pull/195\n\n  NAF.schemas.add({\n    template: \"#remote-avatar\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      \"scale\",\n      \"player-info\",\n      \"networked-avatar\",\n      {\n        selector: \".camera\",\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        selector: \".camera\",\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        selector: \".left-controller\",\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        selector: \".left-controller\",\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        selector: \".left-controller\",\n        component: \"visible\"\n      },\n      {\n        selector: \".right-controller\",\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        selector: \".right-controller\",\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      {\n        selector: \".right-controller\",\n        component: \"visible\"\n      }\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#interactable-media\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      \"scale\",\n      // TODO: Optimize checking mediaOptions with requiresNetworkUpdate.\n      \"media-loader\",\n      {\n        component: \"media-video\",\n        property: \"time\"\n      },\n      {\n        component: \"media-video\",\n        property: \"videoPaused\"\n      },\n      {\n        component: \"media-pager\",\n        property: \"index\"\n      },\n      \"pinnable\"\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#static-media\",\n    components: [\n      // TODO: Optimize checking mediaOptions with requiresNetworkUpdate.\n      \"media-loader\",\n      {\n        component: \"media-video\",\n        property: \"time\"\n      }\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#static-controlled-media\",\n    components: [\n      // TODO: Optimize checking mediaOptions with requiresNetworkUpdate.\n      \"media-loader\",\n      {\n        component: \"media-video\",\n        property: \"time\"\n      },\n      {\n        component: \"media-video\",\n        property: \"videoPaused\"\n      },\n      {\n        component: \"media-pager\",\n        property: \"index\"\n      }\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#interactable-drawing\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      \"scale\",\n      \"networked-drawing\"\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#interactable-camera\",\n    components: [\n      \"position\",\n      \"rotation\",\n      {\n        component: \"camera-tool\",\n        property: \"isSnapping\"\n      },\n      {\n        component: \"camera-tool\",\n        property: \"isRecording\"\n      },\n      {\n        component: \"camera-tool\",\n        property: \"label\"\n      }\n    ]\n  });\n\n  NAF.schemas.add({\n    template: \"#interactable-pen\",\n    components: [\n      {\n        component: \"position\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.001)\n      },\n      {\n        component: \"rotation\",\n        requiresNetworkUpdate: vectorRequiresUpdate(0.5)\n      },\n      \"scale\",\n      \"media-loader\",\n      {\n        selector: \"#pen\",\n        component: \"pen\",\n        property: \"radius\"\n      },\n      {\n        selector: \"#pen\",\n        component: \"pen\",\n        property: \"color\"\n      }\n    ]\n  });\n}\n\nexport default registerNetworkSchemas;\n","import \"@babel/polyfill\";\nimport \"./utils/debug-log\";\n\nconsole.log(`Hubs version: ${process.env.BUILD_VERSION || \"?\"}`);\n\nimport \"./assets/stylesheets/hub.scss\";\n\nimport \"aframe\";\nimport \"./utils/logging\";\nimport { patchWebGLRenderingContext } from \"./utils/webgl\";\npatchWebGLRenderingContext();\n\nimport \"three/examples/js/loaders/GLTFLoader\";\nimport \"networked-aframe/src/index\";\nimport \"naf-janus-adapter\";\nimport \"aframe-rounded\";\nimport \"webrtc-adapter\";\nimport \"aframe-slice9-component\";\nimport \"./utils/audio-context-fix\";\nimport \"./utils/threejs-positional-audio-updatematrixworld\";\nimport \"./utils/threejs-world-update\";\nimport patchThreeAllocations from \"./utils/threejs-allocation-patches\";\nimport { detectOS, detect } from \"detect-browser\";\nimport {\n  getReticulumFetchUrl,\n  getReticulumMeta,\n  invalidateReticulumMeta,\n  migrateChannelToSocket\n} from \"./utils/phoenix-utils\";\n\nimport nextTick from \"./utils/next-tick\";\nimport { addAnimationComponents } from \"./utils/animation\";\nimport Cookies from \"js-cookie\";\n\nimport \"./components/scene-components\";\nimport \"./components/mute-mic\";\nimport \"./components/toggle-flying\";\nimport \"./components/bone-mute-state-indicator\";\nimport \"./components/bone-visibility\";\nimport \"./components/in-world-hud\";\nimport \"./components/virtual-gamepad-controls\";\nimport \"./components/ik-controller\";\nimport \"./components/hand-controls2\";\nimport \"./components/character-controller\";\nimport \"./components/hoverable-visuals\";\nimport \"./components/hover-visuals\";\nimport \"./components/offset-relative-to\";\nimport \"./components/player-info\";\nimport \"./components/debug\";\nimport \"./components/hand-poses\";\nimport \"./components/hud-controller\";\nimport \"./components/freeze-controller\";\nimport \"./components/icon-button\";\nimport \"./components/text-button\";\nimport \"./components/block-button\";\nimport \"./components/mute-button\";\nimport \"./components/kick-button\";\nimport \"./components/close-vr-notice-button\";\nimport \"./components/leave-room-button\";\nimport \"./components/visible-if-permitted\";\nimport \"./components/visibility-on-content-type\";\nimport \"./components/hide-when-pinned-and-forbidden\";\nimport \"./components/visibility-while-frozen\";\nimport \"./components/stats-plus\";\nimport \"./components/networked-avatar\";\nimport \"./components/media-views\";\nimport \"./components/avatar-volume-controls\";\nimport \"./components/pinch-to-move\";\nimport \"./components/pitch-yaw-rotator\";\nimport \"./components/position-at-box-shape-border\";\nimport \"./components/pinnable\";\nimport \"./components/pin-networked-object-button\";\nimport \"./components/drop-object-button\";\nimport \"./components/remove-networked-object-button\";\nimport \"./components/camera-focus-button\";\nimport \"./components/unmute-video-button\";\nimport \"./components/destroy-at-extreme-distances\";\nimport \"./components/visible-to-owner\";\nimport \"./components/camera-tool\";\nimport \"./components/emit-state-change\";\nimport \"./components/action-to-event\";\nimport \"./components/action-to-remove\";\nimport \"./components/emit-scene-event-on-remove\";\nimport \"./components/follow-in-fov\";\nimport \"./components/matrix-auto-update\";\nimport \"./components/clone-media-button\";\nimport \"./components/open-media-button\";\nimport \"./components/tweet-media-button\";\nimport \"./components/transform-object-button\";\nimport \"./components/hover-menu\";\nimport \"./components/disable-frustum-culling\";\nimport \"./components/teleporter\";\nimport \"./components/set-active-camera\";\nimport \"./components/track-pose\";\nimport \"./components/replay\";\nimport \"./components/visibility-by-path\";\nimport \"./components/tags\";\nimport \"./components/hubs-text\";\nimport \"./components/billboard\";\nimport { sets as userinputSets } from \"./systems/userinput/sets\";\n\nimport ReactDOM from \"react-dom\";\nimport React from \"react\";\nimport { Router, Route } from \"react-router-dom\";\nimport { createBrowserHistory } from \"history\";\nimport { pushHistoryState } from \"./utils/history\";\nimport UIRoot from \"./react-components/ui-root\";\nimport AuthChannel from \"./utils/auth-channel\";\nimport HubChannel from \"./utils/hub-channel\";\nimport LinkChannel from \"./utils/link-channel\";\nimport { connectToReticulum } from \"./utils/phoenix-utils\";\nimport { disableiOSZoom } from \"./utils/disable-ios-zoom\";\nimport { proxiedUrlFor } from \"./utils/media-url-utils\";\nimport { traverseMeshesAndAddShapes } from \"./utils/physics-utils\";\nimport { handleExitTo2DInterstitial, exit2DInterstitialAndEnterVR } from \"./utils/vr-interstitial\";\nimport { getAvatarSrc } from \"./utils/avatar-utils.js\";\nimport MessageDispatch from \"./message-dispatch\";\nimport SceneEntryManager from \"./scene-entry-manager\";\nimport Subscriptions from \"./subscriptions\";\nimport { createInWorldLogMessage } from \"./react-components/chat-message\";\n\nimport \"./systems/nav\";\nimport \"./systems/frame-scheduler\";\nimport \"./systems/personal-space-bubble\";\nimport \"./systems/app-mode\";\nimport \"./systems/permissions\";\nimport \"./systems/exit-on-blur\";\nimport \"./systems/camera-tools\";\nimport \"./systems/userinput/userinput\";\nimport \"./systems/userinput/userinput-debug\";\nimport \"./systems/ui-hotkeys\";\nimport \"./systems/tips\";\nimport \"./systems/interactions\";\nimport \"./systems/hubs-systems\";\nimport \"./systems/capture-system\";\nimport { SOUND_CHAT_MESSAGE } from \"./systems/sound-effects-system\";\n\nimport \"./gltf-component-mappings\";\n\nimport { App } from \"./App\";\n\nwindow.APP = new App();\nwindow.APP.RENDER_ORDER = {\n  HUD_BACKGROUND: 1,\n  HUD_ICONS: 2,\n  CURSOR: 3\n};\nconst store = window.APP.store;\nconst mediaSearchStore = window.APP.mediaSearchStore;\nconst OAUTH_FLOW_PERMS_TOKEN_KEY = \"ret-oauth-flow-perms-token\";\nconst NOISY_OCCUPANT_COUNT = 12; // Above this # of occupants, we stop posting join/leaves/renames\n\nconst qs = new URLSearchParams(location.search);\nconst isMobile = AFRAME.utils.device.isMobile();\nconst isMobileVR = AFRAME.utils.device.isMobileVR();\nconst isEmbed = window.self !== window.top;\nif (isEmbed && !qs.get(\"embed_token\")) {\n  // Should be covered by X-Frame-Options, but just in case.\n  throw new Error(\"no embed token\");\n}\n\nTHREE.Object3D.DefaultMatrixAutoUpdate = false;\nwindow.APP.quality = qs.get(\"quality\") || (isMobile || isMobileVR) ? \"low\" : \"high\";\n\nconst Ammo = require(\"ammo.js/builds/ammo.wasm.js\");\nconst AmmoWasm = require(\"ammo.js/builds/ammo.wasm.wasm\");\nwindow.Ammo = Ammo.bind(undefined, {\n  locateFile(path) {\n    if (path.endsWith(\".wasm\")) {\n      return AmmoWasm;\n    }\n    return path;\n  }\n});\nrequire(\"aframe-physics-system\");\n\nimport \"./systems/post-physics\";\n\nimport \"./components/owned-object-limiter\";\nimport \"./components/set-unowned-body-kinematic\";\nimport \"./components/scalable-when-grabbed\";\nimport \"./components/networked-counter\";\nimport \"./components/event-repeater\";\nimport \"./components/set-yxz-order\";\n\nimport \"./components/cursor-controller\";\n\nimport \"./components/nav-mesh-helper\";\n\nimport \"./components/tools/pen\";\nimport \"./components/tools/networked-drawing\";\nimport \"./components/tools/drawing-manager\";\n\nimport registerNetworkSchemas from \"./network-schemas\";\nimport registerTelemetry from \"./telemetry\";\nimport { warmSerializeElement } from \"./utils/serialize-element\";\n\nimport { getAvailableVREntryTypes, VR_DEVICE_AVAILABILITY } from \"./utils/vr-caps-detect.js\";\nimport detectConcurrentLoad from \"./utils/concurrent-load-detector.js\";\n\nimport qsTruthy from \"./utils/qs_truthy\";\n\nconst PHOENIX_RELIABLE_NAF = \"phx-reliable\";\nNAF.options.firstSyncSource = PHOENIX_RELIABLE_NAF;\nNAF.options.syncSource = PHOENIX_RELIABLE_NAF;\n\nconst isBotMode = qsTruthy(\"bot\");\nconst isTelemetryDisabled = qsTruthy(\"disable_telemetry\");\nconst isDebug = qsTruthy(\"debug\");\nconst loadingEnvironmentURL = proxiedUrlFor(\n  \"https://uploads-prod.reticulum.io/files/61d77151-7a74-40a6-b427-0c5a350c4502.glb\"\n);\n\nif (!isBotMode && !isTelemetryDisabled) {\n  registerTelemetry(\"/hub\", \"Room Landing Page\");\n}\n\ndisableiOSZoom();\ndetectConcurrentLoad();\n\nstore.init();\n\nfunction getPlatformUnsupportedReason() {\n  if (typeof RTCDataChannelEvent === \"undefined\") return \"no_data_channels\";\n  return null;\n}\n\nfunction setupLobbyCamera() {\n  const camera = document.querySelector(\"#player-camera\");\n  const previewCamera = document.querySelector(\"#environment-scene\").object3D.getObjectByName(\"scene-preview-camera\");\n\n  if (previewCamera) {\n    camera.object3D.position.copy(previewCamera.position);\n    camera.object3D.rotation.copy(previewCamera.rotation);\n    camera.object3D.rotation.reorder(\"YXZ\");\n  } else {\n    const cameraPos = camera.object3D.position;\n    camera.object3D.position.set(cameraPos.x, 2.5, cameraPos.z);\n  }\n\n  camera.object3D.matrixNeedsUpdate = true;\n\n  camera.setAttribute(\"scene-preview-camera\", \"positionOnly: true; duration: 60\");\n  camera.components[\"pitch-yaw-rotator\"].set(camera.object3D.rotation.x, camera.object3D.rotation.y);\n}\n\nlet uiProps = {};\n\n// Hub ID and slug are the basename\nlet routerBaseName = document.location.pathname\n  .split(\"/\")\n  .slice(0, 2)\n  .join(\"/\");\n\nif (document.location.pathname.includes(\"hub.html\")) {\n  routerBaseName = \"\";\n}\n\nconst history = createBrowserHistory({ basename: routerBaseName });\nwindow.APP.history = history;\n\nconst qsVREntryType = qs.get(\"vr_entry_type\");\n\nfunction mountUI(props = {}) {\n  const scene = document.querySelector(\"a-scene\");\n  const disableAutoExitOnConcurrentLoad = qsTruthy(\"allow_multi\");\n  const isCursorHoldingPen = scene && scene.systems.userinput.activeSets.includes(userinputSets.cursorHoldingPen);\n  const hasActiveCamera = scene && !!scene.systems[\"camera-tools\"].getMyCamera();\n  const forcedVREntryType = qsVREntryType;\n\n  ReactDOM.render(\n    <Router history={history}>\n      <Route\n        render={routeProps => (\n          <UIRoot\n            {...{\n              scene,\n              isBotMode,\n              disableAutoExitOnConcurrentLoad,\n              forcedVREntryType,\n              store,\n              mediaSearchStore,\n              isCursorHoldingPen,\n              hasActiveCamera,\n              ...props,\n              ...routeProps\n            }}\n          />\n        )}\n      />\n    </Router>,\n    document.getElementById(\"ui-root\")\n  );\n}\n\nfunction remountUI(props) {\n  uiProps = { ...uiProps, ...props };\n  mountUI(uiProps);\n}\n\nasync function updateUIForHub(hub) {\n  remountUI({\n    hubId: hub.hub_id,\n    hubName: hub.name,\n    hubMemberPermissions: hub.member_permissions,\n    hubScene: hub.scene,\n    hubEntryCode: hub.entry_code\n  });\n}\n\nasync function updateEnvironmentForHub(hub) {\n  let sceneUrl = 'https://www.dropbox.com/s/ayl3t33p2ymnxux/Axon%20Park_Cliffside.glb'\n  let isLegacyBundle; // Deprecated\n\n  const environmentScene = document.querySelector(\"#environment-scene\");\n  const sceneEl = document.querySelector(\"a-scene\");\n\n  if (hub.scene) {\n    isLegacyBundle = false;\n    sceneUrl = hub.scene.model_url;\n  } else if (hub.scene === null) {\n    // delisted/removed scene\n    sceneUrl = loadingEnvironmentURL;\n  } else {\n    const defaultSpaceTopic = hub.topics[0];\n    const glbAsset = defaultSpaceTopic.assets.find(a => a.asset_type === \"glb\");\n    const bundleAsset = defaultSpaceTopic.assets.find(a => a.asset_type === \"gltf_bundle\");\n    sceneUrl = (glbAsset || bundleAsset).src;\n    const hasExtension = /\\.gltf/i.test(sceneUrl) || /\\.glb/i.test(sceneUrl);\n    isLegacyBundle = !(glbAsset || hasExtension);\n  }\n\n  if (isLegacyBundle) {\n    // Deprecated\n    const res = await fetch(sceneUrl);\n    const data = await res.json();\n    const baseURL = new URL(THREE.LoaderUtils.extractUrlBase(sceneUrl), window.location.href);\n    sceneUrl = new URL(data.assets[0].src, baseURL).href;\n  } else {\n    sceneUrl = proxiedUrlFor(sceneUrl);\n  }\n\n  console.log(`Scene URL: ${sceneUrl}`);\n\n  let environmentEl = null;\n\n  if (environmentScene.childNodes.length === 0) {\n    const environmentEl = document.createElement(\"a-entity\");\n    environmentEl.setAttribute(\"gltf-model-plus\", { src: sceneUrl, useCache: false, inflate: true });\n\n    environmentScene.appendChild(environmentEl);\n\n    environmentEl.addEventListener(\n      \"model-loaded\",\n      () => {\n        // Show the canvas once the model has loaded\n        document.querySelector(\".a-canvas\").classList.remove(\"a-hidden\");\n\n        //TODO: check if the environment was made with spoke to determine if a shape should be added\n        traverseMeshesAndAddShapes(environmentEl);\n      },\n      { once: true }\n    );\n  } else {\n    // Change environment\n    environmentEl = environmentScene.childNodes[0];\n\n    // Clear the three.js image cache and load the loading environment before switching to the new one.\n    THREE.Cache.clear();\n\n    environmentEl.addEventListener(\n      \"model-loaded\",\n      () => {\n        environmentEl.addEventListener(\n          \"model-loaded\",\n          () => {\n            traverseMeshesAndAddShapes(environmentEl);\n\n            // We've already entered, so move to new spawn point once new environment is loaded\n            if (sceneEl.is(\"entered\")) {\n              document.querySelector(\"#player-rig\").components[\"spawn-controller\"].moveToSpawnPoint();\n            }\n          },\n          { once: true }\n        );\n\n        environmentEl.setAttribute(\"gltf-model-plus\", { src: sceneUrl });\n      },\n      { once: true }\n    );\n\n    environmentEl.setAttribute(\"gltf-model-plus\", { src: loadingEnvironmentURL });\n  }\n}\n\nasync function handleHubChannelJoined(entryManager, hubChannel, messageDispatch, data) {\n  const scene = document.querySelector(\"a-scene\");\n  const isRejoin = NAF.connection.isConnected();\n\n  if (isRejoin) {\n    // Slight hack, to ensure correct presence state we need to re-send the entry event\n    // on re-join. Ideally this would be updated into the channel socket state but this\n    // would require significant changes to the hub channel events and socket management.\n    if (scene.is(\"entered\")) {\n      hubChannel.sendEntryEvent();\n    }\n\n    // Send complete sync on phoenix re-join.\n    NAF.connection.entities.completeSync(null, true);\n    return;\n  }\n\n  // Turn off NAF for embeds as an optimization, so the user's browser isn't getting slammed\n  // with NAF traffic on load.\n  if (isEmbed) {\n    hubChannel.allowNAFTraffic(false);\n  }\n\n  const hub = data.hubs[0];\n\n  let embedToken = hub.embed_token;\n\n  if (!embedToken) {\n    const embedTokenEntry = store.state.embedTokens && store.state.embedTokens.find(t => t.hubId === hub.hub_id);\n\n    if (embedTokenEntry) {\n      embedToken = embedTokenEntry.embedToken;\n    }\n  }\n\n  console.log(`Janus host: ${hub.host}`);\n\n  remountUI({\n    onSendMessage: messageDispatch.dispatch,\n    onLoaded: () => store.executeOnLoadActions(scene),\n    onMediaSearchResultEntrySelected: entry => scene.emit(\"action_selected_media_result_entry\", entry),\n    onMediaSearchCancelled: entry => scene.emit(\"action_media_search_cancelled\", entry),\n    onAvatarSaved: entry => scene.emit(\"action_avatar_saved\", entry),\n    embedToken: embedToken\n  });\n\n  scene.addEventListener(\"action_selected_media_result_entry\", e => {\n    const entry = e.detail;\n    if (entry.type !== \"scene_listing\" && entry.type !== \"scene\") return;\n    if (!hubChannel.can(\"update_hub\")) return;\n\n    hubChannel.updateScene(entry.url);\n  });\n\n  // Handle request for user gesture\n  scene.addEventListener(\"2d-interstitial-gesture-required\", () => {\n    remountUI({\n      showInterstitialPrompt: true,\n      onInterstitialPromptClicked: () => {\n        scene.emit(\"2d-interstitial-gesture-complete\");\n        remountUI({ showInterstitialPrompt: false, onInterstitialPromptClicked: null });\n      }\n    });\n  });\n\n  const objectsScene = document.querySelector(\"#objects-scene\");\n  const objectsUrl = getReticulumFetchUrl(`/${hub.hub_id}/objects.gltf`);\n  const objectsEl = document.createElement(\"a-entity\");\n  objectsEl.setAttribute(\"gltf-model-plus\", { src: objectsUrl, useCache: false, inflate: true });\n\n  if (!isBotMode) {\n    objectsScene.appendChild(objectsEl);\n  }\n\n  // Wait for scene objects to load before connecting, so there is no race condition on network state.\n  const connectToScene = async () => {\n    scene.setAttribute(\"networked-scene\", {\n      room: hub.hub_id,\n      serverURL: `wss://${hub.host}`,\n      debug: !!isDebug\n    });\n\n    while (!scene.components[\"networked-scene\"] || !scene.components[\"networked-scene\"].data) await nextTick();\n\n    scene.addEventListener(\"adapter-ready\", ({ detail: adapter }) => {\n      let newHostPollInterval = null;\n\n      // When reconnecting, update the server URL if necessary\n      adapter.setReconnectionListeners(\n        () => {\n          if (newHostPollInterval) return;\n\n          newHostPollInterval = setInterval(async () => {\n            const currentServerURL = NAF.connection.adapter.serverUrl;\n            const newHubHost = await hubChannel.getHost();\n            const newServerURL = `wss://${newHubHost}`;\n\n            if (currentServerURL !== newServerURL) {\n              console.log(\"Connecting to new Janus server \" + newServerURL);\n              scene.setAttribute(\"networked-scene\", { serverURL: newServerURL });\n              adapter.serverUrl = newServerURL;\n            }\n          }, 1000);\n        },\n        () => {\n          clearInterval(newHostPollInterval);\n          newHostPollInterval = null;\n        },\n        null\n      );\n\n      const sendViaPhoenix = reliable => (clientId, dataType, data) => {\n        const payload = { dataType, data };\n\n        if (clientId) {\n          payload.clientId = clientId;\n        }\n\n        const isOpen = hubChannel.channel.socket.connectionState() === \"open\";\n\n        if (isOpen || reliable) {\n          if (isOpen) {\n            hubChannel.channel.push(\"naf\", payload);\n          } else {\n            // Memory is re-used, so make a copy\n            hubChannel.channel.push(\"naf\", AFRAME.utils.clone(payload));\n          }\n        }\n      };\n\n      adapter.reliableTransport = sendViaPhoenix(true);\n      adapter.unreliableTransport = sendViaPhoenix(false);\n    });\n\n    const loadEnvironmentAndConnect = () => {\n      updateEnvironmentForHub(hub);\n\n      scene.components[\"networked-scene\"]\n        .connect()\n        .then(() => scene.emit(\"didConnectToNetworkedScene\"))\n        .catch(connectError => {\n          // hacky until we get return codes\n          const isFull = connectError.error && connectError.error.msg.match(/\\bfull\\b/i);\n          console.error(connectError);\n          remountUI({ roomUnavailableReason: isFull ? \"full\" : \"connect_error\" });\n          entryManager.exitScene();\n\n          return;\n        });\n    };\n\n    updateUIForHub(hub);\n\n    if (!isEmbed) {\n      loadEnvironmentAndConnect();\n    } else {\n      remountUI({\n        onPreloadLoadClicked: () => {\n          hubChannel.allowNAFTraffic(true);\n          remountUI({ showPreload: false });\n          loadEnvironmentAndConnect();\n        }\n      });\n    }\n  };\n\n  if (!isBotMode) {\n    objectsEl.addEventListener(\"model-loaded\", async el => {\n      if (el.target !== objectsEl) return;\n      connectToScene();\n    });\n  } else {\n    connectToScene();\n  }\n}\n\nasync function runBotMode(scene, entryManager) {\n  const noop = () => {};\n  scene.renderer = { setAnimationLoop: noop, render: noop };\n\n  while (!NAF.connection.isConnected()) await nextTick();\n  entryManager.enterSceneWhenLoaded(new MediaStream(), false);\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", async () => {\n  const canvas = document.querySelector(\".a-canvas\");\n  canvas.classList.add(\"a-hidden\");\n\n  warmSerializeElement();\n\n  if (!window.WebAssembly) {\n    remountUI({ showWebAssemblyDialog: true });\n    return;\n  }\n\n  // If we are on iOS but we don't have the mediaDevices API, then we are likely in a Firefox or Chrome WebView,\n  // or a WebView preview used in apps like Twitter and Discord. So we show the dialog that tells users to open\n  // the room in the real Safari.\n  const detectedOS = detectOS(navigator.userAgent);\n  if (detectedOS === \"iOS\" && !navigator.mediaDevices) {\n    remountUI({ showSafariDialog: true });\n    return;\n  }\n\n  // HACK: On Safari for iOS & MacOS, if mic permission is not granted, subscriber webrtc negotiation fails.\n  // So we need to insist on microphone grants to continue.\n  const browser = detect();\n  if ([\"iOS\", \"Mac OS\"].includes(detectedOS) && [\"safari\", \"ios\"].includes(browser.name)) {\n    try {\n      await navigator.mediaDevices.getUserMedia({ audio: true });\n    } catch (e) {\n      remountUI({ showSafariMicDialog: true });\n      return;\n    }\n  }\n\n  const hubId = qs.get(\"hub_id\") || document.location.pathname.substring(1).split(\"/\")[0];\n  console.log(`Hub ID: ${hubId}`);\n\n  const subscriptions = new Subscriptions(hubId);\n\n  if (navigator.serviceWorker) {\n    try {\n      navigator.serviceWorker\n        .register(\"/hub.service.js\")\n        .then(() => {\n          navigator.serviceWorker.ready\n            .then(registration => subscriptions.setRegistration(registration))\n            .catch(() => subscriptions.setRegistrationFailed());\n        })\n        .catch(() => subscriptions.setRegistrationFailed());\n    } catch (e) {\n      subscriptions.setRegistrationFailed();\n    }\n  } else {\n    subscriptions.setRegistrationFailed();\n  }\n\n  const scene = document.querySelector(\"a-scene\");\n  scene.setAttribute(\"shadow\", { enabled: window.APP.quality !== \"low\" }); // Disable shadows on low quality\n\n  // Physics needs to be ready before spawning anything.\n  while (!scene.systems.physics.initialized) await nextTick();\n\n  const onSceneLoaded = () => {\n    const physicsSystem = scene.systems.physics;\n    physicsSystem.setDebug(isDebug || physicsSystem.data.debug);\n    patchThreeAllocations();\n  };\n\n  if (scene.hasLoaded) {\n    onSceneLoaded();\n  } else {\n    scene.addEventListener(\"loaded\", onSceneLoaded, { once: true });\n  }\n\n  // If the stored avatar doesn't have a valid src, reset to a legacy avatar.\n  const avatarSrc = await getAvatarSrc(store.state.profile.avatarId);\n  if (!avatarSrc) {\n    store.resetToRandomLegacyAvatar();\n  }\n\n  const authChannel = new AuthChannel(store);\n  const hubChannel = new HubChannel(store, hubId);\n  const availableVREntryTypes = await getAvailableVREntryTypes();\n  const entryManager = new SceneEntryManager(hubChannel, authChannel, availableVREntryTypes, history);\n  const performConditionalSignIn = async (predicate, action, messageId, onFailure) => {\n    if (predicate()) return action();\n\n    const signInContinueTextId = scene.is(\"vr-mode\") ? \"entry.return-to-vr\" : \"dialog.close\";\n\n    handleExitTo2DInterstitial(true, () => remountUI({ showSignInDialog: false }));\n\n    remountUI({\n      showSignInDialog: true,\n      signInMessageId: `sign-in.${messageId}`,\n      signInCompleteMessageId: `sign-in.${messageId}-complete`,\n      signInContinueTextId,\n      onContinueAfterSignIn: async () => {\n        remountUI({ showSignInDialog: false });\n        let actionError = null;\n        if (predicate()) {\n          try {\n            await action();\n          } catch (e) {\n            actionError = e;\n          }\n        } else {\n          actionError = new Error(\"Predicate failed post sign-in\");\n        }\n\n        if (actionError && onFailure) onFailure(actionError);\n        exit2DInterstitialAndEnterVR();\n      }\n    });\n  };\n\n  window.addEventListener(\"action_create_avatar\", () => {\n    performConditionalSignIn(\n      () => hubChannel.signedIn,\n      () => pushHistoryState(history, \"overlay\", \"avatar-editor\"),\n      \"create-avatar\"\n    );\n  });\n\n  scene.addEventListener(\"scene_media_selected\", e => {\n    const sceneInfo = e.detail;\n\n    performConditionalSignIn(\n      () => hubChannel.can(\"update_hub\"),\n      () => hubChannel.updateScene(sceneInfo),\n      \"change-scene\"\n    );\n  });\n\n  scene.addEventListener(\"action_media_tweet\", e => {\n    let isInModal = false;\n    let isInOAuth = false;\n\n    const exitOAuth = () => {\n      isInOAuth = false;\n      store.clearOnLoadActions();\n      remountUI({ showOAuthDialog: false, oauthInfo: null });\n    };\n\n    handleExitTo2DInterstitial(true, () => {\n      if (isInModal) history.goBack();\n      if (isInOAuth) exitOAuth();\n    });\n\n    performConditionalSignIn(\n      () => hubChannel.signedIn,\n      async () => {\n        // Strip el from stored payload because it won't serialize into the store.\n        const serializableDetail = {};\n        Object.assign(serializableDetail, e.detail);\n        delete serializableDetail.el;\n\n        if (hubChannel.can(\"tweet\")) {\n          isInModal = true;\n          pushHistoryState(history, \"modal\", \"tweet\", serializableDetail);\n        } else {\n          if (e.detail.el) {\n            // Pin the object if we have to go through OAuth, since the page will refresh and\n            // the object will otherwise be removed\n            e.detail.el.setAttribute(\"pinnable\", \"pinned\", true);\n          }\n\n          const url = await hubChannel.getTwitterOAuthURL();\n\n          isInOAuth = true;\n          store.enqueueOnLoadAction(\"emit_scene_event\", { event: \"action_media_tweet\", detail: serializableDetail });\n          remountUI({\n            showOAuthDialog: true,\n            oauthInfo: [{ type: \"twitter\", url: url }],\n            onCloseOAuthDialog: () => exitOAuth()\n          });\n        }\n      },\n      \"tweet\"\n    );\n  });\n\n  remountUI({ performConditionalSignIn, embed: isEmbed, showPreload: isEmbed });\n  entryManager.performConditionalSignIn = performConditionalSignIn;\n  entryManager.init();\n\n  const linkChannel = new LinkChannel(store);\n\n  window.APP.scene = scene;\n  window.APP.hubChannel = hubChannel;\n  window.dispatchEvent(new CustomEvent(\"hub_channel_ready\"));\n\n  const handleEarlyVRMode = () => {\n    // If VR headset is activated, refreshing page will fire vrdisplayactivate\n    // which puts A-Frame in VR mode, so exit VR mode whenever it is attempted\n    // to be entered and we haven't entered the room yet.\n    if (scene.is(\"vr-mode\") && !scene.is(\"vr-entered\")) {\n      console.log(\"Pre-emptively exiting VR mode.\");\n      scene.exitVR();\n      return true;\n    }\n\n    return false;\n  };\n\n  scene.addEventListener(\"enter-vr\", () => {\n    if (handleEarlyVRMode()) return true;\n\n    if (isMobileVR) {\n      // Optimization, stop drawing UI if not visible\n      remountUI({ hide: true });\n    }\n\n    document.body.classList.add(\"vr-mode\");\n\n    // Don't stretch canvas on cardboard, since that's drawing the actual VR view :)\n    if ((!isMobile && !isMobileVR) || availableVREntryTypes.cardboard !== VR_DEVICE_AVAILABILITY.yes) {\n      document.body.classList.add(\"vr-mode-stretch\");\n    }\n  });\n\n  handleEarlyVRMode();\n\n  // HACK A-Frame 0.9.0 seems to fail to wire up vrdisplaypresentchange early enough\n  // to catch presentation state changes and recognize that an HMD is presenting on startup.\n  window.addEventListener(\n    \"vrdisplaypresentchange\",\n    () => {\n      if (scene.is(\"vr-entered\")) return;\n      if (scene.is(\"vr-mode\")) return;\n\n      const device = AFRAME.utils.device.getVRDisplay();\n\n      if (device && device.isPresenting) {\n        if (!scene.is(\"vr-mode\")) {\n          console.warn(\"Hit A-Frame bug where VR display is presenting but A-Frame has not entered VR mode.\");\n          scene.enterVR();\n        }\n      }\n    },\n    { once: true }\n  );\n\n  scene.addEventListener(\"exit-vr\", () => {\n    document.body.classList.remove(\"vr-mode\");\n    document.body.classList.remove(\"vr-mode-stretch\");\n\n    remountUI({ hide: false });\n\n    // HACK: Oculus browser pauses videos when exiting VR mode, so we need to resume them after a timeout.\n    if (/OculusBrowser/i.test(window.navigator.userAgent)) {\n      document.querySelectorAll(\"[media-video]\").forEach(m => {\n        const videoComponent = m.components[\"media-video\"];\n\n        if (videoComponent) {\n          videoComponent._ignorePauseStateChanges = true;\n\n          setTimeout(() => {\n            const video = videoComponent.video;\n\n            if (video && video.paused && !videoComponent.data.videoPaused) {\n              video.play();\n            }\n\n            videoComponent._ignorePauseStateChanges = false;\n          }, 1000);\n        }\n      });\n    }\n  });\n\n  registerNetworkSchemas();\n\n  remountUI({\n    authChannel,\n    hubChannel,\n    linkChannel,\n    subscriptions,\n    enterScene: entryManager.enterScene,\n    exitScene: reason => {\n      entryManager.exitScene();\n\n      if (reason) {\n        remountUI({ roomUnavailableReason: reason });\n      }\n    },\n    initialIsSubscribed: subscriptions.isSubscribed(),\n    activeTips: scene.systems.tips.activeTips\n  });\n\n  scene.addEventListener(\"action_focus_chat\", () => {\n    const chatFocusTarget = document.querySelector(\".chat-focus-target\");\n    chatFocusTarget && chatFocusTarget.focus();\n  });\n\n  scene.addEventListener(\"tips_changed\", e => {\n    remountUI({ activeTips: e.detail });\n  });\n\n  scene.addEventListener(\"leave_room_requested\", () => {\n    scene.exitVR();\n    entryManager.exitScene(\"left\");\n    remountUI({ roomUnavailableReason: \"left\" });\n  });\n\n  scene.addEventListener(\"camera_toggled\", () => remountUI({}));\n\n  scene.addEventListener(\"camera_removed\", () => remountUI({}));\n\n  scene.addEventListener(\"hub_closed\", () => {\n    scene.exitVR();\n    entryManager.exitScene(\"closed\");\n    remountUI({ roomUnavailableReason: \"closed\" });\n  });\n\n  scene.addEventListener(\"action_camera_recording_started\", () => hubChannel.beginRecording());\n  scene.addEventListener(\"action_camera_recording_ended\", () => hubChannel.endRecording());\n\n  const platformUnsupportedReason = getPlatformUnsupportedReason();\n\n  if (platformUnsupportedReason) {\n    remountUI({ platformUnsupportedReason });\n    entryManager.exitScene();\n    return;\n  }\n\n  if (qs.get(\"required_version\") && process.env.BUILD_VERSION) {\n    const buildNumber = process.env.BUILD_VERSION.split(\" \", 1)[0]; // e.g. \"123 (abcd5678)\"\n\n    if (qs.get(\"required_version\") !== buildNumber) {\n      remountUI({ roomUnavailableReason: \"version_mismatch\" });\n      setTimeout(() => document.location.reload(), 5000);\n      entryManager.exitScene();\n      return;\n    }\n  }\n\n  getReticulumMeta().then(reticulumMeta => {\n    console.log(`Reticulum @ ${reticulumMeta.phx_host}: v${reticulumMeta.version} on ${reticulumMeta.pool}`);\n\n    if (\n      qs.get(\"required_ret_version\") &&\n      (qs.get(\"required_ret_version\") !== reticulumMeta.version || qs.get(\"required_ret_pool\") !== reticulumMeta.pool)\n    ) {\n      remountUI({ roomUnavailableReason: \"version_mismatch\" });\n      setTimeout(() => document.location.reload(), 5000);\n      entryManager.exitScene();\n      return;\n    }\n  });\n\n  if (isMobileVR) {\n    remountUI({ availableVREntryTypes, forcedVREntryType: \"vr\" });\n\n    if (/Oculus/.test(navigator.userAgent)) {\n      // HACK - The polyfill reports Cardboard as the primary VR display on startup out ahead of Oculus Go on Oculus Browser 5.5.0 beta. This display is cached by A-Frame,\n      // so we need to resolve that and get the real VRDisplay before entering as well.\n      const displays = await navigator.getVRDisplays();\n      const vrDisplay = displays.length && displays[0];\n      AFRAME.utils.device.getVRDisplay = () => vrDisplay;\n    }\n  } else {\n    const hasVREntryDevice =\n      availableVREntryTypes.cardboard !== VR_DEVICE_AVAILABILITY.no ||\n      availableVREntryTypes.generic !== VR_DEVICE_AVAILABILITY.no ||\n      availableVREntryTypes.daydream !== VR_DEVICE_AVAILABILITY.no;\n\n    remountUI({ availableVREntryTypes, forcedVREntryType: qsVREntryType || (!hasVREntryDevice ? \"2d\" : null) });\n  }\n\n  const environmentScene = document.querySelector(\"#environment-scene\");\n\n  const onFirstEnvironmentLoad = () => {\n    if (!scene.is(\"entered\")) {\n      setupLobbyCamera();\n    }\n\n    // Replace renderer with a noop renderer to reduce bot resource usage.\n    if (isBotMode) {\n      runBotMode(scene, entryManager);\n    }\n\n    environmentScene.removeEventListener(\"model-loaded\", onFirstEnvironmentLoad);\n  };\n\n  environmentScene.addEventListener(\"model-loaded\", onFirstEnvironmentLoad);\n\n  environmentScene.addEventListener(\"model-loaded\", () => {\n    // This will be run every time the environment is changed (including the first load.)\n    remountUI({ environmentSceneLoaded: true });\n    scene.emit(\"environment-scene-loaded\");\n\n    // Re-bind the teleporter controls collision meshes in case the scene changed.\n    document.querySelectorAll(\"a-entity[teleporter]\").forEach(x => x.components[\"teleporter\"].queryCollisionEntities());\n\n    for (const modelEl of environmentScene.children) {\n      addAnimationComponents(modelEl);\n    }\n  });\n\n  const socket = await connectToReticulum(isDebug);\n\n  socket.onClose(e => {\n    // We don't currently have an easy way to distinguish between being kicked (server closes socket)\n    // and a variety of other network issues that seem to produce the 1000 closure code, but the\n    // latter are probably more common. Either way, we just tell the user they got disconnected.\n    const NORMAL_CLOSURE = 1000;\n    if (e.code === NORMAL_CLOSURE) {\n      entryManager.exitScene();\n      remountUI({ roomUnavailableReason: \"disconnected\" });\n    }\n  });\n\n  let retDeployReconnectInterval;\n  const retReconnectMaxDelayMs = 15000;\n\n  // Reticulum global channel\n  let retPhxChannel = socket.channel(`ret`, { hub_id: hubId });\n  retPhxChannel\n    .join()\n    .receive(\"ok\", async data => subscriptions.setVapidPublicKey(data.vapid_public_key))\n    .receive(\"error\", res => {\n      subscriptions.setVapidPublicKey(null);\n      console.error(res);\n    });\n\n  const pushSubscriptionEndpoint = await subscriptions.getCurrentEndpoint();\n\n  const oauthFlowPermsToken = Cookies.get(OAUTH_FLOW_PERMS_TOKEN_KEY);\n\n  if (oauthFlowPermsToken) {\n    Cookies.remove(OAUTH_FLOW_PERMS_TOKEN_KEY);\n  }\n\n  const createHubChannelParams = permsToken => {\n    const params = {\n      profile: store.state.profile,\n      push_subscription_endpoint: pushSubscriptionEndpoint,\n      auth_token: null,\n      perms_token: null,\n      context: {\n        mobile: isMobile || isMobileVR,\n        hmd: availableVREntryTypes.isInHMD,\n        embed: isEmbed\n      }\n    };\n\n    if (permsToken) {\n      params.perms_token = permsToken;\n    }\n\n    const { token } = store.state.credentials;\n    if (token) {\n      console.log(`Logged into account ${store.credentialsAccountId}`);\n      params.auth_token = token;\n    }\n\n    return params;\n  };\n\n  const migrateToNewReticulumServer = async deployNotification => {\n    // On Reticulum deploys, reconnect after a random delay until pool + version match deployed version/pool\n    console.log(`Reticulum deploy detected v${deployNotification.ret_version} on ${deployNotification.ret_pool}`);\n    clearInterval(retDeployReconnectInterval);\n\n    setTimeout(() => {\n      const tryReconnect = async () => {\n        invalidateReticulumMeta();\n        const reticulumMeta = await getReticulumMeta();\n\n        if (\n          reticulumMeta.pool === deployNotification.ret_pool &&\n          reticulumMeta.version === deployNotification.ret_version\n        ) {\n          console.log(\"Reticulum reconnecting.\");\n          clearInterval(retDeployReconnectInterval);\n          const oldSocket = retPhxChannel.socket;\n          const socket = await connectToReticulum(isDebug, oldSocket.params());\n          retPhxChannel = await migrateChannelToSocket(retPhxChannel, socket);\n          await hubChannel.migrateToSocket(socket, createHubChannelParams());\n          authChannel.setSocket(socket);\n          linkChannel.setSocket(socket);\n\n          // Disconnect old socket after a delay to ensure this user is always registered in presence.\n          setTimeout(() => {\n            console.log(\"Reconnection complete. Disconnecting old reticulum socket.\");\n            oldSocket.teardown();\n          }, 10000);\n        }\n      };\n\n      retDeployReconnectInterval = setInterval(tryReconnect, 5000);\n      tryReconnect();\n    }, Math.floor(Math.random() * retReconnectMaxDelayMs));\n  };\n\n  retPhxChannel.on(\"notice\", async data => {\n    // On Reticulum deploys, reconnect after a random delay until pool + version match deployed version/pool\n    if (data.event === \"ret-deploy\") {\n      await migrateToNewReticulumServer(data);\n    }\n  });\n\n  const hubPhxChannel = socket.channel(`hub:${hubId}`, createHubChannelParams(oauthFlowPermsToken));\n\n  const presenceLogEntries = [];\n  const addToPresenceLog = entry => {\n    entry.key = Date.now().toString();\n\n    presenceLogEntries.push(entry);\n    remountUI({ presenceLogEntries });\n    if (entry.type === \"chat\") {\n      scene.systems[\"hubs-systems\"].soundEffectsSystem.playSoundOneShot(SOUND_CHAT_MESSAGE);\n    }\n\n    // Fade out and then remove\n    setTimeout(() => {\n      entry.expired = true;\n      remountUI({ presenceLogEntries });\n\n      setTimeout(() => {\n        presenceLogEntries.splice(presenceLogEntries.indexOf(entry), 1);\n        remountUI({ presenceLogEntries });\n      }, 5000);\n    }, 20000);\n  };\n\n  const messageDispatch = new MessageDispatch(\n    scene,\n    entryManager,\n    hubChannel,\n    addToPresenceLog,\n    remountUI,\n    mediaSearchStore\n  );\n\n  let isInitialJoin = true;\n\n  hubChannel.setPhoenixChannel(hubPhxChannel);\n\n  hubPhxChannel\n    .join()\n    .receive(\"ok\", async data => {\n      socket.params().session_id = data.session_id;\n      socket.params().session_token = data.session_token;\n\n      const vrHudPresenceCount = document.querySelector(\"#hud-presence-count\");\n\n      if (isInitialJoin) {\n        store.addEventListener(\"profilechanged\", hubChannel.sendProfileUpdate.bind(hubChannel));\n        hubChannel.presence.onSync(() => {\n          const presence = hubChannel.presence;\n\n          remountUI({\n            sessionId: socket.params().session_id,\n            presences: presence.state\n          });\n\n          const occupantCount = Object.entries(presence.state).length;\n          vrHudPresenceCount.setAttribute(\"text\", \"value\", occupantCount.toString());\n\n          if (occupantCount > 1) {\n            scene.addState(\"copresent\");\n          } else {\n            scene.removeState(\"copresent\");\n          }\n\n          // HACK - Set a flag on the presence object indicating if the initial sync has completed,\n          // which is used to determine if we should fire join/leave messages into the presence log.\n          presence.__hadInitialSync = true;\n\n          presence.onJoin((sessionId, current, info) => {\n            // Ignore presence join/leaves if this Presence has not yet had its initial sync (o/w the user\n            // will see join messages for every user.)\n            if (!hubChannel.presence.__hadInitialSync) return;\n\n            const meta = info.metas[info.metas.length - 1];\n            const occupantCount = Object.entries(hubChannel.presence.state).length;\n\n            if (occupantCount <= NOISY_OCCUPANT_COUNT) {\n              if (current) {\n                // Change to existing presence\n                const isSelf = sessionId === socket.params().session_id;\n                const currentMeta = current.metas[0];\n\n                if (\n                  !isSelf &&\n                  currentMeta.presence !== meta.presence &&\n                  meta.presence === \"room\" &&\n                  meta.profile.displayName\n                ) {\n                  addToPresenceLog({\n                    type: \"entered\",\n                    presence: meta.presence,\n                    name: meta.profile.displayName\n                  });\n                }\n\n                if (\n                  currentMeta.profile &&\n                  meta.profile &&\n                  currentMeta.profile.displayName !== meta.profile.displayName\n                ) {\n                  addToPresenceLog({\n                    type: \"display_name_changed\",\n                    oldName: currentMeta.profile.displayName,\n                    newName: meta.profile.displayName\n                  });\n                }\n              } else if (info.metas.length === 1) {\n                // New presence\n                const meta = info.metas[0];\n\n                if (meta.presence && meta.profile.displayName) {\n                  addToPresenceLog({\n                    type: \"join\",\n                    presence: meta.presence,\n                    name: meta.profile.displayName\n                  });\n                }\n              }\n            }\n\n            scene.emit(\"presence_updated\", {\n              sessionId,\n              profile: meta.profile,\n              roles: meta.roles,\n              streaming: meta.streaming,\n              recording: meta.recording\n            });\n          });\n\n          presence.onLeave((sessionId, current, info) => {\n            // Ignore presence join/leaves if this Presence has not yet had its initial sync\n            if (!hubChannel.presence.__hadInitialSync) return;\n\n            if (current && current.metas.length > 0) return;\n            const occupantCount = Object.entries(hubChannel.presence.state).length;\n            if (occupantCount > NOISY_OCCUPANT_COUNT) return;\n\n            const meta = info.metas[0];\n\n            if (meta.profile.displayName) {\n              addToPresenceLog({\n                type: \"leave\",\n                name: meta.profile.displayName\n              });\n            }\n          });\n        });\n      }\n\n      isInitialJoin = false;\n\n      const permsToken = oauthFlowPermsToken || data.perms_token;\n      hubChannel.setPermissionsFromToken(permsToken);\n\n      scene.addEventListener(\"adapter-ready\", ({ detail: adapter }) => {\n        adapter.setClientId(socket.params().session_id);\n        adapter.setJoinToken(data.perms_token);\n        hubChannel.addEventListener(\"permissions-refreshed\", e => adapter.setJoinToken(e.detail.permsToken));\n      });\n      subscriptions.setHubChannel(hubChannel);\n\n      subscriptions.setSubscribed(data.subscriptions.web_push);\n\n      remountUI({\n        hubIsBound: data.hub_requires_oauth,\n        initialIsFavorited: data.subscriptions.favorites,\n        initialIsSubscribed: subscriptions.isSubscribed()\n      });\n\n      await handleHubChannelJoined(entryManager, hubChannel, messageDispatch, data);\n    })\n    .receive(\"error\", res => {\n      if (res.reason === \"closed\") {\n        entryManager.exitScene();\n        remountUI({ roomUnavailableReason: \"closed\" });\n      } else if (res.reason === \"oauth_required\") {\n        entryManager.exitScene();\n        remountUI({ oauthInfo: res.oauth_info, showOAuthDialog: true });\n      } else if (res.reason === \"join_denied\") {\n        entryManager.exitScene();\n        remountUI({ roomUnavailableReason: \"denied\" });\n      }\n\n      console.error(res);\n    });\n\n  hubPhxChannel.on(\"naf\", data => {\n    if (!NAF.connection.adapter) return;\n    NAF.connection.adapter.onData(data, PHOENIX_RELIABLE_NAF);\n  });\n\n  hubPhxChannel.on(\"message\", ({ session_id, type, body, from }) => {\n    const getAuthor = () => {\n      const userInfo = hubChannel.presence.state[session_id];\n      if (from) {\n        return from;\n      } else if (userInfo) {\n        return userInfo.metas[0].profile.displayName;\n      } else {\n        return \"Mystery user\";\n      }\n    };\n\n    const name = getAuthor();\n    const maySpawn = scene.is(\"entered\");\n\n    const incomingMessage = { name, type, body, maySpawn, sessionId: session_id };\n\n    if (scene.is(\"vr-mode\")) {\n      createInWorldLogMessage(incomingMessage);\n    }\n\n    addToPresenceLog(incomingMessage);\n  });\n\n  hubPhxChannel.on(\"hub_refresh\", ({ session_id, hubs, stale_fields }) => {\n    const hub = hubs[0];\n    const userInfo = hubChannel.presence.state[session_id];\n\n    updateUIForHub(hub);\n\n    if (stale_fields.includes(\"scene\")) {\n      updateEnvironmentForHub(hub);\n\n      addToPresenceLog({\n        type: \"scene_changed\",\n        name: userInfo.metas[0].profile.displayName,\n        sceneName: hub.scene ? hub.scene.name : \"a custom URL\"\n      });\n    }\n\n    if (stale_fields.includes(\"member_permissions\")) {\n      hubChannel.fetchPermissions();\n    }\n\n    if (stale_fields.includes(\"name\")) {\n      const titleParts = document.title.split(\" | \"); // Assumes title has | trailing site name\n      titleParts[0] = hub.name;\n      document.title = titleParts.join(\" | \");\n\n      // Re-write the slug in the browser history\n      const pathParts = history.location.pathname.split(\"/\");\n      const oldSlug = pathParts[1];\n      const { search, state } = history.location;\n      const pathname = history.location.pathname.replace(`/${oldSlug}`, `/${hub.slug}`);\n\n      history.replace({ pathname, search, state });\n\n      addToPresenceLog({\n        type: \"hub_name_changed\",\n        name: userInfo.metas[0].profile.displayName,\n        hubName: hub.name\n      });\n    }\n\n    if (hub.entry_mode === \"deny\") {\n      scene.emit(\"hub_closed\");\n    }\n  });\n\n  hubPhxChannel.on(\"permissions_updated\", () => hubChannel.fetchPermissions());\n\n  hubPhxChannel.on(\"mute\", ({ session_id }) => {\n    if (session_id === NAF.clientId && !scene.is(\"muted\")) {\n      scene.emit(\"action_mute\");\n    }\n  });\n\n  authChannel.setSocket(socket);\n  linkChannel.setSocket(socket);\n});\n","// Stores a key in localStorage and registeres a listener for the same key being set (by another tab).\n// When detected, fire a \"concurrentload\" event.\nexport default function detectConcurrentLoad(instanceKey = \"global\") {\n  const key = `___concurrent_load_detector_${instanceKey}`;\n  localStorage.setItem(key, JSON.stringify({ started_at: new Date() }));\n  const onStorageEvent = e => {\n    if (e.key !== key) return;\n    window.dispatchEvent(new CustomEvent(\"concurrentload\"));\n    window.removeEventListener(\"storage\", onStorageEvent);\n  };\n  window.addEventListener(\"storage\", onStorageEvent);\n}\n","export default function patchThreeAllocations() {\n  const renderer = AFRAME.scenes[0].renderer;\n  const gl = renderer.context;\n\n  // These functions in three.js uses the arguments object, which allocates.\n  renderer.state.texImage2D = function(a, b, c, d, e, f, g, h, i) {\n    try {\n      if (g === undefined) {\n        gl.texImage2D(a, b, c, d, e, f);\n      } else {\n        gl.texImage2D(a, b, c, d, e, f, g, h, i);\n      }\n    } catch (error) {\n      console.error(\"THREE.WebGLState:\", error);\n    }\n  };\n\n  renderer.state.compressedTexImage2D = function(a, b, c, d, e, f, g, h, i, j) {\n    try {\n      if (h === undefined) {\n        gl.compressedTexImage2D(a, b, c, d, e, f, g);\n      } else if (i === undefined) {\n        gl.compressedTexImage2D(a, b, c, d, e, f, g, h);\n      } else if (j === undefined) {\n        gl.compressedTexImage2D(a, b, c, d, e, f, g, h, i);\n      } else {\n        gl.compressedTexImage2D(a, b, c, d, e, f, g, h, i, j);\n      }\n    } catch (error) {\n      console.error(\"THREE.WebGLState:\", error);\n    }\n  };\n}\n","/* global fetch THREE */\nimport URL_TICK from \"../assets/sfx/tick.mp3\";\nimport URL_TELEPORT_LOOP from \"../assets/sfx/teleport-loop.mp3\";\nimport URL_QUICK_TURN from \"../assets/sfx/quickTurn.mp3\";\nimport URL_TAP_MELLOW from \"../assets/sfx/tap_mellow.mp3\";\nimport URL_PEN_SPAWN from \"../assets/sfx/PenSpawn.mp3\";\nimport URL_PEN_DRAW from \"../assets/sfx/PenDraw1.mp3\";\nimport URL_CAMERA_SNAPSHOT from \"../assets/sfx/PicSnapHey.mp3\";\nimport URL_WELCOME from \"../assets/sfx/welcome.mp3\";\nimport URL_QUACK from \"../assets/sfx/quack.mp3\";\nimport URL_SPECIAL_QUACK from \"../assets/sfx/specialquack.mp3\";\nimport URL_POP from \"../assets/sfx/pop.mp3\";\nimport URL_FREEZE from \"../assets/sfx/Eb_blip.mp3\";\nimport URL_TACK from \"../assets/sfx/tack.mp3\";\nimport URL_MEDIA_LOADED from \"../assets/sfx/A_bendUp.mp3\";\nimport URL_MEDIA_LOADING from \"../assets/sfx/suspense.mp3\";\n\nlet soundEnum = 0;\nexport const SOUND_HOVER_OR_GRAB = soundEnum++;\nexport const SOUND_THAW = soundEnum++;\nexport const SOUND_PEN_STOP_DRAW = soundEnum++;\nexport const SOUND_PEN_UNDO_DRAW = soundEnum++;\nexport const SOUND_PEN_CHANGE_COLOR = soundEnum++;\nexport const SOUND_TOGGLE_MIC = soundEnum++;\nexport const SOUND_TELEPORT_START = soundEnum++;\nexport const SOUND_TELEPORT_END = soundEnum++;\nexport const SOUND_SNAP_ROTATE = soundEnum++;\nexport const SOUND_SPAWN_PEN = soundEnum++;\nexport const SOUND_PEN_START_DRAW = soundEnum++;\nexport const SOUND_CAMERA_TOOL_TOOK_SNAPSHOT = soundEnum++;\nexport const SOUND_ENTER_SCENE = soundEnum++;\nexport const SOUND_QUACK = soundEnum++;\nexport const SOUND_SPECIAL_QUACK = soundEnum++;\nexport const SOUND_CHAT_MESSAGE = soundEnum++;\nexport const SOUND_FREEZE = soundEnum++;\nexport const SOUND_PIN = soundEnum++;\nexport const SOUND_MEDIA_LOADING = soundEnum++;\nexport const SOUND_MEDIA_LOADED = soundEnum++;\nexport const SOUND_CAMERA_TOOL_COUNTDOWN = soundEnum++;\n\n// Safari doesn't support the promise form of decodeAudioData, so we polyfill it.\nfunction decodeAudioData(audioContext, arrayBuffer) {\n  return new Promise((resolve, reject) => {\n    audioContext.decodeAudioData(arrayBuffer, resolve, reject);\n  });\n}\n\nexport class SoundEffectsSystem {\n  constructor() {\n    this.pendingEffects = [];\n    this.audioContext = THREE.AudioContext.getContext();\n    const soundsAndUrls = [\n      [SOUND_HOVER_OR_GRAB, URL_TICK],\n      [SOUND_THAW, URL_TICK],\n      [SOUND_PEN_STOP_DRAW, URL_TICK],\n      [SOUND_PEN_UNDO_DRAW, URL_TICK],\n      [SOUND_PEN_CHANGE_COLOR, URL_TICK],\n      [SOUND_TOGGLE_MIC, URL_TICK],\n      [SOUND_CAMERA_TOOL_COUNTDOWN, URL_TICK],\n      [SOUND_TELEPORT_START, URL_TELEPORT_LOOP],\n      [SOUND_TELEPORT_END, URL_QUICK_TURN],\n      [SOUND_SNAP_ROTATE, URL_TAP_MELLOW],\n      [SOUND_SPAWN_PEN, URL_PEN_SPAWN],\n      [SOUND_PEN_START_DRAW, URL_PEN_DRAW],\n      [SOUND_CAMERA_TOOL_TOOK_SNAPSHOT, URL_CAMERA_SNAPSHOT],\n      [SOUND_ENTER_SCENE, URL_WELCOME],\n      [SOUND_QUACK, URL_QUACK],\n      [SOUND_SPECIAL_QUACK, URL_SPECIAL_QUACK],\n      [SOUND_CHAT_MESSAGE, URL_POP],\n      [SOUND_FREEZE, URL_FREEZE],\n      [SOUND_PIN, URL_TACK],\n      [SOUND_MEDIA_LOADING, URL_MEDIA_LOADING],\n      [SOUND_MEDIA_LOADED, URL_MEDIA_LOADED]\n    ];\n    const loading = new Map();\n    const load = url => {\n      let audioBufferPromise = loading.get(url);\n      if (!audioBufferPromise) {\n        audioBufferPromise = fetch(url)\n          .then(r => r.arrayBuffer())\n          .then(arrayBuffer => decodeAudioData(this.audioContext, arrayBuffer));\n        loading.set(url, audioBufferPromise);\n      }\n      return audioBufferPromise;\n    };\n    this.sounds = new Map();\n    soundsAndUrls.map(([sound, url]) => {\n      load(url).then(audioBuffer => {\n        this.sounds.set(sound, audioBuffer);\n      });\n    });\n  }\n\n  enqueueSound(sound, loop) {\n    const audioBuffer = this.sounds.get(sound);\n    if (!audioBuffer) return null;\n    // The nodes are very inexpensive to create, according to\n    // https://developer.mozilla.org/en-US/docs/Web/API/AudioBufferSourceNode\n    const source = this.audioContext.createBufferSource();\n    source.buffer = audioBuffer;\n    source.connect(this.audioContext.destination);\n    source.loop = loop;\n    this.pendingEffects.push(source);\n    return source;\n  }\n\n  playSoundOneShot(sound) {\n    return this.enqueueSound(sound, false);\n  }\n\n  playSoundLooped(sound) {\n    return this.enqueueSound(sound, true);\n  }\n\n  playSoundLoopedWithGain(sound) {\n    const audioBuffer = this.sounds.get(sound);\n    if (!audioBuffer) return null;\n\n    const source = this.audioContext.createBufferSource();\n    const gain = this.audioContext.createGain();\n    source.buffer = audioBuffer;\n    source.connect(gain);\n    gain.connect(this.audioContext.destination);\n    source.loop = true;\n    this.pendingEffects.push(source);\n    return { gain, source };\n  }\n\n  stopSoundNode(node) {\n    const index = this.pendingEffects.indexOf(node);\n    if (index !== -1) {\n      this.pendingEffects.splice(index, 1);\n    } else {\n      node.stop();\n    }\n  }\n\n  tick() {\n    for (let i = 0; i < this.pendingEffects.length; i++) {\n      this.pendingEffects[i].start();\n    }\n    this.pendingEffects.length = 0;\n  }\n}\n","module.exports = __webpack_public_path__ + \"assets/images/warning_icon-739d2a2ea906737505bcbc2cb51123a8.png\";","module.exports = __webpack_public_path__ + \"assets/images/warning_icon@2x-706e4a4db33f9456bac320e956b4120d.png\";","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { injectIntl, FormattedMessage } from \"react-intl\";\nimport classNames from \"classnames\";\nimport \"three/examples/js/controls/OrbitControls\";\n\nimport { createDefaultEnvironmentMap } from \"../components/environment-map\";\nimport { loadGLTF } from \"../components/gltf-model-plus\";\nimport { disposeNode } from \"../utils/three-utils\";\nimport { createImageBitmap, disposeImageBitmap } from \"../utils/image-bitmap-utils\";\nimport styles from \"../assets/stylesheets/avatar-preview.scss\";\n\nconst TEXTURE_PROPS = {\n  base_map: [\"map\"],\n  emissive_map: [\"emissiveMap\"],\n  normal_map: [\"normalMap\"],\n  orm_map: [\"aoMap\", \"roughnessMap\", \"metalnessMap\"]\n};\n\nconst ALL_MAPS = Object.keys(TEXTURE_PROPS);\n\n// This should match our aframe renderer=\"antialias: true; colorManagement: true; sortObjects: true;\n// physicallyCorrectLights: true; webgl2: true; multiview: false;\"\nfunction createRenderer(canvas, alpha = false, useDevicePixelRatio = true) {\n  const context = canvas.getContext(\"webgl2\", {\n    alpha,\n    depth: true,\n    antialias: true,\n    premultipliedAlpha: true,\n    preserveDrawingBuffer: false,\n    powerPreference: \"default\"\n  });\n\n  const renderer = new THREE.WebGLRenderer({ alpha, canvas, context });\n  renderer.gammaOutput = true;\n  renderer.gammaFactor = 2.2;\n  renderer.physicallyCorrectLights = true;\n  if (useDevicePixelRatio) {\n    renderer.setPixelRatio(window.devicePixelRatio);\n  }\n  return renderer;\n}\n\nconst createImageBitmapFromURL = url =>\n  fetch(url)\n    .then(r => r.blob())\n    .then(createImageBitmap);\n\nconst ORBIT_ANGLE = new THREE.Euler(-30 * THREE.Math.DEG2RAD, 30 * THREE.Math.DEG2RAD, 0);\nconst DEFAULT_MARGIN = 1;\n\nfunction fitBoxInFrustum(camera, box, center, margin = DEFAULT_MARGIN) {\n  const halfYExtents = Math.max(box.max.y - center.y, center.y - box.min.y);\n  const halfVertFOV = THREE.Math.degToRad(camera.fov / 2);\n  camera.position.set(0, 0, (halfYExtents / Math.tan(halfVertFOV) + box.max.z) * margin);\n  camera.position.applyEuler(ORBIT_ANGLE);\n  camera.position.add(center);\n  camera.lookAt(center);\n}\n\nclass AvatarPreview extends Component {\n  static propTypes = {\n    avatarGltfUrl: PropTypes.string,\n    className: PropTypes.string\n  };\n  constructor(props) {\n    super(props);\n    this.state = { loading: true, error: null };\n    this.avatar = null;\n    this.imageBitmaps = {};\n  }\n\n  componentDidMount = () => {\n    this.scene = new THREE.Scene();\n\n    this.camera = new THREE.PerspectiveCamera(55, this.canvas.clientWidth / this.canvas.clientHeight, 0.1, 1000);\n    this.controls = new THREE.OrbitControls(this.camera, this.canvas);\n    this.controls.enablePan = false;\n\n    const light = new THREE.DirectionalLight(0xf7f6ef, 1);\n    light.position.set(0, 10, 10);\n    this.scene.add(light);\n    this.scene.add(new THREE.HemisphereLight(0xb1e3ff, 0xb1e3ff, 2.5));\n\n    this.camera.position.set(-0.2, 0.5, 0.5);\n    this.camera.matrixAutoUpdate = true;\n\n    this.controls.target.set(0, 0.45, 0);\n    this.controls.update();\n\n    if (this.props.avatarGltfUrl) {\n      this.loadPreviewAvatar(this.props.avatarGltfUrl).then(this.setAvatar);\n    }\n\n    const clock = new THREE.Clock();\n\n    this.snapshotCanvas = document.createElement(\"canvas\");\n    this.snapshotCanvas.width = 720;\n    this.snapshotCanvas.height = 1280;\n    this.snapshotCamera = new THREE.PerspectiveCamera(55, 720 / 1280, 0.1, 1000);\n    this.snapshotCamera.matrixAutoUpdate = true;\n    this.snapshotRenderer = createRenderer(this.snapshotCanvas, true, false);\n    this.snapshotRenderer.setClearAlpha(0);\n\n    this.previewRenderer = createRenderer(this.canvas);\n    this.previewRenderer.setClearColor(0xeaeaea);\n    this.previewRenderer.setAnimationLoop(() => {\n      const dt = clock.getDelta();\n      this.mixer && this.mixer.update(dt);\n      this.previewRenderer.render(this.scene, this.camera);\n    });\n    window.addEventListener(\"resize\", this.resize);\n    this.resize();\n  };\n\n  resize = () => {\n    const width = this.canvas.parentElement.offsetWidth;\n    const height = this.canvas.parentElement.offsetHeight;\n    this.previewRenderer.setSize(width, height);\n    this.camera.aspect = width / height;\n    this.camera.updateProjectionMatrix();\n  };\n\n  setAvatar = avatar => {\n    if (!avatar) return;\n    this.avatar = avatar;\n    this.scene.add(avatar);\n    this.resetCamera();\n    this.setState({ error: null, loading: false });\n  };\n\n  resetCamera = (() => {\n    const box = new THREE.Box3();\n    const center = new THREE.Vector3();\n    return () => {\n      box.setFromObject(this.avatar);\n      box.getCenter(center);\n\n      // Shift the center vertically in order to frame the avatar nicely.\n      center.y = (box.max.y - box.min.y) * 0.6 + box.min.y;\n\n      fitBoxInFrustum(this.camera, box, center);\n      fitBoxInFrustum(this.snapshotCamera, box, center, 0.7);\n\n      this.controls.target.copy(center);\n      this.controls.update();\n    };\n  })();\n\n  componentWillUnmount = () => {\n    // Gotta be particularly careful about disposing things here since we will likely create many avatar\n    // previews during a session and Chrome will eventually discard the oldest webgl context if we leak\n    // contexts by holding on to them directly or indirectly.\n\n    this.scene && this.scene.traverse(disposeNode);\n    if (this.previewRenderer) {\n      this.previewRenderer.dispose();\n      this.previewRenderer.context = null;\n    }\n    if (this.snapshotRenderer) {\n      this.snapshotRenderer.dispose();\n      this.snapshotRenderer.context = null;\n    }\n    if (this.controls) {\n      this.controls.dispose();\n      this.controls.domElement = null;\n    }\n\n    Object.values(this.imageBitmaps).forEach(img => disposeImageBitmap(img));\n    window.removeEventListener(\"resize\", this.resize);\n  };\n\n  componentDidUpdate = async oldProps => {\n    if (oldProps.avatarGltfUrl !== this.props.avatarGltfUrl) {\n      if (this.avatar) {\n        this.scene.remove(this.avatar);\n        this.avatar = null;\n      }\n      if (this.props.avatarGltfUrl) {\n        this.setState({ error: null, loading: true });\n        await this.loadPreviewAvatar(this.props.avatarGltfUrl).then(this.setAvatar);\n      }\n    }\n    this.applyMaps(oldProps, this.props);\n  };\n\n  applyMaps(oldProps, newProps) {\n    return Promise.all(\n      ALL_MAPS.map(mapName => {\n        const applyMap = this.applyMapToPreview.bind(this, mapName);\n        if (oldProps[mapName] != newProps[mapName]) {\n          if (newProps[mapName] instanceof File) {\n            return createImageBitmap(newProps[mapName]).then(applyMap);\n          } else if (newProps[mapName]) {\n            return createImageBitmapFromURL(newProps[mapName]).then(applyMap);\n          } else {\n            return this.revertMap(mapName);\n          }\n        }\n      })\n    );\n  }\n\n  loadPreviewAvatar = async avatarGltfUrl => {\n    let gltf;\n    try {\n      gltf = await loadGLTF(avatarGltfUrl, \"model/gltf\");\n    } catch (e) {\n      this.setState({ loading: false, error: true });\n      return;\n    }\n\n    // On the backend we look for a material called Bot_PBS, here we are looking for a mesh called Avatar.\n    // When we \"officially\" support uploading custom GLTFs we need to decide what we are going to key things on\n    this.previewMesh =\n      gltf.scene.getObjectByName(\"AvatarMesh\") ||\n      gltf.scene.getObjectByName(\"Avatar\") ||\n      gltf.scene.getObjectByName(\"Bot_Skinned\") ||\n      gltf.scene;\n\n    const idleAnimation = gltf.animations && gltf.animations.find(({ name }) => name === \"idle_eyes\");\n    if (idleAnimation) {\n      this.mixer = new THREE.AnimationMixer(this.previewMesh);\n      const action = this.mixer.clipAction(idleAnimation);\n      action.enabled = true;\n      action.setLoop(THREE.LoopRepeat, Infinity).play();\n      this.idleAnimationAction = action;\n    }\n\n    const { material } = this.previewMesh;\n    if (material) {\n      // We delete onUpdate here to opt out of the auto texture cleanup after GPU upload.\n      const getImage = p => delete material[p].onUpdate && material[p].image;\n      this.originalMaps = {\n        base_map: TEXTURE_PROPS[\"base_map\"].map(getImage),\n        emissive_map: TEXTURE_PROPS[\"emissive_map\"].map(getImage),\n        normal_map: TEXTURE_PROPS[\"normal_map\"].map(getImage),\n        orm_map: TEXTURE_PROPS[\"orm_map\"].map(getImage)\n      };\n\n      await Promise.all([\n        this.applyMaps({}, this.props), // Apply initial maps\n        createDefaultEnvironmentMap().then(t => {\n          this.previewMesh.material.envMap = t;\n          this.previewMesh.material.needsUpdate = true;\n        })\n      ]);\n    } else {\n      this.originalMaps = {};\n    }\n\n    return gltf.scene;\n  };\n\n  applyMapToPreview = (name, image) => {\n    if (this.imageBitmaps[name]) {\n      disposeImageBitmap(this.imageBitmaps[name]);\n    }\n    this.imageBitmaps[name] = image;\n    TEXTURE_PROPS[name].forEach(prop => {\n      const texture = this.previewMesh.material[prop];\n      texture.image = image;\n      texture.needsUpdate = true;\n    });\n  };\n\n  revertMap = name => {\n    if (this.imageBitmaps[name]) {\n      disposeImageBitmap(this.imageBitmaps[name]);\n    }\n    delete this.imageBitmaps[name];\n    this.originalMaps[name].forEach((bm, i) => {\n      const texture = this.previewMesh.material[TEXTURE_PROPS[name][i]];\n      texture.image = bm;\n      texture.needsUpdate = true;\n    });\n  };\n\n  snapshot = () => {\n    return new Promise(resolve => {\n      if (this.idleAnimationAction) this.idleAnimationAction.stop();\n      this.snapshotRenderer.render(this.scene, this.snapshotCamera);\n      this.snapshotCanvas.toBlob(blob => {\n        if (this.idleAnimationAction) this.idleAnimationAction.play();\n        resolve(blob);\n      });\n    });\n  };\n\n  render() {\n    return (\n      <div className={classNames(styles.preview, this.props.className)}>\n        {this.state.loading &&\n          !this.state.error && (\n            <div className=\"loader\">\n              <div className=\"loader-center\" />\n            </div>\n          )}\n        {this.state.error &&\n          !this.state.loading && (\n            <div className=\"error\">\n              <img\n                src=\"../assets/images/warning_icon.png\"\n                srcSet=\"../assets/images/warning_icon@2x.png 2x\"\n                className=\"error-icon\"\n              />\n              <FormattedMessage id=\"avatar-preview.loading-failed\" />\n            </div>\n          )}\n        <canvas ref={c => (this.canvas = c)} />\n      </div>\n    );\n  }\n}\n\nexport default injectIntl(AvatarPreview, { withRef: true });\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { FormattedMessage } from \"react-intl\";\nimport { getAirtableAssets, airtableAssetsInitialState } from '../everyspace/airtable'\n\nimport styles from \"../assets/stylesheets/sign-in-dialog.scss\";\nimport DialogContainer from \"./dialog-container\";\nimport { handleTextFieldFocus, handleTextFieldBlur } from \"../utils/focus-utils\";\n\nexport default class SignInDialog extends Component {\n  static propTypes = {\n    authStarted: PropTypes.bool,\n    authComplete: PropTypes.bool,\n    onSignIn: PropTypes.func,\n    onContinue: PropTypes.func,\n    message: PropTypes.string,\n    continueText: PropTypes.string,\n    privacyLink: PropTypes.string,\n    termsLink: PropTypes.string\n  };\n\n  state = {\n    email: \"\",\n    airtableAssets: airtableAssetsInitialState\n  };\n\n  componentWillMount(){\n    this.fetchAirtableAssets()\n  }\n\n  fetchAirtableAssets = async () => {\n    const airtableAssets = await getAirtableAssets()\n    if (airtableAssets) this.setState({ airtableAssets })\n  }\n\n  onSubmit = e => {\n    e.preventDefault();\n    e.stopPropagation();\n    this.props.onSignIn(this.state.email);\n  };\n\n  render() {\n    let contents;\n    if (this.props.authStarted) {\n      contents = (\n        <p>\n          <FormattedMessage className=\"preformatted\" id=\"sign-in.auth-started\" />\n        </p>\n      );\n    } else if (this.props.authComplete) {\n      contents = (\n        <div className={styles.signInComplete}>\n          <p>{this.props.message}</p>\n          <button onClick={this.props.onContinue} className={styles.continueButton}>\n            {this.props.continueText}\n          </button>\n        </div>\n      );\n    } else {\n      contents = (\n        <form onSubmit={this.onSubmit} className={styles.signInForm}>\n          <span>{this.state.airtableAssets.Sign_In_Message}</span>\n          <input\n            name=\"email\"\n            type=\"email\"\n            required\n            placeholder=\"Your email address\"\n            value={this.state.email}\n            onFocus={e => handleTextFieldFocus(e.target)}\n            onBlur={() => handleTextFieldBlur()}\n            onChange={e => this.setState({ email: e.target.value })}\n            className={styles.emailField}\n          />\n          <p className={styles.terms}>\n            By proceeding, you agree to the{\" \"}\n            <a rel=\"noopener noreferrer\" target=\"_blank\" href={this.state.airtableAssets.Terms_Link || \"https://github.com/mozilla/hubs/blob/master/TERMS.md\"}>\n              terms of use\n            </a>{\" \"}\n            and{\" \"}\n            <a rel=\"noopener noreferrer\" target=\"_blank\" href={this.state.airtableAssets.Privacy_Link || \"https://github.com/mozilla/hubs/blob/master/PRIVACY.md\"}>\n              privacy notice\n            </a>.\n          </p>\n          <button type=\"submit\" className={styles.nextButton}>\n            next\n          </button>\n        </form>\n      );\n    }\n\n    return (\n      <DialogContainer title=\"Sign In\" {...this.props}>\n        {contents}\n      </DialogContainer>\n    );\n  }\n}\n","// removed by extract-text-webpack-plugin\nmodule.exports = {\"media-browser\":\"media-browser__media-browser__y0Hsu\",\"mediaBrowser\":\"media-browser__media-browser__y0Hsu\",\"facets\":\"media-browser__facets__1Yz65\",\"facet\":\"media-browser__facet__2uP6U\",\"body\":\"media-browser__body__j6Tv2\",\"pager\":\"media-browser__pager__RKx5O\",\"header-center\":\"media-browser__header-center__2D9CW\",\"headerCenter\":\"media-browser__header-center__2D9CW\",\"search\":\"media-browser__search__3gQ84\",\"engine-attribution\":\"media-browser__engine-attribution__2P2aD\",\"engineAttribution\":\"media-browser__engine-attribution__2P2aD\",\"engine-attribution-contents\":\"media-browser__engine-attribution-contents__gCdfr\",\"engineAttributionContents\":\"media-browser__engine-attribution-contents__gCdfr\",\"favorites-header\":\"media-browser__favorites-header__1XzZx\",\"favoritesHeader\":\"media-browser__favorites-header__1XzZx\",\"search-clear\":\"media-browser__search-clear__2GkP3\",\"searchClear\":\"media-browser__search-clear__2GkP3\",\"search-icon\":\"media-browser__search-icon__g1Sj9\",\"searchIcon\":\"media-browser__search-icon__g1Sj9\",\"box\":\"media-browser__box__1KHYi\",\"header\":\"media-browser__header__zqZ09\",\"no-search\":\"media-browser__no-search__3N90H\",\"noSearch\":\"media-browser__no-search__3N90H\",\"nav\":\"media-browser__nav__9J5If\",\"nav-right-pad\":\"media-browser__nav-right-pad__1qH0B\",\"navRightPad\":\"media-browser__nav-right-pad__1qH0B\",\"nav-source\":\"media-browser__nav-source__o6NI6\",\"navSource\":\"media-browser__nav-source__o6NI6\",\"nav-source-selected\":\"media-browser__nav-source-selected__2osjH\",\"navSourceSelected\":\"media-browser__nav-source-selected__2osjH\",\"nav-scroll-arrow\":\"media-browser__nav-scroll-arrow__2Nikk\",\"navScrollArrow\":\"media-browser__nav-scroll-arrow__2Nikk\",\"tiles\":\"media-browser__tiles__1BYEY\",\"tile\":\"media-browser__tile__2lzHU\",\"info\":\"media-browser__info__2c8Zs\",\"name\":\"media-browser__name__RFiE4\",\"attribution\":\"media-browser__attribution__3glgj\",\"creator\":\"media-browser__creator__3LDPh\",\"publisher\":\"media-browser__publisher__mTzsX\",\"last-joined\":\"media-browser__last-joined__2DVWf\",\"lastJoined\":\"media-browser__last-joined__2DVWf\",\"tile-link\":\"media-browser__tile-link__IXyUO\",\"tileLink\":\"media-browser__tile-link__IXyUO\",\"tile-content\":\"media-browser__tile-content__1QYSP\",\"tileContent\":\"media-browser__tile-content__1QYSP\",\"avatar-tile\":\"media-browser__avatar-tile__qNo2r\",\"avatarTile\":\"media-browser__avatar-tile__qNo2r\",\"edit-avatar\":\"media-browser__edit-avatar__2HBfV\",\"editAvatar\":\"media-browser__edit-avatar__2HBfV\",\"create-tile\":\"media-browser__create-tile__RL9vr\",\"createTile\":\"media-browser__create-tile__RL9vr\",\"tiles-variable\":\"media-browser__tiles-variable__1ZNxg\",\"tilesVariable\":\"media-browser__tiles-variable__1ZNxg\",\"page-number\":\"media-browser__page-number__OTpSH\",\"pageNumber\":\"media-browser__page-number__OTpSH\",\"pager-button-disabled\":\"media-browser__pager-button-disabled__ytlSN\",\"pagerButtonDisabled\":\"media-browser__pager-button-disabled__ytlSN\",\"header-left\":\"media-browser__header-left__1ObQh\",\"headerLeft\":\"media-browser__header-left__1ObQh\",\"header-right\":\"media-browser__header-right__3k3JZ\",\"headerRight\":\"media-browser__header-right__3k3JZ\",\"create-button\":\"media-browser__create-button__30hMV\",\"createButton\":\"media-browser__create-button__30hMV\",\"create-link\":\"media-browser__create-link__28Bpj\",\"createLink\":\"media-browser__create-link__28Bpj\",\"empty-string\":\"media-browser__empty-string__3r0tc\",\"emptyString\":\"media-browser__empty-string__3r0tc\",\"media-browser-inline\":\"media-browser__media-browser-inline__3AgWD\",\"mediaBrowserInline\":\"media-browser__media-browser-inline__3AgWD\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"email-field\":\"sign-in-dialog__email-field__g3xRW\",\"emailField\":\"sign-in-dialog__email-field__g3xRW\",\"next-button\":\"sign-in-dialog__next-button__2pGtq\",\"nextButton\":\"sign-in-dialog__next-button__2pGtq\",\"continue-button\":\"sign-in-dialog__continue-button__kFN6Z\",\"continueButton\":\"sign-in-dialog__continue-button__kFN6Z\",\"sign-in-form\":\"sign-in-dialog__sign-in-form__3Muog\",\"signInForm\":\"sign-in-dialog__sign-in-form__3Muog\",\"sign-in-complete\":\"sign-in-dialog__sign-in-complete__3JMkv\",\"signInComplete\":\"sign-in-dialog__sign-in-complete__3JMkv\",\"terms\":\"sign-in-dialog__terms__3TT6i\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"ui\":\"hub__ui__3UYRO\",\"ui-dialog\":\"hub__ui-dialog__vlyfc\",\"uiDialog\":\"hub__ui-dialog__vlyfc\",\"ui-interactive\":\"hub__ui-interactive__3bdyc\",\"uiInteractive\":\"hub__ui-interactive__3bdyc\",\"presence-info\":\"hub__presence-info__dqWyo\",\"presenceInfo\":\"hub__presence-info__dqWyo\",\"corner-button\":\"hub__corner-button__2KphD\",\"cornerButton\":\"hub__corner-button__2KphD\",\"profile-entry\":\"hub__profile-entry__1RY0R\",\"profileEntry\":\"hub__profile-entry__1RY0R\",\"form-submit\":\"hub__form-submit__12yem\",\"formSubmit\":\"hub__form-submit__12yem\",\"nag-corner-button\":\"hub__nag-corner-button__lNoyE\",\"nagCornerButton\":\"hub__nag-corner-button__lNoyE\",\"choose-scene-button\":\"hub__choose-scene-button__5Y0Q_\",\"chooseSceneButton\":\"hub__choose-scene-button__5Y0Q_\",\"choose-avatar\":\"hub__choose-avatar__22JJm\",\"chooseAvatar\":\"hub__choose-avatar__22JJm\",\"entry-button-secondary\":\"hub__entry-button-secondary__2ui-g\",\"entryButtonSecondary\":\"hub__entry-button-secondary__2ui-g\",\"entry-panel\":\"hub__entry-panel__cCmIv\",\"entryPanel\":\"hub__entry-panel__cCmIv\",\"button-container\":\"hub__button-container__38FOc\",\"buttonContainer\":\"hub__button-container__38FOc\",\"secondary-action-button\":\"hub__secondary-action-button__2KoCD\",\"secondaryActionButton\":\"hub__secondary-action-button__2KoCD\",\"leave-button\":\"hub__leave-button__1YK4o\",\"leaveButton\":\"hub__leave-button__1YK4o\",\"interstitial\":\"hub__interstitial__3WXbJ\",\"entry-button\":\"hub__entry-button__1e9jM\",\"entryButton\":\"hub__entry-button__1e9jM\",\"action-button\":\"hub__action-button__3zqlu\",\"actionButton\":\"hub__action-button__3zqlu\",\"collapse-button\":\"hub__collapse-button__3N-6b\",\"collapseButton\":\"hub__collapse-button__3N-6b\",\"favorite-button\":\"hub__favorite-button__1Qgbp\",\"favoriteButton\":\"hub__favorite-button__1Qgbp\",\"back\":\"hub__back__3AZh2\",\"form-field-text\":\"hub__form-field-text__tR1Lt\",\"formFieldText\":\"hub__form-field-text__tR1Lt\",\"lobby-label\":\"hub__lobby-label__2ktmo\",\"lobbyLabel\":\"hub__lobby-label__2ktmo\",\"label\":\"hub__label__1kjp1\",\"title\":\"hub__title__ezGEu\",\"name\":\"hub__name__2umw1\",\"rename-button\":\"hub__rename-button__h-4K7\",\"renameButton\":\"hub__rename-button__h-4K7\",\"center\":\"hub__center__1Mvfu\",\"wide-button\":\"hub__wide-button__1yqDc\",\"wideButton\":\"hub__wide-button__1yqDc\",\"screen-sharing\":\"hub__screen-sharing__2VF91\",\"screenSharing\":\"hub__screen-sharing__2VF91\",\"checkbox\":\"hub__checkbox__32dyv\",\"invite-tip\":\"hub__invite-tip__9enoe\",\"inviteTip\":\"hub__invite-tip__9enoe\",\"loading-text\":\"hub__loading-text__1WDud\",\"loadingText\":\"hub__loading-text__1WDud\",\"streaming-tip\":\"hub__streaming-tip__1LnId\",\"streamingTip\":\"hub__streaming-tip__1LnId\",\"streaming-tip-attach-point\":\"hub__streaming-tip-attach-point__1oCgh\",\"streamingTipAttachPoint\":\"hub__streaming-tip-attach-point__1oCgh\",\"streaming-tip-close\":\"hub__streaming-tip-close__E6fwS\",\"streamingTipClose\":\"hub__streaming-tip-close__E6fwS\",\"streaming-tip-message\":\"hub__streaming-tip-message__XcScW\",\"streamingTipMessage\":\"hub__streaming-tip-message__XcScW\",\"ui-dialog-box-contents\":\"hub__ui-dialog-box-contents__PZ5qP\",\"uiDialogBoxContents\":\"hub__ui-dialog-box-contents__PZ5qP\",\"backgrounded\":\"hub__backgrounded__30IfD\",\"in-room-favorite-button\":\"hub__in-room-favorite-button__2T-zs\",\"inRoomFavoriteButton\":\"hub__in-room-favorite-button__2T-zs\",\"occupant-count\":\"hub__occupant-count__3eAEj\",\"occupantCount\":\"hub__occupant-count__3eAEj\",\"presence-info-selected\":\"hub__presence-info-selected__FRBSA\",\"presenceInfoSelected\":\"hub__presence-info-selected__FRBSA\",\"camera-mode-exit-button\":\"hub__camera-mode-exit-button__BqKKt\",\"cameraModeExitButton\":\"hub__camera-mode-exit-button__BqKKt\",\"corner-button-selected\":\"hub__corner-button-selected__Cqa93\",\"cornerButtonSelected\":\"hub__corner-button-selected__Cqa93\",\"invite-tip-attach-point\":\"hub__invite-tip-attach-point__2y_bz\",\"inviteTipAttachPoint\":\"hub__invite-tip-attach-point__2y_bz\",\"avatar-editor\":\"hub__avatar-editor__2b8-H\",\"avatarEditor\":\"hub__avatar-editor__2b8-H\",\"logo\":\"hub__logo__3kJSj\",\"form\":\"hub__form__3kQXh\",\"box\":\"hub__box__2SMbn\",\"links\":\"hub__links__1C6Ce\",\"darkened\":\"hub__darkened__1gqMQ\",\"display-name\":\"hub__display-name__36hFZ\",\"displayName\":\"hub__display-name__36hFZ\",\"preview\":\"hub__preview__2UUoU\",\"edit-avatar\":\"hub__edit-avatar__22A53\",\"editAvatar\":\"hub__edit-avatar__22A53\",\"close\":\"hub__close__gWtCN\",\"entry-dialog\":\"hub__entry-dialog__2Ljux\",\"entryDialog\":\"hub__entry-dialog__2Ljux\",\"favorited\":\"hub__favorited__3c3lB\",\"icon\":\"hub__icon__1pzf7\",\"bolded\":\"hub__bolded__2MYLZ\",\"subtitle\":\"hub__subtitle__3kYcd\",\"room-subtitle\":\"hub__room-subtitle__GhUCG\",\"roomSubtitle\":\"hub__room-subtitle__GhUCG\",\"lobby\":\"hub__lobby__2VW6G\",\"profile-icon\":\"hub__profile-icon__fwSfD\",\"profileIcon\":\"hub__profile-icon__fwSfD\",\"button-subtitle\":\"hub__button-subtitle__3kkpo\",\"buttonSubtitle\":\"hub__button-subtitle__3kkpo\",\"audio-loader\":\"hub__audio-loader__F5ovU\",\"audioLoader\":\"hub__audio-loader__F5ovU\",\"webvr-link-container\":\"hub__webvr-link-container__1Vq5m\",\"webvrLinkContainer\":\"hub__webvr-link-container__1Vq5m\",\"webvr-link\":\"hub__webvr-link__xW04U\",\"webvrLink\":\"hub__webvr-link__xW04U\",\"secondary\":\"hub__secondary__22yt_\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"touchZone\":\"virtual-gamepad-controls__touchZone__1KF_C\",\"left\":\"virtual-gamepad-controls__left__1-URB\",\"right\":\"virtual-gamepad-controls__right__1cgnU\",\"mockJoystickContainer\":\"virtual-gamepad-controls__mockJoystickContainer__1aH3e\",\"mockJoystick\":\"virtual-gamepad-controls__mockJoystick__2CuCG\",\"inner\":\"virtual-gamepad-controls__inner__1Bn3C\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"ui\":\"ui-root__ui__33CMU\",\"ui-dialog\":\"ui-root__ui-dialog__2TY9Y\",\"uiDialog\":\"ui-root__ui-dialog__2TY9Y\",\"ui-interactive\":\"ui-root__ui-interactive__2mtC4\",\"uiInteractive\":\"ui-root__ui-interactive__2mtC4\",\"presence-info\":\"ui-root__presence-info__3cieq\",\"presenceInfo\":\"ui-root__presence-info__3cieq\",\"corner-button\":\"ui-root__corner-button__2rfQ5\",\"cornerButton\":\"ui-root__corner-button__2rfQ5\",\"nag-corner-button\":\"ui-root__nag-corner-button__3TFW5\",\"nagCornerButton\":\"ui-root__nag-corner-button__3TFW5\",\"choose-scene-button\":\"ui-root__choose-scene-button__3VNdD\",\"chooseSceneButton\":\"ui-root__choose-scene-button__3VNdD\",\"leave-button\":\"ui-root__leave-button__29u2_\",\"leaveButton\":\"ui-root__leave-button__29u2_\",\"interstitial\":\"ui-root__interstitial__1cotl\",\"invite-tip\":\"ui-root__invite-tip__20NJ6\",\"inviteTip\":\"ui-root__invite-tip__20NJ6\",\"streaming-tip\":\"ui-root__streaming-tip__17WYl\",\"streamingTip\":\"ui-root__streaming-tip__17WYl\",\"streaming-tip-attach-point\":\"ui-root__streaming-tip-attach-point__3XSH-\",\"streamingTipAttachPoint\":\"ui-root__streaming-tip-attach-point__3XSH-\",\"streaming-tip-close\":\"ui-root__streaming-tip-close__1OHPc\",\"streamingTipClose\":\"ui-root__streaming-tip-close__1OHPc\",\"streaming-tip-message\":\"ui-root__streaming-tip-message__2XOUD\",\"streamingTipMessage\":\"ui-root__streaming-tip-message__2XOUD\",\"ui-dialog-box-contents\":\"ui-root__ui-dialog-box-contents__3XWtl\",\"uiDialogBoxContents\":\"ui-root__ui-dialog-box-contents__3XWtl\",\"backgrounded\":\"ui-root__backgrounded__34j0m\",\"in-room-favorite-button\":\"ui-root__in-room-favorite-button__2I0Kj\",\"inRoomFavoriteButton\":\"ui-root__in-room-favorite-button__2I0Kj\",\"occupant-count\":\"ui-root__occupant-count__34rGX\",\"occupantCount\":\"ui-root__occupant-count__34rGX\",\"presence-info-selected\":\"ui-root__presence-info-selected__1Jhbw\",\"presenceInfoSelected\":\"ui-root__presence-info-selected__1Jhbw\",\"camera-mode-exit-button\":\"ui-root__camera-mode-exit-button__2mpbz\",\"cameraModeExitButton\":\"ui-root__camera-mode-exit-button__2mpbz\",\"corner-button-selected\":\"ui-root__corner-button-selected__qRY5R\",\"cornerButtonSelected\":\"ui-root__corner-button-selected__qRY5R\",\"invite-tip-attach-point\":\"ui-root__invite-tip-attach-point__3rQJ6\",\"inviteTipAttachPoint\":\"ui-root__invite-tip-attach-point__3rQJ6\",\"avatar-editor\":\"ui-root__avatar-editor__2mO8z\",\"avatarEditor\":\"ui-root__avatar-editor__2mO8z\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"entry-button-secondary\":\"entry__entry-button-secondary__1Fr_E\",\"entryButtonSecondary\":\"entry__entry-button-secondary__1Fr_E\",\"entry-panel\":\"entry__entry-panel__34CD9\",\"entryPanel\":\"entry__entry-panel__34CD9\",\"button-container\":\"entry__button-container__3Blog\",\"buttonContainer\":\"entry__button-container__3Blog\",\"secondary-action-button\":\"entry__secondary-action-button__3FCMj\",\"secondaryActionButton\":\"entry__secondary-action-button__3FCMj\",\"entry-button\":\"entry__entry-button__G7PQF\",\"entryButton\":\"entry__entry-button__G7PQF\",\"action-button\":\"entry__action-button__3Vnab\",\"actionButton\":\"entry__action-button__3Vnab\",\"collapse-button\":\"entry__collapse-button__3_PLp\",\"collapseButton\":\"entry__collapse-button__3_PLp\",\"favorite-button\":\"entry__favorite-button__2CVuk\",\"favoriteButton\":\"entry__favorite-button__2CVuk\",\"back\":\"entry__back__J4Sgl\",\"lobby-label\":\"entry__lobby-label__2Nj9w\",\"lobbyLabel\":\"entry__lobby-label__2Nj9w\",\"label\":\"entry__label__fUhpb\",\"title\":\"entry__title__1GITj\",\"name\":\"entry__name__sYOeV\",\"rename-button\":\"entry__rename-button__KFW9R\",\"renameButton\":\"entry__rename-button__KFW9R\",\"center\":\"entry__center__1105W\",\"wide-button\":\"entry__wide-button__2tfMM\",\"wideButton\":\"entry__wide-button__2tfMM\",\"screen-sharing\":\"entry__screen-sharing__NBXQu\",\"screenSharing\":\"entry__screen-sharing__NBXQu\",\"checkbox\":\"entry__checkbox__3SoPk\",\"entry-dialog\":\"entry__entry-dialog__30kMs\",\"entryDialog\":\"entry__entry-dialog__30kMs\",\"favorited\":\"entry__favorited__2IHpj\",\"icon\":\"entry__icon__3JiUl\",\"bolded\":\"entry__bolded__13B4f\",\"subtitle\":\"entry__subtitle__1BC2y\",\"room-subtitle\":\"entry__room-subtitle__7MSMo\",\"roomSubtitle\":\"entry__room-subtitle__7MSMo\",\"lobby\":\"entry__lobby__3AxfL\",\"profile-icon\":\"entry__profile-icon__3BAWG\",\"profileIcon\":\"entry__profile-icon__3BAWG\",\"button-subtitle\":\"entry__button-subtitle__3zrEo\",\"buttonSubtitle\":\"entry__button-subtitle__3zrEo\",\"audio-loader\":\"entry__audio-loader__1YCJd\",\"audioLoader\":\"entry__audio-loader__1YCJd\",\"webvr-link-container\":\"entry__webvr-link-container__3scWP\",\"webvrLinkContainer\":\"entry__webvr-link-container__3scWP\",\"webvr-link\":\"entry__webvr-link__3eWuZ\",\"webvrLink\":\"entry__webvr-link__3eWuZ\",\"secondary\":\"entry__secondary__3uhYE\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"invite-container\":\"invite-dialog__invite-container__1c0Jw\",\"inviteContainer\":\"invite-dialog__invite-container__1c0Jw\",\"dialog\":\"invite-dialog__dialog__1XbxO\",\"link-button\":\"invite-dialog__link-button__S_o-t\",\"linkButton\":\"invite-dialog__link-button__S_o-t\",\"enter-vr-button\":\"invite-dialog__enter-vr-button__3y1BF\",\"enterVrButton\":\"invite-dialog__enter-vr-button__3y1BF\",\"invite-button\":\"invite-dialog__invite-button__3cjFw\",\"inviteButton\":\"invite-dialog__invite-button__3cjFw\",\"enter-button\":\"invite-dialog__enter-button__2Z5EY\",\"enterButton\":\"invite-dialog__enter-button__2Z5EY\",\"invite-mini-button\":\"invite-dialog__invite-mini-button__2zWJj\",\"inviteMiniButton\":\"invite-dialog__invite-mini-button__2zWJj\",\"domain\":\"invite-dialog__domain__2Q8Wr\",\"embed-text\":\"invite-dialog__embed-text__3-Boo\",\"embedText\":\"invite-dialog__embed-text__3-Boo\",\"invite-container-inverted\":\"invite-dialog__invite-container-inverted__1E3hR\",\"inviteContainerInverted\":\"invite-dialog__invite-container-inverted__1E3hR\",\"subscribe\":\"invite-dialog__subscribe__qlJL4\",\"embed-tip-wrap\":\"invite-dialog__embed-tip-wrap__2CQRc\",\"embedTipWrap\":\"invite-dialog__embed-tip-wrap__2CQRc\",\"embed-tip\":\"invite-dialog__embed-tip__12p0o\",\"embedTip\":\"invite-dialog__embed-tip__12p0o\",\"modal\":\"invite-dialog__modal__1hbVP\",\"hide-small-screens\":\"invite-dialog__hide-small-screens__3UCeH\",\"hideSmallScreens\":\"invite-dialog__hide-small-screens__3UCeH\",\"invite-container-below-hud\":\"invite-dialog__invite-container-below-hud__30RHX\",\"inviteContainerBelowHud\":\"invite-dialog__invite-container-below-hud__30RHX\",\"attach-point\":\"invite-dialog__attach-point__otyII\",\"attachPoint\":\"invite-dialog__attach-point__otyII\",\"code\":\"invite-dialog__code__13AIx\",\"keep-open\":\"invite-dialog__keep-open__229sO\",\"keepOpen\":\"invite-dialog__keep-open__229sO\",\"digit\":\"invite-dialog__digit__2w64P\",\"digit_2\":\"invite-dialog__digit_2__pQCJ3\",\"digit2\":\"invite-dialog__digit_2__pQCJ3\",\"digit_3\":\"invite-dialog__digit_3__1bWtt\",\"digit3\":\"invite-dialog__digit_3__1bWtt\",\"code-loading-panel\":\"invite-dialog__code-loading-panel__1gghm\",\"codeLoadingPanel\":\"invite-dialog__code-loading-panel__1gghm\",\"hub-link-link\":\"invite-dialog__hub-link-link__2guVF\",\"hubLinkLink\":\"invite-dialog__hub-link-link__2guVF\",\"buttons\":\"invite-dialog__buttons__1yN_j\",\"embed\":\"invite-dialog__embed__2zy_A\",\"close\":\"invite-dialog__close__3PAxl\",\"embed-tip-attach-point\":\"invite-dialog__embed-tip-attach-point__2UAZp\",\"embedTipAttachPoint\":\"invite-dialog__embed-tip-attach-point__2UAZp\"};","function loadAsync(loader, url, onProgress) {\n  return new Promise((resolve, reject) => loader.load(url, resolve, onProgress, reject));\n}\n\nexport default class HubsTextureLoader {\n  static crossOrigin = \"anonymous\";\n\n  constructor(manager = THREE.DefaultLoadingManager) {\n    this.manager = manager;\n  }\n\n  load(url, onLoad, onProgress, onError) {\n    const texture = new THREE.Texture();\n\n    this.loadTextureAsync(texture, url, onProgress)\n      .then(onLoad)\n      .catch(onError);\n\n    return texture;\n  }\n\n  async loadTextureAsync(texture, src, onProgress) {\n    let imageLoader;\n\n    if (window.createImageBitmap !== undefined) {\n      imageLoader = new THREE.ImageBitmapLoader(this.manager);\n      texture.flipY = false;\n    } else {\n      imageLoader = new THREE.ImageLoader(this.manager);\n    }\n\n    imageLoader.setCrossOrigin(this.crossOrigin);\n    imageLoader.setPath(this.path);\n\n    const cacheKey = this.manager.resolveURL(src);\n\n    texture.image = await loadAsync(imageLoader, src, onProgress);\n\n    // Image was just added to cache before this function gets called, disable caching by immediatly removing it\n    THREE.Cache.remove(cacheKey);\n\n    texture.needsUpdate = true;\n\n    texture.onUpdate = function() {\n      // Delete texture data once it has been uploaded to the GPU\n      texture.image.close && texture.image.close();\n      delete texture.image;\n    };\n\n    return texture;\n  }\n\n  setCrossOrigin(value) {\n    this.crossOrigin = value;\n    return this;\n  }\n\n  setPath(value) {\n    this.path = value;\n    return this;\n  }\n}\n","import { objectTypeForOriginAndContentType } from \"../object-types\";\nimport { getReticulumFetchUrl } from \"./phoenix-utils\";\nimport mediaHighlightFrag from \"./media-highlight-frag.glsl\";\nimport { mapMaterials } from \"./material-utils\";\nimport HubsTextureLoader from \"../loaders/HubsTextureLoader\";\nimport { validMaterials } from \"../components/hoverable-visuals\";\n\nconst mediaAPIEndpoint = getReticulumFetchUrl(\"/api/v1/media\");\n\n// Map<String, Promise<Object>\nconst resolveUrlCache = new Map();\nexport const resolveUrl = async (url, index) => {\n  const cacheKey = `${url}|${index}`;\n  if (resolveUrlCache.has(cacheKey)) return resolveUrlCache.get(cacheKey);\n\n  const resultPromise = fetch(mediaAPIEndpoint, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({ media: { url, index } })\n  }).then(async response => {\n    if (!response.ok) {\n      const message = `Error resolving url \"${url}\":`;\n      try {\n        const body = await response.text();\n        throw new Error(message + \" \" + body);\n      } catch (e) {\n        throw new Error(message + \" \" + response.statusText);\n      }\n    }\n    return response.json();\n  });\n\n  resolveUrlCache.set(cacheKey, resultPromise);\n  return resultPromise;\n};\n\nexport const upload = (file, desiredContentType) => {\n  const formData = new FormData();\n  formData.append(\"media\", file);\n  formData.append(\"promotion_mode\", \"with_token\");\n\n  if (desiredContentType) {\n    formData.append(\"desired_content_type\", desiredContentType);\n  }\n\n  return fetch(mediaAPIEndpoint, {\n    method: \"POST\",\n    body: formData\n  }).then(r => r.json());\n};\n\n// https://stackoverflow.com/questions/7584794/accessing-jpeg-exif-rotation-data-in-javascript-on-the-client-side/32490603#32490603\nfunction getOrientation(file, callback) {\n  const reader = new FileReader();\n  reader.onload = function(e) {\n    const view = new DataView(e.target.result);\n    if (view.getUint16(0, false) != 0xffd8) {\n      return callback(-2);\n    }\n    const length = view.byteLength;\n    let offset = 2;\n    while (offset < length) {\n      if (view.getUint16(offset + 2, false) <= 8) return callback(-1);\n      const marker = view.getUint16(offset, false);\n      offset += 2;\n      if (marker == 0xffe1) {\n        if (view.getUint32((offset += 2), false) != 0x45786966) {\n          return callback(-1);\n        }\n\n        const little = view.getUint16((offset += 6), false) == 0x4949;\n        offset += view.getUint32(offset + 4, little);\n        const tags = view.getUint16(offset, little);\n        offset += 2;\n        for (let i = 0; i < tags; i++) {\n          if (view.getUint16(offset + i * 12, little) == 0x0112) {\n            return callback(view.getUint16(offset + i * 12 + 8, little));\n          }\n        }\n      } else if ((marker & 0xff00) != 0xff00) {\n        break;\n      } else {\n        offset += view.getUint16(offset, false);\n      }\n    }\n    return callback(-1);\n  };\n  reader.readAsArrayBuffer(file);\n}\n\nlet interactableId = 0;\nexport const addMedia = (\n  src,\n  template,\n  contentOrigin,\n  contentSubtype = null,\n  resolve = false,\n  resize = false,\n  animate = true\n) => {\n  const scene = AFRAME.scenes[0];\n\n  const entity = document.createElement(\"a-entity\");\n  entity.id = \"interactable-media-\" + interactableId++;\n  entity.setAttribute(\"networked\", { template: template });\n  const needsToBeUploaded = src instanceof File;\n  entity.setAttribute(\"media-loader\", {\n    resize,\n    resolve,\n    animate,\n    src: typeof src === \"string\" ? src : \"\",\n    contentSubtype,\n    fileIsOwned: !needsToBeUploaded\n  });\n\n  entity.object3D.matrixNeedsUpdate = true;\n\n  scene.appendChild(entity);\n\n  const fireLoadingTimeout = setTimeout(() => {\n    scene.emit(\"media-loading\", { src: src });\n  }, 100);\n\n  [\"model-loaded\", \"video-loaded\", \"image-loaded\"].forEach(eventName => {\n    entity.addEventListener(\n      eventName,\n      async () => {\n        clearTimeout(fireLoadingTimeout);\n        scene.emit(\"media-loaded\", { src: src });\n      },\n      { once: true }\n    );\n  });\n\n  const orientation = new Promise(function(resolve) {\n    if (needsToBeUploaded) {\n      getOrientation(src, x => {\n        resolve(x);\n      });\n    } else {\n      resolve(1);\n    }\n  });\n  if (needsToBeUploaded) {\n    // Video camera videos are converted to mp4 for compatibility\n    const desiredContentType = contentSubtype === \"video-camera\" ? \"video/mp4\" : null;\n\n    upload(src, desiredContentType)\n      .then(response => {\n        const srcUrl = new URL(response.raw);\n        srcUrl.searchParams.set(\"token\", response.meta.access_token);\n        entity.setAttribute(\"media-loader\", { resolve: false, src: srcUrl.href, fileId: response.file_id });\n        window.APP.store.update({\n          uploadPromotionTokens: [{ fileId: response.file_id, promotionToken: response.meta.promotion_token }]\n        });\n      })\n      .catch(e => {\n        console.error(\"Media upload failed\", e);\n        entity.setAttribute(\"media-loader\", { src: \"error\" });\n      });\n  } else if (src instanceof MediaStream) {\n    entity.setAttribute(\"media-loader\", { src: `hubs://clients/${NAF.clientId}/video` });\n  }\n\n  if (contentOrigin) {\n    entity.addEventListener(\"media_resolved\", ({ detail }) => {\n      const objectType = objectTypeForOriginAndContentType(contentOrigin, detail.contentType, detail.src);\n      scene.emit(\"object_spawned\", { objectType });\n    });\n  }\n\n  return { entity, orientation };\n};\n\nexport function injectCustomShaderChunks(obj) {\n  const vertexRegex = /\\bskinning_vertex\\b/;\n  const fragRegex = /\\bgl_FragColor\\b/;\n\n  const shaderUniforms = [];\n  const batchManagerSystem = AFRAME.scenes[0].systems[\"hubs-systems\"].batchManagerSystem;\n\n  obj.traverse(object => {\n    if (!object.material) return;\n\n    object.material = mapMaterials(object, material => {\n      if (!validMaterials.includes(material.type)) {\n        return material;\n      }\n\n      // HACK, this routine inadvertently leaves the A-Frame shaders wired to the old, dark\n      // material, so maps cannot be updated at runtime. This breaks UI elements who have\n      // hover/toggle state, so for now just skip these while we figure out a more correct\n      // solution.\n      if (\n        object.el.classList.contains(\"ui\") ||\n        object.el.classList.contains(\"hud\") ||\n        object.el.getAttribute(\"text-button\")\n      )\n        return material;\n\n      // Used when the object is batched\n      batchManagerSystem.meshToEl.set(object, obj.el);\n\n      const newMaterial = material.clone();\n      // This will not run if the object is never rendered unbatched, since its unbatched shader will never be compiled\n      newMaterial.onBeforeCompile = shader => {\n        if (!vertexRegex.test(shader.vertexShader)) return;\n\n        shader.uniforms.hubs_IsFrozen = { value: false };\n        shader.uniforms.hubs_EnableSweepingEffect = { value: false };\n        shader.uniforms.hubs_SweepParams = { value: [0, 0] };\n        shader.uniforms.hubs_InteractorOnePos = { value: [0, 0, 0] };\n        shader.uniforms.hubs_InteractorTwoPos = { value: [0, 0, 0] };\n        shader.uniforms.hubs_HighlightInteractorOne = { value: false };\n        shader.uniforms.hubs_HighlightInteractorTwo = { value: false };\n        shader.uniforms.hubs_Time = { value: 0 };\n\n        const vchunk = `\n        if (hubs_HighlightInteractorOne || hubs_HighlightInteractorTwo || hubs_IsFrozen) {\n          vec4 wt = modelMatrix * vec4(transformed, 1);\n\n          // Used in the fragment shader below.\n          hubs_WorldPosition = wt.xyz;\n        }\n      `;\n\n        const vlines = shader.vertexShader.split(\"\\n\");\n        const vindex = vlines.findIndex(line => vertexRegex.test(line));\n        vlines.splice(vindex + 1, 0, vchunk);\n        vlines.unshift(\"varying vec3 hubs_WorldPosition;\");\n        vlines.unshift(\"uniform bool hubs_IsFrozen;\");\n        vlines.unshift(\"uniform bool hubs_HighlightInteractorOne;\");\n        vlines.unshift(\"uniform bool hubs_HighlightInteractorTwo;\");\n        shader.vertexShader = vlines.join(\"\\n\");\n\n        const flines = shader.fragmentShader.split(\"\\n\");\n        const findex = flines.findIndex(line => fragRegex.test(line));\n        flines.splice(findex + 1, 0, mediaHighlightFrag);\n        flines.unshift(\"varying vec3 hubs_WorldPosition;\");\n        flines.unshift(\"uniform bool hubs_IsFrozen;\");\n        flines.unshift(\"uniform bool hubs_EnableSweepingEffect;\");\n        flines.unshift(\"uniform vec2 hubs_SweepParams;\");\n        flines.unshift(\"uniform bool hubs_HighlightInteractorOne;\");\n        flines.unshift(\"uniform vec3 hubs_InteractorOnePos;\");\n        flines.unshift(\"uniform bool hubs_HighlightInteractorTwo;\");\n        flines.unshift(\"uniform vec3 hubs_InteractorTwoPos;\");\n        flines.unshift(\"uniform float hubs_Time;\");\n        shader.fragmentShader = flines.join(\"\\n\");\n\n        shaderUniforms.push(shader.uniforms);\n      };\n      newMaterial.needsUpdate = true;\n      return newMaterial;\n    });\n  });\n\n  return shaderUniforms;\n}\n\nexport function getPromotionTokenForFile(fileId) {\n  return window.APP.store.state.uploadPromotionTokens.find(upload => upload.fileId === fileId);\n}\n\nconst mediaPos = new THREE.Vector3();\n\nexport function addAndArrangeMedia(el, media, contentSubtype, snapCount, mirrorOrientation = false) {\n  const { entity, orientation } = addMedia(media, \"#interactable-media\", undefined, contentSubtype, false);\n\n  const pos = el.object3D.position;\n\n  entity.object3D.position.set(pos.x, pos.y, pos.z);\n  entity.object3D.rotation.copy(el.object3D.rotation);\n\n  if (mirrorOrientation) {\n    entity.object3D.rotateY(Math.PI);\n  }\n\n  // Generate photos in a circle around camera, starting from the bottom.\n  // Prevent z-fighting but place behind viewfinder\n  const idx = (snapCount % 6) + 3;\n\n  mediaPos.set(\n    Math.cos(Math.PI * 2 * (idx / 6.0)) * 0.75,\n    Math.sin(Math.PI * 2 * (idx / 6.0)) * 0.75,\n    -0.05 + idx * 0.001\n  );\n\n  el.object3D.localToWorld(mediaPos);\n  entity.object3D.visible = false;\n\n  const handler = () => {\n    entity.object3D.visible = true;\n    entity.setAttribute(\"animation__photo_pos\", {\n      property: \"position\",\n      dur: 800,\n      from: { x: pos.x, y: pos.y, z: pos.z },\n      to: { x: mediaPos.x, y: mediaPos.y, z: mediaPos.z },\n      easing: \"easeOutElastic\"\n    });\n  };\n\n  let eventType = null;\n\n  if (contentSubtype.startsWith(\"photo\")) {\n    entity.addEventListener(\"image-loaded\", handler, { once: true });\n    eventType = \"photo\";\n  } else if (contentSubtype.startsWith(\"video\")) {\n    entity.addEventListener(\"video-loaded\", handler, { once: true });\n    eventType = \"video\";\n  } else {\n    console.error(\"invalid type \" + contentSubtype);\n    return;\n  }\n\n  entity.object3D.matrixNeedsUpdate = true;\n\n  entity.addEventListener(\n    \"media_resolved\",\n    () => {\n      el.emit(`${eventType}_taken`, entity.components[\"media-loader\"].data.src);\n    },\n    { once: true }\n  );\n\n  return { entity, orientation };\n}\n\nexport const textureLoader = new HubsTextureLoader().setCrossOrigin(\"anonymous\");\n\nexport async function createImageTexture(url) {\n  const texture = new THREE.Texture();\n\n  try {\n    await textureLoader.loadTextureAsync(texture, url);\n  } catch (e) {\n    throw new Error(`'${url}' could not be fetched (Error code: ${e.status}; Response: ${e.statusText})`);\n  }\n\n  texture.encoding = THREE.sRGBEncoding;\n  texture.anisotropy = 4;\n\n  return texture;\n}\n","// removed by extract-text-webpack-plugin\nmodule.exports = {\"cancel-button\":\"promote-client-dialog__cancel-button__3YZLa\",\"cancelButton\":\"promote-client-dialog__cancel-button__3YZLa\",\"confirm-button\":\"promote-client-dialog__confirm-button__3LXvQ\",\"confirmButton\":\"promote-client-dialog__confirm-button__3LXvQ\",\"message\":\"promote-client-dialog__message__1LA_N\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"client-action-buttons\":\"client-info-dialog__client-action-buttons__3u-6v\",\"clientActionButtons\":\"client-info-dialog__client-action-buttons__3u-6v\",\"cancel\":\"client-info-dialog__cancel__2BguV\",\"client-info-dialog\":\"client-info-dialog__client-info-dialog__2e1dc\",\"clientInfoDialog\":\"client-info-dialog__client-info-dialog__2e1dc\",\"title\":\"client-info-dialog__title__3FGPe\",\"community-identifier\":\"client-info-dialog__community-identifier__g3lbP\",\"communityIdentifier\":\"client-info-dialog__community-identifier__g3lbP\",\"client-info\":\"client-info-dialog__client-info__1MUSa\",\"clientInfo\":\"client-info-dialog__client-info__1MUSa\",\"client-profile-image\":\"client-info-dialog__client-profile-image__zt1EA\",\"clientProfileImage\":\"client-info-dialog__client-profile-image__zt1EA\",\"client-details\":\"client-info-dialog__client-details__1F5zy\",\"clientDetails\":\"client-info-dialog__client-details__1F5zy\",\"client-main\":\"client-info-dialog__client-main__2BC1s\",\"clientMain\":\"client-info-dialog__client-main__2BC1s\",\"button-icon\":\"client-info-dialog__button-icon__1vKfx\",\"buttonIcon\":\"client-info-dialog__button-icon__1vKfx\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"loading-text\":\"loader__loading-text__QVcF3\",\"loadingText\":\"loader__loading-text__QVcF3\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"profile-entry\":\"profile__profile-entry__1pJKZ\",\"profileEntry\":\"profile__profile-entry__1pJKZ\",\"form-submit\":\"profile__form-submit__2y7xb\",\"formSubmit\":\"profile__form-submit__2y7xb\",\"choose-avatar\":\"profile__choose-avatar__2EV0F\",\"chooseAvatar\":\"profile__choose-avatar__2EV0F\",\"form-field-text\":\"profile__form-field-text__1bzeV\",\"formFieldText\":\"profile__form-field-text__1bzeV\",\"title\":\"profile__title__Vcynv\",\"logo\":\"profile__logo__1JZAd\",\"form\":\"profile__form__1-hBO\",\"box\":\"profile__box__oJXQD\",\"links\":\"profile__links__2hukW\",\"darkened\":\"profile__darkened__1rVba\",\"display-name\":\"profile__display-name__auABh\",\"displayName\":\"profile__display-name__auABh\",\"preview\":\"profile__preview__3QjLq\",\"edit-avatar\":\"profile__edit-avatar__3386A\",\"editAvatar\":\"profile__edit-avatar__3386A\",\"close\":\"profile__close__2Uitz\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"preview\":\"avatar-preview__preview__2I8qx\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"action-button\":\"create-object-dialog__action-button__3OIJQ\",\"actionButton\":\"create-object-dialog__action-button__3OIJQ\",\"buttons\":\"create-object-dialog__buttons__1zA-b\",\"small-button\":\"create-object-dialog__small-button__7UxXQ\",\"smallButton\":\"create-object-dialog__small-button__7UxXQ\",\"input-border\":\"create-object-dialog__input-border__1N9AV\",\"inputBorder\":\"create-object-dialog__input-border__1N9AV\",\"left-side-of-input\":\"create-object-dialog__left-side-of-input__zyV06\",\"leftSideOfInput\":\"create-object-dialog__left-side-of-input__zyV06\",\"add-media-form\":\"create-object-dialog__add-media-form__10Wh-\",\"addMediaForm\":\"create-object-dialog__add-media-form__10Wh-\",\"cancel-icon\":\"create-object-dialog__cancel-icon__yD-8A\",\"cancelIcon\":\"create-object-dialog__cancel-icon__yD-8A\",\"upload-icon\":\"create-object-dialog__upload-icon__19g9k\",\"uploadIcon\":\"create-object-dialog__upload-icon__19g9k\",\"hide-file-input\":\"create-object-dialog__hide-file-input__2myDe\",\"hideFileInput\":\"create-object-dialog__hide-file-input__2myDe\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"action-button\":\"change-scene-dialog__action-button__1xtdK\",\"actionButton\":\"change-scene-dialog__action-button__1xtdK\",\"buttons\":\"change-scene-dialog__buttons__2QE34\",\"spoke-launch\":\"change-scene-dialog__spoke-launch__YObDn\",\"spokeLaunch\":\"change-scene-dialog__spoke-launch__YObDn\",\"input-border\":\"change-scene-dialog__input-border__30jd6\",\"inputBorder\":\"change-scene-dialog__input-border__30jd6\",\"left-side-of-input\":\"change-scene-dialog__left-side-of-input__14WKu\",\"leftSideOfInput\":\"change-scene-dialog__left-side-of-input__14WKu\",\"change-scene-button\":\"change-scene-dialog__change-scene-button__ckfZW\",\"changeSceneButton\":\"change-scene-dialog__change-scene-button__ckfZW\",\"spoke-create\":\"change-scene-dialog__spoke-create__2krL-\",\"spokeCreate\":\"change-scene-dialog__spoke-create__2krL-\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"avatar-url-dialog\":\"avatar-url-dialog__avatar-url-dialog__17OoD\",\"avatarUrlDialog\":\"avatar-url-dialog__avatar-url-dialog__17OoD\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"close-button\":\"link-dialog__close-button__2THTw\",\"closeButton\":\"link-dialog__close-button__2THTw\",\"domain\":\"link-dialog__domain__1WbPJ\",\"dialog\":\"link-dialog__dialog__1zbyG\",\"header\":\"link-dialog__header__1A06x\",\"contents\":\"link-dialog__contents__3ODVz\",\"code\":\"link-dialog__code__259RI\",\"imageHeader\":\"link-dialog__imageHeader__eaJe6\",\"keep-open\":\"link-dialog__keep-open__DYcUI\",\"keepOpen\":\"link-dialog__keep-open__DYcUI\",\"digit\":\"link-dialog__digit___zoC4\",\"code-loading-panel\":\"link-dialog__code-loading-panel__WKkNk\",\"codeLoadingPanel\":\"link-dialog__code-loading-panel__WKkNk\",\"close\":\"link-dialog__close__2TTmg\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"name-field\":\"room-settings-dialog__name-field___yGhb\",\"nameField\":\"room-settings-dialog__name-field___yGhb\",\"next-button\":\"room-settings-dialog__next-button__2F9Jd\",\"nextButton\":\"room-settings-dialog__next-button__2F9Jd\",\"continue-button\":\"room-settings-dialog__continue-button__2Ltsg\",\"continueButton\":\"room-settings-dialog__continue-button__2Ltsg\",\"room-settings-form\":\"room-settings-dialog__room-settings-form__yNism\",\"roomSettingsForm\":\"room-settings-dialog__room-settings-form__yNism\",\"permission\":\"room-settings-dialog__permission__3W-cW\",\"subtitle\":\"room-settings-dialog__subtitle__2ddy2\",\"permissions\":\"room-settings-dialog__permissions__1sHPN\",\"permissions-group\":\"room-settings-dialog__permissions-group__1oRYA\",\"permissionsGroup\":\"room-settings-dialog__permissions-group__1oRYA\",\"permission-disabled\":\"room-settings-dialog__permission-disabled__3NH-j\",\"permissionDisabled\":\"room-settings-dialog__permission-disabled__3NH-j\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"cancel-button\":\"close-room-dialog__cancel-button__MmtAo\",\"cancelButton\":\"close-room-dialog__cancel-button__MmtAo\",\"confirm-button\":\"close-room-dialog__confirm-button__Bs9y3\",\"confirmButton\":\"close-room-dialog__confirm-button__Bs9y3\",\"message\":\"close-room-dialog__message__1Rvh3\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"tip-root\":\"tip__tip-root__1s7D1\",\"tipRoot\":\"tip__tip-root__1s7D1\",\"tip-link\":\"tip__tip-link__3m4Iq\",\"tipLink\":\"tip__tip-link__3m4Iq\",\"tip-cancel\":\"tip__tip-cancel__1xPNP\",\"tipCancel\":\"tip__tip-cancel__1xPNP\",\"tip\":\"tip__tip__32KOl\",\"split-tip\":\"tip__split-tip__1xSCE\",\"splitTip\":\"tip__split-tip__1xSCE\",\"split-tip-icon\":\"tip__split-tip-icon__1ZXw0\",\"splitTipIcon\":\"tip__split-tip-icon__1ZXw0\",\"spawn_menu-icon\":\"tip__spawn_menu-icon__2en_9\",\"spawnMenuIcon\":\"tip__spawn_menu-icon__2en_9\",\"object_rotate_button-icon\":\"tip__object_rotate_button-icon__2tgeV\",\"objectRotateButtonIcon\":\"tip__object_rotate_button-icon__2tgeV\",\"object_scale_button-icon\":\"tip__object_scale_button-icon__pxKrw\",\"objectScaleButtonIcon\":\"tip__object_scale_button-icon__pxKrw\",\"object_recenter_button-icon\":\"tip__object_recenter_button-icon__38tNR\",\"objectRecenterButtonIcon\":\"tip__object_recenter_button-icon__38tNR\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"form-frame\":\"feedback-dialog__form-frame__1gfk_\",\"formFrame\":\"feedback-dialog__form-frame__1gfk_\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"leave-room\":\"leave-room-dialog__leave-room__31Jf7\",\"leaveRoom\":\"leave-room-dialog__leave-room__31Jf7\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"title\":\"room-info-dialog__title__3-3CO\",\"room-info\":\"room-info-dialog__room-info__3XkbS\",\"roomInfo\":\"room-info-dialog__room-info__3XkbS\",\"scene-screenshot\":\"room-info-dialog__scene-screenshot__3PWz-\",\"sceneScreenshot\":\"room-info-dialog__scene-screenshot__3PWz-\",\"scene-details\":\"room-info-dialog__scene-details__2pYml\",\"sceneDetails\":\"room-info-dialog__scene-details__2pYml\",\"scene-main\":\"room-info-dialog__scene-main__2mhXj\",\"sceneMain\":\"room-info-dialog__scene-main__2mhXj\",\"scene-name\":\"room-info-dialog__scene-name__1bqGh\",\"sceneName\":\"room-info-dialog__scene-name__1bqGh\",\"scene-creator\":\"room-info-dialog__scene-creator__3_za4\",\"sceneCreator\":\"room-info-dialog__scene-creator__3_za4\",\"scene-attributions\":\"room-info-dialog__scene-attributions__QpYVd\",\"sceneAttributions\":\"room-info-dialog__scene-attributions__QpYVd\",\"attribution\":\"room-info-dialog__attribution__I9_V-\",\"attribution-name\":\"room-info-dialog__attribution-name__3JTpI\",\"attributionName\":\"room-info-dialog__attribution-name__3JTpI\",\"attribution-author\":\"room-info-dialog__attribution-author__BouZB\",\"attributionAuthor\":\"room-info-dialog__attribution-author__BouZB\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"oauth-discord-button\":\"oauth-dialog__oauth-discord-button__A_Zra\",\"oauthDiscordButton\":\"oauth-dialog__oauth-discord-button__A_Zra\",\"oauth-twitter-button\":\"oauth-dialog__oauth-twitter-button__Vh4oX\",\"oauthTwitterButton\":\"oauth-dialog__oauth-twitter-button__Vh4oX\",\"oauth-button\":\"oauth-dialog__oauth-button__25RiO\",\"oauthButton\":\"oauth-dialog__oauth-button__25RiO\",\"oauth-type-name\":\"oauth-dialog__oauth-type-name__jPyhW\",\"oauthTypeName\":\"oauth-dialog__oauth-type-name__jPyhW\",\"oauth-icon\":\"oauth-dialog__oauth-icon__v1G6W\",\"oauthIcon\":\"oauth-dialog__oauth-icon__v1G6W\",\"privacy-notice\":\"oauth-dialog__privacy-notice__2R9ZT\",\"privacyNotice\":\"oauth-dialog__privacy-notice__2R9ZT\",\"oauth-buttons\":\"oauth-dialog__oauth-buttons__1U1Ni\",\"oauthButtons\":\"oauth-dialog__oauth-buttons__1U1Ni\",\"twitter-message\":\"oauth-dialog__twitter-message__cWCES\",\"twitterMessage\":\"oauth-dialog__twitter-message__cWCES\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"buttons\":\"tweet-dialog__buttons__1gYv2\",\"tweet-button\":\"tweet-dialog__tweet-button__3XvNj\",\"tweetButton\":\"tweet-dialog__tweet-button__3XvNj\",\"tweet\":\"tweet-dialog__tweet__25N6e\",\"editor\":\"tweet-dialog__editor__3xJV-\",\"editor-inner\":\"tweet-dialog__editor-inner__1Zhzc\",\"editorInner\":\"tweet-dialog__editor-inner__1Zhzc\",\"emoji-button\":\"tweet-dialog__emoji-button__2L9tR\",\"emojiButton\":\"tweet-dialog__emoji-button__2L9tR\",\"counter\":\"tweet-dialog__counter__2OZyX\",\"highlight\":\"tweet-dialog__highlight__1EXxs\",\"media\":\"tweet-dialog__media__IeN9e\",\"posted\":\"tweet-dialog__posted__2t8RC\",\"tweet-loader\":\"tweet-dialog__tweet-loader__3Q8YL\",\"tweetLoader\":\"tweet-dialog__tweet-loader__3Q8YL\",\"dialog-background\":\"tweet-dialog__dialog-background__2vvyQ\",\"dialogBackground\":\"tweet-dialog__dialog-background__2vvyQ\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"message-entry-in-room\":\"message-entry__message-entry-in-room__1aN5s\",\"messageEntryInRoom\":\"message-entry__message-entry-in-room__1aN5s\",\"message-entry-spawn\":\"message-entry__message-entry-spawn__1_AF5\",\"messageEntrySpawn\":\"message-entry__message-entry-spawn__1_AF5\",\"message-entry-input\":\"message-entry__message-entry-input__2AtQE\",\"messageEntryInput\":\"message-entry__message-entry-input__2AtQE\",\"message-entry\":\"message-entry__message-entry__x7lQX\",\"messageEntry\":\"message-entry__message-entry__x7lQX\",\"message-entry-disabled\":\"message-entry__message-entry-disabled__25LSI\",\"messageEntryDisabled\":\"message-entry__message-entry-disabled__25LSI\",\"message-entry-button\":\"message-entry__message-entry-button__3xJhH\",\"messageEntryButton\":\"message-entry__message-entry-button__3xJhH\",\"message-entry-button-in-room\":\"message-entry__message-entry-button-in-room__2yMTR\",\"messageEntryButtonInRoom\":\"message-entry__message-entry-button-in-room__2yMTR\",\"message-entry-upload\":\"message-entry__message-entry-upload__3F0sX\",\"messageEntryUpload\":\"message-entry__message-entry-upload__3F0sX\",\"message-entry-input-in-room\":\"message-entry__message-entry-input-in-room__30ReF\",\"messageEntryInputInRoom\":\"message-entry__message-entry-input-in-room__30ReF\",\"message-entry-input-no-spawn\":\"message-entry__message-entry-input-no-spawn__1wF7R\",\"messageEntryInputNoSpawn\":\"message-entry__message-entry-input-no-spawn__1wF7R\",\"message-entry-on-mobile\":\"message-entry__message-entry-on-mobile__2pSYF\",\"messageEntryOnMobile\":\"message-entry__message-entry-on-mobile__2pSYF\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"command-help\":\"chat-command-help__command-help__q0Wb8\",\"commandHelp\":\"chat-command-help__command-help__q0Wb8\",\"entry\":\"chat-command-help__entry__1E1un\",\"command\":\"chat-command-help__command__2GMyn\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"presence-log\":\"presence-log__presence-log__10oFj\",\"presenceLog\":\"presence-log__presence-log__10oFj\",\"presence-log-entry\":\"presence-log__presence-log-entry__dt0t4\",\"presenceLogEntry\":\"presence-log__presence-log-entry__dt0t4\",\"message-body\":\"presence-log__message-body__2L9jA\",\"messageBody\":\"presence-log__message-body__2L9jA\",\"message-body-multi\":\"presence-log__message-body-multi__2e-Sx\",\"messageBodyMulti\":\"presence-log__message-body-multi__2e-Sx\",\"message-body-mono\":\"presence-log__message-body-mono__3zuQE\",\"messageBodyMono\":\"presence-log__message-body-mono__3zuQE\",\"message-wrap\":\"presence-log__message-wrap__2aWCa\",\"messageWrap\":\"presence-log__message-wrap__2aWCa\",\"message-wrap-multi\":\"presence-log__message-wrap-multi__1eA6v\",\"messageWrapMulti\":\"presence-log__message-wrap-multi__1eA6v\",\"message-source\":\"presence-log__message-source__3CI4d\",\"messageSource\":\"presence-log__message-source__3CI4d\",\"message-source-link\":\"presence-log__message-source-link__1evTZ\",\"messageSourceLink\":\"presence-log__message-source-link__1evTZ\",\"icon-button\":\"presence-log__icon-button__2Shbm\",\"iconButton\":\"presence-log__icon-button__2Shbm\",\"spawn-message\":\"presence-log__spawn-message__14Ne8\",\"spawnMessage\":\"presence-log__spawn-message__14Ne8\",\"share\":\"presence-log__share__37U7E\",\"media\":\"presence-log__media__2qG_d\",\"mediaBody\":\"presence-log__mediaBody__1rByA\",\"expired\":\"presence-log__expired__2wMJc\",\"presence-log-entry-with-button\":\"presence-log__presence-log-entry-with-button__1PxTw\",\"presenceLogEntryWithButton\":\"presence-log__presence-log-entry-with-button__1PxTw\",\"presence-log-in-room\":\"presence-log__presence-log-in-room__17h3n\",\"presenceLogInRoom\":\"presence-log__presence-log-in-room__17h3n\",\"presence-log-spawn\":\"presence-log__presence-log-spawn__3jlmT\",\"presenceLogSpawn\":\"presence-log__presence-log-spawn__3jlmT\",\"presence-log-entry-one-line\":\"presence-log__presence-log-entry-one-line__bRXfp\",\"presenceLogEntryOneLine\":\"presence-log__presence-log-entry-one-line__bRXfp\",\"presence-log-emoji\":\"presence-log__presence-log-emoji__1_3Yn\",\"presenceLogEmoji\":\"presence-log__presence-log-emoji__1_3Yn\",\"emoji\":\"presence-log__emoji__10b18\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"client-link\":\"presence-list__client-link__3tkyz\",\"clientLink\":\"presence-list__client-link__3tkyz\",\"presence-list\":\"presence-list__presence-list__1KERe\",\"presenceList\":\"presence-list__presence-list__1KERe\",\"attach-point\":\"presence-list__attach-point__kIdfx\",\"attachPoint\":\"presence-list__attach-point__kIdfx\",\"contents\":\"presence-list__contents__1B7bz\",\"rows\":\"presence-list__rows__1B6KS\",\"row\":\"presence-list__row__1D2j2\",\"row-header\":\"presence-list__row-header__3kl1w\",\"rowHeader\":\"presence-list__row-header__3kl1w\",\"list-item\":\"presence-list__list-item__2YARP\",\"listItem\":\"presence-list__list-item__2YARP\",\"list-item-link\":\"presence-list__list-item-link__2DLC2\",\"listItemLink\":\"presence-list__list-item-link__2DLC2\",\"presence\":\"presence-list__presence__15DJe\",\"sign-in\":\"presence-list__sign-in__28eVu\",\"signIn\":\"presence-list__sign-in__28eVu\",\"icon\":\"presence-list__icon__1t8iB\",\"self\":\"presence-list__self__1g-bw\",\"moderator-badge\":\"presence-list__moderator-badge__2njku\",\"moderatorBadge\":\"presence-list__moderator-badge__2njku\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"avatar-editor\":\"avatar-editor__avatar-editor__xtJ6P\",\"avatarEditor\":\"avatar-editor__avatar-editor__xtJ6P\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"bottom-links-main\":\"settings-menu__bottom-links-main__Vtlje\",\"bottomLinksMain\":\"settings-menu__bottom-links-main__Vtlje\",\"bottom-links\":\"settings-menu__bottom-links__b1tDE\",\"bottomLinks\":\"settings-menu__bottom-links__b1tDE\",\"settings-menu\":\"settings-menu__settings-menu__3x1Pv\",\"settingsMenu\":\"settings-menu__settings-menu__3x1Pv\",\"attach-point\":\"settings-menu__attach-point__2gV3g\",\"attachPoint\":\"settings-menu__attach-point__2gV3g\",\"contents\":\"settings-menu__contents__3GQlW\",\"rows\":\"settings-menu__rows__2OtlS\",\"row\":\"settings-menu__row__3w7fz\",\"row-header\":\"settings-menu__row-header__2oCqk\",\"rowHeader\":\"settings-menu__row-header__2oCqk\",\"list-item\":\"settings-menu__list-item__1__z6\",\"listItem\":\"settings-menu__list-item__1__z6\",\"list-item-link\":\"settings-menu__list-item-link__2ovr3\",\"listItemLink\":\"settings-menu__list-item-link__2ovr3\",\"settings-row\":\"settings-menu__settings-row__1sDDk\",\"settingsRow\":\"settings-menu__settings-row__1sDDk\",\"icon\":\"settings-menu__icon__3KMMz\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"load-button\":\"preload-overlay__load-button__ba1d4\",\"loadButton\":\"preload-overlay__load-button__ba1d4\",\"treatment\":\"preload-overlay__treatment__1L4r0\",\"screenshot\":\"preload-overlay__screenshot__3TZYm\",\"hub-name\":\"preload-overlay__hub-name__2txaT\",\"hubName\":\"preload-overlay__hub-name__2txaT\",\"main-panel\":\"preload-overlay__main-panel__2EX4k\",\"mainPanel\":\"preload-overlay__main-panel__2EX4k\",\"logo\":\"preload-overlay__logo__1IJJc\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"panel\":\"_2d-hud__panel__2oM_T\",\"tip-cancel-text\":\"_2d-hud__tip-cancel-text__12KQ2\",\"tipCancelText\":\"_2d-hud__tip-cancel-text__12KQ2\",\"top-tip\":\"_2d-hud__top-tip__E5uti\",\"topTip\":\"_2d-hud__top-tip__E5uti\",\"container\":\"_2d-hud__container__66GRt\",\"top\":\"_2d-hud__top__3PiNe\",\"column\":\"_2d-hud__column__1y7XY\",\"bottom\":\"_2d-hud__bottom__2jUcT\",\"hide\":\"_2d-hud__hide__3HJO8\",\"attach-point\":\"_2d-hud__attach-point__17FSc\",\"attachPoint\":\"_2d-hud__attach-point__17FSc\",\"attach_video_share_mode\":\"_2d-hud__attach_video_share_mode__21PhM\",\"attachVideoShareMode\":\"_2d-hud__attach_video_share_mode__21PhM\",\"attach_video_share_failed\":\"_2d-hud__attach_video_share_failed__2tfqf\",\"attachVideoShareFailed\":\"_2d-hud__attach_video_share_failed__2tfqf\",\"attach_pen_mode\":\"_2d-hud__attach_pen_mode__cI1AW\",\"attachPenMode\":\"_2d-hud__attach_pen_mode__cI1AW\",\"attach_mute_mode\":\"_2d-hud__attach_mute_mode__153iB\",\"attachMuteMode\":\"_2d-hud__attach_mute_mode__153iB\",\"attach_freeze_mode\":\"_2d-hud__attach_freeze_mode__3UIHP\",\"attachFreezeMode\":\"_2d-hud__attach_freeze_mode__3UIHP\",\"top-tip-no-hud\":\"_2d-hud__top-tip-no-hud__16RXh\",\"topTipNoHud\":\"_2d-hud__top-tip-no-hud__16RXh\",\"tip-cancel\":\"_2d-hud__tip-cancel__JaFV-\",\"tipCancel\":\"_2d-hud__tip-cancel__JaFV-\",\"video-share-extra-options\":\"_2d-hud__video-share-extra-options__31VMr\",\"videoShareExtraOptions\":\"_2d-hud__video-share-extra-options__31VMr\",\"iconButton\":\"_2d-hud__iconButton__3faJz\",\"up\":\"_2d-hud__up__1lyhr\",\"small\":\"_2d-hud__small__2rqgF\",\"large\":\"_2d-hud__large__2bHqH\",\"disabled\":\"_2d-hud__disabled__3ylbZ\",\"video-share\":\"_2d-hud__video-share__38X7W\",\"videoShare\":\"_2d-hud__video-share__38X7W\",\"fly\":\"_2d-hud__fly__kDxPK\",\"active\":\"_2d-hud__active__1TMB8\",\"mute\":\"_2d-hud__mute__25kHI\",\"pen\":\"_2d-hud__pen__3uTC7\",\"camera\":\"_2d-hud__camera__84ksg\",\"freeze\":\"_2d-hud__freeze__26rlJ\",\"spawn\":\"_2d-hud__spawn__1FoBz\",\"mobile-media-picker\":\"_2d-hud__mobile-media-picker__3ZXHc\",\"mobileMediaPicker\":\"_2d-hud__mobile-media-picker__3ZXHc\",\"share_camera\":\"_2d-hud__share_camera__v67Il\",\"shareCamera\":\"_2d-hud__share_camera__v67Il\",\"share_screen\":\"_2d-hud__share_screen__1HQ8E\",\"shareScreen\":\"_2d-hud__share_screen__1HQ8E\",\"share_window\":\"_2d-hud__share_window__stsD3\",\"shareWindow\":\"_2d-hud__share_window__stsD3\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"mic-0\":\"css-spritesheet__mic-0__2XVsh\",\"mic0\":\"css-spritesheet__mic-0__2XVsh\",\"mic-1\":\"css-spritesheet__mic-1__1tNtE\",\"mic1\":\"css-spritesheet__mic-1__1tNtE\",\"mic-2\":\"css-spritesheet__mic-2__2a7bH\",\"mic2\":\"css-spritesheet__mic-2__2a7bH\",\"mic-3\":\"css-spritesheet__mic-3__2A0Xs\",\"mic3\":\"css-spritesheet__mic-3__2A0Xs\",\"mic-4\":\"css-spritesheet__mic-4__ig2RD\",\"mic4\":\"css-spritesheet__mic-4__ig2RD\",\"mic-5\":\"css-spritesheet__mic-5__10MFm\",\"mic5\":\"css-spritesheet__mic-5__10MFm\",\"mic-6\":\"css-spritesheet__mic-6__3-bU1\",\"mic6\":\"css-spritesheet__mic-6__3-bU1\",\"mic-7\":\"css-spritesheet__mic-7__3j-4R\",\"mic7\":\"css-spritesheet__mic-7__3j-4R\",\"mic-off-0\":\"css-spritesheet__mic-off-0__1ZJb1\",\"micOff0\":\"css-spritesheet__mic-off-0__1ZJb1\",\"mic-off-1\":\"css-spritesheet__mic-off-1__PLn60\",\"micOff1\":\"css-spritesheet__mic-off-1__PLn60\",\"mic-off-2\":\"css-spritesheet__mic-off-2__ArmUv\",\"micOff2\":\"css-spritesheet__mic-off-2__ArmUv\",\"mic-off-3\":\"css-spritesheet__mic-off-3__33n8o\",\"micOff3\":\"css-spritesheet__mic-off-3__33n8o\",\"mic-off-4\":\"css-spritesheet__mic-off-4__5L_ui\",\"micOff4\":\"css-spritesheet__mic-off-4__5L_ui\",\"mic-off-5\":\"css-spritesheet__mic-off-5__3DqkV\",\"micOff5\":\"css-spritesheet__mic-off-5__3DqkV\",\"mic-off-6\":\"css-spritesheet__mic-off-6__2a7HR\",\"micOff6\":\"css-spritesheet__mic-off-6__2a7HR\",\"mic-off-7\":\"css-spritesheet__mic-off-7__Y2kJU\",\"micOff7\":\"css-spritesheet__mic-off-7__Y2kJU\"};","// removed by extract-text-webpack-plugin\nmodule.exports = {\"label\":\"spectating-label__label__3JS5A\"};","const qs = new URLSearchParams(location.search);\n\nexport default function qsTruthy(param) {\n  const val = qs.get(param);\n  // if the param exists but is not set (e.g. \"?foo&bar\"), its value is the empty string.\n  return val === \"\" || /1|on|true|yes/i.test(val);\n}\n","export function findAncestorWithComponent(entity, componentName) {\n  while (entity && !(entity.components && entity.components[componentName])) {\n    entity = entity.parentNode;\n  }\n  return entity;\n}\n","// Computes an AABB that surrounds the object in question and all of its children.\n// Note that if the children have rotations, this probably won't return the tightest\n// possible AABB -- we could return a tighter one if we examined all of the vertices\n// of the geometry for ourselves, but we don't care enough for what we're using this\n// for to do so much work.\nconst computeObjectAABB = (function() {\n  const bounds = new THREE.Box3();\n  return function(root, target) {\n    target.makeEmpty();\n    root.traverse(node => {\n      const geometry = node.geometry;\n      if (geometry != null) {\n        if (geometry.boundingBox == null) {\n          geometry.computeBoundingBox();\n        }\n        target.union(bounds.copy(geometry.boundingBox).applyMatrix4(node.matrixWorld));\n      }\n    });\n    return target;\n  };\n})();\n\nconst rotation = new THREE.Euler();\nexport function getBox(entity, boxRoot) {\n  const box = new THREE.Box3();\n\n  rotation.copy(entity.object3D.rotation);\n  entity.object3D.rotation.set(0, 0, 0);\n\n  entity.object3D.updateMatrices(true, true);\n  boxRoot.updateMatrices(true, true);\n  boxRoot.updateMatrixWorld(true);\n\n  computeObjectAABB(boxRoot, box);\n\n  if (!box.isEmpty()) {\n    entity.object3D.worldToLocal(box.min);\n    entity.object3D.worldToLocal(box.max);\n    entity.object3D.rotation.copy(rotation);\n    entity.object3D.matrixNeedsUpdate = true;\n  }\n\n  boxRoot.matrixWorldNeedsUpdate = true;\n  boxRoot.updateMatrices();\n\n  return box;\n}\n\nexport function getScaleCoefficient(length, box) {\n  if (box.isEmpty()) return 1.0;\n\n  const { max, min } = box;\n  const dX = Math.abs(max.x - min.x);\n  const dY = Math.abs(max.y - min.y);\n  const dZ = Math.abs(max.z - min.z);\n  const lengthOfLongestComponent = Math.max(dX, dY, dZ);\n  return length / lengthOfLongestComponent;\n}\n","import {Helmet} from 'react-helmet'\nimport React from \"react\";\n\nexport const HelmetComponent = ({assets, page}) => {\n\tlet pageTitle = page;\n\tconst titleRoot = assets.Page_Title_Root;\n\tif (titleRoot) pageTitle = `${titleRoot} | ${page}`;\n\treturn <Helmet>\n        <title>{pageTitle}</title>\n        <link rel=\"icon\" sizes=\"16x16 24x24 32x32 48x48 64x64\" href={assets.Favicon} />\n\t    <meta property=\"og:title\" content={assets.Name} />\n\t    <meta property=\"og:description\" content={assets.Social_Description} />\n\t    <meta property=\"og:image\" content={assets.Social_Image} />\n\t    <meta name=\"twitter:site\" content={assets.Twitter_Handle} />\n\t    <meta name=\"twitter:title\" content={assets.Name} />\n\t    <meta name=\"twitter:image\" content={assets.Social_Image} />\n\t    <meta name=\"twitter:description\" content={assets.Social_Description} />\n\t    <meta name=\"application-name\" content={assets.Name} />\n    </Helmet>\n}","import Airtable from 'airtable';\nAirtable.configure({\n    endpointUrl: 'https://api.airtable.com',\n    apiKey: 'keyOHSVeLr3ryLrL5'\n});\nconst base = Airtable.base('appIR0AlHDFG5WR8z');\n\nexport const airtableAssetsInitialState = { DarkLogo: null, Name: null, Icon: null }\n\nlet assets;\n\nconst airtableAssets = base('Assets');\n// export const getAirtableAssets = () => airtableAssets.find('recHqITRS7cBMwn9i');\nexport const getAirtableAssets = async () => {\n    if (assets) return assets;\n    const result = await airtableAssets.select({\n        view: 'Grid view'\n    }).firstPage()\n    assets = result[0].fields;\n    return result[0].fields\n}\n\nexport const airtableMessages = base('Messages').select({\n    view: 'Grid view'\n}).firstPage(async (err, records) => {\n    if (err) { console.error(err); return; }\n    const record = records[0];\n    return record;\n});;","import { airtableMessages } from './airtable'\nimport { Name, Hero_Blurb } from './customization'\nimport translations from '../assets/translations.data.json';\nlet modifiedTranslations = translations;\nconst name = Name;\n// const name = airtableMessages && airtableMessages.get('Name') || \"Axon Park\";\n\n// modifiedTranslations.en[\"home.hero_blurb\"] = airtableMessages && airtableMessages.get('Motto') || 'Learn together, from anywhere.\\nThe future of learning is virtual.\\nEqualizing access to premier quality education.';\nmodifiedTranslations.en[\"home.hero_blurb\"] = Hero_Blurb;\nmodifiedTranslations.en[\"sign-in.rename-room\"] = `You'll need to sign in to rename ${name}.`;\nmodifiedTranslations.en[\"sign-in.close-room\"] = `You'll need to sign in to close ${name}.`;\nmodifiedTranslations.en[\"rename-room.message\"] = `Enter the new name for ${name}.`;\nmodifiedTranslations.en[\"rename-room.rename\"] = `Rename ${name}`;\nmodifiedTranslations.en[\"close-room.message\"] =\n  `Closing this room will remove yourself and others from ${name}, shutting it down permanently.\\n\\nAre you sure? This action cannot be undone.`;\nmodifiedTranslations.en[\"close-room.confirm\"] = `Yes, Close ${name}`;\nmodifiedTranslations.en[\"entry.enter-room\"] = `Enter ${name}`;\nmodifiedTranslations.en[\"entry.leave-room\"] = `Leave ${name}`;\nmodifiedTranslations.en[\"entry.in-lobby-notice\"] = `You are viewing ${name} from the lobby.`;\nmodifiedTranslations.en[\"exit.subtitle.kicked\"] = `You have been kicked from ${name}.`;\nmodifiedTranslations.en[\"exit.subtitle.left\"] = `You have left ${name}.`;\nmodifiedTranslations.en[\"exit.subtitle.disconnected\"] = `You have disconnected from ${name}. Refresh the page to try to reconnect.`;\nmodifiedTranslations.en[\"presence.entered_room\"] = `entered ${name}.`;\nmodifiedTranslations.en[\"presence.entered_lobby\"] = `entered ${name}'s lobby.`;\nmodifiedTranslations.en[\"presence.join_lobby\"] = `joined the ${name} lobby.`;\nmodifiedTranslations.en[\"presence.join_room\"] = `joined ${name}.`;\nmodifiedTranslations.en[\"presence.in_lobby\"] = `${name} Lobby`;\nmodifiedTranslations.en[\"presence.in_room\"] = `In ${name}`;\nmodifiedTranslations.en[\"home.create_a_room\"] = `Initialize ${name}`;\nmodifiedTranslations.en[\"home.room_create_button\"] = `Initialize ${name}`;\nmodifiedTranslations.en[\"home.have_code\"] = `Have an ${name} code?`;\nmodifiedTranslations.en[\"commands.leave\"] = `Disconnect from ${name}.`;\nmodifiedTranslations.en[\"settings.rename-room\"] = `Set ${name} Name...`;\nmodifiedTranslations.en[\"settings.close-room\"] = `Close ${name}...`;\nmodifiedTranslations.en[\"settings.leave-room\"] = `Leave ${name}`;\nmodifiedTranslations.en[\"settings.room-info\"] = `${name} Info`;\nmodifiedTranslations.en[\"settings.create-room\"] = `New ${name}...`;\nmodifiedTranslations.en[\"settings.row-room\"] = `${name}`;\nmodifiedTranslations.en[\"settings.room-settings\"] = `${name} Settings`;\nmodifiedTranslations.en[\"tips.mobile.object_pin\"] = `Pin an object to save it to ${name}.`;\nmodifiedTranslations.en[\"tips.mobile.object_pin\"] = `Pin an object to save it to ${name}.`;\nmodifiedTranslations.en[\"tips.mobile.invite\"] = `Use the Invite button to share ${name}.`;\nmodifiedTranslations.en[\"tips.desktop.object_pin\"] = `Pin an object to save it to ${name}.`;\nmodifiedTranslations.en[\"tips.watching.back\"] = `Enter ${name}`;\nmodifiedTranslations.en[\"leave-room-dialog.create-room.confirm\"] = `Leave ${name}.`;\n\nexport default modifiedTranslations;","export const Name = \"Axon Park\"\nexport const Hero_Blurb = 'Learn together, from anywhere.\\nThe future of learning is virtual.\\nEqualizing access to premier quality education.'","import localeData from \"../everyspace/messages.js\";\n// import localeData from \"../assets/translations.data.json\";\nconst navigatorLang = ((navigator.languages && navigator.languages[0]) || navigator.language || navigator.userLanguage)\n  .toLowerCase()\n  .split(/[_-]+/)[0];\nexport const lang = (localeData[navigatorLang] && navigatorLang) || \"en\";\nexport const messages = localeData[lang] || localeData.en;\n","// A-Frame blows away any npm debug log filters so this allow the user to set the log filter\n// via the query string.\nimport debug from \"debug\";\nimport qsTruthy from \"./qs_truthy\";\n\nconst qs = new URLSearchParams(location.search);\nconst isDebug = qsTruthy(\"debug\");\nconst logFilter = qs.get(\"log_filter\") || (isDebug && \"naf-janus-adapter:*\");\n\nif (logFilter) {\n  debug.enable(logFilter);\n}\n","// This computation is expensive, so we run on at most one avatar per frame, including quiet avatars.\n// However if we detect an avatar is seen speaking (its volume is above DISABLE_AT_VOLUME_THRESHOLD)\n// then we continue analysis for at least DISABLE_GRACE_PERIOD_MS and disable doing it every frame if\n// the avatar is quiet during that entire duration (eg they are muted)\nconst DISABLE_AT_VOLUME_THRESHOLD = 0.00001;\nconst DISABLE_GRACE_PERIOD_MS = 10000;\nconst MIN_VOLUME_THRESHOLD = 0.01;\n\nconst calculateVolume = (analyser, levels) => {\n  // take care with compatibility, e.g. safari doesn't support getFloatTimeDomainData\n  analyser.getByteTimeDomainData(levels);\n  let sum = 0;\n  for (let i = 0; i < levels.length; i++) {\n    const amplitude = (levels[i] - 128) / 128;\n    sum += amplitude * amplitude;\n  }\n  const currVolume = Math.sqrt(sum / levels.length);\n  return currVolume < MIN_VOLUME_THRESHOLD ? 0 : currVolume;\n};\n\nconst tempScaleFromPosition = new THREE.Vector3();\nconst tempScaleToPosition = new THREE.Vector3();\n\nexport function getAudioFeedbackScale(fromObject, toObject, minScale, maxScale, volume) {\n  tempScaleToPosition.setFromMatrixPosition(toObject.matrixWorld);\n  tempScaleFromPosition.setFromMatrixPosition(fromObject.matrixWorld);\n  const distance = tempScaleFromPosition.distanceTo(tempScaleToPosition) / 10;\n  return Math.min(maxScale, minScale + (maxScale - minScale) * volume * 8 * distance);\n}\n\n/**\n * Emits audioFrequencyChange events based on a networked audio source\n * @namespace avatar\n * @component networked-audio-analyser\n */\nAFRAME.registerComponent(\"networked-audio-analyser\", {\n  async init() {\n    this.volume = 0;\n    this.prevVolume = 0;\n    this._updateAnalysis = this._updateAnalysis.bind(this);\n    this._runScheduledWork = this._runScheduledWork.bind(this);\n    this.el.sceneEl.systems[\"frame-scheduler\"].schedule(this._updateAnalysis, \"audio-analyser\");\n    this.el.addEventListener(\"sound-source-set\", event => {\n      const ctx = THREE.AudioContext.getContext();\n      this.analyser = ctx.createAnalyser();\n      this.analyser.fftSize = 32;\n      this.levels = new Uint8Array(this.analyser.frequencyBinCount);\n      event.detail.soundSource.connect(this.analyser);\n    });\n  },\n\n  remove: function() {\n    this.el.sceneEl.systems[\"frame-scheduler\"].unschedule(this._runScheduledWork, \"audio-analyser\");\n  },\n\n  tick: function(t) {\n    if (!this.avatarIsQuiet) {\n      this._updateAnalysis(t);\n    }\n  },\n\n  _runScheduledWork: function() {\n    if (this.avatarIsQuiet) {\n      this._updateAnalysis();\n    }\n  },\n\n  // Updates the analysis/volume. If t is passed, that implies this is called via tick\n  // and so as a performance optimization will check to see if it's been at least DISABLE_GRACE_PERIOD_MS\n  // since the last volume was seen above DISABLE_AT_VOLUME_THRESHOLD, and if so, will disable\n  // tick updates until the volume exceeds the level again.\n  _updateAnalysis: function(t) {\n    if (!this.analyser) return;\n\n    const currentVolume = calculateVolume(this.analyser, this.levels);\n    const s = 0.3;\n    this.volume = s * currentVolume + (1 - s) * this.prevVolume;\n    this.prevVolume = this.volume;\n\n    if (this.volume < DISABLE_AT_VOLUME_THRESHOLD) {\n      if (t && this.lastSeenVolume && this.lastSeenVolume < t - DISABLE_GRACE_PERIOD_MS) {\n        this.avatarIsQuiet = true;\n      }\n    } else {\n      if (t) {\n        this.lastSeenVolume = t;\n      }\n\n      this.avatarIsQuiet = false;\n    }\n  }\n});\n\nfunction connectAnalyser(mediaStream) {\n  const ctx = THREE.AudioContext.getContext();\n  const source = ctx.createMediaStreamSource(mediaStream);\n  const analyser = ctx.createAnalyser();\n  analyser.fftSize = 32;\n  const levels = new Uint8Array(analyser.frequencyBinCount);\n  source.connect(analyser);\n  return { analyser, levels };\n}\n\n/**\n * Calculates volume of the local audio stream.\n */\nAFRAME.registerSystem(\"local-audio-analyser\", {\n  init() {\n    this.volume = 0;\n\n    this.el.addEventListener(\"local-media-stream-created\", e => {\n      const mediaStream = e.detail.mediaStream;\n      if (this.stream) {\n        console.warn(\"media stream changed\", this.stream, mediaStream);\n        // TODO: cleanup?\n      }\n      this.stream = mediaStream;\n      const { analyser, levels } = connectAnalyser(mediaStream);\n      this.analyser = analyser;\n      this.levels = levels;\n    });\n  },\n\n  tick: function() {\n    if (!this.analyser) return;\n    this.volume = calculateVolume(this.analyser, this.levels);\n  }\n});\n\n/**\n * Sets an entity's scale base on audioFrequencyChange events.\n * @namespace avatar\n * @component scale-audio-feedback\n */\nAFRAME.registerComponent(\"scale-audio-feedback\", {\n  schema: {\n    minScale: { default: 1 },\n    maxScale: { default: 2 }\n  },\n\n  init() {\n    this._playerCamera = document.getElementById(\"player-camera\").object3D;\n  },\n\n  tick() {\n    // TODO: come up with a cleaner way to handle this.\n    // bone's are \"hidden\" by scaling them with bone-visibility, without this we would overwrite that.\n    if (!this.el.object3D.visible) return;\n\n    const { minScale, maxScale } = this.data;\n\n    const audioAnalyser = this.el.components[\"networked-audio-analyser\"];\n\n    if (!audioAnalyser) return;\n\n    const { object3D } = this.el;\n\n    const scale = getAudioFeedbackScale(this.el.object3D, this._playerCamera, minScale, maxScale, audioAnalyser.volume);\n\n    object3D.scale.setScalar(scale);\n    object3D.matrixNeedsUpdate = true;\n  }\n});\n\nconst SPRITE_NAMES = {\n  MIC: [\"mic-0.png\", \"mic-1.png\", \"mic-2.png\", \"mic-3.png\", \"mic-4.png\", \"mic-5.png\", \"mic-6.png\", \"mic-7.png\"],\n  MIC_HOVER: [\n    \"mic-0_hover.png\",\n    \"mic-1_hover.png\",\n    \"mic-2_hover.png\",\n    \"mic-3_hover.png\",\n    \"mic-4_hover.png\",\n    \"mic-5_hover.png\",\n    \"mic-6_hover.png\",\n    \"mic-7_hover.png\"\n  ],\n  MIC_OFF: [\n    \"mic-off-0.png\",\n    \"mic-off-1.png\",\n    \"mic-off-2.png\",\n    \"mic-off-3.png\",\n    \"mic-off-4.png\",\n    \"mic-off-5.png\",\n    \"mic-off-6.png\",\n    \"mic-off-7.png\"\n  ],\n  MIC_OFF_HOVER: [\n    \"mic-off-0_hover.png\",\n    \"mic-off-1_hover.png\",\n    \"mic-off-2_hover.png\",\n    \"mic-off-3_hover.png\",\n    \"mic-off-4_hover.png\",\n    \"mic-off-5_hover.png\",\n    \"mic-off-6_hover.png\",\n    \"mic-off-7_hover.png\"\n  ]\n};\n\nexport function micLevelForVolume(volume, max) {\n  return max === 0\n    ? 0\n    : volume < max * 0.02\n      ? 0\n      : volume < max * 0.03\n        ? 1\n        : volume < max * 0.06\n          ? 2\n          : volume < max * 0.08\n            ? 3\n            : volume < max * 0.16\n              ? 4\n              : volume < max * 0.32\n                ? 5\n                : volume < max * 0.5\n                  ? 6\n                  : 7;\n}\n\nAFRAME.registerComponent(\"mic-button\", {\n  schema: {\n    active: { type: \"boolean\" },\n    tooltip: { type: \"selector\" },\n    tooltipText: { type: \"string\" },\n    activeTooltipText: { type: \"string\" }\n  },\n\n  init() {\n    this.loudest = 0;\n    this.prevSpriteName = \"\";\n    this.decayingVolume = 0;\n    this.el.object3D.matrixNeedsUpdate = true;\n    this.hovering = false;\n    this.onHover = () => {\n      this.hovering = true;\n      this.data.tooltip.setAttribute(\"visible\", true);\n    };\n    this.onHoverOut = () => {\n      this.hovering = false;\n      this.data.tooltip.setAttribute(\"visible\", false);\n    };\n  },\n\n  play() {\n    this.el.object3D.addEventListener(\"hovered\", this.onHover);\n    this.el.object3D.addEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  pause() {\n    this.el.object3D.removeEventListener(\"hovered\", this.onHover);\n    this.el.object3D.removeEventListener(\"unhovered\", this.onHoverOut);\n  },\n\n  update() {\n    if (this.data.tooltip) {\n      this.textEl = this.data.tooltip.querySelector(\"[text]\");\n    }\n  },\n\n  tick() {\n    const audioAnalyser = this.el.sceneEl.systems[\"local-audio-analyser\"];\n    let volume;\n    if (audioAnalyser.volume > this.decayingVolume) {\n      this.decayingVolume = audioAnalyser.volume;\n      volume = audioAnalyser.volume;\n      this.loudest = Math.max(this.loudest, volume);\n    } else {\n      const s = 0.8;\n      volume = this.decayingVolume * s > 0.001 ? this.decayingVolume * s : 0;\n      this.decayingVolume = volume;\n    }\n\n    const active = this.data.active;\n    const hovering = this.hovering;\n    const spriteNames =\n      SPRITE_NAMES[!active ? (hovering ? \"MIC_HOVER\" : \"MIC\") : hovering ? \"MIC_OFF_HOVER\" : \"MIC_OFF\"];\n    const level = micLevelForVolume(volume, this.loudest);\n    const spriteName = spriteNames[level];\n    if (spriteName !== this.prevSpriteName) {\n      this.prevSpriteName = spriteName;\n      this.el.setAttribute(\"sprite\", \"name\", spriteName);\n    }\n\n    if (this.data.tooltip && hovering) {\n      this.textEl = this.textEl || this.data.tooltip.querySelector(\"[text]\");\n      this.textEl.setAttribute(\"text\", \"value\", active ? this.data.activeTooltipText : this.data.tooltipText);\n    }\n  }\n});\n","import uuid from \"uuid/v4\";\n\nexport default class AuthChannel {\n  constructor(store) {\n    this.store = store;\n    this.socket = null;\n    this._signedIn = !!this.store.state.credentials.token;\n  }\n\n  setSocket = socket => {\n    this.socket = socket;\n  };\n\n  get email() {\n    return this.store.state.credentials.email;\n  }\n\n  get signedIn() {\n    return this._signedIn;\n  }\n\n  signOut = async hubChannel => {\n    if (hubChannel) {\n      await hubChannel.signOut();\n    }\n    this.store.update({ credentials: { token: null, email: null } });\n    this.store.resetToRandomLegacyAvatar();\n    this._signedIn = false;\n  };\n\n  verifyAuthentication(authTopic, authToken, authPayload) {\n    const channel = this.socket.channel(authTopic);\n    return new Promise((resolve, reject) =>\n      channel\n        .join()\n        .receive(\"ok\", () => {\n          channel.on(\"auth_credentials\", async ({ credentials: token, payload: payload }) => {\n            await this.handleAuthCredentials(payload.email, token);\n            resolve();\n          });\n\n          channel.push(\"auth_verified\", { token: authToken, payload: authPayload });\n        })\n        .receive(\"error\", reject)\n    );\n  }\n\n  async startAuthentication(email, hubChannel) {\n    const channel = this.socket.channel(`auth:${uuid()}`);\n    await new Promise((resolve, reject) =>\n      channel\n        .join()\n        .receive(\"ok\", resolve)\n        .receive(\"error\", reject)\n    );\n\n    const authComplete = new Promise(resolve =>\n      channel.on(\"auth_credentials\", async ({ credentials: token }) => {\n        await this.handleAuthCredentials(email, token, hubChannel);\n        resolve();\n      })\n    );\n\n    channel.push(\"auth_request\", { email, origin: \"hubs\" });\n\n    // Returning an object with the authComplete promise since we want the caller to wait for the above await but not\n    // for authComplete.\n    return { authComplete };\n  }\n\n  async handleAuthCredentials(email, token, hubChannel) {\n    this.store.update({ credentials: { email, token } });\n\n    if (hubChannel) {\n      await hubChannel.signIn(token);\n    }\n\n    this._signedIn = true;\n  }\n}\n","export function addAnimationComponents(modelEl) {\n  if (!modelEl.components[\"animation-mixer\"]) {\n    return;\n  }\n\n  if (!modelEl.querySelector(\"[loop-animation]\")) {\n    modelEl.setAttribute(\"loop-animation\", \"\");\n  }\n}\n","const tempVector3 = new THREE.Vector3();\nconst tempQuaternion = new THREE.Quaternion();\n\nexport function getLastWorldPosition(src, target) {\n  src.updateMatrices();\n  target.setFromMatrixPosition(src.matrixWorld);\n  return target;\n}\n\nexport function getLastWorldQuaternion(src, target) {\n  src.updateMatrices();\n  src.matrixWorld.decompose(tempVector3, target, tempVector3);\n  return target;\n}\n\nexport function getLastWorldScale(src, target) {\n  src.updateMatrices();\n  src.matrixWorld.decompose(tempVector3, tempQuaternion, target);\n  return target;\n}\n\nexport function disposeMaterial(mtrl) {\n  if (mtrl.map) mtrl.map.dispose();\n  if (mtrl.lightMap) mtrl.lightMap.dispose();\n  if (mtrl.bumpMap) mtrl.bumpMap.dispose();\n  if (mtrl.normalMap) mtrl.normalMap.dispose();\n  if (mtrl.specularMap) mtrl.specularMap.dispose();\n  if (mtrl.envMap) mtrl.envMap.dispose();\n  mtrl.dispose();\n}\n\nexport function disposeNode(node) {\n  if (!(node instanceof THREE.Mesh)) return;\n\n  if (node.geometry) {\n    node.geometry.dispose();\n  }\n\n  if (node.material) {\n    let materialArray;\n    if (node.material instanceof THREE.MeshFaceMaterial || node.material instanceof THREE.MultiMaterial) {\n      materialArray = node.material.materials;\n    } else if (node.material instanceof Array) {\n      materialArray = node.material;\n    }\n    if (materialArray) {\n      materialArray.forEach(disposeMaterial);\n    } else {\n      disposeMaterial(node.material);\n    }\n  }\n}\n\nexport function setMatrixWorld(object3D, m) {\n  object3D.matrixWorld.copy(m);\n  object3D.matrix = object3D.matrix.getInverse(object3D.parent.matrixWorld).multiply(object3D.matrixWorld);\n  object3D.matrix.decompose(object3D.position, object3D.quaternion, object3D.scale);\n}\n","export function forEachMaterial(object3D, fn) {\n  if (!object3D.material) return;\n\n  if (Array.isArray(object3D.material)) {\n    object3D.material.forEach(fn);\n  } else {\n    fn(object3D.material);\n  }\n}\n\nexport function mapMaterials(object3D, fn) {\n  if (!object3D.material) return;\n\n  if (Array.isArray(object3D.material)) {\n    return object3D.material.map(fn);\n  } else {\n    return fn(object3D.material);\n  }\n}\n","export default function maskEmail(email) {\n  if (!email) return \"\";\n  const emailParts = email.split(\"@\");\n  const emailIdentity = emailParts[0];\n  const emailDomain = emailParts[1];\n  const truncatedIdentity = emailIdentity.substring(0, Math.min(emailIdentity.length, 3));\n  return `${truncatedIdentity}...@${emailDomain}`;\n}\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classNames from \"classnames\";\nimport dayjs from \"dayjs-ext\";\nimport relativeTime from \"dayjs-ext/plugin/relativeTime\";\nimport { FormattedMessage } from \"react-intl\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport { faAngleLeft } from \"@fortawesome/free-solid-svg-icons/faAngleLeft\";\nimport { faAngleRight } from \"@fortawesome/free-solid-svg-icons/faAngleRight\";\nimport { faExternalLinkAlt } from \"@fortawesome/free-solid-svg-icons/faExternalLinkAlt\";\nimport { faPencilAlt } from \"@fortawesome/free-solid-svg-icons/faPencilAlt\";\nimport { faPlus } from \"@fortawesome/free-solid-svg-icons/faPlus\";\n\nimport styles from \"../assets/stylesheets/media-browser.scss\";\nimport { scaledThumbnailUrlFor } from \"../utils/media-url-utils\";\nimport StateLink from \"./state-link\";\n\ndayjs.extend(relativeTime);\n\nconst PUBLISHER_FOR_ENTRY_TYPE = {\n  sketchfab_model: \"Sketchfab\",\n  poly_model: \"Google Poly\",\n  twitch_stream: \"Twitch\"\n};\n\nclass MediaTiles extends Component {\n  static propTypes = {\n    result: PropTypes.object,\n    history: PropTypes.object,\n    urlSource: PropTypes.string,\n    handleEntryClicked: PropTypes.func,\n    handlePager: PropTypes.func\n  };\n\n  render() {\n    const { urlSource, result } = this.props;\n    const entries = (result && result.entries) || [];\n    const [createTileWidth, createTileHeight] = this.getTileDimensions(false, urlSource === \"avatars\");\n    const searchParams = new URLSearchParams((this.props.history ? this.props.history.location : location).search);\n    const hasMeta = !!(result && result.meta);\n    const apiSource = (hasMeta && result.meta.source) || null;\n    const isVariableWidth = result && [\"bing_images\", \"tenor\"].includes(apiSource);\n    const hasNext = !!(hasMeta && result.meta.next_cursor) || false;\n    const hasPrevious = searchParams.get(\"cursor\");\n\n    return (\n      <div className={styles.body}>\n        <div className={classNames({ [styles.tiles]: true, [styles.tilesVariable]: isVariableWidth })}>\n          {(urlSource === \"avatars\" || urlSource === \"scenes\") && (\n            <div\n              style={{ width: `${createTileWidth}px`, height: `${createTileHeight}px` }}\n              className={classNames(styles.tile, styles.createTile)}\n            >\n              {urlSource === \"scenes\" ? (\n                <a href=\"/spoke/new\" rel=\"noopener noreferrer\" target=\"_blank\" className={styles.tileLink}>\n                  <div className={styles.tileContent}>\n                    <FontAwesomeIcon icon={faPlus} />\n                    <FormattedMessage id=\"media-browser.create-scene\" />\n                  </div>\n                </a>\n              ) : (\n                <a\n                  onClick={e => {\n                    e.preventDefault();\n                    window.dispatchEvent(new CustomEvent(\"action_create_avatar\"));\n                  }}\n                  className={styles.tileLink}\n                >\n                  <div className={styles.tileContent}>\n                    <FontAwesomeIcon icon={faPlus} />\n                    <FormattedMessage id=\"media-browser.create-avatar\" />\n                  </div>\n                </a>\n              )}\n            </div>\n          )}\n\n          {entries.map(this.entryToTile)}\n        </div>\n\n        {result &&\n          (hasNext || hasPrevious) &&\n          this.props.handlePager && (\n            <div className={styles.pager}>\n              <a\n                className={classNames({ [styles.previousPage]: true, [styles.pagerButtonDisabled]: !hasPrevious })}\n                onClick={() => this.props.handlePager(-1)}\n              >\n                <FontAwesomeIcon icon={faAngleLeft} />\n              </a>\n              <div className={styles.pageNumber}>{result.meta.page}</div>\n              <a\n                className={classNames({ [styles.nextPage]: true, [styles.pagerButtonDisabled]: !hasNext })}\n                onClick={() => this.props.handlePager(1)}\n              >\n                <FontAwesomeIcon icon={faAngleRight} />\n              </a>\n            </div>\n          )}\n      </div>\n    );\n  }\n\n  getTileDimensions = (isImage, isAvatar, imageAspect) => {\n    // Doing breakpointing here, so we can have proper image placeholder based upon dynamic aspect ratio\n    const clientWidth = window.innerWidth;\n    let imageHeight = clientWidth < 1079 ? (clientWidth < 768 ? (clientWidth < 400 ? 85 : 100) : 150) : 200;\n    if (isAvatar) imageHeight = Math.floor(imageHeight * 1.5);\n\n    // Aspect ratio can vary per image if its an image result. Avatars are a taller portrait aspect, o/w assume 720p\n    let imageWidth;\n    if (isImage) {\n      imageWidth = Math.floor(Math.max(imageAspect * imageHeight, imageHeight * 0.85));\n    } else if (isAvatar) {\n      imageWidth = Math.floor((9 / 16) * imageHeight);\n    } else {\n      imageWidth = Math.floor(Math.max((16 / 9) * imageHeight, imageHeight * 0.85));\n    }\n\n    return [imageWidth, imageHeight];\n  };\n\n  entryToTile = (entry, idx) => {\n    const imageSrc = entry.images.preview.url;\n    const creator = entry.attributions && entry.attributions.creator;\n    const isImage = entry.type.endsWith(\"_image\");\n    const isAvatar = [\"avatar\", \"avatar_listing\"].includes(entry.type);\n    const isHub = [\"hub\"].includes(entry.type);\n    const imageAspect = entry.images.preview.width / entry.images.preview.height;\n\n    const [imageWidth, imageHeight] = this.getTileDimensions(isImage, isAvatar, imageAspect);\n\n    const publisherName =\n      (entry.attributions && entry.attributions.publisher && entry.attributions.publisher.name) ||\n      PUBLISHER_FOR_ENTRY_TYPE[entry.type];\n\n    return (\n      <div style={{ width: `${imageWidth}px` }} className={styles.tile} key={`${entry.id}_${idx}`}>\n        <a\n          href={entry.url}\n          rel=\"noreferrer noopener\"\n          onClick={e => this.props.handleEntryClicked && this.props.handleEntryClicked(e, entry)}\n          className={styles.tileLink}\n          style={{ width: `${imageWidth}px`, height: `${imageHeight}px` }}\n        >\n          <img\n            className={classNames(styles.tileContent, styles.avatarTile)}\n            src={scaledThumbnailUrlFor(imageSrc, imageWidth, imageHeight)}\n          />\n        </a>\n        {entry.type === \"avatar\" && (\n          <StateLink\n            className={styles.editAvatar}\n            stateKey=\"overlay\"\n            stateValue=\"avatar-editor\"\n            stateDetail={{ avatarId: entry.id }}\n            history={this.props.history}\n          >\n            <FontAwesomeIcon icon={faPencilAlt} />\n          </StateLink>\n        )}\n        {!entry.type.endsWith(\"_image\") && (\n          <div className={styles.info}>\n            <a\n              href={entry.url}\n              rel=\"noreferrer noopener\"\n              className={styles.name}\n              onClick={e => this.props.handleEntryClicked && this.props.handleEntryClicked(e, entry)}\n            >\n              {entry.name || \"\\u00A0\"}\n            </a>\n            {!isAvatar &&\n              !isHub && (\n                <div className={styles.attribution}>\n                  <div className={styles.creator}>\n                    {creator && creator.name === undefined && <span>{creator}</span>}\n                    {creator && creator.name && !creator.url && <span>{creator.name}</span>}\n                    {creator &&\n                      creator.name &&\n                      creator.url && (\n                        <a href={creator.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                          {creator.name}\n                        </a>\n                      )}\n                  </div>\n                  {publisherName && (\n                    <div className={styles.publisher}>\n                      <i>\n                        <FontAwesomeIcon icon={faExternalLinkAlt} />\n                      </i>\n                      &nbsp;<a href={entry.url} target=\"_blank\" rel=\"noopener noreferrer\">\n                        {publisherName}\n                      </a>\n                    </div>\n                  )}\n                </div>\n              )}\n            {isHub && (\n              <div className={styles.attribution}>\n                <div className={styles.lastJoined}>\n                  <FormattedMessage id=\"media-browser.hub.joined-prefix\" />\n                  {dayjs(entry.last_activated_at).fromNow()}\n                </div>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    );\n  };\n}\nexport default MediaTiles;\n","const THREE = AFRAME.THREE;\n\nfunction checkFloatTextureSupport() {\n  const renderer = new THREE.WebGLRenderer();\n\n  const scene = new THREE.Scene();\n  const size = 2;\n  const data = new Float32Array(size * size * 4);\n  const dataTexture = new THREE.DataTexture(data, size, size, THREE.RGBAFormat, THREE.FloatType);\n  const box = new THREE.Mesh(new THREE.PlaneBufferGeometry(1, 1), new THREE.MeshBasicMaterial({ map: dataTexture }));\n  box.material.map.needsUpdate = true;\n  scene.add(box);\n\n  renderer.render(scene, new THREE.Camera());\n  const result = renderer.context.getError() === 0;\n  renderer.dispose();\n  return result;\n}\n\nexport function patchWebGLRenderingContext() {\n  if (/Android.+Firefox/.test(navigator.userAgent)) {\n    // It appears that Galaxy S6 devices falsely report that they support\n    // OES_texture_float in Firefox. This workaround disables float textures\n    // for those devices.\n    // See https://github.com/mozilla/hubs/issues/32 and\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1338656\n    const originalGetExtension = WebGLRenderingContext.prototype.getExtension;\n    const supportsFloatTextures = checkFloatTextureSupport();\n    WebGLRenderingContext.prototype.getExtension = function patchedGetExtension(name) {\n      if (name === \"OES_texture_float\" && !supportsFloatTextures) {\n        return null;\n      }\n      return originalGetExtension.call(this, name);\n    };\n  }\n}\n","module.exports = __webpack_public_path__ + \"assets/LoadingObject_Atom-7dcc3b81897e68b740c1cf12b6cf4c3f.glb\";","module.exports = __webpack_public_path__ + \"assets/sfx/teleport-loop-84e2caa4f62e5c6d6ce339b0c715c06d.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/quickTurn-cda89edb1a7a32e4442cac70cd2694be.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/tap_mellow-673398d6e97818ec4b675708d460bd0f.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/PenSpawn-aac1f534773040f0fafa41e9db76017b.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/PenDraw1-ddbdc17a6beefecbca2685c8c9d0d2d5.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/PicSnapHey-0228ddd197e5a6d88f7bcd2ceb340f8e.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/welcome-0083300978d5dd05eaa376f65761da47.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/quack-1f18502834f8f1db43990b769c2ab193.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/specialquack-6d1a192a6092e8dfed5d3de063755ee2.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/pop-5784f3bcfaf98637147737448d6df8df.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/Eb_blip-8d7302990e83d6798400a6027dce3936.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/tack-0d55b064794faaa1733fcf6bc89cad0c.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/A_bendUp-de32e556413bb2a527fb514984738c70.mp3\";","module.exports = __webpack_public_path__ + \"assets/sfx/suspense-f27c64840e5ede36ec694c22a030615c.mp3\";","module.exports = __webpack_public_path__ + \"assets/waternormals-4418dde3f6abc21dc32506acf5f5b093.jpg\";","import { avatars } from \"../assets/avatars/avatars.js\";\n\nconst names = [\n  \"Baers-Pochard\",\n  \"Baikal-Teal\",\n  \"Barrows-Goldeneye\",\n  \"Blue-Billed\",\n  \"Blue-Duck\",\n  \"Blue-Winged\",\n  \"Brown-Teal\",\n  \"Bufflehead\",\n  \"Canvasback\",\n  \"Cape-Shoveler\",\n  \"Chestnut-Teal\",\n  \"Chiloe-Wigeon\",\n  \"Cinnamon-Teal\",\n  \"Comb-Duck\",\n  \"Common-Eider\",\n  \"Common-Goldeneye\",\n  \"Common-Merganser\",\n  \"Common-Pochard\",\n  \"Common-Scoter\",\n  \"Common-Shelduck\",\n  \"Cotton-Pygmy\",\n  \"Crested-Duck\",\n  \"Crested-Shelduck\",\n  \"Eatons-Pintail\",\n  \"Falcated\",\n  \"Ferruginous\",\n  \"Freckled-Duck\",\n  \"Gadwall\",\n  \"Garganey\",\n  \"Greater-Scaup\",\n  \"Green-Pygmy\",\n  \"Grey-Teal\",\n  \"Hardhead\",\n  \"Harlequin\",\n  \"Hartlaubs\",\n  \"Hooded-Merganser\",\n  \"Hottentot-Teal\",\n  \"Kelp-Goose\",\n  \"King-Eider\",\n  \"Lake-Duck\",\n  \"Laysan-Duck\",\n  \"Lesser-Scaup\",\n  \"Long-Tailed\",\n  \"Maccoa-Duck\",\n  \"Mallard\",\n  \"Mandarin\",\n  \"Marbled-Teal\",\n  \"Mellers-Duck\",\n  \"Merganser\",\n  \"Northern-Pintail\",\n  \"Orinoco-Goose\",\n  \"Paradise-Shelduck\",\n  \"Plumed-Whistler\",\n  \"Puna-Teal\",\n  \"Pygmy-Goose\",\n  \"Radjah-Shelduck\",\n  \"Red-Billed\",\n  \"Red-Crested\",\n  \"Red-Shoveler\",\n  \"Ring-Necked\",\n  \"Ringed-Teal\",\n  \"Rosy-Billed\",\n  \"Ruddy-Shelduck\",\n  \"Salvadoris-Teal\",\n  \"Scaly-Sided\",\n  \"Shelduck\",\n  \"Shoveler\",\n  \"Silver-Teal\",\n  \"Smew\",\n  \"Spectacled-Eider\",\n  \"Spot-Billed\",\n  \"Spotted-Whistler\",\n  \"Steamerduck\",\n  \"Stellers-Eider\",\n  \"Sunda-Teal\",\n  \"Surf-Scoter\",\n  \"Tufted-Duck\",\n  \"Velvet-Scoter\",\n  \"Wandering-Whistler\",\n  \"Whistling-duck\",\n  \"White-Backed\",\n  \"White-Cheeked\",\n  \"White-Winged\",\n  \"Wigeon\",\n  \"Wood-Duck\",\n  \"Yellow-Billed\"\n];\n\nfunction selectRandom(arr) {\n  return arr[Math.floor(Math.random() * arr.length)];\n}\n\nexport function generateRandomName() {\n  return `${selectRandom(names)}-${Math.floor(10000 + Math.random() * 10000)}`;\n}\n\nexport const avatarIds = avatars.map(av => av.id);\n\nexport function generateDefaultProfile() {\n  return {\n    avatarId: selectRandom(avatarIds)\n  };\n}\n","import { Validator } from \"jsonschema\";\nimport merge from \"deepmerge\";\nimport Cookies from \"js-cookie\";\nimport jwtDecode from \"jwt-decode\";\n\nconst LOCAL_STORE_KEY = \"___hubs_store\";\nconst STORE_STATE_CACHE_KEY = Symbol();\nconst OAUTH_FLOW_CREDENTIALS_KEY = \"ret-oauth-flow-account-credentials\";\nconst validator = new Validator();\nimport { EventTarget } from \"event-target-shim\";\nimport { generateDefaultProfile, generateRandomName } from \"../utils/identity.js\";\n\n// Durable (via local-storage) schema-enforced state that is meant to be consumed via forward data flow.\n// (Think flux but with way less incidental complexity, at least for now :))\nexport const SCHEMA = {\n  id: \"/HubsStore\",\n\n  definitions: {\n    profile: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        displayName: { type: \"string\", pattern: \"^[A-Za-z0-9-]{3,32}$\" },\n        avatarId: { type: \"string\" },\n        personalAvatarId: { type: \"string\" }\n      }\n    },\n\n    credentials: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        token: { type: [\"null\", \"string\"] },\n        email: { type: [\"null\", \"string\"] }\n      }\n    },\n\n    activity: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        hasFoundFreeze: { type: \"boolean\" },\n        hasChangedName: { type: \"boolean\" },\n        hasAcceptedProfile: { type: \"boolean\" },\n        lastEnteredAt: { type: \"string\" },\n        hasPinned: { type: \"boolean\" },\n        hasRotated: { type: \"boolean\" },\n        hasRecentered: { type: \"boolean\" },\n        hasScaled: { type: \"boolean\" },\n        hasHoveredInWorldHud: { type: \"boolean\" },\n        hasOpenedShare: { type: \"boolean\" },\n        entryCount: { type: \"number\" }\n      }\n    },\n\n    settings: {\n      type: \"object\",\n      additionalProperties: false,\n      properties: {\n        lastUsedMicDeviceId: { type: \"string\" }\n      }\n    },\n\n    // Legacy\n    confirmedDiscordRooms: {\n      type: \"array\",\n      items: { type: \"string\" }\n    },\n\n    confirmedBroadcastedRooms: {\n      type: \"array\",\n      items: { type: \"string\" }\n    },\n\n    uploadPromotionTokens: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          fileId: { type: \"string\" },\n          promotionToken: { type: \"string\" }\n        }\n      }\n    },\n\n    creatorAssignmentTokens: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          hubId: { type: \"string\" },\n          creatorAssignmentToken: { type: \"string\" }\n        }\n      }\n    },\n\n    embedTokens: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          hubId: { type: \"string\" },\n          embedToken: { type: \"string\" }\n        }\n      }\n    },\n\n    onLoadActions: {\n      type: \"array\",\n      items: {\n        type: \"object\",\n        additionalProperties: false,\n        properties: {\n          action: { type: \"string\" },\n          args: { type: \"object\" }\n        }\n      }\n    }\n  },\n\n  type: \"object\",\n\n  properties: {\n    profile: { $ref: \"#/definitions/profile\" },\n    credentials: { $ref: \"#/definitions/credentials\" },\n    activity: { $ref: \"#/definitions/activity\" },\n    settings: { $ref: \"#/definitions/settings\" },\n    confirmedDiscordRooms: { $ref: \"#/definitions/confirmedDiscordRooms\" }, // Legacy\n    confirmedBroadcastedRooms: { $ref: \"#/definitions/confirmedBroadcastedRooms\" },\n    uploadPromotionTokens: { $ref: \"#/definitions/uploadPromotionTokens\" },\n    creatorAssignmentTokens: { $ref: \"#/definitions/creatorAssignmentTokens\" },\n    embedTokens: { $ref: \"#/definitions/embedTokens\" },\n    onLoadActions: { $ref: \"#/definitions/onLoadActions\" }\n  },\n\n  additionalProperties: false\n};\n\nexport default class Store extends EventTarget {\n  constructor() {\n    super();\n\n    if (localStorage.getItem(LOCAL_STORE_KEY) === null) {\n      localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify({}));\n    }\n\n    // When storage is updated in another window\n    window.addEventListener(\"storage\", e => {\n      if (e.key !== LOCAL_STORE_KEY) return;\n      delete this[STORE_STATE_CACHE_KEY];\n      this.dispatchEvent(new CustomEvent(\"statechanged\"));\n    });\n\n    this.update({\n      activity: {},\n      settings: {},\n      credentials: {},\n      profile: {},\n      confirmedDiscordRooms: [],\n      confirmedBroadcastedRooms: [],\n      uploadPromotionTokens: [],\n      creatorAssignmentTokens: [],\n      embedTokens: [],\n      onLoadActions: []\n    });\n\n    const oauthFlowCredentials = Cookies.getJSON(OAUTH_FLOW_CREDENTIALS_KEY);\n    if (oauthFlowCredentials) {\n      this.update({ credentials: oauthFlowCredentials });\n      this.resetToRandomLegacyAvatar();\n      Cookies.remove(OAUTH_FLOW_CREDENTIALS_KEY);\n    }\n  }\n\n  // Initializes store with any default bits\n  init = () => {\n    this.update({\n      profile: { ...generateDefaultProfile(), ...(this.state.profile || {}) }\n    });\n\n    // Regenerate name to encourage users to change it.\n    if (!this.state.activity.hasChangedName) {\n      this.update({ profile: { displayName: generateRandomName() } });\n    }\n  };\n\n  resetToRandomLegacyAvatar = () => {\n    this.update({\n      profile: { ...(this.state.profile || {}), ...generateDefaultProfile() }\n    });\n  };\n\n  get state() {\n    if (!this.hasOwnProperty(STORE_STATE_CACHE_KEY)) {\n      this[STORE_STATE_CACHE_KEY] = JSON.parse(localStorage.getItem(LOCAL_STORE_KEY));\n    }\n\n    return this[STORE_STATE_CACHE_KEY];\n  }\n\n  get credentialsAccountId() {\n    if (this.state.credentials.token) {\n      return jwtDecode(this.state.credentials.token).sub;\n    } else {\n      return null;\n    }\n  }\n\n  resetConfirmedBroadcastedRooms() {\n    this.clearStoredArray(\"confirmedBroadcastedRooms\");\n  }\n\n  resetTipActivityFlags() {\n    this.update({\n      activity: { hasRotated: false, hasPinned: false, hasRecentered: false, hasScaled: false, entryCount: 0 }\n    });\n  }\n\n  bumpEntryCount() {\n    const currentEntryCount = this.state.activity.entryCount || 0;\n    this.update({ activity: { entryCount: currentEntryCount + 1 } });\n  }\n\n  // Sets a one-time action to perform the next time the page loads\n  enqueueOnLoadAction(action, args) {\n    this.update({ onLoadActions: [{ action, args }] });\n  }\n\n  executeOnLoadActions(sceneEl) {\n    for (let i = 0; i < this.state.onLoadActions.length; i++) {\n      const { action, args } = this.state.onLoadActions[i];\n\n      if (action === \"emit_scene_event\") {\n        sceneEl.emit(args.event, args.detail);\n      }\n    }\n\n    this.clearOnLoadActions();\n  }\n\n  clearOnLoadActions() {\n    this.clearStoredArray(\"onLoadActions\");\n  }\n\n  clearStoredArray(key) {\n    const overwriteMerge = (destinationArray, sourceArray) => sourceArray;\n    const update = {};\n    update[key] = [];\n\n    this.update(update, { arrayMerge: overwriteMerge });\n  }\n\n  update(newState, mergeOpts) {\n    const finalState = merge(this.state, newState, mergeOpts);\n    const { valid } = validator.validate(finalState, SCHEMA);\n\n    if (!valid) {\n      // Intentionally not including details about the state or validation result here, since we don't want to leak\n      // sensitive data in the error message.\n      throw new Error(`Write to store failed schema validation.`);\n    }\n\n    localStorage.setItem(LOCAL_STORE_KEY, JSON.stringify(finalState));\n    delete this[STORE_STATE_CACHE_KEY];\n\n    if (newState.profile !== undefined) {\n      this.dispatchEvent(new CustomEvent(\"profilechanged\"));\n    }\n    this.dispatchEvent(new CustomEvent(\"statechanged\"));\n\n    return finalState;\n  }\n}\n","// NOTE: We do not use an IV since we generate a new keypair each time we use these routines.\n\nasync function deriveKey(privateKey, publicKey) {\n  return crypto.subtle.deriveKey(\n    { name: \"ECDH\", public: publicKey },\n    privateKey,\n    { name: \"AES-CBC\", length: 256 },\n    true,\n    [\"encrypt\", \"decrypt\"]\n  );\n}\n\nasync function publicKeyToString(key) {\n  return JSON.stringify(await crypto.subtle.exportKey(\"jwk\", key));\n}\n\nasync function stringToPublicKey(s) {\n  return await crypto.subtle.importKey(\"jwk\", JSON.parse(s), { name: \"ECDH\", namedCurve: \"P-256\" }, true, []);\n}\n\nfunction stringToArrayBuffer(s) {\n  const buf = new Uint8Array(s.length);\n\n  for (let i = 0; i < s.length; i++) {\n    buf[i] = s.charCodeAt(i);\n  }\n\n  return buf;\n}\n\nfunction arrayBufferToString(b) {\n  const buf = new Uint8Array(b);\n  let s = \"\";\n\n  for (let i = 0; i < buf.byteLength; i++) {\n    s += String.fromCharCode(buf[i]);\n  }\n\n  return s;\n}\n\n// This allows a single object to be passed encrypted from a receiver in a req -> response flow\n\n// Requestor generates a public key and private key, and should send the public key to receiver.\nexport async function generateKeys() {\n  const keyPair = await crypto.subtle.generateKey({ name: \"ECDH\", namedCurve: \"P-256\" }, true, [\"deriveKey\"]);\n  const publicKeyString = await publicKeyToString(keyPair.publicKey);\n  return { publicKeyString, privateKey: keyPair.privateKey };\n}\n\n// Receiver takes the public key from requestor and passes obj to get a response public key and the encrypted data to return.\nexport async function generatePublicKeyAndEncryptedObject(incomingPublicKeyString, obj) {\n  const iv = new Uint8Array(16);\n  const incomingPublicKey = await stringToPublicKey(incomingPublicKeyString);\n  const keyPair = await crypto.subtle.generateKey({ name: \"ECDH\", namedCurve: \"P-256\" }, true, [\"deriveKey\"]);\n  const publicKeyString = await publicKeyToString(keyPair.publicKey);\n  const secret = await deriveKey(keyPair.privateKey, incomingPublicKey);\n\n  const encryptedData = btoa(\n    arrayBufferToString(\n      await crypto.subtle.encrypt({ name: \"AES-CBC\", iv }, secret, stringToArrayBuffer(JSON.stringify(obj)))\n    )\n  );\n\n  return { publicKeyString, encryptedData };\n}\n\n// Requestor then takes the receiver's public key, the private key (returned from generateKeys()), and the data from the receiver.\nexport async function decryptObject(publicKeyString, privateKey, base64value) {\n  const iv = new Uint8Array(16);\n  const publicKey = await stringToPublicKey(publicKeyString);\n  const secret = await deriveKey(privateKey, publicKey);\n  const ciphertext = stringToArrayBuffer(atob(base64value));\n  const data = await crypto.subtle.decrypt({ name: \"AES-CBC\", iv }, secret, ciphertext);\n  return JSON.parse(arrayBufferToString(data));\n}\n","import { generatePublicKeyAndEncryptedObject, generateKeys, decryptObject } from \"./crypto\";\n\nconst LINK_ACTION_TIMEOUT = 10000;\n\nexport default class LinkChannel {\n  constructor(store) {\n    this.store = store;\n  }\n\n  setSocket = socket => {\n    this.socket = socket;\n  };\n\n  // Returns a promise that, when resolved, will forward an object with three keys:\n  //\n  // code: The code that was made available to use for link.\n  //\n  // cancel: A function that the caller can call to cancel the use of the code.\n  //\n  // onFinished: A promise that, when resolved, indicates the code is no longer usable,\n  // because it was either successfully used by the remote device or it has expired\n  // (\"used\" or \"expired\" is passed to the callback).\n  generateCode = () => {\n    return new Promise(resolve => {\n      const onFinished = new Promise(finished => {\n        const step = () => {\n          const getLetter = () => \"ABCDEFGHI\"[Math.floor(Math.random() * 9)];\n          const code = `${getLetter()}${getLetter()}${getLetter()}${getLetter()}`;\n\n          // Only respond to one link_request in this channel.\n          let readyToSend = false;\n          let leftChannel = false;\n\n          const channel = this.socket.channel(`link:${code}`, { timeout: LINK_ACTION_TIMEOUT });\n\n          const leave = () => {\n            if (!leftChannel) channel.leave();\n            leftChannel = true;\n          };\n\n          const cancel = () => leave();\n\n          channel.on(\"link_expired\", () => finished(\"expired\"));\n\n          channel.on(\"presence_state\", state => {\n            if (readyToSend) return;\n\n            if (Object.keys(state).length > 0) {\n              // Code is in use by someone else, try a new one\n              step();\n            } else {\n              readyToSend = true;\n              resolve({ code, cancel, onFinished });\n            }\n          });\n\n          channel.on(\"link_request\", incoming => {\n            if (readyToSend) {\n              const data = { path: location.pathname };\n\n              // Copy profile data to link'ed device if it's been set.\n              if (this.store.state.activity.hasChangedName) {\n                data.profile = { ...this.store.state.profile };\n              }\n              data.credentials = { ...this.store.state.credentials };\n\n              generatePublicKeyAndEncryptedObject(incoming.public_key, data).then(\n                ({ publicKeyString, encryptedData }) => {\n                  const payload = {\n                    target_session_id: incoming.reply_to_session_id,\n                    public_key: publicKeyString,\n                    data: encryptedData\n                  };\n\n                  if (!leftChannel) {\n                    channel.push(\"link_response\", payload);\n                  }\n\n                  leave();\n\n                  finished(\"used\");\n                  readyToSend = false;\n                }\n              );\n            }\n          });\n\n          channel.join().receive(\"error\", r => console.error(r));\n        };\n\n        step();\n      });\n    });\n  };\n\n  // Attempts to receive a link payload from a remote device using the given code.\n  //\n  // Promise rejects if the code is invalid or there is a problem with the channel.\n  // Promise resolves and passes payload of link source on successful link.\n  attemptLink = code => {\n    return new Promise((resolve, reject) => {\n      const channel = this.socket.channel(`link:${code}`, { timeout: LINK_ACTION_TIMEOUT });\n      let finished = false;\n\n      generateKeys().then(({ publicKeyString, privateKey }) => {\n        channel.on(\"presence_state\", state => {\n          const numOccupants = Object.keys(state).length;\n\n          if (numOccupants === 1) {\n            // Great, only sender is in topic, request link\n            channel.push(\"link_request\", {\n              reply_to_session_id: this.socket.params().session_id,\n              public_key: publicKeyString\n            });\n\n            setTimeout(() => {\n              if (finished) return;\n              channel.leave();\n              reject(new Error(\"no_response\"));\n            }, LINK_ACTION_TIMEOUT);\n          } else if (numOccupants === 0) {\n            // Nobody in this channel, probably a bad code.\n            channel.leave();\n            reject(new Error(\"failed\"));\n          } else {\n            console.warn(\"link code channel already has 2 or more occupants, something fishy is going on.\");\n            channel.leave();\n            reject(new Error(\"in_use\"));\n          }\n        });\n\n        channel.on(\"link_response\", payload => {\n          finished = true;\n          channel.leave();\n\n          decryptObject(payload.public_key, privateKey, payload.data).then(resolve);\n        });\n\n        channel\n          .join()\n          .receive(\"ok\", data => (this.socket.params().session_id = data.session_id))\n          .receive(\"error\", r => console.error(r));\n      });\n    });\n  };\n}\n","import screenfull from \"screenfull\";\nimport { showFullScreenIfWasFullScreen } from \"./fullscreen\";\nconst { detect } = require(\"detect-browser\");\n\nconst browser = detect();\nlet isExitingFullscreenDueToFocus = false;\n\n// Utility function that handles a bunch of incidental stuff related to text fields:\n//\n// - On non-mobile platforms, selects the value on focus\n// - If full screen, exits/enters full screen because of firefox full screen issues\nexport function handleTextFieldFocus(target) {\n  if (!window.AFRAME) return;\n  const isMobile = AFRAME.utils.device.isMobile();\n\n  if (screenfull.isFullscreen && !AFRAME.utils.device.isMobileVR() && browser.name === \"firefox\") {\n    // This will prevent focus, but its the only way to avoid getting into a\n    // weird \"firefox reports full screen but actually not\". You end up having to tap\n    // twice to ultimately get the focus.\n    //\n    // We need to keep track of a bit here so that we don't re-full screen when\n    // the text box is blurred by the browser.\n\n    isExitingFullscreenDueToFocus = true;\n    screenfull.exit().then(() => {\n      target.focus();\n    });\n  }\n\n  if (!isMobile) target.select();\n}\n\nexport function handleTextFieldBlur() {\n  // This is the incidental blur event when exiting fullscreen mode on mobile\n  if (isExitingFullscreenDueToFocus) {\n    isExitingFullscreenDueToFocus = false;\n    return;\n  }\n\n  showFullScreenIfWasFullScreen();\n}\n","module.exports = __webpack_public_path__ + \"assets/images/mic_denied-5ce12e4dc9b5eb42ce69b753c46c2174.png\";","module.exports = __webpack_public_path__ + \"assets/images/mic_denied@2x-127a94ff73b93a0b4ac89682ce836b91.png\";","// Enumeration of spawned object content origins. URL means the content is\n// fetched from a URL, FILE means it was an uploaded/dropped file, and\n// CLIPBOARD means it was raw data pasted in from the clipboard, SPAWNER means\n// it was copied over from a spawner.\nexport const ObjectContentOrigins = {\n  URL: 1,\n  FILE: 2,\n  CLIPBOARD: 3,\n  SPAWNER: 4\n};\n\n// Enumeration of spawnable object types, used for telemetry, which encapsulates\n// both the origin of the content for the object and also the type of content\n// contained in the object.\nexport const ObjectTypes = {\n  URL_IMAGE: 0,\n  URL_VIDEO: 1,\n  URL_MODEL: 2,\n  URL_PDF: 3,\n  URL_AUDIO: 4,\n  //URL_TEXT: 5,\n  //URL_TELEPORTER: 6,\n  FILE_IMAGE: 8,\n  FILE_VIDEO: 9,\n  FILE_MODEL: 10,\n  FILE_PDF: 11,\n  FILE_AUDIO: 12,\n  //FILE_TEXT: 13,\n  CLIPBOARD_IMAGE: 16,\n  CLIPBOARD_VIDEO: 17,\n  CLIPBOARD_MODEL: 18,\n  CLIPBOARD_PDF: 19,\n  CLIPBOARD_AUDIO: 20,\n  //CLIPBOARD_TEXT: 21,\n  SPAWNER_IMAGE: 24,\n  SPAWNER_VIDEO: 25,\n  SPAWNER_MODEL: 26,\n  SPAWNER_PDF: 27,\n  SPAWNER_AUDIO: 28,\n  //SPAWNER_TEXT: 29,\n  CAMERA: 30,\n  UNKNOWN: 31\n};\n\n// Given an origin and three object type values for URL, FILE, and CLIPBOARD\n// origins respectively, return the appropriate one\nfunction objectTypeForOrigin(contentOrigin, urlType, fileType, clipboardType, spawnerType) {\n  if (contentOrigin === ObjectContentOrigins.URL) {\n    return urlType;\n  } else if (contentOrigin === ObjectContentOrigins.FILE) {\n    return fileType;\n  } else if (contentOrigin === ObjectContentOrigins.CLIPBOARD) {\n    return clipboardType;\n  } else {\n    return spawnerType;\n  }\n}\n\n// Lookup table of mime-type prefixes to the set of object types that we should use\n// for objects spawned matching their underlying Content-Type.\nconst objectTypeMimePrefixLookupMap = {\n  \"image/\": [ObjectTypes.URL_IMAGE, ObjectTypes.FILE_IMAGE, ObjectTypes.CLIPBOARD_IMAGE, ObjectTypes.SPAWNER_IMAGE],\n  \"model/\": [ObjectTypes.URL_MODEL, ObjectTypes.FILE_MODEL, ObjectTypes.CLIPBOARD_MODEL, ObjectTypes.SPAWNER_MODEL],\n  \"application/x-zip-compressed\": [\n    ObjectTypes.URL_MODEL,\n    ObjectTypes.FILE_MODEL,\n    ObjectTypes.CLIPBOARD_MODEL,\n    ObjectTypes.SPAWNER_MODEL\n  ],\n  \"video/\": [ObjectTypes.URL_VIDEO, ObjectTypes.FILE_VIDEO, ObjectTypes.CLIPBOARD_VIDEO, ObjectTypes.SPAWNER_VIDEO],\n  \"application/vnd.apple.mpegurl\": [\n    ObjectTypes.URL_VIDEO,\n    ObjectTypes.FILE_VIDEO,\n    ObjectTypes.CLIPBOARD_VIDEO,\n    ObjectTypes.SPAWNER_VIDEO\n  ],\n  \"application/x-mpegurl\": [\n    ObjectTypes.URL_VIDEO,\n    ObjectTypes.FILE_VIDEO,\n    ObjectTypes.CLIPBOARD_VIDEO,\n    ObjectTypes.SPAWNER_VIDEO\n  ],\n  \"audio/\": [ObjectTypes.URL_AUDIO, ObjectTypes.FILE_AUDIO, ObjectTypes.CLIPBOARD_AUDIO, ObjectTypes.SPAWNER_AUDIO],\n  \"application/pdf\": [ObjectTypes.URL_PDF, ObjectTypes.FILE_PDF, ObjectTypes.CLIPBOARD_PDF, ObjectTypes.SPAWNER_PDF]\n};\n\nconst srcSuffixLookupMap = {\n  \".m3u8\": [ObjectTypes.URL_VIDEO, ObjectTypes.FILE_VIDEO, ObjectTypes.CLIPBOARD_VIDEO, ObjectTypes.SPAWNER_VIDEO]\n};\n\n// Given an content origin and the resolved mime type of a piece of content, return\n// the ObjectType, if any, for that content.\nexport function objectTypeForOriginAndContentType(contentOrigin, contentType, src) {\n  for (const prefix in objectTypeMimePrefixLookupMap) {\n    if (contentType.toLowerCase().startsWith(prefix)) {\n      const types = objectTypeMimePrefixLookupMap[prefix];\n      return objectTypeForOrigin(contentOrigin, ...types);\n    }\n  }\n\n  if (src) {\n    for (const suffix in srcSuffixLookupMap) {\n      if (src.toLowerCase().endsWith(suffix)) {\n        const types = srcSuffixLookupMap[suffix];\n        return objectTypeForOrigin(contentOrigin, ...types);\n      }\n    }\n  }\n\n  return ObjectTypes.UNKNOWN;\n}\n","export const avatars = [\n  {\n    id: \"botdefault\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotDefault_Avatar-9f71f8ff22.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botdefault-thumb-42C4C7D3C01D085EAFDAC8BACE591CE6.png\"\n  },\n  {\n    id: \"botbobo\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotBobo_Avatar-f9740a010b.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botbobo-thumb-261278FD5831E9CD89610D15948F23E4.png\"\n  },\n  {\n    id: \"botdom\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotDom_Avatar-0c48bf15a5.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botdom-thumb-1160EB5E81D24F12CE643C520CE1E99E.png\"\n  },\n  {\n    id: \"botgreg\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotGreg_Avatar-98d39797bb.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botgreg-thumb-F2A37F14F9C342EE44DDE9B24DD9B9FC.png\"\n  },\n  {\n    id: \"botguest\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotGuest_Avatar-78cd857332.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botguest-thumb-F7A471250E2C10C2709325C3B02A8BBB.png\"\n  },\n  {\n    id: \"botjim\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotJim_Avatar-d28005a687.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botjim-thumb-A2D195C1A51A082BCED58BD172481B39.png\"\n  },\n  {\n    id: \"botkev\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotKev_Avatar-a95787bb51.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botkev-thumb-90746A7349E3F964C913EA612EE9A53F.png\"\n  },\n  {\n    id: \"botpinky\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotPinky_Avatar-b0b93f8675.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botpinky-thumb-C2E69D4479077766B988DC3EE4F30BE5.png\"\n  },\n  {\n    id: \"botrobert\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotRobert_Avatar-e9554880f3.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botrobert-thumb-9C33F2C752326E2CF4321EAA7BDB4E47.png\"\n  },\n  {\n    id: \"botwoody\",\n    model: \"https://asset-bundles-prod.reticulum.io/bots/BotWoody_Avatar-0140485a23.gltf\",\n    thumbnail: \"https://asset-bundles-prod.reticulum.io/bots/botwoody-thumb-F1F1FA7E21301B5AC1D8872B4ED0CC56.png\"\n  }\n];\n","import Raven from \"raven-js\";\n\nconst ga = window.ga;\n\nexport default function registerTelemetry(trackedPage, trackedTitle) {\n  const sentryDsn = process.env.SENTRY_DSN;\n  const gaTrackingId = process.env.GA_TRACKING_ID;\n\n  if (sentryDsn) {\n    console.log(\"Tracking: Sentry DSN: \" + sentryDsn);\n    Raven.config(sentryDsn).install();\n  }\n\n  if (ga && gaTrackingId) {\n    console.log(\"Tracking: Google Analytics ID: \" + gaTrackingId);\n\n    ga(\"create\", gaTrackingId, \"auto\");\n\n    if (trackedPage) {\n      ga(\"set\", \"page\", trackedPage);\n    }\n\n    if (trackedTitle) {\n      ga(\"set\", \"title\", trackedTitle);\n    }\n\n    ga(\"send\", \"pageview\");\n  }\n}\n","import qsTruthy from \"./qs_truthy\";\n\nconst showLog = qsTruthy(\"debug_log\");\n\nif (showLog) {\n  const template = document.createElement(\"template\");\n  template.innerHTML = `\n    <style>\n      #debug-log {\n        position: absolute;\n        top: 13em;\n        background: white;\n        opacity: 0.7;\n        z-index: 1000;\n      }\n      #debug-log, #debug-log-input {\n        font-family: monospace;\n        font-size: 11px;\n        width: 100%;\n      }\n\n      #debug-log-controls {\n        display: flex;\n        padding: 0.2em;\n      }\n\n      #debug-log-eval {\n        display: flex;\n        flex: 1;\n      }\n\n      #debug-log-log {\n        overflow: auto;\n        height: 30vh;\n      }\n      #debug-log-log.minimized {\n        height: auto;\n      }\n      #debug-log-log.minimized .entry {\n        display: none;\n      }\n      #debug-log-log.minimized .entry:last-child {\n        display: block;\n      }\n      #debug-log-log .entry {\n        border: 1px solid grey;\n        margin: 0.2em;\n        padding: 0.2em;\n      }\n      #debug-log-log .entry.error { background-color: pink; }\n      #debug-log-log .entry.warn { background-color: orange; }\n    </style>\n    <div id=\"debug-log\">\n        <div id=\"debug-log-controls\">\n          <form id=\"debug-log-eval\">\n            <input id=\"debug-log-input\" placeholder=\"&gt;&gt;\" autocorrect=\"off\" autocapitalize=\"none\" />\n            <button>&gt;</button>\n          </form>\n          <button id=\"debug-log-minimize\">_</button>\n        </div>\n        <div id=\"debug-log-log\"></div>\n    </div>\n  `;\n\n  document.addEventListener(\"DOMContentLoaded\", () => {\n    document.body.appendChild(template.content);\n  });\n\n  const debugLog = template.content.querySelector(\"#debug-log-log\");\n  debugLog.addEventListener(\"wheel\", e => e.stopPropagation());\n\n  const debugLogInput = template.content.querySelector(\"#debug-log-input\");\n  const debugLogEval = template.content.querySelector(\"#debug-log-eval\");\n  debugLogEval.onsubmit = e => {\n    e.preventDefault();\n    console.log(eval(`(${debugLogInput.value})`));\n  };\n\n  let minimized = false;\n  const debugLogMinimize = template.content.querySelector(\"#debug-log-minimize\");\n  debugLogMinimize.onclick = () => {\n    minimized = !minimized;\n    debugLog.className = minimized ? \"minimized\" : \"\";\n    debugLog.scrollTop = debugLog.scrollHeight - debugLog.clientHeight;\n  };\n\n  const origConsoleLog = console.log;\n  const origConsoleError = console.error;\n  const origConsoleWarn = console.warn;\n\n  const log = function(className, objs) {\n    let entry;\n    if (debugLog.childNodes.length > 1000) {\n      entry = debugLog.firstChild;\n    } else {\n      entry = document.createElement(\"div\");\n      entry.classList.add(\"entry\");\n    }\n    entry.classList.remove(\"warn\", \"error\");\n    entry.classList.add(className);\n\n    const arr = Array.from(objs);\n    const firstObj = arr[0];\n    let content;\n    if (typeof firstObj === \"string\" && firstObj.includes(\"%c\")) {\n      content = firstObj.replace(/%c/g, \"\");\n    } else if (firstObj instanceof Error) {\n      content = `${firstObj.message}\\n${firstObj.stack}`;\n    } else {\n      content = arr\n        .map(obj => {\n          if (typeof obj === \"string\") return obj;\n          return JSON.stringify(obj);\n        })\n        .join(\" \");\n    }\n\n    const time = new Date().toISOString().substring(11, 23);\n    entry.textContent = `[${time}] ${content}`;\n\n    const shouldScroll = debugLog.scrollTop === debugLog.scrollHeight - debugLog.clientHeight;\n    debugLog.append(entry);\n    if (shouldScroll) debugLog.scrollTop = debugLog.scrollHeight - debugLog.clientHeight;\n  };\n\n  console.warn = function() {\n    origConsoleWarn.apply(null, arguments);\n    log(\"warn\", arguments);\n  };\n\n  console.error = function() {\n    origConsoleError.apply(null, arguments);\n    log(\"error\", arguments);\n  };\n\n  console.log = function() {\n    origConsoleLog.apply(null, arguments);\n    log(\"log\", arguments);\n  };\n\n  window.onunhandledrejection = e => log(\"error\", [e.reason.message, e.reason.code, e.reason.name]);\n  window.onerror = e => log(\"error\", [e]);\n}\n","const zeroPos = new THREE.Vector3(0, 0, 0);\nconst zeroQuat = new THREE.Quaternion();\nconst oneScale = new THREE.Vector3(1, 1, 1);\nconst identity = new THREE.Matrix4();\nidentity.identity();\n\n// Patch animation system\nconst bindingSetters = THREE.PropertyBinding.prototype.SetterByBindingTypeAndVersioning;\nconst Versioning = THREE.PropertyBinding.prototype.Versioning;\n\n// For all binding types, monkey patch the setters that require world matrix\n// updates to also flip matrixNeedsUpdate\nfor (let i = 0; i < bindingSetters.length; i++) {\n  const setter = bindingSetters[i][Versioning.MatrixWorldNeedsUpdate];\n  if (!setter) continue;\n\n  bindingSetters[i][Versioning.MatrixWorldNeedsUpdate] = function() {\n    const v = setter.apply(this, arguments);\n    this.targetObject.matrixNeedsUpdate = true;\n    return v;\n  };\n}\n\nTHREE.Object3D.prototype.getWorldPosition = function(target) {\n  if (target === undefined) {\n    console.warn(\"THREE.Object3D: .getWorldPosition() target is now required\");\n    target = new THREE.Vector3();\n  }\n\n  // New function, defined below (used instead of updateMatrixWorld)\n  this.updateMatrices();\n\n  return target.setFromMatrixPosition(this.matrixWorld);\n};\n\nTHREE.Object3D.prototype.getWorldQuaternion = (function() {\n  const position = new THREE.Vector3();\n  const scale = new THREE.Vector3();\n\n  return function getWorldQuaternion(target) {\n    if (target === undefined) {\n      console.warn(\"THREE.Object3D: .getWorldQuaternion() target is now required\");\n      target = new THREE.Quaternion();\n    }\n\n    // New function, defined below (used instead of updateMatrixWorld)\n    this.updateMatrices();\n    this.matrixWorld.decompose(position, target, scale);\n\n    return target;\n  };\n})();\n\nTHREE.Object3D.getWorldScale = (function() {\n  const position = new THREE.Vector3();\n  const quaternion = new THREE.Quaternion();\n\n  return function getWorldScale(target) {\n    if (target === undefined) {\n      console.warn(\"THREE.Object3D: .getWorldScale() target is now required\");\n      target = new THREE.Vector3();\n    }\n\n    // New function, defined below (used instead of updateMatrixWorld)\n    this.updateMatrices();\n    this.matrixWorld.decompose(position, quaternion, target);\n\n    return target;\n  };\n})();\n\nconst handleMatrixModification = o => {\n  if (!o.matrixIsModified) {\n    o.matrixIsModified = true;\n\n    if (o.cachedMatrixWorld) {\n      o.cachedMatrixWorld.copy(o.matrixWorld);\n      o.matrixWorld = o.cachedMatrixWorld;\n    }\n  }\n};\n\nconst updateMatrix = THREE.Object3D.prototype.updateMatrix;\nTHREE.Object3D.prototype.updateMatrix = function() {\n  updateMatrix.apply(this, arguments);\n  handleMatrixModification(this);\n};\n\nconst applyMatrix = THREE.Object3D.prototype.applyMatrix;\nTHREE.Object3D.prototype.applyMatrix = function() {\n  applyMatrix.apply(this, arguments);\n  handleMatrixModification(this);\n};\n\n// By the end of this function this.matrix reflects the updated local matrix\n// and this.matrixWorld reflects the updated world matrix, taking into account\n// parent matrices.\n//\n// forceLocalUpdate - Forces the local matrix to be updated regardless of if it has not\n// been marked dirty.\n//\n// forceWorldUpdate - Forces the world matrix to be updated regardless of if the local matrix\n// has been updated since the last update.\n//\n// skipParents - unless true, all parent matricies are updated before updating this object's\n// local and world matrix.\n//\nTHREE.Object3D.prototype.updateMatrices = function(forceLocalUpdate, forceWorldUpdate, skipParents) {\n  if (!this.hasHadFirstMatrixUpdate) {\n    if (\n      !this.position.equals(zeroPos) ||\n      !this.quaternion.equals(zeroQuat) ||\n      !this.scale.equals(oneScale) ||\n      !this.matrix.equals(identity)\n    ) {\n      // Only update the matrix the first time if its non-identity, this way\n      // this.matrixIsModified will remain false until the default\n      // identity matrix is updated.\n      this.updateMatrix();\n    }\n\n    this.hasHadFirstMatrixUpdate = true;\n    this.matrixWorldNeedsUpdate = true;\n    this.cachedMatrixWorld = this.matrixWorld;\n  } else if (this.matrixNeedsUpdate || this.matrixAutoUpdate || forceLocalUpdate) {\n    this.updateMatrix();\n    if (this.matrixNeedsUpdate) this.matrixNeedsUpdate = false;\n  }\n\n  if (!skipParents && this.parent) {\n    this.parent.updateMatrices(false, forceWorldUpdate, false);\n    this.matrixWorldNeedsUpdate = this.matrixWorldNeedsUpdate || this.parent.childrenNeedMatrixWorldUpdate;\n  }\n\n  if (this.matrixWorldNeedsUpdate || forceWorldUpdate) {\n    if (this.parent === null) {\n      this.matrixWorld.copy(this.matrix);\n    } else {\n      // If the matrix is unmodified, it is the identity matrix,\n      // and hence we can use the parent's world matrix directly.\n      //\n      // Note this assumes all callers will either not pass skipParents=true\n      // *or* will update the parent themselves beforehand as is done in\n      // updateMatrixWorld.\n      if (!this.matrixIsModified) {\n        this.matrixWorld = this.parent.matrixWorld;\n      } else {\n        // Once matrixIsModified === true, this.matrixWorld has been updated to be a local\n        // copy, not a reference to this.parent.matrixWorld (see updateMatrix/applyMatrix)\n        this.matrixWorld.multiplyMatrices(this.parent.matrixWorld, this.matrix);\n      }\n    }\n\n    this.childrenNeedMatrixWorldUpdate = true;\n    this.matrixWorldNeedsUpdate = false;\n  }\n};\n\n// Computes this object's matrices and then the recursively computes the matrices of all the children.\n//\n// forceWorldUpdate - If true and the object is visible, will force the world matrix to be updated for\n// this node and all of its children.\n//\n// includeInvisible - If true, does not ignore non-visible objects.\nTHREE.Object3D.prototype.updateMatrixWorld = function(forceWorldUpdate, includeInvisible) {\n  if (!this.visible && !includeInvisible) return;\n\n  // Do not recurse upwards, since this is recursing downwards\n  this.updateMatrices(false, forceWorldUpdate, true);\n\n  const children = this.children;\n  const forceChildrenWorldUpdate = this.childrenNeedMatrixWorldUpdate || forceWorldUpdate;\n\n  for (let i = 0, l = children.length; i < l; i++) {\n    children[i].updateMatrixWorld(forceChildrenWorldUpdate, includeInvisible);\n  }\n\n  if (this.childrenNeedMatrixWorldUpdate) this.childrenNeedMatrixWorldUpdate = false;\n};\n\n// Updates this function to use updateMatrices() to avoid extra matrix computations\nTHREE.Object3D.prototype.lookAt = (function() {\n  // This method does not support objects having non-uniformly-scaled parent(s)\n\n  const q1 = new THREE.Quaternion();\n  const m1 = new THREE.Matrix4();\n  const target = new THREE.Vector3();\n  const position = new THREE.Vector3();\n\n  return function lookAt(x, y, z) {\n    if (x.isVector3) {\n      target.copy(x);\n    } else {\n      target.set(x, y, z);\n    }\n\n    const parent = this.parent;\n\n    this.updateMatrices(); // hubs change\n\n    position.setFromMatrixPosition(this.matrixWorld);\n\n    if (this.isCamera || this.isLight) {\n      m1.lookAt(position, target, this.up);\n    } else {\n      m1.lookAt(target, position, this.up);\n    }\n\n    this.quaternion.setFromRotationMatrix(m1);\n\n    if (parent) {\n      m1.extractRotation(parent.matrixWorld);\n      q1.setFromRotationMatrix(m1);\n      this.quaternion.premultiply(q1.inverse());\n    }\n  };\n})();\n","/* eslint-disable */\n\n// Modified version of A-Frame's animation component to set matrixNeedsUpdate = true in the\n// scenario where the transform changes on an object during an animation.\n//\n// Changes are identified w comment // hubs\n//\n// Bugfix added 3/1/19 - If an animation component is removed before its delay setting, then\n// it erroneously restarts.\n\nvar anime = require(\"animejs\").default;\nvar components = AFRAME.components; // hubs\nvar registerComponent = AFRAME.registerComponent; // hubs\n//var THREE = require('../lib/three'); // hubs\nvar utils = AFRAME.utils; // hubs\n\ndelete AFRAME.components.animation; // hubs\n\nvar colorHelperFrom = new THREE.Color();\nvar colorHelperTo = new THREE.Color();\n\nvar getComponentProperty = utils.entity.getComponentProperty;\nvar setComponentProperty = utils.entity.setComponentProperty;\nvar splitCache = {};\n\nvar TYPE_COLOR = \"color\";\nvar PROP_POSITION = \"position\";\nvar PROP_ROTATION = \"rotation\";\nvar PROP_SCALE = \"scale\";\nvar STRING_COMPONENTS = \"components\";\nvar STRING_OBJECT3D = \"object3D\";\n\n/**\n * Animation component for A-Frame using anime.js.\n *\n * The component manually controls the tick by setting `autoplay: false` on anime.js and\n * manually * calling `animation.tick()` in the tick handler. To pause or resume, we toggle a\n * boolean * flag * `isAnimationPlaying`.\n *\n * anime.js animation config for tweenining Javascript objects and values works as:\n *\n *  config = {\n *    targets: {foo: 0.0, bar: '#000'},\n *    foo: 1.0,\n *    bar: '#FFF'\n *  }\n *\n * The above will tween each property in `targets`. The `to` values are set in the root of\n * the config.\n *\n * @member {object} animation - anime.js instance.\n * @member {boolean} animationIsPlaying - Control if animation is playing.\n */\nmodule.exports.Component = registerComponent(\"animation\", {\n  schema: {\n    autoplay: { default: true },\n    delay: { default: 0 },\n    dir: { default: \"\" },\n    dur: { default: 1000 },\n    easing: { default: \"easeInQuad\" },\n    elasticity: { default: 400 },\n    enabled: { default: true },\n    from: { default: \"\" },\n    loop: {\n      default: 0,\n      parse: function(value) {\n        // Boolean or integer.\n        if (value === true || value === \"true\") {\n          return true;\n        }\n        if (value === false || value === \"false\") {\n          return false;\n        }\n        return parseInt(value, 10);\n      }\n    },\n    property: { default: \"\" },\n    startEvents: { type: \"array\" },\n    pauseEvents: { type: \"array\" },\n    resumeEvents: { type: \"array\" },\n    round: { default: false },\n    to: { default: \"\" },\n    type: { default: \"\" },\n    isRawProperty: { default: false }\n  },\n\n  multiple: true,\n\n  init: function() {\n    var self = this;\n\n    this.eventDetail = { name: this.attrName };\n    this.time = 0;\n\n    this.animation = null;\n    this.animationIsPlaying = false;\n    this.onStartEvent = this.onStartEvent.bind(this);\n    this.beginAnimation = this.beginAnimation.bind(this);\n    this.pauseAnimation = this.pauseAnimation.bind(this);\n    this.resumeAnimation = this.resumeAnimation.bind(this);\n\n    this.fromColor = {};\n    this.toColor = {};\n    this.targets = {};\n    this.targetsArray = [];\n\n    this.updateConfigForDefault = this.updateConfigForDefault.bind(this);\n    this.updateConfigForRawColor = this.updateConfigForRawColor.bind(this);\n\n    this.config = {\n      complete: function() {\n        self.animationIsPlaying = false;\n        self.el.emit(\"animationcomplete\", self.eventDetail, false);\n        if (self.id) {\n          self.el.emit(\"animationcomplete__\" + self.id, self.eventDetail, false);\n        }\n      }\n    };\n  },\n\n  update: function(oldData) {\n    var config = this.config;\n    var data = this.data;\n\n    this.animationIsPlaying = false;\n\n    if (!this.data.enabled) {\n      return;\n    }\n\n    if (!data.property) {\n      return;\n    }\n\n    // Base config.\n    config.autoplay = false;\n    config.direction = data.dir;\n    config.duration = data.dur;\n    config.easing = data.easing;\n    config.elasticity = data.elasticity;\n    config.loop = data.loop;\n    config.round = data.round;\n\n    // Start new animation.\n    this.createAndStartAnimation();\n  },\n\n  tick: function(t, dt) {\n    if (!this.animationIsPlaying) {\n      return;\n    }\n    this.time += dt;\n    this.animation.tick(this.time);\n  },\n\n  remove: function() {\n    this.pauseAnimation();\n    this.removeEventListeners();\n    this.cancelDelayedStart(); // hubs\n  },\n\n  pause: function() {\n    this.paused = true;\n    this.pausedWasPlaying = this.animationIsPlaying;\n    this.pauseAnimation();\n    this.removeEventListeners();\n    this.cancelDelayedStart(); // hubs\n  },\n\n  /**\n   * `play` handler only for resuming scene.\n   */\n  play: function() {\n    if (!this.paused) {\n      return;\n    }\n    this.paused = false;\n    this.addEventListeners();\n    if (this.pausedWasPlaying) {\n      this.resumeAnimation();\n      this.pausedWasPlaying = false;\n    }\n  },\n\n  /**\n   * Start animation from scratch.\n   */\n  createAndStartAnimation: function() {\n    var data = this.data;\n\n    this.updateConfig();\n    this.animationIsPlaying = false;\n    this.animation = anime(this.config);\n\n    this.removeEventListeners();\n    this.cancelDelayedStart(); // hubs\n    this.addEventListeners();\n\n    // Wait for start events for animation.\n    if (!data.autoplay || (data.startEvents && data.startEvents.length)) {\n      return;\n    }\n\n    // Delay animation.\n    if (data.delay) {\n      // hubs\n      this.delayTimeout = setTimeout(this.beginAnimation, data.delay);\n      return;\n    }\n\n    // Play animation.\n    this.beginAnimation();\n  },\n\n  /**\n   * This is before animation start (including from startEvents).\n   * Set to initial state (config.from, time = 0, seekTime = 0).\n   */\n  beginAnimation: function() {\n    this.updateConfig();\n    this.time = 0;\n    this.animationIsPlaying = true;\n    this.stopRelatedAnimations();\n    this.el.emit(\"animationbegin\", this.eventDetail, false);\n  },\n\n  pauseAnimation: function() {\n    this.animationIsPlaying = false;\n  },\n\n  resumeAnimation: function() {\n    this.animationIsPlaying = true;\n  },\n\n  /**\n   * startEvents callback.\n   */\n  onStartEvent: function() {\n    if (!this.data.enabled) {\n      return;\n    }\n\n    this.updateConfig();\n    if (this.animation) {\n      this.animation.pause();\n    }\n    this.animation = anime(this.config);\n\n    // Include the delay before each start event.\n    if (this.data.delay) {\n      setTimeout(this.beginAnimation, this.data.delay);\n      return;\n    }\n    this.beginAnimation();\n  },\n\n  /**\n   * rawProperty: true and type: color;\n   */\n  updateConfigForRawColor: function() {\n    var config = this.config;\n    var data = this.data;\n    var el = this.el;\n    var from;\n    var key;\n    var to;\n\n    if (this.waitComponentInitRawProperty(this.updateConfigForRawColor)) {\n      return;\n    }\n\n    from = data.from === \"\" ? getRawProperty(el, data.property) : data.from;\n    to = data.to;\n\n    // Use r/g/b vector for color type.\n    this.setColorConfig(from, to);\n    from = this.fromColor;\n    to = this.toColor;\n\n    this.targetsArray.length = 0;\n    this.targetsArray.push(from);\n    config.targets = this.targetsArray;\n    for (key in to) {\n      config[key] = to[key];\n    }\n\n    config.update = (function() {\n      var lastValue = {};\n      return function(anim) {\n        var value;\n        value = anim.animatables[0].target;\n        // For animation timeline.\n        if (value.r === lastValue.r && value.g === lastValue.g && value.b === lastValue.b) {\n          return;\n        }\n\n        setRawProperty(el, data.property, value, data.type);\n      };\n    })();\n  },\n\n  /**\n   * Stuff property into generic `property` key.\n   */\n  updateConfigForDefault: function() {\n    var config = this.config;\n    var data = this.data;\n    var el = this.el;\n    var from;\n    var isBoolean;\n    var isNumber;\n    var to;\n\n    if (this.waitComponentInitRawProperty(this.updateConfigForDefault)) {\n      return;\n    }\n\n    if (data.from === \"\") {\n      // Infer from.\n      from = isRawProperty(data) ? getRawProperty(el, data.property) : getComponentProperty(el, data.property);\n    } else {\n      // Explicit from.\n      from = data.from;\n    }\n\n    to = data.to;\n\n    isNumber = !isNaN(from || to);\n    if (isNumber) {\n      from = parseFloat(from);\n      to = parseFloat(to);\n    } else {\n      from = from ? from.toString() : from;\n      to = to ? to.toString() : to;\n    }\n\n    // Convert booleans to integer to allow boolean flipping.\n    isBoolean = data.to === \"true\" || data.to === \"false\" || data.to === true || data.to === false;\n    if (isBoolean) {\n      from = data.from === \"true\" || data.from === true ? 1 : 0;\n      to = data.to === \"true\" || data.to === true ? 1 : 0;\n    }\n\n    this.targets.aframeProperty = from;\n    config.targets = this.targets;\n    config.aframeProperty = to;\n    config.update = (function() {\n      var lastValue;\n\n      return function(anim) {\n        var value;\n        value = anim.animatables[0].target.aframeProperty;\n\n        // Need to do a last value check for animation timeline since all the tweening\n        // begins simultaenously even if the value has not changed. Also better for perf\n        // anyways.\n        if (value === lastValue) {\n          return;\n        }\n        lastValue = value;\n\n        if (isBoolean) {\n          value = value >= 1;\n        }\n\n        if (isRawProperty(data)) {\n          setRawProperty(el, data.property, value, data.type);\n        } else {\n          setComponentProperty(el, data.property, value);\n        }\n      };\n    })();\n  },\n\n  /**\n   * Extend x/y/z/w onto the config.\n   * Update vector by modifying object3D.\n   */\n  updateConfigForVector: function() {\n    var config = this.config;\n    var data = this.data;\n    var el = this.el;\n    var key;\n    var from;\n    var to;\n\n    // Parse coordinates.\n    from =\n      data.from !== \"\"\n        ? utils.coordinates.parse(data.from) // If data.from defined, use that.\n        : getComponentProperty(el, data.property); // If data.from not defined, get on the fly.\n    to = utils.coordinates.parse(data.to);\n\n    if (data.property === PROP_ROTATION) {\n      toRadians(from);\n      toRadians(to);\n    }\n\n    // Set to and from.\n    this.targetsArray.length = 0;\n    this.targetsArray.push(from);\n    config.targets = this.targetsArray;\n    for (key in to) {\n      config[key] = to[key];\n    }\n\n    // If animating object3D transformation, run more optimized updater.\n    if (data.property === PROP_POSITION || data.property === PROP_ROTATION || data.property === PROP_SCALE) {\n      config.update = (function() {\n        var lastValue = {};\n        return function(anim) {\n          var value = anim.animatables[0].target;\n\n          if (data.property === PROP_SCALE) {\n            value.x = Math.max(0.0001, value.x);\n            value.y = Math.max(0.0001, value.y);\n            value.z = Math.max(0.0001, value.z);\n          }\n\n          // For animation timeline.\n          if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\n            return;\n          }\n\n          lastValue.x = value.x;\n          lastValue.y = value.y;\n          lastValue.z = value.z;\n\n          el.object3D[data.property].set(value.x, value.y, value.z);\n          el.object3D.matrixNeedsUpdate = true; // hubs\n        };\n      })();\n      return;\n    }\n\n    // Animating some vector.\n    config.update = (function() {\n      var lastValue = {};\n      return function(anim) {\n        var value = anim.animations[0].target;\n\n        // Animate rotation through radians.\n        // For animation timeline.\n        if (value.x === lastValue.x && value.y === lastValue.y && value.z === lastValue.z) {\n          return;\n        }\n        lastValue.x = value.x;\n        lastValue.y = value.y;\n        lastValue.z = value.z;\n        setComponentProperty(el, data.property, value);\n      };\n    })();\n  },\n\n  /**\n   * Update the config before each run.\n   */\n  updateConfig: function() {\n    var propType;\n\n    // Route config type.\n    propType = getPropertyType(this.el, this.data.property);\n    if (isRawProperty(this.data) && this.data.type === TYPE_COLOR) {\n      this.updateConfigForRawColor();\n    } else if (propType === \"vec2\" || propType === \"vec3\" || propType === \"vec4\") {\n      this.updateConfigForVector();\n    } else {\n      this.updateConfigForDefault();\n    }\n  },\n\n  /**\n   * Wait for component to initialize.\n   */\n  waitComponentInitRawProperty: function(cb) {\n    var componentName;\n    var data = this.data;\n    var el = this.el;\n    var self = this;\n\n    if (data.from !== \"\") {\n      return false;\n    }\n\n    if (!data.property.startsWith(STRING_COMPONENTS)) {\n      return false;\n    }\n\n    componentName = splitDot(data.property)[1];\n    if (el.components[componentName]) {\n      return false;\n    }\n\n    el.addEventListener(\"componentinitialized\", function wait(evt) {\n      if (evt.detail.name !== componentName) {\n        return;\n      }\n      cb();\n      // Since the config was created async, create the animation now since we missed it\n      // earlier.\n      self.animation = anime(self.config);\n      el.removeEventListener(\"componentinitialized\", wait);\n    });\n    return true;\n  },\n\n  /**\n   * Make sure two animations on the same property don't fight each other.\n   * e.g., animation__mouseenter=\"property: material.opacity\"\n   *       animation__mouseleave=\"property: material.opacity\"\n   */\n  stopRelatedAnimations: function() {\n    var component;\n    var componentName;\n    for (componentName in this.el.components) {\n      component = this.el.components[componentName];\n      if (componentName === this.attrName) {\n        continue;\n      }\n      if (component.name !== \"animation\") {\n        continue;\n      }\n      if (!component.animationIsPlaying) {\n        continue;\n      }\n      if (component.data.property !== this.data.property) {\n        continue;\n      }\n      component.animationIsPlaying = false;\n    }\n  },\n\n  addEventListeners: function() {\n    var data = this.data;\n    var el = this.el;\n    addEventListeners(el, data.startEvents, this.onStartEvent);\n    addEventListeners(el, data.pauseEvents, this.pauseAnimation);\n    addEventListeners(el, data.resumeEvents, this.resumeAnimation);\n  },\n\n  removeEventListeners: function() {\n    var data = this.data;\n    var el = this.el;\n    removeEventListeners(el, data.startEvents, this.onStartEvent);\n    removeEventListeners(el, data.pauseEvents, this.pauseAnimation);\n    removeEventListeners(el, data.resumeEvents, this.resumeAnimation);\n  },\n\n  // hubs\n  cancelDelayedStart: function() {\n    if (this.delayTimeout) {\n      clearTimeout(this.delayTimeout);\n      this.delayTimeout = null;\n    }\n  },\n\n  setColorConfig: function(from, to) {\n    colorHelperFrom.set(from);\n    colorHelperTo.set(to);\n    from = this.fromColor;\n    to = this.toColor;\n    from.r = colorHelperFrom.r;\n    from.g = colorHelperFrom.g;\n    from.b = colorHelperFrom.b;\n    to.r = colorHelperTo.r;\n    to.g = colorHelperTo.g;\n    to.b = colorHelperTo.b;\n  }\n});\n\n/**\n * Given property name, check schema to see what type we are animating.\n * We just care whether the property is a vector.\n */\nfunction getPropertyType(el, property) {\n  var component;\n  var componentName;\n  var split;\n  var propertyName;\n\n  split = property.split(\".\");\n  componentName = split[0];\n  propertyName = split[1];\n  component = el.components[componentName] || components[componentName];\n\n  // Primitives.\n  if (!component) {\n    return null;\n  }\n\n  // Dynamic schema. We only care about vectors anyways.\n  if (propertyName && !component.schema[propertyName]) {\n    return null;\n  }\n\n  // Multi-prop.\n  if (propertyName) {\n    return component.schema[propertyName].type;\n  }\n\n  // Single-prop.\n  return component.schema.type;\n}\n\n/**\n * Convert object to radians.\n */\nfunction toRadians(obj) {\n  obj.x = THREE.Math.degToRad(obj.x);\n  obj.y = THREE.Math.degToRad(obj.y);\n  obj.z = THREE.Math.degToRad(obj.z);\n}\n\nfunction addEventListeners(el, eventNames, handler) {\n  var i;\n  for (i = 0; i < eventNames.length; i++) {\n    el.addEventListener(eventNames[i], handler);\n  }\n}\n\nfunction removeEventListeners(el, eventNames, handler) {\n  var i;\n  for (i = 0; i < eventNames.length; i++) {\n    el.removeEventListener(eventNames[i], handler);\n  }\n}\n\nfunction getRawProperty(el, path) {\n  var i;\n  var split;\n  var value;\n  split = splitDot(path);\n  value = el;\n  for (i = 0; i < split.length; i++) {\n    value = value[split[i]];\n  }\n  return value;\n}\n\nfunction setRawProperty(el, path, value, type) {\n  var i;\n  var split;\n  var propertyName;\n  var targetValue;\n\n  if (path.startsWith(\"object3D.rotation\")) {\n    value = THREE.Math.degToRad(value);\n  }\n\n  // Walk.\n  split = splitDot(path);\n  targetValue = el;\n  for (i = 0; i < split.length - 1; i++) {\n    targetValue = targetValue[split[i]];\n  }\n  propertyName = split[split.length - 1];\n\n  // Raw color.\n  if (type === TYPE_COLOR) {\n    if (\"r\" in targetValue[propertyName]) {\n      targetValue[propertyName].r = value.r;\n      targetValue[propertyName].g = value.g;\n      targetValue[propertyName].b = value.b;\n    } else {\n      targetValue[propertyName].x = value.r;\n      targetValue[propertyName].y = value.g;\n      targetValue[propertyName].z = value.b;\n    }\n    return;\n  }\n\n  targetValue[propertyName] = value;\n}\n\nfunction splitDot(path) {\n  if (path in splitCache) {\n    return splitCache[path];\n  }\n  splitCache[path] = path.split(\".\");\n  return splitCache[path];\n}\n\nfunction isRawProperty(data) {\n  return data.isRawProperty || data.property.startsWith(STRING_COMPONENTS) || data.property.startsWith(STRING_OBJECT3D);\n}\n","AFRAME.registerComponent(\"ambient-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 }\n  },\n\n  init() {\n    const el = this.el;\n    this.light = new THREE.AmbientLight();\n    this.el.setObject3D(\"ambient-light\", this.light);\n    this.el.sceneEl.systems.light.registerLight(el);\n    this.rendererSystem = this.el.sceneEl.systems.renderer;\n  },\n\n  update(prevData) {\n    if (this.data.color !== prevData.color) {\n      this.light.color.set(this.data.color);\n      this.rendererSystem.applyColorCorrection(this.light.color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      this.light.intensity = this.data.intensity;\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"ambient-light\");\n  }\n});\n","/**\n * Instantiates and updates a THREE.AnimationMixer on an entity.\n * @component animation-mixer\n */\nAFRAME.registerComponent(\"animation-mixer\", {\n  initMixer(animations) {\n    this.mixer = new THREE.AnimationMixer(this.el.object3D);\n    this.el.object3D.animations = animations;\n    this.animations = animations;\n  },\n\n  tick: function(t, dt) {\n    if (this.mixer) {\n      this.mixer.update(dt / 1000);\n    }\n  }\n});\n","/**\n * Sets the CSS class on an entity.\n * @component css-class\n */\nAFRAME.registerComponent(\"css-class\", {\n  schema: {\n    type: \"string\"\n  },\n  multiple: true,\n  init() {\n    this.el.classList.add(this.data);\n  },\n  update(oldData) {\n    if (this.data !== oldData) {\n      this.el.classList.remove(oldData);\n      this.el.classList.add(this.data);\n    }\n  },\n  remove() {\n    this.el.classList.remove(this.data);\n  }\n});\n","/* global CANNON */\n/**\n * Floats a duck based on its scale.\n * @component duck\n */\nAFRAME.registerComponent(\"duck\", {\n  schema: {\n    initialForce: { default: 0 },\n    maxForce: { default: 6.5 },\n    maxScale: { default: 5 }\n  },\n\n  init: function() {\n    this.physicsSystem = this.el.sceneEl.systems.physics;\n    this.hasBody = false;\n    this.position = new CANNON.Vec3();\n    this.force = new CANNON.Vec3(0, this.data.initialForce, 0);\n    this.initialScale = this.el.object3D.scale.x;\n    this.maxScale = this.data.maxScale * this.initialScale;\n  },\n\n  play: function() {\n    this.physicsSystem.addComponent(this);\n  },\n\n  pause: function() {\n    this.physicsSystem.removeComponent(this);\n  },\n\n  beforeStep: function() {\n    if (this.el.body && NAF.utils.isMine(this.el)) {\n      const currentScale = this.el.object3D.scale.x;\n      const ratio = Math.min(1, (currentScale - this.initialScale) / (this.maxScale - this.initialScale));\n      const force = ratio * this.data.maxForce;\n      if (force > 0) {\n        const angle = Math.random() * Math.PI * 2;\n        const x = Math.cos(angle);\n        const z = Math.sin(angle);\n        this.force.set(x, force, z);\n        this.position.set(x * 0.01, 0, z * 0.01);\n        this.el.object3D.matrixNeedsUpdate = true;\n        this.el.body.applyForce(this.force, this.position);\n      }\n    }\n  }\n});\n","/* global CANNON */\nAFRAME.registerComponent(\"heightfield\", {\n  init() {\n    this.el.addEventListener(\"componentinitialized\", e => {\n      if (e.detail.name === \"static-body\") {\n        this.generateAndAddHeightfield(this.el.components[\"static-body\"]);\n      }\n    });\n    this.el.setAttribute(\"static-body\", { shape: \"none\", mass: 0 });\n  },\n  generateAndAddHeightfield(body) {\n    const { offset, distance, data } = this.data;\n\n    const orientation = new CANNON.Quaternion();\n    orientation.setFromAxisAngle(new CANNON.Vec3(1, 0, 0), -Math.PI / 2);\n\n    const rotation = new CANNON.Quaternion();\n    rotation.setFromAxisAngle(new CANNON.Vec3(0, 1, 0), -Math.PI / 2);\n    rotation.mult(orientation, orientation);\n\n    const cannonOffset = new CANNON.Vec3(offset.x, offset.y, offset.z);\n\n    const shape = new CANNON.Heightfield(data, { elementSize: distance });\n\n    body.addShape(shape, cannonOffset, orientation);\n  }\n});\n","AFRAME.registerComponent(\"hemisphere-light\", {\n  schema: {\n    skyColor: { type: \"color\" },\n    groundColor: { type: \"color\" },\n    intensity: { default: 1.0 }\n  },\n\n  init() {\n    const el = this.el;\n    this.light = new THREE.HemisphereLight();\n    this.light.position.set(0, 0, 0);\n    this.light.matrixNeedsUpdate = true;\n    this.el.setObject3D(\"hemisphere-light\", this.light);\n    this.el.sceneEl.systems.light.registerLight(el);\n  },\n\n  update(prevData) {\n    if (this.data.skyColor !== prevData.skyColor) {\n      this.light.color.set(this.data.skyColor);\n    }\n\n    if (this.data.groundColor !== prevData.groundColor) {\n      this.light.groundColor.set(this.data.groundColor);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      this.light.intensity = this.data.intensity;\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"hemisphere-light\");\n  }\n});\n","/**\n * Hides entities based on the scene's quality mode\n * @namespace environment\n * @component hide-when-quality\n */\nAFRAME.registerComponent(\"hide-when-quality\", {\n  schema: { type: \"string\", default: \"low\" },\n\n  init() {\n    this.onQualityChanged = this.onQualityChanged.bind(this);\n    this.el.sceneEl.addEventListener(\"quality-changed\", this.onQualityChanged);\n  },\n\n  onQualityChanged(event) {\n    this.updateComponentState(event.detail);\n  },\n\n  update(oldData) {\n    if (this.data !== oldData) {\n      this.updateComponentState(window.APP.quality);\n    }\n  },\n\n  updateComponentState(quality) {\n    this.el.setAttribute(\"visible\", quality !== this.data);\n  }\n});\n","AFRAME.registerComponent(\"point-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 },\n    range: { default: 0 },\n    decay: { default: 2 },\n    castShadow: { default: true },\n    shadowMapResolution: { default: [512, 512] },\n    shadowBias: { default: 0 },\n    shadowRadius: { default: 1 }\n  },\n\n  init() {\n    const el = this.el;\n    this.light = new THREE.PointLight();\n    this.light.shadow.camera.matrixAutoUpdate = true;\n    this.el.setObject3D(\"point-light\", this.light);\n    this.el.sceneEl.systems.light.registerLight(el);\n    this.rendererSystem = this.el.sceneEl.systems.renderer;\n  },\n\n  update(prevData) {\n    const light = this.light;\n\n    if (this.data.color !== prevData.color) {\n      const color = new THREE.Color(this.data.color);\n      this.rendererSystem.applyColorCorrection(color);\n      light.color.copy(color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      light.intensity = this.data.intensity;\n    }\n\n    if (this.data.range !== prevData.range) {\n      light.distance = this.data.range;\n    }\n\n    if (this.data.decay !== prevData.decay) {\n      light.decay = this.data.decay;\n    }\n\n    if (this.data.castShadow !== prevData.castShadow) {\n      light.castShadow = this.data.castShadow;\n    }\n\n    if (this.data.shadowBias !== prevData.shadowBias) {\n      light.shadow.bias = this.data.shadowBias;\n    }\n\n    if (this.data.shadowRadius !== prevData.shadowRadius) {\n      light.shadow.radius = this.data.shadowRadius;\n    }\n\n    const [width, height] = this.data.shadowMapResolution;\n    const [prevWidth, prevHeight] = prevData.shadowMapResolution ? prevData.shadowMapResolution : [512, 512];\n\n    if (width !== prevWidth || height !== prevHeight) {\n      light.shadow.mapSize.set(width, height);\n\n      if (light.shadow.map) {\n        light.shadow.map.dispose();\n        light.shadow.map = null;\n      }\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"point-light\");\n  }\n});\n","AFRAME.registerComponent(\"spot-light\", {\n  schema: {\n    color: { type: \"color\" },\n    intensity: { default: 1.0 },\n    range: { default: 0 },\n    decay: { default: 2 },\n    innerConeAngle: { default: 0 },\n    outerConeAngle: { default: Math.PI / 4.0 },\n    castShadow: { default: true },\n    shadowMapResolution: { default: [512, 512] },\n    shadowBias: { default: 0 },\n    shadowRadius: { default: 1 }\n  },\n\n  init() {\n    const el = this.el;\n    this.light = new THREE.SpotLight();\n    this.light.position.set(0, 0, 0);\n    this.light.target.position.set(0, 0, 1);\n    this.light.add(this.light.target);\n    this.light.matrixNeedsUpdate = true;\n    this.light.target.matrixNeedsUpdate = true;\n    this.el.setObject3D(\"spot-light\", this.light);\n    this.el.sceneEl.systems.light.registerLight(el);\n  },\n\n  update(prevData) {\n    const light = this.light;\n\n    if (this.data.color !== prevData.color) {\n      light.color.set(this.data.color);\n    }\n\n    if (this.data.intensity !== prevData.intensity) {\n      light.intensity = this.data.intensity;\n    }\n\n    if (this.data.range !== prevData.range) {\n      light.distance = this.data.range;\n    }\n\n    if (this.data.decay !== prevData.decay) {\n      light.decay = this.data.decay;\n    }\n\n    if (this.data.innerConeAngle !== prevData.innerConeAngle || this.data.outerConeAngle !== prevData.outerConeAngle) {\n      light.angle = this.data.outerConeAngle;\n      light.penumbra = 1.0 - this.data.innerConeAngle / this.data.outerConeAngle;\n    }\n\n    if (this.data.castShadow !== prevData.castShadow) {\n      light.castShadow = this.data.castShadow;\n    }\n\n    if (this.data.shadowBias !== prevData.shadowBias) {\n      light.shadow.bias = this.data.shadowBias;\n    }\n\n    if (this.data.shadowRadius !== prevData.shadowRadius) {\n      light.shadow.radius = this.data.shadowRadius;\n    }\n\n    const [width, height] = this.data.shadowMapResolution;\n    const [prevWidth, prevHeight] = prevData.shadowMapResolution ? prevData.shadowMapResolution : [512, 512];\n\n    if (width !== prevWidth || height !== prevHeight) {\n      light.shadow.mapSize.set(width, height);\n\n      if (light.shadow.map) {\n        light.shadow.map.dispose();\n        light.shadow.map = null;\n      }\n    }\n  },\n\n  remove: function() {\n    this.el.removeObject3D(\"spot-light\");\n  }\n});\n","/* global AFRAME */\nconst COLLISION_LAYERS = require(\"../constants\").COLLISION_LAYERS;\n\nAFRAME.registerComponent(\"floaty-object\", {\n  schema: {\n    // Make the object locked/kinematic upon load\n    autoLockOnLoad: { default: false },\n\n    // Make the object kinematic immediately upon release\n    autoLockOnRelease: { default: false },\n\n    // On release, modify the gravity based upon gravitySpeedLimit. If less than this, let the object float\n    // otherwise apply releaseGravity.\n    modifyGravityOnRelease: { default: false },\n\n    // Gravity to apply if object is thrown at a speed greated than speed limit.\n    releaseGravity: { default: -2 },\n\n    // If true, the degree to which angular rotation is allowed when floating is reduced (useful for 2d media)\n    reduceAngularFloat: { default: false },\n\n    // Velocity speed limit under which gravity will not be added if modifyGravityOnRelease is true\n    gravitySpeedLimit: { default: 1.85 } // Set to 0 to never apply gravity\n  },\n\n  init() {\n    this.onGrab = this.onGrab.bind(this);\n    this.onRelease = this.onRelease.bind(this);\n  },\n\n  tick() {\n    if (!this.ammoBody) {\n      this.ammoBody = this.el.components[\"ammo-body\"];\n    }\n\n    const interaction = AFRAME.scenes[0].systems.interaction;\n    const isHeld = interaction.isHeld(this.el);\n    if (isHeld && !this.wasHeld) {\n      this.onGrab();\n    }\n    if (this.wasHeld && !isHeld) {\n      this.onRelease();\n    }\n\n    if (!isHeld && this._makeStaticWhenAtRest) {\n      const isMine = this.el.components.networked && NAF.utils.isMine(this.el);\n      const linearThreshold = this.ammoBody.data.linearSleepingThreshold;\n      const angularThreshold = this.ammoBody.data.angularSleepingThreshold;\n      const isAtRest =\n        this.ammoBody.body.getLinearVelocity().length2() < linearThreshold * linearThreshold &&\n        this.ammoBody.body.getAngularVelocity().length2() < angularThreshold * angularThreshold;\n\n      if (isAtRest && isMine) {\n        this.el.setAttribute(\"ammo-body\", { type: \"static\" });\n      }\n\n      if (isAtRest || !isMine) {\n        this._makeStaticWhenAtRest = false;\n      }\n    }\n\n    this.wasHeld = isHeld;\n  },\n\n  play() {\n    // We do this in play instead of in init because otherwise NAF.utils.isMine fails\n    if (this.hasBeenHereBefore) return;\n    this.hasBeenHereBefore = true;\n    if (this.el.body) {\n      this._onBodyLoaded();\n    } else {\n      this._onBodyLoaded = this._onBodyLoaded.bind(this);\n      this.el.addEventListener(\"body-loaded\", this._onBodyLoaded, { once: true });\n    }\n  },\n\n  setLocked(locked) {\n    if (this.el.components.networked && !NAF.utils.isMine(this.el)) return;\n\n    this.locked = locked;\n    this.el.setAttribute(\"ammo-body\", { type: locked ? \"kinematic\" : \"dynamic\" });\n  },\n\n  _onBodyLoaded() {\n    if (this.data.autoLockOnLoad) {\n      this.setLocked(true);\n    }\n  },\n\n  onRelease() {\n    if (this.data.modifyGravityOnRelease) {\n      if (\n        this.data.gravitySpeedLimit === 0 ||\n        this.ammoBody.getVelocity().length2() < this.data.gravitySpeedLimit * this.data.gravitySpeedLimit\n      ) {\n        this.el.setAttribute(\"ammo-body\", {\n          gravity: { x: 0, y: 0, z: 0 },\n          angularDamping: this.data.reduceAngularFloat ? 0.98 : 0.5,\n          linearDamping: 0.95,\n          linearSleepingThreshold: 0.1,\n          angularSleepingThreshold: 0.1,\n          collisionFilterMask: COLLISION_LAYERS.HANDS\n        });\n\n        this._makeStaticWhenAtRest = true;\n      } else {\n        this.el.setAttribute(\"ammo-body\", {\n          gravity: { x: 0, y: this.data.releaseGravity, z: 0 },\n          angularDamping: 0.01,\n          linearDamping: 0.01,\n          linearSleepingThreshold: 1.6,\n          angularSleepingThreshold: 2.5,\n          collisionFilterMask: COLLISION_LAYERS.DEFAULT_INTERACTABLE\n        });\n      }\n    } else {\n      this.el.setAttribute(\"ammo-body\", { collisionFilterMask: COLLISION_LAYERS.DEFAULT_INTERACTABLE });\n    }\n\n    if (this.data.autoLockOnRelease) {\n      this.setLocked(true);\n    }\n  },\n\n  onGrab() {\n    this.el.setAttribute(\"ammo-body\", {\n      collisionFilterMask: COLLISION_LAYERS.HANDS\n    });\n    this.setLocked(false);\n  },\n\n  remove() {\n    this.el.removeEventListener(\"body-loaded\", this._onBodyLoaded);\n    if (this.stuckTo) {\n      const stuckTo = this.stuckTo;\n      delete this.stuckTo;\n      stuckTo._unstickObject();\n    }\n  }\n});\n","const sizeVec = new THREE.Vector3();\nconst boundingBoxWorldPositionVec = new THREE.Vector3();\nconst colliderWorldPositionVec = new THREE.Vector3();\n\nAFRAME.registerComponent(\"trigger-volume\", {\n  schema: {\n    colliders: { type: \"selectorAll\" },\n    size: { type: \"vec3\", default: { x: 1, y: 1, z: 1 } },\n    target: { type: \"selector\" },\n    enterComponent: { type: \"string\" },\n    enterProperty: { type: \"string\" },\n    enterValue: {\n      default: \"\",\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\n      stringify: JSON.stringify\n    },\n    leaveComponent: { type: \"string\" },\n    leaveProperty: { type: \"string\" },\n    leaveValue: {\n      default: \"\",\n      parse: v => (typeof v === \"object\" ? v : JSON.parse(v)),\n      stringify: JSON.stringify\n    }\n  },\n  init() {\n    this.boundingBox = new THREE.Box3();\n    this.collidingLastFrame = {};\n  },\n  update() {\n    this.el.object3D.getWorldPosition(boundingBoxWorldPositionVec);\n    sizeVec.copy(this.data.size);\n    this.boundingBox.setFromCenterAndSize(boundingBoxWorldPositionVec, sizeVec);\n  },\n  tick() {\n    const colliders = this.data.colliders;\n\n    for (let i = 0; i < colliders.length; i++) {\n      const collider = colliders[i];\n      const object3D = collider.object3D;\n\n      object3D.getWorldPosition(colliderWorldPositionVec);\n      const isColliding = this.boundingBox.containsPoint(colliderWorldPositionVec);\n      const collidingLastFrame = this.collidingLastFrame[object3D.id];\n\n      if (isColliding && !collidingLastFrame) {\n        this.data.target.setAttribute(this.data.enterComponent, this.data.enterProperty, this.data.enterValue);\n      } else if (!isColliding && collidingLastFrame) {\n        this.data.target.setAttribute(this.data.leaveComponent, this.data.leaveProperty, this.data.leaveValue);\n      }\n\n      this.collidingLastFrame[object3D.id] = isColliding;\n    }\n  }\n});\n","// HACK: Setting videoPaused on media-video doesn't work if you are the owner.\n// This component gets around that by calling .togglePlaying() to play/pause the video based on a property change.\nAFRAME.registerComponent(\"video-pause-state\", {\n  schema: {\n    paused: { default: false }\n  },\n\n  init() {\n    this.onPauseStateChange = this.onPauseStateChange.bind(this);\n    this.videoComponent = this.el.components[\"media-video\"];\n\n    if (this.videoComponent) {\n      this.onVideoLoaded();\n    } else {\n      this.onVideoLoaded = this.onVideoLoaded.bind(this);\n      this.el.addEventListener(\"video-loaded\", this.onVideoLoaded);\n    }\n  },\n\n  onVideoLoaded() {\n    this.videoComponent = this.el.components[\"media-video\"];\n    this.video = this.videoComponent.video;\n    this.video.addEventListener(\"pause\", this.onPauseStateChange);\n  },\n\n  onPauseStateChange() {\n    this.el.setAttribute(\"paused\", this.video.paused);\n  },\n\n  update() {\n    if (this.video && this.data.paused !== this.video.paused) {\n      this.videoComponent.togglePlaying();\n    }\n  },\n\n  remove() {\n    this.video.removeEventListener(\"pause\", this.onPauseStateChange);\n    this.el.removeEventListener(\"video-loaded\", this.onVideoLoaded);\n  }\n});\n","/**\n * Logs all events dispatched on an entity\n * @namespace debug\n * @component log-events\n */\nAFRAME.registerComponent(\"log-events\", {\n  init: function() {\n    const el = this.el;\n    const log = this.log.bind(this);\n    const origDispatch = this.el.dispatchEvent;\n    this.el.dispatchEvent = function() {\n      log(Array.from(arguments));\n      return origDispatch.apply(el, arguments);\n    };\n  },\n  log: function([e]) {\n    if ([\"componentchanged\"].includes(e.type)) return;\n    let firstObject = true;\n    const replacer = (k, x) => {\n      if (!x) return x;\n      if (typeof x === \"object\" && x.length === undefined) {\n        if (firstObject) {\n          firstObject = false;\n          return x;\n        }\n        return \"[object]\";\n      }\n      return x;\n    };\n    console.info(`log-events: ${this.el.id} ${e.type} ${JSON.stringify(e.detail, replacer)}`);\n  }\n});\n\n/**\n * Logs all life cycle phases on an entity.\n * @namespace debug\n * @component lifecycle-checker\n */\nAFRAME.registerComponent(\"lifecycle-checker\", {\n  schema: {\n    name: { type: \"string\" },\n    tick: { default: false }\n  },\n  init: function() {\n    this.log(\"init\");\n  },\n  update: function() {\n    this.log(\"update\");\n  },\n  tick: function() {\n    if (this.data.tick) {\n      this.log(\"tick\");\n    }\n  },\n  remove: function() {\n    this.log(\"remove\");\n  },\n  pause: function() {\n    this.log(\"pause\");\n  },\n  play: function() {\n    this.log(\"play\");\n  },\n\n  log: function(method) {\n    console.info(`lifecycle-checker:${this.data.name} ${method}`);\n  }\n});\n","export const createImageBitmap =\n  window.createImageBitmap ||\n  async function(data) {\n    return new Promise(resolve => {\n      // https://dev.to/nektro/createimagebitmap-polyfill-for-safari-and-edge-228\n      // https://gist.github.com/MonsieurV/fb640c29084c171b4444184858a91bc7\n\n      let srcUrl;\n      if (data instanceof Blob) {\n        srcUrl = URL.createObjectURL(data);\n      } else {\n        const canvas = document.createElement(\"canvas\");\n        const ctx = canvas.getContext(\"2d\");\n        canvas.width = data.width;\n        canvas.height = data.height;\n        ctx.putImageData(data, 0, 0);\n        srcUrl = canvas.toDataURL();\n      }\n      const img = document.createElement(\"img\");\n\n      img.addEventListener(\"load\", () => resolve(img));\n\n      img.src = srcUrl;\n    });\n  };\n\nexport function disposeImageBitmap(imageBitmap) {\n  if (imageBitmap instanceof HTMLImageElement && imageBitmap.src.startsWith(\"blob:\")) {\n    URL.revokeObjectURL(imageBitmap.src);\n  } else {\n    imageBitmap.close && imageBitmap.close();\n  }\n}\n","const { Pathfinding } = require(\"three-pathfinding\");\n\nAFRAME.registerSystem(\"nav\", {\n  init: function() {\n    this.pathfinder = new Pathfinding();\n  },\n\n  loadMesh: function(mesh, zone) {\n    this.el.object3D.updateMatrixWorld();\n\n    if (this.mesh && this.mesh.geometry && this.mesh.geometry.dispose) {\n      this.mesh.geometry.dispose();\n    }\n\n    this.mesh = mesh;\n    const geometry = new THREE.Geometry().fromBufferGeometry(mesh.geometry);\n    geometry.applyMatrix(mesh.matrixWorld);\n    this.pathfinder.setZoneData(zone, Pathfinding.createZone(geometry));\n    this.el.sceneEl.emit(\"nav-mesh-loaded\");\n  }\n});\n","/**\n * Listens to events from an event source and re-emits them on this entity\n * @component event-repeater\n */\nAFRAME.registerComponent(\"event-repeater\", {\n  schema: {\n    eventSource: { type: \"selector\" },\n    events: { type: \"array\" }\n  },\n\n  play: function() {\n    this.data.eventListeners = [];\n    const events = this.data.events;\n    for (let i = 0; i < events.length; i++) {\n      const event = events[i];\n      this.data.eventListeners[event] = this._handleEvent.bind(this, event);\n      this.data.eventSource.addEventListener(event, this.data.eventListeners[event]);\n    }\n  },\n\n  pause: function() {\n    const events = this.data.events;\n    for (let i = 0; i < events.length; i++) {\n      const event = events[i];\n      this.data.eventSource.removeEventListener(event, this.data.eventListeners[event]);\n    }\n    this.data.eventListeners = [];\n  },\n\n  _handleEvent: function(event, e) {\n    this.el.emit(event, e.detail);\n  }\n});\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\n\nexport const ReactAudioContext = React.createContext({});\n\nexport const hudHoverSound = \"play_sound-hud_hover_start\";\n\nexport const WithHoverSound = ({ sound, children }) => {\n  return (\n    <ReactAudioContext.Consumer>\n      {context => {\n        return React.cloneElement(children, {\n          onMouseEnter: e => {\n            if (context && context.playSound) {\n              context.playSound(sound || hudHoverSound);\n            }\n            children.props.onMouseEnter && children.props.onMouseEnter(e);\n          }\n        });\n      }}\n    </ReactAudioContext.Consumer>\n  );\n};\n\nWithHoverSound.propTypes = {\n  children: PropTypes.object,\n  sound: PropTypes.string\n};\n","export default function nextTick() {\n  return new Promise(resolve => {\n    setTimeout(resolve, 0);\n  });\n}\n","export function showHoverEffect(el) {\n  const isFrozen = el.sceneEl.is(\"frozen\");\n  const isPinned = el.components.pinnable && el.components.pinnable.data.pinned;\n  const isSpawner = !!el.components[\"super-spawner\"];\n  const canMove =\n    window.APP.hubChannel.can(\"spawn_and_move_media\") && (!isPinned || window.APP.hubChannel.can(\"pin_objects\"));\n  return (isSpawner || !isPinned || isFrozen) && canMove;\n}\n\nexport function canMove(entity) {\n  const isPinned = entity.components.pinnable && entity.components.pinnable.data.pinned;\n  const networkedTemplate = entity && entity.components.networked && entity.components.networked.data.template;\n  const isCamera = networkedTemplate === \"#interactable-camera\";\n  const isPen = networkedTemplate === \"#interactable-pen\";\n  return (\n    window.APP.hubChannel.can(\"spawn_and_move_media\") &&\n    (!isPinned || window.APP.hubChannel.can(\"pin_objects\")) &&\n    (!isCamera || window.APP.hubChannel.can(\"spawn_camera\")) &&\n    (!isPen || window.APP.hubChannel.can(\"spawn_drawing\"))\n  );\n}\n"],"sourceRoot":""}